From c75966b83ca8f6484a4fa18bb7c43a82b98f549d Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 07:56:46 +0000
Subject: [PATCH 01/27] feat: add crm-homecare template (Twomiah Care vertical)

- 48-model Prisma schema from CVHC base + 7 migrations (full homecare domain)
- 25 API route files: auth, clients, caregivers, scheduling, time-tracking,
  billing, EVV, EDI, claims, remittance, authorizations, payroll, compliance,
  communication, forms, push, SMS, portal, reports, optimizer, audit, company
- Seed: agency, admin user, 10 service codes, 4 default payers, 3 form templates, noshow config
- Frontend: React + Vite + Tailwind with 50 admin components, caregiver portal, family portal
- config.js shim maps CVHC API calls to new tokenized api.js service
- Generator updated: industry=home_care routes to crm-homecare template
- Render services use -care/-care-api suffix for home_care builds
- All tokens in place for full Factory injection
- render.yaml.template with postgres + API + static frontend + SPA rewrite
---
 backend/src/services/factory/generator.js     |    9 +-
 templates/crm-homecare/backend/.env.example   |   44 +
 templates/crm-homecare/backend/.gitignore     |    4 +
 .../crm-homecare/backend/package-lock.json    | 2542 +++++++++++++++++
 templates/crm-homecare/backend/package.json   |   42 +
 .../crm-homecare/backend/prisma/schema.prisma | 1135 ++++++++
 templates/crm-homecare/backend/prisma/seed.js |  155 +
 templates/crm-homecare/backend/src/index.js   |  163 ++
 .../backend/src/middleware/auth.js            |   49 +
 .../backend/src/middleware/security.js        |   16 +
 .../crm-homecare/backend/src/routes/audit.js  |   23 +
 .../crm-homecare/backend/src/routes/auth.js   |  115 +
 .../backend/src/routes/authorizations.js      |   44 +
 .../backend/src/routes/billing.js             |  113 +
 .../backend/src/routes/caregivers.js          |  145 +
 .../crm-homecare/backend/src/routes/claims.js |   39 +
 .../backend/src/routes/clients.js             |  159 ++
 .../backend/src/routes/communication.js       |  117 +
 .../backend/src/routes/company.js             |   40 +
 .../backend/src/routes/compliance.js          |   79 +
 .../backend/src/routes/dashboard.js           |  111 +
 .../backend/src/routes/documents.js           |   32 +
 .../crm-homecare/backend/src/routes/edi.js    |   38 +
 .../crm-homecare/backend/src/routes/evv.js    |   65 +
 .../crm-homecare/backend/src/routes/forms.js  |   62 +
 .../backend/src/routes/notifications.js       |   47 +
 .../backend/src/routes/optimizer.js           |   49 +
 .../crm-homecare/backend/src/routes/payers.js |   32 +
 .../backend/src/routes/payroll.js             |   96 +
 .../crm-homecare/backend/src/routes/portal.js |   72 +
 .../crm-homecare/backend/src/routes/push.js   |   33 +
 .../backend/src/routes/remittance.js          |   36 +
 .../backend/src/routes/reports.js             |  117 +
 .../backend/src/routes/scheduling.js          |  234 ++
 .../backend/src/routes/serviceCodes.js        |   29 +
 .../crm-homecare/backend/src/routes/sms.js    |   22 +
 .../crm-homecare/backend/src/routes/stripe.js |   11 +
 .../backend/src/routes/timeTracking.js        |  178 ++
 .../backend/src/services/logger.js            |   21 +
 .../backend/src/services/socket.js            |   48 +
 .../crm-homecare/backend/src/utils/errors.js  |   28 +
 templates/crm-homecare/frontend/.env.example  |    4 +
 templates/crm-homecare/frontend/.gitignore    |    3 +
 templates/crm-homecare/frontend/index.html    |   14 +
 templates/crm-homecare/frontend/package.json  |   29 +
 .../crm-homecare/frontend/postcss.config.js   |    3 +
 templates/crm-homecare/frontend/src/App.jsx   |   93 +
 .../frontend/src/components/AddressLink.jsx   |  120 +
 .../src/components/CaregiverClientModal.jsx   |  286 ++
 .../frontend/src/components/ConfirmModal.jsx  |   79 +
 .../frontend/src/components/ErrorBoundary.jsx |   69 +
 .../frontend/src/components/HelpPanel.jsx     |  453 +++
 .../src/components/MileageTracker.jsx         |  375 +++
 .../frontend/src/components/OfflineBanner.jsx |   69 +
 .../frontend/src/components/Toast.jsx         |   68 +
 .../src/components/admin/ADLTracking.jsx      |  597 ++++
 .../components/admin/AbsenceManagement.jsx    |  238 ++
 .../components/admin/AddCaregiverModal.jsx    |  145 +
 .../src/components/admin/AlertsManagement.jsx |  494 ++++
 .../components/admin/ApplicationDetail.jsx    |  297 ++
 .../admin/ApplicationsDashboard.jsx           |  292 ++
 .../src/components/admin/AuditLogs.jsx        |  512 ++++
 .../src/components/admin/AutoFillButton.jsx   |  431 +++
 .../src/components/admin/BackgroundChecks.jsx |  544 ++++
 .../src/components/admin/BillingDashboard.jsx | 1639 +++++++++++
 .../src/components/admin/CarePlans.jsx        |  514 ++++
 .../admin/CaregiverAvailability.jsx           |  422 +++
 .../src/components/admin/CaregiverDetail.jsx  |  819 ++++++
 .../src/components/admin/CaregiverHistory.jsx |  363 +++
 .../components/admin/CaregiverManagement.jsx  |  608 ++++
 .../src/components/admin/CaregiverProfile.jsx |  464 +++
 .../src/components/admin/ClaimsManagement.jsx |  509 ++++
 .../src/components/admin/ClientModal.jsx      |   88 +
 .../src/components/admin/ClientOnboarding.jsx |  377 +++
 .../components/admin/ClientsManagement.jsx    |  478 ++++
 .../src/components/admin/CommunicationLog.jsx |  264 ++
 .../src/components/admin/CompanyOptimizer.jsx |  662 +++++
 .../components/admin/ComplianceTracking.jsx   |  783 +++++
 .../components/admin/DashboardOverview.jsx    |  191 ++
 .../components/admin/DocumentsManagement.jsx  |  465 +++
 .../components/admin/DragDropScheduler.jsx    |  616 ++++
 .../src/components/admin/EditClientModal.jsx  |  859 ++++++
 .../components/admin/EmergencyCoverage.jsx    |  284 ++
 .../components/admin/ExpenseManagement.jsx    |  549 ++++
 .../components/admin/FamilyPortalAdmin.jsx    |  647 +++++
 .../src/components/admin/FormBuilder.jsx      |  408 +++
 .../components/admin/IncidentReporting.jsx    |  531 ++++
 .../src/components/admin/IntegrationsHub.jsx  |  770 +++++
 .../src/components/admin/LoginActivity.jsx    |  258 ++
 .../admin/MedicationsManagement.jsx           |  645 +++++
 .../src/components/admin/MessageBoard.jsx     |  348 +++
 .../src/components/admin/NoShowAlerts.jsx     |  256 ++
 .../components/admin/NotificationCenter.jsx   |  470 +++
 .../src/components/admin/OpenShifts.jsx       |  539 ++++
 .../components/admin/PayrollProcessing.jsx    |  821 ++++++
 .../components/admin/PerformanceRatings.jsx   |  429 +++
 .../src/components/admin/ReferralSources.jsx  |  295 ++
 .../src/components/admin/ReportsAnalytics.jsx |  675 +++++
 .../src/components/admin/RevenueForecast.jsx  |  294 ++
 .../src/components/admin/RosterOptimizer.jsx  |  646 +++++
 .../src/components/admin/RouteOptimizer.jsx   | 1307 +++++++++
 .../src/components/admin/SMSManagement.jsx    |  666 +++++
 .../src/components/admin/ScheduleCalendar.jsx |  587 ++++
 .../components/admin/ScheduleOptimizer.jsx    |  604 ++++
 .../src/components/admin/SchedulingHub.jsx    | 1564 ++++++++++
 .../src/components/admin/ShiftSwaps.jsx       |  254 ++
 .../caregiver/CaregiverDashboard.jsx          | 1172 ++++++++
 .../components/caregiver/CaregiverHelp.jsx    |  284 ++
 .../caregiver/CaregiverMessages.jsx           |  192 ++
 .../components/caregiver/ShiftMissReport.jsx  |  185 ++
 .../src/components/common/AddressLink.jsx     |  120 +
 .../src/components/common/ConfirmModal.jsx    |   79 +
 .../src/components/common/ErrorBoundary.jsx   |   69 +
 .../frontend/src/components/common/Login.jsx  |  122 +
 .../src/components/common/MileageTracker.jsx  |  375 +++
 .../frontend/src/components/common/Toast.jsx  |   68 +
 .../src/components/layout/AppLayout.jsx       |   96 +
 .../src/components/portal/ClientPortal.jsx    |  160 ++
 .../components/portal/PortalCaregivers.jsx    |  104 +
 .../src/components/portal/PortalHistory.jsx   |  121 +
 .../src/components/portal/PortalInvoices.jsx  |  133 +
 .../src/components/portal/PortalLogin.jsx     |   93 +
 .../components/portal/PortalNotifications.jsx |  151 +
 .../src/components/portal/PortalSetup.jsx     |  115 +
 .../src/components/portal/PortalVisits.jsx    |  151 +
 templates/crm-homecare/frontend/src/config.js |  152 +
 .../frontend/src/contexts/AuthContext.jsx     |   50 +
 .../frontend/src/contexts/ToastContext.jsx    |   36 +
 .../frontend/src/hooks/useNative.js           |  351 +++
 .../frontend/src/hooks/useOfflineSync.jsx     |   93 +
 templates/crm-homecare/frontend/src/index.css |   32 +
 templates/crm-homecare/frontend/src/main.jsx  |   10 +
 .../frontend/src/pages/AuditPage.jsx          |    8 +
 .../frontend/src/pages/BillingPage.jsx        |    8 +
 .../src/pages/CaregiverDetailPage.jsx         |    8 +
 .../src/pages/CaregiverPortalPage.jsx         |   10 +
 .../frontend/src/pages/CaregiversPage.jsx     |    8 +
 .../frontend/src/pages/ClaimsPage.jsx         |    8 +
 .../frontend/src/pages/ClientDetailPage.jsx   |    8 +
 .../frontend/src/pages/ClientsPage.jsx        |   92 +
 .../frontend/src/pages/CommunicationPage.jsx  |    8 +
 .../frontend/src/pages/CompliancePage.jsx     |    8 +
 .../frontend/src/pages/DashboardPage.jsx      |   95 +
 .../frontend/src/pages/DocumentsPage.jsx      |    8 +
 .../frontend/src/pages/EVVPage.jsx            |    8 +
 .../frontend/src/pages/FamilyPortalPage.jsx   |   10 +
 .../frontend/src/pages/FormsPage.jsx          |    8 +
 .../frontend/src/pages/LoginPage.jsx          |   75 +
 .../frontend/src/pages/NotificationsPage.jsx  |    8 +
 .../frontend/src/pages/PayrollPage.jsx        |    8 +
 .../frontend/src/pages/ReportsPage.jsx        |    8 +
 .../frontend/src/pages/SchedulingPage.jsx     |    8 +
 .../frontend/src/pages/SettingsPage.jsx       |    8 +
 .../frontend/src/pages/TimeTrackingPage.jsx   |   80 +
 .../crm-homecare/frontend/src/services/api.js |   74 +
 .../crm-homecare/frontend/tailwind.config.js  |   13 +
 .../crm-homecare/frontend/vite.config.js      |    7 +
 templates/crm-homecare/render.yaml.template   |   51 +
 158 files changed, 40723 insertions(+), 3 deletions(-)
 create mode 100644 templates/crm-homecare/backend/.env.example
 create mode 100644 templates/crm-homecare/backend/.gitignore
 create mode 100644 templates/crm-homecare/backend/package-lock.json
 create mode 100644 templates/crm-homecare/backend/package.json
 create mode 100644 templates/crm-homecare/backend/prisma/schema.prisma
 create mode 100644 templates/crm-homecare/backend/prisma/seed.js
 create mode 100644 templates/crm-homecare/backend/src/index.js
 create mode 100644 templates/crm-homecare/backend/src/middleware/auth.js
 create mode 100644 templates/crm-homecare/backend/src/middleware/security.js
 create mode 100644 templates/crm-homecare/backend/src/routes/audit.js
 create mode 100644 templates/crm-homecare/backend/src/routes/auth.js
 create mode 100644 templates/crm-homecare/backend/src/routes/authorizations.js
 create mode 100644 templates/crm-homecare/backend/src/routes/billing.js
 create mode 100644 templates/crm-homecare/backend/src/routes/caregivers.js
 create mode 100644 templates/crm-homecare/backend/src/routes/claims.js
 create mode 100644 templates/crm-homecare/backend/src/routes/clients.js
 create mode 100644 templates/crm-homecare/backend/src/routes/communication.js
 create mode 100644 templates/crm-homecare/backend/src/routes/company.js
 create mode 100644 templates/crm-homecare/backend/src/routes/compliance.js
 create mode 100644 templates/crm-homecare/backend/src/routes/dashboard.js
 create mode 100644 templates/crm-homecare/backend/src/routes/documents.js
 create mode 100644 templates/crm-homecare/backend/src/routes/edi.js
 create mode 100644 templates/crm-homecare/backend/src/routes/evv.js
 create mode 100644 templates/crm-homecare/backend/src/routes/forms.js
 create mode 100644 templates/crm-homecare/backend/src/routes/notifications.js
 create mode 100644 templates/crm-homecare/backend/src/routes/optimizer.js
 create mode 100644 templates/crm-homecare/backend/src/routes/payers.js
 create mode 100644 templates/crm-homecare/backend/src/routes/payroll.js
 create mode 100644 templates/crm-homecare/backend/src/routes/portal.js
 create mode 100644 templates/crm-homecare/backend/src/routes/push.js
 create mode 100644 templates/crm-homecare/backend/src/routes/remittance.js
 create mode 100644 templates/crm-homecare/backend/src/routes/reports.js
 create mode 100644 templates/crm-homecare/backend/src/routes/scheduling.js
 create mode 100644 templates/crm-homecare/backend/src/routes/serviceCodes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/sms.js
 create mode 100644 templates/crm-homecare/backend/src/routes/stripe.js
 create mode 100644 templates/crm-homecare/backend/src/routes/timeTracking.js
 create mode 100644 templates/crm-homecare/backend/src/services/logger.js
 create mode 100644 templates/crm-homecare/backend/src/services/socket.js
 create mode 100644 templates/crm-homecare/backend/src/utils/errors.js
 create mode 100644 templates/crm-homecare/frontend/.env.example
 create mode 100644 templates/crm-homecare/frontend/.gitignore
 create mode 100644 templates/crm-homecare/frontend/index.html
 create mode 100644 templates/crm-homecare/frontend/package.json
 create mode 100644 templates/crm-homecare/frontend/postcss.config.js
 create mode 100644 templates/crm-homecare/frontend/src/App.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/AddressLink.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/CaregiverClientModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/ConfirmModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/ErrorBoundary.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/HelpPanel.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/MileageTracker.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/OfflineBanner.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/Toast.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ADLTracking.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/AbsenceManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/AddCaregiverModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/AlertsManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ApplicationDetail.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ApplicationsDashboard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/AuditLogs.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/AutoFillButton.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/BackgroundChecks.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/BillingDashboard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CarePlans.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CaregiverAvailability.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CaregiverDetail.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CaregiverHistory.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CaregiverManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CaregiverProfile.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ClaimsManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ClientModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ClientOnboarding.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ClientsManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CommunicationLog.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/CompanyOptimizer.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ComplianceTracking.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/DashboardOverview.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/DocumentsManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/DragDropScheduler.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/EditClientModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/EmergencyCoverage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ExpenseManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/FamilyPortalAdmin.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/FormBuilder.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/IncidentReporting.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/IntegrationsHub.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/LoginActivity.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/MedicationsManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/MessageBoard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/NoShowAlerts.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/NotificationCenter.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/OpenShifts.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/PayrollProcessing.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/PerformanceRatings.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ReferralSources.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ReportsAnalytics.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/RevenueForecast.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/RosterOptimizer.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/RouteOptimizer.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/SMSManagement.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ScheduleCalendar.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ScheduleOptimizer.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/SchedulingHub.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/admin/ShiftSwaps.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/caregiver/CaregiverHelp.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/caregiver/CaregiverMessages.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/caregiver/ShiftMissReport.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/AddressLink.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/ConfirmModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/ErrorBoundary.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/Login.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/MileageTracker.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/common/Toast.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/layout/AppLayout.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/ClientPortal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalCaregivers.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalHistory.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalInvoices.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalLogin.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalNotifications.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalSetup.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/portal/PortalVisits.jsx
 create mode 100644 templates/crm-homecare/frontend/src/config.js
 create mode 100644 templates/crm-homecare/frontend/src/contexts/AuthContext.jsx
 create mode 100644 templates/crm-homecare/frontend/src/contexts/ToastContext.jsx
 create mode 100644 templates/crm-homecare/frontend/src/hooks/useNative.js
 create mode 100644 templates/crm-homecare/frontend/src/hooks/useOfflineSync.jsx
 create mode 100644 templates/crm-homecare/frontend/src/index.css
 create mode 100644 templates/crm-homecare/frontend/src/main.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/AuditPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/BillingPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/CaregiverDetailPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/CaregiverPortalPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/CaregiversPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/ClaimsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/ClientDetailPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/ClientsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/CommunicationPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/CompliancePage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/DashboardPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/DocumentsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/EVVPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/FamilyPortalPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/FormsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/LoginPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/NotificationsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/PayrollPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/ReportsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/SchedulingPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/SettingsPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/pages/TimeTrackingPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/services/api.js
 create mode 100644 templates/crm-homecare/frontend/tailwind.config.js
 create mode 100644 templates/crm-homecare/frontend/vite.config.js
 create mode 100644 templates/crm-homecare/render.yaml.template

diff --git a/backend/src/services/factory/generator.js b/backend/src/services/factory/generator.js
index 1b7a79b..e39b872 100644
--- a/backend/src/services/factory/generator.js
+++ b/backend/src/services/factory/generator.js
@@ -95,7 +95,10 @@ export async function generate(config) {
     }
 
     if (products.includes('crm')) {
-      copyTemplate('crm', path.join(workDir, 'crm'), tokens);
+      // Pick the right CRM template based on industry
+      const crmIndustry = config.company?.industry || '';
+      const crmTemplate = crmIndustry === 'home_care' ? 'crm-homecare' : 'crm';
+      copyTemplate(crmTemplate, path.join(workDir, 'crm'), tokens);
       // Process CRM-specific files
       processCRM(path.join(workDir, 'crm'), config, tokens);
       // Write logo to CRM frontend public dir
@@ -168,8 +171,8 @@ function buildTokenMap(config, slug) {
     // Domain / URLs
     '{{DOMAIN}}': c.domain || `${slug}.com`,
     '{{SITE_URL}}': c.siteUrl || `https://${c.domain || slug + '.com'}`,
-    '{{FRONTEND_URL}}': c.frontendUrl || `https://${slug}-crm.onrender.com`,
-    '{{BACKEND_URL}}': c.backendUrl || `https://${slug}-api.onrender.com`,
+    '{{FRONTEND_URL}}': c.frontendUrl || (c.industry === 'home_care' ? `https://${slug}-care.onrender.com` : `https://${slug}-crm.onrender.com`),
+    '{{BACKEND_URL}}': c.backendUrl || (c.industry === 'home_care' ? `https://${slug}-care-api.onrender.com` : `https://${slug}-api.onrender.com`),
 
     // Industry
     '{{INDUSTRY}}': c.industry || 'Contractor',
diff --git a/templates/crm-homecare/backend/.env.example b/templates/crm-homecare/backend/.env.example
new file mode 100644
index 0000000..14e2146
--- /dev/null
+++ b/templates/crm-homecare/backend/.env.example
@@ -0,0 +1,44 @@
+# {{COMPANY_NAME}} — HomeCare CRM Backend
+# Generated by Twomiah Build Factory
+
+# ── Database ─────────────────────────────────────────────
+DATABASE_URL="postgresql://user:password@localhost:5432/{{COMPANY_SLUG}}_care"
+
+# ── Auth ─────────────────────────────────────────────────
+JWT_SECRET="{{JWT_SECRET}}"
+JWT_REFRESH_SECRET="{{JWT_REFRESH_SECRET}}"
+
+# ── App ──────────────────────────────────────────────────
+NODE_ENV="production"
+PORT=3001
+FRONTEND_URL="{{FRONTEND_URL}}"
+
+# ── Encryption (for SSN, license, sensitive fields) ──────
+ENCRYPTION_KEY="{{ENCRYPTION_KEY}}"
+
+# ── Twilio (SMS) ─────────────────────────────────────────
+TWILIO_ACCOUNT_SID=""
+TWILIO_AUTH_TOKEN=""
+TWILIO_PHONE_NUMBER=""
+
+# ── Email (SendGrid or SMTP) ─────────────────────────────
+SENDGRID_API_KEY=""
+EMAIL_FROM="{{COMPANY_EMAIL}}"
+
+# ── Stripe ───────────────────────────────────────────────
+STRIPE_SECRET_KEY=""
+STRIPE_WEBHOOK_SECRET=""
+
+# ── Push Notifications (VAPID) ───────────────────────────
+VAPID_PUBLIC_KEY=""
+VAPID_PRIVATE_KEY=""
+VAPID_EMAIL="{{COMPANY_EMAIL}}"
+
+# ── File Uploads ─────────────────────────────────────────
+UPLOAD_DIR="./uploads"
+MAX_FILE_SIZE_MB=10
+
+# ── Feature Flags ────────────────────────────────────────
+ENABLE_SANDATA_EVV=false
+ENABLE_GUSTO=false
+ENABLE_WORCS=false
diff --git a/templates/crm-homecare/backend/.gitignore b/templates/crm-homecare/backend/.gitignore
new file mode 100644
index 0000000..969e239
--- /dev/null
+++ b/templates/crm-homecare/backend/.gitignore
@@ -0,0 +1,4 @@
+node_modules/
+.env
+uploads/
+prisma/migrations/
diff --git a/templates/crm-homecare/backend/package-lock.json b/templates/crm-homecare/backend/package-lock.json
new file mode 100644
index 0000000..2a154b4
--- /dev/null
+++ b/templates/crm-homecare/backend/package-lock.json
@@ -0,0 +1,2542 @@
+{
+  "name": "twomiah-care-api",
+  "version": "1.0.0",
+  "lockfileVersion": 3,
+  "requires": true,
+  "packages": {
+    "": {
+      "name": "twomiah-care-api",
+      "version": "1.0.0",
+      "dependencies": {
+        "@prisma/client": "^5.10.0",
+        "@sendgrid/mail": "^8.1.0",
+        "bcryptjs": "^2.4.3",
+        "cookie-parser": "^1.4.6",
+        "cors": "^2.8.5",
+        "dotenv": "^16.4.5",
+        "express": "^4.18.3",
+        "express-rate-limit": "^7.2.0",
+        "helmet": "^7.1.0",
+        "jsonwebtoken": "^9.0.2",
+        "multer": "^1.4.5-lts.1",
+        "nodemailer": "^6.9.12",
+        "socket.io": "^4.7.4",
+        "stripe": "^14.25.0",
+        "twilio": "^5.0.0",
+        "uuid": "^9.0.1",
+        "web-push": "^3.6.7",
+        "winston": "^3.11.0",
+        "zod": "^3.22.4"
+      },
+      "devDependencies": {
+        "nodemon": "^3.1.0",
+        "prisma": "^5.10.0"
+      }
+    },
+    "node_modules/@colors/colors": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/@colors/colors/-/colors-1.6.0.tgz",
+      "integrity": "sha512-Ir+AOibqzrIsL6ajt3Rz3LskB7OiMVHqltZmspbW/TJuTVuyOMirVqAkjfY6JISiLHgyNqicAC8AyHHGzNd/dA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.1.90"
+      }
+    },
+    "node_modules/@dabh/diagnostics": {
+      "version": "2.0.8",
+      "resolved": "https://registry.npmjs.org/@dabh/diagnostics/-/diagnostics-2.0.8.tgz",
+      "integrity": "sha512-R4MSXTVnuMzGD7bzHdW2ZhhdPC/igELENcq5IjEverBvq5hn1SXCWcsi6eSsdWP0/Ur+SItRRjAktmdoX/8R/Q==",
+      "license": "MIT",
+      "dependencies": {
+        "@so-ric/colorspace": "^1.1.6",
+        "enabled": "2.0.x",
+        "kuler": "^2.0.0"
+      }
+    },
+    "node_modules/@prisma/client": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/client/-/client-5.22.0.tgz",
+      "integrity": "sha512-M0SVXfyHnQREBKxCgyo7sffrKttwE6R8PMq330MIUF0pTwjUhLbW84pFDlf06B27XyCR++VtjugEnIHdr07SVA==",
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
+      "engines": {
+        "node": ">=16.13"
+      },
+      "peerDependencies": {
+        "prisma": "*"
+      },
+      "peerDependenciesMeta": {
+        "prisma": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/@prisma/debug": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/debug/-/debug-5.22.0.tgz",
+      "integrity": "sha512-AUt44v3YJeggO2ZU5BkXI7M4hu9BF2zzH2iF2V5pyXT/lRTyWiElZ7It+bRH1EshoMRxHgpYg4VB6rCM+mG5jQ==",
+      "devOptional": true,
+      "license": "Apache-2.0"
+    },
+    "node_modules/@prisma/engines": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/engines/-/engines-5.22.0.tgz",
+      "integrity": "sha512-UNjfslWhAt06kVL3CjkuYpHAWSO6L4kDCVPegV6itt7nD1kSJavd3vhgAEhjglLJJKEdJ7oIqDJ+yHk6qO8gPA==",
+      "devOptional": true,
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0",
+        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+        "@prisma/fetch-engine": "5.22.0",
+        "@prisma/get-platform": "5.22.0"
+      }
+    },
+    "node_modules/@prisma/engines-version": {
+      "version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+      "resolved": "https://registry.npmjs.org/@prisma/engines-version/-/engines-version-5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2.tgz",
+      "integrity": "sha512-2PTmxFR2yHW/eB3uqWtcgRcgAbG1rwG9ZriSvQw+nnb7c4uCr3RAcGMb6/zfE88SKlC1Nj2ziUvc96Z379mHgQ==",
+      "devOptional": true,
+      "license": "Apache-2.0"
+    },
+    "node_modules/@prisma/fetch-engine": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/fetch-engine/-/fetch-engine-5.22.0.tgz",
+      "integrity": "sha512-bkrD/Mc2fSvkQBV5EpoFcZ87AvOgDxbG99488a5cexp5Ccny+UM6MAe/UFkUC0wLYD9+9befNOqGiIJhhq+HbA==",
+      "devOptional": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0",
+        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+        "@prisma/get-platform": "5.22.0"
+      }
+    },
+    "node_modules/@prisma/get-platform": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/get-platform/-/get-platform-5.22.0.tgz",
+      "integrity": "sha512-pHhpQdr1UPFpt+zFfnPazhulaZYCUqeIcPpJViYoq9R+D/yw4fjE+CtnsnKzPYm0ddUbeXUzjGVGIRVgPDCk4Q==",
+      "devOptional": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0"
+      }
+    },
+    "node_modules/@sendgrid/client": {
+      "version": "8.1.6",
+      "resolved": "https://registry.npmjs.org/@sendgrid/client/-/client-8.1.6.tgz",
+      "integrity": "sha512-/BHu0hqwXNHr2aLhcXU7RmmlVqrdfrbY9KpaNj00KZHlVOVoRxRVrpOCabIB+91ISXJ6+mLM9vpaVUhK6TwBWA==",
+      "license": "MIT",
+      "dependencies": {
+        "@sendgrid/helpers": "^8.0.0",
+        "axios": "^1.12.0"
+      },
+      "engines": {
+        "node": ">=12.*"
+      }
+    },
+    "node_modules/@sendgrid/helpers": {
+      "version": "8.0.0",
+      "resolved": "https://registry.npmjs.org/@sendgrid/helpers/-/helpers-8.0.0.tgz",
+      "integrity": "sha512-Ze7WuW2Xzy5GT5WRx+yEv89fsg/pgy3T1E3FS0QEx0/VvRmigMZ5qyVGhJz4SxomegDkzXv/i0aFPpHKN8qdAA==",
+      "license": "MIT",
+      "dependencies": {
+        "deepmerge": "^4.2.2"
+      },
+      "engines": {
+        "node": ">= 12.0.0"
+      }
+    },
+    "node_modules/@sendgrid/mail": {
+      "version": "8.1.6",
+      "resolved": "https://registry.npmjs.org/@sendgrid/mail/-/mail-8.1.6.tgz",
+      "integrity": "sha512-/ZqxUvKeEztU9drOoPC/8opEPOk+jLlB2q4+xpx6HVLq6aFu3pMpalkTpAQz8XfRfpLp8O25bh6pGPcHDCYpqg==",
+      "license": "MIT",
+      "dependencies": {
+        "@sendgrid/client": "^8.1.5",
+        "@sendgrid/helpers": "^8.0.0"
+      },
+      "engines": {
+        "node": ">=12.*"
+      }
+    },
+    "node_modules/@so-ric/colorspace": {
+      "version": "1.1.6",
+      "resolved": "https://registry.npmjs.org/@so-ric/colorspace/-/colorspace-1.1.6.tgz",
+      "integrity": "sha512-/KiKkpHNOBgkFJwu9sh48LkHSMYGyuTcSFK/qMBdnOAlrRJzRSXAOFB5qwzaVQuDl8wAvHVMkaASQDReTahxuw==",
+      "license": "MIT",
+      "dependencies": {
+        "color": "^5.0.2",
+        "text-hex": "1.0.x"
+      }
+    },
+    "node_modules/@socket.io/component-emitter": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/@socket.io/component-emitter/-/component-emitter-3.1.2.tgz",
+      "integrity": "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA==",
+      "license": "MIT"
+    },
+    "node_modules/@types/cors": {
+      "version": "2.8.19",
+      "resolved": "https://registry.npmjs.org/@types/cors/-/cors-2.8.19.tgz",
+      "integrity": "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": "*"
+      }
+    },
+    "node_modules/@types/node": {
+      "version": "25.3.0",
+      "resolved": "https://registry.npmjs.org/@types/node/-/node-25.3.0.tgz",
+      "integrity": "sha512-4K3bqJpXpqfg2XKGK9bpDTc6xO/xoUP/RBWS7AtRMug6zZFaRekiLzjVtAoZMquxoAbzBvy5nxQ7veS5eYzf8A==",
+      "license": "MIT",
+      "dependencies": {
+        "undici-types": "~7.18.0"
+      }
+    },
+    "node_modules/@types/triple-beam": {
+      "version": "1.3.5",
+      "resolved": "https://registry.npmjs.org/@types/triple-beam/-/triple-beam-1.3.5.tgz",
+      "integrity": "sha512-6WaYesThRMCl19iryMYP7/x2OVgCtbIVflDGFpWnb9irXI3UjYE4AzmYuiUKY1AJstGijoY+MgUszMgRxIYTYw==",
+      "license": "MIT"
+    },
+    "node_modules/accepts": {
+      "version": "1.3.8",
+      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
+      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-types": "~2.1.34",
+        "negotiator": "0.6.3"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/agent-base": {
+      "version": "6.0.2",
+      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
+      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "4"
+      },
+      "engines": {
+        "node": ">= 6.0.0"
+      }
+    },
+    "node_modules/agent-base/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/agent-base/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/anymatch": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
+      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "normalize-path": "^3.0.0",
+        "picomatch": "^2.0.4"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/append-field": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/append-field/-/append-field-1.0.0.tgz",
+      "integrity": "sha512-klpgFSWLW1ZEs8svjfb7g4qWY0YS5imI82dTg+QahUvJ8YqAY0P10Uk8tTyh9ZGuYEZEMaeJYCF5BFuX552hsw==",
+      "license": "MIT"
+    },
+    "node_modules/array-flatten": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
+      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
+      "license": "MIT"
+    },
+    "node_modules/asn1.js": {
+      "version": "5.4.1",
+      "resolved": "https://registry.npmjs.org/asn1.js/-/asn1.js-5.4.1.tgz",
+      "integrity": "sha512-+I//4cYPccV8LdmBLiX8CYvf9Sp3vQsrqu2QNXRcrbiWvcx/UdlFiqUJJzxRQxgsZmvhXhn4cSKeSmoFjVdupA==",
+      "license": "MIT",
+      "dependencies": {
+        "bn.js": "^4.0.0",
+        "inherits": "^2.0.1",
+        "minimalistic-assert": "^1.0.0",
+        "safer-buffer": "^2.1.0"
+      }
+    },
+    "node_modules/async": {
+      "version": "3.2.6",
+      "resolved": "https://registry.npmjs.org/async/-/async-3.2.6.tgz",
+      "integrity": "sha512-htCUDlxyyCLMgaM3xXg0C0LW2xqfuQ6p05pCEIsXuyQ+a1koYKTuBMzRNwmybfLgvJDMd0r1LTn4+E0Ti6C2AA==",
+      "license": "MIT"
+    },
+    "node_modules/asynckit": {
+      "version": "0.4.0",
+      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
+      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
+      "license": "MIT"
+    },
+    "node_modules/axios": {
+      "version": "1.13.5",
+      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.5.tgz",
+      "integrity": "sha512-cz4ur7Vb0xS4/KUN0tPWe44eqxrIu31me+fbang3ijiNscE129POzipJJA6zniq2C/Z6sJCjMimjS8Lc/GAs8Q==",
+      "license": "MIT",
+      "dependencies": {
+        "follow-redirects": "^1.15.11",
+        "form-data": "^4.0.5",
+        "proxy-from-env": "^1.1.0"
+      }
+    },
+    "node_modules/balanced-match": {
+      "version": "4.0.4",
+      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-4.0.4.tgz",
+      "integrity": "sha512-BLrgEcRTwX2o6gGxGOCNyMvGSp35YofuYzw9h1IMTRmKqttAZZVU67bdb9Pr2vUHA8+j3i2tJfjO6C6+4myGTA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/base64id": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/base64id/-/base64id-2.0.0.tgz",
+      "integrity": "sha512-lGe34o6EHj9y3Kts9R4ZYs/Gr+6N7MCaMlIFA3F1R2O5/m7K06AxfSeO5530PEERE6/WyEg3lsuyw4GHlPZHog==",
+      "license": "MIT",
+      "engines": {
+        "node": "^4.5.0 || >= 5.9"
+      }
+    },
+    "node_modules/bcryptjs": {
+      "version": "2.4.3",
+      "resolved": "https://registry.npmjs.org/bcryptjs/-/bcryptjs-2.4.3.tgz",
+      "integrity": "sha512-V/Hy/X9Vt7f3BbPJEi8BdVFMByHi+jNXrYkW3huaybV/kQ0KJg0Y6PkEMbn+zeT+i+SiKZ/HMqJGIIt4LZDqNQ==",
+      "license": "MIT"
+    },
+    "node_modules/binary-extensions": {
+      "version": "2.3.0",
+      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
+      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/bn.js": {
+      "version": "4.12.3",
+      "resolved": "https://registry.npmjs.org/bn.js/-/bn.js-4.12.3.tgz",
+      "integrity": "sha512-fGTi3gxV/23FTYdAoUtLYp6qySe2KE3teyZitipKNRuVYcBkoP/bB3guXN/XVKUe9mxCHXnc9C4ocyz8OmgN0g==",
+      "license": "MIT"
+    },
+    "node_modules/body-parser": {
+      "version": "1.20.4",
+      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.4.tgz",
+      "integrity": "sha512-ZTgYYLMOXY9qKU/57FAo8F+HA2dGX7bqGc71txDRC1rS4frdFI5R7NhluHxH6M0YItAP0sHB4uqAOcYKxO6uGA==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "~3.1.2",
+        "content-type": "~1.0.5",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "destroy": "~1.2.0",
+        "http-errors": "~2.0.1",
+        "iconv-lite": "~0.4.24",
+        "on-finished": "~2.4.1",
+        "qs": "~6.14.0",
+        "raw-body": "~2.5.3",
+        "type-is": "~1.6.18",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/brace-expansion": {
+      "version": "5.0.3",
+      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-5.0.3.tgz",
+      "integrity": "sha512-fy6KJm2RawA5RcHkLa1z/ScpBeA762UF9KmZQxwIbDtRJrgLzM10depAiEQ+CXYcoiqW1/m96OAAoke2nE9EeA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "balanced-match": "^4.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/braces": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
+      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "fill-range": "^7.1.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/buffer-equal-constant-time": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
+      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/buffer-from": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
+      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
+      "license": "MIT"
+    },
+    "node_modules/busboy": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
+      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
+      "dependencies": {
+        "streamsearch": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=10.16.0"
+      }
+    },
+    "node_modules/bytes": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
+      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/call-bind-apply-helpers": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
+      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/call-bound": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
+      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "get-intrinsic": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/chokidar": {
+      "version": "3.6.0",
+      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
+      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "anymatch": "~3.1.2",
+        "braces": "~3.0.2",
+        "glob-parent": "~5.1.2",
+        "is-binary-path": "~2.1.0",
+        "is-glob": "~4.0.1",
+        "normalize-path": "~3.0.0",
+        "readdirp": "~3.6.0"
+      },
+      "engines": {
+        "node": ">= 8.10.0"
+      },
+      "funding": {
+        "url": "https://paulmillr.com/funding/"
+      },
+      "optionalDependencies": {
+        "fsevents": "~2.3.2"
+      }
+    },
+    "node_modules/color": {
+      "version": "5.0.3",
+      "resolved": "https://registry.npmjs.org/color/-/color-5.0.3.tgz",
+      "integrity": "sha512-ezmVcLR3xAVp8kYOm4GS45ZLLgIE6SPAFoduLr6hTDajwb3KZ2F46gulK3XpcwRFb5KKGCSezCBAY4Dw4HsyXA==",
+      "license": "MIT",
+      "dependencies": {
+        "color-convert": "^3.1.3",
+        "color-string": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/color-convert": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-3.1.3.tgz",
+      "integrity": "sha512-fasDH2ont2GqF5HpyO4w0+BcewlhHEZOFn9c1ckZdHpJ56Qb7MHhH/IcJZbBGgvdtwdwNbLvxiBEdg336iA9Sg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=14.6"
+      }
+    },
+    "node_modules/color-name": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-2.1.0.tgz",
+      "integrity": "sha512-1bPaDNFm0axzE4MEAzKPuqKWeRaT43U/hyxKPBdqTfmPF+d6n7FSoTFxLVULUJOmiLp01KjhIPPH+HrXZJN4Rg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=12.20"
+      }
+    },
+    "node_modules/color-string": {
+      "version": "2.1.4",
+      "resolved": "https://registry.npmjs.org/color-string/-/color-string-2.1.4.tgz",
+      "integrity": "sha512-Bb6Cq8oq0IjDOe8wJmi4JeNn763Xs9cfrBcaylK1tPypWzyoy2G3l90v9k64kjphl/ZJjPIShFztenRomi8WTg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/combined-stream": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
+      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
+      "license": "MIT",
+      "dependencies": {
+        "delayed-stream": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/concat-stream": {
+      "version": "1.6.2",
+      "resolved": "https://registry.npmjs.org/concat-stream/-/concat-stream-1.6.2.tgz",
+      "integrity": "sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==",
+      "engines": [
+        "node >= 0.8"
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "buffer-from": "^1.0.0",
+        "inherits": "^2.0.3",
+        "readable-stream": "^2.2.2",
+        "typedarray": "^0.0.6"
+      }
+    },
+    "node_modules/content-disposition": {
+      "version": "0.5.4",
+      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
+      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "5.2.1"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/content-type": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
+      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/cookie": {
+      "version": "0.7.2",
+      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
+      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/cookie-parser": {
+      "version": "1.4.7",
+      "resolved": "https://registry.npmjs.org/cookie-parser/-/cookie-parser-1.4.7.tgz",
+      "integrity": "sha512-nGUvgXnotP3BsjiLX2ypbQnWoGUPIIfHQNZkkC668ntrzGWEZVW70HDEB1qnNGMicPje6EttlIgzo51YSwNQGw==",
+      "license": "MIT",
+      "dependencies": {
+        "cookie": "0.7.2",
+        "cookie-signature": "1.0.6"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/cookie-signature": {
+      "version": "1.0.6",
+      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.6.tgz",
+      "integrity": "sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==",
+      "license": "MIT"
+    },
+    "node_modules/core-util-is": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/core-util-is/-/core-util-is-1.0.3.tgz",
+      "integrity": "sha512-ZQBvi1DcpJ4GDqanjucZ2Hj3wEO5pZDS89BWbkcrvdxksJorwUDDZamX9ldFkp9aw2lmBDLgkObEA4DWNJ9FYQ==",
+      "license": "MIT"
+    },
+    "node_modules/cors": {
+      "version": "2.8.6",
+      "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.6.tgz",
+      "integrity": "sha512-tJtZBBHA6vjIAaF6EnIaq6laBBP9aq/Y3ouVJjEfoHbRBcHBAHYcMh/w8LDrk2PvIMMq8gmopa5D4V8RmbrxGw==",
+      "license": "MIT",
+      "dependencies": {
+        "object-assign": "^4",
+        "vary": "^1"
+      },
+      "engines": {
+        "node": ">= 0.10"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/dayjs": {
+      "version": "1.11.19",
+      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
+      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
+      "license": "MIT"
+    },
+    "node_modules/debug": {
+      "version": "2.6.9",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
+      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "2.0.0"
+      }
+    },
+    "node_modules/deepmerge": {
+      "version": "4.3.1",
+      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
+      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/delayed-stream": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
+      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.4.0"
+      }
+    },
+    "node_modules/depd": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
+      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/destroy": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
+      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/dotenv": {
+      "version": "16.6.1",
+      "resolved": "https://registry.npmjs.org/dotenv/-/dotenv-16.6.1.tgz",
+      "integrity": "sha512-uBq4egWHTcTt33a72vpSG0z3HnPuIl6NqYcTrKEg2azoEyl2hpW0zqlxysq2pK9HlDIHyHyakeYaYnSAwd8bow==",
+      "license": "BSD-2-Clause",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://dotenvx.com"
+      }
+    },
+    "node_modules/dunder-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
+      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "gopd": "^1.2.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/ecdsa-sig-formatter": {
+      "version": "1.0.11",
+      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
+      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
+      "license": "Apache-2.0",
+      "dependencies": {
+        "safe-buffer": "^5.0.1"
+      }
+    },
+    "node_modules/ee-first": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
+      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
+      "license": "MIT"
+    },
+    "node_modules/enabled": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/enabled/-/enabled-2.0.0.tgz",
+      "integrity": "sha512-AKrN98kuwOzMIdAizXGI86UFBoo26CL21UM763y1h/GMSJ4/OHU9k2YlsmBpyScFo/wbLzWQJBMCW4+IO3/+OQ==",
+      "license": "MIT"
+    },
+    "node_modules/encodeurl": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
+      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/engine.io": {
+      "version": "6.6.5",
+      "resolved": "https://registry.npmjs.org/engine.io/-/engine.io-6.6.5.tgz",
+      "integrity": "sha512-2RZdgEbXmp5+dVbRm0P7HQUImZpICccJy7rN7Tv+SFa55pH+lxnuw6/K1ZxxBfHoYpSkHLAO92oa8O4SwFXA2A==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/cors": "^2.8.12",
+        "@types/node": ">=10.0.0",
+        "accepts": "~1.3.4",
+        "base64id": "2.0.0",
+        "cookie": "~0.7.2",
+        "cors": "~2.8.5",
+        "debug": "~4.4.1",
+        "engine.io-parser": "~5.2.1",
+        "ws": "~8.18.3"
+      },
+      "engines": {
+        "node": ">=10.2.0"
+      }
+    },
+    "node_modules/engine.io-parser": {
+      "version": "5.2.3",
+      "resolved": "https://registry.npmjs.org/engine.io-parser/-/engine.io-parser-5.2.3.tgz",
+      "integrity": "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/engine.io/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/engine.io/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/es-define-property": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
+      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-errors": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
+      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-object-atoms": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
+      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-set-tostringtag": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
+      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.6",
+        "has-tostringtag": "^1.0.2",
+        "hasown": "^2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/escape-html": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
+      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
+      "license": "MIT"
+    },
+    "node_modules/etag": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
+      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/express": {
+      "version": "4.22.1",
+      "resolved": "https://registry.npmjs.org/express/-/express-4.22.1.tgz",
+      "integrity": "sha512-F2X8g9P1X7uCPZMA3MVf9wcTqlyNp7IhH5qPCI0izhaOIYXaW9L535tGA3qmjRzpH+bZczqq7hVKxTR4NWnu+g==",
+      "license": "MIT",
+      "dependencies": {
+        "accepts": "~1.3.8",
+        "array-flatten": "1.1.1",
+        "body-parser": "~1.20.3",
+        "content-disposition": "~0.5.4",
+        "content-type": "~1.0.4",
+        "cookie": "~0.7.1",
+        "cookie-signature": "~1.0.6",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "etag": "~1.8.1",
+        "finalhandler": "~1.3.1",
+        "fresh": "~0.5.2",
+        "http-errors": "~2.0.0",
+        "merge-descriptors": "1.0.3",
+        "methods": "~1.1.2",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "path-to-regexp": "~0.1.12",
+        "proxy-addr": "~2.0.7",
+        "qs": "~6.14.0",
+        "range-parser": "~1.2.1",
+        "safe-buffer": "5.2.1",
+        "send": "~0.19.0",
+        "serve-static": "~1.16.2",
+        "setprototypeof": "1.2.0",
+        "statuses": "~2.0.1",
+        "type-is": "~1.6.18",
+        "utils-merge": "1.0.1",
+        "vary": "~1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.10.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/express-rate-limit": {
+      "version": "7.5.1",
+      "resolved": "https://registry.npmjs.org/express-rate-limit/-/express-rate-limit-7.5.1.tgz",
+      "integrity": "sha512-7iN8iPMDzOMHPUYllBEsQdWVB6fPDMPqwjBaFrgr4Jgr/+okjvzAy+UHlYYL/Vs0OsOrMkwS6PJDkFlJwoxUnw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 16"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/express-rate-limit"
+      },
+      "peerDependencies": {
+        "express": ">= 4.11"
+      }
+    },
+    "node_modules/fecha": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/fecha/-/fecha-4.2.3.tgz",
+      "integrity": "sha512-OP2IUU6HeYKJi3i0z4A19kHMQoLVs4Hc+DPqqxI2h/DPZHTm/vjsfC6P0b4jCMy14XizLBqvndQ+UilD7707Jw==",
+      "license": "MIT"
+    },
+    "node_modules/fill-range": {
+      "version": "7.1.1",
+      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
+      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "to-regex-range": "^5.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/finalhandler": {
+      "version": "1.3.2",
+      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.2.tgz",
+      "integrity": "sha512-aA4RyPcd3badbdABGDuTXCMTtOneUCAYH/gxoYRTZlIJdF0YPWuGqiAsIrhNnnqdXGswYk6dGujem4w80UJFhg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "2.6.9",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "statuses": "~2.0.2",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/fn.name": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/fn.name/-/fn.name-1.1.0.tgz",
+      "integrity": "sha512-GRnmB5gPyJpAhTQdSZTSp9uaPSvl09KoYcMQtsB9rQoOmzs9dH6ffeccH+Z+cv6P68Hu5bC6JjRh4Ah/mHSNRw==",
+      "license": "MIT"
+    },
+    "node_modules/follow-redirects": {
+      "version": "1.15.11",
+      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
+      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
+      "funding": [
+        {
+          "type": "individual",
+          "url": "https://github.com/sponsors/RubenVerborgh"
+        }
+      ],
+      "license": "MIT",
+      "engines": {
+        "node": ">=4.0"
+      },
+      "peerDependenciesMeta": {
+        "debug": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/form-data": {
+      "version": "4.0.5",
+      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
+      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
+      "license": "MIT",
+      "dependencies": {
+        "asynckit": "^0.4.0",
+        "combined-stream": "^1.0.8",
+        "es-set-tostringtag": "^2.1.0",
+        "hasown": "^2.0.2",
+        "mime-types": "^2.1.12"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/forwarded": {
+      "version": "0.2.0",
+      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
+      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/fresh": {
+      "version": "0.5.2",
+      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
+      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/fsevents": {
+      "version": "2.3.3",
+      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
+      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
+      "dev": true,
+      "hasInstallScript": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
+      }
+    },
+    "node_modules/function-bind": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
+      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-intrinsic": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
+      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "es-define-property": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "es-object-atoms": "^1.1.1",
+        "function-bind": "^1.1.2",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "has-symbols": "^1.1.0",
+        "hasown": "^2.0.2",
+        "math-intrinsics": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
+      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
+      "license": "MIT",
+      "dependencies": {
+        "dunder-proto": "^1.0.1",
+        "es-object-atoms": "^1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/glob-parent": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
+      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "is-glob": "^4.0.1"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/gopd": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
+      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-flag": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-3.0.0.tgz",
+      "integrity": "sha512-sKJf1+ceQBr4SMkvQnBDNDtf4TXpVhVGateu0t918bl30FnbE2m4vNLX+VWe/dpjlb+HugGYzW7uQXH98HPEYw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/has-symbols": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
+      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-tostringtag": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
+      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
+      "license": "MIT",
+      "dependencies": {
+        "has-symbols": "^1.0.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/hasown": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
+      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/helmet": {
+      "version": "7.2.0",
+      "resolved": "https://registry.npmjs.org/helmet/-/helmet-7.2.0.tgz",
+      "integrity": "sha512-ZRiwvN089JfMXokizgqEPXsl2Guk094yExfoDXR0cBYWxtBbaSww/w+vT4WEJsBW2iTUi1GgZ6swmoug3Oy4Xw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/http_ece": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/http_ece/-/http_ece-1.2.0.tgz",
+      "integrity": "sha512-JrF8SSLVmcvc5NducxgyOrKXe3EsyHMgBFgSaIUGmArKe+rwr0uphRkRXvwiom3I+fpIfoItveHrfudL8/rxuA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=16"
+      }
+    },
+    "node_modules/http-errors": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.1.tgz",
+      "integrity": "sha512-4FbRdAX+bSdmo4AUFuS0WNiPz8NgFt+r8ThgNWmlrjQjt1Q7ZR9+zTlce2859x4KSXrwIsaeTqDoKQmtP8pLmQ==",
+      "license": "MIT",
+      "dependencies": {
+        "depd": "~2.0.0",
+        "inherits": "~2.0.4",
+        "setprototypeof": "~1.2.0",
+        "statuses": "~2.0.2",
+        "toidentifier": "~1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/https-proxy-agent": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
+      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
+      "license": "MIT",
+      "dependencies": {
+        "agent-base": "6",
+        "debug": "4"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/https-proxy-agent/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/https-proxy-agent/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/iconv-lite": {
+      "version": "0.4.24",
+      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
+      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
+      "license": "MIT",
+      "dependencies": {
+        "safer-buffer": ">= 2.1.2 < 3"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/ignore-by-default": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/ignore-by-default/-/ignore-by-default-1.0.1.tgz",
+      "integrity": "sha512-Ius2VYcGNk7T90CppJqcIkS5ooHUZyIQK+ClZfMfMNFEF9VSE73Fq+906u/CWu92x4gzZMWOwfFYckPObzdEbA==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/inherits": {
+      "version": "2.0.4",
+      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
+      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
+      "license": "ISC"
+    },
+    "node_modules/ipaddr.js": {
+      "version": "1.9.1",
+      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
+      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/is-binary-path": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
+      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "binary-extensions": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/is-extglob": {
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
+      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/is-glob": {
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
+      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "is-extglob": "^2.1.1"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/is-number": {
+      "version": "7.0.0",
+      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
+      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.12.0"
+      }
+    },
+    "node_modules/is-stream": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
+      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/isarray": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/isarray/-/isarray-1.0.0.tgz",
+      "integrity": "sha512-VLghIWNM6ELQzo7zwmcg0NmTVyWKYjvIeM83yjp0wRDTmUnrM678fQbcKBo6n2CJEF0szoG//ytg+TKla89ALQ==",
+      "license": "MIT"
+    },
+    "node_modules/jsonwebtoken": {
+      "version": "9.0.3",
+      "resolved": "https://registry.npmjs.org/jsonwebtoken/-/jsonwebtoken-9.0.3.tgz",
+      "integrity": "sha512-MT/xP0CrubFRNLNKvxJ2BYfy53Zkm++5bX9dtuPbqAeQpTVe0MQTFhao8+Cp//EmJp244xt6Drw/GVEGCUj40g==",
+      "license": "MIT",
+      "dependencies": {
+        "jws": "^4.0.1",
+        "lodash.includes": "^4.3.0",
+        "lodash.isboolean": "^3.0.3",
+        "lodash.isinteger": "^4.0.4",
+        "lodash.isnumber": "^3.0.3",
+        "lodash.isplainobject": "^4.0.6",
+        "lodash.isstring": "^4.0.1",
+        "lodash.once": "^4.0.0",
+        "ms": "^2.1.1",
+        "semver": "^7.5.4"
+      },
+      "engines": {
+        "node": ">=12",
+        "npm": ">=6"
+      }
+    },
+    "node_modules/jsonwebtoken/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/jwa": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/jwa/-/jwa-2.0.1.tgz",
+      "integrity": "sha512-hRF04fqJIP8Abbkq5NKGN0Bbr3JxlQ+qhZufXVr0DvujKy93ZCbXZMHDL4EOtodSbCWxOqR8MS1tXA5hwqCXDg==",
+      "license": "MIT",
+      "dependencies": {
+        "buffer-equal-constant-time": "^1.0.1",
+        "ecdsa-sig-formatter": "1.0.11",
+        "safe-buffer": "^5.0.1"
+      }
+    },
+    "node_modules/jws": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/jws/-/jws-4.0.1.tgz",
+      "integrity": "sha512-EKI/M/yqPncGUUh44xz0PxSidXFr/+r0pA70+gIYhjv+et7yxM+s29Y+VGDkovRofQem0fs7Uvf4+YmAdyRduA==",
+      "license": "MIT",
+      "dependencies": {
+        "jwa": "^2.0.1",
+        "safe-buffer": "^5.0.1"
+      }
+    },
+    "node_modules/kuler": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/kuler/-/kuler-2.0.0.tgz",
+      "integrity": "sha512-Xq9nH7KlWZmXAtodXDDRE7vs6DU1gTU8zYDHDiWLSip45Egwq3plLHzPn27NgvzL2r1LMPC1vdqh98sQxtqj4A==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.includes": {
+      "version": "4.3.0",
+      "resolved": "https://registry.npmjs.org/lodash.includes/-/lodash.includes-4.3.0.tgz",
+      "integrity": "sha512-W3Bx6mdkRTGtlJISOvVD/lbqjTlPPUDTMnlXZFnVwi9NKJ6tiAk6LVdlhZMm17VZisqhKcgzpO5Wz91PCt5b0w==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.isboolean": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/lodash.isboolean/-/lodash.isboolean-3.0.3.tgz",
+      "integrity": "sha512-Bz5mupy2SVbPHURB98VAcw+aHh4vRV5IPNhILUCsOzRmsTmSQ17jIuqopAentWoehktxGd9e/hbIXq980/1QJg==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.isinteger": {
+      "version": "4.0.4",
+      "resolved": "https://registry.npmjs.org/lodash.isinteger/-/lodash.isinteger-4.0.4.tgz",
+      "integrity": "sha512-DBwtEWN2caHQ9/imiNeEA5ys1JoRtRfY3d7V9wkqtbycnAmTvRRmbHKDV4a0EYc678/dia0jrte4tjYwVBaZUA==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.isnumber": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/lodash.isnumber/-/lodash.isnumber-3.0.3.tgz",
+      "integrity": "sha512-QYqzpfwO3/CWf3XP+Z+tkQsfaLL/EnUlXWVkIk5FUPc4sBdTehEqZONuyRt2P67PXAk+NXmTBcc97zw9t1FQrw==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.isplainobject": {
+      "version": "4.0.6",
+      "resolved": "https://registry.npmjs.org/lodash.isplainobject/-/lodash.isplainobject-4.0.6.tgz",
+      "integrity": "sha512-oSXzaWypCMHkPC3NvBEaPHf0KsA5mvPrOPgQWDsbg8n7orZ290M0BmC/jgRZ4vcJ6DTAhjrsSYgdsW/F+MFOBA==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.isstring": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/lodash.isstring/-/lodash.isstring-4.0.1.tgz",
+      "integrity": "sha512-0wJxfxH1wgO3GrbuP+dTTk7op+6L41QCXbGINEmD+ny/G/eCqGzxyCsh7159S+mgDDcoarnBw6PC1PS5+wUGgw==",
+      "license": "MIT"
+    },
+    "node_modules/lodash.once": {
+      "version": "4.1.1",
+      "resolved": "https://registry.npmjs.org/lodash.once/-/lodash.once-4.1.1.tgz",
+      "integrity": "sha512-Sb487aTOCr9drQVL8pIxOzVhafOjZN9UU54hiN8PU3uAiSV7lx1yYNpbNmex2PK6dSJoNTSJUUswT651yww3Mg==",
+      "license": "MIT"
+    },
+    "node_modules/logform": {
+      "version": "2.7.0",
+      "resolved": "https://registry.npmjs.org/logform/-/logform-2.7.0.tgz",
+      "integrity": "sha512-TFYA4jnP7PVbmlBIfhlSe+WKxs9dklXMTEGcBCIvLhE/Tn3H6Gk1norupVW7m5Cnd4bLcr08AytbyV/xj7f/kQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@colors/colors": "1.6.0",
+        "@types/triple-beam": "^1.3.2",
+        "fecha": "^4.2.0",
+        "ms": "^2.1.1",
+        "safe-stable-stringify": "^2.3.1",
+        "triple-beam": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 12.0.0"
+      }
+    },
+    "node_modules/logform/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/math-intrinsics": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
+      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/media-typer": {
+      "version": "0.3.0",
+      "resolved": "https://registry.npmjs.org/media-typer/-/media-typer-0.3.0.tgz",
+      "integrity": "sha512-dq+qelQ9akHpcOl/gUVRTxVIOkAJ1wR3QAvb4RsVjS8oVoFjDGTc679wJYmUmknUF5HwMLOgb5O+a3KxfWapPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/merge-descriptors": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/merge-descriptors/-/merge-descriptors-1.0.3.tgz",
+      "integrity": "sha512-gaNvAS7TZ897/rVaZ0nMtAyxNyi/pdbjbAwUpFQpN70GqnVfOiXpeUUMKRBmzXaSQ8DdTX4/0ms62r2K+hE6mQ==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/methods": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
+      "integrity": "sha512-iclAHeNqNm68zFtnZ0e+1L2yUIdvzNoauKU4WBA3VvH/vPFieF7qfRlwUZU+DA9P9bPXIS90ulxoUoCH23sV2w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/mime": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/mime/-/mime-1.6.0.tgz",
+      "integrity": "sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==",
+      "license": "MIT",
+      "bin": {
+        "mime": "cli.js"
+      },
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/mime-db": {
+      "version": "1.52.0",
+      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
+      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/mime-types": {
+      "version": "2.1.35",
+      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
+      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-db": "1.52.0"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/minimalistic-assert": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/minimalistic-assert/-/minimalistic-assert-1.0.1.tgz",
+      "integrity": "sha512-UtJcAD4yEaGtjPezWuO9wC4nwUnVH/8/Im3yEHQP4b67cXlD/Qr9hdITCU1xDbSEXg2XKNaP8jsReV7vQd00/A==",
+      "license": "ISC"
+    },
+    "node_modules/minimatch": {
+      "version": "10.2.2",
+      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-10.2.2.tgz",
+      "integrity": "sha512-+G4CpNBxa5MprY+04MbgOw1v7So6n5JY166pFi9KfYwT78fxScCeSNQSNzp6dpPSW2rONOps6Ocam1wFhCgoVw==",
+      "dev": true,
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "brace-expansion": "^5.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/minimist": {
+      "version": "1.2.8",
+      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
+      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/mkdirp": {
+      "version": "0.5.6",
+      "resolved": "https://registry.npmjs.org/mkdirp/-/mkdirp-0.5.6.tgz",
+      "integrity": "sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==",
+      "license": "MIT",
+      "dependencies": {
+        "minimist": "^1.2.6"
+      },
+      "bin": {
+        "mkdirp": "bin/cmd.js"
+      }
+    },
+    "node_modules/ms": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.0.0.tgz",
+      "integrity": "sha512-Tpp60P6IUJDTuOq/5Z8cdskzJujfwqfOTkrwIwj7IRISpnkJnT6SyJ4PCPnGMoFjC9ddhal5KVIYtAt97ix05A==",
+      "license": "MIT"
+    },
+    "node_modules/multer": {
+      "version": "1.4.5-lts.2",
+      "resolved": "https://registry.npmjs.org/multer/-/multer-1.4.5-lts.2.tgz",
+      "integrity": "sha512-VzGiVigcG9zUAoCNU+xShztrlr1auZOlurXynNvO9GiWD1/mTBbUljOKY+qMeazBqXgRnjzeEgJI/wyjJUHg9A==",
+      "deprecated": "Multer 1.x is impacted by a number of vulnerabilities, which have been patched in 2.x. You should upgrade to the latest 2.x version.",
+      "license": "MIT",
+      "dependencies": {
+        "append-field": "^1.0.0",
+        "busboy": "^1.0.0",
+        "concat-stream": "^1.5.2",
+        "mkdirp": "^0.5.4",
+        "object-assign": "^4.1.1",
+        "type-is": "^1.6.4",
+        "xtend": "^4.0.0"
+      },
+      "engines": {
+        "node": ">= 6.0.0"
+      }
+    },
+    "node_modules/negotiator": {
+      "version": "0.6.3",
+      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
+      "integrity": "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/nodemailer": {
+      "version": "6.10.1",
+      "resolved": "https://registry.npmjs.org/nodemailer/-/nodemailer-6.10.1.tgz",
+      "integrity": "sha512-Z+iLaBGVaSjbIzQ4pX6XV41HrooLsQ10ZWPUehGmuantvzWoDVBnmsdUcOIDM1t+yPor5pDhVlDESgOMEGxhHA==",
+      "license": "MIT-0",
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/nodemon": {
+      "version": "3.1.14",
+      "resolved": "https://registry.npmjs.org/nodemon/-/nodemon-3.1.14.tgz",
+      "integrity": "sha512-jakjZi93UtB3jHMWsXL68FXSAosbLfY0In5gtKq3niLSkrWznrVBzXFNOEMJUfc9+Ke7SHWoAZsiMkNP3vq6Jw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "chokidar": "^3.5.2",
+        "debug": "^4",
+        "ignore-by-default": "^1.0.1",
+        "minimatch": "^10.2.1",
+        "pstree.remy": "^1.1.8",
+        "semver": "^7.5.3",
+        "simple-update-notifier": "^2.0.0",
+        "supports-color": "^5.5.0",
+        "touch": "^3.1.0",
+        "undefsafe": "^2.0.5"
+      },
+      "bin": {
+        "nodemon": "bin/nodemon.js"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/nodemon"
+      }
+    },
+    "node_modules/nodemon/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/nodemon/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/normalize-path": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
+      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/object-assign": {
+      "version": "4.1.1",
+      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
+      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/object-inspect": {
+      "version": "1.13.4",
+      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
+      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/on-finished": {
+      "version": "2.4.1",
+      "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.4.1.tgz",
+      "integrity": "sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg==",
+      "license": "MIT",
+      "dependencies": {
+        "ee-first": "1.1.1"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/one-time": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/one-time/-/one-time-1.0.0.tgz",
+      "integrity": "sha512-5DXOiRKwuSEcQ/l0kGCF6Q3jcADFv5tSmRaJck/OqkVFcOzutB134KRSfF0xDrL39MNnqxbHBbUUcjZIhTgb2g==",
+      "license": "MIT",
+      "dependencies": {
+        "fn.name": "1.x.x"
+      }
+    },
+    "node_modules/parseurl": {
+      "version": "1.3.3",
+      "resolved": "https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz",
+      "integrity": "sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/path-to-regexp": {
+      "version": "0.1.12",
+      "resolved": "https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.12.tgz",
+      "integrity": "sha512-RA1GjUVMnvYFxuqovrEqZoxxW5NUZqbwKtYz/Tt7nXerk0LbLblQmrsgdeOxV5SFHf0UDggjS/bSeOZwt1pmEQ==",
+      "license": "MIT"
+    },
+    "node_modules/picomatch": {
+      "version": "2.3.1",
+      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
+      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8.6"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/jonschlinkert"
+      }
+    },
+    "node_modules/prisma": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/prisma/-/prisma-5.22.0.tgz",
+      "integrity": "sha512-vtpjW3XuYCSnMsNVBjLMNkTj6OZbudcPPTPYHqX0CJfpcdWciI1dM8uHETwmDxxiqEwCIE6WvXucWUetJgfu/A==",
+      "devOptional": true,
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/engines": "5.22.0"
+      },
+      "bin": {
+        "prisma": "build/index.js"
+      },
+      "engines": {
+        "node": ">=16.13"
+      },
+      "optionalDependencies": {
+        "fsevents": "2.3.3"
+      }
+    },
+    "node_modules/process-nextick-args": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/process-nextick-args/-/process-nextick-args-2.0.1.tgz",
+      "integrity": "sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==",
+      "license": "MIT"
+    },
+    "node_modules/proxy-addr": {
+      "version": "2.0.7",
+      "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
+      "integrity": "sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg==",
+      "license": "MIT",
+      "dependencies": {
+        "forwarded": "0.2.0",
+        "ipaddr.js": "1.9.1"
+      },
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/proxy-from-env": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
+      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
+      "license": "MIT"
+    },
+    "node_modules/pstree.remy": {
+      "version": "1.1.8",
+      "resolved": "https://registry.npmjs.org/pstree.remy/-/pstree.remy-1.1.8.tgz",
+      "integrity": "sha512-77DZwxQmxKnu3aR542U+X8FypNzbfJ+C5XQDk3uWjWxn6151aIMGthWYRXTqT1E5oJvg+ljaa2OJi+VfvCOQ8w==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/qs": {
+      "version": "6.14.2",
+      "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.2.tgz",
+      "integrity": "sha512-V/yCWTTF7VJ9hIh18Ugr2zhJMP01MY7c5kh4J870L7imm6/DIzBsNLTXzMwUA3yZ5b/KBqLx8Kp3uRvd7xSe3Q==",
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "side-channel": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=0.6"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/range-parser": {
+      "version": "1.2.1",
+      "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
+      "integrity": "sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/raw-body": {
+      "version": "2.5.3",
+      "resolved": "https://registry.npmjs.org/raw-body/-/raw-body-2.5.3.tgz",
+      "integrity": "sha512-s4VSOf6yN0rvbRZGxs8Om5CWj6seneMwK3oDb4lWDH0UPhWcxwOWw5+qk24bxq87szX1ydrwylIOp2uG1ojUpA==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "~3.1.2",
+        "http-errors": "~2.0.1",
+        "iconv-lite": "~0.4.24",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/readable-stream": {
+      "version": "2.3.8",
+      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-2.3.8.tgz",
+      "integrity": "sha512-8p0AUk4XODgIewSi0l8Epjs+EVnWiK7NoDIEGU0HhE7+ZyY8D1IMY7odu5lRrFXGg71L15KG8QrPmum45RTtdA==",
+      "license": "MIT",
+      "dependencies": {
+        "core-util-is": "~1.0.0",
+        "inherits": "~2.0.3",
+        "isarray": "~1.0.0",
+        "process-nextick-args": "~2.0.0",
+        "safe-buffer": "~5.1.1",
+        "string_decoder": "~1.1.1",
+        "util-deprecate": "~1.0.1"
+      }
+    },
+    "node_modules/readable-stream/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/readdirp": {
+      "version": "3.6.0",
+      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
+      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "picomatch": "^2.2.1"
+      },
+      "engines": {
+        "node": ">=8.10.0"
+      }
+    },
+    "node_modules/safe-buffer": {
+      "version": "5.2.1",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
+      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/feross"
+        },
+        {
+          "type": "patreon",
+          "url": "https://www.patreon.com/feross"
+        },
+        {
+          "type": "consulting",
+          "url": "https://feross.org/support"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/safe-stable-stringify": {
+      "version": "2.5.0",
+      "resolved": "https://registry.npmjs.org/safe-stable-stringify/-/safe-stable-stringify-2.5.0.tgz",
+      "integrity": "sha512-b3rppTKm9T+PsVCBEOUR46GWI7fdOs00VKZ1+9c1EWDaDMvjQc6tUwuFyIprgGgTcWoVHSKrU8H31ZHA2e0RHA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/safer-buffer": {
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
+      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
+      "license": "MIT"
+    },
+    "node_modules/scmp": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/scmp/-/scmp-2.1.0.tgz",
+      "integrity": "sha512-o/mRQGk9Rcer/jEEw/yw4mwo3EU/NvYvp577/Btqrym9Qy5/MdWGBqipbALgd2lrdWTJ5/gqDusxfnQBxOxT2Q==",
+      "deprecated": "Just use Node.js's crypto.timingSafeEqual()",
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/semver": {
+      "version": "7.7.4",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.4.tgz",
+      "integrity": "sha512-vFKC2IEtQnVhpT78h1Yp8wzwrf8CM+MzKMHGJZfBtzhZNycRFnXsHk6E5TxIkkMsgNS7mdX3AGB7x2QM2di4lA==",
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/send": {
+      "version": "0.19.2",
+      "resolved": "https://registry.npmjs.org/send/-/send-0.19.2.tgz",
+      "integrity": "sha512-VMbMxbDeehAxpOtWJXlcUS5E8iXh6QmN+BkRX1GARS3wRaXEEgzCcB10gTQazO42tpNIya8xIyNx8fll1OFPrg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "destroy": "1.2.0",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "etag": "~1.8.1",
+        "fresh": "~0.5.2",
+        "http-errors": "~2.0.1",
+        "mime": "1.6.0",
+        "ms": "2.1.3",
+        "on-finished": "~2.4.1",
+        "range-parser": "~1.2.1",
+        "statuses": "~2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/send/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/serve-static": {
+      "version": "1.16.3",
+      "resolved": "https://registry.npmjs.org/serve-static/-/serve-static-1.16.3.tgz",
+      "integrity": "sha512-x0RTqQel6g5SY7Lg6ZreMmsOzncHFU7nhnRWkKgWuMTu5NN0DR5oruckMqRvacAN9d5w6ARnRBXl9xhDCgfMeA==",
+      "license": "MIT",
+      "dependencies": {
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "parseurl": "~1.3.3",
+        "send": "~0.19.1"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/setprototypeof": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz",
+      "integrity": "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==",
+      "license": "ISC"
+    },
+    "node_modules/side-channel": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
+      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "object-inspect": "^1.13.3",
+        "side-channel-list": "^1.0.0",
+        "side-channel-map": "^1.0.1",
+        "side-channel-weakmap": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-list": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
+      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "object-inspect": "^1.13.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-map": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
+      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.5",
+        "object-inspect": "^1.13.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/side-channel-weakmap": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
+      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.5",
+        "object-inspect": "^1.13.3",
+        "side-channel-map": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/simple-update-notifier": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/simple-update-notifier/-/simple-update-notifier-2.0.0.tgz",
+      "integrity": "sha512-a2B9Y0KlNXl9u/vsW6sTIu9vGEpfKu2wRV6l1H3XEas/0gUIzGzBoP/IouTcUQbm9JWZLH3COxyn03TYlFax6w==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "semver": "^7.5.3"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/socket.io": {
+      "version": "4.8.3",
+      "resolved": "https://registry.npmjs.org/socket.io/-/socket.io-4.8.3.tgz",
+      "integrity": "sha512-2Dd78bqzzjE6KPkD5fHZmDAKRNe3J15q+YHDrIsy9WEkqttc7GY+kT9OBLSMaPbQaEd0x1BjcmtMtXkfpc+T5A==",
+      "license": "MIT",
+      "dependencies": {
+        "accepts": "~1.3.4",
+        "base64id": "~2.0.0",
+        "cors": "~2.8.5",
+        "debug": "~4.4.1",
+        "engine.io": "~6.6.0",
+        "socket.io-adapter": "~2.5.2",
+        "socket.io-parser": "~4.2.4"
+      },
+      "engines": {
+        "node": ">=10.2.0"
+      }
+    },
+    "node_modules/socket.io-adapter": {
+      "version": "2.5.6",
+      "resolved": "https://registry.npmjs.org/socket.io-adapter/-/socket.io-adapter-2.5.6.tgz",
+      "integrity": "sha512-DkkO/dz7MGln0dHn5bmN3pPy+JmywNICWrJqVWiVOyvXjWQFIv9c2h24JrQLLFJ2aQVQf/Cvl1vblnd4r2apLQ==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "~4.4.1",
+        "ws": "~8.18.3"
+      }
+    },
+    "node_modules/socket.io-adapter/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/socket.io-adapter/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/socket.io-parser": {
+      "version": "4.2.5",
+      "resolved": "https://registry.npmjs.org/socket.io-parser/-/socket.io-parser-4.2.5.tgz",
+      "integrity": "sha512-bPMmpy/5WWKHea5Y/jYAP6k74A+hvmRCQaJuJB6I/ML5JZq/KfNieUVo/3Mh7SAqn7TyFdIo6wqYHInG1MU1bQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@socket.io/component-emitter": "~3.1.0",
+        "debug": "~4.4.1"
+      },
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/socket.io-parser/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/socket.io-parser/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/socket.io/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/socket.io/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/stack-trace": {
+      "version": "0.0.10",
+      "resolved": "https://registry.npmjs.org/stack-trace/-/stack-trace-0.0.10.tgz",
+      "integrity": "sha512-KGzahc7puUKkzyMt+IqAep+TVNbKP+k2Lmwhub39m1AsTSkaDutx56aDCo+HLDzf/D26BIHTJWNiTG1KAJiQCg==",
+      "license": "MIT",
+      "engines": {
+        "node": "*"
+      }
+    },
+    "node_modules/statuses": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.2.tgz",
+      "integrity": "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/streamsearch": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
+      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/string_decoder": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.1.1.tgz",
+      "integrity": "sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "~5.1.0"
+      }
+    },
+    "node_modules/string_decoder/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/stripe": {
+      "version": "14.25.0",
+      "resolved": "https://registry.npmjs.org/stripe/-/stripe-14.25.0.tgz",
+      "integrity": "sha512-wQS3GNMofCXwH8TSje8E1SE8zr6ODiGtHQgPtO95p9Mb4FhKC9jvXR2NUTpZ9ZINlckJcFidCmaTFV4P6vsb9g==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": ">=8.1.0",
+        "qs": "^6.11.0"
+      },
+      "engines": {
+        "node": ">=12.*"
+      }
+    },
+    "node_modules/supports-color": {
+      "version": "5.5.0",
+      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-5.5.0.tgz",
+      "integrity": "sha512-QjVjwdXIt408MIiAqCX4oUKsgU2EqAGzs2Ppkm4aQYbjm+ZEWEcW4SfFNTr4uMNZma0ey4f5lgLrkB0aX0QMow==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "has-flag": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/text-hex": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/text-hex/-/text-hex-1.0.0.tgz",
+      "integrity": "sha512-uuVGNWzgJ4yhRaNSiubPY7OjISw4sw4E5Uv0wbjp+OzcbmVU/rsT8ujgcXJhn9ypzsgr5vlzpPqP+MBBKcGvbg==",
+      "license": "MIT"
+    },
+    "node_modules/to-regex-range": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
+      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "is-number": "^7.0.0"
+      },
+      "engines": {
+        "node": ">=8.0"
+      }
+    },
+    "node_modules/toidentifier": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.1.tgz",
+      "integrity": "sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.6"
+      }
+    },
+    "node_modules/touch": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/touch/-/touch-3.1.1.tgz",
+      "integrity": "sha512-r0eojU4bI8MnHr8c5bNo7lJDdI2qXlWWJk6a9EAFG7vbhTjElYhBVS3/miuE0uOuoLdb8Mc/rVfsmm6eo5o9GA==",
+      "dev": true,
+      "license": "ISC",
+      "bin": {
+        "nodetouch": "bin/nodetouch.js"
+      }
+    },
+    "node_modules/triple-beam": {
+      "version": "1.4.1",
+      "resolved": "https://registry.npmjs.org/triple-beam/-/triple-beam-1.4.1.tgz",
+      "integrity": "sha512-aZbgViZrg1QNcG+LULa7nhZpJTZSLm/mXnHXnbAbjmN5aSa0y7V+wvv6+4WaBtpISJzThKy+PIPxc1Nq1EJ9mg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 14.0.0"
+      }
+    },
+    "node_modules/twilio": {
+      "version": "5.12.2",
+      "resolved": "https://registry.npmjs.org/twilio/-/twilio-5.12.2.tgz",
+      "integrity": "sha512-yjTH04Ig0Z3PAxIXhwrto0IJC4Gv7lBDQQ9f4/P9zJhnxVdd+3tENqBMJOtdmmRags3X0jl2IGKEQefCEpJE9g==",
+      "license": "MIT",
+      "dependencies": {
+        "axios": "^1.12.0",
+        "dayjs": "^1.11.9",
+        "https-proxy-agent": "^5.0.0",
+        "jsonwebtoken": "^9.0.2",
+        "qs": "^6.14.1",
+        "scmp": "^2.1.0",
+        "xmlbuilder": "^13.0.2"
+      },
+      "engines": {
+        "node": ">=14.0"
+      }
+    },
+    "node_modules/type-is": {
+      "version": "1.6.18",
+      "resolved": "https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz",
+      "integrity": "sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==",
+      "license": "MIT",
+      "dependencies": {
+        "media-typer": "0.3.0",
+        "mime-types": "~2.1.24"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/typedarray": {
+      "version": "0.0.6",
+      "resolved": "https://registry.npmjs.org/typedarray/-/typedarray-0.0.6.tgz",
+      "integrity": "sha512-/aCDEGatGvZ2BIk+HmLf4ifCJFwvKFNb9/JeZPMulfgFracn9QFcAf5GO8B/mweUjSoblS5In0cWhqpfs/5PQA==",
+      "license": "MIT"
+    },
+    "node_modules/undefsafe": {
+      "version": "2.0.5",
+      "resolved": "https://registry.npmjs.org/undefsafe/-/undefsafe-2.0.5.tgz",
+      "integrity": "sha512-WxONCrssBM8TSPRqN5EmsjVrsv4A8X12J4ArBiiayv3DyyG3ZlIg6yysuuSYdZsVz3TKcTg2fd//Ujd4CHV1iA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/undici-types": {
+      "version": "7.18.2",
+      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-7.18.2.tgz",
+      "integrity": "sha512-AsuCzffGHJybSaRrmr5eHr81mwJU3kjw6M+uprWvCXiNeN9SOGwQ3Jn8jb8m3Z6izVgknn1R0FTCEAP2QrLY/w==",
+      "license": "MIT"
+    },
+    "node_modules/unpipe": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
+      "integrity": "sha512-pjy2bYhSsufwWlKwPc+l3cN7+wuJlK6uz0YdJEOlQDbl6jo/YlPi4mb8agUkVC8BF7V8NuzeyPNqRksA3hztKQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/util-deprecate": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
+      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
+      "license": "MIT"
+    },
+    "node_modules/utils-merge": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/utils-merge/-/utils-merge-1.0.1.tgz",
+      "integrity": "sha512-pMZTvIkT1d+TFGvDOqodOclx0QWkkgi6Tdoa8gC8ffGAAqz9pzPTZWAybbsHHoED/ztMtkv/VoYTYyShUn81hA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4.0"
+      }
+    },
+    "node_modules/uuid": {
+      "version": "9.0.1",
+      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
+      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
+      "funding": [
+        "https://github.com/sponsors/broofa",
+        "https://github.com/sponsors/ctavan"
+      ],
+      "license": "MIT",
+      "bin": {
+        "uuid": "dist/bin/uuid"
+      }
+    },
+    "node_modules/vary": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
+      "integrity": "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/web-push": {
+      "version": "3.6.7",
+      "resolved": "https://registry.npmjs.org/web-push/-/web-push-3.6.7.tgz",
+      "integrity": "sha512-OpiIUe8cuGjrj3mMBFWY+e4MMIkW3SVT+7vEIjvD9kejGUypv8GPDf84JdPWskK8zMRIJ6xYGm+Kxr8YkPyA0A==",
+      "license": "MPL-2.0",
+      "dependencies": {
+        "asn1.js": "^5.3.0",
+        "http_ece": "1.2.0",
+        "https-proxy-agent": "^7.0.0",
+        "jws": "^4.0.0",
+        "minimist": "^1.2.5"
+      },
+      "bin": {
+        "web-push": "src/cli.js"
+      },
+      "engines": {
+        "node": ">= 16"
+      }
+    },
+    "node_modules/web-push/node_modules/agent-base": {
+      "version": "7.1.4",
+      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-7.1.4.tgz",
+      "integrity": "sha512-MnA+YT8fwfJPgBx3m60MNqakm30XOkyIoH1y6huTQvC0PwZG7ki8NacLBcrPbNoo8vEZy7Jpuk7+jMO+CUovTQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 14"
+      }
+    },
+    "node_modules/web-push/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/web-push/node_modules/https-proxy-agent": {
+      "version": "7.0.6",
+      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-7.0.6.tgz",
+      "integrity": "sha512-vK9P5/iUfdl95AI+JVyUuIcVtd4ofvtrOr3HNtM2yxC9bnMbEdp3x01OhQNnjb8IJYi38VlTE3mBXwcfvywuSw==",
+      "license": "MIT",
+      "dependencies": {
+        "agent-base": "^7.1.2",
+        "debug": "4"
+      },
+      "engines": {
+        "node": ">= 14"
+      }
+    },
+    "node_modules/web-push/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/winston": {
+      "version": "3.19.0",
+      "resolved": "https://registry.npmjs.org/winston/-/winston-3.19.0.tgz",
+      "integrity": "sha512-LZNJgPzfKR+/J3cHkxcpHKpKKvGfDZVPS4hfJCc4cCG0CgYzvlD6yE/S3CIL/Yt91ak327YCpiF/0MyeZHEHKA==",
+      "license": "MIT",
+      "dependencies": {
+        "@colors/colors": "^1.6.0",
+        "@dabh/diagnostics": "^2.0.8",
+        "async": "^3.2.3",
+        "is-stream": "^2.0.0",
+        "logform": "^2.7.0",
+        "one-time": "^1.0.0",
+        "readable-stream": "^3.4.0",
+        "safe-stable-stringify": "^2.3.1",
+        "stack-trace": "0.0.x",
+        "triple-beam": "^1.3.0",
+        "winston-transport": "^4.9.0"
+      },
+      "engines": {
+        "node": ">= 12.0.0"
+      }
+    },
+    "node_modules/winston-transport": {
+      "version": "4.9.0",
+      "resolved": "https://registry.npmjs.org/winston-transport/-/winston-transport-4.9.0.tgz",
+      "integrity": "sha512-8drMJ4rkgaPo1Me4zD/3WLfI/zPdA9o2IipKODunnGDcuqbHwjsbB79ylv04LCGGzU0xQ6vTznOMpQGaLhhm6A==",
+      "license": "MIT",
+      "dependencies": {
+        "logform": "^2.7.0",
+        "readable-stream": "^3.6.2",
+        "triple-beam": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 12.0.0"
+      }
+    },
+    "node_modules/winston-transport/node_modules/readable-stream": {
+      "version": "3.6.2",
+      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
+      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
+      "license": "MIT",
+      "dependencies": {
+        "inherits": "^2.0.3",
+        "string_decoder": "^1.1.1",
+        "util-deprecate": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/winston/node_modules/readable-stream": {
+      "version": "3.6.2",
+      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
+      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
+      "license": "MIT",
+      "dependencies": {
+        "inherits": "^2.0.3",
+        "string_decoder": "^1.1.1",
+        "util-deprecate": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/ws": {
+      "version": "8.18.3",
+      "resolved": "https://registry.npmjs.org/ws/-/ws-8.18.3.tgz",
+      "integrity": "sha512-PEIGCY5tSlUt50cqyMXfCzX+oOPqN0vuGqWzbcJ2xvnkzkq46oOpz7dQaTDBdfICb4N14+GARUDw2XV2N4tvzg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10.0.0"
+      },
+      "peerDependencies": {
+        "bufferutil": "^4.0.1",
+        "utf-8-validate": ">=5.0.2"
+      },
+      "peerDependenciesMeta": {
+        "bufferutil": {
+          "optional": true
+        },
+        "utf-8-validate": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/xmlbuilder": {
+      "version": "13.0.2",
+      "resolved": "https://registry.npmjs.org/xmlbuilder/-/xmlbuilder-13.0.2.tgz",
+      "integrity": "sha512-Eux0i2QdDYKbdbA6AM6xE4m6ZTZr4G4xF9kahI2ukSEMCzwce2eX9WlTI5J3s+NU7hpasFsr8hWIONae7LluAQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.0"
+      }
+    },
+    "node_modules/xtend": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/xtend/-/xtend-4.0.2.tgz",
+      "integrity": "sha512-LKYU1iAXJXUgAXn9URjiu+MWhyUXHsvfp7mcuYm9dSUKK0/CjtrUwFAxD82/mCWbtLsGjFIad0wIsod4zrTAEQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.4"
+      }
+    },
+    "node_modules/zod": {
+      "version": "3.25.76",
+      "resolved": "https://registry.npmjs.org/zod/-/zod-3.25.76.tgz",
+      "integrity": "sha512-gzUt/qt81nXsFGKIFcC3YnfEAx5NkunCfnDlvuBSSFS02bcXu4Lmea0AFIUwbLWxWPx3d9p8S5QoaujKcNQxcQ==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/colinhacks"
+      }
+    }
+  }
+}
diff --git a/templates/crm-homecare/backend/package.json b/templates/crm-homecare/backend/package.json
new file mode 100644
index 0000000..a833536
--- /dev/null
+++ b/templates/crm-homecare/backend/package.json
@@ -0,0 +1,42 @@
+{
+  "name": "twomiah-care-api",
+  "version": "1.0.0",
+  "type": "module",
+  "scripts": {
+    "dev": "nodemon src/index.js",
+    "start": "node src/index.js",
+    "db:generate": "prisma generate",
+    "db:migrate": "prisma migrate dev",
+    "db:push": "prisma db push",
+    "db:seed": "node prisma/seed.js",
+    "db:reset": "prisma db push --force-reset && npm run db:seed"
+  },
+  "prisma": {
+    "seed": "node prisma/seed.js"
+  },
+  "dependencies": {
+    "@prisma/client": "^5.10.0",
+    "@sendgrid/mail": "^8.1.0",
+    "bcryptjs": "^2.4.3",
+    "cookie-parser": "^1.4.6",
+    "cors": "^2.8.5",
+    "dotenv": "^16.4.5",
+    "express": "^4.18.3",
+    "express-rate-limit": "^7.2.0",
+    "helmet": "^7.1.0",
+    "jsonwebtoken": "^9.0.2",
+    "multer": "^1.4.5-lts.1",
+    "nodemailer": "^6.9.12",
+    "socket.io": "^4.7.4",
+    "stripe": "^14.25.0",
+    "twilio": "^5.0.0",
+    "uuid": "^9.0.1",
+    "web-push": "^3.6.7",
+    "winston": "^3.11.0",
+    "zod": "^3.22.4"
+  },
+  "devDependencies": {
+    "nodemon": "^3.1.0",
+    "prisma": "^5.10.0"
+  }
+}
diff --git a/templates/crm-homecare/backend/prisma/schema.prisma b/templates/crm-homecare/backend/prisma/schema.prisma
new file mode 100644
index 0000000..df10d3e
--- /dev/null
+++ b/templates/crm-homecare/backend/prisma/schema.prisma
@@ -0,0 +1,1135 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+// ==================== AGENCY (TOP-LEVEL TENANT) ====================
+model Agency {
+  id             String   @id @default(cuid())
+  name           String
+  legalName      String?
+  slug           String   @unique
+  email          String?
+  phone          String?
+  address        String?
+  city           String?
+  state          String?
+  zip            String?
+  primaryColor   String   @default("#0369a1")
+  secondaryColor String?
+  logo           String?
+  website        String?
+  licenseNumber  String?
+  npi            String?
+  medicaidId     String?
+  settings       Json     @default("{}")
+
+  // Stripe
+  stripeCustomerId String? @unique
+  subscriptionTier String?
+
+  // Twilio
+  twilioPhoneNumber String?
+  twilioAccountSid  String?
+  twilioAuthToken   String?
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@map("agencies")
+}
+
+// ==================== USERS (ADMINS & CAREGIVERS) ====================
+model User {
+  id                   String    @id @default(cuid())
+  email                String    @unique
+  passwordHash         String
+  firstName            String
+  lastName             String
+  phone                String?
+  role                 String    @default("caregiver") // 'admin' | 'caregiver' | 'billing'
+  isActive             Boolean   @default(true)
+  // Address
+  address              String?
+  city                 String?
+  state                String?
+  zip                  String?
+  latitude             Decimal?  @db.Decimal(10, 8)
+  longitude            Decimal?  @db.Decimal(11, 8)
+  // Caregiver fields
+  certifications       String[]
+  certificationsExpiry DateTime[]
+  defaultPayRate       Decimal?  @db.Decimal(8, 2)
+  hireDate             DateTime? @db.Date
+  emergencyContactName  String?
+  emergencyContactPhone String?
+  // Auth
+  lastLogin            DateTime?
+  refreshToken         String?
+  resetToken           String?
+  resetTokenExp        DateTime?
+  createdAt            DateTime  @default(now())
+  updatedAt            DateTime  @updatedAt
+
+  // Relations
+  profile              CaregiverProfile?
+  availability         CaregiverAvailability?
+  schedules            CaregiverSchedule[]
+  timeOff              CaregiverTimeOff[]
+  assignments          ClientAssignment[]
+  timeEntries          TimeEntry[]
+  gpsPoints            GpsTracking[]
+  absences             Absence[]
+  absencesCovering     Absence[]            @relation("CoverageAssigned")
+  absencesReported     Absence[]            @relation("AbsenceReportedBy")
+  performanceRatings   PerformanceRating[]
+  notifications        Notification[]
+  notificationPrefs    NotificationPreference?
+  pushSubscriptions    PushSubscription[]
+  backgroundChecks     BackgroundCheck[]
+  backgroundChecksBy   BackgroundCheck[]    @relation("BackgroundCheckCreatedBy")
+  gustoMap             GustoEmployeeMap?
+  messagesCreated      MessageThread[]
+  messagesSent         Message[]
+  threadParticipations MessageThreadParticipant[]
+  communicationLogs    CommunicationLog[]
+  formTemplates        FormTemplate[]
+  formSubmissions      FormSubmission[]
+  openShiftsCreated    OpenShift[]
+  loginActivities      LoginActivity[]
+  noshowsResolved      NoshowAlert[]        @relation("NoshowResolvedBy")
+  validationResolved   ValidationLog[]
+  remittanceBatches    RemittanceBatch[]
+  ediBatchesCreated    EdiBatch[]
+  authorizationsCreated Authorization[]
+  gustoSyncLogs        GustoSyncLog[]
+  expenseSubmissions   Expense[]
+
+  @@map("users")
+}
+
+// ==================== CAREGIVER PROFILE (EXTENDED) ====================
+model CaregiverProfile {
+  id               String   @id @default(cuid())
+  caregiverId      String   @unique
+  caregiver        User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  notes            String?
+  capabilities     String?
+  limitations      String?
+  preferredHours   String?
+  availableMon     Boolean  @default(true)
+  availableTue     Boolean  @default(true)
+  availableWed     Boolean  @default(true)
+  availableThu     Boolean  @default(true)
+  availableFri     Boolean  @default(true)
+  availableSat     Boolean  @default(false)
+  availableSun     Boolean  @default(false)
+  npiNumber        String?
+  taxonomyCode     String?  @default("374700000X")
+  evvWorkerId      String?
+  medicaidProviderId String?
+  createdAt        DateTime @default(now())
+  updatedAt        DateTime @updatedAt
+
+  @@map("caregiver_profiles")
+}
+
+// ==================== CAREGIVER AVAILABILITY ====================
+model CaregiverAvailability {
+  id               String   @id @default(cuid())
+  caregiverId      String   @unique
+  caregiver        User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  status           String   @default("available") // available | unavailable | limited
+  maxHoursPerWeek  Int      @default(40)
+  weeklyAvailability Json?  // {0: {available: bool, start: '09:00', end: '17:00'}, ...}
+  notes            String?
+  createdAt        DateTime @default(now())
+  updatedAt        DateTime @updatedAt
+
+  @@map("caregiver_availability")
+}
+
+// ==================== CAREGIVER SCHEDULES ====================
+model CaregiverSchedule {
+  id             String   @id @default(cuid())
+  caregiverId    String
+  caregiver      User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  dayOfWeek      Int?     // 0-6 (Sunday=0) for recurring; null for specific date
+  date           DateTime? @db.Date
+  startTime      DateTime? @db.Time
+  endTime        DateTime? @db.Time
+  isAvailable    Boolean  @default(true)
+  maxHoursPerWeek Int     @default(40)
+  overtimeApproved Boolean @default(false)
+  notes          String?
+  createdAt      DateTime @default(now())
+  updatedAt      DateTime @updatedAt
+
+  @@index([caregiverId])
+  @@index([date])
+  @@map("caregiver_schedules")
+}
+
+// ==================== CAREGIVER TIME OFF ====================
+model CaregiverTimeOff {
+  id          String   @id @default(cuid())
+  caregiverId String
+  caregiver   User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  startDate   DateTime @db.Date
+  endDate     DateTime @db.Date
+  type        String   // vacation | sick | other
+  reason      String?
+  approvedById String?
+  status      String   @default("pending") // pending | approved | rejected
+  createdAt   DateTime @default(now())
+
+  @@index([caregiverId])
+  @@index([startDate, endDate])
+  @@map("caregiver_time_off")
+}
+
+// ==================== REFERRAL SOURCES / PAYERS ====================
+model ReferralSource {
+  id              String   @id @default(cuid())
+  name            String
+  type            String?  // hospital | doctor | agency | social_services | family | insurance | private_pay
+  contactName     String?
+  email           String?
+  phone           String?
+  address         String?
+  city            String?
+  state           String?
+  zip             String?
+  notes           String?
+  isActive        Boolean  @default(true)
+  // Payer fields (v4)
+  payerType       String?  @default("other") // mco_family_care | managed_care | medicaid | va | private_pay | other
+  payerIdNumber   String?
+  npi             String?
+  expectedPayDays Int?     @default(30)
+  isActivePayer   Boolean  @default(false)
+  ediPayerId      String?
+  submissionMethod String? @default("manual") // edi | manual | portal
+  createdAt       DateTime @default(now())
+  updatedAt       DateTime @updatedAt
+
+  clients      Client[]
+  authorizations Authorization[]
+  ediBatches   EdiBatch[]
+  remittances  RemittanceBatch[]
+
+  @@index([type])
+  @@index([isActive])
+  @@map("referral_sources")
+}
+
+// ==================== CLIENTS ====================
+model Client {
+  id                    String   @id @default(cuid())
+  firstName             String
+  lastName              String
+  dateOfBirth           DateTime? @db.Date
+  ssnEncrypted          String?  // AES encrypted
+  gender                String?
+  address               String?
+  city                  String?
+  state                 String?
+  zip                   String?
+  phone                 String?
+  email                 String?
+  referredById          String?
+  referredBy            ReferralSource? @relation(fields: [referredById], references: [id])
+  referralDate          DateTime? @db.Date
+  startDate             DateTime? @db.Date
+  isActive              Boolean  @default(true)
+  serviceType           String?  // personal_care | companionship | respite_care | skilled_nursing | etc.
+  insuranceProvider     String?
+  insuranceId           String?
+  insuranceGroup        String?
+  medicalConditions     String[]
+  allergies             String[]
+  medications           String[]
+  preferredCaregivers   String[] // user IDs
+  doNotUseCaregivers    String[] // user IDs
+  notes                 String?
+  // Billing fields (v4)
+  evvClientId           String?
+  mcoMemberId           String?
+  primaryDiagnosisCode  String?
+  secondaryDiagnosisCode String?
+  createdAt             DateTime @default(now())
+  updatedAt             DateTime @updatedAt
+
+  emergencyContacts ClientEmergencyContact[]
+  onboarding        ClientOnboarding?
+  assignments       ClientAssignment[]
+  timeEntries       TimeEntry[]
+  geofence          GeofenceSettings?
+  evvVisits         EvvVisit[]
+  authorizations    Authorization[]
+  invoices          Invoice[]
+  performanceRatings PerformanceRating[]
+  communicationLogs  CommunicationLog[]
+  formSubmissions    FormSubmission[]
+  absencesCovering   Absence[]
+  noshowAlerts       NoshowAlert[]
+
+  @@index([isActive])
+  @@index([referredById])
+  @@map("clients")
+}
+
+// ==================== CLIENT EMERGENCY CONTACTS ====================
+model ClientEmergencyContact {
+  id           String   @id @default(cuid())
+  clientId     String
+  client       Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  name         String
+  relationship String?
+  phone        String
+  email        String?
+  isPrimary    Boolean  @default(false)
+  createdAt    DateTime @default(now())
+
+  @@index([clientId])
+  @@map("client_emergency_contacts")
+}
+
+// ==================== CLIENT ONBOARDING CHECKLIST ====================
+model ClientOnboarding {
+  id                          String    @id @default(cuid())
+  clientId                    String    @unique
+  client                      Client    @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  emergencyContactsCompleted  Boolean   @default(false)
+  medicalHistoryCompleted     Boolean   @default(false)
+  insuranceInfoCompleted      Boolean   @default(false)
+  carePreferencesCompleted    Boolean   @default(false)
+  familyCommunicationCompleted Boolean  @default(false)
+  initialAssessmentCompleted  Boolean   @default(false)
+  allCompleted                Boolean   @default(false)
+  completedAt                 DateTime?
+  createdAt                   DateTime  @default(now())
+  updatedAt                   DateTime  @updatedAt
+
+  @@map("client_onboarding")
+}
+
+// ==================== CLIENT ASSIGNMENTS ====================
+model ClientAssignment {
+  id             String   @id @default(cuid())
+  clientId       String
+  client         Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  caregiverId    String
+  caregiver      User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  assignmentDate DateTime @db.Date
+  hoursPerWeek   Decimal? @db.Decimal(5, 2)
+  payRate        Decimal? @db.Decimal(10, 2)
+  status         String   @default("active") // active | paused | completed
+  notes          String?
+  createdAt      DateTime @default(now())
+  updatedAt      DateTime @updatedAt
+
+  @@index([clientId])
+  @@index([caregiverId])
+  @@index([status])
+  @@map("client_assignments")
+}
+
+// ==================== SCHEDULES ====================
+model Schedule {
+  id           String    @id @default(cuid())
+  clientId     String?
+  caregiverId  String?
+  title        String?
+  startTime    DateTime?
+  endTime      DateTime?
+  frequency    String    @default("weekly") // weekly | biweekly | monthly | one_off
+  effectiveDate DateTime? @db.Date
+  anchorDate   DateTime? @db.Date
+  scheduleType String    @default("recurring") // recurring | one_off
+  isActive     Boolean   @default(true)
+  dayOfWeek    Int?
+  notes        String?
+  createdAt    DateTime  @default(now())
+  updatedAt    DateTime  @updatedAt
+
+  timeEntries  TimeEntry[]
+  noshowAlerts NoshowAlert[]
+
+  @@index([clientId])
+  @@index([caregiverId])
+  @@map("schedules")
+}
+
+// ==================== OPEN SHIFTS ====================
+model OpenShift {
+  id                  String    @id @default(cuid())
+  clientId            String?
+  date                DateTime  @db.Date
+  startTime           DateTime? @db.Time
+  endTime             DateTime? @db.Time
+  status              String    @default("open") // open | filled | cancelled
+  notes               String?
+  sourceAbsenceId     String?
+  notifiedCaregiverCount Int    @default(0)
+  autoCreated         Boolean   @default(false)
+  createdById         String?
+  createdBy           User?     @relation(fields: [createdById], references: [id])
+  createdAt           DateTime  @default(now())
+  updatedAt           DateTime  @updatedAt
+
+  notifications       OpenShiftNotification[]
+
+  @@index([date])
+  @@index([status])
+  @@map("open_shifts")
+}
+
+// ==================== OPEN SHIFT NOTIFICATIONS ====================
+model OpenShiftNotification {
+  id              String   @id @default(cuid())
+  openShiftId     String
+  openShift       OpenShift @relation(fields: [openShiftId], references: [id], onDelete: Cascade)
+  caregiverId     String
+  notifiedAt      DateTime @default(now())
+  notificationType String  @default("push") // push | sms | both
+
+  @@unique([openShiftId, caregiverId])
+  @@index([openShiftId])
+  @@map("open_shift_notifications")
+}
+
+// ==================== ABSENCES ====================
+model Absence {
+  id                String   @id @default(cuid())
+  caregiverId       String
+  caregiver         User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  clientId          String?
+  client            Client?  @relation(fields: [clientId], references: [id])
+  date              DateTime @db.Date
+  type              String   // callout | no_show | scheduled
+  reason            String?
+  reportedById      String?
+  reportedBy        User?    @relation("AbsenceReportedBy", fields: [reportedById], references: [id])
+  coverageNeeded    Boolean  @default(true)
+  coverageAssignedTo String?
+  coverageAssigned  User?    @relation("CoverageAssigned", fields: [coverageAssignedTo], references: [id])
+  createdAt         DateTime @default(now())
+
+  @@index([caregiverId])
+  @@index([date])
+  @@map("absences")
+}
+
+// ==================== TIME ENTRIES ====================
+model TimeEntry {
+  id                 String    @id @default(cuid())
+  caregiverId        String
+  caregiver          User      @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  clientId           String
+  client             Client    @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  assignmentId       String?
+  scheduleId         String?
+  schedule           Schedule? @relation(fields: [scheduleId], references: [id])
+  startTime          DateTime
+  endTime            DateTime?
+  durationMinutes    Int?
+  allottedMinutes    Int?
+  billableMinutes    Int?
+  discrepancyMinutes Int?
+  clockInLocation    Json?    // {lat, lng, accuracy}
+  clockOutLocation   Json?
+  isComplete         Boolean  @default(false)
+  notes              String?
+  createdAt          DateTime @default(now())
+  updatedAt          DateTime @updatedAt
+
+  gpsPoints GpsTracking[]
+  evvVisit  EvvVisit?
+  lineItems InvoiceLineItem[]
+
+  @@index([caregiverId])
+  @@index([clientId])
+  @@index([startTime])
+  @@index([scheduleId])
+  @@map("time_entries")
+}
+
+// ==================== GPS TRACKING ====================
+model GpsTracking {
+  id          String   @id @default(cuid())
+  caregiverId String
+  caregiver   User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  timeEntryId String?
+  timeEntry   TimeEntry? @relation(fields: [timeEntryId], references: [id])
+  latitude    Decimal  @db.Decimal(10, 8)
+  longitude   Decimal  @db.Decimal(11, 8)
+  accuracy    Int?
+  speed       Decimal? @db.Decimal(6, 2)
+  heading     Int?
+  timestamp   DateTime @default(now())
+
+  @@index([caregiverId])
+  @@index([timeEntryId])
+  @@index([timestamp])
+  @@map("gps_tracking")
+}
+
+// ==================== GEOFENCE SETTINGS ====================
+model GeofenceSettings {
+  id                  String   @id @default(cuid())
+  clientId            String   @unique
+  client              Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  radiusFeet          Int      @default(300)
+  autoClockIn         Boolean  @default(true)
+  autoClockOut        Boolean  @default(true)
+  requireGps          Boolean  @default(true)
+  notifyAdminOnOverride Boolean @default(true)
+  createdAt           DateTime @default(now())
+  updatedAt           DateTime @updatedAt
+
+  @@map("geofence_settings")
+}
+
+// ==================== SERVICE CODES ====================
+model ServiceCode {
+  id              String   @id @default(cuid())
+  code            String
+  modifier1       String?
+  modifier2       String?
+  description     String
+  serviceCategory String?
+  payerType       String   @default("all")
+  unitType        String   @default("15min") // 15min | hour | day | visit
+  ratePerUnit     Decimal? @db.Decimal(8, 4)
+  requiresEvv     Boolean  @default(true)
+  isActive        Boolean  @default(true)
+  createdAt       DateTime @default(now())
+
+  @@index([code])
+  @@index([isActive])
+  @@map("service_codes")
+}
+
+// ==================== AUTHORIZATIONS ====================
+model Authorization {
+  id                  String   @id @default(cuid())
+  clientId            String
+  client              Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  payerId             String?
+  payer               ReferralSource? @relation(fields: [payerId], references: [id])
+  authNumber          String?
+  midasAuthId         String?
+  procedureCode       String?
+  modifier            String?
+  authorizedUnits     Decimal  @db.Decimal(10, 2)
+  unitType            String   @default("15min")
+  usedUnits           Decimal  @default(0) @db.Decimal(10, 2)
+  startDate           DateTime @db.Date
+  endDate             DateTime @db.Date
+  status              String   @default("active") // active | expired | exhausted | cancelled
+  lowUnitsAlertThreshold Decimal @default(20) @db.Decimal(10, 2)
+  notes               String?
+  importedFrom        String   @default("manual")
+  createdById         String?
+  createdBy           User?    @relation(fields: [createdById], references: [id])
+  createdAt           DateTime @default(now())
+  updatedAt           DateTime @updatedAt
+
+  evvVisits   EvvVisit[]
+  claims      Claim[]
+
+  @@index([clientId])
+  @@index([startDate, endDate])
+  @@index([status])
+  @@map("authorizations")
+}
+
+// ==================== EVV VISITS ====================
+model EvvVisit {
+  id                 String    @id @default(cuid())
+  timeEntryId        String    @unique
+  timeEntry          TimeEntry @relation(fields: [timeEntryId], references: [id], onDelete: Cascade)
+  clientId           String
+  client             Client    @relation(fields: [clientId], references: [id])
+  caregiverId        String
+  authorizationId    String?
+  authorization      Authorization? @relation(fields: [authorizationId], references: [id])
+  serviceCode        String?
+  modifier           String?
+  serviceDate        DateTime  @db.Date
+  actualStart        DateTime
+  actualEnd          DateTime?
+  unitsOfService     Decimal?  @db.Decimal(8, 2)
+  gpsInLat           Decimal?  @db.Decimal(10, 7)
+  gpsInLng           Decimal?  @db.Decimal(10, 7)
+  gpsOutLat          Decimal?  @db.Decimal(10, 7)
+  gpsOutLng          Decimal?  @db.Decimal(10, 7)
+  sandataStatus      String    @default("pending") // pending | submitted | accepted | rejected
+  sandataVisitId     String?
+  sandataSubmittedAt DateTime?
+  sandataResponse    Json?
+  sandataExceptionCode String?
+  sandataExceptionDesc String?
+  evvMethod          String    @default("gps") // gps | telephony | manual
+  isVerified         Boolean   @default(false)
+  verificationIssues Json      @default("[]")
+  createdAt          DateTime  @default(now())
+  updatedAt          DateTime  @updatedAt
+
+  claims   Claim[]
+
+  @@index([clientId, serviceDate])
+  @@index([caregiverId])
+  @@index([sandataStatus])
+  @@map("evv_visits")
+}
+
+// ==================== VALIDATION LOG ====================
+model ValidationLog {
+  id             String    @id @default(cuid())
+  entityType     String    // time_entry | evv_visit | claim | authorization
+  entityId       String
+  validationType String
+  status         String    // error | warning | info
+  message        String?
+  details        Json?
+  resolvedAt     DateTime?
+  resolvedById   String?
+  resolvedBy     User?     @relation(fields: [resolvedById], references: [id])
+  createdAt      DateTime  @default(now())
+
+  @@index([entityId, entityType])
+  @@map("validation_log")
+}
+
+// ==================== INVOICES ====================
+model Invoice {
+  id                 String   @id @default(cuid())
+  invoiceNumber      String   @unique
+  clientId           String
+  client             Client   @relation(fields: [clientId], references: [id])
+  billingPeriodStart DateTime @db.Date
+  billingPeriodEnd   DateTime @db.Date
+  subtotal           Decimal  @db.Decimal(12, 2)
+  tax                Decimal  @default(0) @db.Decimal(12, 2)
+  total              Decimal  @db.Decimal(12, 2)
+  paymentStatus      String   @default("pending") // pending | paid | overdue | partial
+  paymentDueDate     DateTime? @db.Date
+  paymentDate        DateTime? @db.Date
+  paymentMethod      String?
+  stripePaymentIntentId String?
+  notes              String?
+  createdAt          DateTime @default(now())
+  updatedAt          DateTime @updatedAt
+
+  lineItems        InvoiceLineItem[]
+  remittanceLines  RemittanceLineItem[]
+
+  @@index([clientId])
+  @@index([paymentStatus])
+  @@map("invoices")
+}
+
+// ==================== INVOICE LINE ITEMS ====================
+model InvoiceLineItem {
+  id          String   @id @default(cuid())
+  invoiceId   String
+  invoice     Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
+  timeEntryId String?
+  timeEntry   TimeEntry? @relation(fields: [timeEntryId], references: [id])
+  caregiverId String
+  description String
+  hours       Decimal  @db.Decimal(6, 2)
+  rate        Decimal  @db.Decimal(10, 2)
+  amount      Decimal  @db.Decimal(12, 2)
+  createdAt   DateTime @default(now())
+
+  @@index([invoiceId])
+  @@map("invoice_line_items")
+}
+
+// ==================== EDI BATCHES ====================
+model EdiBatch {
+  id             String    @id @default(cuid())
+  payerId        String?
+  payer          ReferralSource? @relation(fields: [payerId], references: [id])
+  batchNumber    String    @unique
+  status         String    @default("draft") // draft | submitted | accepted | rejected | partial
+  claimCount     Int       @default(0)
+  totalBilled    Decimal   @default(0) @db.Decimal(10, 2)
+  ediContent     String?   @db.Text
+  submittedAt    DateTime?
+  responseCode   String?
+  responseMessage String?
+  createdById    String?
+  createdBy      User?     @relation(fields: [createdById], references: [id])
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
+
+  claims Claim[]
+
+  @@index([status])
+  @@map("edi_batches")
+}
+
+// ==================== CLAIMS ====================
+model Claim {
+  id              String    @id @default(cuid())
+  clientId        String?
+  caregiverId     String?
+  ediBatchId      String?
+  ediBatch        EdiBatch? @relation(fields: [ediBatchId], references: [id])
+  evvVisitId      String?
+  evvVisit        EvvVisit? @relation(fields: [evvVisitId], references: [id])
+  authorizationId String?
+  authorization   Authorization? @relation(fields: [authorizationId], references: [id])
+  claimNumber     String?
+  serviceDate     DateTime? @db.Date
+  serviceCode     String?
+  billedAmount    Decimal?  @db.Decimal(10, 2)
+  allowedAmount   Decimal?  @db.Decimal(10, 2)
+  paidAmount      Decimal?  @db.Decimal(10, 2)
+  denialCode      String?
+  denialReason    String?
+  status          String    @default("pending") // pending | submitted | paid | denied | voided
+  submissionDate  DateTime? @db.Date
+  paidDate        DateTime? @db.Date
+  notes           String?
+  createdAt       DateTime  @default(now())
+  updatedAt       DateTime  @updatedAt
+
+  remittanceLines RemittanceLineItem[]
+
+  @@index([ediBatchId])
+  @@index([evvVisitId])
+  @@index([status])
+  @@map("claims")
+}
+
+// ==================== REMITTANCE BATCHES ====================
+model RemittanceBatch {
+  id          String   @id @default(cuid())
+  payerId     String?
+  payer       ReferralSource? @relation(fields: [payerId], references: [id])
+  payerName   String
+  payerType   String   @default("other")
+  checkNumber String?
+  checkDate   DateTime? @db.Date
+  paymentDate DateTime? @db.Date
+  totalAmount Decimal  @db.Decimal(10, 2)
+  rawOcrText  String?  @db.Text
+  status      String   @default("pending_match") // pending_match | matched | posted
+  notes       String?
+  createdById String?
+  createdBy   User?    @relation(fields: [createdById], references: [id])
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+
+  lineItems RemittanceLineItem[]
+
+  @@index([payerId])
+  @@map("remittance_batches")
+}
+
+// ==================== REMITTANCE LINE ITEMS ====================
+model RemittanceLineItem {
+  id              String   @id @default(cuid())
+  batchId         String
+  batch           RemittanceBatch @relation(fields: [batchId], references: [id], onDelete: Cascade)
+  clientId        String?
+  invoiceId       String?
+  invoice         Invoice? @relation(fields: [invoiceId], references: [id])
+  claimId         String?
+  claim           Claim?   @relation(fields: [claimId], references: [id])
+  claimNumber     String?
+  serviceDateFrom DateTime? @db.Date
+  serviceDateTo   DateTime? @db.Date
+  billedAmount    Decimal?  @db.Decimal(10, 2)
+  allowedAmount   Decimal?  @db.Decimal(10, 2)
+  paidAmount      Decimal   @db.Decimal(10, 2)
+  adjustmentAmount Decimal  @default(0) @db.Decimal(10, 2)
+  denialCode      String?
+  denialReason    String?
+  matchStatus     String   @default("unmatched") // unmatched | matched | exception
+  matchedAt       DateTime?
+  createdAt       DateTime @default(now())
+
+  @@index([batchId])
+  @@map("remittance_line_items")
+}
+
+// ==================== GUSTO PAYROLL ====================
+model GustoSyncLog {
+  id              String   @id @default(cuid())
+  syncType        String   // export | import
+  status          String   // success | failed | partial
+  payPeriodStart  DateTime? @db.Date
+  payPeriodEnd    DateTime? @db.Date
+  recordsExported Int      @default(0)
+  gustoResponse   Json?
+  errorMessage    String?
+  createdById     String?
+  createdBy       User?    @relation(fields: [createdById], references: [id])
+  createdAt       DateTime @default(now())
+
+  @@map("gusto_sync_log")
+}
+
+model GustoEmployeeMap {
+  id               String   @id @default(cuid())
+  userId           String   @unique
+  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)
+  gustoEmployeeId  String?
+  gustoUuid        String?
+  isSynced         Boolean  @default(false)
+  lastSyncedAt     DateTime?
+
+  @@map("gusto_employee_map")
+}
+
+// ==================== EXPENSES ====================
+model Expense {
+  id          String   @id @default(cuid())
+  userId      String
+  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
+  category    String?  // mileage | supplies | other
+  description String
+  amount      Decimal  @db.Decimal(10, 2)
+  date        DateTime @db.Date
+  receiptUrl  String?
+  status      String   @default("pending") // pending | approved | rejected | reimbursed
+  notes       String?
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+
+  @@index([userId])
+  @@map("expenses")
+}
+
+// ==================== PERFORMANCE RATINGS ====================
+model PerformanceRating {
+  id                  String   @id @default(cuid())
+  caregiverId         String
+  caregiver           User     @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  clientId            String
+  client              Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
+  ratingDate          DateTime @default(now()) @db.Date
+  satisfactionScore   Int?
+  punctualityScore    Int?
+  professionalismScore Int?
+  careQualityScore    Int?
+  comments            String?
+  noShows             Int      @default(0)
+  lateArrivals        Int      @default(0)
+  createdAt           DateTime @default(now())
+  updatedAt           DateTime @updatedAt
+
+  @@index([caregiverId])
+  @@index([clientId])
+  @@map("performance_ratings")
+}
+
+// ==================== BACKGROUND CHECKS ====================
+model BackgroundCheck {
+  id                       String    @id @default(cuid())
+  caregiverId              String
+  caregiver                User      @relation(fields: [caregiverId], references: [id], onDelete: Cascade)
+  checkType                String    @default("criminal") // criminal | mvr | drug | reference
+  provider                 String?
+  cost                     Decimal?  @db.Decimal(8, 2)
+  status                   String    @default("pending") // pending | in_progress | clear | flagged | expired
+  initiatedDate            DateTime  @default(now()) @db.Date
+  expirationDate           DateTime? @db.Date
+  worcsReferenceNumber     String?
+  worcsStatus              String?
+  ssnEncrypted             String?
+  driversLicenseEncrypted  String?
+  driversLicenseState      String?
+  notes                    String?
+  createdById              String?
+  createdBy                User?     @relation("BackgroundCheckCreatedBy", fields: [createdById], references: [id])
+  createdAt                DateTime  @default(now())
+  updatedAt                DateTime  @updatedAt
+
+  @@index([caregiverId])
+  @@map("background_checks")
+}
+
+// ==================== NOTIFICATIONS ====================
+model Notification {
+  id         String   @id @default(cuid())
+  userId     String
+  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
+  type       String?  // schedule_alert | absence_alert | billing_alert | rating_alert | noshow_alert
+  title      String
+  message    String?
+  isRead     Boolean  @default(false)
+  emailSent  Boolean  @default(false)
+  pushSent   Boolean  @default(false)
+  createdAt  DateTime @default(now())
+
+  @@index([userId])
+  @@index([isRead])
+  @@map("notifications")
+}
+
+// ==================== NOTIFICATION PREFERENCES ====================
+model NotificationPreference {
+  id             String   @id @default(cuid())
+  userId         String   @unique
+  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
+  emailEnabled   Boolean  @default(true)
+  pushEnabled    Boolean  @default(true)
+  scheduleAlerts Boolean  @default(true)
+  absenceAlerts  Boolean  @default(true)
+  billingAlerts  Boolean  @default(true)
+  ratingAlerts   Boolean  @default(true)
+  dailyDigest    Boolean  @default(true)
+  createdAt      DateTime @default(now())
+  updatedAt      DateTime @updatedAt
+
+  @@map("notification_preferences")
+}
+
+// ==================== PUSH SUBSCRIPTIONS ====================
+model PushSubscription {
+  id           String   @id @default(cuid())
+  userId       String
+  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
+  subscription Json
+  isActive     Boolean  @default(true)
+  createdAt    DateTime @default(now())
+  updatedAt    DateTime @updatedAt
+
+  @@unique([userId, subscription])
+  @@index([isActive])
+  @@map("push_subscriptions")
+}
+
+// ==================== MESSAGE BOARD ====================
+model MessageThread {
+  id          String   @id @default(cuid())
+  subject     String
+  createdById String
+  createdBy   User     @relation(fields: [createdById], references: [id], onDelete: Cascade)
+  threadType  String   @default("direct") // direct | group | broadcast
+  isBroadcast Boolean  @default(false)
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+
+  participants MessageThreadParticipant[]
+  messages     Message[]
+
+  @@index([updatedAt(sort: Desc)])
+  @@map("message_threads")
+}
+
+model MessageThreadParticipant {
+  id         String    @id @default(cuid())
+  threadId   String
+  thread     MessageThread @relation(fields: [threadId], references: [id], onDelete: Cascade)
+  userId     String
+  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
+  lastReadAt DateTime?
+  joinedAt   DateTime  @default(now())
+
+  @@unique([threadId, userId])
+  @@index([userId])
+  @@index([threadId])
+  @@map("message_thread_participants")
+}
+
+model Message {
+  id        String   @id @default(cuid())
+  threadId  String
+  thread    MessageThread @relation(fields: [threadId], references: [id], onDelete: Cascade)
+  senderId  String
+  sender    User     @relation(fields: [senderId], references: [id], onDelete: Cascade)
+  body      String
+  isDeleted Boolean  @default(false)
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@index([threadId, createdAt])
+  @@map("messages")
+}
+
+// ==================== COMMUNICATION LOG ====================
+model CommunicationLog {
+  id            String   @id @default(cuid())
+  entityType    String   // client | caregiver
+  entityId      String
+  logType       String   @default("note") // note | call | email | text | visit | incident | complaint | compliment | other
+  direction     String?  // inbound | outbound | internal
+  subject       String?
+  body          String
+  loggedById    String?
+  loggedBy      User?    @relation(fields: [loggedById], references: [id])
+  loggedByName  String?
+  clientId      String?
+  client        Client?  @relation(fields: [clientId], references: [id])
+  followUpDate  DateTime? @db.Date
+  followUpDone  Boolean  @default(false)
+  isPinned      Boolean  @default(false)
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+
+  @@index([entityType, entityId])
+  @@index([createdAt(sort: Desc)])
+  @@map("communication_log")
+}
+
+// ==================== NO-SHOW ALERTS ====================
+model NoshowAlertConfig {
+  id                 String   @id @default(cuid())
+  graceMinutes       Int      @default(15)
+  notifyAdmin        Boolean  @default(true)
+  notifyCaregiver    Boolean  @default(true)
+  notifyClientFamily Boolean  @default(false)
+  adminPhone         String?
+  adminEmail         String?
+  isActive           Boolean  @default(true)
+  createdAt          DateTime @default(now())
+  updatedAt          DateTime @updatedAt
+
+  @@map("noshow_alert_config")
+}
+
+model NoshowAlert {
+  id             String    @id @default(cuid())
+  scheduleId     String?
+  schedule       Schedule? @relation(fields: [scheduleId], references: [id])
+  caregiverId    String?
+  caregiver      User?     @relation(fields: [caregiverId], references: [id])
+  clientId       String?
+  client         Client?   @relation(fields: [clientId], references: [id])
+  shiftDate      DateTime  @db.Date
+  expectedStart  DateTime  @db.Time
+  alertedAt      DateTime  @default(now())
+  resolvedAt     DateTime?
+  resolvedById   String?
+  resolvedBy     User?     @relation("NoshowResolvedBy", fields: [resolvedById], references: [id])
+  resolutionNote String?
+  status         String    @default("open") // open | resolved | false_alarm
+  smsSent        Boolean   @default(false)
+  createdAt      DateTime  @default(now())
+
+  @@index([status, shiftDate])
+  @@index([caregiverId])
+  @@map("noshow_alerts")
+}
+
+// ==================== FORM BUILDER ====================
+model FormTemplate {
+  id                String   @id @default(cuid())
+  name              String
+  description       String?
+  category          String   @default("general") // assessment | incident | physician_order | consent | intake | hr | general
+  fields            Json     @default("[]")
+  isActive          Boolean  @default(true)
+  requiresSignature Boolean  @default(false)
+  autoAttachTo      String?  // client | caregiver | both
+  createdById       String?
+  createdBy         User?    @relation(fields: [createdById], references: [id])
+  createdAt         DateTime @default(now())
+  updatedAt         DateTime @updatedAt
+
+  submissions FormSubmission[]
+
+  @@index([category, isActive])
+  @@map("form_templates")
+}
+
+model FormSubmission {
+  id                String    @id @default(cuid())
+  templateId        String?
+  template          FormTemplate? @relation(fields: [templateId], references: [id])
+  templateName      String?
+  entityType        String?   // client | caregiver
+  entityId          String?
+  clientId          String?
+  client            Client?   @relation(fields: [clientId], references: [id])
+  submittedById     String?
+  submittedBy       User?     @relation(fields: [submittedById], references: [id])
+  submittedByName   String?
+  data              Json      @default("{}")
+  signature         String?   @db.Text
+  signedAt          DateTime?
+  status            String    @default("draft") // draft | submitted | signed | archived
+  createdAt         DateTime  @default(now())
+  updatedAt         DateTime  @updatedAt
+
+  @@index([entityType, entityId])
+  @@index([templateId])
+  @@map("form_submissions")
+}
+
+// ==================== LOGIN ACTIVITY ====================
+model LoginActivity {
+  id         String   @id @default(cuid())
+  email      String
+  userId     String?
+  user       User?    @relation(fields: [userId], references: [id], onDelete: SetNull)
+  success    Boolean  @default(false)
+  ipAddress  String?
+  userAgent  String?
+  failReason String?  // invalid_password | user_not_found | account_inactive
+  createdAt  DateTime @default(now())
+
+  @@index([email])
+  @@index([userId])
+  @@index([createdAt(sort: Desc)])
+  @@map("login_activity")
+}
+
+// ==================== AUDIT LOG ====================
+model AuditLog {
+  id        String   @id @default(cuid())
+  userId    String
+  action    String   // INSERT | UPDATE | DELETE
+  tableName String?
+  recordId  String?
+  oldData   Json?
+  newData   Json?
+  ipAddress String?
+  timestamp DateTime @default(now())
+
+  @@index([userId])
+  @@index([timestamp])
+  @@index([tableName])
+  @@map("audit_logs")
+}
+
+// ==================== SERVICE LOCATIONS ====================
+model ServiceLocation {
+  id             String   @id @default(cuid())
+  name           String
+  address        String?
+  city           String?
+  state          String?
+  zip            String?
+  latitude       Decimal? @db.Decimal(10, 8)
+  longitude      Decimal? @db.Decimal(11, 8)
+  serviceRadiusMiles Int  @default(5)
+  isActive       Boolean  @default(true)
+  createdAt      DateTime @default(now())
+  updatedAt      DateTime @updatedAt
+
+  @@map("service_locations")
+}
+
+// ==================== DASHBOARD CACHE ====================
+model DashboardCache {
+  id        String   @id @default(cuid())
+  cacheKey  String   @unique
+  data      Json?
+  expiresAt DateTime?
+  createdAt DateTime @default(now())
+
+  @@map("dashboard_cache")
+}
diff --git a/templates/crm-homecare/backend/prisma/seed.js b/templates/crm-homecare/backend/prisma/seed.js
new file mode 100644
index 0000000..e4b7506
--- /dev/null
+++ b/templates/crm-homecare/backend/prisma/seed.js
@@ -0,0 +1,155 @@
+import { PrismaClient } from '@prisma/client';
+import bcrypt from 'bcryptjs';
+
+const prisma = new PrismaClient();
+
+async function main() {
+  console.log('🌱 Seeding {{COMPANY_NAME}} Care database...');
+
+  // ── AGENCY ────────────────────────────────────────────
+  const agency = await prisma.agency.create({
+    data: {
+      name: '{{COMPANY_NAME}}',
+      legalName: '{{COMPANY_LEGAL_NAME}}',
+      slug: '{{COMPANY_SLUG}}',
+      email: '{{COMPANY_EMAIL}}',
+      phone: '{{COMPANY_PHONE}}',
+      address: '{{COMPANY_ADDRESS}}',
+      city: '{{CITY}}',
+      state: '{{STATE}}',
+      zip: '{{ZIP}}',
+      primaryColor: '{{PRIMARY_COLOR}}',
+      secondaryColor: '{{SECONDARY_COLOR}}',
+    },
+  });
+  console.log(`✅ Agency created: ${agency.name}`);
+
+  // ── ADMIN USER ────────────────────────────────────────
+  const passwordHash = await bcrypt.hash('{{DEFAULT_PASSWORD}}', 12);
+
+  const admin = await prisma.user.create({
+    data: {
+      email: '{{ADMIN_EMAIL}}',
+      passwordHash,
+      firstName: '{{OWNER_FIRST_NAME}}',
+      lastName: '{{OWNER_LAST_NAME}}',
+      role: 'admin',
+      isActive: true,
+    },
+  });
+  await prisma.notificationPreference.create({ data: { userId: admin.id } });
+  console.log(`✅ Admin user created: ${admin.email}`);
+
+  // ── NO-SHOW ALERT CONFIG ──────────────────────────────
+  await prisma.noshowAlertConfig.create({
+    data: { graceMinutes: 15, notifyAdmin: true, notifyCaregiver: true, isActive: true, adminEmail: '{{ADMIN_EMAIL}}' },
+  });
+  console.log('✅ No-show alert config created');
+
+  // ── SERVICE CODES ─────────────────────────────────────
+  const serviceCodes = [
+    { code: 'T1019', description: 'Personal Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
+    { code: 'T1019', modifier1: 'U1', description: 'Personal Care - Supportive Home Care', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
+    { code: 'T1019', modifier1: 'U2', description: 'Personal Care - Consumer Directed', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
+    { code: 'S5125', description: 'Attendant Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
+    { code: 'S5130', description: 'Homemaker Services - per 15 min', serviceCategory: 'homemaker', payerType: 'all', unitType: '15min', requiresEvv: true },
+    { code: 'S5135', description: 'Companion Services - per 15 min', serviceCategory: 'companion', payerType: 'all', unitType: '15min', requiresEvv: true },
+    { code: 'T1005', description: 'Respite Care Services - per 15 min', serviceCategory: 'respite', payerType: 'all', unitType: '15min', requiresEvv: true },
+    { code: 'G0299', description: 'Direct Skilled Nursing - per visit', serviceCategory: 'skilled_nursing', payerType: 'medicaid', unitType: 'visit', requiresEvv: true },
+    { code: '99509', description: 'Home Visit - Assistance with ADLs', serviceCategory: 'personal_care', payerType: 'all', unitType: 'visit', requiresEvv: true },
+    { code: 'T2025', description: 'Waiver Services - Hourly', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: 'hour', requiresEvv: true },
+  ];
+
+  for (const code of serviceCodes) {
+    await prisma.serviceCode.create({ data: code });
+  }
+  console.log(`✅ ${serviceCodes.length} service codes seeded`);
+
+  // ── PAYERS ────────────────────────────────────────────
+  const payers = [
+    { name: 'Private Pay', type: 'private_pay', payerType: 'private_pay', isActivePayer: true, expectedPayDays: 14, submissionMethod: 'manual' },
+    { name: 'Medicaid', type: 'insurance', payerType: 'medicaid', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
+    { name: 'Medicare', type: 'insurance', payerType: 'medicare', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
+    { name: 'Veterans Affairs (VA)', type: 'insurance', payerType: 'va', isActivePayer: true, expectedPayDays: 45, submissionMethod: 'edi' },
+  ];
+
+  for (const payer of payers) {
+    await prisma.referralSource.create({ data: payer });
+  }
+  console.log(`✅ ${payers.length} payers seeded`);
+
+  // ── SERVICE LOCATION ──────────────────────────────────
+  await prisma.serviceLocation.create({
+    data: { name: '{{COMPANY_NAME}} Main Office', address: '{{COMPANY_ADDRESS}}', city: '{{CITY}}', state: '{{STATE}}', zip: '{{ZIP}}', isActive: true },
+  });
+
+  // ── FORM TEMPLATES ────────────────────────────────────
+  const formTemplates = [
+    {
+      name: 'Initial Client Assessment',
+      description: 'Standard intake assessment for new clients',
+      category: 'assessment',
+      requiresSignature: true,
+      autoAttachTo: 'client',
+      fields: JSON.stringify([
+        { id: 'f1', type: 'text', label: 'Primary Diagnosis', required: true },
+        { id: 'f2', type: 'textarea', label: 'Medical History', required: false },
+        { id: 'f3', type: 'select', label: 'Mobility Level', required: true, options: ['Independent', 'Requires Assistance', 'Non-Ambulatory'] },
+        { id: 'f4', type: 'select', label: 'Cognitive Status', required: true, options: ['Alert & Oriented', 'Mild Impairment', 'Moderate Impairment', 'Severe Impairment'] },
+        { id: 'f5', type: 'checkbox', label: 'Fall Risk', required: false },
+        { id: 'f6', type: 'checkbox', label: 'Requires Hoyer Lift', required: false },
+        { id: 'f7', type: 'textarea', label: 'Special Instructions for Caregiver', required: false },
+      ]),
+    },
+    {
+      name: 'Incident Report',
+      description: 'Document any incidents during a visit',
+      category: 'incident',
+      requiresSignature: true,
+      autoAttachTo: 'client',
+      fields: JSON.stringify([
+        { id: 'i1', type: 'text', label: 'Date of Incident', required: true, inputType: 'date' },
+        { id: 'i2', type: 'text', label: 'Time of Incident', required: true, inputType: 'time' },
+        { id: 'i3', type: 'select', label: 'Incident Type', required: true, options: ['Fall', 'Medication Error', 'Behavioral Issue', 'Medical Emergency', 'Property Damage', 'Complaint', 'Other'] },
+        { id: 'i4', type: 'textarea', label: 'Description of Incident', required: true },
+        { id: 'i5', type: 'textarea', label: 'Immediate Actions Taken', required: true },
+        { id: 'i6', type: 'checkbox', label: '911 Called', required: false },
+        { id: 'i7', type: 'checkbox', label: 'Family Notified', required: false },
+        { id: 'i8', type: 'checkbox', label: 'Supervisor Notified', required: false },
+      ]),
+    },
+    {
+      name: 'Caregiver HR Review',
+      description: 'Annual performance and compliance review',
+      category: 'hr',
+      requiresSignature: true,
+      autoAttachTo: 'caregiver',
+      fields: JSON.stringify([
+        { id: 'h1', type: 'select', label: 'Review Period', required: true, options: ['Q1', 'Q2', 'Q3', 'Q4', 'Annual'] },
+        { id: 'h2', type: 'select', label: 'Attendance Rating', required: true, options: ['Excellent', 'Good', 'Needs Improvement', 'Unsatisfactory'] },
+        { id: 'h3', type: 'select', label: 'Performance Rating', required: true, options: ['Exceeds Expectations', 'Meets Expectations', 'Below Expectations'] },
+        { id: 'h4', type: 'textarea', label: 'Strengths', required: false },
+        { id: 'h5', type: 'textarea', label: 'Areas for Improvement', required: false },
+        { id: 'h6', type: 'checkbox', label: 'CPR Certification Current', required: false },
+        { id: 'h7', type: 'checkbox', label: 'Background Check Current', required: false },
+        { id: 'h8', type: 'textarea', label: 'Supervisor Comments', required: false },
+      ]),
+    },
+  ];
+
+  for (const template of formTemplates) {
+    await prisma.formTemplate.create({ data: template });
+  }
+  console.log(`✅ ${formTemplates.length} form templates seeded`);
+
+  console.log('\n✅ Seed complete!');
+  console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
+  console.log(`   Agency:   {{COMPANY_NAME}}`);
+  console.log(`   Login:    {{ADMIN_EMAIL}}`);
+  console.log(`   Password: {{DEFAULT_PASSWORD}}`);
+  console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
+}
+
+main()
+  .catch((e) => { console.error('Seed failed:', e); process.exit(1); })
+  .finally(async () => { await prisma.$disconnect(); });
diff --git a/templates/crm-homecare/backend/src/index.js b/templates/crm-homecare/backend/src/index.js
new file mode 100644
index 0000000..0bfd5df
--- /dev/null
+++ b/templates/crm-homecare/backend/src/index.js
@@ -0,0 +1,163 @@
+import express from 'express';
+import { createServer } from 'http';
+import cors from 'cors';
+import helmet from 'helmet';
+import rateLimit from 'express-rate-limit';
+import cookieParser from 'cookie-parser';
+import path from 'path';
+import { fileURLToPath } from 'url';
+import dotenv from 'dotenv';
+import { PrismaClient } from '@prisma/client';
+
+import logger from './services/logger.js';
+import { initializeSocket } from './services/socket.js';
+import { applySecurity } from './middleware/security.js';
+import { errorHandler, notFoundHandler, handleUncaughtExceptions } from './utils/errors.js';
+
+// Routes
+import authRoutes from './routes/auth.js';
+import dashboardRoutes from './routes/dashboard.js';
+import clientsRoutes from './routes/clients.js';
+import caregiversRoutes from './routes/caregivers.js';
+import schedulingRoutes from './routes/scheduling.js';
+import timeTrackingRoutes from './routes/timeTracking.js';
+import billingRoutes from './routes/billing.js';
+import payrollRoutes from './routes/payroll.js';
+import complianceRoutes from './routes/compliance.js';
+import communicationRoutes from './routes/communication.js';
+import documentsRoutes from './routes/documents.js';
+import notificationsRoutes from './routes/notifications.js';
+import pushRoutes from './routes/push.js';
+import smsRoutes from './routes/sms.js';
+import portalRoutes from './routes/portal.js';
+import reportsRoutes from './routes/reports.js';
+import formsRoutes from './routes/forms.js';
+import evvRoutes from './routes/evv.js';
+import ediRoutes from './routes/edi.js';
+import claimsRoutes from './routes/claims.js';
+import remittanceRoutes from './routes/remittance.js';
+import authorizationsRoutes from './routes/authorizations.js';
+import serviceCodesRoutes from './routes/serviceCodes.js';
+import payersRoutes from './routes/payers.js';
+import auditRoutes from './routes/audit.js';
+import companyRoutes from './routes/company.js';
+import stripeRoutes from './routes/stripe.js';
+import optimizerRoutes from './routes/optimizer.js';
+
+dotenv.config();
+
+handleUncaughtExceptions();
+
+const __filename = fileURLToPath(import.meta.url);
+const __dirname = path.dirname(__filename);
+
+const app = express();
+const server = createServer(app);
+
+const io = initializeSocket(server);
+
+const prisma = new PrismaClient({
+  log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],
+});
+
+export { prisma, io };
+
+app.set('trust proxy', 1);
+
+app.use(helmet({
+  crossOriginResourcePolicy: { policy: 'cross-origin' },
+}));
+
+app.use(cors({
+  origin: process.env.FRONTEND_URL || 'http://localhost:5173',
+  credentials: true,
+  methods: ['GET', 'POST', 'PUT', 'PATCH', 'DELETE', 'OPTIONS'],
+  allowedHeaders: ['Content-Type', 'Authorization'],
+}));
+
+app.use(express.json({ limit: '10mb' }));
+app.use(express.urlencoded({ extended: true, limit: '10mb' }));
+app.use(cookieParser());
+
+applySecurity(app);
+
+const limiter = rateLimit({
+  windowMs: 15 * 60 * 1000,
+  max: process.env.NODE_ENV === 'production' ? 200 : 1000,
+  message: { error: 'Too many requests, please try again later' },
+  standardHeaders: true,
+  legacyHeaders: false,
+});
+app.use('/api/', limiter);
+
+const authLimiter = rateLimit({
+  windowMs: 15 * 60 * 1000,
+  max: 20,
+  message: { error: 'Too many authentication attempts' },
+});
+app.use('/api/auth/login', authLimiter);
+
+const uploadsDir = process.env.UPLOAD_DIR || path.join(process.cwd(), 'uploads');
+app.use('/uploads', express.static(uploadsDir));
+
+app.use((req, res, next) => {
+  req.prisma = prisma;
+  next();
+});
+
+app.get('/health', (req, res) => {
+  res.json({ status: 'ok', timestamp: new Date().toISOString(), uptime: process.uptime() });
+});
+
+// API routes
+app.use('/api/auth', authRoutes);
+app.use('/api/dashboard', dashboardRoutes);
+app.use('/api/clients', clientsRoutes);
+app.use('/api/caregivers', caregiversRoutes);
+app.use('/api/scheduling', schedulingRoutes);
+app.use('/api/time-tracking', timeTrackingRoutes);
+app.use('/api/billing', billingRoutes);
+app.use('/api/payroll', payrollRoutes);
+app.use('/api/compliance', complianceRoutes);
+app.use('/api/communication', communicationRoutes);
+app.use('/api/documents', documentsRoutes);
+app.use('/api/notifications', notificationsRoutes);
+app.use('/api/push', pushRoutes);
+app.use('/api/sms', smsRoutes);
+app.use('/api/portal', portalRoutes);
+app.use('/api/reports', reportsRoutes);
+app.use('/api/forms', formsRoutes);
+app.use('/api/evv', evvRoutes);
+app.use('/api/edi', ediRoutes);
+app.use('/api/claims', claimsRoutes);
+app.use('/api/remittance', remittanceRoutes);
+app.use('/api/authorizations', authorizationsRoutes);
+app.use('/api/service-codes', serviceCodesRoutes);
+app.use('/api/payers', payersRoutes);
+app.use('/api/audit', auditRoutes);
+app.use('/api/company', companyRoutes);
+app.use('/api/stripe', stripeRoutes);
+app.use('/api/optimizer', optimizerRoutes);
+
+app.use(notFoundHandler);
+app.use(errorHandler);
+
+const shutdown = async (signal) => {
+  logger.info(`${signal} received, shutting down gracefully`);
+  await prisma.$disconnect();
+  process.exit(0);
+};
+
+process.on('SIGTERM', () => shutdown('SIGTERM'));
+process.on('SIGINT', () => shutdown('SIGINT'));
+
+const PORT = process.env.PORT || 3001;
+
+server.listen(PORT, () => {
+  logger.info(`{{COMPANY_NAME}} Care API running on port ${PORT}`, {
+    env: process.env.NODE_ENV || 'development',
+    port: PORT,
+  });
+});
+
+export default app;
diff --git a/templates/crm-homecare/backend/src/middleware/auth.js b/templates/crm-homecare/backend/src/middleware/auth.js
new file mode 100644
index 0000000..e3a0db4
--- /dev/null
+++ b/templates/crm-homecare/backend/src/middleware/auth.js
@@ -0,0 +1,49 @@
+import jwt from 'jsonwebtoken';
+import { prisma } from '../index.js';
+
+export const authenticate = async (req, res, next) => {
+  try {
+    const authHeader = req.headers.authorization;
+    if (!authHeader?.startsWith('Bearer ')) {
+      return res.status(401).json({ error: 'No token provided' });
+    }
+
+    const token = authHeader.split(' ')[1];
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+
+    const user = await prisma.user.findUnique({
+      where: { id: decoded.userId },
+      select: { id: true, email: true, role: true, isActive: true, firstName: true, lastName: true },
+    });
+
+    if (!user || !user.isActive) {
+      return res.status(401).json({ error: 'User not found or inactive' });
+    }
+
+    req.user = { userId: user.id, email: user.email, role: user.role, firstName: user.firstName, lastName: user.lastName };
+    next();
+  } catch (error) {
+    if (error.name === 'TokenExpiredError') {
+      return res.status(401).json({ error: 'Token expired' });
+    }
+    return res.status(401).json({ error: 'Invalid token' });
+  }
+};
+
+export const requireRole = (...roles) => (req, res, next) => {
+  if (!req.user) return res.status(401).json({ error: 'Not authenticated' });
+  if (!roles.includes(req.user.role)) return res.status(403).json({ error: 'Insufficient permissions' });
+  next();
+};
+
+export const requireAdmin = requireRole('admin', 'billing');
+export const adminOnly = requireRole('admin');
+
+// Log auth events (HIPAA requirement)
+export const logAuthEvent = async (prisma, { email, userId, success, ipAddress, userAgent, failReason }) => {
+  try {
+    await prisma.loginActivity.create({
+      data: { email, userId, success, ipAddress, userAgent, failReason },
+    });
+  } catch (_) { /* non-blocking */ }
+};
diff --git a/templates/crm-homecare/backend/src/middleware/security.js b/templates/crm-homecare/backend/src/middleware/security.js
new file mode 100644
index 0000000..3dbe1af
--- /dev/null
+++ b/templates/crm-homecare/backend/src/middleware/security.js
@@ -0,0 +1,16 @@
+// security.js
+export const applySecurity = (app) => {
+  // CSRF-lite: block requests with no origin on state-changing methods in prod
+  if (process.env.NODE_ENV === 'production') {
+    app.use((req, res, next) => {
+      if (['POST', 'PUT', 'PATCH', 'DELETE'].includes(req.method)) {
+        const origin = req.headers.origin;
+        const allowed = process.env.FRONTEND_URL;
+        if (origin && allowed && !origin.startsWith(allowed)) {
+          return res.status(403).json({ error: 'Forbidden' });
+        }
+      }
+      next();
+    });
+  }
+};
diff --git a/templates/crm-homecare/backend/src/routes/audit.js b/templates/crm-homecare/backend/src/routes/audit.js
new file mode 100644
index 0000000..4765168
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/audit.js
@@ -0,0 +1,23 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const { tableName, userId, page = 1, limit = 100 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+    const where = {};
+    if (tableName) where.tableName = tableName;
+    if (userId) where.userId = userId;
+    const [logs, total] = await Promise.all([
+      prisma.auditLog.findMany({ where, skip, take: parseInt(limit), orderBy: { timestamp: 'desc' } }),
+      prisma.auditLog.count({ where }),
+    ]);
+    res.json({ logs, total });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/auth.js b/templates/crm-homecare/backend/src/routes/auth.js
new file mode 100644
index 0000000..5a3f06c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/auth.js
@@ -0,0 +1,115 @@
+import { Router } from 'express';
+import bcrypt from 'bcryptjs';
+import jwt from 'jsonwebtoken';
+import { z } from 'zod';
+import { prisma } from '../index.js';
+import { authenticate, logAuthEvent } from '../middleware/auth.js';
+import logger from '../services/logger.js';
+
+const router = Router();
+
+const generateTokens = (userId, email, role) => {
+  const accessToken = jwt.sign({ userId, email, role }, process.env.JWT_SECRET, { expiresIn: '15m' });
+  const refreshToken = jwt.sign({ userId, type: 'refresh' }, process.env.JWT_REFRESH_SECRET || process.env.JWT_SECRET, { expiresIn: '7d' });
+  return { accessToken, refreshToken };
+};
+
+// POST /api/auth/login
+router.post('/login', async (req, res, next) => {
+  const ip = req.ip;
+  const ua = req.headers['user-agent'];
+  try {
+    const { email, password } = req.body;
+    if (!email || !password) return res.status(400).json({ error: 'Email and password are required' });
+
+    const user = await prisma.user.findUnique({ where: { email: email.toLowerCase().trim() } });
+
+    if (!user) {
+      await logAuthEvent(prisma, { email, success: false, ipAddress: ip, userAgent: ua, failReason: 'user_not_found' });
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    if (!user.isActive) {
+      await logAuthEvent(prisma, { email, userId: user.id, success: false, ipAddress: ip, userAgent: ua, failReason: 'account_inactive' });
+      return res.status(401).json({ error: 'Account is inactive' });
+    }
+
+    const valid = await bcrypt.compare(password, user.passwordHash);
+    if (!valid) {
+      await logAuthEvent(prisma, { email, userId: user.id, success: false, ipAddress: ip, userAgent: ua, failReason: 'invalid_password' });
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    const { accessToken, refreshToken } = generateTokens(user.id, user.email, user.role);
+
+    await prisma.user.update({ where: { id: user.id }, data: { lastLogin: new Date(), refreshToken } });
+    await logAuthEvent(prisma, { email, userId: user.id, success: true, ipAddress: ip, userAgent: ua });
+
+    res.json({
+      accessToken,
+      refreshToken,
+      user: { id: user.id, email: user.email, firstName: user.firstName, lastName: user.lastName, role: user.role },
+    });
+  } catch (err) { next(err); }
+});
+
+// POST /api/auth/refresh
+router.post('/refresh', async (req, res, next) => {
+  try {
+    const { refreshToken } = req.body;
+    if (!refreshToken) return res.status(401).json({ error: 'No refresh token' });
+
+    const decoded = jwt.verify(refreshToken, process.env.JWT_REFRESH_SECRET || process.env.JWT_SECRET);
+    const user = await prisma.user.findUnique({ where: { id: decoded.userId } });
+
+    if (!user || !user.isActive || user.refreshToken !== refreshToken) {
+      return res.status(401).json({ error: 'Invalid refresh token' });
+    }
+
+    const tokens = generateTokens(user.id, user.email, user.role);
+    await prisma.user.update({ where: { id: user.id }, data: { refreshToken: tokens.refreshToken } });
+
+    res.json(tokens);
+  } catch {
+    res.status(401).json({ error: 'Invalid refresh token' });
+  }
+});
+
+// POST /api/auth/logout
+router.post('/logout', authenticate, async (req, res, next) => {
+  try {
+    await prisma.user.update({ where: { id: req.user.userId }, data: { refreshToken: null } });
+    res.json({ message: 'Logged out' });
+  } catch (err) { next(err); }
+});
+
+// GET /api/auth/me
+router.get('/me', authenticate, async (req, res, next) => {
+  try {
+    const user = await prisma.user.findUnique({
+      where: { id: req.user.userId },
+      select: {
+        id: true, email: true, firstName: true, lastName: true, phone: true,
+        role: true, isActive: true, hireDate: true, defaultPayRate: true,
+        certifications: true, certificationsExpiry: true, lastLogin: true,
+        profile: { select: { npiNumber: true, taxonomyCode: true, evvWorkerId: true, medicaidProviderId: true } },
+      },
+    });
+    res.json(user);
+  } catch (err) { next(err); }
+});
+
+// PUT /api/auth/change-password
+router.put('/change-password', authenticate, async (req, res, next) => {
+  try {
+    const { currentPassword, newPassword } = req.body;
+    const user = await prisma.user.findUnique({ where: { id: req.user.userId } });
+    const valid = await bcrypt.compare(currentPassword, user.passwordHash);
+    if (!valid) return res.status(400).json({ error: 'Current password is incorrect' });
+    const passwordHash = await bcrypt.hash(newPassword, 12);
+    await prisma.user.update({ where: { id: req.user.userId }, data: { passwordHash } });
+    res.json({ message: 'Password changed successfully' });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/authorizations.js b/templates/crm-homecare/backend/src/routes/authorizations.js
new file mode 100644
index 0000000..9dd4be6
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/authorizations.js
@@ -0,0 +1,44 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const { clientId, status, payerId } = req.query;
+    const where = {};
+    if (clientId) where.clientId = clientId;
+    if (status) where.status = status;
+    if (payerId) where.payerId = payerId;
+    const auths = await prisma.authorization.findMany({
+      where, orderBy: { endDate: 'asc' },
+      include: { client: { select: { firstName: true, lastName: true } }, payer: { select: { name: true } } },
+    });
+    res.json(auths);
+  } catch (err) { next(err); }
+});
+
+router.post('/', async (req, res, next) => {
+  try {
+    const auth = await prisma.authorization.create({ data: { ...req.body, createdById: req.user.userId } });
+    res.status(201).json(auth);
+  } catch (err) { next(err); }
+});
+
+router.put('/:id', async (req, res, next) => {
+  try {
+    const auth = await prisma.authorization.update({ where: { id: req.params.id }, data: req.body });
+    res.json(auth);
+  } catch (err) { next(err); }
+});
+
+router.delete('/:id', async (req, res, next) => {
+  try {
+    await prisma.authorization.update({ where: { id: req.params.id }, data: { status: 'cancelled' } });
+    res.json({ message: 'Cancelled' });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/billing.js b/templates/crm-homecare/backend/src/routes/billing.js
new file mode 100644
index 0000000..ae85510
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/billing.js
@@ -0,0 +1,113 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+// ── INVOICES ──────────────────────────────────────────────────────
+
+router.get('/invoices', async (req, res, next) => {
+  try {
+    const { paymentStatus, clientId, startDate, endDate, page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+    const where = {};
+    if (paymentStatus) where.paymentStatus = paymentStatus;
+    if (clientId) where.clientId = clientId;
+    if (startDate || endDate) {
+      where.billingPeriodStart = {};
+      if (startDate) where.billingPeriodStart.gte = new Date(startDate);
+      if (endDate) where.billingPeriodStart.lte = new Date(endDate);
+    }
+    const [invoices, total] = await Promise.all([
+      prisma.invoice.findMany({
+        where, skip, take: parseInt(limit),
+        orderBy: { createdAt: 'desc' },
+        include: { client: { select: { firstName: true, lastName: true } }, lineItems: true },
+      }),
+      prisma.invoice.count({ where }),
+    ]);
+    res.json({ invoices, total });
+  } catch (err) { next(err); }
+});
+
+router.get('/invoices/:id', async (req, res, next) => {
+  try {
+    const invoice = await prisma.invoice.findUniqueOrThrow({
+      where: { id: req.params.id },
+      include: { client: true, lineItems: { include: { caregiver: { select: { firstName: true, lastName: true } } } } },
+    });
+    res.json(invoice);
+  } catch (err) { next(err); }
+});
+
+router.post('/invoices', async (req, res, next) => {
+  try {
+    const { lineItems, ...data } = req.body;
+    // Generate invoice number
+    const count = await prisma.invoice.count();
+    const invoiceNumber = `INV-${String(count + 1).padStart(5, '0')}`;
+    const invoice = await prisma.invoice.create({
+      data: {
+        ...data,
+        invoiceNumber,
+        lineItems: lineItems ? { create: lineItems } : undefined,
+      },
+      include: { lineItems: true },
+    });
+    res.status(201).json(invoice);
+  } catch (err) { next(err); }
+});
+
+router.patch('/invoices/:id/status', async (req, res, next) => {
+  try {
+    const invoice = await prisma.invoice.update({
+      where: { id: req.params.id },
+      data: { paymentStatus: req.body.status, paymentDate: req.body.paymentDate ? new Date(req.body.paymentDate) : undefined },
+    });
+    res.json(invoice);
+  } catch (err) { next(err); }
+});
+
+// ── GENERATE INVOICE FROM TIME ENTRIES ───────────────────────────
+
+router.post('/invoices/generate', async (req, res, next) => {
+  try {
+    const { clientId, startDate, endDate } = req.body;
+    const entries = await prisma.timeEntry.findMany({
+      where: { clientId, startTime: { gte: new Date(startDate), lte: new Date(endDate) }, isComplete: true },
+      include: { caregiver: true },
+    });
+    if (!entries.length) return res.status(400).json({ error: 'No completed time entries in this period' });
+
+    const assignment = await prisma.clientAssignment.findFirst({ where: { clientId, status: 'active' } });
+    const rate = assignment?.payRate || 25.00;
+
+    const lineItems = entries.map(e => ({
+      caregiverId: e.caregiverId,
+      timeEntryId: e.id,
+      description: `${e.caregiver.firstName} ${e.caregiver.lastName} - Care Visit`,
+      hours: Number((e.billableMinutes || e.durationMinutes || 0) / 60).toFixed(2),
+      rate: Number(rate),
+      amount: Number(((e.billableMinutes || e.durationMinutes || 0) / 60) * Number(rate)).toFixed(2),
+    }));
+
+    const subtotal = lineItems.reduce((s, l) => s + Number(l.amount), 0);
+    const count = await prisma.invoice.count();
+    const invoice = await prisma.invoice.create({
+      data: {
+        invoiceNumber: `INV-${String(count + 1).padStart(5, '0')}`,
+        clientId,
+        billingPeriodStart: new Date(startDate),
+        billingPeriodEnd: new Date(endDate),
+        subtotal,
+        total: subtotal,
+        lineItems: { create: lineItems },
+      },
+      include: { lineItems: true, client: { select: { firstName: true, lastName: true } } },
+    });
+    res.status(201).json(invoice);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/caregivers.js b/templates/crm-homecare/backend/src/routes/caregivers.js
new file mode 100644
index 0000000..d698703
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/caregivers.js
@@ -0,0 +1,145 @@
+import { Router } from 'express';
+import bcrypt from 'bcryptjs';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// GET /api/caregivers
+router.get('/', async (req, res, next) => {
+  try {
+    const { search, isActive = 'true', page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+
+    const where = { role: 'caregiver' };
+    if (isActive !== 'all') where.isActive = isActive === 'true';
+    if (search) {
+      where.OR = [
+        { firstName: { contains: search, mode: 'insensitive' } },
+        { lastName: { contains: search, mode: 'insensitive' } },
+        { email: { contains: search, mode: 'insensitive' } },
+        { phone: { contains: search } },
+      ];
+    }
+
+    const [caregivers, total] = await Promise.all([
+      prisma.user.findMany({
+        where,
+        skip,
+        take: parseInt(limit),
+        orderBy: [{ isActive: 'desc' }, { lastName: 'asc' }],
+        select: {
+          id: true, firstName: true, lastName: true, email: true, phone: true,
+          isActive: true, hireDate: true, defaultPayRate: true,
+          certifications: true, certificationsExpiry: true,
+          profile: { select: { npiNumber: true, evvWorkerId: true, availableMon: true, availableTue: true, availableWed: true, availableThu: true, availableFri: true, availableSat: true, availableSun: true } },
+          availability: { select: { status: true, maxHoursPerWeek: true } },
+        },
+      }),
+      prisma.user.count({ where }),
+    ]);
+
+    res.json({ caregivers, total, page: parseInt(page), pages: Math.ceil(total / parseInt(limit)) });
+  } catch (err) { next(err); }
+});
+
+// GET /api/caregivers/:id
+router.get('/:id', async (req, res, next) => {
+  try {
+    const caregiver = await prisma.user.findUniqueOrThrow({
+      where: { id: req.params.id },
+      select: {
+        id: true, email: true, firstName: true, lastName: true, phone: true,
+        isActive: true, hireDate: true, defaultPayRate: true, address: true, city: true, state: true, zip: true,
+        latitude: true, longitude: true, certifications: true, certificationsExpiry: true,
+        emergencyContactName: true, emergencyContactPhone: true,
+        profile: true, availability: true,
+        assignments: { where: { status: 'active' }, include: { client: { select: { firstName: true, lastName: true, address: true, city: true } } } },
+        backgroundChecks: { orderBy: { createdAt: 'desc' }, take: 5 },
+      },
+    });
+    res.json(caregiver);
+  } catch (err) { next(err); }
+});
+
+// POST /api/caregivers - create caregiver account
+router.post('/', requireAdmin, async (req, res, next) => {
+  try {
+    const { password = 'Welcome1!', profile, ...data } = req.body;
+    const passwordHash = await bcrypt.hash(password, 12);
+
+    const caregiver = await prisma.user.create({
+      data: {
+        ...data,
+        email: data.email.toLowerCase().trim(),
+        passwordHash,
+        role: 'caregiver',
+        profile: profile ? { create: profile } : { create: {} },
+        availability: { create: {} },
+        notificationPrefs: { create: {} },
+      },
+      select: {
+        id: true, email: true, firstName: true, lastName: true, phone: true,
+        isActive: true, role: true, profile: true, availability: true,
+      },
+    });
+    res.status(201).json(caregiver);
+  } catch (err) { next(err); }
+});
+
+// PUT /api/caregivers/:id
+router.put('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const { profile, availability, password, ...data } = req.body;
+
+    const updates = [
+      prisma.user.update({ where: { id: req.params.id }, data }),
+    ];
+    if (profile) updates.push(prisma.caregiverProfile.upsert({ where: { caregiverId: req.params.id }, create: { ...profile, caregiverId: req.params.id }, update: profile }));
+    if (availability) updates.push(prisma.caregiverAvailability.upsert({ where: { caregiverId: req.params.id }, create: { ...availability, caregiverId: req.params.id }, update: availability }));
+    if (password) {
+      const passwordHash = await bcrypt.hash(password, 12);
+      updates.push(prisma.user.update({ where: { id: req.params.id }, data: { passwordHash } }));
+    }
+
+    await Promise.all(updates);
+    const updated = await prisma.user.findUnique({ where: { id: req.params.id }, select: { id: true, email: true, firstName: true, lastName: true, isActive: true, profile: true, availability: true } });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// GET /api/caregivers/:id/background-checks
+router.get('/:id/background-checks', requireAdmin, async (req, res, next) => {
+  try {
+    const checks = await prisma.backgroundCheck.findMany({
+      where: { caregiverId: req.params.id },
+      orderBy: { createdAt: 'desc' },
+    });
+    // Strip encrypted fields
+    const safe = checks.map(({ ssnEncrypted: _, driversLicenseEncrypted: __, ...c }) => c);
+    res.json(safe);
+  } catch (err) { next(err); }
+});
+
+// POST /api/caregivers/:id/background-checks
+router.post('/:id/background-checks', requireAdmin, async (req, res, next) => {
+  try {
+    const check = await prisma.backgroundCheck.create({
+      data: { ...req.body, caregiverId: req.params.id, createdById: req.user.userId },
+    });
+    const { ssnEncrypted: _, driversLicenseEncrypted: __, ...safe } = check;
+    res.status(201).json(safe);
+  } catch (err) { next(err); }
+});
+
+// PATCH /api/caregivers/:id/toggle-active
+router.patch('/:id/toggle-active', requireAdmin, async (req, res, next) => {
+  try {
+    const user = await prisma.user.findUniqueOrThrow({ where: { id: req.params.id }, select: { isActive: true } });
+    const updated = await prisma.user.update({ where: { id: req.params.id }, data: { isActive: !user.isActive } });
+    res.json({ isActive: updated.isActive });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/claims.js b/templates/crm-homecare/backend/src/routes/claims.js
new file mode 100644
index 0000000..4b23326
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/claims.js
@@ -0,0 +1,39 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const { status, page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+    const where = {};
+    if (status) where.status = status;
+    const [claims, total] = await Promise.all([
+      prisma.claim.findMany({
+        where, skip, take: parseInt(limit), orderBy: { createdAt: 'desc' },
+        include: { ediBatch: { select: { batchNumber: true } }, evvVisit: { select: { serviceDate: true } } },
+      }),
+      prisma.claim.count({ where }),
+    ]);
+    res.json({ claims, total });
+  } catch (err) { next(err); }
+});
+
+router.post('/', async (req, res, next) => {
+  try {
+    const claim = await prisma.claim.create({ data: req.body });
+    res.status(201).json(claim);
+  } catch (err) { next(err); }
+});
+
+router.patch('/:id', async (req, res, next) => {
+  try {
+    const claim = await prisma.claim.update({ where: { id: req.params.id }, data: req.body });
+    res.json(claim);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/clients.js b/templates/crm-homecare/backend/src/routes/clients.js
new file mode 100644
index 0000000..bb103b8
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/clients.js
@@ -0,0 +1,159 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// GET /api/clients
+router.get('/', async (req, res, next) => {
+  try {
+    const { search, isActive, serviceType, page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+
+    const where = {};
+    if (isActive !== undefined) where.isActive = isActive === 'true';
+    if (serviceType) where.serviceType = serviceType;
+    if (search) {
+      where.OR = [
+        { firstName: { contains: search, mode: 'insensitive' } },
+        { lastName: { contains: search, mode: 'insensitive' } },
+        { phone: { contains: search } },
+        { email: { contains: search, mode: 'insensitive' } },
+      ];
+    }
+
+    const [clients, total] = await Promise.all([
+      prisma.client.findMany({
+        where,
+        skip,
+        take: parseInt(limit),
+        orderBy: [{ isActive: 'desc' }, { lastName: 'asc' }],
+        include: {
+          emergencyContacts: { where: { isPrimary: true }, take: 1 },
+          onboarding: { select: { allCompleted: true } },
+          assignments: { where: { status: 'active' }, include: { caregiver: { select: { firstName: true, lastName: true } } } },
+        },
+      }),
+      prisma.client.count({ where }),
+    ]);
+
+    // Strip SSN from list view
+    const safeClients = clients.map(({ ssnEncrypted: _, ...c }) => c);
+    res.json({ clients: safeClients, total, page: parseInt(page), pages: Math.ceil(total / parseInt(limit)) });
+  } catch (err) { next(err); }
+});
+
+// GET /api/clients/:id
+router.get('/:id', async (req, res, next) => {
+  try {
+    const client = await prisma.client.findUniqueOrThrow({
+      where: { id: req.params.id },
+      include: {
+        emergencyContacts: true,
+        onboarding: true,
+        assignments: { include: { caregiver: { select: { id: true, firstName: true, lastName: true, phone: true } } } },
+        referredBy: { select: { id: true, name: true, type: true } },
+        geofence: true,
+        authorizations: { where: { status: 'active' }, orderBy: { endDate: 'asc' } },
+      },
+    });
+    const { ssnEncrypted: _, ...safeClient } = client;
+    res.json(safeClient);
+  } catch (err) { next(err); }
+});
+
+// POST /api/clients
+router.post('/', requireAdmin, async (req, res, next) => {
+  try {
+    const { emergencyContacts, ...data } = req.body;
+    const client = await prisma.client.create({
+      data: {
+        ...data,
+        emergencyContacts: emergencyContacts?.length
+          ? { create: emergencyContacts }
+          : undefined,
+        onboarding: { create: {} },
+      },
+      include: { emergencyContacts: true, onboarding: true },
+    });
+    res.status(201).json(client);
+  } catch (err) { next(err); }
+});
+
+// PUT /api/clients/:id
+router.put('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const { emergencyContacts, onboarding, ...data } = req.body;
+    const client = await prisma.client.update({
+      where: { id: req.params.id },
+      data,
+      include: { emergencyContacts: true, onboarding: true },
+    });
+    res.json(client);
+  } catch (err) { next(err); }
+});
+
+// PATCH /api/clients/:id/onboarding
+router.patch('/:id/onboarding', requireAdmin, async (req, res, next) => {
+  try {
+    const data = req.body;
+    const allFields = ['emergencyContactsCompleted', 'medicalHistoryCompleted', 'insuranceInfoCompleted', 'carePreferencesCompleted', 'familyCommunicationCompleted', 'initialAssessmentCompleted'];
+    const allCompleted = allFields.every(f => data[f] === true);
+    const updated = await prisma.clientOnboarding.update({
+      where: { clientId: req.params.id },
+      data: { ...data, allCompleted, completedAt: allCompleted ? new Date() : null },
+    });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// POST /api/clients/:id/emergency-contacts
+router.post('/:id/emergency-contacts', requireAdmin, async (req, res, next) => {
+  try {
+    const contact = await prisma.clientEmergencyContact.create({
+      data: { ...req.body, clientId: req.params.id },
+    });
+    res.status(201).json(contact);
+  } catch (err) { next(err); }
+});
+
+// DELETE /api/clients/:id/emergency-contacts/:contactId
+router.delete('/:id/emergency-contacts/:contactId', requireAdmin, async (req, res, next) => {
+  try {
+    await prisma.clientEmergencyContact.delete({ where: { id: req.params.contactId } });
+    res.json({ message: 'Deleted' });
+  } catch (err) { next(err); }
+});
+
+// POST /api/clients/:id/assignments
+router.post('/:id/assignments', requireAdmin, async (req, res, next) => {
+  try {
+    const assignment = await prisma.clientAssignment.create({
+      data: { ...req.body, clientId: req.params.id },
+      include: { caregiver: { select: { id: true, firstName: true, lastName: true } } },
+    });
+    res.status(201).json(assignment);
+  } catch (err) { next(err); }
+});
+
+// PATCH /api/clients/assignments/:assignmentId
+router.patch('/assignments/:assignmentId', requireAdmin, async (req, res, next) => {
+  try {
+    const assignment = await prisma.clientAssignment.update({
+      where: { id: req.params.assignmentId },
+      data: req.body,
+    });
+    res.json(assignment);
+  } catch (err) { next(err); }
+});
+
+// DELETE /api/clients/:id
+router.delete('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    await prisma.client.update({ where: { id: req.params.id }, data: { isActive: false } });
+    res.json({ message: 'Client deactivated' });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/communication.js b/templates/crm-homecare/backend/src/routes/communication.js
new file mode 100644
index 0000000..36f1082
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/communication.js
@@ -0,0 +1,117 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// Communication Log
+router.get('/log', async (req, res, next) => {
+  try {
+    const { entityType, entityId, page = 1, limit = 30 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+    const where = {};
+    if (entityType) where.entityType = entityType;
+    if (entityId) where.entityId = entityId;
+    const [logs, total] = await Promise.all([
+      prisma.communicationLog.findMany({
+        where, skip, take: parseInt(limit), orderBy: [{ isPinned: 'desc' }, { createdAt: 'desc' }],
+        include: { loggedBy: { select: { firstName: true, lastName: true } } },
+      }),
+      prisma.communicationLog.count({ where }),
+    ]);
+    res.json({ logs, total });
+  } catch (err) { next(err); }
+});
+
+router.post('/log', async (req, res, next) => {
+  try {
+    const log = await prisma.communicationLog.create({
+      data: {
+        ...req.body,
+        loggedById: req.user.userId,
+        loggedByName: `${req.user.firstName} ${req.user.lastName}`,
+      },
+    });
+    res.status(201).json(log);
+  } catch (err) { next(err); }
+});
+
+router.patch('/log/:id/pin', async (req, res, next) => {
+  try {
+    const log = await prisma.communicationLog.findUniqueOrThrow({ where: { id: req.params.id } });
+    const updated = await prisma.communicationLog.update({ where: { id: req.params.id }, data: { isPinned: !log.isPinned } });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+router.patch('/log/:id/follow-up', async (req, res, next) => {
+  try {
+    const updated = await prisma.communicationLog.update({ where: { id: req.params.id }, data: { followUpDone: true } });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// Message Board - Threads
+router.get('/threads', async (req, res, next) => {
+  try {
+    const threads = await prisma.messageThread.findMany({
+      where: {
+        participants: { some: { userId: req.user.userId } },
+      },
+      orderBy: { updatedAt: 'desc' },
+      include: {
+        participants: { include: { user: { select: { firstName: true, lastName: true } } } },
+        messages: { orderBy: { createdAt: 'desc' }, take: 1 },
+        _count: { select: { messages: true } },
+      },
+    });
+    res.json(threads);
+  } catch (err) { next(err); }
+});
+
+router.post('/threads', async (req, res, next) => {
+  try {
+    const { subject, threadType, isBroadcast, participantIds } = req.body;
+    const allIds = [...new Set([req.user.userId, ...(participantIds || [])])];
+    const thread = await prisma.messageThread.create({
+      data: {
+        subject, threadType, isBroadcast,
+        createdById: req.user.userId,
+        participants: { create: allIds.map(id => ({ userId: id })) },
+      },
+      include: { participants: true },
+    });
+    res.status(201).json(thread);
+  } catch (err) { next(err); }
+});
+
+// Messages in thread
+router.get('/threads/:id/messages', async (req, res, next) => {
+  try {
+    const messages = await prisma.message.findMany({
+      where: { threadId: req.params.id, isDeleted: false },
+      orderBy: { createdAt: 'asc' },
+      include: { sender: { select: { firstName: true, lastName: true, role: true } } },
+    });
+    // Mark as read
+    await prisma.messageThreadParticipant.updateMany({
+      where: { threadId: req.params.id, userId: req.user.userId },
+      data: { lastReadAt: new Date() },
+    });
+    res.json(messages);
+  } catch (err) { next(err); }
+});
+
+router.post('/threads/:id/messages', async (req, res, next) => {
+  try {
+    const message = await prisma.message.create({
+      data: { threadId: req.params.id, senderId: req.user.userId, body: req.body.body },
+      include: { sender: { select: { firstName: true, lastName: true } } },
+    });
+    await prisma.messageThread.update({ where: { id: req.params.id }, data: { updatedAt: new Date() } });
+    res.status(201).json(message);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/company.js b/templates/crm-homecare/backend/src/routes/company.js
new file mode 100644
index 0000000..283f19b
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/company.js
@@ -0,0 +1,40 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const agency = await prisma.agency.findFirst();
+    res.json(agency || {});
+  } catch (err) { next(err); }
+});
+
+router.put('/', requireAdmin, async (req, res, next) => {
+  try {
+    const existing = await prisma.agency.findFirst();
+    let agency;
+    if (existing) {
+      agency = await prisma.agency.update({ where: { id: existing.id }, data: req.body });
+    } else {
+      const slug = (req.body.name || 'agency').toLowerCase().replace(/[^a-z0-9]/g, '-');
+      agency = await prisma.agency.create({ data: { ...req.body, slug } });
+    }
+    res.json(agency);
+  } catch (err) { next(err); }
+});
+
+// User management (all staff)
+router.get('/users', requireAdmin, async (req, res, next) => {
+  try {
+    const users = await prisma.user.findMany({
+      select: { id: true, email: true, firstName: true, lastName: true, role: true, isActive: true, lastLogin: true },
+      orderBy: [{ role: 'asc' }, { lastName: 'asc' }],
+    });
+    res.json(users);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/compliance.js b/templates/crm-homecare/backend/src/routes/compliance.js
new file mode 100644
index 0000000..8160226
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/compliance.js
@@ -0,0 +1,79 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+// Compliance dashboard - certifications expiring, background checks, etc.
+router.get('/dashboard', async (req, res, next) => {
+  try {
+    const soon = new Date(); soon.setDate(soon.getDate() + 60);
+
+    const [activeCaregiversCount, caregivers, recentBackgroundChecks, performanceRatings] = await Promise.all([
+      prisma.user.count({ where: { role: 'caregiver', isActive: true } }),
+      prisma.user.findMany({
+        where: { role: 'caregiver', isActive: true },
+        select: { id: true, firstName: true, lastName: true, certifications: true, certificationsExpiry: true },
+      }),
+      prisma.backgroundCheck.findMany({
+        where: { expirationDate: { lte: soon } },
+        orderBy: { expirationDate: 'asc' }, take: 20,
+        include: { caregiver: { select: { firstName: true, lastName: true } } },
+      }),
+      prisma.performanceRating.groupBy({
+        by: ['caregiverId'],
+        _avg: { satisfactionScore: true, punctualityScore: true },
+        _count: true,
+      }),
+    ]);
+
+    // Identify caregivers with expiring certs
+    const expiringCerts = caregivers.flatMap(c =>
+      (c.certificationsExpiry || []).map((exp, i) => ({
+        caregiverId: c.id,
+        name: `${c.firstName} ${c.lastName}`,
+        cert: c.certifications[i],
+        expiry: exp,
+      })).filter(x => x.expiry && new Date(x.expiry) <= soon)
+    );
+
+    res.json({ activeCaregiversCount, expiringCerts, recentBackgroundChecks, performanceRatings });
+  } catch (err) { next(err); }
+});
+
+// Performance ratings
+router.get('/ratings', async (req, res, next) => {
+  try {
+    const ratings = await prisma.performanceRating.findMany({
+      where: req.query.caregiverId ? { caregiverId: req.query.caregiverId } : {},
+      orderBy: { ratingDate: 'desc' },
+      include: {
+        caregiver: { select: { firstName: true, lastName: true } },
+        client: { select: { firstName: true, lastName: true } },
+      },
+    });
+    res.json(ratings);
+  } catch (err) { next(err); }
+});
+
+router.post('/ratings', async (req, res, next) => {
+  try {
+    const rating = await prisma.performanceRating.create({ data: req.body });
+    res.status(201).json(rating);
+  } catch (err) { next(err); }
+});
+
+// Login activity monitor
+router.get('/login-activity', async (req, res, next) => {
+  try {
+    const activity = await prisma.loginActivity.findMany({
+      orderBy: { createdAt: 'desc' },
+      take: 100,
+      include: { user: { select: { firstName: true, lastName: true, role: true } } },
+    });
+    res.json(activity);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/dashboard.js b/templates/crm-homecare/backend/src/routes/dashboard.js
new file mode 100644
index 0000000..3b36e05
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/dashboard.js
@@ -0,0 +1,111 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// GET /api/dashboard/stats
+router.get('/stats', async (req, res, next) => {
+  try {
+    const today = new Date(); today.setHours(0, 0, 0, 0);
+    const tomorrow = new Date(today); tomorrow.setDate(today.getDate() + 1);
+    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
+
+    const [
+      activeClients,
+      activeCaregiversCount,
+      openShifts,
+      openNoshows,
+      incompleteOnboarding,
+      invoicesOutstanding,
+      authsExpiringSoon,
+      shiftsToday,
+    ] = await Promise.all([
+      prisma.client.count({ where: { isActive: true } }),
+      prisma.user.count({ where: { role: 'caregiver', isActive: true } }),
+      prisma.openShift.count({ where: { status: 'open', date: { gte: today } } }),
+      prisma.noshowAlert.count({ where: { status: 'open' } }),
+      prisma.clientOnboarding.count({ where: { allCompleted: false } }),
+      prisma.invoice.aggregate({ where: { paymentStatus: { in: ['pending', 'overdue'] } }, _sum: { total: true } }),
+      prisma.authorization.count({
+        where: {
+          status: 'active',
+          endDate: { lte: new Date(today.getTime() + 30 * 24 * 60 * 60 * 1000) },
+        }
+      }),
+      prisma.timeEntry.count({ where: { startTime: { gte: today, lt: tomorrow }, isComplete: false } }),
+    ]);
+
+    // Caregivers currently on shift
+    const caregiversClockedIn = await prisma.timeEntry.findMany({
+      where: { startTime: { gte: today }, endTime: null, isComplete: false },
+      select: { caregiverId: true },
+      distinct: ['caregiverId'],
+    });
+
+    res.json({
+      activeClients,
+      activeCaregiversCount,
+      caregiversClockedIn: caregiversClockedIn.length,
+      openShifts,
+      openNoshows,
+      incompleteOnboarding,
+      outstandingRevenue: Number(invoicesOutstanding._sum.total || 0),
+      authsExpiringSoon,
+      shiftsToday,
+    });
+  } catch (err) { next(err); }
+});
+
+// GET /api/dashboard/recent-activity
+router.get('/recent-activity', async (req, res, next) => {
+  try {
+    const [recentClients, recentTimeEntries, recentInvoices, pendingAbsences] = await Promise.all([
+      prisma.client.findMany({ where: { isActive: true }, orderBy: { createdAt: 'desc' }, take: 5, select: { id: true, firstName: true, lastName: true, serviceType: true, createdAt: true } }),
+      prisma.timeEntry.findMany({ orderBy: { startTime: 'desc' }, take: 8, select: { id: true, startTime: true, endTime: true, isComplete: true, caregiver: { select: { firstName: true, lastName: true } }, client: { select: { firstName: true, lastName: true } } } }),
+      prisma.invoice.findMany({ orderBy: { createdAt: 'desc' }, take: 5, select: { id: true, invoiceNumber: true, total: true, paymentStatus: true, createdAt: true, client: { select: { firstName: true, lastName: true } } } }),
+      prisma.absence.findMany({ orderBy: { createdAt: 'desc' }, take: 5, where: { coverageNeeded: true, coverageAssignedTo: null }, select: { id: true, date: true, type: true, caregiver: { select: { firstName: true, lastName: true } } } }),
+    ]);
+
+    res.json({ recentClients, recentTimeEntries, recentInvoices, pendingAbsences });
+  } catch (err) { next(err); }
+});
+
+// GET /api/dashboard/alerts
+router.get('/alerts', async (req, res, next) => {
+  try {
+    const today = new Date(); today.setHours(0, 0, 0, 0);
+
+    const [noshowAlerts, expiringAuths, expiringCerts] = await Promise.all([
+      prisma.noshowAlert.findMany({
+        where: { status: 'open' },
+        orderBy: { createdAt: 'desc' },
+        take: 10,
+        include: { caregiver: { select: { firstName: true, lastName: true } }, client: { select: { firstName: true, lastName: true } } },
+      }),
+      prisma.authorization.findMany({
+        where: {
+          status: 'active',
+          endDate: { lte: new Date(today.getTime() + 14 * 24 * 60 * 60 * 1000) },
+        },
+        include: { client: { select: { firstName: true, lastName: true } } },
+        orderBy: { endDate: 'asc' },
+        take: 10,
+      }),
+      prisma.user.findMany({
+        where: {
+          role: 'caregiver',
+          isActive: true,
+          certificationsExpiry: { hasSome: [] },
+        },
+        select: { id: true, firstName: true, lastName: true, certifications: true, certificationsExpiry: true },
+        take: 10,
+      }),
+    ]);
+
+    res.json({ noshowAlerts, expiringAuths, expiringCerts });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/documents.js b/templates/crm-homecare/backend/src/routes/documents.js
new file mode 100644
index 0000000..ea9a5b4
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/documents.js
@@ -0,0 +1,32 @@
+import { Router } from 'express';
+import multer from 'multer';
+import path from 'path';
+import fs from 'fs';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+const uploadsDir = process.env.UPLOAD_DIR || './uploads';
+if (!fs.existsSync(uploadsDir)) fs.mkdirSync(uploadsDir, { recursive: true });
+
+const storage = multer.diskStorage({
+  destination: (req, file, cb) => {
+    const dir = path.join(uploadsDir, req.params.entityType || 'misc');
+    if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
+    cb(null, dir);
+  },
+  filename: (req, file, cb) => {
+    const safe = file.originalname.replace(/[^a-z0-9.\-_]/gi, '_');
+    cb(null, `${Date.now()}-${safe}`);
+  },
+});
+
+const upload = multer({ storage, limits: { fileSize: (parseInt(process.env.MAX_FILE_SIZE_MB) || 10) * 1024 * 1024 } });
+
+router.post('/:entityType/:entityId/upload', requireAdmin, upload.single('file'), (req, res) => {
+  if (!req.file) return res.status(400).json({ error: 'No file uploaded' });
+  res.json({ filename: req.file.filename, originalName: req.file.originalname, size: req.file.size, path: `/uploads/${req.params.entityType}/${req.file.filename}` });
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/edi.js b/templates/crm-homecare/backend/src/routes/edi.js
new file mode 100644
index 0000000..50115b5
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/edi.js
@@ -0,0 +1,38 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/batches', async (req, res, next) => {
+  try {
+    const batches = await prisma.ediBatch.findMany({
+      orderBy: { createdAt: 'desc' },
+      include: { payer: { select: { name: true } }, _count: { select: { claims: true } } },
+    });
+    res.json(batches);
+  } catch (err) { next(err); }
+});
+
+router.post('/batches', async (req, res, next) => {
+  try {
+    const count = await prisma.ediBatch.count();
+    const batch = await prisma.ediBatch.create({
+      data: { ...req.body, batchNumber: `EDI-${String(count + 1).padStart(5, '0')}`, createdById: req.user.userId },
+    });
+    res.status(201).json(batch);
+  } catch (err) { next(err); }
+});
+
+router.patch('/batches/:id/submit', async (req, res, next) => {
+  try {
+    const batch = await prisma.ediBatch.update({
+      where: { id: req.params.id },
+      data: { status: 'submitted', submittedAt: new Date() },
+    });
+    res.json(batch);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/evv.js b/templates/crm-homecare/backend/src/routes/evv.js
new file mode 100644
index 0000000..299b050
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/evv.js
@@ -0,0 +1,65 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const { status, startDate, endDate, page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+    const where = {};
+    if (status) where.sandataStatus = status;
+    if (startDate || endDate) {
+      where.serviceDate = {};
+      if (startDate) where.serviceDate.gte = new Date(startDate);
+      if (endDate) where.serviceDate.lte = new Date(endDate);
+    }
+    const [visits, total] = await Promise.all([
+      prisma.evvVisit.findMany({
+        where, skip, take: parseInt(limit), orderBy: { serviceDate: 'desc' },
+        include: {
+          timeEntry: { select: { startTime: true, endTime: true, durationMinutes: true } },
+          client: { select: { firstName: true, lastName: true, mcoMemberId: true } },
+        },
+      }),
+      prisma.evvVisit.count({ where }),
+    ]);
+    res.json({ visits, total });
+  } catch (err) { next(err); }
+});
+
+router.post('/create-from-entry/:timeEntryId', async (req, res, next) => {
+  try {
+    const entry = await prisma.timeEntry.findUniqueOrThrow({
+      where: { id: req.params.timeEntryId },
+      include: { client: true },
+    });
+    const visit = await prisma.evvVisit.create({
+      data: {
+        timeEntryId: entry.id,
+        clientId: entry.clientId,
+        caregiverId: entry.caregiverId,
+        serviceDate: new Date(entry.startTime.toISOString().split('T')[0]),
+        actualStart: entry.startTime,
+        actualEnd: entry.endTime,
+        gpsInLat: entry.clockInLocation?.lat,
+        gpsInLng: entry.clockInLocation?.lng,
+        gpsOutLat: entry.clockOutLocation?.lat,
+        gpsOutLng: entry.clockOutLocation?.lng,
+        ...req.body,
+      },
+    });
+    res.status(201).json(visit);
+  } catch (err) { next(err); }
+});
+
+router.patch('/:id/verify', async (req, res, next) => {
+  try {
+    const visit = await prisma.evvVisit.update({ where: { id: req.params.id }, data: { isVerified: true, sandataStatus: 'accepted' } });
+    res.json(visit);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/forms.js b/templates/crm-homecare/backend/src/routes/forms.js
new file mode 100644
index 0000000..09e6198
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/forms.js
@@ -0,0 +1,62 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.get('/templates', async (req, res, next) => {
+  try {
+    const templates = await prisma.formTemplate.findMany({
+      where: { isActive: true },
+      orderBy: [{ category: 'asc' }, { name: 'asc' }],
+    });
+    res.json(templates);
+  } catch (err) { next(err); }
+});
+
+router.post('/templates', requireAdmin, async (req, res, next) => {
+  try {
+    const template = await prisma.formTemplate.create({ data: { ...req.body, createdById: req.user.userId } });
+    res.status(201).json(template);
+  } catch (err) { next(err); }
+});
+
+router.put('/templates/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const template = await prisma.formTemplate.update({ where: { id: req.params.id }, data: req.body });
+    res.json(template);
+  } catch (err) { next(err); }
+});
+
+router.get('/submissions', async (req, res, next) => {
+  try {
+    const { entityType, entityId, templateId } = req.query;
+    const where = {};
+    if (entityType) where.entityType = entityType;
+    if (entityId) where.entityId = entityId;
+    if (templateId) where.templateId = templateId;
+    const submissions = await prisma.formSubmission.findMany({
+      where, orderBy: { createdAt: 'desc' },
+      include: { template: { select: { name: true, category: true } }, submittedBy: { select: { firstName: true, lastName: true } } },
+    });
+    res.json(submissions);
+  } catch (err) { next(err); }
+});
+
+router.post('/submissions', async (req, res, next) => {
+  try {
+    const submission = await prisma.formSubmission.create({
+      data: {
+        ...req.body,
+        submittedById: req.user.userId,
+        submittedByName: `${req.user.firstName} ${req.user.lastName}`,
+        status: req.body.signature ? 'signed' : 'submitted',
+        signedAt: req.body.signature ? new Date() : null,
+      },
+    });
+    res.status(201).json(submission);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/notifications.js b/templates/crm-homecare/backend/src/routes/notifications.js
new file mode 100644
index 0000000..ee51be6
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/notifications.js
@@ -0,0 +1,47 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const notifications = await prisma.notification.findMany({
+      where: { userId: req.user.userId },
+      orderBy: { createdAt: 'desc' },
+      take: 50,
+    });
+    res.json(notifications);
+  } catch (err) { next(err); }
+});
+
+router.patch('/mark-read', async (req, res, next) => {
+  try {
+    const { ids } = req.body;
+    const where = ids?.length ? { id: { in: ids }, userId: req.user.userId } : { userId: req.user.userId };
+    await prisma.notification.updateMany({ where, data: { isRead: true } });
+    res.json({ message: 'Marked as read' });
+  } catch (err) { next(err); }
+});
+
+router.get('/preferences', async (req, res, next) => {
+  try {
+    let prefs = await prisma.notificationPreference.findUnique({ where: { userId: req.user.userId } });
+    if (!prefs) prefs = await prisma.notificationPreference.create({ data: { userId: req.user.userId } });
+    res.json(prefs);
+  } catch (err) { next(err); }
+});
+
+router.put('/preferences', async (req, res, next) => {
+  try {
+    const prefs = await prisma.notificationPreference.upsert({
+      where: { userId: req.user.userId },
+      create: { ...req.body, userId: req.user.userId },
+      update: req.body,
+    });
+    res.json(prefs);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/optimizer.js b/templates/crm-homecare/backend/src/routes/optimizer.js
new file mode 100644
index 0000000..355415f
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/optimizer.js
@@ -0,0 +1,49 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+// Company-level efficiency analysis
+router.get('/company', async (req, res, next) => {
+  try {
+    const activeClients = await prisma.client.findMany({
+      where: { isActive: true },
+      include: { assignments: { where: { status: 'active' }, include: { caregiver: { select: { id: true, firstName: true, lastName: true } } } } },
+    });
+
+    const understaffed = activeClients.filter(c => c.assignments.length === 0)
+      .map(c => ({ clientId: c.id, name: `${c.firstName} ${c.lastName}`, issue: 'No active caregiver assigned' }));
+
+    const caregiverHours = await prisma.timeEntry.groupBy({
+      by: ['caregiverId'],
+      where: { startTime: { gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) }, isComplete: true },
+      _sum: { durationMinutes: true },
+    });
+
+    const overscheduled = caregiverHours
+      .filter(c => (c._sum.durationMinutes || 0) > 40 * 60)
+      .map(c => ({ caregiverId: c.caregiverId, weeklyMinutes: c._sum.durationMinutes, issue: 'Over 40 hours this week' }));
+
+    res.json({ understaffedClients: understaffed, overscheduledCaregivers: overscheduled });
+  } catch (err) { next(err); }
+});
+
+// Route optimizer - find optimal caregiver order for multi-client days
+router.get('/routes', async (req, res, next) => {
+  try {
+    const { caregiverId, date } = req.query;
+    const dateObj = date ? new Date(date) : new Date();
+    const nextDay = new Date(dateObj); nextDay.setDate(dateObj.getDate() + 1);
+
+    const assignments = await prisma.clientAssignment.findMany({
+      where: { caregiverId, status: 'active' },
+      include: { client: { select: { firstName: true, lastName: true, address: true, city: true, latitude: true, longitude: true } } },
+    });
+
+    res.json({ caregiverId, date: dateObj.toISOString().split('T')[0], stops: assignments.map(a => a.client) });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/payers.js b/templates/crm-homecare/backend/src/routes/payers.js
new file mode 100644
index 0000000..d89e26e
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/payers.js
@@ -0,0 +1,32 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const payers = await prisma.referralSource.findMany({
+      where: { isActive: true },
+      orderBy: [{ isActivePayer: 'desc' }, { name: 'asc' }],
+    });
+    res.json(payers);
+  } catch (err) { next(err); }
+});
+
+router.post('/', requireAdmin, async (req, res, next) => {
+  try {
+    const payer = await prisma.referralSource.create({ data: req.body });
+    res.status(201).json(payer);
+  } catch (err) { next(err); }
+});
+
+router.put('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const payer = await prisma.referralSource.update({ where: { id: req.params.id }, data: req.body });
+    res.json(payer);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/payroll.js b/templates/crm-homecare/backend/src/routes/payroll.js
new file mode 100644
index 0000000..c5e9d38
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/payroll.js
@@ -0,0 +1,96 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+// GET payroll summary for a pay period
+router.get('/summary', async (req, res, next) => {
+  try {
+    const { startDate, endDate } = req.query;
+    if (!startDate || !endDate) return res.status(400).json({ error: 'startDate and endDate required' });
+
+    const entries = await prisma.timeEntry.findMany({
+      where: {
+        startTime: { gte: new Date(startDate), lte: new Date(endDate) },
+        isComplete: true,
+      },
+      include: { caregiver: { select: { id: true, firstName: true, lastName: true, defaultPayRate: true } } },
+    });
+
+    // Group by caregiver
+    const byCaregiver = {};
+    entries.forEach(e => {
+      const id = e.caregiverId;
+      if (!byCaregiver[id]) {
+        byCaregiver[id] = { caregiver: e.caregiver, totalMinutes: 0, totalPay: 0, entryCount: 0 };
+      }
+      byCaregiver[id].totalMinutes += e.billableMinutes || e.durationMinutes || 0;
+      byCaregiver[id].entryCount++;
+    });
+
+    Object.values(byCaregiver).forEach(c => {
+      const hours = c.totalMinutes / 60;
+      c.totalHours = Number(hours.toFixed(2));
+      c.totalPay = Number((hours * Number(c.caregiver.defaultPayRate || 15)).toFixed(2));
+    });
+
+    res.json({ payPeriodStart: startDate, payPeriodEnd: endDate, caregivers: Object.values(byCaregiver) });
+  } catch (err) { next(err); }
+});
+
+// GET /payroll/gusto/sync-log
+router.get('/gusto/sync-log', async (req, res, next) => {
+  try {
+    const logs = await prisma.gustoSyncLog.findMany({ orderBy: { createdAt: 'desc' }, take: 20 });
+    res.json(logs);
+  } catch (err) { next(err); }
+});
+
+// POST /payroll/gusto/sync
+router.post('/gusto/sync', async (req, res, next) => {
+  try {
+    const log = await prisma.gustoSyncLog.create({
+      data: {
+        syncType: 'export',
+        status: 'success',
+        payPeriodStart: req.body.startDate ? new Date(req.body.startDate) : undefined,
+        payPeriodEnd: req.body.endDate ? new Date(req.body.endDate) : undefined,
+        recordsExported: req.body.recordCount || 0,
+        createdById: req.user.userId,
+      },
+    });
+    res.json(log);
+  } catch (err) { next(err); }
+});
+
+// GET /payroll/expenses
+router.get('/expenses', async (req, res, next) => {
+  try {
+    const expenses = await prisma.expense.findMany({
+      where: req.query.status ? { status: req.query.status } : {},
+      orderBy: { createdAt: 'desc' },
+      include: { user: { select: { firstName: true, lastName: true } } },
+    });
+    res.json(expenses);
+  } catch (err) { next(err); }
+});
+
+router.post('/expenses', async (req, res, next) => {
+  try {
+    const expense = await prisma.expense.create({
+      data: { ...req.body, userId: req.user.role === 'caregiver' ? req.user.userId : req.body.userId },
+    });
+    res.status(201).json(expense);
+  } catch (err) { next(err); }
+});
+
+router.patch('/expenses/:id/status', async (req, res, next) => {
+  try {
+    const expense = await prisma.expense.update({ where: { id: req.params.id }, data: { status: req.body.status } });
+    res.json(expense);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/portal.js b/templates/crm-homecare/backend/src/routes/portal.js
new file mode 100644
index 0000000..23caa07
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/portal.js
@@ -0,0 +1,72 @@
+import { Router } from 'express';
+import jwt from 'jsonwebtoken';
+import { prisma } from '../index.js';
+
+const router = Router();
+
+// Portal uses its own lightweight auth (token-based, no password)
+const portalAuth = async (req, res, next) => {
+  const token = req.headers['x-portal-token'];
+  if (!token) return res.status(401).json({ error: 'Portal token required' });
+  try {
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+    req.portalClientId = decoded.clientId;
+    next();
+  } catch { res.status(401).json({ error: 'Invalid portal token' }); }
+};
+
+// Generate portal access link (admin only)
+router.post('/generate-link', async (req, res, next) => {
+  try {
+    const { clientId } = req.body;
+    const token = jwt.sign({ clientId, type: 'portal' }, process.env.JWT_SECRET, { expiresIn: '30d' });
+    res.json({ token, url: `${process.env.FRONTEND_URL}/portal?token=${token}` });
+  } catch (err) { next(err); }
+});
+
+// Portal endpoints (family-facing)
+router.get('/schedule', portalAuth, async (req, res, next) => {
+  try {
+    const schedules = await prisma.schedule.findMany({
+      where: { clientId: req.portalClientId, isActive: true },
+      orderBy: { effectiveDate: 'asc' },
+    });
+    res.json(schedules);
+  } catch (err) { next(err); }
+});
+
+router.get('/visits', portalAuth, async (req, res, next) => {
+  try {
+    const visits = await prisma.timeEntry.findMany({
+      where: { clientId: req.portalClientId, isComplete: true },
+      orderBy: { startTime: 'desc' },
+      take: 30,
+      include: { caregiver: { select: { firstName: true, lastName: true } } },
+    });
+    res.json(visits);
+  } catch (err) { next(err); }
+});
+
+router.get('/invoices', portalAuth, async (req, res, next) => {
+  try {
+    const invoices = await prisma.invoice.findMany({
+      where: { clientId: req.portalClientId },
+      orderBy: { createdAt: 'desc' },
+      take: 20,
+      include: { lineItems: true },
+    });
+    res.json(invoices);
+  } catch (err) { next(err); }
+});
+
+router.get('/caregivers', portalAuth, async (req, res, next) => {
+  try {
+    const assignments = await prisma.clientAssignment.findMany({
+      where: { clientId: req.portalClientId, status: 'active' },
+      include: { caregiver: { select: { firstName: true, lastName: true, phone: true, certifications: true } } },
+    });
+    res.json(assignments.map(a => a.caregiver));
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/push.js b/templates/crm-homecare/backend/src/routes/push.js
new file mode 100644
index 0000000..f8ba13f
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/push.js
@@ -0,0 +1,33 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.post('/subscribe', async (req, res, next) => {
+  try {
+    const sub = await prisma.pushSubscription.upsert({
+      where: { userId_subscription: { userId: req.user.userId, subscription: req.body.subscription } },
+      create: { userId: req.user.userId, subscription: req.body.subscription },
+      update: { isActive: true, updatedAt: new Date() },
+    });
+    res.json(sub);
+  } catch (err) { next(err); }
+});
+
+router.post('/unsubscribe', async (req, res, next) => {
+  try {
+    await prisma.pushSubscription.updateMany({
+      where: { userId: req.user.userId },
+      data: { isActive: false },
+    });
+    res.json({ message: 'Unsubscribed' });
+  } catch (err) { next(err); }
+});
+
+router.get('/vapid-key', (req, res) => {
+  res.json({ publicKey: process.env.VAPID_PUBLIC_KEY || '' });
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/remittance.js b/templates/crm-homecare/backend/src/routes/remittance.js
new file mode 100644
index 0000000..487760a
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/remittance.js
@@ -0,0 +1,36 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const batches = await prisma.remittanceBatch.findMany({
+      orderBy: { createdAt: 'desc' },
+      include: { payer: { select: { name: true } }, lineItems: true },
+    });
+    res.json(batches);
+  } catch (err) { next(err); }
+});
+
+router.post('/', async (req, res, next) => {
+  try {
+    const { lineItems, ...data } = req.body;
+    const batch = await prisma.remittanceBatch.create({
+      data: { ...data, createdById: req.user.userId, lineItems: lineItems ? { create: lineItems } : undefined },
+      include: { lineItems: true },
+    });
+    res.status(201).json(batch);
+  } catch (err) { next(err); }
+});
+
+router.patch('/:id', async (req, res, next) => {
+  try {
+    const batch = await prisma.remittanceBatch.update({ where: { id: req.params.id }, data: req.body });
+    res.json(batch);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/reports.js b/templates/crm-homecare/backend/src/routes/reports.js
new file mode 100644
index 0000000..0c82dcd
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/reports.js
@@ -0,0 +1,117 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+// Hours by caregiver
+router.get('/hours-by-caregiver', async (req, res, next) => {
+  try {
+    const { startDate, endDate } = req.query;
+    const where = { isComplete: true };
+    if (startDate || endDate) {
+      where.startTime = {};
+      if (startDate) where.startTime.gte = new Date(startDate);
+      if (endDate) where.startTime.lte = new Date(endDate);
+    }
+    const entries = await prisma.timeEntry.groupBy({
+      by: ['caregiverId'],
+      where,
+      _sum: { billableMinutes: true, durationMinutes: true },
+      _count: true,
+    });
+
+    const caregivers = await prisma.user.findMany({
+      where: { id: { in: entries.map(e => e.caregiverId) } },
+      select: { id: true, firstName: true, lastName: true, defaultPayRate: true },
+    });
+
+    const result = entries.map(e => {
+      const cg = caregivers.find(c => c.id === e.caregiverId);
+      const hours = (e._sum.billableMinutes || e._sum.durationMinutes || 0) / 60;
+      return { caregiver: cg, totalHours: Number(hours.toFixed(2)), visits: e._count, estimatedPay: Number((hours * Number(cg?.defaultPayRate || 15)).toFixed(2)) };
+    });
+
+    res.json(result);
+  } catch (err) { next(err); }
+});
+
+// Revenue by period
+router.get('/revenue', async (req, res, next) => {
+  try {
+    const { startDate, endDate } = req.query;
+    const where = {};
+    if (startDate || endDate) {
+      where.billingPeriodStart = {};
+      if (startDate) where.billingPeriodStart.gte = new Date(startDate);
+      if (endDate) where.billingPeriodStart.lte = new Date(endDate);
+    }
+    const summary = await prisma.invoice.aggregate({
+      where,
+      _sum: { total: true, subtotal: true },
+      _count: true,
+    });
+    const byStatus = await prisma.invoice.groupBy({ by: ['paymentStatus'], where, _sum: { total: true }, _count: true });
+    res.json({ summary, byStatus });
+  } catch (err) { next(err); }
+});
+
+// Client census
+router.get('/census', async (req, res, next) => {
+  try {
+    const byService = await prisma.client.groupBy({ by: ['serviceType'], where: { isActive: true }, _count: true });
+    const total = await prisma.client.count({ where: { isActive: true } });
+    const newThisMonth = await prisma.client.count({
+      where: { startDate: { gte: new Date(new Date().getFullYear(), new Date().getMonth(), 1) } },
+    });
+    res.json({ total, newThisMonth, byServiceType: byService });
+  } catch (err) { next(err); }
+});
+
+// Payer mix
+router.get('/payer-mix', async (req, res, next) => {
+  try {
+    const mix = await prisma.client.groupBy({
+      by: ['insuranceProvider'],
+      where: { isActive: true },
+      _count: true,
+    });
+    res.json(mix.sort((a, b) => b._count - a._count));
+  } catch (err) { next(err); }
+});
+
+// Revenue forecast
+router.get('/forecast', async (req, res, next) => {
+  try {
+    const activeAuths = await prisma.authorization.findMany({
+      where: { status: 'active', endDate: { gte: new Date() } },
+      include: { client: { select: { firstName: true, lastName: true } } },
+    });
+    const forecast = activeAuths.map(a => {
+      const remainingUnits = Number(a.authorizedUnits) - Number(a.usedUnits);
+      return { clientName: `${a.client.firstName} ${a.client.lastName}`, remainingUnits, endDate: a.endDate, procedureCode: a.procedureCode };
+    });
+    res.json({ activeAuthorizationsCount: activeAuths.length, forecast });
+  } catch (err) { next(err); }
+});
+
+// No-show rate
+router.get('/noshow-rate', async (req, res, next) => {
+  try {
+    const { startDate, endDate } = req.query;
+    const where = {};
+    if (startDate || endDate) {
+      where.date = {};
+      if (startDate) where.date.gte = new Date(startDate);
+      if (endDate) where.date.lte = new Date(endDate);
+    }
+    const [total, noShows] = await Promise.all([
+      prisma.timeEntry.count({ where: { isComplete: true, ...where.date ? { startTime: where.date } : {} } }),
+      prisma.absence.count({ where: { type: 'no_show', ...where } }),
+    ]);
+    res.json({ totalShifts: total, noShows, rate: total > 0 ? Number((noShows / total * 100).toFixed(1)) : 0 });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/scheduling.js b/templates/crm-homecare/backend/src/routes/scheduling.js
new file mode 100644
index 0000000..540e481
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/scheduling.js
@@ -0,0 +1,234 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// ── SCHEDULES ─────────────────────────────────────────────────────
+
+router.get('/schedules', async (req, res, next) => {
+  try {
+    const { clientId, caregiverId, startDate, endDate } = req.query;
+    const where = {};
+    if (clientId) where.clientId = clientId;
+    if (caregiverId) where.caregiverId = caregiverId;
+    if (startDate || endDate) {
+      where.effectiveDate = {};
+      if (startDate) where.effectiveDate.gte = new Date(startDate);
+      if (endDate) where.effectiveDate.lte = new Date(endDate);
+    }
+    const schedules = await prisma.schedule.findMany({ where, orderBy: { effectiveDate: 'asc' } });
+    res.json(schedules);
+  } catch (err) { next(err); }
+});
+
+router.post('/schedules', requireAdmin, async (req, res, next) => {
+  try {
+    const schedule = await prisma.schedule.create({ data: req.body });
+    res.status(201).json(schedule);
+  } catch (err) { next(err); }
+});
+
+router.put('/schedules/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const schedule = await prisma.schedule.update({ where: { id: req.params.id }, data: req.body });
+    res.json(schedule);
+  } catch (err) { next(err); }
+});
+
+router.delete('/schedules/:id', requireAdmin, async (req, res, next) => {
+  try {
+    await prisma.schedule.delete({ where: { id: req.params.id } });
+    res.json({ message: 'Deleted' });
+  } catch (err) { next(err); }
+});
+
+// ── CAREGIVER SCHEDULES (availability calendar) ───────────────────
+
+router.get('/caregiver-schedules', async (req, res, next) => {
+  try {
+    const { caregiverId, startDate, endDate } = req.query;
+    const where = {};
+    if (caregiverId) where.caregiverId = caregiverId;
+    if (startDate || endDate) {
+      where.date = {};
+      if (startDate) where.date.gte = new Date(startDate);
+      if (endDate) where.date.lte = new Date(endDate);
+    }
+    const schedules = await prisma.caregiverSchedule.findMany({ where, orderBy: { date: 'asc' }, include: { caregiver: { select: { firstName: true, lastName: true } } } });
+    res.json(schedules);
+  } catch (err) { next(err); }
+});
+
+router.post('/caregiver-schedules', requireAdmin, async (req, res, next) => {
+  try {
+    const schedule = await prisma.caregiverSchedule.create({ data: req.body });
+    res.status(201).json(schedule);
+  } catch (err) { next(err); }
+});
+
+// ── TIME OFF ──────────────────────────────────────────────────────
+
+router.get('/time-off', async (req, res, next) => {
+  try {
+    const { caregiverId, status } = req.query;
+    const where = {};
+    if (caregiverId) where.caregiverId = caregiverId;
+    if (status) where.status = status;
+    const timeOff = await prisma.caregiverTimeOff.findMany({
+      where,
+      orderBy: { startDate: 'desc' },
+      include: { caregiver: { select: { firstName: true, lastName: true } } },
+    });
+    res.json(timeOff);
+  } catch (err) { next(err); }
+});
+
+router.post('/time-off', async (req, res, next) => {
+  try {
+    const caregiverId = req.user.role === 'caregiver' ? req.user.userId : req.body.caregiverId;
+    const timeOff = await prisma.caregiverTimeOff.create({ data: { ...req.body, caregiverId } });
+    res.status(201).json(timeOff);
+  } catch (err) { next(err); }
+});
+
+router.patch('/time-off/:id/approve', requireAdmin, async (req, res, next) => {
+  try {
+    const updated = await prisma.caregiverTimeOff.update({
+      where: { id: req.params.id },
+      data: { status: 'approved', approvedById: req.user.userId },
+    });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+router.patch('/time-off/:id/reject', requireAdmin, async (req, res, next) => {
+  try {
+    const updated = await prisma.caregiverTimeOff.update({ where: { id: req.params.id }, data: { status: 'rejected' } });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// ── OPEN SHIFTS ───────────────────────────────────────────────────
+
+router.get('/open-shifts', async (req, res, next) => {
+  try {
+    const { status = 'open' } = req.query;
+    const shifts = await prisma.openShift.findMany({
+      where: { status },
+      orderBy: { date: 'asc' },
+      include: { notifications: true },
+    });
+    res.json(shifts);
+  } catch (err) { next(err); }
+});
+
+router.post('/open-shifts', requireAdmin, async (req, res, next) => {
+  try {
+    const shift = await prisma.openShift.create({ data: { ...req.body, createdById: req.user.userId } });
+    res.status(201).json(shift);
+  } catch (err) { next(err); }
+});
+
+router.patch('/open-shifts/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const shift = await prisma.openShift.update({ where: { id: req.params.id }, data: req.body });
+    res.json(shift);
+  } catch (err) { next(err); }
+});
+
+// ── ABSENCES ──────────────────────────────────────────────────────
+
+router.get('/absences', async (req, res, next) => {
+  try {
+    const { startDate, endDate, caregiverId } = req.query;
+    const where = {};
+    if (caregiverId) where.caregiverId = caregiverId;
+    if (startDate || endDate) {
+      where.date = {};
+      if (startDate) where.date.gte = new Date(startDate);
+      if (endDate) where.date.lte = new Date(endDate);
+    }
+    const absences = await prisma.absence.findMany({
+      where,
+      orderBy: { date: 'desc' },
+      include: {
+        caregiver: { select: { firstName: true, lastName: true } },
+        coverageAssigned: { select: { firstName: true, lastName: true } },
+      },
+    });
+    res.json(absences);
+  } catch (err) { next(err); }
+});
+
+router.post('/absences', requireAdmin, async (req, res, next) => {
+  try {
+    const absence = await prisma.absence.create({
+      data: { ...req.body, reportedById: req.user.userId },
+    });
+
+    // Auto-create open shift if coverage needed
+    if (absence.coverageNeeded) {
+      await prisma.openShift.create({
+        data: {
+          clientId: absence.clientId,
+          date: absence.date,
+          autoCreated: true,
+          sourceAbsenceId: absence.id,
+          createdById: req.user.userId,
+        },
+      });
+    }
+
+    res.status(201).json(absence);
+  } catch (err) { next(err); }
+});
+
+// ── NO-SHOW ALERTS ────────────────────────────────────────────────
+
+router.get('/noshow-alerts', requireAdmin, async (req, res, next) => {
+  try {
+    const alerts = await prisma.noshowAlert.findMany({
+      where: { status: 'open' },
+      orderBy: { alertedAt: 'desc' },
+      include: {
+        caregiver: { select: { firstName: true, lastName: true, phone: true } },
+        client: { select: { firstName: true, lastName: true, address: true } },
+      },
+    });
+    res.json(alerts);
+  } catch (err) { next(err); }
+});
+
+router.patch('/noshow-alerts/:id/resolve', requireAdmin, async (req, res, next) => {
+  try {
+    const alert = await prisma.noshowAlert.update({
+      where: { id: req.params.id },
+      data: { status: req.body.status || 'resolved', resolvedAt: new Date(), resolvedById: req.user.userId, resolutionNote: req.body.resolutionNote },
+    });
+    res.json(alert);
+  } catch (err) { next(err); }
+});
+
+router.get('/noshow-config', requireAdmin, async (req, res, next) => {
+  try {
+    let config = await prisma.noshowAlertConfig.findFirst();
+    if (!config) config = await prisma.noshowAlertConfig.create({ data: {} });
+    res.json(config);
+  } catch (err) { next(err); }
+});
+
+router.put('/noshow-config', requireAdmin, async (req, res, next) => {
+  try {
+    let config = await prisma.noshowAlertConfig.findFirst();
+    if (config) {
+      config = await prisma.noshowAlertConfig.update({ where: { id: config.id }, data: req.body });
+    } else {
+      config = await prisma.noshowAlertConfig.create({ data: req.body });
+    }
+    res.json(config);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/serviceCodes.js b/templates/crm-homecare/backend/src/routes/serviceCodes.js
new file mode 100644
index 0000000..015b427
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/serviceCodes.js
@@ -0,0 +1,29 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+router.get('/', async (req, res, next) => {
+  try {
+    const codes = await prisma.serviceCode.findMany({ where: { isActive: true }, orderBy: { code: 'asc' } });
+    res.json(codes);
+  } catch (err) { next(err); }
+});
+
+router.post('/', requireAdmin, async (req, res, next) => {
+  try {
+    const code = await prisma.serviceCode.create({ data: req.body });
+    res.status(201).json(code);
+  } catch (err) { next(err); }
+});
+
+router.put('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const code = await prisma.serviceCode.update({ where: { id: req.params.id }, data: req.body });
+    res.json(code);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/sms.js b/templates/crm-homecare/backend/src/routes/sms.js
new file mode 100644
index 0000000..e3150ff
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/sms.js
@@ -0,0 +1,22 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.post('/send', async (req, res, next) => {
+  try {
+    const { to, body } = req.body;
+    if (!process.env.TWILIO_ACCOUNT_SID) {
+      return res.status(503).json({ error: 'SMS not configured. Add Twilio credentials to enable SMS.' });
+    }
+    // Dynamic import to avoid crash if twilio not configured
+    const twilio = await import('twilio');
+    const client = twilio.default(process.env.TWILIO_ACCOUNT_SID, process.env.TWILIO_AUTH_TOKEN);
+    const message = await client.messages.create({ from: process.env.TWILIO_PHONE_NUMBER, to, body });
+    res.json({ sid: message.sid, status: message.status });
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/stripe.js b/templates/crm-homecare/backend/src/routes/stripe.js
new file mode 100644
index 0000000..a30f532
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/stripe.js
@@ -0,0 +1,11 @@
+import { Router } from 'express';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate, requireAdmin);
+
+router.get('/status', (req, res) => {
+  res.json({ configured: !!process.env.STRIPE_SECRET_KEY });
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/routes/timeTracking.js b/templates/crm-homecare/backend/src/routes/timeTracking.js
new file mode 100644
index 0000000..1d70a94
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/timeTracking.js
@@ -0,0 +1,178 @@
+import { Router } from 'express';
+import { prisma } from '../index.js';
+import { authenticate, requireAdmin } from '../middleware/auth.js';
+
+const router = Router();
+router.use(authenticate);
+
+// GET /api/time-tracking
+router.get('/', async (req, res, next) => {
+  try {
+    const { caregiverId, clientId, startDate, endDate, isComplete, page = 1, limit = 50 } = req.query;
+    const skip = (parseInt(page) - 1) * parseInt(limit);
+
+    const where = {};
+    if (req.user.role === 'caregiver') where.caregiverId = req.user.userId;
+    else if (caregiverId) where.caregiverId = caregiverId;
+    if (clientId) where.clientId = clientId;
+    if (isComplete !== undefined) where.isComplete = isComplete === 'true';
+    if (startDate || endDate) {
+      where.startTime = {};
+      if (startDate) where.startTime.gte = new Date(startDate);
+      if (endDate) where.startTime.lte = new Date(new Date(endDate).setHours(23, 59, 59));
+    }
+
+    const [entries, total] = await Promise.all([
+      prisma.timeEntry.findMany({
+        where, skip, take: parseInt(limit),
+        orderBy: { startTime: 'desc' },
+        include: {
+          caregiver: { select: { firstName: true, lastName: true } },
+          client: { select: { firstName: true, lastName: true, address: true, city: true } },
+          evvVisit: { select: { id: true, sandataStatus: true, isVerified: true } },
+        },
+      }),
+      prisma.timeEntry.count({ where }),
+    ]);
+
+    res.json({ entries, total, page: parseInt(page), pages: Math.ceil(total / parseInt(limit)) });
+  } catch (err) { next(err); }
+});
+
+// GET /api/time-tracking/active - caregivers currently clocked in
+router.get('/active', requireAdmin, async (req, res, next) => {
+  try {
+    const active = await prisma.timeEntry.findMany({
+      where: { endTime: null, isComplete: false },
+      include: {
+        caregiver: { select: { id: true, firstName: true, lastName: true, phone: true } },
+        client: { select: { id: true, firstName: true, lastName: true, address: true, city: true } },
+        gpsPoints: { orderBy: { timestamp: 'desc' }, take: 1 },
+      },
+    });
+    res.json(active);
+  } catch (err) { next(err); }
+});
+
+// POST /api/time-tracking/clock-in
+router.post('/clock-in', async (req, res, next) => {
+  try {
+    const { clientId, scheduleId, clockInLocation, notes } = req.body;
+    const caregiverId = req.user.role === 'caregiver' ? req.user.userId : req.body.caregiverId;
+
+    // Check not already clocked in
+    const existing = await prisma.timeEntry.findFirst({
+      where: { caregiverId, endTime: null, isComplete: false },
+    });
+    if (existing) return res.status(400).json({ error: 'Already clocked in. Clock out first.' });
+
+    const entry = await prisma.timeEntry.create({
+      data: { caregiverId, clientId, scheduleId, startTime: new Date(), clockInLocation, notes },
+      include: {
+        caregiver: { select: { firstName: true, lastName: true } },
+        client: { select: { firstName: true, lastName: true } },
+      },
+    });
+    res.status(201).json(entry);
+  } catch (err) { next(err); }
+});
+
+// POST /api/time-tracking/clock-out
+router.post('/clock-out', async (req, res, next) => {
+  try {
+    const { timeEntryId, clockOutLocation, notes } = req.body;
+    const caregiverId = req.user.role === 'caregiver' ? req.user.userId : req.body.caregiverId;
+
+    const entry = await prisma.timeEntry.findFirst({
+      where: { id: timeEntryId, caregiverId, endTime: null },
+    });
+    if (!entry) return res.status(404).json({ error: 'Active time entry not found' });
+
+    const endTime = new Date();
+    const durationMinutes = Math.round((endTime - entry.startTime) / 60000);
+
+    const updated = await prisma.timeEntry.update({
+      where: { id: entry.id },
+      data: {
+        endTime,
+        durationMinutes,
+        billableMinutes: durationMinutes,
+        clockOutLocation,
+        notes: notes || entry.notes,
+        isComplete: true,
+      },
+    });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// POST /api/time-tracking/gps
+router.post('/gps', async (req, res, next) => {
+  try {
+    const { timeEntryId, latitude, longitude, accuracy, speed, heading } = req.body;
+    const point = await prisma.gpsTracking.create({
+      data: {
+        caregiverId: req.user.userId,
+        timeEntryId,
+        latitude,
+        longitude,
+        accuracy,
+        speed,
+        heading,
+      },
+    });
+    res.status(201).json(point);
+  } catch (err) { next(err); }
+});
+
+// PUT /api/time-tracking/:id - admin edit
+router.put('/:id', requireAdmin, async (req, res, next) => {
+  try {
+    const { startTime, endTime, notes, billableMinutes } = req.body;
+    const data = {};
+    if (startTime) data.startTime = new Date(startTime);
+    if (endTime) {
+      data.endTime = new Date(endTime);
+      data.isComplete = true;
+      if (startTime) data.durationMinutes = Math.round((new Date(endTime) - new Date(startTime)) / 60000);
+    }
+    if (notes !== undefined) data.notes = notes;
+    if (billableMinutes !== undefined) data.billableMinutes = billableMinutes;
+
+    const updated = await prisma.timeEntry.update({ where: { id: req.params.id }, data });
+    res.json(updated);
+  } catch (err) { next(err); }
+});
+
+// GET /api/time-tracking/:id/gps
+router.get('/:id/gps', requireAdmin, async (req, res, next) => {
+  try {
+    const points = await prisma.gpsTracking.findMany({
+      where: { timeEntryId: req.params.id },
+      orderBy: { timestamp: 'asc' },
+    });
+    res.json(points);
+  } catch (err) { next(err); }
+});
+
+// GET /api/time-tracking/geofence/:clientId
+router.get('/geofence/:clientId', async (req, res, next) => {
+  try {
+    const settings = await prisma.geofenceSettings.findUnique({ where: { clientId: req.params.clientId } });
+    const client = await prisma.client.findUnique({ where: { id: req.params.clientId }, select: { latitude: true, longitude: true, address: true } });
+    res.json({ settings, client });
+  } catch (err) { next(err); }
+});
+
+router.post('/geofence/:clientId', requireAdmin, async (req, res, next) => {
+  try {
+    const settings = await prisma.geofenceSettings.upsert({
+      where: { clientId: req.params.clientId },
+      create: { ...req.body, clientId: req.params.clientId },
+      update: req.body,
+    });
+    res.json(settings);
+  } catch (err) { next(err); }
+});
+
+export default router;
diff --git a/templates/crm-homecare/backend/src/services/logger.js b/templates/crm-homecare/backend/src/services/logger.js
new file mode 100644
index 0000000..ad6b09a
--- /dev/null
+++ b/templates/crm-homecare/backend/src/services/logger.js
@@ -0,0 +1,21 @@
+import winston from 'winston';
+
+const logger = winston.createLogger({
+  level: process.env.LOG_LEVEL || 'info',
+  format: winston.format.combine(
+    winston.format.timestamp(),
+    winston.format.errors({ stack: true }),
+    process.env.NODE_ENV === 'production'
+      ? winston.format.json()
+      : winston.format.combine(
+          winston.format.colorize(),
+          winston.format.printf(({ timestamp, level, message, ...meta }) => {
+            const metaStr = Object.keys(meta).length ? ' ' + JSON.stringify(meta) : '';
+            return `${timestamp} [${level}] ${message}${metaStr}`;
+          })
+        )
+  ),
+  transports: [new winston.transports.Console()],
+});
+
+export default logger;
diff --git a/templates/crm-homecare/backend/src/services/socket.js b/templates/crm-homecare/backend/src/services/socket.js
new file mode 100644
index 0000000..0d5ae14
--- /dev/null
+++ b/templates/crm-homecare/backend/src/services/socket.js
@@ -0,0 +1,48 @@
+import { Server } from 'socket.io';
+import jwt from 'jsonwebtoken';
+import logger from './logger.js';
+
+let io;
+
+export const initializeSocket = (server) => {
+  io = new Server(server, {
+    cors: {
+      origin: process.env.FRONTEND_URL || 'http://localhost:5173',
+      credentials: true,
+    },
+  });
+
+  io.use((socket, next) => {
+    try {
+      const token = socket.handshake.auth.token;
+      if (!token) return next(new Error('No token'));
+      const decoded = jwt.verify(token, process.env.JWT_SECRET);
+      socket.userId = decoded.userId;
+      socket.role = decoded.role;
+      next();
+    } catch {
+      next(new Error('Authentication error'));
+    }
+  });
+
+  io.on('connection', (socket) => {
+    socket.join(`user:${socket.userId}`);
+    logger.info(`Socket connected: ${socket.userId}`);
+
+    socket.on('disconnect', () => {
+      logger.info(`Socket disconnected: ${socket.userId}`);
+    });
+  });
+
+  return io;
+};
+
+export const emitToUser = (userId, event, data) => {
+  if (io) io.to(`user:${userId}`).emit(event, data);
+};
+
+export const emitToAll = (event, data) => {
+  if (io) io.emit(event, data);
+};
+
+export { io };
diff --git a/templates/crm-homecare/backend/src/utils/errors.js b/templates/crm-homecare/backend/src/utils/errors.js
new file mode 100644
index 0000000..0c431d4
--- /dev/null
+++ b/templates/crm-homecare/backend/src/utils/errors.js
@@ -0,0 +1,28 @@
+import logger from '../services/logger.js';
+
+export const errorHandler = (err, req, res, next) => {
+  const status = err.status || err.statusCode || 500;
+  const message = err.message || 'Internal server error';
+
+  if (status >= 500) {
+    logger.error('Unhandled error', { error: message, stack: err.stack, path: req.path });
+  }
+
+  res.status(status).json({
+    error: process.env.NODE_ENV === 'production' && status >= 500 ? 'Internal server error' : message,
+  });
+};
+
+export const notFoundHandler = (req, res) => {
+  res.status(404).json({ error: `Route not found: ${req.method} ${req.path}` });
+};
+
+export const handleUncaughtExceptions = () => {
+  process.on('uncaughtException', (err) => {
+    logger.error('Uncaught exception', { error: err.message, stack: err.stack });
+    process.exit(1);
+  });
+  process.on('unhandledRejection', (reason) => {
+    logger.error('Unhandled rejection', { reason: String(reason) });
+  });
+};
diff --git a/templates/crm-homecare/frontend/.env.example b/templates/crm-homecare/frontend/.env.example
new file mode 100644
index 0000000..a52215e
--- /dev/null
+++ b/templates/crm-homecare/frontend/.env.example
@@ -0,0 +1,4 @@
+# {{COMPANY_NAME}} Care — Frontend Config
+VITE_API_URL={{BACKEND_URL}}
+VITE_COMPANY_NAME={{COMPANY_NAME}}
+VITE_PRIMARY_COLOR={{PRIMARY_COLOR}}
diff --git a/templates/crm-homecare/frontend/.gitignore b/templates/crm-homecare/frontend/.gitignore
new file mode 100644
index 0000000..deed335
--- /dev/null
+++ b/templates/crm-homecare/frontend/.gitignore
@@ -0,0 +1,3 @@
+node_modules/
+dist/
+.env
diff --git a/templates/crm-homecare/frontend/index.html b/templates/crm-homecare/frontend/index.html
new file mode 100644
index 0000000..22bb1e8
--- /dev/null
+++ b/templates/crm-homecare/frontend/index.html
@@ -0,0 +1,14 @@
+<!doctype html>
+<html lang="en">
+  <head>
+    <meta charset="UTF-8" />
+    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
+    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+    <title>{{COMPANY_NAME}} Care</title>
+    <meta name="description" content="{{COMPANY_NAME}} Home Care Management System" />
+  </head>
+  <body>
+    <div id="root"></div>
+    <script type="module" src="/src/main.jsx"></script>
+  </body>
+</html>
diff --git a/templates/crm-homecare/frontend/package.json b/templates/crm-homecare/frontend/package.json
new file mode 100644
index 0000000..8766065
--- /dev/null
+++ b/templates/crm-homecare/frontend/package.json
@@ -0,0 +1,29 @@
+{
+  "name": "twomiah-care-frontend",
+  "private": true,
+  "version": "1.0.0",
+  "type": "module",
+  "scripts": {
+    "dev": "vite",
+    "build": "vite build",
+    "preview": "vite preview"
+  },
+  "dependencies": {
+    "clsx": "^2.1.1",
+    "lucide-react": "^0.344.0",
+    "react": "^18.2.0",
+    "react-dom": "^18.2.0",
+    "react-router-dom": "^6.22.1",
+    "socket.io-client": "^4.7.4",
+    "zustand": "^4.5.0"
+  },
+  "devDependencies": {
+    "@types/react": "^18.2.56",
+    "@types/react-dom": "^18.2.19",
+    "@vitejs/plugin-react": "^4.2.1",
+    "autoprefixer": "^10.4.17",
+    "postcss": "^8.4.35",
+    "tailwindcss": "^3.4.1",
+    "vite": "^5.1.4"
+  }
+}
diff --git a/templates/crm-homecare/frontend/postcss.config.js b/templates/crm-homecare/frontend/postcss.config.js
new file mode 100644
index 0000000..e008c9c
--- /dev/null
+++ b/templates/crm-homecare/frontend/postcss.config.js
@@ -0,0 +1,3 @@
+export default {
+  plugins: { tailwindcss: {}, autoprefixer: {} },
+};
diff --git a/templates/crm-homecare/frontend/src/App.jsx b/templates/crm-homecare/frontend/src/App.jsx
new file mode 100644
index 0000000..da6a852
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/App.jsx
@@ -0,0 +1,93 @@
+import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
+import { AuthProvider, useAuth } from './contexts/AuthContext.jsx';
+import { ToastProvider } from './contexts/ToastContext.jsx';
+
+// Layout & Auth
+import AppLayout from './components/layout/AppLayout.jsx';
+import LoginPage from './pages/LoginPage.jsx';
+
+// Admin Pages
+import DashboardPage from './pages/DashboardPage.jsx';
+import ClientsPage from './pages/ClientsPage.jsx';
+import ClientDetailPage from './pages/ClientDetailPage.jsx';
+import CaregiversPage from './pages/CaregiversPage.jsx';
+import CaregiverDetailPage from './pages/CaregiverDetailPage.jsx';
+import SchedulingPage from './pages/SchedulingPage.jsx';
+import TimeTrackingPage from './pages/TimeTrackingPage.jsx';
+import BillingPage from './pages/BillingPage.jsx';
+import PayrollPage from './pages/PayrollPage.jsx';
+import ReportsPage from './pages/ReportsPage.jsx';
+import CompliancePage from './pages/CompliancePage.jsx';
+import CommunicationPage from './pages/CommunicationPage.jsx';
+import FormsPage from './pages/FormsPage.jsx';
+import EVVPage from './pages/EVVPage.jsx';
+import ClaimsPage from './pages/ClaimsPage.jsx';
+import DocumentsPage from './pages/DocumentsPage.jsx';
+import NotificationsPage from './pages/NotificationsPage.jsx';
+import SettingsPage from './pages/SettingsPage.jsx';
+import AuditPage from './pages/AuditPage.jsx';
+
+// Caregiver portal
+import CaregiverPortalPage from './pages/CaregiverPortalPage.jsx';
+
+// Family portal
+import FamilyPortalPage from './pages/FamilyPortalPage.jsx';
+
+function ProtectedRoute({ children, adminOnly = false }) {
+  const { user, loading } = useAuth();
+  if (loading) return <div className="min-h-screen flex items-center justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary" style={{ borderColor: 'var(--color-primary)' }} /></div>;
+  if (!user) return <Navigate to="/login" replace />;
+  if (adminOnly && user.role === 'caregiver') return <Navigate to="/caregiver" replace />;
+  return children;
+}
+
+function AppRoutes() {
+  const { user } = useAuth();
+
+  return (
+    <Routes>
+      <Route path="/login" element={user ? <Navigate to={user.role === 'caregiver' ? '/caregiver' : '/'} replace /> : <LoginPage />} />
+      <Route path="/portal" element={<FamilyPortalPage />} />
+
+      {/* Admin routes */}
+      <Route path="/" element={<ProtectedRoute adminOnly><AppLayout /></ProtectedRoute>}>
+        <Route index element={<DashboardPage />} />
+        <Route path="clients" element={<ClientsPage />} />
+        <Route path="clients/:id" element={<ClientDetailPage />} />
+        <Route path="caregivers" element={<CaregiversPage />} />
+        <Route path="caregivers/:id" element={<CaregiverDetailPage />} />
+        <Route path="scheduling" element={<SchedulingPage />} />
+        <Route path="time-tracking" element={<TimeTrackingPage />} />
+        <Route path="billing" element={<BillingPage />} />
+        <Route path="payroll" element={<PayrollPage />} />
+        <Route path="compliance" element={<CompliancePage />} />
+        <Route path="communication" element={<CommunicationPage />} />
+        <Route path="forms" element={<FormsPage />} />
+        <Route path="evv" element={<EVVPage />} />
+        <Route path="claims" element={<ClaimsPage />} />
+        <Route path="documents" element={<DocumentsPage />} />
+        <Route path="notifications" element={<NotificationsPage />} />
+        <Route path="reports" element={<ReportsPage />} />
+        <Route path="audit" element={<AuditPage />} />
+        <Route path="settings" element={<SettingsPage />} />
+      </Route>
+
+      {/* Caregiver dashboard */}
+      <Route path="/caregiver/*" element={<ProtectedRoute><CaregiverPortalPage /></ProtectedRoute>} />
+
+      <Route path="*" element={<Navigate to="/" replace />} />
+    </Routes>
+  );
+}
+
+export default function App() {
+  return (
+    <BrowserRouter>
+      <AuthProvider>
+        <ToastProvider>
+          <AppRoutes />
+        </ToastProvider>
+      </AuthProvider>
+    </BrowserRouter>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/AddressLink.jsx b/templates/crm-homecare/frontend/src/components/AddressLink.jsx
new file mode 100644
index 0000000..f14796c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/AddressLink.jsx
@@ -0,0 +1,120 @@
+// src/components/common/AddressLink.jsx
+import React from 'react';
+
+/**
+ * Clickable address that opens in Google Maps
+ * 
+ * Usage:
+ * <AddressLink 
+ *   address="123 Main St"
+ *   city="Eau Claire"
+ *   state="WI"
+ *   zip="54701"
+ * />
+ * 
+ * Or with full address string:
+ * <AddressLink fullAddress="123 Main St, Eau Claire, WI 54701" />
+ */
+const AddressLink = ({ 
+  address, 
+  city, 
+  state, 
+  zip, 
+  fullAddress,
+  showIcon = true,
+  style = {}
+}) => {
+  // Build full address from parts or use fullAddress prop
+  const getFullAddress = () => {
+    if (fullAddress) return fullAddress;
+    
+    const parts = [];
+    if (address) parts.push(address);
+    if (city) parts.push(city);
+    if (state && zip) {
+      parts.push(`${state} ${zip}`);
+    } else if (state) {
+      parts.push(state);
+    } else if (zip) {
+      parts.push(zip);
+    }
+    return parts.join(', ');
+  };
+
+  const addressString = getFullAddress();
+  
+  if (!addressString) return <span style={{ color: '#999' }}>No address</span>;
+
+  // Encode address for URL
+  const encodedAddress = encodeURIComponent(addressString);
+  
+  // Google Maps URL - works on both desktop and mobile
+  // On mobile, it will open the Maps app if installed
+  const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
+
+  const handleClick = (e) => {
+    e.stopPropagation(); // Prevent triggering parent onClick handlers
+    window.open(mapsUrl, '_blank', 'noopener,noreferrer');
+  };
+
+  return (
+    <span
+      onClick={handleClick}
+      style={{
+        color: '#1976d2',
+        cursor: 'pointer',
+        textDecoration: 'underline',
+        textDecorationStyle: 'dotted',
+        display: 'inline-flex',
+        alignItems: 'center',
+        gap: '0.25rem',
+        ...style
+      }}
+      title="Open in Google Maps"
+    >
+      {showIcon && <span style={{ fontSize: '0.9em' }}>📍</span>}
+      {addressString}
+    </span>
+  );
+};
+
+export default AddressLink;
+
+
+// =====================================================
+// ALTERNATIVE: Simple function you can use anywhere
+// =====================================================
+
+/**
+ * Simple function to open address in Google Maps
+ * 
+ * Usage:
+ * <span onClick={() => openInMaps('123 Main St, Eau Claire, WI')}>
+ *   123 Main St
+ * </span>
+ */
+export const openInMaps = (address) => {
+  if (!address) return;
+  const encodedAddress = encodeURIComponent(address);
+  window.open(`https://www.google.com/maps/search/?api=1&query=${encodedAddress}`, '_blank');
+};
+
+
+// =====================================================
+// ALTERNATIVE: Get directions from current location
+// =====================================================
+
+/**
+ * Open directions in Google Maps from current location
+ * 
+ * Usage:
+ * <button onClick={() => getDirections('123 Main St, Eau Claire, WI')}>
+ *   Get Directions
+ * </button>
+ */
+export const getDirections = (destinationAddress) => {
+  if (!destinationAddress) return;
+  const encodedAddress = encodeURIComponent(destinationAddress);
+  // This will prompt for starting location or use current location on mobile
+  window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodedAddress}`, '_blank');
+};
diff --git a/templates/crm-homecare/frontend/src/components/CaregiverClientModal.jsx b/templates/crm-homecare/frontend/src/components/CaregiverClientModal.jsx
new file mode 100644
index 0000000..9cdfb9f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/CaregiverClientModal.jsx
@@ -0,0 +1,286 @@
+// src/components/CaregiverClientModal.jsx
+// What caregivers see when they click on a client - care-focused info only, no admin/billing
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../config';
+
+const CaregiverClientModal = ({ clientId, isOpen, onClose, token }) => {
+  const [client, setClient] = useState(null);
+  const [visitNotes, setVisitNotes] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [activeTab, setActiveTab] = useState('info');
+  const [newNote, setNewNote] = useState('');
+  const [submitting, setSubmitting] = useState(false);
+
+  useEffect(() => {
+    if (isOpen && clientId) {
+      loadClientData();
+    }
+  }, [isOpen, clientId]);
+
+  const loadClientData = async () => {
+    setLoading(true);
+    try {
+      const [clientRes, notesRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/clients/${clientId}/caregiver-view`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients/${clientId}/visit-notes`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      if (clientRes.ok) {
+        setClient(await clientRes.json());
+      }
+      if (notesRes.ok) {
+        setVisitNotes(await notesRes.json());
+      }
+    } catch (error) {
+      console.error('Failed to load client data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleAddNote = async (e) => {
+    e.preventDefault();
+    if (!newNote.trim()) return;
+
+    setSubmitting(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients/${clientId}/visit-notes`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ note: newNote })
+      });
+
+      if (!response.ok) throw new Error('Failed to add note');
+
+      setNewNote('');
+      loadClientData();
+    } catch (error) {
+      alert('Failed to add note: ' + error.message);
+    } finally {
+      setSubmitting(false);
+    }
+  };
+
+  if (!isOpen) return null;
+
+  const tabs = [
+    { id: 'info', label: '📋 Info' },
+    { id: 'medical', label: '🏥 Medical' },
+    { id: 'notes', label: '📝 Notes' }
+  ];
+
+  return (
+    <div className="modal active">
+      <div className="modal-content modal-large">
+        <div className="modal-header">
+          <h2>
+            {loading ? 'Loading...' : `${client?.first_name} ${client?.last_name}`}
+          </h2>
+          <button className="close-btn" onClick={onClose}>×</button>
+        </div>
+
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : !client ? (
+          <p>Client not found</p>
+        ) : (
+          <>
+            {/* Tabs */}
+            <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', borderBottom: '2px solid #eee', paddingBottom: '0.5rem' }}>
+              {tabs.map(tab => (
+                <button
+                  key={tab.id}
+                  type="button"
+                  className={`btn ${activeTab === tab.id ? 'btn-primary' : 'btn-secondary'}`}
+                  onClick={() => setActiveTab(tab.id)}
+                  style={{ flex: 1 }}
+                >
+                  {tab.label}
+                </button>
+              ))}
+            </div>
+
+            {/* Info Tab */}
+            {activeTab === 'info' && (
+              <div>
+                {/* Basic Info Card */}
+                <div className="card" style={{ background: '#f8f9fa', marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0 }}>👤 Basic Information</h4>
+                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}>
+                    <p><strong>Phone:</strong> <a href={`tel:${client.phone}`}>{client.phone || 'N/A'}</a></p>
+                    <p><strong>DOB:</strong> {client.date_of_birth ? new Date(client.date_of_birth).toLocaleDateString() : 'N/A'}</p>
+                    <p style={{ gridColumn: '1 / -1' }}>
+                      <strong>Address:</strong>{' '}
+                      {client.address ? (
+                        <a 
+                          href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${client.address}, ${client.city}, ${client.state} ${client.zip}`)}`}
+                          target="_blank"
+                          rel="noopener noreferrer"
+                          style={{ display: 'inline-flex', alignItems: 'center', gap: '4px' }}
+                        >
+                          📍 {client.address}, {client.city}, {client.state} {client.zip}
+                        </a>
+                      ) : 'N/A'}
+                    </p>
+                  </div>
+                </div>
+
+                {/* Emergency Contact - IMPORTANT */}
+                <div className="card" style={{ background: '#fff3cd', border: '2px solid #ffc107', marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0, color: '#856404' }}>🚨 Emergency Contact</h4>
+                  {client.emergency_contact_name ? (
+                    <div>
+                      <p style={{ margin: '0.25rem 0' }}>
+                        <strong>{client.emergency_contact_name}</strong>
+                        {client.emergency_contact_relationship && ` (${client.emergency_contact_relationship})`}
+                      </p>
+                      <p style={{ margin: '0.25rem 0', fontSize: '1.1rem' }}>
+                        📞 <a href={`tel:${client.emergency_contact_phone}`} style={{ fontWeight: 'bold' }}>
+                          {client.emergency_contact_phone}
+                        </a>
+                      </p>
+                    </div>
+                  ) : (
+                    <p style={{ color: '#856404' }}>No emergency contact on file</p>
+                  )}
+                </div>
+
+                {/* Care Preferences */}
+                {client.care_preferences && (
+                  <div className="card" style={{ marginBottom: '1rem' }}>
+                    <h4 style={{ marginTop: 0 }}>💡 Care Preferences</h4>
+                    <p style={{ whiteSpace: 'pre-wrap' }}>{client.care_preferences}</p>
+                  </div>
+                )}
+
+                {/* General Notes for Caregivers */}
+                {client.notes && (
+                  <div className="card" style={{ marginBottom: '1rem' }}>
+                    <h4 style={{ marginTop: 0 }}>📋 Care Instructions</h4>
+                    <p style={{ whiteSpace: 'pre-wrap' }}>{client.notes}</p>
+                  </div>
+                )}
+              </div>
+            )}
+
+            {/* Medical Tab */}
+            {activeTab === 'medical' && (
+              <div>
+                {/* Allergies - CRITICAL */}
+                <div className="card" style={{ background: client.allergies ? '#f8d7da' : '#f8f9fa', border: client.allergies ? '2px solid #dc3545' : '1px solid #ddd', marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0, color: client.allergies ? '#721c24' : 'inherit' }}>
+                    ⚠️ Allergies
+                  </h4>
+                  <p style={{ whiteSpace: 'pre-wrap', margin: 0 }}>
+                    {client.allergies || 'No known allergies'}
+                  </p>
+                </div>
+
+                {/* Medical Conditions */}
+                <div className="card" style={{ marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0 }}>🏥 Medical Conditions</h4>
+                  <p style={{ whiteSpace: 'pre-wrap', margin: 0 }}>
+                    {client.medical_conditions || 'None on file'}
+                  </p>
+                </div>
+
+                {/* Medications */}
+                <div className="card" style={{ marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0 }}>💊 Medications</h4>
+                  <p style={{ whiteSpace: 'pre-wrap', margin: 0 }}>
+                    {client.medications || 'None on file'}
+                  </p>
+                </div>
+
+                {/* Medical Notes */}
+                {client.medical_notes && (
+                  <div className="card" style={{ marginBottom: '1rem' }}>
+                    <h4 style={{ marginTop: 0 }}>📝 Medical Notes</h4>
+                    <p style={{ whiteSpace: 'pre-wrap', margin: 0 }}>{client.medical_notes}</p>
+                  </div>
+                )}
+
+                {/* Mobility/Assistance Needs */}
+                {client.mobility_assistance_needs && (
+                  <div className="card" style={{ marginBottom: '1rem' }}>
+                    <h4 style={{ marginTop: 0 }}>🚶 Mobility & Assistance</h4>
+                    <p style={{ whiteSpace: 'pre-wrap', margin: 0 }}>{client.mobility_assistance_needs}</p>
+                  </div>
+                )}
+              </div>
+            )}
+
+            {/* Notes Tab */}
+            {activeTab === 'notes' && (
+              <div>
+                {/* Add New Note */}
+                <div className="card" style={{ marginBottom: '1rem' }}>
+                  <h4 style={{ marginTop: 0 }}>➕ Add Visit Note</h4>
+                  <form onSubmit={handleAddNote}>
+                    <div className="form-group">
+                      <textarea
+                        value={newNote}
+                        onChange={(e) => setNewNote(e.target.value)}
+                        placeholder="How was the visit? Any observations, concerns, or updates about the client..."
+                        rows="3"
+                        required
+                      />
+                    </div>
+                    <button 
+                      type="submit" 
+                      className="btn btn-primary"
+                      disabled={submitting || !newNote.trim()}
+                    >
+                      {submitting ? 'Saving...' : 'Add Note'}
+                    </button>
+                  </form>
+                </div>
+
+                {/* Previous Notes */}
+                <div className="card">
+                  <h4 style={{ marginTop: 0 }}>📜 Recent Visit Notes</h4>
+                  {visitNotes.length === 0 ? (
+                    <p style={{ color: '#666' }}>No visit notes yet</p>
+                  ) : (
+                    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
+                      {visitNotes.map((note, idx) => (
+                        <div 
+                          key={note.id || idx} 
+                          style={{ 
+                            padding: '1rem', 
+                            background: '#f8f9fa', 
+                            borderRadius: '6px',
+                            borderLeft: '4px solid #007bff'
+                          }}
+                        >
+                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem', fontSize: '0.85rem', color: '#666' }}>
+                            <span><strong>{note.caregiver_name || 'Caregiver'}</strong></span>
+                            <span>{new Date(note.created_at).toLocaleString()}</span>
+                          </div>
+                          <p style={{ margin: 0, whiteSpace: 'pre-wrap' }}>{note.note}</p>
+                        </div>
+                      ))}
+                    </div>
+                  )}
+                </div>
+              </div>
+            )}
+          </>
+        )}
+
+        <div className="modal-actions" style={{ marginTop: '1rem' }}>
+          <button className="btn btn-secondary" onClick={onClose}>Close</button>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default CaregiverClientModal;
diff --git a/templates/crm-homecare/frontend/src/components/ConfirmModal.jsx b/templates/crm-homecare/frontend/src/components/ConfirmModal.jsx
new file mode 100644
index 0000000..fd043bd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/ConfirmModal.jsx
@@ -0,0 +1,79 @@
+// src/components/ConfirmModal.jsx - Replaces all window.confirm() calls
+import React, { useState, useEffect } from 'react';
+
+let confirmFn = null;
+
+export const confirm = (message, options = {}) => {
+  return new Promise((resolve) => {
+    if (confirmFn) {
+      confirmFn(message, options, resolve);
+    } else {
+      resolve(window.confirm(message));
+    }
+  });
+};
+
+export const ConfirmModal = () => {
+  const [modal, setModal] = useState(null);
+
+  useEffect(() => {
+    confirmFn = (message, options, resolve) => {
+      setModal({ message, options, resolve });
+    };
+    return () => { confirmFn = null; };
+  }, []);
+
+  if (!modal) return null;
+
+  const { message, options = {}, resolve } = modal;
+  const {
+    title = 'Confirm Action',
+    confirmLabel = 'Confirm',
+    cancelLabel = 'Cancel',
+    danger = false,
+  } = options;
+
+  const handleConfirm = () => { setModal(null); resolve(true); };
+  const handleCancel  = () => { setModal(null); resolve(false); };
+
+  return (
+    <div style={{
+      position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)',
+      zIndex: 99998, display: 'flex', alignItems: 'center', justifyContent: 'center',
+      padding: '1rem'
+    }} onClick={handleCancel}>
+      <div style={{
+        background: '#fff', borderRadius: '12px', padding: '1.5rem',
+        maxWidth: '420px', width: '100%',
+        boxShadow: '0 20px 60px rgba(0,0,0,0.2)',
+        animation: 'confirmSlideIn 0.2s ease'
+      }} onClick={e => e.stopPropagation()}>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.75rem' }}>
+          <span style={{ fontSize: '1.4rem' }}>{danger ? '🗑️' : '❓'}</span>
+          <h3 style={{ margin: 0, fontSize: '1.05rem', color: '#111827' }}>{title}</h3>
+        </div>
+        <p style={{ margin: '0 0 1.5rem 0', color: '#6B7280', lineHeight: '1.5', fontSize: '0.95rem' }}>
+          {message}
+        </p>
+        <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>
+          <button onClick={handleCancel} style={{
+            padding: '0.6rem 1.25rem', borderRadius: '8px',
+            border: '1px solid #D1D5DB', background: '#fff',
+            color: '#374151', cursor: 'pointer', fontWeight: '500', fontSize: '0.9rem'
+          }}>{cancelLabel}</button>
+          <button onClick={handleConfirm} style={{
+            padding: '0.6rem 1.25rem', borderRadius: '8px', border: 'none',
+            background: danger ? '#DC2626' : '#2ABBA7',
+            color: '#fff', cursor: 'pointer', fontWeight: '600', fontSize: '0.9rem'
+          }}>{confirmLabel}</button>
+        </div>
+      </div>
+      <style>{`
+        @keyframes confirmSlideIn {
+          from { opacity: 0; transform: scale(0.95); }
+          to   { opacity: 1; transform: scale(1); }
+        }
+      `}</style>
+    </div>
+  );
+};
diff --git a/templates/crm-homecare/frontend/src/components/ErrorBoundary.jsx b/templates/crm-homecare/frontend/src/components/ErrorBoundary.jsx
new file mode 100644
index 0000000..6718761
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/ErrorBoundary.jsx
@@ -0,0 +1,69 @@
+// ErrorBoundary.jsx - Catches component crashes so the whole app doesn't go down
+import React from 'react';
+
+export class ErrorBoundary extends React.Component {
+  constructor(props) {
+    super(props);
+    this.state = { hasError: false, error: null, errorInfo: null };
+  }
+
+  static getDerivedStateFromError(error) {
+    return { hasError: true, error };
+  }
+
+  componentDidCatch(error, errorInfo) {
+    this.setState({ errorInfo });
+    // Log to console — in production you'd send to Sentry or similar
+    console.error('[ErrorBoundary] Component crash:', error, errorInfo);
+  }
+
+  render() {
+    if (this.state.hasError) {
+      return (
+        <div style={{
+          padding: '40px 24px',
+          textAlign: 'center',
+          fontFamily: 'system-ui, sans-serif',
+        }}>
+          <div style={{ fontSize: 48, marginBottom: 16 }}>⚠️</div>
+          <h2 style={{ color: '#DC2626', marginBottom: 8 }}>Something went wrong</h2>
+          <p style={{ color: '#6B7280', marginBottom: 24, maxWidth: 400, margin: '0 auto 24px' }}>
+            This section crashed unexpectedly. The rest of the app is still working.
+          </p>
+          <button
+            onClick={() => this.setState({ hasError: false, error: null, errorInfo: null })}
+            style={{
+              background: '#3B82F6', color: '#fff', border: 'none',
+              borderRadius: 8, padding: '10px 24px', fontWeight: 600,
+              fontSize: 14, cursor: 'pointer',
+            }}
+          >
+            Try Again
+          </button>
+          {process.env.NODE_ENV === 'development' && this.state.error && (
+            <details style={{ marginTop: 24, textAlign: 'left', maxWidth: 600, margin: '24px auto 0' }}>
+              <summary style={{ cursor: 'pointer', color: '#6B7280', fontSize: 13 }}>Error details (dev only)</summary>
+              <pre style={{ fontSize: 11, overflow: 'auto', background: '#F3F4F6', padding: 12, borderRadius: 6, marginTop: 8 }}>
+                {this.state.error.toString()}
+                {this.state.errorInfo?.componentStack}
+              </pre>
+            </details>
+          )}
+        </div>
+      );
+    }
+
+    return this.props.children;
+  }
+}
+
+// Wrap any component with this for targeted protection
+export function withErrorBoundary(Component, fallback = null) {
+  return function WrappedWithBoundary(props) {
+    return (
+      <ErrorBoundary fallback={fallback}>
+        <Component {...props} />
+      </ErrorBoundary>
+    );
+  };
+}
diff --git a/templates/crm-homecare/frontend/src/components/HelpPanel.jsx b/templates/crm-homecare/frontend/src/components/HelpPanel.jsx
new file mode 100644
index 0000000..17ccc74
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/HelpPanel.jsx
@@ -0,0 +1,453 @@
+// src/components/HelpPanel.jsx
+// Slide-out admin help panel with searchable articles per section
+import React, { useState, useEffect, useRef } from 'react';
+
+const HELP_ARTICLES = [
+  {
+    section: 'Dashboard',
+    icon: '🏠',
+    articles: [
+      {
+        title: 'Reading the Today Panel',
+        content: `The Today Panel at the top of the dashboard shows four live numbers:
+• Active Shifts Today — total shifts scheduled for today
+• Clocked In Now — caregivers currently on the clock
+• Shifts Remaining — shifts that haven't started yet
+• Coverage Gaps — shifts with no caregiver assigned (red = urgent)
+
+If you see a red "Find Coverage →" button, click it immediately to open Emergency Coverage.`
+      },
+      {
+        title: 'Notification Bell',
+        content: `The bell icon in the top-right header shows unread alerts. It refreshes every 30 seconds automatically.
+
+Notifications include:
+• Caregiver miss reports (highest priority)
+• Clock-in/out confirmations
+• Coverage assignments
+• System alerts
+
+Click the bell to see the list and mark items as read.`
+      },
+      {
+        title: 'Quick Actions',
+        content: `The six Quick Action buttons are shortcuts to the most common tasks:
+• New Client → opens client onboarding
+• New Caregiver → opens add caregiver form
+• Billing → goes to invoice management
+• Reports → goes to analytics
+• Emergency Coverage → opens the coverage tool
+• Background Checks → opens compliance overview`
+      },
+    ]
+  },
+  {
+    section: 'Clients',
+    icon: '👥',
+    articles: [
+      {
+        title: 'Adding a New Client',
+        content: `Go to Operations → Clients → click "+ Add Client".
+
+Required fields: first name, last name, phone, address, and service type.
+
+After saving, the client appears in your active list and can be assigned to schedules immediately.`
+      },
+      {
+        title: 'Setting Up a Care Plan',
+        content: `Care plans define what services a client is authorized for and how many hours per week.
+
+Go to Operations → Care Plans → select the client → click "+ Add Care Plan Entry".
+
+Enter the service type, authorized hours/week, and any instructions. The system will warn you if you try to leave with unsaved changes.
+
+Note: Care plans set authorization only — scheduling is done separately in the Schedule Hub.`
+      },
+      {
+        title: 'Difference: Clients vs Referrals',
+        content: `Clients = people actively receiving services who are signed up in the system.
+Referrals = prospects who have been referred but haven't started care yet.
+
+Use Operations → Referrals for new leads. When they convert to active clients, use the "Convert to Client" action on their referral record. This keeps your active client list clean.`
+      },
+    ]
+  },
+  {
+    section: 'Scheduling',
+    icon: '📅',
+    articles: [
+      {
+        title: 'Schedule Types Explained',
+        content: `One-Time: Single shift on a specific date. Good for substitutes or trial shifts.
+
+Recurring (Single Day): Same day every week forever (or until deactivated). Example: every Monday 9am–1pm.
+
+Multi-Day Recurring: Multiple days per week. Creates one schedule entry per day selected.
+
+Bi-Weekly: Every other week. You'll be asked to pick the "ON week" anchor date — choose any date in the first week the caregiver should work. The system handles the alternating pattern automatically.`
+      },
+      {
+        title: 'Conflict Detection',
+        content: `When you add a schedule, the system checks if the caregiver already has a conflicting schedule at the same time.
+
+A red conflict warning appears in the form before you submit if an overlap is detected. You can still save if you choose, but the warning won't go away until the conflict is resolved.
+
+For bi-weekly schedules, the system is smart enough to check if two bi-weekly schedules actually overlap (based on their anchor dates) before flagging a conflict.`
+      },
+      {
+        title: 'Ending a Recurring Schedule',
+        content: `Never delete a recurring schedule — this removes history.
+
+Instead, click on the schedule and click "Deactivate." This stops future occurrences while keeping all past shift records intact for payroll and reporting.
+
+If you need to change a schedule (different time, different client), deactivate the old one and create a new one.`
+      },
+      {
+        title: 'Bi-Weekly Anchor Date',
+        content: `The anchor date tells the system which week is the "ON" week for a bi-weekly schedule.
+
+When creating a bi-weekly schedule, pick any date in the first week the caregiver should work. You don't need to pick a Sunday — just any day in that week. The system normalizes it.
+
+If you change the anchor date later (in the edit modal), you're changing which weeks are "on" and "off" — this takes effect immediately, so double-check the next few weeks in the calendar after making changes.`
+      },
+    ]
+  },
+  {
+    section: 'Emergency Coverage',
+    icon: '🚨',
+    articles: [
+      {
+        title: 'How to Find Coverage Fast',
+        content: `1. Go to Scheduling → Emergency Coverage
+2. Check the "Pending Coverage Needs" section at the top for any submitted miss reports
+3. Click "Find Coverage" next to the affected shift
+4. Review the ranked list of available caregivers
+5. Call the caregiver first to confirm verbally
+6. Click "Assign Coverage" to create the schedule and notify them
+
+The whole process should take under 5 minutes if you have available caregivers.`
+      },
+      {
+        title: 'Caregiver Status Badges',
+        content: `Available (green): Under 32 hours this week — no concerns.
+
+Moderate Hours (yellow): 32–37 hours — can take the shift, but watch their total for the week.
+
+Near Overtime (red): 37+ hours — assigning this shift will push them into or further into overtime. Use as a last resort and make sure payroll is aware.
+
+Preferred (teal): This caregiver has worked with this specific client before — they know the client's routine, which usually means a smoother shift.`
+      },
+      {
+        title: 'Manual Coverage Search',
+        content: `You don't need a miss report to use the coverage search tool. Use the manual search form to find available caregivers for any date and time — useful for proactive planning or filling new client openings.
+
+Enter the date, start time, and end time. Optionally filter by client to surface caregivers who have worked with them before.`
+      },
+    ]
+  },
+  {
+    section: 'Caregivers',
+    icon: '👤',
+    articles: [
+      {
+        title: 'Bulk SMS to Caregivers',
+        content: `Select caregivers using the checkboxes on the left of the caregiver table. A blue bulk actions bar will appear at the top.
+
+Click "📱 Send SMS" to open a compose window. Type your message once and it goes to all selected caregivers simultaneously.
+
+Only caregivers with a phone number on file will receive the SMS.`
+      },
+      {
+        title: 'Viewing GPS Route History',
+        content: `Click "🕐 History" on any caregiver to see their full shift timeline.
+
+Shifts with GPS data show a "View Route" button. Click it to open an interactive map showing the caregiver's path during that shift — with a green start marker and red end marker.
+
+This is useful for verifying a caregiver was actually at the client's home and for resolving any disputes about a visit.`
+      },
+      {
+        title: 'Promoting to Admin',
+        content: `In the caregiver table, click "Make Admin" on any caregiver to give them admin access. They'll be able to log in and see the full admin dashboard.
+
+This is useful for lead caregivers or supervisors who need system access.
+
+Warning: Admin users can see all client and caregiver data, billing, and payroll. Only grant this to trusted staff.`
+      },
+    ]
+  },
+  {
+    section: 'Billing & Payroll',
+    icon: '💰',
+    articles: [
+      {
+        title: 'Generating an Invoice',
+        content: `Go to Financial → Billing → click "Generate Invoice."
+
+Select the client, billing period start and end dates, and the payer. The system pulls scheduled hours for that period.
+
+Review the line items and adjust if needed. Click "Create Invoice" to finalize.
+
+Tip: Set the client's payer (Medicaid, private pay, insurance, VA) on their profile before generating invoices — this auto-populates the correct billing info.`
+      },
+      {
+        title: 'Running Payroll',
+        content: `Go to Financial → Payroll. Select your pay period dates and click "Calculate Payroll."
+
+Hours come from actual clock-in/out records — not from schedules. If a caregiver didn't clock in, they won't have hours.
+
+Review each row. Adjust the overtime threshold (default 40 hrs/week) and differentials if needed. Approve individually or click "Approve All."
+
+Export to QuickBooks CSV or standard CSV for your accounting system.`
+      },
+      {
+        title: 'Why Hours Might Look Wrong',
+        content: `Payroll hours come from time_entries (clock-in/clock-out records), not from schedules.
+
+Common reasons for missing or wrong hours:
+• Caregiver forgot to clock in or out — check Caregiver History and manually adjust
+• Caregiver clocked in to the wrong client — fix in the time entry record
+• Clock-out was never recorded — the shift stays "open" indefinitely
+
+Always run a quick audit before approving payroll — look for any caregivers with zero hours who were scheduled to work.`
+      },
+    ]
+  },
+  {
+    section: 'Compliance',
+    icon: '🛡️',
+    articles: [
+      {
+        title: 'Background Check Expiry Dashboard',
+        content: `Go to Compliance → Background Checks → click the "Overview" tab.
+
+This shows ALL caregivers and their background check status in one view. Use the dropdown to filter by expiry window (30, 60, 90, or 180 days).
+
+Click on a status card (Expired, Expiring Soon, etc.) to filter the list to just those caregivers. Click it again to show all.
+
+Run this check monthly at minimum. Any "Expired" or "No Check on File" caregivers should be addressed before their next scheduled shift.`
+      },
+      {
+        title: 'Submitting a WORCS Check',
+        content: `Wisconsin caregivers must be checked through the DOJ WORCS system.
+
+1. Go to Compliance → Background Checks
+2. Select the caregiver
+3. Click "Submit WORCS Check"
+4. Enter their SSN — it is encrypted immediately and never stored in plain text
+5. Submit — the check goes to Wisconsin DOJ automatically
+6. Results return in 24–72 hours. Click "Poll Results" to update the status.
+
+You need your WORCS credentials (username, password, account number) configured in environment settings first.`
+      },
+      {
+        title: 'SSN Security',
+        content: `SSNs are encrypted with AES-256-GCM encryption before being saved. They are never stored in plain text anywhere in the system.
+
+The full SSN is never displayed. You can only see the last 4 digits in the UI.
+
+If you need to verify a full SSN, click "Reveal SSN" — this requires admin access and creates an audit log entry showing who accessed it and when. All SSN reveals are logged permanently.`
+      },
+    ]
+  },
+  {
+    section: 'Reports',
+    icon: '📊',
+    articles: [
+      {
+        title: 'Available Report Types',
+        content: `Overview / Caregiver Hours: Actual hours worked per caregiver from clock-in records.
+
+Revenue / Billing: Invoice totals, collections, and outstanding balances.
+
+Compliance: Background check status and expiration for all caregivers.
+
+Clients: Full roster with service types, enrollment dates, assigned caregivers.
+
+Payroll: Hours and gross pay per caregiver for any date range.
+
+Each report exports to CSV (for Excel) or PDF (branded, printable).`
+      },
+      {
+        title: 'Exporting to PDF',
+        content: `Every report has an "Export" button. Select PDF from the format dropdown.
+
+The PDF is automatically formatted with CVHC branding, the report title, your selected date range, and a table of all records.
+
+For large date ranges (e.g., a full year), PDFs may be multiple pages. The record count is shown at the bottom of each export.`
+      },
+    ]
+  },
+];
+
+const HelpPanel = ({ isOpen, onClose, currentPage = '' }) => {
+  const [search, setSearch] = useState('');
+  const [activeSection, setActiveSection] = useState(null);
+  const [activeArticle, setActiveArticle] = useState(null);
+  const panelRef = useRef(null);
+
+  // Auto-open to matching section when page changes
+  useEffect(() => {
+    if (!isOpen) return;
+    const match = HELP_ARTICLES.find(s =>
+      s.section.toLowerCase().includes(currentPage.toLowerCase()) ||
+      currentPage.toLowerCase().includes(s.section.toLowerCase())
+    );
+    if (match) {
+      setActiveSection(match.section);
+      setActiveArticle(null);
+    }
+  }, [currentPage, isOpen]);
+
+  // Close on outside click
+  useEffect(() => {
+    if (!isOpen) return;
+    const handler = (e) => {
+      if (panelRef.current && !panelRef.current.contains(e.target)) onClose();
+    };
+    document.addEventListener('mousedown', handler);
+    return () => document.removeEventListener('mousedown', handler);
+  }, [isOpen, onClose]);
+
+  const filtered = HELP_ARTICLES.map(section => ({
+    ...section,
+    articles: section.articles.filter(a =>
+      !search ||
+      a.title.toLowerCase().includes(search.toLowerCase()) ||
+      a.content.toLowerCase().includes(search.toLowerCase()) ||
+      section.section.toLowerCase().includes(search.toLowerCase())
+    )
+  })).filter(s => s.articles.length > 0);
+
+  const currentSection = HELP_ARTICLES.find(s => s.section === activeSection);
+  const currentArticle = currentSection?.articles.find(a => a.title === activeArticle);
+
+  const s = {
+    overlay: { position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.3)', zIndex: 9998, opacity: isOpen ? 1 : 0, pointerEvents: isOpen ? 'all' : 'none', transition: 'opacity 0.2s' },
+    panel: { position: 'fixed', top: 0, right: 0, bottom: 0, width: '420px', maxWidth: '95vw', background: '#fff', zIndex: 9999, boxShadow: '-4px 0 24px rgba(0,0,0,0.15)', transform: isOpen ? 'translateX(0)' : 'translateX(100%)', transition: 'transform 0.25s cubic-bezier(0.4,0,0.2,1)', display: 'flex', flexDirection: 'column' },
+    header: { padding: '1.25rem 1.25rem 0', borderBottom: '1px solid #E5E7EB', paddingBottom: '1rem' },
+    body: { flex: 1, overflowY: 'auto', padding: '1rem 1.25rem' },
+  };
+
+  return (
+    <>
+      <div style={s.overlay} onClick={onClose} />
+      <div ref={panelRef} style={s.panel}>
+        {/* Header */}
+        <div style={s.header}>
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.875rem' }}>
+            <div>
+              <div style={{ fontWeight: '800', fontSize: '1.1rem', color: '#111827' }}>
+                {currentArticle ? (
+                  <button onClick={() => setActiveArticle(null)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '0.85rem', padding: 0, marginBottom: '0.25rem', display: 'block' }}>
+                    ← {activeSection}
+                  </button>
+                ) : activeSection ? (
+                  <button onClick={() => setActiveSection(null)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '0.85rem', padding: 0, marginBottom: '0.25rem', display: 'block' }}>
+                    ← All Topics
+                  </button>
+                ) : null}
+                {currentArticle ? currentArticle.title : activeSection ? `${currentSection?.icon} ${activeSection}` : '❓ Help Center'}
+              </div>
+            </div>
+            <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '1.25rem', color: '#6B7280', padding: '0.25rem' }}>✕</button>
+          </div>
+          {!currentArticle && (
+            <input
+              placeholder="Search help articles..."
+              value={search}
+              onChange={e => { setSearch(e.target.value); setActiveSection(null); setActiveArticle(null); }}
+              style={{ width: '100%', padding: '0.6rem 0.875rem', border: '1px solid #D1D5DB', borderRadius: '8px', fontSize: '0.9rem', boxSizing: 'border-box', outline: 'none' }}
+              autoFocus={isOpen}
+            />
+          )}
+        </div>
+
+        {/* Body */}
+        <div style={s.body}>
+          {/* Single article view */}
+          {currentArticle ? (
+            <div>
+              {currentArticle.content.split('\n').map((line, i) => {
+                if (line.startsWith('•')) {
+                  return (
+                    <div key={i} style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.4rem', paddingLeft: '0.5rem' }}>
+                      <span style={{ color: '#2ABBA7', fontWeight: '700', flexShrink: 0 }}>•</span>
+                      <span style={{ fontSize: '0.9rem', color: '#374151', lineHeight: 1.6 }}>{line.slice(1).trim()}</span>
+                    </div>
+                  );
+                }
+                if (line.match(/^\d+\./)) {
+                  return (
+                    <div key={i} style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.4rem', paddingLeft: '0.5rem' }}>
+                      <span style={{ color: '#2ABBA7', fontWeight: '700', flexShrink: 0, minWidth: '1.2rem' }}>{line.match(/^\d+/)[0]}.</span>
+                      <span style={{ fontSize: '0.9rem', color: '#374151', lineHeight: 1.6 }}>{line.replace(/^\d+\./, '').trim()}</span>
+                    </div>
+                  );
+                }
+                if (line.trim() === '') return <div key={i} style={{ height: '0.5rem' }} />;
+                return <p key={i} style={{ fontSize: '0.9rem', color: '#374151', lineHeight: 1.6, margin: '0 0 0.5rem' }}>{line}</p>;
+              })}
+              <div style={{ marginTop: '1.5rem', padding: '0.875rem', background: '#F0FDFB', borderRadius: '8px', border: '1px solid #BBF7D0' }}>
+                <p style={{ margin: 0, fontSize: '0.82rem', color: '#065F46' }}>💡 Still need help? Contact your system administrator or call the office directly.</p>
+              </div>
+            </div>
+          ) : activeSection ? (
+            /* Section article list */
+            <div>
+              {currentSection?.articles.map((article, i) => (
+                <button key={i} onClick={() => setActiveArticle(article.title)}
+                  style={{ display: 'block', width: '100%', textAlign: 'left', padding: '0.875rem 1rem', marginBottom: '0.5rem', background: '#F9FAFB', border: '1px solid #E5E7EB', borderRadius: '10px', cursor: 'pointer', transition: 'all 0.15s' }}>
+                  <div style={{ fontWeight: '600', color: '#111827', fontSize: '0.9rem', marginBottom: '0.2rem' }}>{article.title}</div>
+                  <div style={{ fontSize: '0.8rem', color: '#6B7280', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                    {article.content.split('\n')[0].slice(0, 80)}...
+                  </div>
+                </button>
+              ))}
+            </div>
+          ) : (
+            /* Main topics list (or search results) */
+            <div>
+              {filtered.map((section, i) => (
+                <div key={i} style={{ marginBottom: '0.5rem' }}>
+                  <button onClick={() => { setActiveSection(section.section); setSearch(''); }}
+                    style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', width: '100%', padding: '0.875rem 1rem', background: '#fff', border: '1px solid #E5E7EB', borderRadius: '10px', cursor: 'pointer', transition: 'all 0.15s' }}>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
+                      <span style={{ fontSize: '1.3rem' }}>{section.icon}</span>
+                      <div style={{ textAlign: 'left' }}>
+                        <div style={{ fontWeight: '700', color: '#111827', fontSize: '0.9rem' }}>{section.section}</div>
+                        <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{section.articles.length} article{section.articles.length !== 1 ? 's' : ''}</div>
+                      </div>
+                    </div>
+                    <span style={{ color: '#D1D5DB', fontSize: '1rem' }}>›</span>
+                  </button>
+                  {search && section.articles.map((article, j) => (
+                    <button key={j} onClick={() => { setActiveSection(section.section); setActiveArticle(article.title); setSearch(''); }}
+                      style={{ display: 'block', width: '100%', textAlign: 'left', padding: '0.6rem 1rem 0.6rem 3rem', background: '#F9FAFB', border: '1px solid #E5E7EB', borderTop: 'none', borderRadius: j === section.articles.length - 1 ? '0 0 8px 8px' : 0, cursor: 'pointer' }}>
+                      <div style={{ fontSize: '0.85rem', color: '#2ABBA7', fontWeight: '600' }}>{article.title}</div>
+                    </button>
+                  ))}
+                </div>
+              ))}
+              {filtered.length === 0 && (
+                <div style={{ textAlign: 'center', padding: '2rem', color: '#6B7280' }}>
+                  <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>🔍</div>
+                  <p style={{ margin: 0 }}>No results for "{search}"</p>
+                  <p style={{ fontSize: '0.82rem', marginTop: '0.5rem' }}>Try different keywords or browse by topic above</p>
+                </div>
+              )}
+            </div>
+          )}
+        </div>
+
+        {/* Footer */}
+        <div style={{ padding: '0.875rem 1.25rem', borderTop: '1px solid #E5E7EB', background: '#F9FAFB' }}>
+          <p style={{ margin: 0, fontSize: '0.78rem', color: '#9CA3AF', textAlign: 'center' }}>
+            Chippewa Valley Home Care CRM — Help Center
+          </p>
+        </div>
+      </div>
+    </>
+  );
+};
+
+export default HelpPanel;
diff --git a/templates/crm-homecare/frontend/src/components/MileageTracker.jsx b/templates/crm-homecare/frontend/src/components/MileageTracker.jsx
new file mode 100644
index 0000000..f71524c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/MileageTracker.jsx
@@ -0,0 +1,375 @@
+// src/components/MileageTracker.jsx
+// Simple start/stop mileage tracking for caregivers
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+// Calculate distance between two GPS points (Haversine formula)
+const calculateDistance = (lat1, lon1, lat2, lon2) => {
+  const R = 3959; // Earth's radius in miles
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = 
+    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
+    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
+    Math.sin(dLon / 2) * Math.sin(dLon / 2);
+  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
+  const straightLine = R * c;
+  // Multiply by 1.3 to approximate road distance (roads aren't straight)
+  return straightLine * 1.3;
+};
+
+const MileageTracker = ({ token, caregiverId }) => {
+  const [tripState, setTripState] = useState('idle'); // idle, started, ended
+  const [startPoint, setStartPoint] = useState(null);
+  const [endPoint, setEndPoint] = useState(null);
+  const [startLocation, setStartLocation] = useState('');
+  const [endLocation, setEndLocation] = useState('');
+  const [calculatedMiles, setCalculatedMiles] = useState(0);
+  const [error, setError] = useState(null);
+  const [saving, setSaving] = useState(false);
+  const [gettingLocation, setGettingLocation] = useState(false);
+  const [showHistory, setShowHistory] = useState(false);
+  const [history, setHistory] = useState([]);
+  const [loadingHistory, setLoadingHistory] = useState(false);
+
+  const getCurrentPosition = () => {
+    return new Promise((resolve, reject) => {
+      if (!navigator.geolocation) {
+        reject(new Error('Geolocation not supported'));
+        return;
+      }
+      navigator.geolocation.getCurrentPosition(
+        (position) => resolve({
+          lat: position.coords.latitude,
+          lon: position.coords.longitude,
+          accuracy: position.coords.accuracy
+        }),
+        (err) => reject(err),
+        { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
+      );
+    });
+  };
+
+  const reverseGeocode = async (lat, lon) => {
+    try {
+      const response = await fetch(
+        `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`,
+        { headers: { 'User-Agent': 'CVHC-CRM' } }
+      );
+      if (response.ok) {
+        const data = await response.json();
+        const parts = [];
+        if (data.address?.house_number && data.address?.road) {
+          parts.push(`${data.address.house_number} ${data.address.road}`);
+        } else if (data.address?.road) {
+          parts.push(data.address.road);
+        }
+        if (data.address?.city || data.address?.town || data.address?.village) {
+          parts.push(data.address.city || data.address.town || data.address.village);
+        }
+        return parts.join(', ') || 'Unknown location';
+      }
+    } catch (e) {
+      console.error('Reverse geocode failed:', e);
+    }
+    return 'Unknown location';
+  };
+
+  const handleStartTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setStartPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setStartLocation(address);
+      
+      setTripState('started');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else if (err.code === 2) {
+        setError('Unable to get location. Please try again.');
+      } else {
+        setError('Location timeout. Make sure GPS is enabled.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleEndTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setEndPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setEndLocation(address);
+      
+      // Calculate distance
+      const miles = calculateDistance(
+        startPoint.lat, startPoint.lon,
+        position.lat, position.lon
+      );
+      setCalculatedMiles(Math.round(miles * 10) / 10);
+      
+      setTripState('ended');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else {
+        setError('Unable to get location. Please try again.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleSaveTrip = async () => {
+    if (calculatedMiles < 0.1) {
+      alert('Trip too short to save');
+      return;
+    }
+
+    setSaving(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/mileage`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          caregiverId,
+          date: new Date().toISOString().split('T')[0],
+          miles: calculatedMiles,
+          fromLocation: startLocation,
+          toLocation: endLocation,
+          notes: `GPS tracked: ${startLocation} → ${endLocation}`
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to save mileage');
+
+      alert(`Saved ${calculatedMiles} miles!`);
+      handleReset();
+      
+    } catch (error) {
+      alert('Failed to save: ' + error.message);
+    } finally {
+      setSaving(false);
+    }
+  };
+
+  const handleReset = () => {
+    setTripState('idle');
+    setStartPoint(null);
+    setEndPoint(null);
+    setStartLocation('');
+    setEndLocation('');
+    setCalculatedMiles(0);
+    setError(null);
+  };
+
+  const loadHistory = async () => {
+    setLoadingHistory(true);
+    try {
+      const response = await fetch(
+        `${API_BASE_URL}/api/payroll/mileage?caregiverId=${caregiverId}`,
+        { headers: { 'Authorization': `Bearer ${token}` } }
+      );
+      if (response.ok) {
+        setHistory(await response.json());
+      }
+    } catch (error) {
+      console.error('Failed to load history:', error);
+    } finally {
+      setLoadingHistory(false);
+    }
+  };
+
+  const handleToggleHistory = () => {
+    if (!showHistory) loadHistory();
+    setShowHistory(!showHistory);
+  };
+
+  return (
+    <div className="card" style={{ marginBottom: '1rem' }}>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+        <h3 style={{ margin: 0 }}>🚗 Mileage Tracker</h3>
+        <button 
+          className="btn btn-sm btn-secondary"
+          onClick={handleToggleHistory}
+        >
+          {showHistory ? 'Hide' : 'History'}
+        </button>
+      </div>
+
+      {error && (
+        <div style={{ 
+          background: '#f8d7da', 
+          color: '#721c24', 
+          padding: '0.75rem', 
+          borderRadius: '6px',
+          marginBottom: '1rem'
+        }}>
+          ⚠️ {error}
+        </div>
+      )}
+
+      {/* IDLE STATE */}
+      {tripState === 'idle' && (
+        <div style={{ textAlign: 'center', padding: '1rem' }}>
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Tap when leaving to start tracking
+          </p>
+          <button 
+            className="btn btn-primary"
+            onClick={handleStartTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🚗 Start Trip'}
+          </button>
+        </div>
+      )}
+
+      {/* STARTED STATE */}
+      {tripState === 'started' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#d4edda', 
+            padding: '1rem', 
+            borderRadius: '8px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ color: '#155724', fontWeight: 'bold' }}>📍 Trip Started</div>
+            <div style={{ color: '#666', fontSize: '0.9rem', marginTop: '0.5rem' }}>
+              From: {startLocation}
+            </div>
+          </div>
+          
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Drive to your destination, then tap End Trip
+          </p>
+          
+          <button 
+            className="btn btn-danger"
+            onClick={handleEndTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🏁 End Trip'}
+          </button>
+          
+          <button 
+            className="btn btn-secondary"
+            onClick={handleReset}
+            style={{ marginTop: '0.5rem', width: '100%' }}
+          >
+            Cancel
+          </button>
+        </div>
+      )}
+
+      {/* ENDED STATE - Show results */}
+      {tripState === 'ended' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#f8f9fa', 
+            padding: '1.5rem', 
+            borderRadius: '12px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ fontSize: '2.5rem', fontWeight: 'bold', color: '#007bff' }}>
+              {calculatedMiles} miles
+            </div>
+            
+            <div style={{ 
+              marginTop: '1rem', 
+              fontSize: '0.9rem', 
+              color: '#666',
+              textAlign: 'left',
+              padding: '0 1rem'
+            }}>
+              <div style={{ marginBottom: '0.5rem' }}>
+                <strong>From:</strong> {startLocation}
+              </div>
+              <div>
+                <strong>To:</strong> {endLocation}
+              </div>
+            </div>
+          </div>
+
+          <p style={{ fontSize: '0.8rem', color: '#999', marginBottom: '1rem' }}>
+            *Estimated road distance
+          </p>
+
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button 
+              className="btn btn-primary"
+              onClick={handleSaveTrip}
+              disabled={saving}
+              style={{ flex: 1 }}
+            >
+              {saving ? 'Saving...' : '💾 Save'}
+            </button>
+            <button 
+              className="btn btn-secondary"
+              onClick={handleReset}
+              style={{ flex: 1 }}
+            >
+              🗑️ Discard
+            </button>
+          </div>
+        </div>
+      )}
+
+      {/* History Section */}
+      {showHistory && (
+        <div style={{ marginTop: '1.5rem', borderTop: '1px solid #ddd', paddingTop: '1rem' }}>
+          <h4 style={{ marginTop: 0 }}>Recent Trips</h4>
+          {loadingHistory ? (
+            <p>Loading...</p>
+          ) : history.length === 0 ? (
+            <p style={{ color: '#666' }}>No trips recorded yet</p>
+          ) : (
+            <div style={{ maxHeight: '200px', overflowY: 'auto' }}>
+              {history.slice(0, 10).map((trip, idx) => (
+                <div 
+                  key={trip.id || idx}
+                  style={{ 
+                    padding: '0.5rem',
+                    background: idx % 2 === 0 ? '#f8f9fa' : '#fff',
+                    borderRadius: '4px',
+                    marginBottom: '0.25rem',
+                    fontSize: '0.9rem'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                    <strong>{trip.miles} mi</strong>
+                    <span style={{ color: '#666' }}>
+                      {new Date(trip.date).toLocaleDateString()}
+                    </span>
+                  </div>
+                  {(trip.from_location || trip.to_location) && (
+                    <div style={{ fontSize: '0.8rem', color: '#666', marginTop: '2px' }}>
+                      {trip.from_location} → {trip.to_location}
+                    </div>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default MileageTracker;
diff --git a/templates/crm-homecare/frontend/src/components/OfflineBanner.jsx b/templates/crm-homecare/frontend/src/components/OfflineBanner.jsx
new file mode 100644
index 0000000..0888b59
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/OfflineBanner.jsx
@@ -0,0 +1,69 @@
+// components/OfflineBanner.jsx
+// Shows when the caregiver is offline and has queued actions waiting to sync
+
+import React from 'react';
+import { useOfflineSync } from '../hooks/useNative';
+
+export default function OfflineBanner() {
+  const { online, queueCount, syncing } = useOfflineSync();
+
+  if (online && queueCount === 0) return null;
+
+  if (syncing) {
+    return (
+      <div style={styles.banner('#2563EB')}>
+        <span style={styles.dot} />
+        Syncing {queueCount} action{queueCount !== 1 ? 's' : ''}...
+      </div>
+    );
+  }
+
+  if (!online) {
+    return (
+      <div style={styles.banner('#DC2626')}>
+        <span style={{ ...styles.dot, background: '#fff' }} />
+        You're offline
+        {queueCount > 0 && ` · ${queueCount} action${queueCount !== 1 ? 's' : ''} will sync when reconnected`}
+      </div>
+    );
+  }
+
+  if (queueCount > 0) {
+    return (
+      <div style={styles.banner('#D97706')}>
+        <span style={{ ...styles.dot, background: '#fff' }} />
+        {queueCount} action{queueCount !== 1 ? 's' : ''} pending sync
+      </div>
+    );
+  }
+
+  return null;
+}
+
+const styles = {
+  banner: (bg) => ({
+    position: 'fixed',
+    top: 0,
+    left: 0,
+    right: 0,
+    zIndex: 9999,
+    background: bg,
+    color: '#fff',
+    padding: '8px 16px',
+    fontSize: '13px',
+    fontWeight: 600,
+    display: 'flex',
+    alignItems: 'center',
+    gap: '8px',
+    justifyContent: 'center',
+    boxShadow: '0 2px 8px rgba(0,0,0,0.2)',
+  }),
+  dot: {
+    width: 8,
+    height: 8,
+    borderRadius: '50%',
+    background: 'rgba(255,255,255,0.8)',
+    display: 'inline-block',
+    animation: 'pulse 1.5s ease-in-out infinite',
+  },
+};
diff --git a/templates/crm-homecare/frontend/src/components/Toast.jsx b/templates/crm-homecare/frontend/src/components/Toast.jsx
new file mode 100644
index 0000000..308459f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/Toast.jsx
@@ -0,0 +1,68 @@
+// src/components/Toast.jsx - Global toast notification system
+import React, { useState, useEffect, useCallback } from 'react';
+
+let toastFn = null;
+
+export const toast = (message, type = 'success', duration = 4000) => {
+  if (toastFn) toastFn(message, type, duration);
+};
+
+export const ToastContainer = () => {
+  const [toasts, setToasts] = useState([]);
+
+  useEffect(() => {
+    toastFn = (message, type, duration) => {
+      const id = Date.now() + Math.random();
+      setToasts(prev => [...prev, { id, message, type }]);
+      setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), duration);
+    };
+    return () => { toastFn = null; };
+  }, []);
+
+  const remove = (id) => setToasts(prev => prev.filter(t => t.id !== id));
+
+  const icons = { success: '✅', error: '❌', warning: '⚠️', info: 'ℹ️' };
+  const colors = {
+    success: { bg: '#F0FDF4', border: '#16A34A', text: '#15803D' },
+    error:   { bg: '#FEF2F2', border: '#DC2626', text: '#B91C1C' },
+    warning: { bg: '#FFFBEB', border: '#D97706', text: '#B45309' },
+    info:    { bg: '#EFF6FF', border: '#2563EB', text: '#1D4ED8' },
+  };
+
+  return (
+    <div style={{
+      position: 'fixed', bottom: '1.5rem', right: '1.5rem',
+      zIndex: 99999, display: 'flex', flexDirection: 'column', gap: '0.5rem',
+      maxWidth: '380px', width: 'calc(100vw - 3rem)'
+    }}>
+      {toasts.map(t => {
+        const c = colors[t.type] || colors.info;
+        return (
+          <div key={t.id} style={{
+            display: 'flex', alignItems: 'flex-start', gap: '0.75rem',
+            padding: '0.875rem 1rem', borderRadius: '10px',
+            background: c.bg, border: `1px solid ${c.border}`,
+            boxShadow: '0 4px 16px rgba(0,0,0,0.12)',
+            animation: 'toastSlideIn 0.25s ease',
+          }}>
+            <span style={{ fontSize: '1rem', flexShrink: 0, marginTop: '1px' }}>{icons[t.type]}</span>
+            <span style={{ flex: 1, fontSize: '0.9rem', color: c.text, fontWeight: '500', lineHeight: '1.4' }}>
+              {t.message}
+            </span>
+            <button onClick={() => remove(t.id)} style={{
+              background: 'none', border: 'none', cursor: 'pointer',
+              color: c.text, opacity: 0.6, fontSize: '1.1rem', flexShrink: 0,
+              padding: '0', lineHeight: 1
+            }}>×</button>
+          </div>
+        );
+      })}
+      <style>{`
+        @keyframes toastSlideIn {
+          from { opacity: 0; transform: translateX(20px); }
+          to   { opacity: 1; transform: translateX(0); }
+        }
+      `}</style>
+    </div>
+  );
+};
diff --git a/templates/crm-homecare/frontend/src/components/admin/ADLTracking.jsx b/templates/crm-homecare/frontend/src/components/admin/ADLTracking.jsx
new file mode 100644
index 0000000..8ed7eda
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ADLTracking.jsx
@@ -0,0 +1,597 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/ADLTracking.jsx
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ADLTracking = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [selectedClient, setSelectedClient] = useState('');
+  const [requirements, setRequirements] = useState([]);
+  const [logs, setLogs] = useState([]);
+  const [loading, setLoading] = useState(false);
+  const [activeTab, setActiveTab] = useState('logs');
+  const [showAddReqModal, setShowAddReqModal] = useState(false);
+  const [showLogModal, setShowLogModal] = useState(false);
+  const [dateRange, setDateRange] = useState({
+    start: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
+    end: new Date().toISOString().split('T')[0]
+  });
+
+  const adlCategories = [
+    { id: 'bathing', name: 'Bathing', icon: '🛁' },
+    { id: 'dressing', name: 'Dressing', icon: '👕' },
+    { id: 'grooming', name: 'Grooming', icon: '💇' },
+    { id: 'feeding', name: 'Feeding/Eating', icon: '🍽️' },
+    { id: 'toileting', name: 'Toileting', icon: '🚽' },
+    { id: 'transferring', name: 'Transferring', icon: '🧑‍🦽' },
+    { id: 'mobility', name: 'Mobility', icon: '🚶' },
+    { id: 'medication', name: 'Medication Reminders', icon: '💊' },
+    { id: 'housekeeping', name: 'Light Housekeeping', icon: '🧹' },
+    { id: 'laundry', name: 'Laundry', icon: '🧺' },
+    { id: 'meal_prep', name: 'Meal Preparation', icon: '👨‍🍳' },
+    { id: 'companionship', name: 'Companionship', icon: '💬' },
+    { id: 'errands', name: 'Errands/Shopping', icon: '🛒' },
+    { id: 'transportation', name: 'Transportation', icon: '🚗' }
+  ];
+
+  useEffect(() => {
+    const fn = (e) => { if (isDirty) { e.preventDefault(); e.returnValue = "You have unsaved changes. Leave anyway?"; return e.returnValue; } };
+    window.addEventListener("beforeunload", fn);
+    return () => window.removeEventListener("beforeunload", fn);
+  }, [isDirty]);
+
+  useEffect(() => {
+    loadClients();
+  }, []);
+
+  useEffect(() => {
+    if (selectedClient) {
+      loadRequirements();
+      loadLogs();
+    }
+  }, [selectedClient, dateRange]);
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data.filter(c => c.status === 'active') : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const loadRequirements = async () => {
+    setLoading(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/adl/client/${selectedClient}/requirements`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setRequirements(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load requirements:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadLogs = async () => {
+    try {
+      const res = await fetch(
+        `${API_BASE_URL}/api/adl/client/${selectedClient}/logs?startDate=${dateRange.start}&endDate=${dateRange.end}`, 
+        { headers: { 'Authorization': `Bearer ${token}` } }
+      );
+      const data = await res.json();
+      setLogs(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load logs:', error);
+    }
+  };
+
+  const saveRequirement = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/adl/requirements`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ ...formData, clientId: selectedClient })
+      });
+      if (res.ok) {
+        setShowAddReqModal(false);
+        loadRequirements();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const logADL = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/adl/log`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ ...formData, clientId: selectedClient })
+      });
+      if (res.ok) {
+        setShowLogModal(false);
+        loadLogs();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const deleteRequirement = async (reqId) => {
+    const _cok = await confirm('Remove this ADL requirement?', {danger: true}); if (!_cok) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/adl/requirements/${reqId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadRequirements();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getAssistanceBadge = (level) => {
+    const colors = {
+      independent: '#4caf50',
+      supervision: '#8bc34a',
+      limited_assistance: '#ffeb3b',
+      extensive_assistance: '#ff9800',
+      total_dependence: '#f44336'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: level === 'limited_assistance' ? '#333' : 'white',
+        backgroundColor: colors[level] || '#9e9e9e'
+      }}>
+        {level?.replace(/_/g, ' ').toUpperCase()}
+      </span>
+    );
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      completed: '#4caf50',
+      partial: '#ff9800',
+      refused: '#f44336',
+      not_needed: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.replace(/_/g, ' ').toUpperCase()}
+      </span>
+    );
+  };
+
+  const getCategoryIcon = (categoryId) => {
+    const cat = adlCategories.find(c => c.id === categoryId);
+    return cat?.icon || '📋';
+  };
+
+  const getCategoryName = (categoryId) => {
+    const cat = adlCategories.find(c => c.id === categoryId);
+    return cat?.name || categoryId;
+  };
+
+  // Group logs by date
+  const logsByDate = logs.reduce((acc, log) => {
+    const date = new Date(log.performed_at).toLocaleDateString();
+    if (!acc[date]) acc[date] = [];
+    acc[date].push(log);
+    return acc;
+  }, {});
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🏠 ADL Tracking</h2>
+      </div>
+
+      {/* Client Selector */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', alignItems: 'flex-end' }}>
+          <div className="form-group" style={{ margin: 0, minWidth: '250px' }}>
+            <label>Select Client</label>
+            <select 
+              value={selectedClient} 
+              onChange={(e) => setSelectedClient(e.target.value)}
+            >
+              <option value="">-- Select a Client --</option>
+              {clients.map(c => (
+                <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+              ))}
+            </select>
+          </div>
+          {selectedClient && (
+            <>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>From</label>
+                <input 
+                  type="date" 
+                  value={dateRange.start}
+                  onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}
+                />
+              </div>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>To</label>
+                <input 
+                  type="date" 
+                  value={dateRange.end}
+                  onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}
+                />
+              </div>
+            </>
+          )}
+        </div>
+      </div>
+
+      {!selectedClient ? (
+        <div className="card">
+          <p style={{ color: '#666' }}>Select a client to view their ADL requirements and logs.</p>
+        </div>
+      ) : (
+        <>
+          {/* Tabs */}
+          <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+            <button 
+              className={`btn ${activeTab === 'logs' ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setActiveTab('logs')}
+            >
+              Daily Logs ({logs.length})
+            </button>
+            <button 
+              className={`btn ${activeTab === 'requirements' ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setActiveTab('requirements')}
+            >
+              Care Requirements ({requirements.length})
+            </button>
+            <div style={{ marginLeft: 'auto' }}>
+              {activeTab === 'logs' && (
+                <button className="btn btn-primary" onClick={() => setShowLogModal(true)}>
+                  + Log ADL
+                </button>
+              )}
+              {activeTab === 'requirements' && (
+                <button className="btn btn-primary" onClick={() => setShowAddReqModal(true)}>
+                  + Add Requirement
+                </button>
+              )}
+            </div>
+          </div>
+
+          {/* Logs Tab */}
+          {activeTab === 'logs' && (
+            <div className="card">
+              {loading ? (
+                <div className="loading"><div className="spinner"></div></div>
+              ) : logs.length === 0 ? (
+                <p>No ADL logs for this date range.</p>
+              ) : (
+                Object.entries(logsByDate).map(([date, dateLogs]) => (
+                  <div key={date} style={{ marginBottom: '1.5rem' }}>
+                    <h4 style={{ borderBottom: '1px solid #eee', paddingBottom: '0.5rem', marginBottom: '0.5rem' }}>
+                      {date}
+                    </h4>
+                    <table className="table">
+                      <thead>
+                        <tr>
+                          <th style={{ width: '40px' }}></th>
+                          <th>Activity</th>
+                          <th>Status</th>
+                          <th>Assistance</th>
+                          <th>Time</th>
+                          <th>Caregiver</th>
+                          <th>Notes</th>
+                        </tr>
+                      </thead>
+                      <tbody>
+                        {dateLogs.map(log => (
+                          <tr key={log.id}>
+                            <td style={{ fontSize: '1.3rem' }}>{getCategoryIcon(log.adl_category)}</td>
+                            <td><strong>{getCategoryName(log.adl_category)}</strong></td>
+                            <td>{getStatusBadge(log.status)}</td>
+                            <td>{getAssistanceBadge(log.assistance_level)}</td>
+                            <td>{new Date(log.performed_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</td>
+                            <td>{log.caregiver_first} {log.caregiver_last}</td>
+                            <td style={{ maxWidth: '200px', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                              {log.notes || '-'}
+                            </td>
+                          </tr>
+                        ))}
+                      </tbody>
+                    </table>
+                  </div>
+                ))
+              )}
+            </div>
+          )}
+
+          {/* Requirements Tab */}
+          {activeTab === 'requirements' && (
+            <div className="card">
+              {loading ? (
+                <div className="loading"><div className="spinner"></div></div>
+              ) : requirements.length === 0 ? (
+                <p>No ADL requirements set for this client. Add requirements to define their care needs.</p>
+              ) : (
+                <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))', gap: '1rem' }}>
+                  {requirements.map(req => (
+                    <div key={req.id} style={{ 
+                      border: '1px solid #ddd', 
+                      borderRadius: '8px', 
+                      padding: '1rem',
+                      backgroundColor: '#fafafa'
+                    }}>
+                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                          <span style={{ fontSize: '1.5rem' }}>{getCategoryIcon(req.adl_category)}</span>
+                          <strong>{getCategoryName(req.adl_category)}</strong>
+                        </div>
+                        <button 
+                          className="btn btn-sm btn-danger"
+                          onClick={() => deleteRequirement(req.id)}
+                        >
+                          ×
+                        </button>
+                      </div>
+                      <div style={{ marginTop: '0.5rem' }}>
+                        {getAssistanceBadge(req.assistance_level)}
+                      </div>
+                      <div style={{ marginTop: '0.5rem', fontSize: '0.9rem' }}>
+                        <strong>Frequency:</strong> {req.frequency || 'As needed'}
+                      </div>
+                      {req.special_instructions && (
+                        <div style={{ marginTop: '0.5rem', fontSize: '0.85rem', color: '#666' }}>
+                          {req.special_instructions}
+                        </div>
+                      )}
+                    </div>
+                  ))}
+                </div>
+              )}
+            </div>
+          )}
+        </>
+      )}
+
+      {/* Add Requirement Modal */}
+      {showAddReqModal && (
+        <div className="modal-overlay" onClick={() => setShowAddReqModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Add ADL Requirement</h3>
+              <button className="modal-close" onClick={() => setShowAddReqModal(false)}>×</button>
+            </div>
+            <RequirementForm 
+              categories={adlCategories}
+              existingCategories={requirements.map(r => r.adl_category)}
+              onSubmit={saveRequirement}
+              onCancel={() => setShowAddReqModal(false)}
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Log ADL Modal */}
+      {showLogModal && (
+        <div className="modal-overlay" onClick={() => setShowLogModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Log ADL Activity</h3>
+              <button className="modal-close" onClick={() => setShowLogModal(false)}>×</button>
+            </div>
+            <LogADLForm 
+              categories={adlCategories}
+              requirements={requirements}
+              onSubmit={logADL}
+              onCancel={() => setShowLogModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Requirement Form Component
+const RequirementForm = ({ categories, existingCategories, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    adlCategory: '',
+    assistanceLevel: 'limited_assistance',
+    frequency: '',
+    specialInstructions: ''
+  });
+
+  const availableCategories = categories.filter(c => !existingCategories.includes(c.id));
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.adlCategory) {
+      toast('Please select an ADL category');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>ADL Category *</label>
+        <select 
+          value={formData.adlCategory}
+          onChange={(e) => setFormData({ ...formData, adlCategory: e.target.value })}
+          required
+        >
+          <option value="">Select Category</option>
+          {availableCategories.map(cat => (
+            <option key={cat.id} value={cat.id}>{cat.icon} {cat.name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Assistance Level *</label>
+        <select 
+          value={formData.assistanceLevel}
+          onChange={(e) => setFormData({ ...formData, assistanceLevel: e.target.value })}
+        >
+          <option value="independent">Independent - No help needed</option>
+          <option value="supervision">Supervision - Standby/cueing only</option>
+          <option value="limited_assistance">Limited Assistance - Some hands-on help</option>
+          <option value="extensive_assistance">Extensive Assistance - Significant help needed</option>
+          <option value="total_dependence">Total Dependence - Full assistance required</option>
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Frequency</label>
+        <input 
+          type="text"
+          value={formData.frequency}
+          onChange={(e) => setFormData({ ...formData, frequency: e.target.value })}
+          placeholder="e.g., Daily, Twice daily, As needed"
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Special Instructions</label>
+        <textarea 
+          value={formData.specialInstructions}
+          onChange={(e) => setFormData({ ...formData, specialInstructions: e.target.value })}
+          placeholder="Any specific instructions for caregivers..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Add Requirement</button>
+      </div>
+    </form>
+  );
+};
+
+// Log ADL Form Component
+const LogADLForm = ({ categories, requirements, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    adlCategory: '',
+    status: 'completed',
+    assistanceLevel: 'limited_assistance',
+    notes: ''
+  });
+
+  // Use requirements to pre-fill assistance level when category is selected
+  const handleCategoryChange = (categoryId) => {
+    const req = requirements.find(r => r.adl_category === categoryId);
+    setFormData({ 
+      ...formData, 
+      adlCategory: categoryId,
+      assistanceLevel: req?.assistance_level || 'limited_assistance'
+    });
+  };
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.adlCategory) {
+      toast('Please select an ADL category');
+      return;
+    }
+    onSubmit({
+      ...formData,
+      performedAt: new Date().toISOString()
+    });
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>ADL Activity *</label>
+        <select 
+          value={formData.adlCategory}
+          onChange={(e) => handleCategoryChange(e.target.value)}
+          required
+        >
+          <option value="">Select Activity</option>
+          {categories.map(cat => (
+            <option key={cat.id} value={cat.id}>{cat.icon} {cat.name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Status *</label>
+          <select 
+            value={formData.status}
+            onChange={(e) => setFormData({ ...formData, status: e.target.value })}
+          >
+            <option value="completed">Completed</option>
+            <option value="partial">Partial</option>
+            <option value="refused">Refused</option>
+            <option value="not_needed">Not Needed</option>
+          </select>
+        </div>
+
+        <div className="form-group">
+          <label>Assistance Level</label>
+          <select 
+            value={formData.assistanceLevel}
+            onChange={(e) => setFormData({ ...formData, assistanceLevel: e.target.value })}
+          >
+            <option value="independent">Independent</option>
+            <option value="supervision">Supervision</option>
+            <option value="limited_assistance">Limited Assistance</option>
+            <option value="extensive_assistance">Extensive Assistance</option>
+            <option value="total_dependence">Total Dependence</option>
+          </select>
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Any observations or notes..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Log Activity</button>
+      </div>
+    </form>
+  );
+};
+
+export default ADLTracking;
diff --git a/templates/crm-homecare/frontend/src/components/admin/AbsenceManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/AbsenceManagement.jsx
new file mode 100644
index 0000000..52bed17
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/AbsenceManagement.jsx
@@ -0,0 +1,238 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/AbsenceManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const AbsenceManagement = ({ token }) => {
+  const [absences, setAbsences] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showForm, setShowForm] = useState(false);
+  const [formData, setFormData] = useState({
+    caregiverId: '',
+    date: '',
+    type: 'call_out',
+    reason: ''
+  });
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [absencesRes, caregiversRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/absences`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const absencesData = await absencesRes.json();
+      const caregiversData = await caregiversRes.json();
+
+      setAbsences(absencesData);
+      setCaregivers(caregiversData);
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/absences`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) throw new Error('Failed to record absence');
+
+      setFormData({
+        caregiverId: '',
+        date: '',
+        type: 'call_out',
+        reason: ''
+      });
+      setShowForm(false);
+      loadData();
+      toast('Absence recorded successfully!');
+    } catch (error) {
+      toast('Failed to record absence: ' + error.message, 'error');
+    }
+  };
+
+  const handleDelete = async (absenceId) => {
+    const _cok = await confirm('Are you sure you want to delete this absence?', {danger: true}); if (!_cok) return;
+    
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/absences/${absenceId}`, {
+        method: 'DELETE',
+        headers: {
+          'Authorization': `Bearer ${token}`
+        }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+      loadData();
+      toast('Absence deleted!');
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getTypeColor = (type) => {
+    switch (type) {
+      case 'call_out':
+        return 'badge-warning';
+      case 'no_show':
+        return 'badge-danger';
+      case 'sick':
+        return 'badge-info';
+      case 'personal':
+        return 'badge-primary';
+      default:
+        return 'badge-secondary';
+    }
+  };
+
+  const getTypeLabel = (type) => {
+    return type.replace('_', ' ').toUpperCase();
+  };
+
+  const getCaregiverName = (id) => {
+    const cg = caregivers.find(c => c.id === id);
+    return cg ? `${cg.first_name} ${cg.last_name}` : 'Unknown';
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📋 Absence Management</h2>
+        <button 
+          className="btn btn-primary"
+          onClick={() => setShowForm(!showForm)}
+        >
+          {showForm ? '✕ Cancel' : '➕ Record Absence'}
+        </button>
+      </div>
+
+      {showForm && (
+        <div className="card card-form">
+          <h3>Record Caregiver Absence</h3>
+          <form onSubmit={handleSubmit}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Caregiver *</label>
+                <select
+                  value={formData.caregiverId}
+                  onChange={(e) => setFormData({ ...formData, caregiverId: e.target.value })}
+                  required
+                >
+                  <option value="">Select a caregiver...</option>
+                  {caregivers.map(cg => (
+                    <option key={cg.id} value={cg.id}>
+                      {cg.first_name} {cg.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Absence Date *</label>
+                <input
+                  type="date"
+                  value={formData.date}
+                  onChange={(e) => setFormData({ ...formData, date: e.target.value })}
+                  required
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Absence Type *</label>
+                <select
+                  value={formData.type}
+                  onChange={(e) => setFormData({ ...formData, type: e.target.value })}
+                >
+                  <option value="call_out">Call Out</option>
+                  <option value="no_show">No Show</option>
+                  <option value="sick">Sick Leave</option>
+                  <option value="personal">Personal</option>
+                </select>
+              </div>
+
+              <div className="form-group" style={{ gridColumn: '1 / -1' }}>
+                <label>Reason</label>
+                <textarea
+                  value={formData.reason}
+                  onChange={(e) => setFormData({ ...formData, reason: e.target.value })}
+                  placeholder="Reason for absence..."
+                  rows="3"
+                ></textarea>
+              </div>
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Record Absence</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Absences Table */}
+      {loading ? (
+        <div className="loading"><div className="spinner"></div></div>
+      ) : absences.length === 0 ? (
+        <div className="card card-centered">
+          <p>No absences recorded.</p>
+        </div>
+      ) : (
+        <table className="table">
+          <thead>
+            <tr>
+              <th>Caregiver</th>
+              <th>Date</th>
+              <th>Type</th>
+              <th>Reason</th>
+              <th>Actions</th>
+            </tr>
+          </thead>
+          <tbody>
+            {absences.map(absence => (
+              <tr key={absence.id}>
+                <td><strong>{getCaregiverName(absence.caregiver_id)}</strong></td>
+                <td>{new Date(absence.date).toLocaleDateString()}</td>
+                <td>
+                  <span className={`badge ${getTypeColor(absence.type)}`}>
+                    {getTypeLabel(absence.type)}
+                  </span>
+                </td>
+                <td>{absence.reason || 'N/A'}</td>
+                <td>
+                  <button
+                    className="btn btn-sm btn-danger"
+                    onClick={() => handleDelete(absence.id)}
+                  >
+                    Delete
+                  </button>
+                </td>
+              </tr>
+            ))}
+          </tbody>
+        </table>
+      )}
+    </div>
+  );
+};
+
+export default AbsenceManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/AddCaregiverModal.jsx b/templates/crm-homecare/frontend/src/components/admin/AddCaregiverModal.jsx
new file mode 100644
index 0000000..1264de3
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/AddCaregiverModal.jsx
@@ -0,0 +1,145 @@
+// src/components/admin/AddCaregiverModal.jsx
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const AddCaregiverModal = ({ isOpen, onClose, onSuccess, token }) => {
+  const [formData, setFormData] = useState({
+    email: '',
+    password: '',
+    firstName: '',
+    lastName: '',
+    phone: '',
+    payRate: '15.00'
+  });
+  const [loading, setLoading] = useState(false);
+  const [error, setError] = useState('');
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+    setLoading(true);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/auth/register-caregiver`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          email: formData.email,
+          password: formData.password,
+          firstName: formData.firstName,
+          lastName: formData.lastName,
+          phone: formData.phone,
+          payRate: parseFloat(formData.payRate) || 15.00
+        })
+      });
+
+      if (!response.ok) {
+        const err = await response.json();
+        throw new Error(err.error || 'Failed to add caregiver');
+      }
+
+      alert('Caregiver added successfully!');
+      setFormData({ email: '', password: '', firstName: '', lastName: '', phone: '', payRate: '15.00' });
+      onSuccess();
+      onClose();
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  if (!isOpen) return null;
+
+  return (
+    <div className="modal active">
+      <div className="modal-content">
+        <div className="modal-header">
+          <h2>Add New Caregiver</h2>
+          <button className="close-btn" onClick={onClose}>×</button>
+        </div>
+
+        {error && <div className="alert alert-error">{error}</div>}
+
+        <form onSubmit={handleSubmit}>
+          <div className="form-group">
+            <label>First Name *</label>
+            <input
+              type="text"
+              value={formData.firstName}
+              onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Last Name *</label>
+            <input
+              type="text"
+              value={formData.lastName}
+              onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Email *</label>
+            <input
+              type="email"
+              value={formData.email}
+              onChange={(e) => setFormData({ ...formData, email: e.target.value })}
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Password *</label>
+            <input
+              type="password"
+              value={formData.password}
+              onChange={(e) => setFormData({ ...formData, password: e.target.value })}
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Phone</label>
+            <input
+              type="tel"
+              value={formData.phone}
+              onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Default Hourly Pay Rate *</label>
+            <input
+              type="number"
+              step="0.01"
+              min="0"
+              value={formData.payRate}
+              onChange={(e) => setFormData({ ...formData, payRate: e.target.value })}
+              placeholder="15.00"
+              required
+            />
+            <small className="text-muted">Can set different rates per care type after adding</small>
+          </div>
+
+          <div className="modal-actions">
+            <button type="submit" className="btn btn-primary" disabled={loading}>
+              {loading ? 'Adding...' : 'Add Caregiver'}
+            </button>
+            <button type="button" className="btn btn-secondary" onClick={onClose}>
+              Cancel
+            </button>
+          </div>
+        </form>
+      </div>
+    </div>
+  );
+};
+
+export default AddCaregiverModal;
diff --git a/templates/crm-homecare/frontend/src/components/admin/AlertsManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/AlertsManagement.jsx
new file mode 100644
index 0000000..7a401fd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/AlertsManagement.jsx
@@ -0,0 +1,494 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/AlertsManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const AlertsManagement = ({ token }) => {
+  const [alerts, setAlerts] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ type: '', priority: '', status: 'active' });
+  const [showCreateModal, setShowCreateModal] = useState(false);
+
+  const alertTypes = [
+    { id: 'certification_expiring', name: 'Certification Expiring', icon: '📜', color: '#ff9800' },
+    { id: 'background_check_expiring', name: 'Background Check Expiring', icon: '🔒', color: '#f44336' },
+    { id: 'schedule_conflict', name: 'Schedule Conflict', icon: '📅', color: '#e91e63' },
+    { id: 'missed_clock_in', name: 'Missed Clock In', icon: '⏰', color: '#f44336' },
+    { id: 'overtime_warning', name: 'Overtime Warning', icon: '⚠️', color: '#ff9800' },
+    { id: 'authorization_expiring', name: 'Authorization Expiring', icon: '📋', color: '#9c27b0' },
+    { id: 'care_plan_review', name: 'Care Plan Review Due', icon: '📝', color: '#2196f3' },
+    { id: 'medication_refill', name: 'Medication Refill Needed', icon: '💊', color: '#00bcd4' },
+    { id: 'incident_report', name: 'Incident Report Filed', icon: '🚨', color: '#f44336' },
+    { id: 'compliance_issue', name: 'Compliance Issue', icon: '⚖️', color: '#ff5722' },
+    { id: 'billing_issue', name: 'Billing Issue', icon: '💰', color: '#795548' },
+    { id: 'custom', name: 'Custom Alert', icon: '🔔', color: '#607d8b' }
+  ];
+
+  useEffect(() => {
+    loadAlerts();
+  }, [filter]);
+
+  const loadAlerts = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.type) params.append('type', filter.type);
+      if (filter.priority) params.append('priority', filter.priority);
+      if (filter.status) params.append('status', filter.status);
+      
+      const res = await fetch(`${API_BASE_URL}/api/alerts?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setAlerts(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load alerts:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const createAlert = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/alerts`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowCreateModal(false);
+        loadAlerts();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const acknowledgeAlert = async (alertId) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/alerts/${alertId}/acknowledge`, {
+        method: 'PUT',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadAlerts();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const resolveAlert = async (alertId) => {
+    const resolution = prompt('Resolution notes (optional):');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/alerts/${alertId}/resolve`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ resolution })
+      });
+      if (res.ok) {
+        loadAlerts();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const dismissAlert = async (alertId) => {
+    const _cok = await confirm('Dismiss this alert without resolving?', {danger: true}); if (!_cok) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/alerts/${alertId}/dismiss`, {
+        method: 'PUT',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadAlerts();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getPriorityBadge = (priority) => {
+    const colors = {
+      low: '#8bc34a',
+      medium: '#ff9800',
+      high: '#f44336',
+      critical: '#b71c1c'
+    };
+    return (
+      <span style={{
+        padding: '2px 8px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[priority] || '#9e9e9e'
+      }}>
+        {priority?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      active: '#f44336',
+      acknowledged: '#ff9800',
+      resolved: '#4caf50',
+      dismissed: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 8px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const getTypeInfo = (typeId) => {
+    return alertTypes.find(t => t.id === typeId) || { icon: '🔔', name: typeId, color: '#607d8b' };
+  };
+
+  const criticalCount = alerts.filter(a => a.priority === 'critical' && a.status === 'active').length;
+  const highCount = alerts.filter(a => a.priority === 'high' && a.status === 'active').length;
+  const activeCount = alerts.filter(a => a.status === 'active').length;
+  const acknowledgedCount = alerts.filter(a => a.status === 'acknowledged').length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🚨 Alerts & Notifications</h2>
+        <button className="btn btn-primary" onClick={() => setShowCreateModal(true)}>
+          + Create Alert
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, priority: 'critical', status: 'active' })}
+          style={{ cursor: 'pointer', borderLeft: '4px solid #b71c1c' }}
+        >
+          <h4>Critical</h4>
+          <div className="value" style={{ color: '#b71c1c' }}>{criticalCount}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, priority: 'high', status: 'active' })}
+          style={{ cursor: 'pointer', borderLeft: '4px solid #f44336' }}
+        >
+          <h4>High Priority</h4>
+          <div className="value" style={{ color: '#f44336' }}>{highCount}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, priority: '', status: 'active' })}
+          style={{ cursor: 'pointer', borderLeft: '4px solid #ff9800' }}
+        >
+          <h4>Active</h4>
+          <div className="value" style={{ color: '#ff9800' }}>{activeCount}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, status: 'acknowledged' })}
+          style={{ cursor: 'pointer', borderLeft: '4px solid #2196f3' }}
+        >
+          <h4>Acknowledged</h4>
+          <div className="value" style={{ color: '#2196f3' }}>{acknowledgedCount}</div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Type</label>
+            <select value={filter.type} onChange={(e) => setFilter({ ...filter, type: e.target.value })}>
+              <option value="">All Types</option>
+              {alertTypes.map(t => (
+                <option key={t.id} value={t.id}>{t.name}</option>
+              ))}
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Priority</label>
+            <select value={filter.priority} onChange={(e) => setFilter({ ...filter, priority: e.target.value })}>
+              <option value="">All Priorities</option>
+              <option value="critical">Critical</option>
+              <option value="high">High</option>
+              <option value="medium">Medium</option>
+              <option value="low">Low</option>
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Status</label>
+            <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+              <option value="">All</option>
+              <option value="active">Active</option>
+              <option value="acknowledged">Acknowledged</option>
+              <option value="resolved">Resolved</option>
+              <option value="dismissed">Dismissed</option>
+            </select>
+          </div>
+          <button 
+            className="btn btn-secondary" 
+            style={{ alignSelf: 'flex-end' }}
+            onClick={() => setFilter({ type: '', priority: '', status: 'active' })}
+          >
+            Reset Filters
+          </button>
+        </div>
+      </div>
+
+      {/* Alerts List */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : alerts.length === 0 ? (
+          <p>No alerts found. 🎉</p>
+        ) : (
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+            {alerts.map(alert => {
+              const typeInfo = getTypeInfo(alert.alert_type);
+              return (
+                <div 
+                  key={alert.id} 
+                  style={{ 
+                    border: '1px solid #ddd', 
+                    borderRadius: '8px', 
+                    padding: '1rem',
+                    borderLeft: `4px solid ${typeInfo.color}`,
+                    backgroundColor: alert.status === 'active' ? '#fff' : '#fafafa',
+                    opacity: alert.status === 'dismissed' ? 0.6 : 1
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.5rem' }}>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                      <span style={{ fontSize: '1.5rem' }}>{typeInfo.icon}</span>
+                      <div>
+                        <strong>{typeInfo.name}</strong>
+                        <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.25rem' }}>
+                          {getPriorityBadge(alert.priority)}
+                          {getStatusBadge(alert.status)}
+                        </div>
+                      </div>
+                    </div>
+                    <span style={{ fontSize: '0.85rem', color: '#666' }}>
+                      {new Date(alert.created_at).toLocaleString()}
+                    </span>
+                  </div>
+
+                  <div style={{ marginTop: '0.75rem', color: '#333' }}>
+                    {alert.message}
+                  </div>
+
+                  {alert.related_entity_type && (
+                    <div style={{ marginTop: '0.5rem', fontSize: '0.85rem', color: '#666' }}>
+                      <strong>Related:</strong> {alert.related_entity_type} 
+                      {alert.related_entity_name && ` - ${alert.related_entity_name}`}
+                    </div>
+                  )}
+
+                  {alert.due_date && (
+                    <div style={{ marginTop: '0.25rem', fontSize: '0.85rem', color: new Date(alert.due_date) < new Date() ? '#f44336' : '#666' }}>
+                      <strong>Due:</strong> {new Date(alert.due_date).toLocaleDateString()}
+                      {new Date(alert.due_date) < new Date() && ' (OVERDUE)'}
+                    </div>
+                  )}
+
+                  {alert.resolution && (
+                    <div style={{ 
+                      marginTop: '0.5rem', 
+                      padding: '0.5rem',
+                      backgroundColor: '#e8f5e9',
+                      borderRadius: '4px',
+                      fontSize: '0.85rem'
+                    }}>
+                      <strong>Resolution:</strong> {alert.resolution}
+                    </div>
+                  )}
+
+                  {alert.status === 'active' && (
+                    <div style={{ marginTop: '0.75rem', display: 'flex', gap: '0.5rem' }}>
+                      <button 
+                        className="btn btn-sm btn-secondary"
+                        onClick={() => acknowledgeAlert(alert.id)}
+                      >
+                        👁️ Acknowledge
+                      </button>
+                      <button 
+                        className="btn btn-sm btn-success"
+                        onClick={() => resolveAlert(alert.id)}
+                      >
+                        ✓ Resolve
+                      </button>
+                      <button 
+                        className="btn btn-sm btn-danger"
+                        onClick={() => dismissAlert(alert.id)}
+                      >
+                        ✗ Dismiss
+                      </button>
+                    </div>
+                  )}
+
+                  {alert.status === 'acknowledged' && (
+                    <div style={{ marginTop: '0.75rem', display: 'flex', gap: '0.5rem' }}>
+                      <button 
+                        className="btn btn-sm btn-success"
+                        onClick={() => resolveAlert(alert.id)}
+                      >
+                        ✓ Resolve
+                      </button>
+                      <button 
+                        className="btn btn-sm btn-danger"
+                        onClick={() => dismissAlert(alert.id)}
+                      >
+                        ✗ Dismiss
+                      </button>
+                    </div>
+                  )}
+                </div>
+              );
+            })}
+          </div>
+        )}
+      </div>
+
+      {/* Create Alert Modal */}
+      {showCreateModal && (
+        <div className="modal-overlay" onClick={() => setShowCreateModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Create Alert</h3>
+              <button className="modal-close" onClick={() => setShowCreateModal(false)}>×</button>
+            </div>
+            <CreateAlertForm 
+              alertTypes={alertTypes}
+              onSubmit={createAlert}
+              onCancel={() => setShowCreateModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Create Alert Form Component
+const CreateAlertForm = ({ alertTypes, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    alertType: 'custom',
+    priority: 'medium',
+    message: '',
+    dueDate: '',
+    relatedEntityType: '',
+    relatedEntityId: ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.message) {
+      toast('Message is required');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Alert Type *</label>
+          <select 
+            value={formData.alertType}
+            onChange={(e) => setFormData({ ...formData, alertType: e.target.value })}
+          >
+            {alertTypes.map(t => (
+              <option key={t.id} value={t.id}>{t.icon} {t.name}</option>
+            ))}
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Priority *</label>
+          <select 
+            value={formData.priority}
+            onChange={(e) => setFormData({ ...formData, priority: e.target.value })}
+          >
+            <option value="low">Low</option>
+            <option value="medium">Medium</option>
+            <option value="high">High</option>
+            <option value="critical">Critical</option>
+          </select>
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Message *</label>
+        <textarea 
+          value={formData.message}
+          onChange={(e) => setFormData({ ...formData, message: e.target.value })}
+          placeholder="Describe the alert..."
+          rows={3}
+          required
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Due Date (Optional)</label>
+        <input 
+          type="date"
+          value={formData.dueDate}
+          onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
+        />
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Related Entity Type</label>
+          <select 
+            value={formData.relatedEntityType}
+            onChange={(e) => setFormData({ ...formData, relatedEntityType: e.target.value })}
+          >
+            <option value="">None</option>
+            <option value="client">Client</option>
+            <option value="caregiver">Caregiver</option>
+            <option value="schedule">Schedule</option>
+            <option value="invoice">Invoice</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Related Entity ID</label>
+          <input 
+            type="text"
+            value={formData.relatedEntityId}
+            onChange={(e) => setFormData({ ...formData, relatedEntityId: e.target.value })}
+            placeholder="ID (optional)"
+          />
+        </div>
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Create Alert</button>
+      </div>
+    </form>
+  );
+};
+
+export default AlertsManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ApplicationDetail.jsx b/templates/crm-homecare/frontend/src/components/admin/ApplicationDetail.jsx
new file mode 100644
index 0000000..6eb92d5
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ApplicationDetail.jsx
@@ -0,0 +1,297 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/ApplicationDetail.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ApplicationDetail = ({ applicationId, token, onBack }) => {
+  const [app, setApp] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [status, setStatus] = useState('');
+  const [interviewNotes, setInterviewNotes] = useState('');
+  const [hiring, setHiring] = useState(false);
+  const [message, setMessage] = useState('');
+
+  useEffect(() => {
+    loadApplication();
+  }, [applicationId]);
+
+  const loadApplication = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications/${applicationId}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setApp(data);
+      setStatus(data.status);
+      setInterviewNotes(data.interview_notes || '');
+    } catch (error) {
+      console.error('Failed to load application:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleUpdateStatus = async (newStatus) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications/${applicationId}/status`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          status: newStatus,
+          notes: interviewNotes
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to update');
+      
+      setStatus(newStatus);
+      setMessage(`Status updated to ${newStatus}`);
+      setTimeout(() => setMessage(''), 2000);
+      loadApplication();
+    } catch (error) {
+      toast('Failed to update: ' + error.message, 'error');
+    }
+  };
+
+  const handleSaveNotes = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications/${applicationId}/notes`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ notes: interviewNotes })
+      });
+
+      if (!response.ok) throw new Error('Failed to save notes');
+      
+      setMessage('Notes saved');
+      setTimeout(() => setMessage(''), 2000);
+    } catch (error) {
+      toast('Failed to save notes: ' + error.message, 'error');
+    }
+  };
+
+  const handleHireApplicant = async () => {
+    const _cok = await confirm('Convert this applicant to a caregiver account?', {danger: true}); if (!_cok) return;
+
+    setHiring(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications/${applicationId}/hire`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          hourlyRate: 15.00
+        })
+      });
+
+      if (!response.ok) {
+        const data = await response.json();
+        throw new Error(data.error || 'Failed to hire');
+      }
+
+      setMessage('✓ Applicant hired and caregiver account created!');
+      setTimeout(() => onBack(), 2000);
+    } catch (error) {
+      toast('Failed to hire: ' + error.message, 'error');
+    } finally {
+      setHiring(false);
+    }
+  };
+
+  if (loading) {
+    return <div className="loading"><div className="spinner"></div></div>;
+  }
+
+  if (!app) {
+    return <div className="card card-centered"><p>Application not found</p></div>;
+  }
+
+  // Parse certifications from comma-separated string
+  const certifications = app.certifications ? app.certifications.split(',').map(c => c.trim()).filter(Boolean) : [];
+  
+  // Parse availability days
+  const availabilityDays = app.availability_days ? app.availability_days.split(',').map(d => d.trim()).filter(Boolean) : [];
+  
+  // Parse shifts
+  const shifts = app.availability_shifts ? app.availability_shifts.split(',').map(s => s.trim()).filter(Boolean) : [];
+
+  return (
+    <div>
+      <div className="page-header">
+        <button className="btn btn-secondary" onClick={onBack}>← Back</button>
+        <h2>{app.first_name} {app.last_name}</h2>
+        <span className={`badge ${
+          app.status === 'hired' ? 'badge-success' :
+          app.status === 'rejected' ? 'badge-danger' :
+          'badge-warning'
+        }`}>{app.status?.toUpperCase()}</span>
+      </div>
+
+      {message && <div className="alert alert-success">{message}</div>}
+
+      <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+        {/* Contact Info */}
+        <div className="card">
+          <h3>Contact Information</h3>
+          <p><strong>Email:</strong> <a href={`mailto:${app.email}`}>{app.email}</a></p>
+          <p><strong>Phone:</strong> <a href={`tel:${app.phone}`}>{app.phone}</a></p>
+          {app.date_of_birth && <p><strong>DOB:</strong> {new Date(app.date_of_birth).toLocaleDateString()}</p>}
+          {app.address && <p><strong>Address:</strong> {app.address}, {app.city}, {app.state} {app.zip}</p>}
+          <p><strong>Applied:</strong> {new Date(app.created_at).toLocaleDateString()}</p>
+        </div>
+
+        {/* Experience */}
+        <div className="card">
+          <h3>Experience</h3>
+          {app.years_experience && <p><strong>Years:</strong> {app.years_experience} years</p>}
+          {app.cna_license && <p><strong>CNA License:</strong> {app.cna_license}</p>}
+          {app.previous_employer && (
+            <div className="experience-item">
+              <p><strong>Previous Employer:</strong> {app.previous_employer}</p>
+              {app.reason_for_leaving && <p><strong>Reason for Leaving:</strong> {app.reason_for_leaving}</p>}
+            </div>
+          )}
+        </div>
+      </div>
+
+      {/* Certifications */}
+      {certifications.length > 0 && (
+        <div className="card">
+          <h3>Certifications</h3>
+          <div className="cert-badges">
+            {certifications.map(cert => (
+              <span key={cert} className="badge badge-success" style={{ marginRight: '0.5rem' }}>{cert}</span>
+            ))}
+          </div>
+        </div>
+      )}
+
+      {/* Eligibility */}
+      <div className="card">
+        <h3>Eligibility</h3>
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr 1fr' }}>
+          <p><strong>Driver's License:</strong> {app.has_drivers_license ? '✓ Yes' : '✗ No'}</p>
+          <p><strong>Transportation:</strong> {app.has_transportation ? '✓ Yes' : '✗ No'}</p>
+          <p><strong>Legal to Work:</strong> {app.legal_to_work ? '✓ Yes' : '✗ No'}</p>
+          <p><strong>Background Check:</strong> {app.willing_background_check ? '✓ Yes' : '✗ No'}</p>
+          <p><strong>Felony:</strong> {app.felony_conviction ? 'Yes' : 'No'}</p>
+        </div>
+        {app.felony_conviction && app.felony_explanation && (
+          <p style={{ marginTop: '1rem' }}><strong>Felony Explanation:</strong> {app.felony_explanation}</p>
+        )}
+      </div>
+
+      {/* References */}
+      <div className="card">
+        <h3>Professional References</h3>
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+          {app.ref1_name && (
+            <div className="reference-item">
+              <p><strong>{app.ref1_name}</strong> ({app.ref1_relationship})</p>
+              <p>Phone: <a href={`tel:${app.ref1_phone}`}>{app.ref1_phone}</a></p>
+              {app.ref1_email && <p>Email: <a href={`mailto:${app.ref1_email}`}>{app.ref1_email}</a></p>}
+            </div>
+          )}
+          {app.ref2_name && (
+            <div className="reference-item">
+              <p><strong>{app.ref2_name}</strong> ({app.ref2_relationship})</p>
+              <p>Phone: <a href={`tel:${app.ref2_phone}`}>{app.ref2_phone}</a></p>
+              {app.ref2_email && <p>Email: <a href={`mailto:${app.ref2_email}`}>{app.ref2_email}</a></p>}
+            </div>
+          )}
+        </div>
+        {!app.ref1_name && !app.ref2_name && <p style={{ color: '#666' }}>No references provided</p>}
+      </div>
+
+      {/* Availability & Expectations */}
+      <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+        <div className="card">
+          <h3>Availability</h3>
+          {availabilityDays.length > 0 && (
+            <p><strong>Days:</strong> {availabilityDays.join(', ')}</p>
+          )}
+          {shifts.length > 0 && (
+            <p><strong>Shifts:</strong> {shifts.join(', ')}</p>
+          )}
+          {app.hours_desired && <p><strong>Hours Desired:</strong> {app.hours_desired}</p>}
+          {app.earliest_start_date && (
+            <p><strong>Can Start:</strong> {new Date(app.earliest_start_date).toLocaleDateString()}</p>
+          )}
+        </div>
+
+        <div className="card">
+          <h3>Additional Information</h3>
+          {app.why_interested && (
+            <div>
+              <p><strong>Why Interested:</strong></p>
+              <p style={{ color: '#666' }}>{app.why_interested}</p>
+            </div>
+          )}
+          {app.additional_info && (
+            <div style={{ marginTop: '1rem' }}>
+              <p><strong>Additional Notes:</strong></p>
+              <p style={{ color: '#666' }}>{app.additional_info}</p>
+            </div>
+          )}
+        </div>
+      </div>
+
+      {/* Interview Notes */}
+      <div className="card">
+        <h3>Interview Notes</h3>
+        <textarea
+          value={interviewNotes}
+          onChange={(e) => setInterviewNotes(e.target.value)}
+          placeholder="Add interview observations, concerns, or recommendations..."
+          rows="5"
+          style={{ width: '100%', marginBottom: '1rem' }}
+        ></textarea>
+        <button className="btn btn-secondary" onClick={handleSaveNotes}>Save Notes</button>
+      </div>
+
+      {/* Status & Actions */}
+      <div className="card">
+        <h3>Application Status</h3>
+        <div className="status-buttons" style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+          {['new', 'reviewing', 'interviewed', 'offered', 'hired', 'rejected'].map(s => (
+            <button
+              key={s}
+              className={`btn ${status === s ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => handleUpdateStatus(s)}
+              disabled={s === status}
+            >
+              {s.charAt(0).toUpperCase() + s.slice(1)}
+            </button>
+          ))}
+        </div>
+
+        {status === 'offered' && (
+          <div style={{ marginTop: '1rem' }}>
+            <button
+              className="btn btn-success btn-large"
+              onClick={handleHireApplicant}
+              disabled={hiring}
+              style={{ padding: '1rem 2rem', fontSize: '1.1rem' }}
+            >
+              {hiring ? 'Creating account...' : '✓ Hire & Create Account'}
+            </button>
+            <p style={{ color: '#666', fontSize: '0.9rem', marginTop: '0.5rem' }}>
+              This will create a caregiver user account and copy application data to their profile.
+            </p>
+          </div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+export default ApplicationDetail;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ApplicationsDashboard.jsx b/templates/crm-homecare/frontend/src/components/admin/ApplicationsDashboard.jsx
new file mode 100644
index 0000000..08b034b
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ApplicationsDashboard.jsx
@@ -0,0 +1,292 @@
+import { toast } from '../Toast';
+// src/components/admin/ApplicationsDashboard.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import ApplicationDetail from './ApplicationDetail';
+
+const ApplicationsDashboard = ({ token }) => {
+  const [applications, setApplications] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState('applied');
+  const [selectedApp, setSelectedApp] = useState(null);
+  const [searchTerm, setSearchTerm] = useState('');
+  const [hireModal, setHireModal] = useState(null);
+  const [hireForm, setHireForm] = useState({ hourlyRate: '15.00', email: '', password: '' });
+  const [hiring, setHiring] = useState(false);
+  const [hireResult, setHireResult] = useState(null);
+
+  useEffect(() => {
+    loadApplications();
+  }, []);
+
+  const loadApplications = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setApplications(data);
+    } catch (error) {
+      console.error('Failed to load applications:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const openHireModal = (app, e) => {
+    e.stopPropagation();
+    setHireForm({ hourlyRate: '15.00', email: app.email || '', password: '' });
+    setHireModal(app);
+    setHireResult(null);
+  };
+
+  const handleHire = async () => {
+    if (!hireModal) return;
+    setHiring(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications/${hireModal.id}/hire`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          hourlyRate: parseFloat(hireForm.hourlyRate) || 15.00,
+          email: hireForm.email,
+          password: hireForm.password || undefined
+        })
+      });
+      const data = await response.json();
+      if (!response.ok) throw new Error(data.error || 'Hire failed');
+      setHireResult(data);
+      loadApplications();
+    } catch (error) {
+      toast('Error: ' + error.message, 'error');
+    } finally {
+      setHiring(false);
+    }
+  };
+
+  const filteredApplications = applications
+    .filter(app => {
+      if (filter !== 'all' && app.status !== filter) return false;
+      if (searchTerm) {
+        const term = searchTerm.toLowerCase();
+        return (
+          app.first_name.toLowerCase().includes(term) ||
+          app.last_name.toLowerCase().includes(term) ||
+          app.email.toLowerCase().includes(term)
+        );
+      }
+      return true;
+    })
+    .sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
+
+  const getStatusColor = (status) => {
+    switch (status) {
+      case 'hired': return 'badge-success';
+      case 'offered': return 'badge-primary';
+      case 'interviewed': return 'badge-info';
+      case 'reviewing': return 'badge-warning';
+      case 'rejected': return 'badge-danger';
+      case 'applied': return 'badge-secondary';
+      default: return 'badge-secondary';
+    }
+  };
+
+  const getCertificationBadges = (app) => {
+    const certs = [];
+    if (app.has_cna) certs.push('CNA');
+    if (app.has_lpn) certs.push('LPN');
+    if (app.has_rn) certs.push('RN');
+    if (app.has_cpr) certs.push('CPR');
+    if (app.has_first_aid) certs.push('First Aid');
+    return certs;
+  };
+
+  if (selectedApp) {
+    return (
+      <ApplicationDetail 
+        applicationId={selectedApp.id}
+        token={token}
+        onBack={() => {
+          setSelectedApp(null);
+          loadApplications();
+        }}
+      />
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📋 Job Applications</h2>
+      </div>
+
+      {/* Search & Filter */}
+      <div className="card">
+        <div className="filter-controls">
+          <input
+            type="text"
+            placeholder="Search by name or email..."
+            value={searchTerm}
+            onChange={(e) => setSearchTerm(e.target.value)}
+            className="search-input"
+          />
+        </div>
+
+        <div className="filter-tabs">
+          {['all', 'applied', 'reviewing', 'interviewed', 'offered', 'hired', 'rejected'].map(f => (
+            <button
+              key={f}
+              className={`filter-tab ${filter === f ? 'active' : ''}`}
+              onClick={() => setFilter(f)}
+            >
+              {f.charAt(0).toUpperCase() + f.slice(1)}
+              <span className="filter-count">
+                ({applications.filter(a => f === 'all' || a.status === f).length})
+              </span>
+            </button>
+          ))}
+        </div>
+      </div>
+
+      {/* Applications Table */}
+      {loading ? (
+        <div className="loading"><div className="spinner"></div></div>
+      ) : filteredApplications.length === 0 ? (
+        <div className="card card-centered">
+          <p>No applications found.</p>
+        </div>
+      ) : (
+        <div className="applications-grid">
+          {filteredApplications.map(app => (
+            <div 
+              key={app.id} 
+              className="application-card"
+              onClick={() => setSelectedApp(app)}
+            >
+              <div className="app-header">
+                <div>
+                  <h4>{app.first_name} {app.last_name}</h4>
+                  <p className="app-date">{new Date(app.created_at).toLocaleDateString()}</p>
+                </div>
+                <span className={`badge ${getStatusColor(app.status)}`}>
+                  {app.status.toUpperCase()}
+                </span>
+              </div>
+
+              <div className="app-body">
+                <p><strong>Email:</strong> {app.email}</p>
+                <p><strong>Phone:</strong> {app.phone}</p>
+                
+                {app.years_of_experience && (
+                  <p><strong>Experience:</strong> {app.years_of_experience} years</p>
+                )}
+
+                {getCertificationBadges(app).length > 0 && (
+                  <div className="app-certs">
+                    {getCertificationBadges(app).map(cert => (
+                      <span key={cert} className="badge badge-info">{cert}</span>
+                    ))}
+                  </div>
+                )}
+
+                {app.expected_hourly_rate && (
+                  <p><strong>Expected Rate:</strong> {app.expected_hourly_rate}</p>
+                )}
+              </div>
+
+              <div className="app-footer" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                <small>Click to review application</small>
+                {app.status !== 'hired' && app.status !== 'rejected' && (
+                  <button 
+                    onClick={(e) => openHireModal(app, e)}
+                    style={{ padding: '0.35rem 0.75rem', background: '#059669', color: '#fff', border: 'none', borderRadius: '6px', fontSize: '0.78rem', fontWeight: '600', cursor: 'pointer' }}>
+                    ✅ Hire as Caregiver
+                  </button>
+                )}
+                {app.status === 'hired' && (
+                  <span style={{ padding: '0.25rem 0.6rem', background: '#D1FAE5', color: '#065F46', borderRadius: '6px', fontSize: '0.75rem', fontWeight: '600' }}>
+                    ✓ Hired
+                  </span>
+                )}
+              </div>
+            </div>
+          ))}
+        </div>
+      )}
+
+      {/* Hire Modal */}
+      {hireModal && (
+        <div onClick={() => { setHireModal(null); setHireResult(null); }}
+          style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, padding: '1rem' }}>
+          <div onClick={(e) => e.stopPropagation()}
+            style={{ background: '#fff', borderRadius: '12px', width: '100%', maxWidth: '480px', overflow: 'hidden' }}>
+            
+            {!hireResult ? (
+              <>
+                <div style={{ padding: '1.25rem', borderBottom: '1px solid #e5e7eb' }}>
+                  <h3 style={{ margin: 0, color: '#059669' }}>✅ Convert to Caregiver</h3>
+                  <p style={{ margin: '0.5rem 0 0', fontSize: '0.88rem', color: '#6B7280' }}>
+                    Create a caregiver account for <strong>{hireModal.first_name} {hireModal.last_name}</strong>
+                  </p>
+                </div>
+                <div style={{ padding: '1.25rem' }}>
+                  <div style={{ marginBottom: '1rem' }}>
+                    <label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Email (for login) *</label>
+                    <input value={hireForm.email} onChange={(e) => setHireForm(p => ({ ...p, email: e.target.value }))}
+                      style={{ width: '100%', padding: '0.6rem', borderRadius: '6px', border: '1px solid #ddd', fontSize: '0.95rem' }} />
+                  </div>
+                  <div style={{ marginBottom: '1rem' }}>
+                    <label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Temporary Password</label>
+                    <input value={hireForm.password} onChange={(e) => setHireForm(p => ({ ...p, password: e.target.value }))} 
+                      placeholder="Leave blank to auto-generate"
+                      style={{ width: '100%', padding: '0.6rem', borderRadius: '6px', border: '1px solid #ddd', fontSize: '0.95rem' }} />
+                    <small style={{ color: '#9CA3AF' }}>They'll use this to log in the first time</small>
+                  </div>
+                  <div style={{ marginBottom: '1rem' }}>
+                    <label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Hourly Rate ($)</label>
+                    <input type="number" step="0.25" value={hireForm.hourlyRate} onChange={(e) => setHireForm(p => ({ ...p, hourlyRate: e.target.value }))}
+                      style={{ width: '100%', padding: '0.6rem', borderRadius: '6px', border: '1px solid #ddd', fontSize: '0.95rem' }} />
+                  </div>
+
+                  {/* Applicant Summary */}
+                  <div style={{ padding: '0.75rem', background: '#F0FDF4', borderRadius: '8px', border: '1px solid #BBF7D0', fontSize: '0.82rem', marginBottom: '1rem' }}>
+                    <div style={{ fontWeight: '700', marginBottom: '0.4rem', color: '#065F46' }}>Applicant Info</div>
+                    <div>📞 {hireModal.phone || 'No phone'}</div>
+                    <div>📍 {hireModal.city ? `${hireModal.city}, ${hireModal.state}` : 'No location'}</div>
+                    {hireModal.years_experience && <div>🏥 {hireModal.years_experience} yrs experience</div>}
+                    {hireModal.cna_license && <div>📋 CNA Licensed</div>}
+                  </div>
+                </div>
+                <div style={{ padding: '1rem 1.25rem', borderTop: '1px solid #e5e7eb', display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
+                  <button onClick={() => { setHireModal(null); setHireResult(null); }}
+                    style={{ padding: '0.6rem 1.25rem', background: '#F3F4F6', border: '1px solid #D1D5DB', borderRadius: '8px', cursor: 'pointer', fontSize: '0.9rem' }}>Cancel</button>
+                  <button onClick={handleHire} disabled={hiring || !hireForm.email}
+                    style={{ padding: '0.6rem 1.25rem', background: hiring ? '#9CA3AF' : '#059669', color: '#fff', border: 'none', borderRadius: '8px', cursor: hiring ? 'not-allowed' : 'pointer', fontSize: '0.9rem', fontWeight: '600' }}>
+                    {hiring ? 'Creating...' : '✅ Create Caregiver Account'}
+                  </button>
+                </div>
+              </>
+            ) : (
+              <div style={{ padding: '2rem', textAlign: 'center' }}>
+                <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>🎉</div>
+                <h3 style={{ margin: '0 0 0.5rem', color: '#059669' }}>Caregiver Created!</h3>
+                <p style={{ color: '#374151', marginBottom: '1rem' }}><strong>{hireModal.first_name} {hireModal.last_name}</strong> is now a caregiver.</p>
+                <div style={{ padding: '1rem', background: '#FEF3C7', borderRadius: '8px', border: '1px solid #FCD34D', textAlign: 'left', marginBottom: '1.5rem' }}>
+                  <div style={{ fontWeight: '700', marginBottom: '0.5rem', color: '#92400E' }}>⚠️ Login Credentials (save these!)</div>
+                  <div style={{ fontSize: '0.9rem' }}><strong>Email:</strong> {hireForm.email}</div>
+                  <div style={{ fontSize: '0.9rem' }}><strong>Temp Password:</strong> {hireResult.tempPassword}</div>
+                </div>
+                <button onClick={() => { setHireModal(null); setHireResult(null); }}
+                  style={{ padding: '0.6rem 2rem', background: '#059669', color: '#fff', border: 'none', borderRadius: '8px', cursor: 'pointer', fontSize: '1rem', fontWeight: '600' }}>
+                  Done
+                </button>
+              </div>
+            )}
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ApplicationsDashboard;
diff --git a/templates/crm-homecare/frontend/src/components/admin/AuditLogs.jsx b/templates/crm-homecare/frontend/src/components/admin/AuditLogs.jsx
new file mode 100644
index 0000000..4b5c164
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/AuditLogs.jsx
@@ -0,0 +1,512 @@
+import { toast } from '../Toast';
+// src/components/admin/AuditLogs.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const AuditLogs = ({ token }) => {
+  const [logs, setLogs] = useState([]);
+  const [filteredLogs, setFilteredLogs] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [selectedLog, setSelectedLog] = useState(null);
+  const [filters, setFilters] = useState({
+    startDate: new Date(new Date().setDate(new Date().getDate() - 30)).toISOString().split('T')[0],
+    endDate: new Date().toISOString().split('T')[0],
+    userId: '',
+    action: '',
+    entityType: '',
+    searchTerm: ''
+  });
+  const [users, setUsers] = useState([]);
+  const [stats, setStats] = useState({
+    totalEvents: 0,
+    uniqueUsers: 0,
+    dataChanges: 0,
+    accessEvents: 0,
+    suspiciousActivity: 0
+  });
+
+  useEffect(() => {
+    loadLogs();
+    loadUsers();
+  }, []);
+
+  useEffect(() => {
+    applyFilters();
+  }, [logs, filters]);
+
+  const loadLogs = async () => {
+    setLoading(true);
+    try {
+      const response = await fetch(
+        `${API_BASE_URL}/api/audit-logs?startDate=${filters.startDate}&endDate=${filters.endDate}`,
+        {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }
+      );
+      const data = await response.json();
+      setLogs(data.logs || []);
+      
+      // Calculate stats
+      const uniqueUsers = new Set(data.logs.map(log => log.user_id)).size;
+      const dataChanges = data.logs.filter(log => log.action === 'update' || log.action === 'create' || log.action === 'delete').length;
+      const accessEvents = data.logs.filter(log => log.action === 'login' || log.action === 'access').length;
+      const suspiciousActivity = data.logs.filter(log => log.flags && log.flags.length > 0).length;
+
+      setStats({
+        totalEvents: data.logs.length,
+        uniqueUsers,
+        dataChanges,
+        accessEvents,
+        suspiciousActivity
+      });
+    } catch (error) {
+      console.error('Failed to load audit logs:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadUsers = async () => {
+    try {
+      const [adminsRes, caregiversRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/users/admins`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+      const admins = await adminsRes.json();
+      const caregivers = await caregiversRes.json();
+      setUsers([...admins, ...caregivers]);
+    } catch (error) {
+      console.error('Failed to load users:', error);
+    }
+  };
+
+  const applyFilters = () => {
+    let filtered = logs;
+
+    if (filters.userId) {
+      filtered = filtered.filter(log => log.user_id === filters.userId);
+    }
+
+    if (filters.action) {
+      filtered = filtered.filter(log => log.action === filters.action);
+    }
+
+    if (filters.entityType) {
+      filtered = filtered.filter(log => log.entity_type === filters.entityType);
+    }
+
+    if (filters.searchTerm) {
+      const term = filters.searchTerm.toLowerCase();
+      filtered = filtered.filter(log =>
+        log.user_name.toLowerCase().includes(term) ||
+        log.entity_id.includes(term) ||
+        (log.change_description && log.change_description.toLowerCase().includes(term))
+      );
+    }
+
+    // Sort by timestamp descending
+    filtered.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
+    setFilteredLogs(filtered);
+  };
+
+  const getActionBadge = (action) => {
+    switch (action) {
+      case 'create':
+        return { class: 'badge-success', label: 'Created' };
+      case 'update':
+        return { class: 'badge-info', label: 'Updated' };
+      case 'delete':
+        return { class: 'badge-danger', label: 'Deleted' };
+      case 'login':
+        return { class: 'badge-primary', label: 'Login' };
+      case 'access':
+        return { class: 'badge-secondary', label: 'Access' };
+      case 'export':
+        return { class: 'badge-warning', label: 'Export' };
+      case 'failed_login':
+        return { class: 'badge-danger', label: 'Failed Login' };
+      default:
+        return { class: 'badge-secondary', label: action };
+    }
+  };
+
+  const getEntityIcon = (entityType) => {
+    switch (entityType) {
+      case 'client':
+        return '👥';
+      case 'caregiver':
+        return '👨‍⚕️';
+      case 'schedule':
+        return '📅';
+      case 'invoice':
+        return '💰';
+      case 'care_plan':
+        return '📋';
+      case 'incident':
+        return '⚠️';
+      case 'user':
+        return '👤';
+      default:
+        return '📄';
+    }
+  };
+
+  const exportLogs = async (format) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/audit-logs/export`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          logs: filteredLogs.map(log => ({
+            timestamp: log.timestamp,
+            user: log.user_name,
+            action: log.action,
+            entity: `${log.entity_type}:${log.entity_id}`,
+            changes: log.changes,
+            ipAddress: log.ip_address,
+            userAgent: log.user_agent
+          })),
+          format
+        })
+      });
+
+      if (!response.ok) throw new Error('Export failed');
+
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `audit-logs-${new Date().toISOString().split('T')[0]}.${format}`;
+      a.click();
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const downloadComplianceReport = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/audit-logs/compliance-report`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          startDate: filters.startDate,
+          endDate: filters.endDate
+        })
+      });
+
+      if (!response.ok) throw new Error('Report generation failed');
+
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `hipaa-compliance-report-${new Date().toISOString().split('T')[0]}.pdf`;
+      a.click();
+    } catch (error) {
+      toast('Failed to generate report: ' + error.message, 'error');
+    }
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🔐 Audit Logs (HIPAA Compliance)</h2>
+        <div className="button-group">
+          <button className="btn btn-secondary" onClick={() => exportLogs('csv')}>
+            📥 Export CSV
+          </button>
+          <button className="btn btn-secondary" onClick={() => exportLogs('pdf')}>
+            📄 Export PDF
+          </button>
+          <button className="btn btn-primary" onClick={downloadComplianceReport}>
+            ✓ Compliance Report
+          </button>
+        </div>
+      </div>
+
+      {/* Compliance Stats */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))' }}>
+        <div className="stat-card">
+          <h3>Total Events</h3>
+          <div className="value">{stats.totalEvents}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Unique Users</h3>
+          <div className="value">{stats.uniqueUsers}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Data Changes</h3>
+          <div className="value value-info">{stats.dataChanges}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Access Events</h3>
+          <div className="value value-primary">{stats.accessEvents}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Suspicious Activity</h3>
+          <div className="value value-danger">{stats.suspiciousActivity}</div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card">
+        <h3>Filter Logs</h3>
+        <div className="filter-controls" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>
+          <div className="form-group">
+            <label>Start Date</label>
+            <input
+              type="date"
+              value={filters.startDate}
+              onChange={(e) => setFilters({ ...filters, startDate: e.target.value })}
+            />
+          </div>
+
+          <div className="form-group">
+            <label>End Date</label>
+            <input
+              type="date"
+              value={filters.endDate}
+              onChange={(e) => setFilters({ ...filters, endDate: e.target.value })}
+            />
+          </div>
+
+          <div className="form-group">
+            <label>User</label>
+            <select
+              value={filters.userId}
+              onChange={(e) => setFilters({ ...filters, userId: e.target.value })}
+            >
+              <option value="">All Users</option>
+              {users.map(user => (
+                <option key={user.id} value={user.id}>
+                  {user.first_name} {user.last_name} ({user.role})
+                </option>
+              ))}
+            </select>
+          </div>
+
+          <div className="form-group">
+            <label>Action</label>
+            <select
+              value={filters.action}
+              onChange={(e) => setFilters({ ...filters, action: e.target.value })}
+            >
+              <option value="">All Actions</option>
+              <option value="create">Create</option>
+              <option value="update">Update</option>
+              <option value="delete">Delete</option>
+              <option value="login">Login</option>
+              <option value="access">Access</option>
+              <option value="export">Export</option>
+              <option value="failed_login">Failed Login</option>
+            </select>
+          </div>
+
+          <div className="form-group">
+            <label>Entity Type</label>
+            <select
+              value={filters.entityType}
+              onChange={(e) => setFilters({ ...filters, entityType: e.target.value })}
+            >
+              <option value="">All Types</option>
+              <option value="client">Client</option>
+              <option value="caregiver">Caregiver</option>
+              <option value="schedule">Schedule</option>
+              <option value="invoice">Invoice</option>
+              <option value="care_plan">Care Plan</option>
+              <option value="incident">Incident</option>
+              <option value="user">User</option>
+            </select>
+          </div>
+
+          <div className="form-group">
+            <label>Search</label>
+            <input
+              type="text"
+              placeholder="Search by name, ID, or description..."
+              value={filters.searchTerm}
+              onChange={(e) => setFilters({ ...filters, searchTerm: e.target.value })}
+            />
+          </div>
+        </div>
+      </div>
+
+      {/* Logs Table */}
+      {loading ? (
+        <div className="loading">
+          <div className="spinner"></div>
+        </div>
+      ) : filteredLogs.length === 0 ? (
+        <div className="card card-centered">
+          <p>No audit logs found for the selected filters.</p>
+        </div>
+      ) : (
+        <div>
+          <div style={{ marginBottom: '1rem', fontSize: '0.9rem', color: '#666' }}>
+            Showing {filteredLogs.length} of {logs.length} events
+          </div>
+          
+          <div style={{ display: 'grid', gap: '1rem' }}>
+            {filteredLogs.map(log => {
+              const actionBadge = getActionBadge(log.action);
+              const hasSuspiciousFlags = log.flags && log.flags.length > 0;
+
+              return (
+                <div
+                  key={log.id}
+                  className="card"
+                  style={{
+                    borderLeft: `4px solid ${hasSuspiciousFlags ? '#f44336' : '#ddd'}`,
+                    cursor: 'pointer',
+                    opacity: hasSuspiciousFlags ? 1 : 0.9
+                  }}
+                  onClick={() => setSelectedLog(selectedLog?.id === log.id ? null : log)}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                    <div style={{ flex: 1 }}>
+                      <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', marginBottom: '0.5rem' }}>
+                        <span style={{ fontSize: '1.2rem' }}>
+                          {getEntityIcon(log.entity_type)}
+                        </span>
+                        <div>
+                          <strong>{log.user_name}</strong>
+                          <span className={`badge ${actionBadge.class}`} style={{ marginLeft: '0.5rem' }}>
+                            {actionBadge.label}
+                          </span>
+                          {hasSuspiciousFlags && (
+                            <span className="badge badge-danger" style={{ marginLeft: '0.5rem' }}>
+                              ⚠️ Flagged
+                            </span>
+                          )}
+                        </div>
+                      </div>
+
+                      <div style={{ fontSize: '0.9rem', color: '#666' }}>
+                        <p style={{ margin: '0.25rem 0' }}>
+                          <strong>{log.entity_type.replace('_', ' ').toUpperCase()}</strong>
+                          {' '} (ID: {log.entity_id})
+                        </p>
+                        <p style={{ margin: '0.25rem 0' }}>
+                          {new Date(log.timestamp).toLocaleString()}
+                        </p>
+                        {log.ip_address && (
+                          <p style={{ margin: '0.25rem 0' }}>
+                            From: {log.ip_address}
+                          </p>
+                        )}
+                      </div>
+
+                      {log.change_description && (
+                        <div style={{ marginTop: '0.5rem', padding: '0.75rem', background: '#f5f5f5', borderRadius: '4px', fontSize: '0.85rem', maxHeight: selectedLog?.id === log.id ? 'none' : '2rem', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                          {log.change_description}
+                        </div>
+                      )}
+                    </div>
+
+                    <span style={{ fontSize: '1.2rem', color: '#999' }}>
+                      {selectedLog?.id === log.id ? '▼' : '▶'}
+                    </span>
+                  </div>
+
+                  {/* Expanded Details */}
+                  {selectedLog?.id === log.id && (
+                    <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #ddd' }}>
+                      <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+                        <div>
+                          <h4>Details</h4>
+                          <p><strong>User ID:</strong> {log.user_id}</p>
+                          <p><strong>Entity Type:</strong> {log.entity_type}</p>
+                          <p><strong>Entity ID:</strong> {log.entity_id}</p>
+                          <p><strong>Action:</strong> {log.action}</p>
+                          <p><strong>Timestamp:</strong> {new Date(log.timestamp).toLocaleString()}</p>
+                        </div>
+
+                        <div>
+                          <h4>Network Info</h4>
+                          <p><strong>IP Address:</strong> {log.ip_address || 'N/A'}</p>
+                          <p><strong>User Agent:</strong></p>
+                          <p style={{ fontSize: '0.8rem', wordBreak: 'break-word', color: '#666' }}>
+                            {log.user_agent || 'N/A'}
+                          </p>
+                        </div>
+                      </div>
+
+                      {log.changes && Object.keys(log.changes).length > 0 && (
+                        <div style={{ marginTop: '1rem' }}>
+                          <h4>Changes</h4>
+                          <table style={{ width: '100%', fontSize: '0.85rem', borderCollapse: 'collapse' }}>
+                            <thead>
+                              <tr style={{ borderBottom: '1px solid #ddd' }}>
+                                <th style={{ textAlign: 'left', padding: '0.5rem' }}>Field</th>
+                                <th style={{ textAlign: 'left', padding: '0.5rem' }}>Old Value</th>
+                                <th style={{ textAlign: 'left', padding: '0.5rem' }}>New Value</th>
+                              </tr>
+                            </thead>
+                            <tbody>
+                              {Object.entries(log.changes).map(([field, change]) => (
+                                <tr key={field} style={{ borderBottom: '1px solid #eee' }}>
+                                  <td style={{ padding: '0.5rem', fontWeight: 'bold' }}>{field}</td>
+                                  <td style={{ padding: '0.5rem', color: '#f44336' }}>
+                                    {typeof change.old_value === 'boolean' ? (change.old_value ? 'Yes' : 'No') : change.old_value || '(empty)'}
+                                  </td>
+                                  <td style={{ padding: '0.5rem', color: '#4caf50' }}>
+                                    {typeof change.new_value === 'boolean' ? (change.new_value ? 'Yes' : 'No') : change.new_value || '(empty)'}
+                                  </td>
+                                </tr>
+                              ))}
+                            </tbody>
+                          </table>
+                        </div>
+                      )}
+
+                      {hasSuspiciousFlags && (
+                        <div style={{ marginTop: '1rem', padding: '1rem', background: '#fff3e0', borderRadius: '4px', borderLeft: '4px solid #f57c00' }}>
+                          <h4 style={{ margin: '0 0 0.5rem 0', color: '#e65100' }}>⚠️ Suspicious Activity Flags</h4>
+                          <ul style={{ margin: 0, paddingLeft: '1.5rem' }}>
+                            {log.flags.map((flag, idx) => (
+                              <li key={idx} style={{ color: '#666' }}>{flag}</li>
+                            ))}
+                          </ul>
+                        </div>
+                      )}
+                    </div>
+                  )}
+                </div>
+              );
+            })}
+          </div>
+        </div>
+      )}
+
+      {/* Detailed Log Modal */}
+      {selectedLog && (
+        <div className="modal active" style={{ display: 'none' }}>
+          <div className="modal-content modal-large">
+            <div className="modal-header">
+              <h2>Audit Log Details</h2>
+              <button className="close-btn" onClick={() => setSelectedLog(null)}>×</button>
+            </div>
+            {/* Details shown inline above */}
+            <div className="modal-actions">
+              <button className="btn btn-secondary" onClick={() => setSelectedLog(null)}>
+                Close
+              </button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default AuditLogs;
diff --git a/templates/crm-homecare/frontend/src/components/admin/AutoFillButton.jsx b/templates/crm-homecare/frontend/src/components/admin/AutoFillButton.jsx
new file mode 100644
index 0000000..d18dbf6
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/AutoFillButton.jsx
@@ -0,0 +1,431 @@
+import React, { useState, useCallback } from 'react';
+import PropTypes from 'prop-types';
+
+const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';
+
+/**
+ * AutoFillButton - Automatically assigns best-fit caregivers to open shifts
+ * 
+ * @param {string} weekOf - ISO date string for the week start (YYYY-MM-DD)
+ * @param {string} token - JWT auth token
+ * @param {function} onComplete - Callback fired after successful fill
+ */
+const AutoFillButton = ({ weekOf, token, onComplete }) => {
+  const [loading, setLoading] = useState(false);
+  const [results, setResults] = useState(null);
+  const [showModal, setShowModal] = useState(false);
+  const [error, setError] = useState(null);
+
+  const getWeekEnd = useCallback((startDate) => {
+    const d = new Date(startDate);
+    d.setDate(d.getDate() + 6);
+    return d.toISOString().split('T')[0];
+  }, []);
+
+  const handleAutoFill = useCallback(async (dryRun = true) => {
+    setLoading(true);
+    setError(null);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/scheduling/auto-fill`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          startDate: weekOf,
+          endDate: getWeekEnd(weekOf),
+          dryRun
+        })
+      });
+
+      if (!response.ok) {
+        throw new Error(`Request failed: ${response.status}`);
+      }
+
+      const data = await response.json();
+      setResults(data);
+
+      if (!dryRun && data.filled > 0 && onComplete) {
+        onComplete();
+      }
+    } catch (err) {
+      console.error('Auto-fill error:', err);
+      setError(err.message || 'Failed to auto-fill shifts');
+    } finally {
+      setLoading(false);
+    }
+  }, [weekOf, token, getWeekEnd, onComplete]);
+
+  const openModal = useCallback(() => {
+    setResults(null);
+    setError(null);
+    setShowModal(true);
+    handleAutoFill(true);
+  }, [handleAutoFill]);
+
+  const closeModal = useCallback(() => {
+    setShowModal(false);
+    setResults(null);
+    setError(null);
+  }, []);
+
+  const confirmFill = useCallback(() => {
+    handleAutoFill(false);
+  }, [handleAutoFill]);
+
+  return (
+    <>
+      <button
+        type="button"
+        onClick={openModal}
+        disabled={loading}
+        className="btn btn-primary"
+        style={{ marginLeft: '1rem' }}
+      >
+        {loading ? '⏳ Working...' : '🪄 Auto-Fill'}
+      </button>
+
+      {showModal && (
+        <div
+          role="dialog"
+          aria-modal="true"
+          aria-labelledby="autofill-title"
+          onClick={closeModal}
+          style={styles.overlay}
+        >
+          <div onClick={(e) => e.stopPropagation()} style={styles.modal}>
+            {/* Header */}
+            <div style={styles.header}>
+              <h2 id="autofill-title" style={styles.title}>
+                🪄 Auto-Fill Open Shifts
+              </h2>
+              <button
+                type="button"
+                onClick={closeModal}
+                aria-label="Close"
+                style={styles.closeBtn}
+              >
+                ×
+              </button>
+            </div>
+
+            {/* Body */}
+            <div style={styles.body}>
+              {error && (
+                <div style={styles.error}>
+                  ❌ {error}
+                </div>
+              )}
+
+              {loading && !results && (
+                <div style={styles.loading}>
+                  ⏳ Finding best matches...
+                </div>
+              )}
+
+              {results && (
+                <>
+                  {/* Summary */}
+                  <div style={styles.summaryGrid}>
+                    <SummaryBox
+                      value={results.total}
+                      label="Open Shifts"
+                      color="#0369a1"
+                      bg="#f0f9ff"
+                    />
+                    <SummaryBox
+                      value={results.filled}
+                      label="Can Fill"
+                      color="#15803d"
+                      bg="#f0fdf4"
+                    />
+                    <SummaryBox
+                      value={results.failed}
+                      label="No Match"
+                      color={results.failed > 0 ? '#dc2626' : '#6b7280'}
+                      bg={results.failed > 0 ? '#fef2f2' : '#f9fafb'}
+                    />
+                  </div>
+
+                  {/* Preview notice */}
+                  {results.dryRun && results.filled > 0 && (
+                    <div style={styles.notice}>
+                      ⚠️ <strong>Preview</strong> — Review assignments below, then confirm.
+                    </div>
+                  )}
+
+                  {/* Success notice */}
+                  {!results.dryRun && results.filled > 0 && (
+                    <div style={styles.success}>
+                      ✅ Successfully filled {results.filled} shift{results.filled !== 1 ? 's' : ''}!
+                    </div>
+                  )}
+
+                  {/* Results list */}
+                  <div style={styles.resultsList}>
+                    {results.results?.map((r, i) => (
+                      <ResultRow key={r.shiftId || i} result={r} />
+                    ))}
+                    {results.total === 0 && (
+                      <div style={styles.empty}>
+                        No open shifts for this week.
+                      </div>
+                    )}
+                  </div>
+                </>
+              )}
+            </div>
+
+            {/* Footer */}
+            <div style={styles.footer}>
+              <button
+                type="button"
+                onClick={closeModal}
+                style={styles.cancelBtn}
+              >
+                {results && !results.dryRun ? 'Close' : 'Cancel'}
+              </button>
+
+              {results?.dryRun && results?.filled > 0 && (
+                <button
+                  type="button"
+                  onClick={confirmFill}
+                  disabled={loading}
+                  style={styles.confirmBtn}
+                >
+                  {loading ? '⏳ Filling...' : `✓ Fill ${results.filled} Shifts`}
+                </button>
+              )}
+            </div>
+          </div>
+        </div>
+      )}
+    </>
+  );
+};
+
+// Sub-components
+const SummaryBox = ({ value, label, color, bg }) => (
+  <div style={{ ...styles.summaryBox, background: bg }}>
+    <div style={{ ...styles.summaryValue, color }}>{value}</div>
+    <div style={styles.summaryLabel}>{label}</div>
+  </div>
+);
+
+const ResultRow = ({ result }) => {
+  const isFilled = result.status === 'filled';
+
+  return (
+    <div style={{
+      ...styles.resultRow,
+      background: isFilled ? '#f0fdf4' : '#fef2f2',
+      borderLeftColor: isFilled ? '#22c55e' : '#ef4444'
+    }}>
+      <div>
+        <strong>{result.client}</strong>
+        <div style={styles.resultMeta}>
+          {result.date} • {result.time}
+        </div>
+      </div>
+      <div style={styles.resultRight}>
+        {isFilled ? (
+          <>
+            <div style={styles.resultSuccess}>✓ {result.assignedTo}</div>
+            <div style={styles.resultDetail}>
+              {result.distance} • {result.familiarity}
+            </div>
+          </>
+        ) : (
+          <div style={styles.resultFail}>✗ No match</div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+// Styles
+const styles = {
+  overlay: {
+    position: 'fixed',
+    top: 0,
+    left: 0,
+    right: 0,
+    bottom: 0,
+    background: 'rgba(0, 0, 0, 0.5)',
+    display: 'flex',
+    alignItems: 'center',
+    justifyContent: 'center',
+    zIndex: 1000
+  },
+  modal: {
+    background: 'white',
+    borderRadius: '12px',
+    width: '90%',
+    maxWidth: '550px',
+    maxHeight: '80vh',
+    overflow: 'hidden',
+    boxShadow: '0 4px 20px rgba(0, 0, 0, 0.15)'
+  },
+  header: {
+    padding: '1rem 1.5rem',
+    borderBottom: '1px solid #e5e7eb',
+    display: 'flex',
+    justifyContent: 'space-between',
+    alignItems: 'center'
+  },
+  title: {
+    margin: 0,
+    fontSize: '1.25rem'
+  },
+  closeBtn: {
+    background: 'none',
+    border: 'none',
+    fontSize: '1.5rem',
+    cursor: 'pointer',
+    color: '#6b7280',
+    padding: '0.25rem'
+  },
+  body: {
+    padding: '1.5rem',
+    overflowY: 'auto',
+    maxHeight: '55vh'
+  },
+  loading: {
+    textAlign: 'center',
+    padding: '2rem',
+    color: '#6b7280'
+  },
+  error: {
+    background: '#fef2f2',
+    color: '#dc2626',
+    padding: '0.75rem 1rem',
+    borderRadius: '6px',
+    marginBottom: '1rem'
+  },
+  notice: {
+    background: '#fef3c7',
+    padding: '0.75rem 1rem',
+    borderRadius: '6px',
+    marginBottom: '1rem',
+    fontSize: '0.9rem'
+  },
+  success: {
+    background: '#f0fdf4',
+    color: '#15803d',
+    padding: '0.75rem 1rem',
+    borderRadius: '6px',
+    marginBottom: '1rem',
+    fontSize: '0.9rem'
+  },
+  summaryGrid: {
+    display: 'grid',
+    gridTemplateColumns: 'repeat(3, 1fr)',
+    gap: '1rem',
+    marginBottom: '1.5rem'
+  },
+  summaryBox: {
+    padding: '1rem',
+    borderRadius: '8px',
+    textAlign: 'center'
+  },
+  summaryValue: {
+    fontSize: '1.75rem',
+    fontWeight: 'bold'
+  },
+  summaryLabel: {
+    fontSize: '0.8rem',
+    color: '#6b7280'
+  },
+  resultsList: {
+    maxHeight: '220px',
+    overflowY: 'auto'
+  },
+  resultRow: {
+    padding: '0.75rem',
+    marginBottom: '0.5rem',
+    borderLeft: '4px solid',
+    borderRadius: '4px',
+    display: 'flex',
+    justifyContent: 'space-between',
+    alignItems: 'flex-start'
+  },
+  resultMeta: {
+    fontSize: '0.85rem',
+    color: '#6b7280'
+  },
+  resultRight: {
+    textAlign: 'right'
+  },
+  resultSuccess: {
+    color: '#15803d',
+    fontWeight: 500
+  },
+  resultFail: {
+    color: '#dc2626',
+    fontWeight: 500
+  },
+  resultDetail: {
+    fontSize: '0.75rem',
+    color: '#6b7280'
+  },
+  empty: {
+    textAlign: 'center',
+    padding: '2rem',
+    color: '#6b7280'
+  },
+  footer: {
+    padding: '1rem 1.5rem',
+    borderTop: '1px solid #e5e7eb',
+    display: 'flex',
+    justifyContent: 'flex-end',
+    gap: '0.75rem'
+  },
+  cancelBtn: {
+    padding: '0.5rem 1rem',
+    background: '#f3f4f6',
+    border: 'none',
+    borderRadius: '6px',
+    cursor: 'pointer',
+    fontSize: '0.9rem'
+  },
+  confirmBtn: {
+    padding: '0.5rem 1rem',
+    background: '#2563eb',
+    color: 'white',
+    border: 'none',
+    borderRadius: '6px',
+    cursor: 'pointer',
+    fontSize: '0.9rem'
+  }
+};
+
+// PropTypes
+AutoFillButton.propTypes = {
+  weekOf: PropTypes.string.isRequired,
+  token: PropTypes.string.isRequired,
+  onComplete: PropTypes.func
+};
+
+SummaryBox.propTypes = {
+  value: PropTypes.number.isRequired,
+  label: PropTypes.string.isRequired,
+  color: PropTypes.string.isRequired,
+  bg: PropTypes.string.isRequired
+};
+
+ResultRow.propTypes = {
+  result: PropTypes.shape({
+    shiftId: PropTypes.string,
+    client: PropTypes.string,
+    date: PropTypes.string,
+    time: PropTypes.string,
+    status: PropTypes.string,
+    assignedTo: PropTypes.string,
+    distance: PropTypes.string,
+    familiarity: PropTypes.string
+  }).isRequired
+};
+
+export default AutoFillButton;
diff --git a/templates/crm-homecare/frontend/src/components/admin/BackgroundChecks.jsx b/templates/crm-homecare/frontend/src/components/admin/BackgroundChecks.jsx
new file mode 100644
index 0000000..c318525
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/BackgroundChecks.jsx
@@ -0,0 +1,544 @@
+import { toast } from '../Toast';
+// src/components/admin/BackgroundChecks.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const BackgroundChecks = ({ token }) => {
+  const [checks, setChecks] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ status: '', type: '' });
+  const [showAddModal, setShowAddModal] = useState(false);
+  const [showDetailModal, setShowDetailModal] = useState(false);
+  const [currentCheck, setCurrentCheck] = useState(null);
+  const [caregivers, setCaregivers] = useState([]);
+
+  const checkTypes = [
+    { id: 'criminal', name: 'Criminal Background', icon: '🔍' },
+    { id: 'sex_offender', name: 'Sex Offender Registry', icon: '⚠️' },
+    { id: 'caregiver_registry', name: 'Caregiver Registry (WI)', icon: '📋' },
+    { id: 'oci', name: 'OCI Misconduct', icon: '🏛️' },
+    { id: 'driving', name: 'Driving Record', icon: '🚗' },
+    { id: 'drug_screen', name: 'Drug Screen', icon: '🧪' },
+    { id: 'reference', name: 'Reference Check', icon: '📞' },
+    { id: 'employment_verification', name: 'Employment Verification', icon: '💼' },
+    { id: 'education_verification', name: 'Education Verification', icon: '🎓' },
+    { id: 'professional_license', name: 'Professional License', icon: '📜' }
+  ];
+
+  useEffect(() => {
+    loadChecks();
+    loadCaregivers();
+  }, [filter]);
+
+  const loadChecks = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.status) params.append('status', filter.status);
+      if (filter.type) params.append('type', filter.type);
+      
+      const res = await fetch(`${API_BASE_URL}/api/background-checks?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setChecks(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load checks:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadCaregivers = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setCaregivers(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+    }
+  };
+
+  const createCheck = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/background-checks`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowAddModal(false);
+        loadChecks();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const updateCheck = async (checkId, updateData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/background-checks/${checkId}`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(updateData)
+      });
+      if (res.ok) {
+        setShowDetailModal(false);
+        setCurrentCheck(null);
+        loadChecks();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      pending: '#ff9800',
+      in_progress: '#2196f3',
+      completed: '#4caf50',
+      failed: '#f44336',
+      expired: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '3px 8px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.replace(/_/g, ' ').toUpperCase()}
+      </span>
+    );
+  };
+
+  const getResultBadge = (result) => {
+    if (!result) return null;
+    const colors = {
+      clear: '#4caf50',
+      flagged: '#ff9800',
+      disqualifying: '#f44336'
+    };
+    return (
+      <span style={{
+        padding: '3px 8px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[result] || '#9e9e9e'
+      }}>
+        {result?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const getTypeIcon = (typeId) => {
+    const type = checkTypes.find(t => t.id === typeId);
+    return type?.icon || '📋';
+  };
+
+  const getTypeName = (typeId) => {
+    const type = checkTypes.find(t => t.id === typeId);
+    return type?.name || typeId;
+  };
+
+  const isExpiringSoon = (expirationDate) => {
+    if (!expirationDate) return false;
+    const expDate = new Date(expirationDate);
+    const thirtyDaysFromNow = new Date();
+    thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
+    return expDate <= thirtyDaysFromNow && expDate > new Date();
+  };
+
+  const isExpired = (expirationDate) => {
+    if (!expirationDate) return false;
+    return new Date(expirationDate) < new Date();
+  };
+
+  const pendingCount = checks.filter(c => c.status === 'pending').length;
+  const expiringSoonCount = checks.filter(c => isExpiringSoon(c.expiration_date)).length;
+  const expiredCount = checks.filter(c => isExpired(c.expiration_date)).length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🔒 Background Checks</h2>
+        <button className="btn btn-primary" onClick={() => setShowAddModal(true)}>
+          + New Background Check
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, status: 'pending' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Pending</h4>
+          <div className="value" style={{ color: '#ff9800' }}>{pendingCount}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, status: '' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Expiring Soon</h4>
+          <div className="value" style={{ color: '#ff9800' }}>{expiringSoonCount}</div>
+          <small>Within 30 days</small>
+        </div>
+        <div 
+          className="stat-card" 
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Expired</h4>
+          <div className="value" style={{ color: '#f44336' }}>{expiredCount}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ status: '', type: '' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Total</h4>
+          <div className="value">{checks.length}</div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Status</label>
+            <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+              <option value="">All Statuses</option>
+              <option value="pending">Pending</option>
+              <option value="in_progress">In Progress</option>
+              <option value="completed">Completed</option>
+              <option value="failed">Failed</option>
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Check Type</label>
+            <select value={filter.type} onChange={(e) => setFilter({ ...filter, type: e.target.value })}>
+              <option value="">All Types</option>
+              {checkTypes.map(t => (
+                <option key={t.id} value={t.id}>{t.name}</option>
+              ))}
+            </select>
+          </div>
+        </div>
+      </div>
+
+      {/* Checks Table */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : checks.length === 0 ? (
+          <p>No background checks found.</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th style={{ width: '40px' }}></th>
+                <th>Caregiver</th>
+                <th>Check Type</th>
+                <th>Status</th>
+                <th>Result</th>
+                <th>Initiated</th>
+                <th>Completed</th>
+                <th>Expires</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {checks.map(check => (
+                <tr key={check.id} style={{ 
+                  backgroundColor: isExpired(check.expiration_date) ? '#ffebee' : 
+                                   isExpiringSoon(check.expiration_date) ? '#fff3e0' : 'transparent'
+                }}>
+                  <td style={{ fontSize: '1.3rem' }}>{getTypeIcon(check.check_type)}</td>
+                  <td><strong>{check.caregiver_first} {check.caregiver_last}</strong></td>
+                  <td>{getTypeName(check.check_type)}</td>
+                  <td>{getStatusBadge(check.status)}</td>
+                  <td>{getResultBadge(check.result)}</td>
+                  <td style={{ fontSize: '0.85rem' }}>
+                    {check.initiated_date ? new Date(check.initiated_date).toLocaleDateString() : '-'}
+                  </td>
+                  <td style={{ fontSize: '0.85rem' }}>
+                    {check.completed_date ? new Date(check.completed_date).toLocaleDateString() : '-'}
+                  </td>
+                  <td>
+                    {check.expiration_date ? (
+                      <span style={{ 
+                        color: isExpired(check.expiration_date) ? '#f44336' : 
+                               isExpiringSoon(check.expiration_date) ? '#ff9800' : '#333',
+                        fontWeight: isExpired(check.expiration_date) || isExpiringSoon(check.expiration_date) ? 'bold' : 'normal'
+                      }}>
+                        {new Date(check.expiration_date).toLocaleDateString()}
+                        {isExpired(check.expiration_date) && ' ⚠️'}
+                      </span>
+                    ) : '-'}
+                  </td>
+                  <td>
+                    <button 
+                      className="btn btn-sm btn-secondary"
+                      onClick={() => { setCurrentCheck(check); setShowDetailModal(true); }}
+                    >
+                      Update
+                    </button>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Add Check Modal */}
+      {showAddModal && (
+        <div className="modal-overlay" onClick={() => setShowAddModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>New Background Check</h3>
+              <button className="modal-close" onClick={() => setShowAddModal(false)}>×</button>
+            </div>
+            <AddCheckForm 
+              caregivers={caregivers}
+              checkTypes={checkTypes}
+              onSubmit={createCheck}
+              onCancel={() => setShowAddModal(false)}
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Update Check Modal */}
+      {showDetailModal && currentCheck && (
+        <div className="modal-overlay" onClick={() => setShowDetailModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Update Background Check</h3>
+              <button className="modal-close" onClick={() => setShowDetailModal(false)}>×</button>
+            </div>
+            <UpdateCheckForm 
+              check={currentCheck}
+              onSubmit={(data) => updateCheck(currentCheck.id, data)}
+              onCancel={() => setShowDetailModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Add Check Form Component
+const AddCheckForm = ({ caregivers, checkTypes, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    caregiverId: '',
+    checkType: '',
+    provider: '',
+    cost: '',
+    notes: ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.caregiverId || !formData.checkType) {
+      toast('Please select caregiver and check type');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Caregiver *</label>
+        <select 
+          value={formData.caregiverId}
+          onChange={(e) => setFormData({ ...formData, caregiverId: e.target.value })}
+          required
+        >
+          <option value="">Select Caregiver</option>
+          {caregivers.map(c => (
+            <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Check Type *</label>
+        <select 
+          value={formData.checkType}
+          onChange={(e) => setFormData({ ...formData, checkType: e.target.value })}
+          required
+        >
+          <option value="">Select Type</option>
+          {checkTypes.map(t => (
+            <option key={t.id} value={t.id}>{t.icon} {t.name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Provider</label>
+          <input 
+            type="text"
+            value={formData.provider}
+            onChange={(e) => setFormData({ ...formData, provider: e.target.value })}
+            placeholder="e.g., Checkr, GoodHire"
+          />
+        </div>
+        <div className="form-group">
+          <label>Cost ($)</label>
+          <input 
+            type="number"
+            step="0.01"
+            value={formData.cost}
+            onChange={(e) => setFormData({ ...formData, cost: e.target.value })}
+            placeholder="0.00"
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Any notes..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Create Check</button>
+      </div>
+    </form>
+  );
+};
+
+// Update Check Form Component
+const UpdateCheckForm = ({ check, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    status: check.status || 'pending',
+    result: check.result || '',
+    completedDate: check.completed_date?.split('T')[0] || '',
+    expirationDate: check.expiration_date?.split('T')[0] || '',
+    referenceNumber: check.reference_number || '',
+    findings: check.findings || '',
+    notes: check.notes || ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <p><strong>Caregiver:</strong> {check.caregiver_first} {check.caregiver_last}</p>
+      <p><strong>Check Type:</strong> {check.check_type}</p>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Status</label>
+          <select 
+            value={formData.status}
+            onChange={(e) => setFormData({ ...formData, status: e.target.value })}
+          >
+            <option value="pending">Pending</option>
+            <option value="in_progress">In Progress</option>
+            <option value="completed">Completed</option>
+            <option value="failed">Failed</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Result</label>
+          <select 
+            value={formData.result}
+            onChange={(e) => setFormData({ ...formData, result: e.target.value })}
+          >
+            <option value="">Not Yet</option>
+            <option value="clear">Clear</option>
+            <option value="flagged">Flagged (Review Required)</option>
+            <option value="disqualifying">Disqualifying</option>
+          </select>
+        </div>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Completed Date</label>
+          <input 
+            type="date"
+            value={formData.completedDate}
+            onChange={(e) => setFormData({ ...formData, completedDate: e.target.value })}
+          />
+        </div>
+        <div className="form-group">
+          <label>Expiration Date</label>
+          <input 
+            type="date"
+            value={formData.expirationDate}
+            onChange={(e) => setFormData({ ...formData, expirationDate: e.target.value })}
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Reference Number</label>
+        <input 
+          type="text"
+          value={formData.referenceNumber}
+          onChange={(e) => setFormData({ ...formData, referenceNumber: e.target.value })}
+          placeholder="External reference/case number"
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Findings</label>
+        <textarea 
+          value={formData.findings}
+          onChange={(e) => setFormData({ ...formData, findings: e.target.value })}
+          placeholder="Document any findings..."
+          rows={3}
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Additional notes..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Update Check</button>
+      </div>
+    </form>
+  );
+};
+
+export default BackgroundChecks;
diff --git a/templates/crm-homecare/frontend/src/components/admin/BillingDashboard.jsx b/templates/crm-homecare/frontend/src/components/admin/BillingDashboard.jsx
new file mode 100644
index 0000000..30eb15b
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/BillingDashboard.jsx
@@ -0,0 +1,1639 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/BillingDashboard.jsx
+// Complete billing system: Invoicing, A/R Aging, Authorizations, Claims, Payments
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+// Helper to parse date without timezone shift
+const parseDate = (dateStr) => {
+  if (!dateStr) return null;
+  // If it's just a date (YYYY-MM-DD), parse as local time
+  if (typeof dateStr === 'string' && dateStr.match(/^\d{4}-\d{2}-\d{2}$/)) {
+    const [year, month, day] = dateStr.split('-').map(Number);
+    return new Date(year, month - 1, day);
+  }
+  // If it includes time, also handle it as local
+  if (typeof dateStr === 'string' && dateStr.includes('T')) {
+    const [datePart] = dateStr.split('T');
+    const [year, month, day] = datePart.split('-').map(Number);
+    return new Date(year, month - 1, day);
+  }
+  return new Date(dateStr);
+};
+
+// Format date for display
+const formatDate = (dateStr, options = {}) => {
+  const date = parseDate(dateStr);
+  if (!date || isNaN(date)) return '';
+  return date.toLocaleDateString('en-US', options);
+};
+
+// Generate time options in 15-minute increments
+const generateTimeOptions = () => {
+  const options = [];
+  for (let hour = 0; hour < 24; hour++) {
+    for (let min = 0; min < 60; min += 15) {
+      const h = hour.toString().padStart(2, '0');
+      const m = min.toString().padStart(2, '0');
+      const value = `${h}:${m}`;
+      const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
+      const ampm = hour < 12 ? 'AM' : 'PM';
+      const label = `${displayHour}:${m.padStart(2, '0')} ${ampm}`;
+      options.push({ value, label });
+    }
+  }
+  return options;
+};
+
+const TIME_OPTIONS = generateTimeOptions();
+
+const BillingDashboard = ({ token }) => {
+  const [activeTab, setActiveTab] = useState('invoices');
+  const [invoices, setInvoices] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [referralSources, setReferralSources] = useState([]);
+  const [careTypes, setCareTypes] = useState([]);
+  const [rates, setRates] = useState([]);
+  const [authorizations, setAuthorizations] = useState([]);
+  const [payments, setPayments] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showGenerateForm, setShowGenerateForm] = useState(false);
+  const [showManualForm, setShowManualForm] = useState(false);
+  const [showBatchForm, setShowBatchForm] = useState(false);
+  const [showInvoiceModal, setShowInvoiceModal] = useState(false);
+  const [showPaymentModal, setShowPaymentModal] = useState(false);
+  const [showAuthModal, setShowAuthModal] = useState(false);
+  const [showAdjustmentModal, setShowAdjustmentModal] = useState(false);
+  const [selectedInvoice, setSelectedInvoice] = useState(null);
+  const [showRateForm, setShowRateForm] = useState(false);
+  const [message, setMessage] = useState('');
+  
+  const [formData, setFormData] = useState({
+    clientId: '',
+    billingPeriodStart: '',
+    billingPeriodEnd: '',
+    notes: ''
+  });
+
+  const [batchFormData, setBatchFormData] = useState({
+    billingPeriodStart: '',
+    billingPeriodEnd: '',
+    clientFilter: 'all',
+    referralSourceId: ''
+  });
+
+  const [rateFormData, setRateFormData] = useState({
+    referralSourceId: '',
+    careTypeId: '',
+    rateAmount: '',
+    rateType: 'hourly'
+  });
+
+  const [authFormData, setAuthFormData] = useState({
+    clientId: '',
+    referralSourceId: '',
+    authorizationNumber: '',
+    serviceType: '',
+    authorizedUnits: '',
+    unitType: 'hours',
+    startDate: '',
+    endDate: '',
+    notes: ''
+  });
+
+  const [paymentFormData, setPaymentFormData] = useState({
+    invoiceId: '',
+    amount: '',
+    paymentDate: new Date().toISOString().split('T')[0],
+    paymentMethod: 'check',
+    referenceNumber: '',
+    notes: ''
+  });
+
+  const [adjustmentFormData, setAdjustmentFormData] = useState({
+    invoiceId: '',
+    amount: '',
+    type: 'write_off',
+    reason: '',
+    notes: ''
+  });
+
+  const [manualFormData, setManualFormData] = useState({
+    clientId: '',
+    billingPeriodStart: '',
+    billingPeriodEnd: '',
+    notes: ''
+  });
+
+  const [detailedMode, setDetailedMode] = useState(true); // Default to detailed (best practice)
+  
+  const [manualLineItems, setManualLineItems] = useState([
+    { caregiverId: '', caregiverName: '', description: 'Home Care Services', hours: '', rate: '', serviceDate: '', startTime: '', endTime: '' }
+  ]);
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [invoiceRes, clientRes, rsRes, ctRes, ratesRes, caregiversRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/billing/invoices`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/clients`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/referral-sources`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/care-types`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/billing/referral-source-rates`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/users?role=caregiver`, { headers: { 'Authorization': `Bearer ${token}` } })
+      ]);
+
+      setInvoices(await invoiceRes.json());
+      setClients(await clientRes.json());
+      setReferralSources(await rsRes.json());
+      setCareTypes(await ctRes.json());
+      setRates(await ratesRes.json());
+      
+      try {
+        const caregiversData = await caregiversRes.json();
+        setCaregivers(Array.isArray(caregiversData) ? caregiversData : []);
+      } catch (e) { setCaregivers([]); }
+
+      // Try loading optional endpoints
+      try {
+        const authRes = await fetch(`${API_BASE_URL}/api/authorizations`, { headers: { 'Authorization': `Bearer ${token}` } });
+        if (authRes.ok) setAuthorizations(await authRes.json());
+      } catch (e) { console.log('Authorizations endpoint not available'); }
+
+      try {
+        const payRes = await fetch(`${API_BASE_URL}/api/billing/invoice-payments`, { headers: { 'Authorization': `Bearer ${token}` } });
+        if (payRes.ok) setPayments(await payRes.json());
+      } catch (e) { console.log('Payments endpoint not available'); }
+
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleGenerateInvoice = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoices/generate-with-rates`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(formData)
+      });
+      if (!response.ok) {
+        const err = await response.json();
+        throw new Error(err.error || 'Failed to generate invoice');
+      }
+      const invoice = await response.json();
+      setFormData({ clientId: '', billingPeriodStart: '', billingPeriodEnd: '', notes: '' });
+      setShowGenerateForm(false);
+      loadData();
+      setSelectedInvoice(invoice);
+      setShowInvoiceModal(true);
+    } catch (error) {
+      toast('Failed to generate invoice: ' + error.message, 'error');
+    }
+  };
+
+  const handleManualInvoice = async (e) => {
+    e.preventDefault();
+    
+    // Validate line items
+    const validLineItems = manualLineItems.filter(item => 
+      parseFloat(item.hours) > 0 && parseFloat(item.rate) > 0
+    );
+    
+    if (validLineItems.length === 0) {
+      toast('Please add at least one line item with hours and rate');
+      return;
+    }
+
+    // In detailed mode, require date for each line item
+    if (detailedMode) {
+      const missingDates = validLineItems.some(item => !item.serviceDate);
+      if (missingDates) {
+        toast('Please enter a date for each line item in detailed mode');
+        return;
+      }
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoices/manual`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          ...manualFormData,
+          detailedMode,
+          lineItems: validLineItems
+        })
+      });
+      if (!response.ok) {
+        const err = await response.json();
+        throw new Error(err.error || 'Failed to create invoice');
+      }
+      const invoice = await response.json();
+      setManualFormData({ clientId: '', billingPeriodStart: '', billingPeriodEnd: '', notes: '' });
+      setManualLineItems([{ caregiverId: '', caregiverName: '', description: 'Home Care Services', hours: '', rate: '', serviceDate: '', startTime: '', endTime: '' }]);
+      setShowManualForm(false);
+      loadData();
+      setSelectedInvoice(invoice);
+      setShowInvoiceModal(true);
+      setMessage('✓ Manual invoice created successfully');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed to create invoice: ' + error.message, 'error');
+    }
+  };
+
+  const addManualLineItem = () => {
+    setManualLineItems([...manualLineItems, { caregiverId: '', caregiverName: '', description: 'Home Care Services', hours: '', rate: '', serviceDate: '', startTime: '', endTime: '' }]);
+  };
+
+  const removeManualLineItem = (index) => {
+    if (manualLineItems.length > 1) {
+      setManualLineItems(manualLineItems.filter((_, i) => i !== index));
+    }
+  };
+
+  const updateManualLineItem = (index, field, value) => {
+    const updated = [...manualLineItems];
+    updated[index][field] = value;
+    
+    // If selecting a caregiver, also store their name
+    if (field === 'caregiverId' && value) {
+      const caregiver = caregivers.find(c => c.id === value);
+      if (caregiver) {
+        updated[index].caregiverName = `${caregiver.first_name} ${caregiver.last_name}`;
+      }
+    }
+    
+    // Auto-calculate hours when start/end times are both set
+    if (field === 'startTime' || field === 'endTime') {
+      const startTime = field === 'startTime' ? value : updated[index].startTime;
+      const endTime = field === 'endTime' ? value : updated[index].endTime;
+      
+      if (startTime && endTime) {
+        const [startHour, startMin] = startTime.split(':').map(Number);
+        const [endHour, endMin] = endTime.split(':').map(Number);
+        
+        let hours = (endHour + endMin / 60) - (startHour + startMin / 60);
+        
+        // Handle overnight shifts
+        if (hours < 0) {
+          hours += 24;
+        }
+        
+        // Round to nearest 0.25 (15 minutes)
+        hours = Math.round(hours * 4) / 4;
+        
+        updated[index].hours = hours.toFixed(2);
+      }
+    }
+    
+    setManualLineItems(updated);
+  };
+
+  const calculateManualTotal = () => {
+    return manualLineItems.reduce((sum, item) => {
+      return sum + (parseFloat(item.hours || 0) * parseFloat(item.rate || 0));
+    }, 0);
+  };
+
+  const handleBatchGenerate = async (e) => {
+    e.preventDefault();
+    setLoading(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoices/batch-generate`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(batchFormData)
+      });
+      if (!response.ok) throw new Error('Batch generation failed');
+      const result = await response.json();
+      setBatchFormData({ billingPeriodStart: '', billingPeriodEnd: '', clientFilter: 'all', referralSourceId: '' });
+      setShowBatchForm(false);
+      loadData();
+      setMessage(`✓ Generated ${result.count} invoices totaling ${formatCurrency(result.total)}`);
+      setTimeout(() => setMessage(''), 5000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleViewInvoice = async (invoiceId) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoices/${invoiceId}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const invoice = await response.json();
+      setSelectedInvoice(invoice);
+      setShowInvoiceModal(true);
+    } catch (error) {
+      toast('Failed to load invoice: ' + error.message, 'error');
+    }
+  };
+const handleDeleteInvoice = async (invoiceId, invoiceNumber) => {
+  if (!confirm(`Are you sure you want to delete invoice ${invoiceNumber}? This cannot be undone.`)) {
+    return;
+  }
+  
+  try {
+    const response = await fetch(`${API_BASE_URL}/api/billing/invoices/${invoiceId}`, {
+      method: 'DELETE',
+      headers: { 'Authorization': `Bearer ${token}` }
+    });
+    
+    if (!response.ok) {
+      const err = await response.json();
+      throw new Error(err.error || 'Failed to delete invoice');
+    }
+    
+    setMessage(`✓ Invoice ${invoiceNumber} deleted`);
+    setTimeout(() => setMessage(''), 3000);
+    loadData();
+  } catch (error) {
+    toast('Failed to delete invoice: ' + error.message, 'error');
+  }
+};
+  const handleMarkPaid = async (invoiceId) => {
+    try {
+      await fetch(`${API_BASE_URL}/api/billing/invoices/${invoiceId}/payment-status`, {
+        method: 'PUT',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ status: 'paid', paymentDate: new Date() })
+      });
+      loadData();
+      if (selectedInvoice?.id === invoiceId) {
+        setSelectedInvoice({ ...selectedInvoice, payment_status: 'paid' });
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleRecordPayment = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoice-payments`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(paymentFormData)
+      });
+      if (!response.ok) throw new Error('Failed to record payment');
+      setPaymentFormData({ invoiceId: '', amount: '', paymentDate: new Date().toISOString().split('T')[0], paymentMethod: 'check', referenceNumber: '', notes: '' });
+      setShowPaymentModal(false);
+      loadData();
+      setMessage('✓ Payment recorded');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleAddAuthorization = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/authorizations`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(authFormData)
+      });
+      if (!response.ok) throw new Error('Failed to add authorization');
+      setAuthFormData({ clientId: '', referralSourceId: '', authorizationNumber: '', serviceType: '', authorizedUnits: '', unitType: 'hours', startDate: '', endDate: '', notes: '' });
+      setShowAuthModal(false);
+      loadData();
+      setMessage('✓ Authorization added');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleRecordAdjustment = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/invoice-adjustments`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(adjustmentFormData)
+      });
+      if (!response.ok) throw new Error('Failed to record adjustment');
+      setAdjustmentFormData({ invoiceId: '', amount: '', type: 'write_off', reason: '', notes: '' });
+      setShowAdjustmentModal(false);
+      loadData();
+      setMessage('✓ Adjustment recorded');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleAddRate = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/referral-source-rates`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(rateFormData)
+      });
+      if (!response.ok) throw new Error('Failed to add rate');
+      setRateFormData({ referralSourceId: '', careTypeId: '', rateAmount: '', rateType: 'hourly' });
+      setShowRateForm(false);
+      loadData();
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleDeleteRate = async (rateId) => {
+    const _cok = await confirm('Delete this rate?', {danger: true}); if (!_cok) return;
+    try {
+      await fetch(`${API_BASE_URL}/api/billing/referral-source-rates/${rateId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      loadData();
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleExportCSV = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/export/invoices-csv`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = 'invoices.csv';
+      a.click();
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const handleExportEVV = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/billing/export/evv`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `evv-export-${new Date().toISOString().split('T')[0]}.csv`;
+      a.click();
+    } catch (error) {
+      toast('Failed to export EVV: ' + error.message, 'error');
+    }
+  };
+
+  const calculateAgingBuckets = () => {
+    const today = new Date();
+    const buckets = { current: 0, thirtyDays: 0, sixtyDays: 0, ninetyDays: 0, over90: 0 };
+    invoices.filter(inv => inv.payment_status !== 'paid').forEach(inv => {
+      const dueDate = parseDate(inv.payment_due_date);
+      const daysOverdue = Math.floor((today - dueDate) / (1000 * 60 * 60 * 24));
+      const amount = parseFloat(inv.total || 0) - parseFloat(inv.amount_paid || 0);
+      if (daysOverdue <= 0) buckets.current += amount;
+      else if (daysOverdue <= 30) buckets.thirtyDays += amount;
+      else if (daysOverdue <= 60) buckets.sixtyDays += amount;
+      else if (daysOverdue <= 90) buckets.ninetyDays += amount;
+      else buckets.over90 += amount;
+    });
+    return buckets;
+  };
+
+  const getAuthUsage = (auth) => {
+    const used = parseFloat(auth.used_units || 0);
+    const authorized = parseFloat(auth.authorized_units || 0);
+    return { used, authorized, remaining: authorized - used, percentage: authorized > 0 ? (used / authorized) * 100 : 0 };
+  };
+
+  const pendingTotal = invoices.filter(inv => inv.payment_status === 'pending').reduce((sum, inv) => sum + parseFloat(inv.total || 0), 0);
+  const paidTotal = invoices.filter(inv => inv.payment_status === 'paid').reduce((sum, inv) => sum + parseFloat(inv.total || 0), 0);
+  const agingBuckets = calculateAgingBuckets();
+
+  const formatCurrency = (amount) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount || 0);
+  const getClientName = (clientId) => { const c = clients.find(c => c.id === clientId); return c ? `${c.first_name} ${c.last_name}` : 'Unknown'; };
+  const getRSName = (rsId) => { const rs = referralSources.find(r => r.id === rsId); return rs ? rs.name : 'Unknown'; };
+
+  const tabs = [
+    { id: 'invoices', label: '📄 Invoices' },
+    { id: 'aging', label: '📊 A/R Aging' },
+    { id: 'authorizations', label: '📋 Authorizations' },
+    { id: 'payments', label: '💳 Payments' },
+    { id: 'rates', label: '💰 Rates' }
+  ];
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>💰 Billing & Invoicing</h2>
+        <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+          <button className="btn btn-primary" onClick={() => setShowGenerateForm(!showGenerateForm)}>📄 New Invoice</button>
+          <button className="btn btn-primary" onClick={() => setShowManualForm(!showManualForm)}>✏️ Manual Invoice</button>
+          <button className="btn btn-secondary" onClick={() => setShowBatchForm(!showBatchForm)}>📋 Batch Generate</button>
+          <button className="btn btn-secondary" onClick={handleExportCSV}>📥 Export CSV</button>
+          <button className="btn btn-secondary" onClick={handleExportEVV}>📤 EVV Export</button>
+        </div>
+      </div>
+
+      {message && <div className="alert alert-success">{message}</div>}
+
+      {/* Summary Cards */}
+      <div className="grid">
+        <div className="stat-card">
+          <h3>Outstanding A/R</h3>
+          <div className="value" style={{ color: '#dc3545' }}>{formatCurrency(pendingTotal)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Collected (All Time)</h3>
+          <div className="value" style={{ color: '#28a745' }}>{formatCurrency(paidTotal)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Over 90 Days</h3>
+          <div className="value" style={{ color: agingBuckets.over90 > 0 ? '#dc3545' : '#28a745' }}>{formatCurrency(agingBuckets.over90)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Active Authorizations</h3>
+          <div className="value">{authorizations.filter(a => parseDate(a.end_date) >= new Date()).length}</div>
+        </div>
+      </div>
+
+      {/* Tabs */}
+      <div className="card">
+        <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '1rem' }}>
+          {tabs.map(tab => (
+            <button key={tab.id} className={`btn ${activeTab === tab.id ? 'btn-primary' : 'btn-secondary'}`} onClick={() => setActiveTab(tab.id)}>{tab.label}</button>
+          ))}
+        </div>
+      </div>
+
+      {/* Generate Invoice Form */}
+      {showGenerateForm && (
+        <div className="card card-form">
+          <h3>Generate Invoice</h3>
+          <form onSubmit={handleGenerateInvoice}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Client *</label>
+                <select value={formData.clientId} onChange={(e) => setFormData({ ...formData, clientId: e.target.value })} required>
+                  <option value="">Select client...</option>
+                  {clients.map(client => <option key={client.id} value={client.id}>{client.first_name} {client.last_name}</option>)}
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Billing Period Start *</label>
+                <input type="date" value={formData.billingPeriodStart} onChange={(e) => setFormData({ ...formData, billingPeriodStart: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Billing Period End *</label>
+                <input type="date" value={formData.billingPeriodEnd} onChange={(e) => setFormData({ ...formData, billingPeriodEnd: e.target.value })} required />
+              </div>
+            </div>
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Generate</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowGenerateForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Manual Invoice Form */}
+      {showManualForm && (
+        <div className="card" style={{ maxWidth: 'none' }}>
+          <h3>✏️ Manual Invoice Entry</h3>
+          <p className="text-muted">Create an invoice with manually entered line items (no time entries required).</p>
+          <form onSubmit={handleManualInvoice}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Client *</label>
+                <select value={manualFormData.clientId} onChange={(e) => setManualFormData({ ...manualFormData, clientId: e.target.value })} required>
+                  <option value="">Select client...</option>
+                  {clients.map(client => <option key={client.id} value={client.id}>{client.first_name} {client.last_name}</option>)}
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Billing Period Start *</label>
+                <input type="date" value={manualFormData.billingPeriodStart} onChange={(e) => setManualFormData({ ...manualFormData, billingPeriodStart: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Billing Period End *</label>
+                <input type="date" value={manualFormData.billingPeriodEnd} onChange={(e) => setManualFormData({ ...manualFormData, billingPeriodEnd: e.target.value })} required />
+              </div>
+            </div>
+            
+            {/* Mode Toggle */}
+            <div style={{ 
+              display: 'flex', 
+              gap: '0.5rem', 
+              alignItems: 'center', 
+              marginTop: '1.5rem', 
+              marginBottom: '1rem',
+              padding: '0.75rem',
+              background: '#f8f9fa',
+              borderRadius: '8px',
+              flexWrap: 'wrap'
+            }}>
+              <label style={{ fontWeight: '600', margin: 0, marginRight: '0.5rem' }}>Format:</label>
+              <button 
+                type="button" 
+                className={`btn btn-sm ${!detailedMode ? 'btn-primary' : 'btn-secondary'}`}
+                onClick={() => setDetailedMode(false)}
+              >
+                Summary
+              </button>
+              <button 
+                type="button" 
+                className={`btn btn-sm ${detailedMode ? 'btn-primary' : 'btn-secondary'}`}
+                onClick={() => setDetailedMode(true)}
+              >
+                Detailed ✓
+              </button>
+            </div>
+            
+            <h4 style={{ marginTop: '1rem', marginBottom: '1rem' }}>Line Items</h4>
+            
+            {/* Card-based line items for better responsiveness */}
+            {manualLineItems.map((item, index) => (
+              <div key={index} style={{ 
+                border: '1px solid #ddd', 
+                borderRadius: '8px', 
+                padding: '1rem', 
+                marginBottom: '0.75rem',
+                background: '#fafafa'
+              }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
+                  <strong style={{ color: '#666' }}>Line Item {index + 1}</strong>
+                  {manualLineItems.length > 1 && (
+                    <button type="button" className="btn btn-sm btn-danger" onClick={() => removeManualLineItem(index)}>✕ Remove</button>
+                  )}
+                </div>
+                
+                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '0.75rem', alignItems: 'end' }}>
+                  {detailedMode && (
+                    <div className="form-group" style={{ margin: 0 }}>
+                      <label style={{ fontSize: '0.8rem' }}>Date *</label>
+                      <input 
+                        type="date" 
+                        value={item.serviceDate} 
+                        onChange={(e) => updateManualLineItem(index, 'serviceDate', e.target.value)}
+                        required={detailedMode}
+                      />
+                    </div>
+                  )}
+                  
+                  <div className="form-group" style={{ margin: 0 }}>
+                    <label style={{ fontSize: '0.8rem' }}>Caregiver</label>
+                    <select 
+                      value={item.caregiverId} 
+                      onChange={(e) => updateManualLineItem(index, 'caregiverId', e.target.value)}
+                    >
+                      <option value="">Select...</option>
+                      {caregivers.map(cg => (
+                        <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>
+                      ))}
+                    </select>
+                  </div>
+                  
+                  <div className="form-group" style={{ margin: 0, gridColumn: 'span 2' }}>
+                    <label style={{ fontSize: '0.8rem' }}>Description</label>
+                    <input 
+                      type="text" 
+                      value={item.description} 
+                      onChange={(e) => updateManualLineItem(index, 'description', e.target.value)}
+                      placeholder="Home Care Services"
+                    />
+                  </div>
+                  
+                  {detailedMode && (
+                    <>
+                      <div className="form-group" style={{ margin: 0 }}>
+                        <label style={{ fontSize: '0.8rem' }}>Start Time</label>
+                        <select 
+                          value={item.startTime} 
+                          onChange={(e) => updateManualLineItem(index, 'startTime', e.target.value)}
+                        >
+                          <option value="">Select...</option>
+                          {TIME_OPTIONS.map(opt => (
+                            <option key={opt.value} value={opt.value}>{opt.label}</option>
+                          ))}
+                        </select>
+                      </div>
+                      <div className="form-group" style={{ margin: 0 }}>
+                        <label style={{ fontSize: '0.8rem' }}>End Time</label>
+                        <select 
+                          value={item.endTime} 
+                          onChange={(e) => updateManualLineItem(index, 'endTime', e.target.value)}
+                        >
+                          <option value="">Select...</option>
+                          {TIME_OPTIONS.map(opt => (
+                            <option key={opt.value} value={opt.value}>{opt.label}</option>
+                          ))}
+                        </select>
+                      </div>
+                    </>
+                  )}
+                  
+                  <div className="form-group" style={{ margin: 0 }}>
+                    <label style={{ fontSize: '0.8rem' }}>Hours *</label>
+                    <input 
+                      type="number" 
+                      step="0.25" 
+                      min="0" 
+                      value={item.hours} 
+                      onChange={(e) => updateManualLineItem(index, 'hours', e.target.value)}
+                      placeholder="0.00"
+                      required
+                    />
+                  </div>
+                  
+                  <div className="form-group" style={{ margin: 0 }}>
+                    <label style={{ fontSize: '0.8rem' }}>Rate *</label>
+                    <input 
+                      type="number" 
+                      step="0.01" 
+                      min="0" 
+                      value={item.rate} 
+                      onChange={(e) => updateManualLineItem(index, 'rate', e.target.value)}
+                      placeholder="0.00"
+                      required
+                    />
+                  </div>
+                  
+                  <div className="form-group" style={{ margin: 0 }}>
+                    <label style={{ fontSize: '0.8rem' }}>Amount</label>
+                    <div style={{ padding: '0.6rem', background: '#e8f5e9', borderRadius: '6px', fontWeight: '600', color: '#2e7d32' }}>
+                      {formatCurrency((parseFloat(item.hours) || 0) * (parseFloat(item.rate) || 0))}
+                    </div>
+                  </div>
+                </div>
+              </div>
+            ))}
+            
+            {/* Totals row */}
+            <div style={{ 
+              display: 'flex', 
+              justifyContent: 'space-between', 
+              alignItems: 'center',
+              padding: '1rem',
+              background: '#e3f2fd',
+              borderRadius: '8px',
+              marginBottom: '1rem'
+            }}>
+              <button type="button" className="btn btn-secondary" onClick={addManualLineItem}>
+                + Add Line Item
+              </button>
+              <div style={{ textAlign: 'right' }}>
+                <span style={{ color: '#666', marginRight: '1rem' }}>Total:</span>
+                <strong style={{ fontSize: '1.3rem', color: '#1565c0' }}>{formatCurrency(calculateManualTotal())}</strong>
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Notes</label>
+              <textarea 
+                value={manualFormData.notes} 
+                onChange={(e) => setManualFormData({ ...manualFormData, notes: e.target.value })}
+                rows="2"
+                placeholder="Optional notes..."
+              />
+            </div>
+            
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Create Invoice</button>
+              <button type="button" className="btn btn-secondary" onClick={() => { setShowManualForm(false); setManualLineItems([{ caregiverId: '', caregiverName: '', description: 'Home Care Services', hours: '', rate: '', serviceDate: '', startTime: '', endTime: '' }]); }}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Batch Generate Form */}
+      {showBatchForm && (
+        <div className="card card-form">
+          <h3>Batch Generate Invoices</h3>
+          <p className="text-muted">Generate invoices for all clients with billable hours in the selected period.</p>
+          <form onSubmit={handleBatchGenerate}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Start Date *</label>
+                <input type="date" value={batchFormData.billingPeriodStart} onChange={(e) => setBatchFormData({ ...batchFormData, billingPeriodStart: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>End Date *</label>
+                <input type="date" value={batchFormData.billingPeriodEnd} onChange={(e) => setBatchFormData({ ...batchFormData, billingPeriodEnd: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Client Type</label>
+                <select value={batchFormData.clientFilter} onChange={(e) => setBatchFormData({ ...batchFormData, clientFilter: e.target.value })}>
+                  <option value="all">All Clients</option>
+                  <option value="insurance">Insurance Only</option>
+                  <option value="private">Private Pay Only</option>
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Specific Payer</label>
+                <select value={batchFormData.referralSourceId} onChange={(e) => setBatchFormData({ ...batchFormData, referralSourceId: e.target.value })}>
+                  <option value="">All Payers</option>
+                  {referralSources.map(rs => <option key={rs.id} value={rs.id}>{rs.name}</option>)}
+                </select>
+              </div>
+            </div>
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary" disabled={loading}>{loading ? 'Generating...' : 'Generate All'}</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowBatchForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* INVOICES TAB */}
+      {activeTab === 'invoices' && (
+        invoices.length === 0 ? (
+          <div className="card card-centered"><p>No invoices yet. Generate your first invoice above.</p></div>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Invoice #</th>
+                <th>Client</th>
+                <th>Payer</th>
+                <th>Period</th>
+                <th>Total</th>
+                <th>Paid</th>
+                <th>Balance</th>
+                <th>Status</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {invoices.map(invoice => {
+                const paid = parseFloat(invoice.amount_paid || 0);
+                const total = parseFloat(invoice.total || 0);
+                const balance = total - paid;
+                return (
+                  <tr key={invoice.id}>
+                    <td><strong>{invoice.invoice_number}</strong></td>
+                    <td>{invoice.first_name} {invoice.last_name}</td>
+                    <td>{invoice.referral_source_name || <span className="badge badge-info">Private</span>}</td>
+                    <td>{formatDate(invoice.billing_period_start)} - {formatDate(invoice.billing_period_end)}</td>
+                    <td><strong>{formatCurrency(total)}</strong></td>
+                    <td style={{ color: '#28a745' }}>{formatCurrency(paid)}</td>
+                    <td style={{ color: balance > 0 ? '#dc3545' : '#28a745' }}>{formatCurrency(balance)}</td>
+                    <td>
+                      <span className={`badge ${invoice.payment_status === 'paid' ? 'badge-success' : invoice.payment_status === 'partial' ? 'badge-warning' : 'badge-danger'}`}>
+                        {invoice.payment_status?.toUpperCase()}
+                      </span>
+                    </td>
+                    <td>
+                      <div style={{ display: 'flex', gap: '0.25rem' }}>
+  <button className="btn btn-sm btn-primary" onClick={() => handleViewInvoice(invoice.id)}>View</button>
+  {invoice.payment_status !== 'paid' && (
+    <button className="btn btn-sm btn-success" onClick={() => { setPaymentFormData({ ...paymentFormData, invoiceId: invoice.id }); setShowPaymentModal(true); }}>Pay</button>
+  )}
+  <button className="btn btn-sm btn-danger" onClick={() => handleDeleteInvoice(invoice.id, invoice.invoice_number)}>🗑️</button>
+</div>
+                    </td>
+                  </tr>
+                );
+              })}
+            </tbody>
+          </table>
+        )
+      )}
+
+      {/* A/R AGING TAB */}
+      {activeTab === 'aging' && (
+        <>
+          <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))' }}>
+            <div className="stat-card" style={{ borderLeftColor: '#28a745' }}><h3>Current</h3><div className="value">{formatCurrency(agingBuckets.current)}</div></div>
+            <div className="stat-card" style={{ borderLeftColor: '#ffc107' }}><h3>1-30 Days</h3><div className="value">{formatCurrency(agingBuckets.thirtyDays)}</div></div>
+            <div className="stat-card" style={{ borderLeftColor: '#fd7e14' }}><h3>31-60 Days</h3><div className="value">{formatCurrency(agingBuckets.sixtyDays)}</div></div>
+            <div className="stat-card" style={{ borderLeftColor: '#dc3545' }}><h3>61-90 Days</h3><div className="value">{formatCurrency(agingBuckets.ninetyDays)}</div></div>
+            <div className="stat-card" style={{ borderLeftColor: '#721c24', background: agingBuckets.over90 > 0 ? '#f8d7da' : undefined }}><h3>Over 90</h3><div className="value">{formatCurrency(agingBuckets.over90)}</div></div>
+          </div>
+          <div className="card">
+            <h3>Outstanding Invoices</h3>
+            <table className="table">
+              <thead>
+                <tr><th>Invoice #</th><th>Client</th><th>Payer</th><th>Due Date</th><th>Days Overdue</th><th>Balance</th><th>Actions</th></tr>
+              </thead>
+              <tbody>
+                {invoices.filter(inv => inv.payment_status !== 'paid').sort((a, b) => parseDate(a.payment_due_date) - parseDate(b.payment_due_date)).map(invoice => {
+                  const daysOverdue = Math.floor((new Date() - parseDate(invoice.payment_due_date)) / (1000 * 60 * 60 * 24));
+                  const balance = parseFloat(invoice.total || 0) - parseFloat(invoice.amount_paid || 0);
+                  return (
+                    <tr key={invoice.id}>
+                      <td><strong>{invoice.invoice_number}</strong></td>
+                      <td>{invoice.first_name} {invoice.last_name}</td>
+                      <td>{invoice.referral_source_name || 'Private Pay'}</td>
+                      <td>{formatDate(invoice.payment_due_date)}</td>
+                      <td><span className={`badge ${daysOverdue <= 0 ? 'badge-success' : daysOverdue <= 30 ? 'badge-warning' : 'badge-danger'}`}>{daysOverdue <= 0 ? 'Current' : `${daysOverdue} days`}</span></td>
+                      <td><strong>{formatCurrency(balance)}</strong></td>
+                      <td>
+                        <button className="btn btn-sm btn-success" onClick={() => { setPaymentFormData({ ...paymentFormData, invoiceId: invoice.id }); setShowPaymentModal(true); }}>Pay</button>
+                        <button className="btn btn-sm btn-secondary" onClick={() => { setAdjustmentFormData({ ...adjustmentFormData, invoiceId: invoice.id }); setShowAdjustmentModal(true); }}>Adjust</button>
+                      </td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          </div>
+        </>
+      )}
+
+      {/* AUTHORIZATIONS TAB */}
+      {activeTab === 'authorizations' && (
+        <div className="card">
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+            <h3 style={{ margin: 0 }}>Service Authorizations</h3>
+            <button className="btn btn-primary" onClick={() => setShowAuthModal(true)}>+ Add Authorization</button>
+          </div>
+          {authorizations.length === 0 ? (
+            <p className="text-muted text-center">No authorizations on file.</p>
+          ) : (
+            <table className="table">
+              <thead>
+                <tr><th>Client</th><th>Payer</th><th>Auth #</th><th>Service</th><th>Authorized</th><th>Used</th><th>Remaining</th><th>Period</th><th>Status</th></tr>
+              </thead>
+              <tbody>
+                {authorizations.map(auth => {
+                  const usage = getAuthUsage(auth);
+                  const isExpired = parseDate(auth.end_date) < new Date();
+                  const isLow = usage.percentage >= 80;
+                  return (
+                    <tr key={auth.id} style={{ background: isExpired ? '#f8d7da' : isLow ? '#fff3cd' : undefined }}>
+                      <td><strong>{getClientName(auth.client_id)}</strong></td>
+                      <td>{getRSName(auth.referral_source_id)}</td>
+                      <td>{auth.authorization_number}</td>
+                      <td>{auth.service_type}</td>
+                      <td>{usage.authorized} {auth.unit_type}</td>
+                      <td>{usage.used.toFixed(2)} ({usage.percentage.toFixed(0)}%)</td>
+                      <td style={{ color: usage.remaining < 10 ? '#dc3545' : '#28a745', fontWeight: 'bold' }}>{usage.remaining.toFixed(2)}</td>
+                      <td>{formatDate(auth.start_date)} - {formatDate(auth.end_date)}</td>
+                      <td>{isExpired ? <span className="badge badge-danger">EXPIRED</span> : isLow ? <span className="badge badge-warning">LOW</span> : <span className="badge badge-success">ACTIVE</span>}</td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          )}
+        </div>
+      )}
+
+      {/* PAYMENTS TAB */}
+      {activeTab === 'payments' && (
+        <div className="card">
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+            <h3 style={{ margin: 0 }}>Payment History</h3>
+            <button className="btn btn-primary" onClick={() => setShowPaymentModal(true)}>+ Record Payment</button>
+          </div>
+          {payments.length === 0 ? (
+            <p className="text-muted text-center">No payments recorded.</p>
+          ) : (
+            <table className="table">
+              <thead>
+                <tr><th>Date</th><th>Invoice #</th><th>Client</th><th>Amount</th><th>Method</th><th>Reference #</th><th>Notes</th></tr>
+              </thead>
+              <tbody>
+                {payments.map(payment => (
+                  <tr key={payment.id}>
+                    <td>{formatDate(payment.payment_date)}</td>
+                    <td><strong>{payment.invoice_number}</strong></td>
+                    <td>{payment.client_name}</td>
+                    <td style={{ color: '#28a745', fontWeight: 'bold' }}>{formatCurrency(payment.amount)}</td>
+                    <td><span className="badge badge-info">{payment.payment_method?.toUpperCase()}</span></td>
+                    <td>{payment.reference_number || '-'}</td>
+                    <td>{payment.notes || '-'}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          )}
+        </div>
+      )}
+
+      {/* RATES TAB */}
+      {activeTab === 'rates' && (
+        <div className="card">
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+            <h3 style={{ margin: 0 }}>Payer Contract Rates</h3>
+            <button className="btn btn-primary" onClick={() => setShowRateForm(!showRateForm)}>{showRateForm ? 'Cancel' : '+ Add Rate'}</button>
+          </div>
+          {showRateForm && (
+            <form onSubmit={handleAddRate} style={{ marginBottom: '1.5rem', padding: '1rem', background: '#f9f9f9', borderRadius: '8px' }}>
+              <div className="form-grid">
+                <div className="form-group">
+                  <label>Payer *</label>
+                  <select value={rateFormData.referralSourceId} onChange={(e) => setRateFormData({ ...rateFormData, referralSourceId: e.target.value })} required>
+                    <option value="">Select payer...</option>
+                    {referralSources.map(rs => <option key={rs.id} value={rs.id}>{rs.name}</option>)}
+                  </select>
+                </div>
+                <div className="form-group">
+                  <label>Care Type *</label>
+                  <select value={rateFormData.careTypeId} onChange={(e) => setRateFormData({ ...rateFormData, careTypeId: e.target.value })} required>
+                    <option value="">Select care type...</option>
+                    {careTypes.map(ct => <option key={ct.id} value={ct.id}>{ct.name}</option>)}
+                  </select>
+                </div>
+                <div className="form-group">
+                  <label>Rate Type *</label>
+                  <select value={rateFormData.rateType} onChange={(e) => setRateFormData({ ...rateFormData, rateType: e.target.value })}>
+                    <option value="hourly">Per Hour</option>
+                    <option value="15min">Per 15 Minutes</option>
+                  </select>
+                </div>
+                <div className="form-group">
+                  <label>Rate Amount *</label>
+                  <input type="number" step="0.01" min="0" value={rateFormData.rateAmount} onChange={(e) => setRateFormData({ ...rateFormData, rateAmount: e.target.value })} required />
+                </div>
+              </div>
+              <div className="form-actions"><button type="submit" className="btn btn-primary">Add Rate</button></div>
+            </form>
+          )}
+          {rates.length === 0 ? (
+            <p className="text-muted text-center">No rates configured.</p>
+          ) : (
+            <table className="table">
+              <thead><tr><th>Payer</th><th>Care Type</th><th>Rate</th><th>Type</th><th>Effective</th><th>Actions</th></tr></thead>
+              <tbody>
+                {rates.map(rate => (
+                  <tr key={rate.id}>
+                    <td><strong>{rate.referral_source_name}</strong></td>
+                    <td>{rate.care_type_name}</td>
+                    <td><strong>{formatCurrency(rate.rate_amount)}</strong></td>
+                    <td><span className="badge badge-info">{rate.rate_type === 'hourly' ? 'Per Hour' : 'Per 15 Min'}</span></td>
+                    <td>{formatDate(rate.effective_date)}</td>
+                    <td><button className="btn btn-sm btn-danger" onClick={() => handleDeleteRate(rate.id)}>Delete</button></td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          )}
+        </div>
+      )}
+
+      {/* PAYMENT MODAL */}
+      {showPaymentModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header">
+              <h2>Record Payment</h2>
+              <button className="close-btn" onClick={() => setShowPaymentModal(false)}>×</button>
+            </div>
+            <form onSubmit={handleRecordPayment}>
+              <div className="form-group">
+                <label>Invoice *</label>
+                <select value={paymentFormData.invoiceId} onChange={(e) => setPaymentFormData({ ...paymentFormData, invoiceId: e.target.value })} required>
+                  <option value="">Select invoice...</option>
+                  {invoices.filter(i => i.payment_status !== 'paid').map(inv => (
+                    <option key={inv.id} value={inv.id}>{inv.invoice_number} - {inv.first_name} {inv.last_name} - {formatCurrency(inv.total)}</option>
+                  ))}
+                </select>
+              </div>
+              <div className="form-grid-2">
+                <div className="form-group"><label>Amount *</label><input type="number" step="0.01" min="0" value={paymentFormData.amount} onChange={(e) => setPaymentFormData({ ...paymentFormData, amount: e.target.value })} required /></div>
+                <div className="form-group"><label>Payment Date *</label><input type="date" value={paymentFormData.paymentDate} onChange={(e) => setPaymentFormData({ ...paymentFormData, paymentDate: e.target.value })} required /></div>
+                <div className="form-group">
+                  <label>Payment Method</label>
+                  <select value={paymentFormData.paymentMethod} onChange={(e) => setPaymentFormData({ ...paymentFormData, paymentMethod: e.target.value })}>
+                    <option value="check">Check</option><option value="ach">ACH</option><option value="credit_card">Credit Card</option><option value="cash">Cash</option><option value="eft">EFT</option>
+                  </select>
+                </div>
+                <div className="form-group"><label>Reference #</label><input type="text" value={paymentFormData.referenceNumber} onChange={(e) => setPaymentFormData({ ...paymentFormData, referenceNumber: e.target.value })} placeholder="Check # or transaction ID" /></div>
+              </div>
+              <div className="form-group"><label>Notes</label><textarea value={paymentFormData.notes} onChange={(e) => setPaymentFormData({ ...paymentFormData, notes: e.target.value })} rows="2" /></div>
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Record Payment</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowPaymentModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* AUTHORIZATION MODAL */}
+      {showAuthModal && (
+        <div className="modal active">
+          <div className="modal-content modal-large">
+            <div className="modal-header">
+              <h2>Add Authorization</h2>
+              <button className="close-btn" onClick={() => setShowAuthModal(false)}>×</button>
+            </div>
+            <form onSubmit={handleAddAuthorization}>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Client *</label>
+                  <select value={authFormData.clientId} onChange={(e) => setAuthFormData({ ...authFormData, clientId: e.target.value })} required>
+                    <option value="">Select client...</option>
+                    {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+                  </select>
+                </div>
+                <div className="form-group">
+                  <label>Payer *</label>
+                  <select value={authFormData.referralSourceId} onChange={(e) => setAuthFormData({ ...authFormData, referralSourceId: e.target.value })} required>
+                    <option value="">Select payer...</option>
+                    {referralSources.map(rs => <option key={rs.id} value={rs.id}>{rs.name}</option>)}
+                  </select>
+                </div>
+                <div className="form-group"><label>Authorization # *</label><input type="text" value={authFormData.authorizationNumber} onChange={(e) => setAuthFormData({ ...authFormData, authorizationNumber: e.target.value })} required /></div>
+                <div className="form-group"><label>Service Type</label><input type="text" value={authFormData.serviceType} onChange={(e) => setAuthFormData({ ...authFormData, serviceType: e.target.value })} placeholder="e.g., Personal Care" /></div>
+                <div className="form-group"><label>Authorized Units *</label><input type="number" step="0.25" min="0" value={authFormData.authorizedUnits} onChange={(e) => setAuthFormData({ ...authFormData, authorizedUnits: e.target.value })} required /></div>
+                <div className="form-group">
+                  <label>Unit Type</label>
+                  <select value={authFormData.unitType} onChange={(e) => setAuthFormData({ ...authFormData, unitType: e.target.value })}>
+                    <option value="hours">Hours</option><option value="visits">Visits</option><option value="days">Days</option>
+                  </select>
+                </div>
+                <div className="form-group"><label>Start Date *</label><input type="date" value={authFormData.startDate} onChange={(e) => setAuthFormData({ ...authFormData, startDate: e.target.value })} required /></div>
+                <div className="form-group"><label>End Date *</label><input type="date" value={authFormData.endDate} onChange={(e) => setAuthFormData({ ...authFormData, endDate: e.target.value })} required /></div>
+              </div>
+              <div className="form-group"><label>Notes</label><textarea value={authFormData.notes} onChange={(e) => setAuthFormData({ ...authFormData, notes: e.target.value })} rows="2" /></div>
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Add Authorization</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowAuthModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* ADJUSTMENT MODAL */}
+      {showAdjustmentModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header">
+              <h2>Record Adjustment</h2>
+              <button className="close-btn" onClick={() => setShowAdjustmentModal(false)}>×</button>
+            </div>
+            <form onSubmit={handleRecordAdjustment}>
+              <div className="form-group">
+                <label>Invoice *</label>
+                <select value={adjustmentFormData.invoiceId} onChange={(e) => setAdjustmentFormData({ ...adjustmentFormData, invoiceId: e.target.value })} required>
+                  <option value="">Select invoice...</option>
+                  {invoices.filter(i => i.payment_status !== 'paid').map(inv => <option key={inv.id} value={inv.id}>{inv.invoice_number} - {formatCurrency(inv.total)}</option>)}
+                </select>
+              </div>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Type *</label>
+                  <select value={adjustmentFormData.type} onChange={(e) => setAdjustmentFormData({ ...adjustmentFormData, type: e.target.value })}>
+                    <option value="write_off">Write Off</option><option value="adjustment">Adjustment</option><option value="discount">Discount</option><option value="refund">Refund</option>
+                  </select>
+                </div>
+                <div className="form-group"><label>Amount *</label><input type="number" step="0.01" min="0" value={adjustmentFormData.amount} onChange={(e) => setAdjustmentFormData({ ...adjustmentFormData, amount: e.target.value })} required /></div>
+              </div>
+              <div className="form-group"><label>Reason *</label><input type="text" value={adjustmentFormData.reason} onChange={(e) => setAdjustmentFormData({ ...adjustmentFormData, reason: e.target.value })} placeholder="e.g., Uncollectable" required /></div>
+              <div className="form-group"><label>Notes</label><textarea value={adjustmentFormData.notes} onChange={(e) => setAdjustmentFormData({ ...adjustmentFormData, notes: e.target.value })} rows="2" /></div>
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Record Adjustment</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowAdjustmentModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* INVOICE DETAIL MODAL - Professional Print Layout */}
+      {showInvoiceModal && selectedInvoice && (
+        <div className="modal active">
+          <div className="modal-content modal-large" style={{ maxWidth: '900px' }}>
+            {/* Screen-only header */}
+            <div className="modal-header no-print">
+              <h2>Invoice {selectedInvoice.invoice_number}</h2>
+              <button className="close-btn" onClick={() => setShowInvoiceModal(false)}>×</button>
+            </div>
+            
+            {/* Printable Invoice - Zoho Style */}
+            <div id="printable-invoice" className="invoice-print-container">
+              <style>{`
+                @media print {
+                  @page {
+                    margin: 10mm;
+                    size: letter;
+                  }
+                  body * { visibility: hidden; }
+                  #printable-invoice, #printable-invoice * { visibility: visible; }
+                  html, body { height: auto !important; overflow: visible !important; }
+                  #root, .main-content, .container { overflow: visible !important; height: auto !important; }
+                  .sidebar { display: none !important; }
+                  .main-content { margin-left: 0 !important; width: 100% !important; }
+                  .modal, .modal.active {
+                    position: absolute !important;
+                    left: 0 !important;
+                    top: 0 !important;
+                    width: 100% !important;
+                    height: auto !important;
+                    overflow: visible !important;
+                    background: none !important;
+                    padding: 0 !important;
+                    display: block !important;
+                  }
+                  .modal-content, .modal-large {
+                    position: relative !important;
+                    overflow: visible !important;
+                    max-height: none !important;
+                    height: auto !important;
+                    box-shadow: none !important;
+                    padding: 0 !important;
+                    margin: 0 !important;
+                    max-width: 100% !important;
+                    width: 100% !important;
+                  }
+                  #printable-invoice {
+                    position: relative !important;
+                    width: 100% !important;
+                    padding: 0 !important;
+                    margin: 0 !important;
+                  }
+                  .no-print { display: none !important; visibility: hidden !important; }
+                  .invoice-table tr { page-break-inside: avoid; break-inside: avoid; }
+                }
+                .invoice-print-container {
+                  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
+                  color: #333;
+                  background: white;
+                  padding: 20px;
+                  line-height: 1.3;
+                  font-size: 12px;
+                }
+                /* Header: Logo+Company LEFT, Invoice Info RIGHT */
+                .invoice-header-row {
+                  display: flex;
+                  justify-content: space-between;
+                  align-items: flex-start;
+                  margin-bottom: 20px;
+                }
+                .invoice-header-left {
+                  display: flex;
+                  flex-direction: column;
+                }
+                .invoice-logo-large {
+                  max-width: 200px;
+                  height: auto;
+                  margin-bottom: 15px;
+                }
+                .invoice-company-info {
+                  font-size: 12px;
+                  color: #555;
+                  line-height: 1.5;
+                }
+                .invoice-company-name {
+                  font-size: 16px;
+                  font-weight: 600;
+                  color: #333;
+                  margin-bottom: 3px;
+                }
+                .invoice-header-right {
+                  text-align: right;
+                }
+                .invoice-title-large {
+                  font-size: 36px;
+                  font-weight: 300;
+                  color: #333;
+                  margin: 0;
+                  letter-spacing: 2px;
+                }
+                .invoice-number-display {
+                  font-size: 14px;
+                  color: #666;
+                  margin-top: 5px;
+                }
+                .invoice-balance-box {
+                  margin-top: 15px;
+                  text-align: right;
+                }
+                .invoice-balance-label {
+                  font-size: 11px;
+                  color: #888;
+                  text-transform: uppercase;
+                }
+                .invoice-balance-amount {
+                  font-size: 28px;
+                  font-weight: 600;
+                  color: #2ABBA7;
+                }
+                /* Bill To LEFT, Invoice Dates RIGHT */
+                .invoice-details-row {
+                  display: flex;
+                  justify-content: space-between;
+                  margin-bottom: 15px;
+                  padding-bottom: 15px;
+                }
+                .invoice-bill-to {
+                  flex: 1;
+                }
+                .invoice-bill-to-label {
+                  font-size: 11px;
+                  color: #888;
+                  margin-bottom: 5px;
+                }
+                .invoice-bill-to-name {
+                  font-size: 15px;
+                  font-weight: 600;
+                  color: #333;
+                  margin-bottom: 3px;
+                }
+                .invoice-bill-to-address {
+                  font-size: 12px;
+                  color: #555;
+                  line-height: 1.5;
+                }
+                .invoice-dates {
+                  text-align: right;
+                }
+                .invoice-date-row {
+                  display: flex;
+                  justify-content: flex-end;
+                  gap: 20px;
+                  margin-bottom: 6px;
+                  font-size: 13px;
+                }
+                .invoice-date-label {
+                  color: #666;
+                }
+                .invoice-date-value {
+                  font-weight: 500;
+                  min-width: 100px;
+                  text-align: right;
+                }
+                /* Table - Zoho Style */
+                .invoice-table {
+                  width: 100%;
+                  border-collapse: collapse;
+                  margin-bottom: 0;
+                }
+                .invoice-table thead {
+                  background: #2ABBA7;
+                }
+                .invoice-table th {
+                  color: white;
+                  padding: 8px 12px;
+                  text-align: left;
+                  font-size: 11px;
+                  font-weight: 600;
+                  text-transform: uppercase;
+                  border: none;
+                }
+                .invoice-table th:first-child { width: 30px; text-align: center; }
+                .invoice-table th:nth-child(2) { width: auto; }
+                .invoice-table th:nth-child(3) { width: 60px; text-align: right; }
+                .invoice-table th:nth-child(4) { width: 70px; text-align: right; }
+                .invoice-table th:last-child { width: 90px; text-align: right; }
+                .invoice-table td {
+                  padding: 6px 12px;
+                  border-bottom: 1px solid #eee;
+                  font-size: 13px;
+                  vertical-align: middle;
+                }
+                .invoice-table td:first-child { text-align: center; color: #888; }
+                .invoice-table td:nth-child(3) { text-align: right; }
+                .invoice-table td:nth-child(4) { text-align: right; }
+                .invoice-table td:last-child { text-align: right; font-weight: 500; }
+                .invoice-item-description {
+                  font-weight: 500;
+                  color: #333;
+                }
+                .invoice-item-details {
+                  font-size: 11px;
+                  color: #888;
+                  margin-top: 3px;
+                  line-height: 1.4;
+                }
+                /* Totals Section */
+                .invoice-totals-section {
+                  display: flex;
+                  justify-content: flex-end;
+                  margin-top: 0;
+                }
+                .invoice-totals-box {
+                  width: 280px;
+                }
+                .invoice-total-row {
+                  display: flex;
+                  justify-content: space-between;
+                  padding: 8px 12px;
+                  border-bottom: 1px solid #eee;
+                  font-size: 13px;
+                }
+                .invoice-total-row:last-child {
+                  border-bottom: none;
+                }
+                .invoice-total-label { color: #555; }
+                .invoice-total-value { font-weight: 500; text-align: right; min-width: 80px; }
+                .invoice-total-row.grand-total {
+                  background: #2ABBA7;
+                  color: white;
+                  font-weight: 600;
+                  font-size: 14px;
+                }
+                .invoice-total-row.grand-total .invoice-total-label,
+                .invoice-total-row.grand-total .invoice-total-value {
+                  color: white;
+                  font-weight: 600;
+                }
+                /* Notes */
+                .invoice-notes-section {
+                  margin-top: 20px;
+                  padding-top: 10px;
+                }
+                .invoice-notes-label {
+                  font-size: 12px;
+                  font-weight: 600;
+                  color: #333;
+                  margin-bottom: 5px;
+                }
+                .invoice-notes-text {
+                  font-size: 12px;
+                  color: #555;
+                }
+                /* Footer */
+                .invoice-footer-section {
+                  margin-top: 25px;
+                  padding-top: 10px;
+                  border-top: 1px solid #ddd;
+                  text-align: center;
+                  color: #888;
+                  font-size: 11px;
+                }
+              `}</style>
+              
+              {/* Header Row: Logo+Company on Left, Invoice Title+Balance on Right */}
+              <div className="invoice-header-row">
+                <div className="invoice-header-left">
+                  <img 
+                    src="/logo.png" 
+                    alt="Chippewa Valley Home Care" 
+                    className="invoice-logo-large"
+                    onError={(e) => { e.target.style.display = 'none'; }}
+                  />
+                  <div className="invoice-company-info">
+                    <div className="invoice-company-name">Chippewa Valley Home Care</div>
+                    <div>2607 Beverly Hills Dr</div>
+                    <div>Eau Claire, Wisconsin 54701</div>
+                    <div>U.S.A</div>
+                    <div>715-491-1254</div>
+                    <div>chippewavalleyhomecare@gmail.com</div>
+                  </div>
+                </div>
+                <div className="invoice-header-right">
+                  <h1 className="invoice-title-large">INVOICE</h1>
+                  <div className="invoice-number-display"># {selectedInvoice.invoice_number}</div>
+                  <div className="invoice-balance-box">
+                    <div className="invoice-balance-label">Balance Due</div>
+                    <div className="invoice-balance-amount">{formatCurrency(parseFloat(selectedInvoice.total || 0) - parseFloat(selectedInvoice.amount_paid || 0))}</div>
+                  </div>
+                </div>
+              </div>
+
+              {/* Details Row: Bill To on Left, Dates on Right */}
+              <div className="invoice-details-row">
+                <div className="invoice-bill-to">
+                  <div className="invoice-bill-to-label">Bill To</div>
+                  <div className="invoice-bill-to-name">{selectedInvoice.first_name} {selectedInvoice.last_name}</div>
+                  <div className="invoice-bill-to-address">
+                    {selectedInvoice.address && <>{selectedInvoice.address}<br /></>}
+                    {selectedInvoice.city && <>{selectedInvoice.city}<br /></>}
+                    {selectedInvoice.state && <>{selectedInvoice.state}<br /></>}
+                    U.S.A
+                  </div>
+                </div>
+                <div className="invoice-dates">
+                  <div className="invoice-date-row">
+                    <span className="invoice-date-label">Invoice Date :</span>
+                    <span className="invoice-date-value">{formatDate(selectedInvoice.created_at, { day: '2-digit', month: 'short', year: 'numeric' })}</span>
+                  </div>
+                  <div className="invoice-date-row">
+                    <span className="invoice-date-label">Terms :</span>
+                    <span className="invoice-date-value">Due on Receipt</span>
+                  </div>
+                  <div className="invoice-date-row">
+                    <span className="invoice-date-label">Due Date :</span>
+                    <span className="invoice-date-value">{formatDate(selectedInvoice.created_at, { day: '2-digit', month: 'short', year: 'numeric' })}</span>
+                  </div>
+                </div>
+              </div>
+
+              {/* Line Items Table */}
+              <table className="invoice-table">
+                <thead>
+                  <tr>
+                    <th>#</th>
+                    <th>Item & Description</th>
+                    <th>HOURS</th>
+                    <th>Rate</th>
+                    <th>Amount</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {selectedInvoice.line_items?.length > 0 ? (
+                    selectedInvoice.line_items.map((item, idx) => (
+                      <tr key={idx}>
+                        <td>{idx + 1}</td>
+                        <td>
+                          <div className="invoice-item-description">{item.description || 'Home Care Services'}</div>
+                          <div className="invoice-item-details">
+                            {item.service_date && formatDate(item.service_date, { month: '2-digit', day: '2-digit' })}
+                            {item.caregiver_first_name && ` - ${item.caregiver_first_name} ${item.caregiver_last_name}`}
+                            {item.time_range && ` ${item.time_range}`}
+                          </div>
+                        </td>
+                        <td>{parseFloat(item.hours).toFixed(2)}</td>
+                        <td>{parseFloat(item.rate).toFixed(2)}</td>
+                        <td>{parseFloat(item.amount).toFixed(2)}</td>
+                      </tr>
+                    ))
+                  ) : (
+                    <tr>
+                      <td>1</td>
+                      <td>
+                        <div className="invoice-item-description">Home Care Services</div>
+                        <div className="invoice-item-details">
+                          {formatDate(selectedInvoice.billing_period_start)} - {formatDate(selectedInvoice.billing_period_end)}
+                        </div>
+                      </td>
+                      <td>{selectedInvoice.total_hours?.toFixed(2) || '0.00'}</td>
+                      <td>{selectedInvoice.line_items?.[0]?.rate?.toFixed(2) || '33.00'}</td>
+                      <td>{parseFloat(selectedInvoice.total).toFixed(2)}</td>
+                    </tr>
+                  )}
+                </tbody>
+              </table>
+
+              {/* Totals */}
+              <div className="invoice-totals-section">
+                <div className="invoice-totals-box">
+                  <div className="invoice-total-row">
+                    <span className="invoice-total-label">Sub Total</span>
+                    <span className="invoice-total-value">{parseFloat(selectedInvoice.subtotal || selectedInvoice.total).toFixed(2)}</span>
+                  </div>
+                  <div className="invoice-total-row">
+                    <span className="invoice-total-label">Total</span>
+                    <span className="invoice-total-value"><strong>${parseFloat(selectedInvoice.total).toFixed(2)}</strong></span>
+                  </div>
+                  {parseFloat(selectedInvoice.amount_paid || 0) > 0 && (
+                    <div className="invoice-total-row">
+                      <span className="invoice-total-label">Amount Paid</span>
+                      <span className="invoice-total-value" style={{ color: '#28a745' }}>-${parseFloat(selectedInvoice.amount_paid).toFixed(2)}</span>
+                    </div>
+                  )}
+                  <div className="invoice-total-row grand-total">
+                    <span className="invoice-total-label">Balance Due</span>
+                    <span className="invoice-total-value">${(parseFloat(selectedInvoice.total || 0) - parseFloat(selectedInvoice.amount_paid || 0)).toFixed(2)}</span>
+                  </div>
+                </div>
+              </div>
+
+              {/* Notes */}
+              {selectedInvoice.notes ? (
+                <div className="invoice-notes-section">
+                  <div className="invoice-notes-label">Notes</div>
+                  <div className="invoice-notes-text">{selectedInvoice.notes}</div>
+                </div>
+              ) : (
+                <div className="invoice-notes-section">
+                  <div className="invoice-notes-label">Notes</div>
+                  <div className="invoice-notes-text">Thanks for your business.</div>
+                </div>
+              )}
+
+              {/* Footer */}
+              <div className="invoice-footer-section">
+                <div>Chippewa Valley Home Care</div>
+                <div>Thank you for choosing us for your home care needs.</div>
+              </div>
+            </div>
+
+            {/* Action Buttons (screen only) */}
+            <div className="modal-actions no-print" style={{ marginTop: '20px', paddingTop: '20px', borderTop: '1px solid #eee' }}>
+              {selectedInvoice.payment_status !== 'paid' && (
+                <>
+                  <button className="btn btn-success" onClick={() => { setPaymentFormData({ ...paymentFormData, invoiceId: selectedInvoice.id }); setShowInvoiceModal(false); setShowPaymentModal(true); }}>💳 Record Payment</button>
+                  <button className="btn btn-warning" onClick={() => handleMarkPaid(selectedInvoice.id)}>✓ Mark Paid</button>
+                </>
+              )}
+              <button className="btn btn-primary" onClick={() => window.print()}>🖨️ Print Invoice</button>
+              <button className="btn btn-secondary" onClick={() => setShowInvoiceModal(false)}>Close</button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default BillingDashboard;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CarePlans.jsx b/templates/crm-homecare/frontend/src/components/admin/CarePlans.jsx
new file mode 100644
index 0000000..c0c3b12
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CarePlans.jsx
@@ -0,0 +1,514 @@
+import { confirm } from '../ConfirmModal';
+// src/components/admin/CarePlans.jsx
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const CarePlans = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [carePlans, setCarePlans] = useState({});
+  const [loading, setLoading] = useState(true);
+  const [isDirty, setIsDirty] = useState(false);
+  const [expandedClient, setExpandedClient] = useState(null);
+  const [showForm, setShowForm] = useState(false);
+  const [message, setMessage] = useState('');
+  const [formData, setFormData] = useState({
+    clientId: '',
+    serviceType: 'personal_care',
+    serviceDescription: '',
+    frequency: '',
+    careGoals: '',
+    specialInstructions: '',
+    precautions: '',
+    medicationNotes: '',
+    mobilityNotes: '',
+    dietaryNotes: '',
+    communicationNotes: '',
+    startDate: new Date().toISOString().split('T')[0],
+    endDate: ''
+  });
+
+  useEffect(() => {
+    const fn = (e) => { if (isDirty) { e.preventDefault(); e.returnValue = "You have unsaved changes. Leave anyway?"; return e.returnValue; } };
+    window.addEventListener("beforeunload", fn);
+    return () => window.removeEventListener("beforeunload", fn);
+  }, [isDirty]);
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [clientsRes, plansRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/care-plans`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const clientsData = await clientsRes.json();
+      const plansData = await plansRes.json();
+
+      setClients(clientsData);
+
+      // Group plans by client
+      const plansByClient = {};
+      clientsData.forEach(client => {
+        plansByClient[client.id] = [];
+      });
+
+      plansData.forEach(plan => {
+        if (plansByClient[plan.client_id]) {
+          plansByClient[plan.client_id].push(plan);
+        }
+      });
+
+      setCarePlans(plansByClient);
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleAddPlan = async (e) => {
+    e.preventDefault();
+    setMessage('');
+
+    if (!formData.clientId || !formData.serviceType) {
+      setMessage('Client and service type are required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/care-plans`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) {
+        const error = await response.json();
+        throw new Error(error.error || 'Failed to create care plan');
+      }
+
+      setMessage('Care plan created successfully!');
+      setFormData({
+        clientId: '',
+        serviceType: 'personal_care',
+        serviceDescription: '',
+        frequency: '',
+        careGoals: '',
+        specialInstructions: '',
+        precautions: '',
+        medicationNotes: '',
+        mobilityNotes: '',
+        dietaryNotes: '',
+        communicationNotes: '',
+        startDate: new Date().toISOString().split('T')[0],
+        endDate: ''
+      });
+      setShowForm(false);
+      loadData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeletePlan = async (planId) => {
+    const _cok = await confirm('Delete this care plan?', {danger: true}); if (!_cok) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/care-plans/${planId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Care plan deleted');
+      setTimeout(() => setMessage(''), 2000);
+      loadData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const getServiceLabel = (serviceType) => {
+    const labels = {
+      'personal_care': 'Personal Care',
+      'medication_management': 'Medication Management',
+      'companionship': 'Companionship',
+      'respite_care': 'Respite Care',
+      'mobility_assistance': 'Mobility Assistance',
+      'meal_prep': 'Meal Preparation',
+      'transportation': 'Transportation',
+      'other': 'Other'
+    };
+    return labels[serviceType] || serviceType;
+  };
+
+  const isActivePlan = (plan) => {
+    const today = new Date().toISOString().split('T')[0];
+    const isAfterStart = !plan.start_date || plan.start_date <= today;
+    const isBeforeEnd = !plan.end_date || plan.end_date >= today;
+    return isAfterStart && isBeforeEnd;
+  };
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Care Plans & Service Agreements</h2>
+        <button
+          className="btn btn-primary"
+          onClick={() => setShowForm(!showForm)}
+        >
+          {showForm ? 'Cancel' : 'Add Care Plan'}
+        </button>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Add Care Plan Form */}
+      {showForm && (
+        <div className="card card-form">
+          <h3>Create New Care Plan</h3>
+          <form onSubmit={handleAddPlan}>
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Client *</label>
+                <select
+                  value={formData.clientId}
+                  onChange={(e) => setFormData({ ...formData, clientId: e.target.value })}
+                  required
+                >
+                  <option value="">Select client...</option>
+                  {clients.map(client => (
+                    <option key={client.id} value={client.id}>
+                      {client.first_name} {client.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Service Type *</label>
+                <select
+                  value={formData.serviceType}
+                  onChange={(e) => setFormData({ ...formData, serviceType: e.target.value })}
+                >
+                  <option value="personal_care">Personal Care</option>
+                  <option value="medication_management">Medication Management</option>
+                  <option value="companionship">Companionship</option>
+                  <option value="respite_care">Respite Care</option>
+                  <option value="mobility_assistance">Mobility Assistance</option>
+                  <option value="meal_prep">Meal Preparation</option>
+                  <option value="transportation">Transportation</option>
+                  <option value="other">Other</option>
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Frequency</label>
+                <input
+                  type="text"
+                  value={formData.frequency}
+                  onChange={(e) => setFormData({ ...formData, frequency: e.target.value })}
+                  placeholder="e.g., Daily, 3x per week, Monday-Friday"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Start Date</label>
+                <input
+                  type="date"
+                  value={formData.startDate}
+                  onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>End Date (if applicable)</label>
+                <input
+                  type="date"
+                  value={formData.endDate}
+                  onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}
+                />
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Service Description</label>
+              <textarea
+                value={formData.serviceDescription}
+                onChange={(e) => setFormData({ ...formData, serviceDescription: e.target.value })}
+                placeholder="Detailed description of what this service entails..."
+                rows="3"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Care Goals</label>
+              <textarea
+                value={formData.careGoals}
+                onChange={(e) => setFormData({ ...formData, careGoals: e.target.value })}
+                placeholder="What are the goals for this care plan? (e.g., improve mobility, maintain independence, manage pain...)"
+                rows="3"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Special Instructions</label>
+              <textarea
+                value={formData.specialInstructions}
+                onChange={(e) => setFormData({ ...formData, specialInstructions: e.target.value })}
+                placeholder="Any special instructions caregivers should follow..."
+                rows="3"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Safety Precautions</label>
+              <textarea
+                value={formData.precautions}
+                onChange={(e) => setFormData({ ...formData, precautions: e.target.value })}
+                placeholder="Any safety concerns, fall risks, allergies, or precautions..."
+                rows="3"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Medication Notes</label>
+              <textarea
+                value={formData.medicationNotes}
+                onChange={(e) => setFormData({ ...formData, medicationNotes: e.target.value })}
+                placeholder="Instructions for medication management, timing, side effects to watch for..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Mobility Notes</label>
+              <textarea
+                value={formData.mobilityNotes}
+                onChange={(e) => setFormData({ ...formData, mobilityNotes: e.target.value })}
+                placeholder="Mobility assistance needed, equipment (walker, wheelchair), transfer techniques..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Dietary Notes</label>
+              <textarea
+                value={formData.dietaryNotes}
+                onChange={(e) => setFormData({ ...formData, dietaryNotes: e.target.value })}
+                placeholder="Dietary restrictions, preferences, feeding assistance needed..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Communication Notes</label>
+              <textarea
+                value={formData.communicationNotes}
+                onChange={(e) => setFormData({ ...formData, communicationNotes: e.target.value })}
+                placeholder="Communication style, hearing/vision issues, cognitive considerations..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Create Care Plan</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Care Plans by Client */}
+      {clients.length === 0 ? (
+        <div className="card card-centered">
+          <p>No clients yet. Create a client to add care plans.</p>
+        </div>
+      ) : (
+        <div style={{ display: 'grid', gap: '1.5rem' }}>
+          {clients.map(client => {
+            const clientPlans = carePlans[client.id] || [];
+            const activePlans = clientPlans.filter(isActivePlan);
+            const isExpanded = expandedClient === client.id;
+
+            return (
+              <div key={client.id} className="card">
+                <div
+                  onClick={() => setExpandedClient(isExpanded ? null : client.id)}
+                  style={{
+                    cursor: 'pointer',
+                    display: 'flex',
+                    justifyContent: 'space-between',
+                    alignItems: 'center',
+                    paddingBottom: '1rem',
+                    borderBottom: '1px solid #ddd'
+                  }}
+                >
+                  <div>
+                    <h3 style={{ margin: 0 }}>{client.first_name} {client.last_name}</h3>
+                    <small style={{ color: '#666' }}>
+                      {activePlans.length} active plan{activePlans.length !== 1 ? 's' : ''}
+                      {clientPlans.length > activePlans.length && ` • ${clientPlans.length - activePlans.length} archived`}
+                    </small>
+                  </div>
+                  <span style={{ fontSize: '1.2rem' }}>
+                    {isExpanded ? '▼' : '▶'}
+                  </span>
+                </div>
+
+                {isExpanded && (
+                  <div style={{ paddingTop: '1rem' }}>
+                    {clientPlans.length === 0 ? (
+                      <p style={{ color: '#999', textAlign: 'center', padding: '1rem' }}>
+                        No care plans yet for this client.
+                      </p>
+                    ) : (
+                      <div style={{ display: 'grid', gap: '1rem' }}>
+                        {clientPlans.map(plan => {
+                          const active = isActivePlan(plan);
+
+                          return (
+                            <div
+                              key={plan.id}
+                              style={{
+                                padding: '1rem',
+                                background: active ? '#f0f8ff' : '#f5f5f5',
+                                border: `1px solid ${active ? '#2196f3' : '#ddd'}`,
+                                borderRadius: '6px',
+                                opacity: active ? 1 : 0.7
+                              }}
+                            >
+                              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '0.75rem' }}>
+                                <div>
+                                  <strong>{getServiceLabel(plan.service_type)}</strong>
+                                  {plan.frequency && <div style={{ fontSize: '0.9rem', color: '#666' }}>{plan.frequency}</div>}
+                                </div>
+                                <div style={{ display: 'flex', gap: '0.5rem' }}>
+                                  {active && <span className="badge badge-success">Active</span>}
+                                  {!active && <span className="badge badge-secondary">Archived</span>}
+                                  <button
+                                    className="btn btn-sm btn-danger"
+                                    onClick={() => handleDeletePlan(plan.id)}
+                                  >
+                                    Delete
+                                  </button>
+                                </div>
+                              </div>
+
+                              <div style={{ fontSize: '0.9rem', marginBottom: '0.75rem' }}>
+                                <strong>Period:</strong> {new Date(plan.start_date).toLocaleDateString()}
+                                {plan.end_date && ` - ${new Date(plan.end_date).toLocaleDateString()}`}
+                              </div>
+
+                              {plan.service_description && (
+                                <div style={{ marginBottom: '0.75rem' }}>
+                                  <strong>Description:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {plan.service_description}
+                                  </p>
+                                </div>
+                              )}
+
+                              {plan.care_goals && (
+                                <div style={{ marginBottom: '0.75rem' }}>
+                                  <strong>Care Goals:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {plan.care_goals}
+                                  </p>
+                                </div>
+                              )}
+
+                              {plan.special_instructions && (
+                                <div style={{ marginBottom: '0.75rem' }}>
+                                  <strong>Special Instructions:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {plan.special_instructions}
+                                  </p>
+                                </div>
+                              )}
+
+                              {plan.precautions && (
+                                <div style={{ marginBottom: '0.75rem', padding: '0.75rem', background: '#ffe6e6', borderRadius: '4px' }}>
+                                  <strong style={{ color: '#d32f2f' }}>Safety Precautions:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {plan.precautions}
+                                  </p>
+                                </div>
+                              )}
+
+                              {(plan.medication_notes || plan.mobility_notes || plan.dietary_notes || plan.communication_notes) && (
+                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', marginTop: '0.75rem' }}>
+                                  {plan.medication_notes && (
+                                    <div style={{ padding: '0.5rem', background: '#f5f5f5', borderRadius: '4px', fontSize: '0.85rem' }}>
+                                      <strong>Medication:</strong>
+                                      <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                        {plan.medication_notes}
+                                      </p>
+                                    </div>
+                                  )}
+                                  {plan.mobility_notes && (
+                                    <div style={{ padding: '0.5rem', background: '#f5f5f5', borderRadius: '4px', fontSize: '0.85rem' }}>
+                                      <strong>Mobility:</strong>
+                                      <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                        {plan.mobility_notes}
+                                      </p>
+                                    </div>
+                                  )}
+                                  {plan.dietary_notes && (
+                                    <div style={{ padding: '0.5rem', background: '#f5f5f5', borderRadius: '4px', fontSize: '0.85rem' }}>
+                                      <strong>Dietary:</strong>
+                                      <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                        {plan.dietary_notes}
+                                      </p>
+                                    </div>
+                                  )}
+                                  {plan.communication_notes && (
+                                    <div style={{ padding: '0.5rem', background: '#f5f5f5', borderRadius: '4px', fontSize: '0.85rem' }}>
+                                      <strong>Communication:</strong>
+                                      <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                        {plan.communication_notes}
+                                      </p>
+                                    </div>
+                                  )}
+                                </div>
+                              )}
+                            </div>
+                          );
+                        })}
+                      </div>
+                    )}
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default CarePlans;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CaregiverAvailability.jsx b/templates/crm-homecare/frontend/src/components/admin/CaregiverAvailability.jsx
new file mode 100644
index 0000000..25b4b75
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CaregiverAvailability.jsx
@@ -0,0 +1,422 @@
+// src/components/admin/CaregiverAvailability.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const CaregiverAvailability = ({ token }) => {
+  const [caregivers, setCaregivers] = useState([]);
+  const [selectedCaregiverId, setSelectedCaregiverId] = useState('');
+  const [availability, setAvailability] = useState(null);
+  const [blackoutDates, setBlackoutDates] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState('');
+  const [showBlackoutForm, setShowBlackoutForm] = useState(false);
+  const [newBlackoutDate, setNewBlackoutDate] = useState({
+    startDate: '',
+    endDate: '',
+    reason: ''
+  });
+  const [formData, setFormData] = useState({
+    status: 'available',
+    maxHoursPerWeek: 40,
+    mondayAvailable: true,
+    mondayStartTime: '08:00',
+    mondayEndTime: '17:00',
+    tuesdayAvailable: true,
+    tuesdayStartTime: '08:00',
+    tuesdayEndTime: '17:00',
+    wednesdayAvailable: true,
+    wednesdayStartTime: '08:00',
+    wednesdayEndTime: '17:00',
+    thursdayAvailable: true,
+    thursdayStartTime: '08:00',
+    thursdayEndTime: '17:00',
+    fridayAvailable: true,
+    fridayStartTime: '08:00',
+    fridayEndTime: '17:00',
+    saturdayAvailable: false,
+    saturdayStartTime: '08:00',
+    saturdayEndTime: '17:00',
+    sundayAvailable: false,
+    sundayStartTime: '08:00',
+    sundayEndTime: '17:00',
+  });
+
+  const days = [
+    { key: 'monday', label: 'Monday' },
+    { key: 'tuesday', label: 'Tuesday' },
+    { key: 'wednesday', label: 'Wednesday' },
+    { key: 'thursday', label: 'Thursday' },
+    { key: 'friday', label: 'Friday' },
+    { key: 'saturday', label: 'Saturday' },
+    { key: 'sunday', label: 'Sunday' }
+  ];
+
+  useEffect(() => {
+    loadCaregivers();
+  }, []);
+
+  const loadCaregivers = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/users/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setCaregivers(data);
+      setLoading(false);
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+      setLoading(false);
+    }
+  };
+
+  const handleCaregiverSelect = async (caregiverId) => {
+    setSelectedCaregiverId(caregiverId);
+    setMessage('');
+    
+    try {
+      const [availRes, blackoutRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/availability`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/blackout-dates`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const availData = await availRes.json();
+      const blackoutData = await blackoutRes.json();
+
+      if (availData) {
+        setFormData({
+          status: availData.status || 'available',
+          maxHoursPerWeek: availData.max_hours_per_week || 40,
+          mondayAvailable: availData.monday_available !== false,
+          mondayStartTime: availData.monday_start_time || '08:00',
+          mondayEndTime: availData.monday_end_time || '17:00',
+          tuesdayAvailable: availData.tuesday_available !== false,
+          tuesdayStartTime: availData.tuesday_start_time || '08:00',
+          tuesdayEndTime: availData.tuesday_end_time || '17:00',
+          wednesdayAvailable: availData.wednesday_available !== false,
+          wednesdayStartTime: availData.wednesday_start_time || '08:00',
+          wednesdayEndTime: availData.wednesday_end_time || '17:00',
+          thursdayAvailable: availData.thursday_available !== false,
+          thursdayStartTime: availData.thursday_start_time || '08:00',
+          thursdayEndTime: availData.thursday_end_time || '17:00',
+          fridayAvailable: availData.friday_available !== false,
+          fridayStartTime: availData.friday_start_time || '08:00',
+          fridayEndTime: availData.friday_end_time || '17:00',
+          saturdayAvailable: availData.saturday_available || false,
+          saturdayStartTime: availData.saturday_start_time || '08:00',
+          saturdayEndTime: availData.saturday_end_time || '17:00',
+          sundayAvailable: availData.sunday_available || false,
+          sundayStartTime: availData.sunday_start_time || '08:00',
+          sundayEndTime: availData.sunday_end_time || '17:00',
+        });
+        setAvailability(availData);
+      }
+
+      setBlackoutDates(Array.isArray(blackoutData) ? blackoutData : []);
+    } catch (error) {
+      console.error('Failed to load availability:', error);
+    }
+  };
+
+  const handleSaveAvailability = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${selectedCaregiverId}/availability`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) throw new Error('Failed to save availability');
+
+      setMessage('Availability updated successfully!');
+      setTimeout(() => setMessage(''), 2000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleAddBlackoutDate = async (e) => {
+    e.preventDefault();
+    
+    if (!newBlackoutDate.startDate || !newBlackoutDate.endDate) {
+      setMessage('Start and end dates are required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${selectedCaregiverId}/blackout-dates`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(newBlackoutDate)
+      });
+
+      if (!response.ok) throw new Error('Failed to add blackout date');
+
+      setMessage('Blackout date added');
+      setTimeout(() => setMessage(''), 2000);
+      setNewBlackoutDate({ startDate: '', endDate: '', reason: '' });
+      setShowBlackoutForm(false);
+      handleCaregiverSelect(selectedCaregiverId);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeleteBlackoutDate = async (dateId) => {
+    if (!window.confirm('Delete this blackout date?')) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/blackout-dates/${dateId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Blackout date deleted');
+      setTimeout(() => setMessage(''), 2000);
+      handleCaregiverSelect(selectedCaregiverId);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const getCaregiverName = (caregiverId) => {
+    const cg = caregivers.find(c => c.id === caregiverId);
+    return cg ? `${cg.first_name} ${cg.last_name}` : '';
+  };
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Caregiver Availability Management</h2>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Caregiver Selection */}
+      <div className="card">
+        <h3>Select Caregiver</h3>
+        <select
+          value={selectedCaregiverId}
+          onChange={(e) => handleCaregiverSelect(e.target.value)}
+          style={{ width: '100%', padding: '0.75rem', fontSize: '1rem', borderRadius: '4px', border: '1px solid #ddd' }}
+        >
+          <option value="">Select a caregiver...</option>
+          {caregivers.map(cg => (
+            <option key={cg.id} value={cg.id}>
+              {cg.first_name} {cg.last_name}
+            </option>
+          ))}
+        </select>
+      </div>
+
+      {selectedCaregiverId && (
+        <>
+          {/* Status and Max Hours */}
+          <div className="card">
+            <h3>Status & Capacity</h3>
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Employment Status</label>
+                <select
+                  value={formData.status}
+                  onChange={(e) => setFormData({ ...formData, status: e.target.value })}
+                >
+                  <option value="available">Available</option>
+                  <option value="on_call">On-Call</option>
+                  <option value="medical_leave">Medical Leave</option>
+                  <option value="vacation">Vacation</option>
+                  <option value="unavailable">Unavailable</option>
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Maximum Hours Per Week</label>
+                <input
+                  type="number"
+                  value={formData.maxHoursPerWeek}
+                  onChange={(e) => setFormData({ ...formData, maxHoursPerWeek: parseInt(e.target.value) })}
+                  min="0"
+                  step="5"
+                />
+              </div>
+            </div>
+          </div>
+
+          {/* Weekly Availability */}
+          <div className="card">
+            <h3>Weekly Availability</h3>
+            <p style={{ color: '#666', marginBottom: '1rem' }}>
+              Set the days and hours {getCaregiverName(selectedCaregiverId)} is available each week
+            </p>
+
+            <div style={{ display: 'grid', gap: '1rem' }}>
+              {days.map(day => {
+                const availKey = `${day.key}Available`;
+                const startKey = `${day.key}StartTime`;
+                const endKey = `${day.key}EndTime`;
+
+                return (
+                  <div key={day.key} style={{ padding: '1rem', background: '#f9f9f9', borderRadius: '4px' }}>
+                    <label style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+                      <input
+                        type="checkbox"
+                        checked={formData[availKey]}
+                        onChange={(e) => setFormData({ ...formData, [availKey]: e.target.checked })}
+                        style={{ cursor: 'pointer' }}
+                      />
+                      <strong style={{ flex: 1 }}>{day.label}</strong>
+                    </label>
+
+                    {formData[availKey] && (
+                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginLeft: '1.5rem' }}>
+                        <div className="form-group">
+                          <label>Start Time</label>
+                          <input
+                            type="time"
+                            value={formData[startKey]}
+                            onChange={(e) => setFormData({ ...formData, [startKey]: e.target.value })}
+                          />
+                        </div>
+                        <div className="form-group">
+                          <label>End Time</label>
+                          <input
+                            type="time"
+                            value={formData[endKey]}
+                            onChange={(e) => setFormData({ ...formData, [endKey]: e.target.value })}
+                          />
+                        </div>
+                      </div>
+                    )}
+                  </div>
+                );
+              })}
+            </div>
+
+            <button
+              className="btn btn-primary"
+              onClick={handleSaveAvailability}
+              style={{ marginTop: '1.5rem' }}
+            >
+              Save Availability
+            </button>
+          </div>
+
+          {/* Blackout Dates */}
+          <div className="card">
+            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #ddd' }}>
+              <h3 style={{ margin: 0 }}>Blackout Dates (Unavailable)</h3>
+              <button
+                className="btn btn-sm btn-primary"
+                onClick={() => setShowBlackoutForm(!showBlackoutForm)}
+              >
+                {showBlackoutForm ? 'Cancel' : 'Add Blackout'}
+              </button>
+            </div>
+
+            {showBlackoutForm && (
+              <form onSubmit={handleAddBlackoutDate} style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+                <div className="form-grid-2">
+                  <div className="form-group">
+                    <label>Start Date *</label>
+                    <input
+                      type="date"
+                      value={newBlackoutDate.startDate}
+                      onChange={(e) => setNewBlackoutDate({ ...newBlackoutDate, startDate: e.target.value })}
+                      required
+                    />
+                  </div>
+
+                  <div className="form-group">
+                    <label>End Date *</label>
+                    <input
+                      type="date"
+                      value={newBlackoutDate.endDate}
+                      onChange={(e) => setNewBlackoutDate({ ...newBlackoutDate, endDate: e.target.value })}
+                      required
+                    />
+                  </div>
+
+                  <div className="form-group" style={{ gridColumn: '1 / -1' }}>
+                    <label>Reason</label>
+                    <input
+                      type="text"
+                      value={newBlackoutDate.reason}
+                      onChange={(e) => setNewBlackoutDate({ ...newBlackoutDate, reason: e.target.value })}
+                      placeholder="e.g., Vacation, Medical, Conference"
+                    />
+                  </div>
+                </div>
+
+                <div className="form-actions">
+                  <button type="submit" className="btn btn-primary">Add Blackout Date</button>
+                  <button type="button" className="btn btn-secondary" onClick={() => setShowBlackoutForm(false)}>Cancel</button>
+                </div>
+              </form>
+            )}
+
+            {blackoutDates.length === 0 ? (
+              <p style={{ color: '#999', textAlign: 'center', padding: '1rem' }}>
+                No blackout dates scheduled.
+              </p>
+            ) : (
+              <div style={{ display: 'grid', gap: '0.75rem' }}>
+                {blackoutDates
+                  .sort((a, b) => new Date(a.start_date) - new Date(b.start_date))
+                  .map(bd => (
+                    <div
+                      key={bd.id}
+                      style={{
+                        padding: '0.75rem',
+                        background: '#ffe6e6',
+                        borderLeft: '4px solid #d32f2f',
+                        borderRadius: '4px',
+                        display: 'flex',
+                        justifyContent: 'space-between',
+                        alignItems: 'center'
+                      }}
+                    >
+                      <div>
+                        <strong>{new Date(bd.start_date).toLocaleDateString()} - {new Date(bd.end_date).toLocaleDateString()}</strong>
+                        {bd.reason && <div style={{ fontSize: '0.9rem', color: '#666' }}>{bd.reason}</div>}
+                      </div>
+                      <button
+                        className="btn btn-sm btn-danger"
+                        onClick={() => handleDeleteBlackoutDate(bd.id)}
+                      >
+                        Delete
+                      </button>
+                    </div>
+                  ))}
+              </div>
+            )}
+          </div>
+        </>
+      )}
+    </div>
+  );
+};
+
+export default CaregiverAvailability;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CaregiverDetail.jsx b/templates/crm-homecare/frontend/src/components/admin/CaregiverDetail.jsx
new file mode 100644
index 0000000..bea9d8f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CaregiverDetail.jsx
@@ -0,0 +1,819 @@
+// src/components/admin/CaregiverDetail.jsx
+// Complete caregiver record: edit all info, hours, earnings, schedule, background checks
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+const fmt$ = (n) => n != null ? `$${parseFloat(n||0).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,',')}` : '—';
+const fmtHrs = (n) => n != null ? `${parseFloat(n||0).toFixed(2)}h` : '—';
+const fmtDate = (d) => d ? new Date(d).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : '—';
+const fmtDateTime = (d) => d ? new Date(d).toLocaleString('en-US',{month:'short',day:'numeric',hour:'numeric',minute:'2-digit'}) : '—';
+const DAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
+
+const s = {
+  page: { maxWidth: 960, margin: '0 auto', fontFamily: "'DM Sans', system-ui, sans-serif" },
+  header: { background: 'linear-gradient(135deg, #0F172A 0%, #1E293B 100%)', borderRadius: 16, padding: '1.75rem 2rem', marginBottom: '1.25rem', color: '#fff', position: 'relative', overflow: 'hidden' },
+  headerAccent: { position: 'absolute', right: -40, top: -40, width: 220, height: 220, borderRadius: '50%', background: 'rgba(42,187,167,0.12)', pointerEvents: 'none' },
+  avatar: { width: 64, height: 64, borderRadius: '50%', background: 'linear-gradient(135deg,#2ABBA7,#0891B2)', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.5rem', fontWeight: 800, color: '#fff', flexShrink: 0 },
+  tab: (active) => ({ padding: '0.55rem 1.1rem', border: 'none', background: 'none', cursor: 'pointer', fontWeight: active ? 800 : 500, fontSize: '0.85rem', color: active ? '#2ABBA7' : '#6B7280', borderBottom: `2px solid ${active ? '#2ABBA7' : 'transparent'}`, marginBottom: -2, whiteSpace: 'nowrap', transition: 'all 0.15s' }),
+  card: { background: '#fff', borderRadius: 14, border: '1px solid #E5E7EB', padding: '1.25rem', marginBottom: '1rem' },
+  label: { display: 'block', fontWeight: 700, fontSize: '0.75rem', color: '#6B7280', marginBottom: 4, textTransform: 'uppercase', letterSpacing: '0.04em' },
+  input: { width: '100%', padding: '0.55rem 0.75rem', border: '1px solid #D1D5DB', borderRadius: 8, fontSize: '0.875rem', boxSizing: 'border-box', background: '#fff', outline: 'none', transition: 'border-color 0.15s' },
+  btn: (color='#2ABBA7', outline=false) => ({ padding: '0.55rem 1.25rem', background: outline?'#fff':color, color: outline?color:'#fff', border: outline?`2px solid ${color}`:'none', borderRadius: 8, cursor: 'pointer', fontWeight: 700, fontSize: '0.85rem' }),
+  statBox: (accent='#2ABBA7') => ({ padding: '1rem', background: '#F9FAFB', borderRadius: 12, borderLeft: `4px solid ${accent}`, flex: 1, minWidth: 120 }),
+  badge: (color='#2ABBA7', bg='#D1FAE5') => ({ padding: '2px 10px', borderRadius: 99, fontSize: '0.72rem', fontWeight: 700, color, background: bg }),
+};
+
+const TABS = [
+  { id: 'overview', label: '📊 Overview' },
+  { id: 'personal', label: '👤 Personal Info' },
+  { id: 'schedule', label: '📅 Schedule' },
+  { id: 'shifts', label: '🕐 Shifts' },
+  { id: 'gpsmap', label: '🗺️ GPS Map' },
+  { id: 'background', label: '🔍 Background Check' },
+  { id: 'evv', label: '📍 EVV / Geofence' },
+];
+
+export default function CaregiverDetail({ caregiverId, token, onBack, onHireComplete }) {
+  const [tab, setTab] = useState('overview');
+  const [data, setData] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [saving, setSaving] = useState(false);
+  const [editing, setEditing] = useState(false);
+  const [bgChecks, setBgChecks] = useState([]);
+  const [payers, setPayers] = useState([]);
+
+  // Edit form state
+  const [form, setForm] = useState({});
+  const [bgForm, setBgForm] = useState({ checkType: 'criminal', provider: '', cost: '', notes: '', status: 'pending' });
+  const [showBgForm, setShowBgForm] = useState(false);
+  const [geocoding, setGeocoding] = useState(false);
+  const [shiftFilter, setShiftFilter] = useState({ start: '', end: '' });
+  const [allShifts, setAllShifts] = useState(null);
+  const [gpsData, setGpsData] = useState(null);
+  const [gpsLoading, setGpsLoading] = useState(false);
+  const [selectedShift, setSelectedShift] = useState(null);
+
+  const hdr = { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' };
+
+  const load = useCallback(async () => {
+    setLoading(true);
+    try {
+      const [sumRes, bgRes, profRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/summary`, { headers: hdr }),
+        fetch(`${API_BASE_URL}/api/background-checks/caregiver/${caregiverId}`, { headers: hdr }),
+        fetch(`${API_BASE_URL}/api/caregiver-profile/${caregiverId}`, { headers: hdr }),
+      ]);
+      const sum = sumRes.ok ? await sumRes.json() : {};
+      const bg = bgRes.ok ? await bgRes.json() : [];
+      const prof = profRes.ok ? await profRes.json() : {};
+      setData(sum);
+      setBgChecks(Array.isArray(bg) ? bg : []);
+      // Populate form from profile - merge summary profile + separate profile endpoint
+      const p = sum.profile || {};
+      setForm({
+        firstName: p.first_name || '',
+        lastName: p.last_name || '',
+        email: p.email || '',
+        phone: p.phone || '',
+        payRate: p.default_pay_rate || '',
+        address: p.address || '',
+        city: p.city || '',
+        state: p.state || '',
+        zip: p.zip || '',
+        hireDate: p.hire_date ? p.hire_date.split('T')[0] : '',
+        emergencyContactName: p.emergency_contact_name || '',
+        emergencyContactPhone: p.emergency_contact_phone || '',
+        isActive: p.is_active !== false,
+        notes: p.notes || prof.notes || '',
+        capabilities: p.capabilities || prof.capabilities || '',
+        limitations: p.limitations || prof.limitations || '',
+        npiNumber: p.npi_number || prof.npi_number || '',
+        evvWorkerId: p.evv_worker_id || prof.evv_worker_id || '',
+      });
+    } catch (e) { toast('Failed to load caregiver', 'error'); }
+    setLoading(false);
+  }, [caregiverId]);
+
+  useEffect(() => { load(); }, [load]);
+
+  const save = async () => {
+    setSaving(true);
+    try {
+      const r = await fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}`, {
+        method: 'PUT', headers: hdr,
+        body: JSON.stringify({
+          firstName: form.firstName, lastName: form.lastName, email: form.email,
+          phone: form.phone, payRate: parseFloat(form.payRate) || null,
+          address: form.address, city: form.city, state: form.state, zip: form.zip,
+          hireDate: form.hireDate || null,
+          emergencyContactName: form.emergencyContactName,
+          emergencyContactPhone: form.emergencyContactPhone,
+          isActive: form.isActive,
+        })
+      });
+      // Also save profile notes
+      await fetch(`${API_BASE_URL}/api/caregiver-profile/${caregiverId}`, {
+        method: 'PATCH', headers: hdr,
+        body: JSON.stringify({ notes: form.notes, capabilities: form.capabilities, limitations: form.limitations })
+      });
+      if (r.ok) { toast('Saved successfully', 'success'); setEditing(false); load(); }
+      else { const d = await r.json(); toast(d.error || 'Save failed', 'error'); }
+    } catch (e) { toast('Save failed', 'error'); }
+    setSaving(false);
+  };
+
+  const geocodeAddress = async () => {
+    if (!form.address) return toast('Enter an address first', 'error');
+    setGeocoding(true);
+    try {
+      const r = await fetch(`${API_BASE_URL}/api/route-optimizer/geocode`, {
+        method: 'POST', headers: hdr,
+        body: JSON.stringify({ address: form.address, city: form.city, state: form.state, zip: form.zip, entityType: 'caregiver', entityId: caregiverId })
+      });
+      const d = await r.json();
+      if (r.ok) toast(`📍 Geocoded: ${d.formattedAddress}`, 'success');
+      else toast(d.error || 'Geocoding failed', 'error');
+    } catch(e) { toast('Geocoding failed', 'error'); }
+    setGeocoding(false);
+  };
+
+  const addBgCheck = async () => {
+    try {
+      const r = await fetch(`${API_BASE_URL}/api/background-checks`, {
+        method: 'POST', headers: hdr,
+        body: JSON.stringify({ caregiverId, ...bgForm })
+      });
+      if (r.ok) { toast('Background check added', 'success'); setShowBgForm(false); setBgForm({ checkType: 'criminal', provider: '', cost: '', notes: '', status: 'pending' }); load(); }
+      else { const d = await r.json(); toast(d.error || 'Failed', 'error'); }
+    } catch(e) { toast('Failed', 'error'); }
+  };
+
+  const deactivate = async () => {
+    if (!window.confirm(`${form.isActive ? 'Deactivate' : 'Reactivate'} this caregiver?`)) return;
+    const r = await fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}`, {
+      method: 'PUT', headers: hdr, body: JSON.stringify({ isActive: !form.isActive })
+    });
+    if (r.ok) { toast(`Caregiver ${form.isActive ? 'deactivated' : 'reactivated'}`, 'success'); load(); }
+  };
+
+  const resetPassword = async () => {
+    const newPwd = `CVHC${form.lastName.charAt(0).toUpperCase()}${Math.random().toString(36).slice(-6)}`;
+    const r = await fetch(`${API_BASE_URL}/api/users/${caregiverId}/reset-password`, {
+      method: 'POST', headers: hdr, body: JSON.stringify({ newPassword: newPwd })
+    });
+    if (r.ok) toast(`New temp password: ${newPwd} — send to caregiver`, 'success');
+    else toast('Password reset failed', 'error');
+  };
+
+  if (loading) return <div style={{textAlign:'center',padding:'3rem',color:'#6B7280'}}>Loading caregiver...</div>;
+  if (!data) return <div style={{textAlign:'center',padding:'3rem',color:'#EF4444'}}>Could not load caregiver data.</div>;
+
+  const { profile, earnings, clients, recentShifts, schedule, payRates } = data;
+  const fullName = `${profile?.first_name || ''} ${profile?.last_name || ''}`.trim();
+  const initials = `${(profile?.first_name||'')[0]||''}${(profile?.last_name||'')[0]||''}`.toUpperCase();
+
+  // ── OVERVIEW ─────────────────────────────────────────────────────────────────
+  const renderOverview = () => (
+    <div>
+      <div style={{ display: 'flex', gap: '0.75rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
+        {[
+          { label: 'Hours This Month', val: fmtHrs(earnings?.hours_this_month), accent: '#2ABBA7' },
+          { label: 'Earnings This Month', val: fmt$(earnings?.earnings_this_month), accent: '#6366F1' },
+          { label: 'Hours This Week', val: fmtHrs(earnings?.hours_this_week), accent: '#0891B2' },
+          { label: 'Total Hours (All Time)', val: fmtHrs(earnings?.total_hours), accent: '#F59E0B' },
+          { label: 'Avg Shift', val: fmtHrs(earnings?.avg_shift_hours), accent: '#8B5CF6' },
+        ].map(s2 => (
+          <div key={s2.label} style={s.statBox(s2.accent)}>
+            <div style={{ fontSize: '1.3rem', fontWeight: 800, color: s2.accent }}>{s2.val}</div>
+            <div style={{ fontSize: '0.72rem', color: '#6B7280', marginTop: 2 }}>{s2.label}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* Clients served */}
+      <div style={s.card}>
+        <div style={{ fontWeight: 800, marginBottom: '0.75rem', fontSize: '0.9rem' }}>🧑‍🤝‍🧑 Clients Served ({clients?.length || 0})</div>
+        {clients?.length > 0 ? (
+          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill,minmax(220px,1fr))', gap: '0.6rem' }}>
+            {clients.map(c => (
+              <div key={c.id} style={{ padding: '0.75rem', background: '#F9FAFB', borderRadius: 10, border: '1px solid #E5E7EB' }}>
+                <div style={{ fontWeight: 700, fontSize: '0.875rem' }}>{c.first_name} {c.last_name}</div>
+                <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{c.address}, {c.city}</div>
+                <div style={{ fontSize: '0.78rem', color: '#374151', marginTop: 4 }}>
+                  {c.shift_count} shifts · {fmtHrs(c.total_hours)} · Last: {fmtDate(c.last_visit)}
+                </div>
+              </div>
+            ))}
+          </div>
+        ) : <p style={{ color: '#9CA3AF', fontSize: '0.875rem' }}>No completed shifts yet.</p>}
+      </div>
+
+      {/* Recent shifts */}
+      <div style={s.card}>
+        <div style={{ fontWeight: 800, marginBottom: '0.75rem', fontSize: '0.9rem' }}>🕐 Recent Shifts</div>
+        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.82rem' }}>
+          <thead>
+            <tr style={{ background: '#F9FAFB' }}>
+              {['Client', 'Date', 'Start', 'End', 'Hours', 'Status'].map(h => (
+                <th key={h} style={{ padding: '0.4rem 0.75rem', textAlign: 'left', fontWeight: 700, color: '#374151', borderBottom: '1px solid #E5E7EB' }}>{h}</th>
+              ))}
+            </tr>
+          </thead>
+          <tbody>
+            {recentShifts?.map(sh => (
+              <tr key={sh.id} style={{ borderBottom: '1px solid #F3F4F6' }}>
+                <td style={{ padding: '0.4rem 0.75rem', fontWeight: 600 }}>{sh.client_first} {sh.client_last}</td>
+                <td style={{ padding: '0.4rem 0.75rem', color: '#6B7280' }}>{fmtDate(sh.start_time)}</td>
+                <td style={{ padding: '0.4rem 0.75rem' }}>{new Date(sh.start_time).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'})}</td>
+                <td style={{ padding: '0.4rem 0.75rem' }}>{sh.end_time ? new Date(sh.end_time).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'}) : '—'}</td>
+                <td style={{ padding: '0.4rem 0.75rem', fontWeight: 700 }}>{sh.hours ? fmtHrs(sh.hours) : '—'}</td>
+                <td style={{ padding: '0.4rem 0.75rem' }}>
+                  <span style={s.badge(sh.is_complete?'#065F46':'#92400E', sh.is_complete?'#D1FAE5':'#FEF3C7')}>
+                    {sh.is_complete ? 'Complete' : 'Active'}
+                  </span>
+                </td>
+              </tr>
+            ))}
+            {!recentShifts?.length && <tr><td colSpan={6} style={{ padding: '1.5rem', textAlign: 'center', color: '#9CA3AF' }}>No shifts yet</td></tr>}
+          </tbody>
+        </table>
+      </div>
+
+      {/* Upcoming schedule */}
+      <div style={s.card}>
+        <div style={{ fontWeight: 800, marginBottom: '0.75rem', fontSize: '0.9rem' }}>📅 Upcoming Schedule ({schedule?.length || 0} shifts)</div>
+        {schedule?.length > 0 ? (
+          <div style={{ display: 'grid', gap: '0.4rem' }}>
+            {[...schedule].sort((a,b) => {
+              // Sort recurring (day_of_week) first by day, then one-time by date
+              if (a.day_of_week != null && b.day_of_week != null) return a.day_of_week - b.day_of_week;
+              if (a.day_of_week != null) return -1;
+              if (b.day_of_week != null) return 1;
+              return new Date(a.date) - new Date(b.date);
+            }).map(sc => (
+              <div key={sc.id} style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '0.6rem 0.75rem', background: sc.day_of_week != null ? '#EFF6FF' : '#F0FDFB', borderRadius: 8, border: `1px solid ${sc.day_of_week != null ? '#BFDBFE' : '#A7F3D0'}` }}>
+                <div style={{ fontWeight: 700, fontSize: '0.82rem', minWidth: 80, color: sc.day_of_week != null ? '#1D4ED8' : '#065F46' }}>
+                  {sc.day_of_week != null
+                    ? <span style={{padding:'0.15rem 0.5rem', background:'#DBEAFE', borderRadius:5}}>{DAYS[sc.day_of_week]} (weekly)</span>
+                    : fmtDate(sc.date)
+                  }
+                </div>
+                <div style={{ fontSize: '0.82rem', color: '#374151', fontWeight:600 }}>{sc.start_time?.slice(0,5)} – {sc.end_time?.slice(0,5)}</div>
+                <div style={{ fontSize: '0.82rem', fontWeight: 700 }}>{sc.client_first} {sc.client_last}</div>
+                {sc.shift_hours && <span style={{ fontSize: '0.72rem', color: '#059669', marginLeft:'auto' }}>{sc.shift_hours}h</span>}
+              </div>
+            ))}
+          </div>
+        ) : <p style={{ color: '#9CA3AF', fontSize: '0.875rem' }}>No upcoming shifts scheduled.</p>}
+      </div>
+    </div>
+  );
+
+  // ── PERSONAL INFO ─────────────────────────────────────────────────────────────
+  const F = ({ label, field, type='text', half=false }) => (
+    <div style={{ gridColumn: half ? 'span 1' : 'span 1' }}>
+      <label style={s.label}>{label}</label>
+      {editing ? (
+        <input
+          type={type}
+          value={form[field] ?? ''}
+          onChange={e => setForm(p => ({ ...p, [field]: type === 'checkbox' ? e.target.checked : e.target.value }))}
+          style={s.input}
+        />
+      ) : (
+        <div style={{ padding: '0.55rem 0', fontSize: '0.875rem', color: form[field] ? '#111827' : '#9CA3AF', borderBottom: '1px solid #F3F4F6' }}>
+          {form[field] || '—'}
+        </div>
+      )}
+    </div>
+  );
+
+  const renderPersonal = () => (
+    <div>
+      <div style={{ ...s.card }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem' }}>
+          <div style={{ fontWeight: 800, fontSize: '0.95rem' }}>Personal Information</div>
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            {editing ? (
+              <>
+                <button style={s.btn()} onClick={save} disabled={saving}>{saving ? 'Saving...' : '💾 Save'}</button>
+                <button style={s.btn('#6B7280', true)} onClick={() => { setEditing(false); load(); }}>Cancel</button>
+              </>
+            ) : (
+              <button style={s.btn()} onClick={() => setEditing(true)}>✏️ Edit All</button>
+            )}
+          </div>
+        </div>
+
+        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+          <F label="First Name" field="firstName" />
+          <F label="Last Name" field="lastName" />
+          <F label="Email Address" field="email" type="email" />
+          <F label="Phone" field="phone" type="tel" />
+          <F label="Hourly Pay Rate ($)" field="payRate" type="number" />
+          <F label="Hire Date" field="hireDate" type="date" />
+          <F label="Address" field="address" />
+          <F label="City" field="city" />
+          <F label="State" field="state" half />
+          <F label="Zip" field="zip" half />
+          <F label="Emergency Contact Name" field="emergencyContactName" />
+          <F label="Emergency Contact Phone" field="emergencyContactPhone" type="tel" />
+        </div>
+
+        {editing && (
+          <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #F3F4F6' }}>
+            <button style={{ ...s.btn('#6366F1'), marginRight: '0.5rem' }} onClick={geocodeAddress} disabled={geocoding}>
+              {geocoding ? '📍 Geocoding...' : '📍 Geocode Address (for GPS clock-in)'}
+            </button>
+            <span style={{ fontSize: '0.78rem', color: '#6B7280' }}>Sets GPS coordinates so geofence auto clock-in works</span>
+          </div>
+        )}
+      </div>
+
+      {/* Profile notes */}
+      <div style={s.card}>
+        <div style={{ fontWeight: 800, fontSize: '0.95rem', marginBottom: '1rem' }}>Professional Details</div>
+        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+          <F label="NPI Number (billing)" field="npiNumber" />
+          <F label="EVV Worker ID (Sandata)" field="evvWorkerId" />
+          <div style={{ gridColumn: 'span 2' }}>
+            <label style={s.label}>Capabilities / Skills</label>
+            {editing ? <textarea value={form.capabilities} onChange={e=>setForm(p=>({...p,capabilities:e.target.value}))} style={{...s.input, minHeight:80, resize:'vertical'}} /> : <div style={{padding:'0.55rem 0',fontSize:'0.875rem',color:form.capabilities?'#111827':'#9CA3AF'}}>{form.capabilities||'—'}</div>}
+          </div>
+          <div style={{ gridColumn: 'span 2' }}>
+            <label style={s.label}>Limitations / Notes</label>
+            {editing ? <textarea value={form.limitations} onChange={e=>setForm(p=>({...p,limitations:e.target.value}))} style={{...s.input, minHeight:60, resize:'vertical'}} /> : <div style={{padding:'0.55rem 0',fontSize:'0.875rem',color:form.limitations?'#111827':'#9CA3AF'}}>{form.limitations||'—'}</div>}
+          </div>
+        </div>
+      </div>
+
+      {/* Status & account */}
+      <div style={s.card}>
+        <div style={{ fontWeight: 800, fontSize: '0.95rem', marginBottom: '1rem' }}>Account Actions</div>
+        <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap' }}>
+          <button style={s.btn(form.isActive ? '#EF4444' : '#2ABBA7', true)} onClick={deactivate}>
+            {form.isActive ? '🔴 Deactivate' : '🟢 Reactivate'}
+          </button>
+          <button style={s.btn('#6366F1', true)} onClick={resetPassword}>🔑 Reset Password</button>
+        </div>
+        <p style={{ fontSize: '0.78rem', color: '#9CA3AF', marginTop: '0.5rem' }}>
+          Member since {fmtDate(profile?.created_at)} · Hire date: {fmtDate(profile?.hire_date) || 'not set'}
+        </p>
+      </div>
+
+      {/* Pay rate history */}
+      {payRates?.length > 0 && (
+        <div style={s.card}>
+          <div style={{ fontWeight: 800, fontSize: '0.95rem', marginBottom: '0.75rem' }}>💰 Pay Rate History</div>
+          <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.82rem' }}>
+            <thead><tr style={{background:'#F9FAFB'}}>{['Rate','Effective Date','Notes'].map(h=><th key={h} style={{padding:'0.4rem 0.75rem',textAlign:'left',fontWeight:700,borderBottom:'1px solid #E5E7EB'}}>{h}</th>)}</tr></thead>
+            <tbody>{payRates.map(r=><tr key={r.id} style={{borderBottom:'1px solid #F3F4F6'}}><td style={{padding:'0.4rem 0.75rem',fontWeight:700,color:'#2ABBA7'}}>{fmt$(r.rate)}</td><td style={{padding:'0.4rem 0.75rem',color:'#6B7280'}}>{fmtDate(r.effective_date)}</td><td style={{padding:'0.4rem 0.75rem',color:'#374151'}}>{r.notes||'—'}</td></tr>)}</tbody>
+          </table>
+        </div>
+      )}
+    </div>
+  );
+
+  // ── SCHEDULE TAB ──────────────────────────────────────────────────────────────
+  const renderSchedule = () => {
+    const recurring = schedule?.filter(sc => sc.day_of_week != null) || [];
+    const oneTime   = schedule?.filter(sc => sc.day_of_week == null && sc.date) || [];
+    return (
+      <div>
+        {/* Recurring schedules */}
+        <div style={s.card}>
+          <div style={{ fontWeight: 800, fontSize: '0.95rem', marginBottom: '1rem' }}>🔁 Recurring Weekly Schedule ({recurring.length} shifts)</div>
+          {recurring.length > 0 ? (
+            <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.82rem' }}>
+              <thead><tr style={{background:'#F9FAFB'}}>{['Day','Time','Hours','Client','Location','Notes'].map(h=><th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:700,color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>)}</tr></thead>
+              <tbody>
+                {recurring.sort((a,b) => a.day_of_week - b.day_of_week).map(sc => (
+                  <tr key={sc.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem'}}>
+                      <span style={{padding:'0.2rem 0.6rem',borderRadius:6,background:'#DBEAFE',color:'#1E40AF',fontWeight:700,fontSize:'0.82rem'}}>
+                        {DAYS[sc.day_of_week]}
+                      </span>
+                    </td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:600}}>{sc.start_time?.slice(0,5)} – {sc.end_time?.slice(0,5)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#059669',fontWeight:700}}>{sc.shift_hours ? `${sc.shift_hours}h` : '—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:600}}>{sc.client_first} {sc.client_last}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280',fontSize:'0.78rem'}}>{sc.client_address ? `${sc.client_address}, ${sc.client_city||''}` : '—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#374151'}}>{sc.notes||'—'}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          ) : <p style={{color:'#9CA3AF',fontSize:'0.875rem'}}>No recurring schedule assigned yet.</p>}
+        </div>
+        {/* One-time upcoming */}
+        <div style={s.card}>
+          <div style={{ fontWeight: 800, fontSize: '0.95rem', marginBottom: '1rem' }}>📅 Upcoming One-Time Shifts ({oneTime.length})</div>
+          {oneTime.length > 0 ? (
+            <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.82rem' }}>
+              <thead><tr style={{background:'#F9FAFB'}}>{['Date','Day','Time','Client','Notes'].map(h=><th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:700,color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>)}</tr></thead>
+              <tbody>
+                {oneTime.map(sc => (
+                  <tr key={sc.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:600}}>{fmtDate(sc.date)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{sc.date ? DAYS[new Date(sc.date+'T12:00:00').getDay()] : '—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>{sc.start_time?.slice(0,5)} – {sc.end_time?.slice(0,5)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:600}}>{sc.client_first} {sc.client_last}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#374151'}}>{sc.notes||'—'}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          ) : <p style={{color:'#9CA3AF',fontSize:'0.875rem'}}>No upcoming one-time shifts.</p>}
+        </div>
+      </div>
+    );
+  };
+
+  // ── SHIFTS TAB ─────────────────────────────────────────────────────────────────
+  const loadShifts = async () => {
+    const params = new URLSearchParams();
+    if (shiftFilter.start) params.set('startDate', shiftFilter.start + 'T00:00:00');
+    if (shiftFilter.end) params.set('endDate', shiftFilter.end + 'T23:59:59');
+    params.set('limit', '100');
+    const r = await fetch(`${API_BASE_URL}/api/time-entries/caregiver-history/${caregiverId}?${params}`, { headers: hdr });
+    if (r.ok) setAllShifts(await r.json());
+  };
+
+  const renderShifts = () => {
+    const shifts = allShifts || recentShifts || [];
+    const totalHrs = shifts.filter(s=>s.is_complete).reduce((sum,s)=>sum+parseFloat(s.hours||0),0);
+    const totalEarn = totalHrs * parseFloat(profile?.default_pay_rate || 0);
+    return (
+      <div>
+        <div style={{...s.card, display:'flex', gap:'0.75rem', alignItems:'flex-end', flexWrap:'wrap'}}>
+          <div><label style={s.label}>From</label><input type="date" value={shiftFilter.start} onChange={e=>setShiftFilter(p=>({...p,start:e.target.value}))} style={{...s.input,width:'auto'}}/></div>
+          <div><label style={s.label}>To</label><input type="date" value={shiftFilter.end} onChange={e=>setShiftFilter(p=>({...p,end:e.target.value}))} style={{...s.input,width:'auto'}}/></div>
+          <button style={s.btn()} onClick={loadShifts}>Search</button>
+          {allShifts && <button style={s.btn('#6B7280',true)} onClick={()=>setAllShifts(null)}>Clear</button>}
+        </div>
+        {allShifts && (
+          <div style={{display:'flex',gap:'0.75rem',marginBottom:'1rem',flexWrap:'wrap'}}>
+            <div style={s.statBox('#2ABBA7')}><div style={{fontSize:'1.2rem',fontWeight:800,color:'#2ABBA7'}}>{fmtHrs(totalHrs)}</div><div style={{fontSize:'0.72rem',color:'#6B7280'}}>Hours in Period</div></div>
+            <div style={s.statBox('#6366F1')}><div style={{fontSize:'1.2rem',fontWeight:800,color:'#6366F1'}}>{fmt$(totalEarn)}</div><div style={{fontSize:'0.72rem',color:'#6B7280'}}>Est. Earnings</div></div>
+            <div style={s.statBox('#F59E0B')}><div style={{fontSize:'1.2rem',fontWeight:800,color:'#F59E0B'}}>{shifts.length}</div><div style={{fontSize:'0.72rem',color:'#6B7280'}}>Total Shifts</div></div>
+          </div>
+        )}
+        <div style={s.card}>
+          <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+            <thead><tr style={{background:'#F9FAFB'}}>{['Client','Date','Start','End','Hours','Est. Pay','GPS','Status'].map(h=><th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:700,color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>)}</tr></thead>
+            <tbody>
+              {shifts.map(sh=>(
+                <tr key={sh.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                  <td style={{padding:'0.5rem 0.75rem',fontWeight:600}}>{sh.client_first_name||sh.client_first} {sh.client_last_name||sh.client_last}</td>
+                  <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{fmtDate(sh.start_time)}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{new Date(sh.start_time).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'})}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{sh.end_time?new Date(sh.end_time).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'}):'Active'}</td>
+                  <td style={{padding:'0.5rem 0.75rem',fontWeight:700}}>{sh.hours||sh.duration_hours?fmtHrs(sh.hours||sh.duration_hours):'—'}</td>
+                  <td style={{padding:'0.5rem 0.75rem',color:'#2ABBA7'}}>{sh.hours&&profile?.default_pay_rate?fmt$(parseFloat(sh.hours)*parseFloat(profile.default_pay_rate)):'—'}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{parseInt(sh.gps_point_count||0)>0?`✅ ${sh.gps_point_count} pts`:'⚠️ No GPS'}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}><span style={s.badge(sh.is_complete?'#065F46':'#92400E',sh.is_complete?'#D1FAE5':'#FEF3C7')}>{sh.is_complete?'Complete':'Active'}</span></td>
+                </tr>
+              ))}
+              {!shifts.length&&<tr><td colSpan={8} style={{padding:'2rem',textAlign:'center',color:'#9CA3AF'}}>{allShifts?'No shifts in this date range':'Showing last 10 shifts — use search to filter'}</td></tr>}
+            </tbody>
+          </table>
+        </div>
+      </div>
+    );
+  };
+
+  // ── GPS MAP TAB ───────────────────────────────────────────────────────────────
+  const loadGpsData = async () => {
+    setGpsLoading(true);
+    try {
+      const r = await fetch(`${API_BASE_URL}/api/time-entries/caregiver-gps/${caregiverId}?limit=30`, { headers: hdr });
+      if (r.ok) { const d = await r.json(); setGpsData(d); if (d.length > 0) setSelectedShift(d[0]); }
+    } catch(e) { console.error(e); }
+    setGpsLoading(false);
+  };
+
+  const renderGpsMap = () => {
+    // Load data on first open
+    if (!gpsData && !gpsLoading) loadGpsData();
+
+    const shift = selectedShift;
+    const fmtTs = (ts) => ts ? new Date(ts).toLocaleString('en-US',{month:'short',day:'numeric',hour:'numeric',minute:'2-digit'}) : '—';
+    const fmtCoord = (n) => n != null ? parseFloat(n).toFixed(5) : '—';
+
+    return (
+      <div>
+        {gpsLoading && <div style={{textAlign:'center',padding:'2rem',color:'#6B7280'}}>⏳ Loading GPS data...</div>}
+
+        {gpsData && gpsData.length === 0 && (
+          <div style={{...s.card, textAlign:'center', padding:'2rem', color:'#9CA3AF'}}>
+            No GPS data recorded yet for this caregiver.
+          </div>
+        )}
+
+        {gpsData && gpsData.length > 0 && (
+          <div style={{display:'grid', gridTemplateColumns:'280px 1fr', gap:'1rem', alignItems:'start'}}>
+
+            {/* Shift list */}
+            <div style={{...s.card, padding:'0.75rem', maxHeight:600, overflowY:'auto'}}>
+              <div style={{fontWeight:800, fontSize:'0.85rem', marginBottom:'0.75rem', color:'#374151'}}>
+                📋 Recent Shifts ({gpsData.length})
+              </div>
+              {gpsData.map(sh => (
+                <div key={sh.id}
+                  onClick={() => setSelectedShift(sh)}
+                  style={{
+                    padding:'0.6rem 0.75rem', borderRadius:8, marginBottom:'0.4rem', cursor:'pointer',
+                    background: selectedShift?.id === sh.id ? '#DBEAFE' : '#F9FAFB',
+                    border: `1.5px solid ${selectedShift?.id === sh.id ? '#3B82F6' : '#E5E7EB'}`,
+                  }}>
+                  <div style={{fontWeight:700, fontSize:'0.82rem'}}>{sh.client_first} {sh.client_last}</div>
+                  <div style={{fontSize:'0.72rem', color:'#6B7280'}}>{fmtTs(sh.start_time)}</div>
+                  <div style={{display:'flex', gap:'0.4rem', marginTop:'0.2rem', flexWrap:'wrap'}}>
+                    <span style={{fontSize:'0.68rem', padding:'0.1rem 0.35rem', borderRadius:4,
+                      background: sh.is_complete ? '#D1FAE5' : '#FEF3C7',
+                      color: sh.is_complete ? '#065F46' : '#92400E', fontWeight:700}}>
+                      {sh.is_complete ? '✓ Complete' : '● Active'}
+                    </span>
+                    <span style={{fontSize:'0.68rem', color:'#6B7280'}}>
+                      {sh.hours ? `${sh.hours}h` : '—'}
+                    </span>
+                    {sh.gpsTrail?.length > 0 && (
+                      <span style={{fontSize:'0.68rem', color:'#2563EB'}}>📍 {sh.gpsTrail.length} pts</span>
+                    )}
+                  </div>
+                </div>
+              ))}
+            </div>
+
+            {/* Shift detail panel */}
+            {shift && (
+              <div>
+                {/* Clock in/out header */}
+                <div style={{...s.card, marginBottom:'0.75rem'}}>
+                  <div style={{fontWeight:800, fontSize:'0.95rem', marginBottom:'0.75rem'}}>
+                    🕐 {shift.client_first} {shift.client_last} — {fmtTs(shift.start_time)}
+                  </div>
+                  <div style={{display:'grid', gridTemplateColumns:'1fr 1fr', gap:'0.75rem'}}>
+                    {/* Clock In */}
+                    <div style={{padding:'0.75rem', background:'#F0FDF4', borderRadius:10, border:'1px solid #A7F3D0'}}>
+                      <div style={{fontWeight:700, color:'#059669', marginBottom:'0.4rem', fontSize:'0.85rem'}}>🟢 Clock In</div>
+                      <div style={{fontSize:'0.82rem', marginBottom:'0.25rem'}}><strong>Time:</strong> {fmtTs(shift.start_time)}</div>
+                      {shift.clock_in_location?.lat != null ? (
+                        <>
+                          <div style={{fontSize:'0.8rem', color:'#374151', marginBottom:'0.15rem'}}>
+                            <strong>GPS:</strong> {fmtCoord(shift.clock_in_location.lat)}, {fmtCoord(shift.clock_in_location.lng)}
+                          </div>
+                          <div style={{fontSize:'0.75rem', color:'#6B7280'}}>
+                            Accuracy: ±{shift.clock_in_location.accuracy || '?'}m
+                          </div>
+                          <a href={`https://www.google.com/maps?q=${shift.clock_in_location.lat},${shift.clock_in_location.lng}`}
+                            target="_blank" rel="noreferrer"
+                            style={{fontSize:'0.75rem', color:'#2563EB', textDecoration:'none', display:'inline-block', marginTop:'0.3rem'}}>
+                            📍 View on Google Maps ↗
+                          </a>
+                        </>
+                      ) : (
+                        <div style={{fontSize:'0.78rem', color:'#9CA3AF'}}>No GPS stamp recorded</div>
+                      )}
+                    </div>
+                    {/* Clock Out */}
+                    <div style={{padding:'0.75rem', background: shift.is_complete ? '#EFF6FF' : '#FFFBEB', borderRadius:10, border:`1px solid ${shift.is_complete ? '#BFDBFE' : '#FDE68A'}`}}>
+                      <div style={{fontWeight:700, color: shift.is_complete ? '#1D4ED8' : '#D97706', marginBottom:'0.4rem', fontSize:'0.85rem'}}>
+                        {shift.is_complete ? '🔵 Clock Out' : '🟡 Still Active'}
+                      </div>
+                      {shift.end_time ? (
+                        <>
+                          <div style={{fontSize:'0.82rem', marginBottom:'0.25rem'}}><strong>Time:</strong> {fmtTs(shift.end_time)}</div>
+                          {shift.clock_out_location?.lat != null ? (
+                            <>
+                              <div style={{fontSize:'0.8rem', color:'#374151', marginBottom:'0.15rem'}}>
+                                <strong>GPS:</strong> {fmtCoord(shift.clock_out_location.lat)}, {fmtCoord(shift.clock_out_location.lng)}
+                              </div>
+                              <div style={{fontSize:'0.75rem', color:'#6B7280'}}>
+                                Accuracy: ±{shift.clock_out_location.accuracy || '?'}m
+                              </div>
+                              <a href={`https://www.google.com/maps?q=${shift.clock_out_location.lat},${shift.clock_out_location.lng}`}
+                                target="_blank" rel="noreferrer"
+                                style={{fontSize:'0.75rem', color:'#2563EB', textDecoration:'none', display:'inline-block', marginTop:'0.3rem'}}>
+                                📍 View on Google Maps ↗
+                              </a>
+                            </>
+                          ) : (
+                            <div style={{fontSize:'0.78rem', color:'#9CA3AF'}}>No GPS stamp recorded</div>
+                          )}
+                        </>
+                      ) : (
+                        <div style={{fontSize:'0.78rem', color:'#D97706'}}>Still clocked in</div>
+                      )}
+                    </div>
+                  </div>
+                </div>
+
+                {/* GPS Trail */}
+                <div style={s.card}>
+                  <div style={{fontWeight:800, fontSize:'0.9rem', marginBottom:'0.75rem'}}>
+                    📍 GPS Trail ({shift.gpsTrail?.length || 0} points)
+                    {shift.gpsTrail?.length > 0 && (
+                      <a href={`https://www.google.com/maps/dir/${shift.gpsTrail.map(p=>`${p.latitude},${p.longitude}`).join('/')}`}
+                        target="_blank" rel="noreferrer"
+                        style={{marginLeft:'0.75rem', fontSize:'0.75rem', color:'#2563EB', fontWeight:400, textDecoration:'none'}}>
+                        🗺️ View Full Route in Google Maps ↗
+                      </a>
+                    )}
+                  </div>
+                  {shift.gpsTrail?.length > 0 ? (
+                    <div style={{maxHeight:300, overflowY:'auto'}}>
+                      <table style={{width:'100%', borderCollapse:'collapse', fontSize:'0.78rem'}}>
+                        <thead><tr style={{background:'#F9FAFB'}}>
+                          {['#','Time','Latitude','Longitude','Accuracy','Speed'].map(h=>(
+                            <th key={h} style={{padding:'0.4rem 0.6rem',textAlign:'left',fontWeight:700,color:'#6B7280',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+                          ))}
+                        </tr></thead>
+                        <tbody>
+                          {shift.gpsTrail.map((pt, i) => (
+                            <tr key={i} style={{borderBottom:'1px solid #F3F4F6'}}>
+                              <td style={{padding:'0.35rem 0.6rem',color:'#9CA3AF'}}>{i+1}</td>
+                              <td style={{padding:'0.35rem 0.6rem',fontWeight:600}}>{fmtTs(pt.timestamp)}</td>
+                              <td style={{padding:'0.35rem 0.6rem'}}>{fmtCoord(pt.latitude)}</td>
+                              <td style={{padding:'0.35rem 0.6rem'}}>{fmtCoord(pt.longitude)}</td>
+                              <td style={{padding:'0.35rem 0.6rem',color:'#6B7280'}}>±{pt.accuracy||'?'}m</td>
+                              <td style={{padding:'0.35rem 0.6rem',color:'#6B7280'}}>{pt.speed != null ? `${pt.speed} mph` : '—'}</td>
+                            </tr>
+                          ))}
+                        </tbody>
+                      </table>
+                    </div>
+                  ) : (
+                    <div style={{color:'#9CA3AF', fontSize:'0.85rem', textAlign:'center', padding:'1rem'}}>
+                      No continuous GPS trail recorded for this shift.<br/>
+                      <span style={{fontSize:'0.78rem'}}>Clock in/out stamps above show start and end locations.</span>
+                    </div>
+                  )}
+                </div>
+              </div>
+            )}
+          </div>
+        )}
+      </div>
+    );
+  };
+
+  // ── BACKGROUND CHECKS ─────────────────────────────────────────────────────────
+  const renderBackground = () => (
+    <div>
+      <div style={{...s.card}}>
+        <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'1rem'}}>
+          <div style={{fontWeight:800,fontSize:'0.95rem'}}>🔍 Background Checks</div>
+          <button style={s.btn()} onClick={()=>setShowBgForm(p=>!p)}>{showBgForm?'Cancel':'+ New Check'}</button>
+        </div>
+
+        {showBgForm && (
+          <div style={{background:'#F9FAFB',borderRadius:10,padding:'1rem',marginBottom:'1rem',display:'grid',gridTemplateColumns:'1fr 1fr',gap:'0.75rem'}}>
+            <div><label style={s.label}>Check Type</label>
+              <select value={bgForm.checkType} onChange={e=>setBgForm(p=>({...p,checkType:e.target.value}))} style={s.input}>
+                <option value="criminal">Criminal Background</option>
+                <option value="sex_offender">Sex Offender Registry</option>
+                <option value="driving">Driving Record (MVR)</option>
+                <option value="drug">Drug Screening</option>
+                <option value="reference">Reference Check</option>
+                <option value="oig">OIG Exclusion Check</option>
+                <option value="worcs">WORCs Registry (Wisconsin)</option>
+                <option value="full">Full Package</option>
+              </select>
+            </div>
+            <div><label style={s.label}>Provider / Vendor</label>
+              <input value={bgForm.provider} onChange={e=>setBgForm(p=>({...p,provider:e.target.value}))} placeholder="e.g. Checkr, Sterling" style={s.input}/>
+            </div>
+            <div><label style={s.label}>Cost</label>
+              <input type="number" value={bgForm.cost} onChange={e=>setBgForm(p=>({...p,cost:e.target.value}))} placeholder="0.00" style={s.input}/>
+            </div>
+            <div><label style={s.label}>Status</label>
+              <select value={bgForm.status} onChange={e=>setBgForm(p=>({...p,status:e.target.value}))} style={s.input}>
+                <option value="pending">Pending</option>
+                <option value="clear">Clear / Passed</option>
+                <option value="flagged">Flagged</option>
+                <option value="failed">Failed</option>
+              </select>
+            </div>
+            <div style={{gridColumn:'span 2'}}><label style={s.label}>Notes</label>
+              <textarea value={bgForm.notes} onChange={e=>setBgForm(p=>({...p,notes:e.target.value}))} style={{...s.input,minHeight:60,resize:'vertical'}}/>
+            </div>
+            <div style={{gridColumn:'span 2'}}><button style={s.btn()} onClick={addBgCheck}>Save Background Check</button></div>
+          </div>
+        )}
+
+        <div style={{background:'#EEF2FF',border:'1px solid #C7D2FE',borderRadius:10,padding:'0.875rem 1rem',marginBottom:'1rem',fontSize:'0.82rem',color:'#3730A3'}}>
+          <strong>Wisconsin Requirements:</strong> WORCs registry check required. OIG exclusion check recommended. Background checks should be renewed every 2 years per Wisconsin DHS guidelines.
+        </div>
+
+        {bgChecks.length > 0 ? (
+          <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+            <thead><tr style={{background:'#F9FAFB'}}>{['Type','Provider','Date','Status','Expires','Notes'].map(h=><th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:700,borderBottom:'1px solid #E5E7EB'}}>{h}</th>)}</tr></thead>
+            <tbody>
+              {bgChecks.map(bg=>{
+                const expired = bg.expiration_date && new Date(bg.expiration_date) < new Date();
+                const expiring = bg.expiration_date && new Date(bg.expiration_date) < new Date(Date.now()+30*86400000) && !expired;
+                return (
+                  <tr key={bg.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:600,textTransform:'capitalize'}}>{(bg.check_type||'').replace(/_/g,' ')}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{bg.provider||'—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>{fmtDate(bg.initiated_date||bg.check_date)}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>
+                      <span style={s.badge(bg.status==='clear'?'#065F46':bg.status==='pending'?'#92400E':'#991B1B',bg.status==='clear'?'#D1FAE5':bg.status==='pending'?'#FEF3C7':'#FEE2E2')}>
+                        {bg.status?.toUpperCase()}
+                      </span>
+                    </td>
+                    <td style={{padding:'0.5rem 0.75rem',color:expired?'#DC2626':expiring?'#F59E0B':'#374151'}}>
+                      {bg.expiration_date ? (expired?'⛔ Expired':expiring?'⚠️ Expiring':fmtDate(bg.expiration_date)) : '—'}
+                    </td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{bg.notes||'—'}</td>
+                  </tr>
+                );
+              })}
+            </tbody>
+          </table>
+        ) : <p style={{color:'#9CA3AF',fontSize:'0.875rem'}}>No background checks on file. Add one above.</p>}
+      </div>
+    </div>
+  );
+
+  // ── EVV / GEOFENCE TAB ────────────────────────────────────────────────────────
+  const renderEVV = () => (
+    <div>
+      <div style={s.card}>
+        <div style={{fontWeight:800,fontSize:'0.95rem',marginBottom:'1rem'}}>📍 GPS & Geofence Settings</div>
+        <div style={{background:'#F0FDFB',border:'1px solid #A7F3D0',borderRadius:10,padding:'0.875rem 1rem',marginBottom:'1rem',fontSize:'0.82rem',color:'#065F46'}}>
+          <strong>How auto clock-in works:</strong> When the caregiver's app detects they're within the geofence radius of a client's address, the system prompts (or automatically) clocks them in. Requires: (1) client address geocoded, (2) caregiver home address geocoded, (3) caregiver phone GPS permissions enabled.
+        </div>
+
+        <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'1rem',marginBottom:'1rem'}}>
+          <div style={{padding:'0.875rem',background:'#F9FAFB',borderRadius:10}}>
+            <div style={{fontWeight:700,fontSize:'0.82rem',marginBottom:'0.25rem',color:'#374151'}}>Caregiver Home GPS</div>
+            <div style={{fontSize:'0.875rem',color:profile?.latitude?'#065F46':'#DC2626',fontWeight:600}}>
+              {profile?.latitude ? `✅ Set (${parseFloat(profile.latitude).toFixed(4)}, ${parseFloat(profile.longitude).toFixed(4)})` : '⚠️ Not geocoded — geofence routing won\'t work'}
+            </div>
+            {!profile?.latitude && (
+              <button style={{...s.btn('#6366F1'),marginTop:'0.5rem',fontSize:'0.78rem',padding:'0.35rem 0.75rem'}} onClick={()=>{setEditing(true);setTab('personal');}}>
+                Go to Personal Info → Geocode Address
+              </button>
+            )}
+          </div>
+          <div style={{padding:'0.875rem',background:'#F9FAFB',borderRadius:10}}>
+            <div style={{fontWeight:700,fontSize:'0.82rem',marginBottom:'0.25rem',color:'#374151'}}>EVV Worker ID (Sandata)</div>
+            <div style={{fontSize:'0.875rem',color:profile?.evv_worker_id?'#065F46':'#92400E',fontWeight:600}}>
+              {profile?.evv_worker_id || '⚠️ Not set — needed for Sandata EVV submission'}
+            </div>
+          </div>
+        </div>
+
+        <div style={{background:'#FEF3C7',border:'1px solid #FCD34D',borderRadius:10,padding:'0.875rem 1rem',fontSize:'0.82rem',color:'#92400E'}}>
+          <strong>To set up auto clock-in for this caregiver's clients:</strong><br/>
+          Go to <strong>Route Optimizer → Geofence tab</strong> → select each client → enable Auto Clock-In and set radius (default 300ft). Each client needs their address geocoded too.
+        </div>
+      </div>
+    </div>
+  );
+
+  return (
+    <div style={s.page}>
+      {/* Header */}
+      <div style={s.header}>
+        <div style={s.headerAccent} />
+        <button onClick={onBack} style={{background:'rgba(255,255,255,0.1)',border:'1px solid rgba(255,255,255,0.2)',color:'#fff',borderRadius:8,padding:'0.4rem 0.875rem',cursor:'pointer',fontSize:'0.82rem',fontWeight:600,marginBottom:'1rem'}}>
+          ← Back
+        </button>
+        <div style={{display:'flex',alignItems:'center',gap:'1rem'}}>
+          <div style={s.avatar}>{initials}</div>
+          <div style={{flex:1}}>
+            <h2 style={{margin:0,fontSize:'1.4rem',fontWeight:800}}>{fullName}</h2>
+            <div style={{display:'flex',gap:'0.75rem',marginTop:'0.25rem',flexWrap:'wrap'}}>
+              <span style={{fontSize:'0.82rem',color:'rgba(255,255,255,0.7)'}}>{profile?.email}</span>
+              <span style={{fontSize:'0.82rem',color:'rgba(255,255,255,0.7)'}}>📞 {profile?.phone || '—'}</span>
+              <span style={{...s.badge(profile?.is_active?'#065F46':'#6B7280',profile?.is_active?'#D1FAE5':'#F3F4F6')}}>
+                {profile?.is_active ? '● Active' : '○ Inactive'}
+              </span>
+            </div>
+          </div>
+          <div style={{textAlign:'right'}}>
+            <div style={{fontSize:'1.5rem',fontWeight:800,color:'#2ABBA7'}}>{fmt$(earnings?.earnings_this_month)}</div>
+            <div style={{fontSize:'0.72rem',color:'rgba(255,255,255,0.6)'}}>This month</div>
+          </div>
+        </div>
+      </div>
+
+      {/* Tabs */}
+      <div style={{display:'flex',gap:0,borderBottom:'2px solid #E5E7EB',marginBottom:'1.25rem',overflowX:'auto'}}>
+        {TABS.map(t => <button key={t.id} style={s.tab(tab===t.id)} onClick={()=>setTab(t.id)}>{t.label}</button>)}
+      </div>
+
+      {tab === 'overview' && renderOverview()}
+      {tab === 'personal' && renderPersonal()}
+      {tab === 'schedule' && renderSchedule()}
+      {tab === 'shifts' && renderShifts()}
+      {tab === 'gpsmap' && renderGpsMap()}
+      {tab === 'background' && renderBackground()}
+      {tab === 'evv' && renderEVV()}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/CaregiverHistory.jsx b/templates/crm-homecare/frontend/src/components/admin/CaregiverHistory.jsx
new file mode 100644
index 0000000..cfa7eb1
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CaregiverHistory.jsx
@@ -0,0 +1,363 @@
+// src/components/admin/CaregiverHistory.jsx
+// Shift timeline + GPS route viewer for admin
+import React, { useState, useEffect, useRef } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const formatDuration = (minutes) => {
+  if (!minutes) return '—';
+  const h = Math.floor(minutes / 60);
+  const m = minutes % 60;
+  return h > 0 ? `${h}h ${m}m` : `${m}m`;
+};
+
+const formatDateTime = (dt) => {
+  if (!dt) return '—';
+  return new Date(dt).toLocaleString('en-US', {
+    month: 'short', day: 'numeric',
+    hour: '2-digit', minute: '2-digit'
+  });
+};
+
+const formatTime = (dt) => {
+  if (!dt) return '—';
+  return new Date(dt).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
+};
+
+// Simple inline map using Leaflet via CDN
+const GPSRouteMap = ({ timeEntryId, token, onClose }) => {
+  const mapRef = useRef(null);
+  const [points, setPoints] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [mapLoaded, setMapLoaded] = useState(false);
+  const mapInstanceRef = useRef(null);
+
+  useEffect(() => {
+    // Load Leaflet CSS
+    if (!document.getElementById('leaflet-css')) {
+      const link = document.createElement('link');
+      link.id = 'leaflet-css';
+      link.rel = 'stylesheet';
+      link.href = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css';
+      document.head.appendChild(link);
+    }
+    // Load Leaflet JS
+    if (!window.L) {
+      const script = document.createElement('script');
+      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js';
+      script.onload = () => setMapLoaded(true);
+      document.head.appendChild(script);
+    } else {
+      setMapLoaded(true);
+    }
+
+    fetch(`${API_BASE_URL}/api/time-entries/${timeEntryId}/gps`, {
+      headers: { Authorization: `Bearer ${token}` }
+    })
+      .then(r => r.json())
+      .then(data => { setPoints(Array.isArray(data) ? data : []); setLoading(false); })
+      .catch(() => setLoading(false));
+  }, [timeEntryId, token]);
+
+  useEffect(() => {
+    if (!mapLoaded || loading || !mapRef.current || mapInstanceRef.current) return;
+    if (points.length === 0) return;
+
+    const L = window.L;
+    const map = L.map(mapRef.current);
+    mapInstanceRef.current = map;
+
+    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
+      attribution: '© OpenStreetMap contributors'
+    }).addTo(map);
+
+    const latlngs = points.map(p => [parseFloat(p.latitude), parseFloat(p.longitude)]);
+
+    // Draw route
+    const polyline = L.polyline(latlngs, { color: '#2ABBA7', weight: 4, opacity: 0.8 }).addTo(map);
+
+    // Start marker (green)
+    if (latlngs.length > 0) {
+      L.circleMarker(latlngs[0], { radius: 10, fillColor: '#16A34A', color: '#fff', weight: 2, fillOpacity: 1 })
+        .bindPopup(`<b>Clock In</b><br>${new Date(points[0].timestamp).toLocaleTimeString()}`)
+        .addTo(map);
+    }
+
+    // End marker (red)
+    if (latlngs.length > 1) {
+      const last = latlngs[latlngs.length - 1];
+      L.circleMarker(last, { radius: 10, fillColor: '#DC2626', color: '#fff', weight: 2, fillOpacity: 1 })
+        .bindPopup(`<b>Clock Out</b><br>${new Date(points[points.length - 1].timestamp).toLocaleTimeString()}`)
+        .addTo(map);
+    }
+
+    map.fitBounds(polyline.getBounds(), { padding: [20, 20] });
+  }, [mapLoaded, loading, points]);
+
+  useEffect(() => {
+    return () => {
+      if (mapInstanceRef.current) {
+        mapInstanceRef.current.remove();
+        mapInstanceRef.current = null;
+      }
+    };
+  }, []);
+
+  return (
+    <div style={{
+      position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)',
+      zIndex: 9999, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem'
+    }}>
+      <div style={{ background: '#fff', borderRadius: '12px', width: '100%', maxWidth: '800px', maxHeight: '90vh', overflow: 'hidden', display: 'flex', flexDirection: 'column' }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '1rem 1.25rem', borderBottom: '1px solid #E5E7EB' }}>
+          <h3 style={{ margin: 0, fontSize: '1.05rem' }}>📍 GPS Route — {points.length} location points</h3>
+          <button onClick={onClose} style={{ background: 'none', border: 'none', fontSize: '1.5rem', cursor: 'pointer', color: '#6B7280' }}>×</button>
+        </div>
+        <div style={{ flex: 1, minHeight: '400px' }}>
+          {loading && (
+            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '400px', color: '#6B7280' }}>
+              Loading GPS data...
+            </div>
+          )}
+          {!loading && points.length === 0 && (
+            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '400px', color: '#6B7280' }}>
+              <div style={{ fontSize: '2.5rem', marginBottom: '0.75rem' }}>📍</div>
+              <p>No GPS data recorded for this shift.</p>
+              <p style={{ fontSize: '0.85rem' }}>GPS tracking requires the caregiver to grant location permission on their device.</p>
+            </div>
+          )}
+          {!loading && points.length > 0 && (
+            <div ref={mapRef} style={{ width: '100%', height: '450px' }} />
+          )}
+        </div>
+        {!loading && points.length > 0 && (
+          <div style={{ padding: '0.75rem 1.25rem', background: '#F9FAFB', borderTop: '1px solid #E5E7EB', display: 'flex', gap: '1.5rem', fontSize: '0.85rem', color: '#6B7280' }}>
+            <span>🟢 Start: {formatTime(points[0]?.timestamp)}</span>
+            <span>🔴 End: {formatTime(points[points.length - 1]?.timestamp)}</span>
+            <span>📍 {points.length} points recorded</span>
+          </div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+const CaregiverHistory = ({ caregiverId, caregiverName, token, onBack }) => {
+  const [entries, setEntries] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [dateRange, setDateRange] = useState({
+    start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
+    end: new Date().toISOString().split('T')[0],
+  });
+  const [selectedEntryId, setSelectedEntryId] = useState(null);
+  const [stats, setStats] = useState({ totalShifts: 0, totalHours: 0, avgDuration: 0, clients: new Set() });
+
+  useEffect(() => { loadHistory(); }, [caregiverId, dateRange]);
+
+  const loadHistory = async () => {
+    setLoading(true);
+    try {
+      const url = `${API_BASE_URL}/api/time-entries/caregiver-history/${caregiverId}?startDate=${dateRange.start}T00:00:00&endDate=${dateRange.end}T23:59:59&limit=100`;
+      const res = await fetch(url, { headers: { Authorization: `Bearer ${token}` } });
+      const data = await res.json();
+      const list = Array.isArray(data) ? data : [];
+      setEntries(list);
+
+      // Calculate stats
+      const totalMins = list.reduce((sum, e) => sum + (parseInt(e.duration_minutes) || 0), 0);
+      const clients = new Set(list.map(e => e.client_id).filter(Boolean));
+      setStats({
+        totalShifts: list.length,
+        totalHours: (totalMins / 60).toFixed(2),
+        avgDuration: list.length ? Math.round(totalMins / list.length) : 0,
+        clients,
+      });
+    } catch (e) {
+      console.error(e);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const statusColor = (entry) => {
+    if (!entry.end_time) return { bg: '#FEF9C3', border: '#CA8A04', text: '#854D0E', label: 'Active' };
+    if (entry.duration_minutes > 480) return { bg: '#FEF2F2', border: '#DC2626', text: '#991B1B', label: 'Long Shift' };
+    return { bg: '#F0FDF4', border: '#16A34A', text: '#166534', label: 'Complete' };
+  };
+
+  return (
+    <div>
+      {/* Header */}
+      <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
+        <button onClick={onBack} style={{
+          display: 'flex', alignItems: 'center', gap: '0.5rem',
+          padding: '0.5rem 1rem', borderRadius: '8px',
+          border: '1px solid #D1D5DB', background: '#fff',
+          color: '#374151', cursor: 'pointer', fontWeight: '500', fontSize: '0.9rem'
+        }}>← Back</button>
+        <div>
+          <h2 style={{ margin: 0, fontSize: '1.25rem', color: '#111827' }}>
+            🕐 Shift History — {caregiverName}
+          </h2>
+          <p style={{ margin: '0.25rem 0 0 0', color: '#6B7280', fontSize: '0.85rem' }}>
+            Clock-in/out records with GPS routes
+          </p>
+        </div>
+      </div>
+
+      {/* Date Range Filter */}
+      <div className="card" style={{ padding: '1rem', marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+            <label style={{ fontSize: '0.85rem', color: '#6B7280', fontWeight: '500' }}>From</label>
+            <input type="date" value={dateRange.start}
+              onChange={e => setDateRange(p => ({ ...p, start: e.target.value }))}
+              style={{ padding: '0.4rem 0.75rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }} />
+          </div>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+            <label style={{ fontSize: '0.85rem', color: '#6B7280', fontWeight: '500' }}>To</label>
+            <input type="date" value={dateRange.end}
+              onChange={e => setDateRange(p => ({ ...p, end: e.target.value }))}
+              style={{ padding: '0.4rem 0.75rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }} />
+          </div>
+          <button onClick={loadHistory} style={{
+            padding: '0.4rem 1rem', background: '#2ABBA7', color: '#fff',
+            border: 'none', borderRadius: '6px', cursor: 'pointer', fontWeight: '500', fontSize: '0.85rem'
+          }}>Apply</button>
+        </div>
+      </div>
+
+      {/* Stats */}
+      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))', gap: '0.75rem', marginBottom: '1.25rem' }}>
+        {[
+          { label: 'Total Shifts', value: stats.totalShifts, icon: '📋' },
+          { label: 'Total Hours', value: `${stats.totalHours}h`, icon: '⏱️' },
+          { label: 'Avg Duration', value: formatDuration(stats.avgDuration), icon: '📊' },
+          { label: 'Unique Clients', value: stats.clients.size, icon: '👤' },
+        ].map(s => (
+          <div key={s.label} className="card" style={{ padding: '0.875rem', textAlign: 'center' }}>
+            <div style={{ fontSize: '1.4rem', marginBottom: '0.25rem' }}>{s.icon}</div>
+            <div style={{ fontSize: '1.4rem', fontWeight: '700', color: '#111827' }}>{s.value}</div>
+            <div style={{ fontSize: '0.75rem', color: '#6B7280' }}>{s.label}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* Timeline */}
+      {loading ? (
+        <div style={{ textAlign: 'center', padding: '3rem', color: '#6B7280' }}>Loading shift history...</div>
+      ) : entries.length === 0 ? (
+        <div className="card" style={{ padding: '2rem', textAlign: 'center', color: '#6B7280' }}>
+          <div style={{ fontSize: '2rem', marginBottom: '0.75rem' }}>📋</div>
+          <p>No shifts found for the selected date range.</p>
+        </div>
+      ) : (
+        <div style={{ position: 'relative' }}>
+          {/* Timeline line */}
+          <div style={{
+            position: 'absolute', left: '20px', top: '20px', bottom: '20px',
+            width: '2px', background: '#E5E7EB', zIndex: 0
+          }} />
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem', paddingLeft: '50px' }}>
+            {entries.map((entry, idx) => {
+              const sc = statusColor(entry);
+              const hasGPS = parseInt(entry.gps_point_count) > 0;
+              return (
+                <div key={entry.id} style={{ position: 'relative' }}>
+                  {/* Timeline dot */}
+                  <div style={{
+                    position: 'absolute', left: '-38px', top: '18px',
+                    width: '14px', height: '14px', borderRadius: '50%',
+                    background: sc.border, border: '2px solid #fff',
+                    boxShadow: '0 0 0 2px ' + sc.border,
+                    zIndex: 1
+                  }} />
+                  <div className="card" style={{
+                    padding: '1rem',
+                    borderLeft: `3px solid ${sc.border}`,
+                    transition: 'box-shadow 0.15s'
+                  }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.5rem' }}>
+                      <div>
+                        <div style={{ fontWeight: '700', fontSize: '0.95rem', color: '#111827', marginBottom: '0.25rem' }}>
+                          {entry.client_first_name
+                            ? `${entry.client_first_name} ${entry.client_last_name}`
+                            : 'Unknown Client'}
+                        </div>
+                        <div style={{ fontSize: '0.85rem', color: '#6B7280' }}>
+                          {entry.client_address && `📍 ${entry.client_address}, ${entry.client_city}`}
+                        </div>
+                      </div>
+                      <span style={{
+                        padding: '0.2rem 0.6rem', borderRadius: '99px', fontSize: '0.75rem',
+                        fontWeight: '600', background: sc.bg, color: sc.text, border: `1px solid ${sc.border}`
+                      }}>{sc.label}</span>
+                    </div>
+
+                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '0.75rem', marginTop: '0.75rem' }}>
+                      <div>
+                        <div style={{ fontSize: '0.72rem', color: '#9CA3AF', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Clock In</div>
+                        <div style={{ fontSize: '0.9rem', fontWeight: '600', color: '#374151' }}>{formatDateTime(entry.start_time)}</div>
+                      </div>
+                      <div>
+                        <div style={{ fontSize: '0.72rem', color: '#9CA3AF', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Clock Out</div>
+                        <div style={{ fontSize: '0.9rem', fontWeight: '600', color: '#374151' }}>
+                          {entry.end_time ? formatDateTime(entry.end_time) : <span style={{ color: '#CA8A04' }}>Still Active</span>}
+                        </div>
+                      </div>
+                      <div>
+                        <div style={{ fontSize: '0.72rem', color: '#9CA3AF', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Duration</div>
+                        <div style={{ fontSize: '0.9rem', fontWeight: '600', color: '#374151' }}>
+                          {entry.duration_minutes ? `${formatDuration(entry.duration_minutes)} (${(entry.duration_minutes / 60).toFixed(2)}h)` : '—'}
+                        </div>
+                      </div>
+                      <div>
+                        <div style={{ fontSize: '0.72rem', color: '#9CA3AF', fontWeight: '600', textTransform: 'uppercase', letterSpacing: '0.05em' }}>GPS</div>
+                        <div style={{ fontSize: '0.9rem' }}>
+                          {hasGPS ? (
+                            <button
+                              onClick={() => setSelectedEntryId(entry.id)}
+                              style={{
+                                background: '#EFF6FF', color: '#2563EB', border: '1px solid #BFDBFE',
+                                borderRadius: '6px', padding: '0.2rem 0.6rem', cursor: 'pointer',
+                                fontSize: '0.8rem', fontWeight: '600'
+                              }}
+                            >
+                              📍 View Route ({entry.gps_point_count} pts)
+                            </button>
+                          ) : (
+                            <span style={{ color: '#9CA3AF', fontSize: '0.85rem' }}>No GPS data</span>
+                          )}
+                        </div>
+                      </div>
+                    </div>
+
+                    {entry.notes && (
+                      <div style={{
+                        marginTop: '0.75rem', padding: '0.5rem 0.75rem',
+                        background: '#F9FAFB', borderRadius: '6px', fontSize: '0.85rem', color: '#6B7280',
+                        borderLeft: '3px solid #D1D5DB'
+                      }}>
+                        📝 {entry.notes}
+                      </div>
+                    )}
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        </div>
+      )}
+
+      {/* GPS Route Modal */}
+      {selectedEntryId && (
+        <GPSRouteMap
+          timeEntryId={selectedEntryId}
+          token={token}
+          onClose={() => setSelectedEntryId(null)}
+        />
+      )}
+    </div>
+  );
+};
+
+export default CaregiverHistory;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CaregiverManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/CaregiverManagement.jsx
new file mode 100644
index 0000000..c1c8edd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CaregiverManagement.jsx
@@ -0,0 +1,608 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/CaregiverManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import AddCaregiverModal from './AddCaregiverModal';
+import CaregiverDetail from './CaregiverDetail';
+
+// Mobile-friendly caregiver card
+const CaregiverCard = ({ caregiver, formatCurrency, onEdit, onRates, onProfile, onPromote }) => (
+  <div className="card" style={{ marginBottom: '0.75rem', padding: '1rem' }}>
+    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.75rem' }}>
+      <div>
+        <strong style={{ fontSize: '1.1rem' }}>{caregiver.first_name} {caregiver.last_name}</strong>
+        <div style={{ fontSize: '0.85rem', color: '#666' }}>{caregiver.email}</div>
+      </div>
+      <span className={`badge ${caregiver.role === 'admin' ? 'badge-danger' : 'badge-info'}`}>
+        {caregiver.role.toUpperCase()}
+      </span>
+    </div>
+    
+    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem', fontSize: '0.9rem', marginBottom: '0.75rem' }}>
+      <div>
+        <span style={{ color: '#666' }}>📞</span>{' '}
+        {caregiver.phone ? (
+          <a href={`tel:${caregiver.phone}`}>{caregiver.phone}</a>
+        ) : (
+          <span style={{ color: '#999' }}>N/A</span>
+        )}
+      </div>
+      <div>
+        <span style={{ color: '#666' }}>💰</span>{' '}
+        <strong>{formatCurrency(caregiver.default_pay_rate)}</strong>/hr
+      </div>
+      <div style={{ gridColumn: '1 / -1', fontSize: '0.82rem' }}>
+        {caregiver.address ? (
+          <span>📍 {[caregiver.address, caregiver.city, caregiver.state, caregiver.zip].filter(Boolean).join(', ')}
+            {caregiver.latitude ? ' ✅' : ' ⚠️ Not geocoded'}
+          </span>
+        ) : (
+          <span style={{ color: '#d97706' }}>⚠️ No home address — needed for route optimization</span>
+        )}
+      </div>
+    </div>
+    
+    <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+      <button className="btn btn-sm" style={{background:'#0F172A',color:'#fff',border:'none',borderRadius:6,padding:'0.25rem 0.6rem',cursor:'pointer',fontWeight:700,fontSize:'0.78rem'}} onClick={() => onProfile && onProfile(caregiver.id)}>👁 Full Profile</button>
+      <button className="btn btn-sm btn-primary" onClick={() => onEdit(caregiver)}>✏️ Edit</button>
+      <button className="btn btn-sm btn-secondary" onClick={() => onRates(caregiver)}>💰 Rates</button>
+      {onProfile && (
+        <button className="btn btn-sm btn-secondary" onClick={() => onProfile(caregiver.id)}>👤 Profile</button>
+      )}
+      {caregiver.role !== 'admin' && (
+        <button className="btn btn-sm btn-warning" onClick={() => onPromote(caregiver.id)}>⬆️ Admin</button>
+      )}
+    </div>
+  </div>
+);
+
+const CaregiverManagement = ({ token, onViewProfile, onViewHistory }) => {
+  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);
+  const [detailId, setDetailId] = useState(null);
+  const [caregivers, setCaregivers] = useState([]);
+  const [careTypes, setCareTypes] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showModal, setShowModal] = useState(false);
+  const [showEditModal, setShowEditModal] = useState(false);
+  const [showRatesModal, setShowRatesModal] = useState(false);
+  const [selectedCaregiver, setSelectedCaregiver] = useState(null);
+  const [caregiverRates, setCaregiverRates] = useState([]);
+  const [selectedIds, setSelectedIds] = useState([]);
+  const [bulkMessage, setBulkMessage] = useState('');
+  const [showBulkMsg, setShowBulkMsg] = useState(false);
+  const [searchQuery, setSearchQuery] = useState('');
+  const [statusFilter, setStatusFilter] = useState('all'); // all, active, inactive
+  
+  const [editData, setEditData] = useState({
+    firstName: '',
+    lastName: '',
+    phone: '',
+    payRate: '',
+    address: '',
+    city: '',
+    state: '',
+    zip: ''
+  });
+
+  const [rateFormData, setRateFormData] = useState({
+    careTypeId: '',
+    hourlyRate: ''
+  });
+
+  // Listen for window resize
+  useEffect(() => {
+    const handleResize = () => setIsMobile(window.innerWidth < 768);
+    window.addEventListener('resize', handleResize);
+    return () => window.removeEventListener('resize', handleResize);
+  }, []);
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [cgRes, ctRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/care-types`, { headers: { 'Authorization': `Bearer ${token}` } })
+      ]);
+      setCaregivers(await cgRes.json());
+      setCareTypes(await ctRes.json());
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handlePromoteToAdmin = async (userId) => {
+    if (await confirm('Promote this caregiver to admin?')) {
+      try {
+        const response = await fetch(`${API_BASE_URL}/api/users/convert-to-admin`, {
+          method: 'POST',
+          headers: {
+            'Content-Type': 'application/json',
+            'Authorization': `Bearer ${token}`
+          },
+          body: JSON.stringify({ userId })
+        });
+        if (!response.ok) throw new Error('Failed to promote');
+        loadData();
+        toast('Caregiver promoted to admin!');
+      } catch (error) {
+        toast('Failed to promote: ' + error.message, 'error');
+      }
+    }
+  };
+
+  const handleOpenEdit = (caregiver) => {
+    setSelectedCaregiver(caregiver);
+    setEditData({
+      firstName: caregiver.first_name || '',
+      lastName: caregiver.last_name || '',
+      phone: caregiver.phone || '',
+      payRate: caregiver.default_pay_rate || '',
+      address: caregiver.address || '',
+      city: caregiver.city || '',
+      state: caregiver.state || '',
+      zip: caregiver.zip || ''
+    });
+    setShowEditModal(true);
+  };
+
+  const handleSaveEdit = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${selectedCaregiver.id}`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          firstName: editData.firstName,
+          lastName: editData.lastName,
+          phone: editData.phone,
+          payRate: parseFloat(editData.payRate) || null,
+          address: editData.address || null,
+          city: editData.city || null,
+          state: editData.state || null,
+          zip: editData.zip || null
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to update caregiver');
+
+      setShowEditModal(false);
+      setSelectedCaregiver(null);
+      loadData();
+      toast('Caregiver updated!');
+    } catch (error) {
+      toast('Failed to update: ' + error.message, 'error');
+    }
+  };
+
+  const handleOpenRates = async (caregiver) => {
+    setSelectedCaregiver(caregiver);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregiver-care-type-rates?caregiverId=${caregiver.id}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      setCaregiverRates(await response.json());
+      setShowRatesModal(true);
+    } catch (error) {
+      toast('Failed to load rates: ' + error.message, 'error');
+    }
+  };
+
+  const handleAddRate = async (e) => {
+    e.preventDefault();
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregiver-care-type-rates`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          caregiverId: selectedCaregiver.id,
+          careTypeId: rateFormData.careTypeId,
+          hourlyRate: parseFloat(rateFormData.hourlyRate)
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to add rate');
+
+      setRateFormData({ careTypeId: '', hourlyRate: '' });
+      
+      const ratesRes = await fetch(`${API_BASE_URL}/api/caregiver-care-type-rates?caregiverId=${selectedCaregiver.id}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      setCaregiverRates(await ratesRes.json());
+    } catch (error) {
+      toast('Failed to add rate: ' + error.message, 'error');
+    }
+  };
+
+  const handleDeleteRate = async (rateId) => {
+    const _cok = await confirm('Remove this rate?', {danger: true}); if (!_cok) return;
+    
+    try {
+      await fetch(`${API_BASE_URL}/api/caregiver-care-type-rates/${rateId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      
+      const ratesRes = await fetch(`${API_BASE_URL}/api/caregiver-care-type-rates?caregiverId=${selectedCaregiver.id}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      setCaregiverRates(await ratesRes.json());
+    } catch (error) {
+      toast('Failed to delete rate: ' + error.message, 'error');
+    }
+  };
+
+  const getAvailableCareTypes = () => {
+    const assignedIds = caregiverRates.map(r => r.care_type_id);
+    return careTypes.filter(ct => !assignedIds.includes(ct.id));
+  };
+
+  const formatCurrency = (amount) => {
+    return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount || 0);
+  };
+
+  const filteredCaregivers = caregivers.filter(cg => {
+    const q = searchQuery.toLowerCase();
+    const matchesSearch = !q || 
+      (cg.first_name + " " + cg.last_name).toLowerCase().includes(q) ||
+      (cg.email || "").toLowerCase().includes(q) ||
+      (cg.phone || "").includes(q) ||
+      (cg.city || "").toLowerCase().includes(q);
+    const matchesStatus = statusFilter === "all" ||
+      (statusFilter === "active" && cg.is_active !== false) ||
+      (statusFilter === "inactive" && cg.is_active === false);
+    return matchesSearch && matchesStatus;
+  });
+
+  // Show full detail view when a caregiver is clicked
+  if (detailId) {
+    return <CaregiverDetail caregiverId={detailId} token={token} onBack={() => { setDetailId(null); loadCaregivers(); }} />;
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>👤 Caregivers</h2>
+        <button className="btn btn-primary" onClick={() => setShowModal(true)}>
+          ➕ Add
+        </button>
+      </div>
+
+      <div style={{ display: "flex", gap: "0.75rem", marginBottom: "1rem", flexWrap: "wrap", alignItems: "center" }}>
+          <input placeholder="🔍 Search caregivers..." value={searchQuery}
+            onChange={e => setSearchQuery(e.target.value)}
+            style={{ flex: "1", minWidth: "180px", padding: "0.5rem 0.75rem", border: "1px solid #D1D5DB", borderRadius: "8px", fontSize: "0.9rem" }} />
+          <select value={statusFilter} onChange={e => setStatusFilter(e.target.value)}
+            style={{ padding: "0.5rem 0.75rem", border: "1px solid #D1D5DB", borderRadius: "8px", fontSize: "0.9rem" }}>
+            <option value="all">All Status</option>
+            <option value="active">Active</option>
+            <option value="inactive">Inactive</option>
+          </select>
+          <span style={{ fontSize: "0.85rem", color: "#6B7280" }}>{filteredCaregivers.length} of {caregivers.length}</span>
+        </div>
+
+        {/* Bulk Actions Bar */}
+        {selectedIds.length > 0 && (
+          <div style={{ display: "flex", alignItems: "center", gap: "0.75rem", padding: "0.6rem 0.875rem", background: "#EFF6FF", border: "1px solid #BFDBFE", borderRadius: "8px", marginBottom: "0.75rem", flexWrap: "wrap" }}>
+            <span style={{ fontSize: "0.875rem", fontWeight: "600", color: "#1D4ED8" }}>
+              ✅ {selectedIds.length} selected
+            </span>
+            <button onClick={() => {
+              // Export selected as CSV
+              const selected = caregivers.filter(c => selectedIds.includes(c.id));
+              const csv = ['Name,Email,Phone,Pay Rate,Status'].concat(
+                selected.map(c => `"${c.first_name} ${c.last_name}","${c.email}","${c.phone || ''}","${c.default_pay_rate || ''}","${c.is_active ? 'Active' : 'Inactive'}"`)
+              ).join('\n');
+              const blob = new Blob([csv], { type: 'text/csv' });
+              const url = URL.createObjectURL(blob);
+              const a = document.createElement('a'); a.href = url; a.download = 'caregivers.csv'; a.click();
+              URL.revokeObjectURL(url);
+              toast(`Exported ${selected.length} caregivers`, 'success');
+            }} style={{ padding: "0.35rem 0.75rem", background: "#fff", border: "1px solid #D1D5DB", borderRadius: "6px", cursor: "pointer", fontSize: "0.82rem", fontWeight: "600" }}>
+              📥 Export CSV
+            </button>
+            <button onClick={() => setShowBulkMsg(true)}
+              style={{ padding: "0.35rem 0.75rem", background: "#2ABBA7", color: "#fff", border: "none", borderRadius: "6px", cursor: "pointer", fontSize: "0.82rem", fontWeight: "600" }}>
+              📱 Send SMS
+            </button>
+            <button onClick={() => setSelectedIds([])} style={{ padding: "0.35rem 0.75rem", background: "none", border: "1px solid #D1D5DB", borderRadius: "6px", cursor: "pointer", fontSize: "0.82rem", color: "#6B7280" }}>
+              Clear
+            </button>
+          </div>
+        )}
+
+        {/* Bulk SMS Modal */}
+        {showBulkMsg && (
+          <div style={{ position: "fixed", inset: 0, background: "rgba(0,0,0,0.5)", zIndex: 9999, display: "flex", alignItems: "center", justifyContent: "center", padding: "1rem" }}>
+            <div style={{ background: "#fff", borderRadius: "12px", padding: "1.5rem", maxWidth: "420px", width: "100%" }}>
+              <h3 style={{ margin: "0 0 0.75rem 0" }}>📱 Send SMS to {selectedIds.length} Caregiver{selectedIds.length !== 1 ? 's' : ''}</h3>
+              <textarea
+                placeholder="Type your message here..."
+                value={bulkMessage}
+                onChange={e => setBulkMessage(e.target.value)}
+                rows={4}
+                style={{ width: "100%", padding: "0.75rem", border: "1px solid #D1D5DB", borderRadius: "8px", fontSize: "0.9rem", resize: "vertical", boxSizing: "border-box" }}
+              />
+              <div style={{ display: "flex", gap: "0.75rem", marginTop: "1rem", justifyContent: "flex-end" }}>
+                <button onClick={() => setShowBulkMsg(false)} style={{ padding: "0.5rem 1rem", border: "1px solid #D1D5DB", borderRadius: "8px", background: "#fff", cursor: "pointer" }}>Cancel</button>
+                <button onClick={async () => {
+                  if (!bulkMessage.trim()) { toast('Enter a message', 'warning'); return; }
+                  try {
+                    const phones = caregivers.filter(c => selectedIds.includes(c.id) && c.phone).map(c => c.phone);
+                    await fetch(`${API_BASE_URL}/api/sms/bulk`, {
+                      method: 'POST', headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
+                      body: JSON.stringify({ phones, message: bulkMessage })
+                    });
+                    toast(`SMS sent to ${phones.length} caregivers`, 'success');
+                    setShowBulkMsg(false); setBulkMessage(''); setSelectedIds([]);
+                  } catch { toast('SMS send failed', 'error'); }
+                }} style={{ padding: "0.5rem 1rem", background: "#2ABBA7", color: "#fff", border: "none", borderRadius: "8px", cursor: "pointer", fontWeight: "600" }}>Send</button>
+              </div>
+            </div>
+          </div>
+        )}
+
+        {loading ? (
+          <div className="spinner"></div>
+        ) : caregivers.length === 0 ? (
+        <div className="card card-centered">
+          <p>No caregivers yet.</p>
+        </div>
+      ) : isMobile ? (
+        <div>
+          {filteredCaregivers.map(caregiver => (
+            <CaregiverCard
+              key={caregiver.id}
+              caregiver={caregiver}
+              formatCurrency={formatCurrency}
+              onEdit={handleOpenEdit}
+              onRates={handleOpenRates}
+              onProfile={onViewProfile}
+              onPromote={handlePromoteToAdmin}
+            />
+          ))}
+        </div>
+      ) : (
+        <div style={{ overflowX: 'auto' }}>
+          <table className="table">
+            <thead>
+              <tr>
+                <th style={{ width: '36px' }}>
+                  <input type="checkbox" checked={selectedIds.length === filteredCaregivers.length && filteredCaregivers.length > 0}
+                    onChange={e => setSelectedIds(e.target.checked ? filteredCaregivers.map(c => c.id) : [])} />
+                </th>
+                <th>Name</th>
+                <th>Email</th>
+                <th>Phone</th>
+                <th>Address</th>
+                <th>Default Rate</th>
+                <th>Role</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {filteredCaregivers.map(caregiver => (
+                <tr key={caregiver.id} style={{ background: selectedIds.includes(caregiver.id) ? '#EFF6FF' : undefined }}>
+                  <td>
+                    <input type="checkbox" checked={selectedIds.includes(caregiver.id)}
+                      onChange={e => setSelectedIds(prev => e.target.checked ? [...prev, caregiver.id] : prev.filter(id => id !== caregiver.id))} />
+                  </td>
+                  <td><strong>{caregiver.first_name} {caregiver.last_name}</strong></td>
+                  <td>{caregiver.email}</td>
+                  <td><a href={`tel:${caregiver.phone}`}>{caregiver.phone || 'N/A'}</a></td>
+                  <td style={{ fontSize: '0.85rem' }}>
+                    {caregiver.address ? (
+                      <span>{[caregiver.city, caregiver.state].filter(Boolean).join(', ')} {caregiver.latitude ? '📍' : '⚠️'}</span>
+                    ) : (
+                      <span style={{ color: '#d97706' }}>⚠️ Missing</span>
+                    )}
+                  </td>
+                  <td><strong>{formatCurrency(caregiver.default_pay_rate)}</strong>/hr</td>
+                  <td>
+                    <span className={`badge ${caregiver.role === 'admin' ? 'badge-danger' : 'badge-info'}`}>
+                      {caregiver.role.toUpperCase()}
+                    </span>
+                  </td>
+                  <td>
+                    <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+                      <button className="btn btn-sm" style={{background:'#0F172A',color:'#fff',border:'none',borderRadius:6,padding:'0.25rem 0.6rem',cursor:'pointer',fontWeight:700,fontSize:'0.78rem'}} onClick={() => setDetailId(caregiver.id)}>👁 Full Profile</button>
+                      <button className="btn btn-sm btn-primary" onClick={() => handleOpenEdit(caregiver)}>Edit</button>
+                      <button className="btn btn-sm btn-secondary" onClick={() => handleOpenRates(caregiver)}>💰 Pay Rates</button>
+                      {onViewHistory && (
+                        <button className="btn btn-sm btn-secondary" onClick={() => onViewHistory(caregiver.id, caregiver.first_name + " " + caregiver.last_name)}>🕐 History</button>
+                      )}
+                      {caregiver.role !== 'admin' && (
+                        <button className="btn btn-sm btn-warning" onClick={() => handlePromoteToAdmin(caregiver.id)}>Make Admin</button>
+                      )}
+                    </div>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        </div>
+      )}
+
+      <AddCaregiverModal 
+        isOpen={showModal}
+        onClose={() => setShowModal(false)}
+        onSuccess={loadData}
+        token={token}
+      />
+
+      {/* Edit Caregiver Modal */}
+      {showEditModal && selectedCaregiver && (
+        <div className="modal active" onClick={() => setShowEditModal(false)}>
+          <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{ maxWidth: isMobile ? '95%' : '500px' }}>
+            <div className="modal-header">
+              <h2>Edit Caregiver</h2>
+              <button className="close-btn" onClick={() => setShowEditModal(false)}>×</button>
+            </div>
+
+            <form onSubmit={handleSaveEdit}>
+              <div className="form-group">
+                <label>First Name</label>
+                <input type="text" value={editData.firstName} onChange={(e) => setEditData({ ...editData, firstName: e.target.value })} />
+              </div>
+
+              <div className="form-group">
+                <label>Last Name</label>
+                <input type="text" value={editData.lastName} onChange={(e) => setEditData({ ...editData, lastName: e.target.value })} />
+              </div>
+
+              <div className="form-group">
+                <label>Phone</label>
+                <input type="tel" value={editData.phone} onChange={(e) => setEditData({ ...editData, phone: e.target.value })} />
+              </div>
+
+              <div className="form-group">
+                <label>Default Hourly Pay Rate</label>
+                <input type="number" step="0.01" min="0" value={editData.payRate} onChange={(e) => setEditData({ ...editData, payRate: e.target.value })} placeholder="15.00" />
+                <small className="text-muted">Used when no care-type-specific rate is set</small>
+              </div>
+
+              <div style={{ borderTop: '1px solid #e2e8f0', paddingTop: '1rem', marginTop: '0.5rem' }}>
+                <label style={{ fontWeight: '700', fontSize: '0.9rem', marginBottom: '0.5rem', display: 'block' }}>
+                  📍 Home Address <small style={{ fontWeight: '400', color: '#666' }}>(needed for route optimization)</small>
+                </label>
+              </div>
+
+              <div className="form-group">
+                <label>Street Address</label>
+                <input type="text" value={editData.address} onChange={(e) => setEditData({ ...editData, address: e.target.value })} placeholder="123 Main St" />
+              </div>
+
+              <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '2fr 1fr 1fr', gap: '0.75rem' }}>
+                <div className="form-group">
+                  <label>City</label>
+                  <input type="text" value={editData.city} onChange={(e) => setEditData({ ...editData, city: e.target.value })} placeholder="Eau Claire" />
+                </div>
+                <div className="form-group">
+                  <label>State</label>
+                  <input type="text" value={editData.state} onChange={(e) => setEditData({ ...editData, state: e.target.value })} placeholder="WI" maxLength="2" />
+                </div>
+                <div className="form-group">
+                  <label>Zip</label>
+                  <input type="text" value={editData.zip} onChange={(e) => setEditData({ ...editData, zip: e.target.value })} placeholder="54701" maxLength="10" />
+                </div>
+              </div>
+
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Save Changes</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowEditModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* Pay Rates by Care Type Modal */}
+      {showRatesModal && selectedCaregiver && (
+        <div className="modal active" onClick={() => setShowRatesModal(false)}>
+          <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{ maxWidth: isMobile ? '95%' : '700px' }}>
+            <div className="modal-header">
+              <h2>💰 Pay Rates</h2>
+              <button className="close-btn" onClick={() => setShowRatesModal(false)}>×</button>
+            </div>
+
+            <div style={{ marginBottom: '1rem' }}>
+              <strong>{selectedCaregiver.first_name} {selectedCaregiver.last_name}</strong>
+            </div>
+
+            <div className="card" style={{ background: '#f9f9f9', marginBottom: '1.5rem', padding: '1rem' }}>
+              <p style={{ margin: 0 }}>
+                <strong>Default Rate:</strong> {formatCurrency(selectedCaregiver.default_pay_rate)}/hr
+              </p>
+              <small className="text-muted">
+                Used when no care-type-specific rate is set
+              </small>
+            </div>
+
+            <h4>Care Type Rates</h4>
+
+            {getAvailableCareTypes().length > 0 && (
+              <form onSubmit={handleAddRate} style={{ marginBottom: '1.5rem' }}>
+                <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '2fr 1fr auto', gap: '0.75rem', alignItems: 'end' }}>
+                  <div className="form-group" style={{ marginBottom: 0 }}>
+                    <label>Care Type</label>
+                    <select value={rateFormData.careTypeId} onChange={(e) => setRateFormData({ ...rateFormData, careTypeId: e.target.value })} required>
+                      <option value="">Select care type...</option>
+                      {getAvailableCareTypes().map(ct => (
+                        <option key={ct.id} value={ct.id}>{ct.name}</option>
+                      ))}
+                    </select>
+                  </div>
+
+                  <div className="form-group" style={{ marginBottom: 0 }}>
+                    <label>Hourly Rate</label>
+                    <input type="number" step="0.01" min="0" value={rateFormData.hourlyRate} onChange={(e) => setRateFormData({ ...rateFormData, hourlyRate: e.target.value })} placeholder="15.00" required />
+                  </div>
+
+                  <button type="submit" className="btn btn-primary" style={{ height: 'fit-content' }}>Add</button>
+                </div>
+              </form>
+            )}
+
+            {caregiverRates.length === 0 ? (
+              <div className="card card-centered">
+                <p>No care-type-specific rates. Default rate will be used.</p>
+              </div>
+            ) : isMobile ? (
+              <div>
+                {caregiverRates.map(rate => (
+                  <div key={rate.id} className="card" style={{ marginBottom: '0.5rem', padding: '0.75rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                    <div>
+                      <strong>{rate.care_type_name}</strong>
+                      <div style={{ fontSize: '0.9rem' }}>{formatCurrency(rate.hourly_rate)}/hr</div>
+                    </div>
+                    <button className="btn btn-sm btn-danger" onClick={() => handleDeleteRate(rate.id)}>✕</button>
+                  </div>
+                ))}
+              </div>
+            ) : (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Care Type</th>
+                    <th>Hourly Rate</th>
+                    <th>Effective Date</th>
+                    <th>Actions</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {caregiverRates.map(rate => (
+                    <tr key={rate.id}>
+                      <td><strong>{rate.care_type_name}</strong></td>
+                      <td><strong>{formatCurrency(rate.hourly_rate)}</strong>/hr</td>
+                      <td>{new Date(rate.effective_date).toLocaleDateString()}</td>
+                      <td>
+                        <button className="btn btn-sm btn-danger" onClick={() => handleDeleteRate(rate.id)}>Remove</button>
+                      </td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            )}
+
+            <div className="modal-actions" style={{ marginTop: '1rem' }}>
+              <button className="btn btn-secondary" onClick={() => setShowRatesModal(false)}>Close</button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default CaregiverManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CaregiverProfile.jsx b/templates/crm-homecare/frontend/src/components/admin/CaregiverProfile.jsx
new file mode 100644
index 0000000..3dfebe0
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CaregiverProfile.jsx
@@ -0,0 +1,464 @@
+// src/components/admin/CaregiverProfile.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const CaregiverProfile = ({ caregiverId, token, onBack }) => {
+  const [caregiver, setCaregiver] = useState(null);
+  const [profile, setProfile] = useState(null);
+  const [certifications, setCertifications] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [editing, setEditing] = useState(false);
+  const [editingCerts, setEditingCerts] = useState(false);
+  const [message, setMessage] = useState('');
+  const [formData, setFormData] = useState({
+    notes: '',
+    capabilities: '',
+    limitations: '',
+    availableDaysOfWeek: [],
+    preferredHours: '',
+  });
+  const [newCert, setNewCert] = useState({
+    certificationName: '',
+    issuedDate: '',
+    expirationDate: '',
+    certificationNumber: '',
+    issuer: ''
+  });
+
+  useEffect(() => {
+    loadCaregiverData();
+  }, [caregiverId]);
+
+  const loadCaregiverData = async () => {
+    try {
+      const [caregiverRes, profileRes, certsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/users/caregivers/${caregiverId}`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/caregiver-profile/${caregiverId}`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/certifications`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const caregiverData = await caregiverRes.json();
+      const profileData = await profileRes.json();
+      const certsData = await certsRes.json();
+
+      setCaregiver(caregiverData);
+      setProfile(profileData);
+      setCertifications(Array.isArray(certsData) ? certsData : []);
+      setFormData({
+        notes: profileData?.notes || '',
+        capabilities: profileData?.capabilities || '',
+        limitations: profileData?.limitations || '',
+        availableDaysOfWeek: profileData?.available_days_of_week || [],
+        preferredHours: profileData?.preferred_hours || '',
+      });
+    } catch (error) {
+      console.error('Failed to load caregiver data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSaveProfile = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregiver-profile/${caregiverId}`, {
+        method: 'PATCH',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) throw new Error('Failed to save');
+
+      setMessage('Profile updated');
+      setTimeout(() => setMessage(''), 2000);
+      setEditing(false);
+      loadCaregiverData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleAddCertification = async (e) => {
+    e.preventDefault();
+
+    if (!newCert.certificationName || !newCert.issuedDate || !newCert.expirationDate) {
+      setMessage('Certification name, issued date, and expiration date are required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/certifications`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(newCert)
+      });
+
+      if (!response.ok) throw new Error('Failed to add certification');
+
+      setMessage('Certification added');
+      setTimeout(() => setMessage(''), 2000);
+      setNewCert({
+        certificationName: '',
+        issuedDate: '',
+        expirationDate: '',
+        certificationNumber: '',
+        issuer: ''
+      });
+      setEditingCerts(false);
+      loadCaregiverData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeleteCertification = async (certId) => {
+    if (!window.confirm('Delete this certification?')) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/certifications/${certId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Certification deleted');
+      setTimeout(() => setMessage(''), 2000);
+      loadCaregiverData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const toggleDay = (day) => {
+    setFormData(prev => {
+      const days = [...prev.availableDaysOfWeek];
+      if (days.includes(day)) {
+        return { ...prev, availableDaysOfWeek: days.filter(d => d !== day) };
+      } else {
+        return { ...prev, availableDaysOfWeek: [...days, day].sort() };
+      }
+    });
+  };
+
+  const isExpiringSoon = (expirationDate) => {
+    const expDate = new Date(expirationDate);
+    const today = new Date();
+    const daysUntilExpire = Math.floor((expDate - today) / (1000 * 60 * 60 * 24));
+    return daysUntilExpire < 90 && daysUntilExpire >= 0;
+  };
+
+  const isExpired = (expirationDate) => {
+    const expDate = new Date(expirationDate);
+    const today = new Date();
+    return expDate < today;
+  };
+
+  const dayLabels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  if (!caregiver) {
+    return <div className="card card-centered"><p>Caregiver not found</p></div>;
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <button className="btn btn-secondary" onClick={onBack}>Back</button>
+        <h2>{caregiver.first_name} {caregiver.last_name}</h2>
+        <button 
+          className="btn btn-primary"
+          onClick={() => setEditing(!editing)}
+        >
+          {editing ? 'Done' : 'Edit'}
+        </button>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Basic Info */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))' }}>
+        <div className="card">
+          <h3>Contact Information</h3>
+          <p><strong>Email:</strong> {caregiver.email}</p>
+          <p><strong>Phone:</strong> {caregiver.phone || 'Not provided'}</p>
+          <p><strong>Hire Date:</strong> {caregiver.hire_date ? new Date(caregiver.hire_date).toLocaleDateString() : 'N/A'}</p>
+          <p><strong>Role:</strong> <span className="badge badge-info">{caregiver.role?.toUpperCase()}</span></p>
+        </div>
+
+        <div className="card">
+          <h3>📍 Home Address</h3>
+          {caregiver.address ? (
+            <>
+              <p>{caregiver.address}</p>
+              <p>{[caregiver.city, caregiver.state, caregiver.zip].filter(Boolean).join(', ')}</p>
+              <p style={{ fontSize: '0.85rem', color: caregiver.latitude ? '#16a34a' : '#d97706' }}>
+                {caregiver.latitude ? `✅ Geocoded (${Number(caregiver.latitude).toFixed(4)}, ${Number(caregiver.longitude).toFixed(4)})` : '⚠️ Not geocoded — use Route Optimizer → GPS & Geofence tab'}
+              </p>
+            </>
+          ) : (
+            <p style={{ color: '#d97706' }}>⚠️ No address on file. Edit via Caregivers → Edit to add home address for route optimization.</p>
+          )}
+        </div>
+      </div>
+
+      {/* Certifications Section */}
+      <div className="card">
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #ddd' }}>
+          <h3 style={{ margin: 0 }}>Certifications & Credentials</h3>
+          <button
+            className="btn btn-sm btn-primary"
+            onClick={() => setEditingCerts(!editingCerts)}
+          >
+            {editingCerts ? 'Cancel' : 'Add Certification'}
+          </button>
+        </div>
+
+        {editingCerts && (
+          <form onSubmit={handleAddCertification} style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+            <h4>Add New Certification</h4>
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Certification Name *</label>
+                <input
+                  type="text"
+                  value={newCert.certificationName}
+                  onChange={(e) => setNewCert({ ...newCert, certificationName: e.target.value })}
+                  placeholder="e.g., CNA, LPN, RN, CPR, First Aid"
+                  required
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Issuer / Organization</label>
+                <input
+                  type="text"
+                  value={newCert.issuer}
+                  onChange={(e) => setNewCert({ ...newCert, issuer: e.target.value })}
+                  placeholder="e.g., American Red Cross"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Certification Number</label>
+                <input
+                  type="text"
+                  value={newCert.certificationNumber}
+                  onChange={(e) => setNewCert({ ...newCert, certificationNumber: e.target.value })}
+                  placeholder="License or cert number"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Issued Date *</label>
+                <input
+                  type="date"
+                  value={newCert.issuedDate}
+                  onChange={(e) => setNewCert({ ...newCert, issuedDate: e.target.value })}
+                  required
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Expiration Date *</label>
+                <input
+                  type="date"
+                  value={newCert.expirationDate}
+                  onChange={(e) => setNewCert({ ...newCert, expirationDate: e.target.value })}
+                  required
+                />
+              </div>
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Add Certification</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setEditingCerts(false)}>Cancel</button>
+            </div>
+          </form>
+        )}
+
+        {certifications.length === 0 ? (
+          <p style={{ color: '#999', textAlign: 'center', padding: '1rem' }}>No certifications recorded.</p>
+        ) : (
+          <div style={{ display: 'grid', gap: '1rem' }}>
+            {certifications.map(cert => {
+              const expired = isExpired(cert.expiration_date);
+              const expiringSoon = isExpiringSoon(cert.expiration_date);
+
+              return (
+                <div
+                  key={cert.id}
+                  style={{
+                    padding: '1rem',
+                    background: expired ? '#fff3cd' : expiringSoon ? '#fff9e6' : '#f9f9f9',
+                    border: `1px solid ${expired ? '#ffc107' : expiringSoon ? '#ffeb3b' : '#ddd'}`,
+                    borderRadius: '6px'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '0.5rem' }}>
+                    <div>
+                      <strong>{cert.certification_name}</strong>
+                      {cert.issuer && <div style={{ fontSize: '0.85rem', color: '#666' }}>Issuer: {cert.issuer}</div>}
+                      {cert.certification_number && <div style={{ fontSize: '0.85rem', color: '#666' }}>Cert #: {cert.certification_number}</div>}
+                    </div>
+                    <div style={{ display: 'flex', gap: '0.5rem' }}>
+                      {expired && <span className="badge" style={{ background: '#dc3545' }}>EXPIRED</span>}
+                      {expiringSoon && !expired && <span className="badge" style={{ background: '#ffc107', color: 'black' }}>EXPIRING SOON</span>}
+                      <button
+                        className="btn btn-sm btn-danger"
+                        onClick={() => handleDeleteCertification(cert.id)}
+                      >
+                        Delete
+                      </button>
+                    </div>
+                  </div>
+
+                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem', fontSize: '0.9rem' }}>
+                    <div>
+                      <strong>Issued:</strong> {new Date(cert.issued_date).toLocaleDateString()}
+                    </div>
+                    <div>
+                      <strong>Expires:</strong> {new Date(cert.expiration_date).toLocaleDateString()}
+                    </div>
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        )}
+      </div>
+
+      {/* Profile Editing */}
+      {editing ? (
+        <div className="card card-form">
+          <h3>Edit Caregiver Profile</h3>
+
+          <div className="form-group">
+            <label>What They Can Do *</label>
+            <textarea
+              value={formData.capabilities}
+              onChange={(e) => setFormData({ ...formData, capabilities: e.target.value })}
+              placeholder="Describe tasks and skills (e.g., medication management, meal prep, mobility assistance...)"
+              rows="4"
+            ></textarea>
+          </div>
+
+          <div className="form-group">
+            <label>Limitations / Restrictions *</label>
+            <textarea
+              value={formData.limitations}
+              onChange={(e) => setFormData({ ...formData, limitations: e.target.value })}
+              placeholder="Any limitations or restrictions (e.g., cannot lift more than X pounds...)"
+              rows="4"
+            ></textarea>
+          </div>
+
+          <div className="form-group">
+            <label>Available Days of Week *</label>
+            <div className="availability-grid">
+              {dayLabels.map((day, idx) => (
+                <label key={day} className="checkbox-label">
+                  <input
+                    type="checkbox"
+                    checked={formData.availableDaysOfWeek.includes(idx)}
+                    onChange={() => toggleDay(idx)}
+                    className="form-checkbox"
+                  />
+                  <span>{day}</span>
+                </label>
+              ))}
+            </div>
+          </div>
+
+          <div className="form-group">
+            <label>Preferred Hours</label>
+            <input
+              type="text"
+              value={formData.preferredHours}
+              onChange={(e) => setFormData({ ...formData, preferredHours: e.target.value })}
+              placeholder="e.g., 8am-5pm, No early mornings, Weekends only..."
+            />
+          </div>
+
+          <div className="form-group">
+            <label>General Notes</label>
+            <textarea
+              value={formData.notes}
+              onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+              placeholder="Any other relevant information..."
+              rows="4"
+            ></textarea>
+          </div>
+
+          <div className="form-actions">
+            <button className="btn btn-primary" onClick={handleSaveProfile}>Save Changes</button>
+            <button className="btn btn-secondary" onClick={() => setEditing(false)}>Cancel</button>
+          </div>
+        </div>
+      ) : (
+        <>
+          {/* View Mode */}
+          <div className="card">
+            <h3>Capabilities</h3>
+            <p>{formData.capabilities || 'Not specified'}</p>
+          </div>
+
+          <div className="card">
+            <h3>Limitations</h3>
+            <p>{formData.limitations || 'None specified'}</p>
+          </div>
+
+          <div className="card">
+            <h3>Availability</h3>
+            <div className="availability-display">
+              <p><strong>Days Available:</strong></p>
+              <div className="availability-badges">
+                {formData.availableDaysOfWeek.length > 0 ? (
+                  formData.availableDaysOfWeek.map(idx => (
+                    <span key={idx} className="badge badge-success">{dayLabels[idx]}</span>
+                  ))
+                ) : (
+                  <span className="badge badge-secondary">Not specified</span>
+                )}
+              </div>
+              {formData.preferredHours && (
+                <p><strong>Preferred Hours:</strong> {formData.preferredHours}</p>
+              )}
+            </div>
+          </div>
+
+          {formData.notes && (
+            <div className="card">
+              <h3>Notes</h3>
+              <p>{formData.notes}</p>
+            </div>
+          )}
+        </>
+      )}
+    </div>
+  );
+};
+
+export default CaregiverProfile;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ClaimsManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/ClaimsManagement.jsx
new file mode 100644
index 0000000..07daacd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ClaimsManagement.jsx
@@ -0,0 +1,509 @@
+import { toast } from '../Toast';
+// src/components/admin/ClaimsManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ClaimsManagement = ({ token }) => {
+  const [claims, setClaims] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ status: '', payerId: '' });
+  const [payers, setPayers] = useState([]);
+  const [selectedClaims, setSelectedClaims] = useState([]);
+  const [showCreateModal, setShowCreateModal] = useState(false);
+  const [showStatusModal, setShowStatusModal] = useState(false);
+  const [currentClaim, setCurrentClaim] = useState(null);
+  const [invoices, setInvoices] = useState([]);
+  const [summary, setSummary] = useState(null);
+
+  useEffect(() => {
+    loadClaims();
+    loadPayers();
+    loadSummary();
+  }, [filter]);
+
+  const loadClaims = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.status) params.append('status', filter.status);
+      if (filter.payerId) params.append('payerId', filter.payerId);
+      
+      const res = await fetch(`${API_BASE_URL}/api/claims?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClaims(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load claims:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadPayers = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/referral-sources`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setPayers(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load payers:', error);
+    }
+  };
+
+  const loadSummary = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/claims/reports/summary`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setSummary(data);
+    } catch (error) {
+      console.error('Failed to load summary:', error);
+    }
+  };
+
+  const loadInvoices = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/billing/invoices?status=pending`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setInvoices(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load invoices:', error);
+    }
+  };
+
+  const createClaim = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/claims`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowCreateModal(false);
+        loadClaims();
+        loadSummary();
+      }
+    } catch (error) {
+      toast('Failed to create claim: ' + error.message, 'error');
+    }
+  };
+
+  const updateClaimStatus = async (status, additionalData = {}) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/claims/${currentClaim.id}/status`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ status, ...additionalData })
+      });
+      if (res.ok) {
+        setShowStatusModal(false);
+        setCurrentClaim(null);
+        loadClaims();
+        loadSummary();
+      }
+    } catch (error) {
+      toast('Failed to update status: ' + error.message, 'error');
+    }
+  };
+
+  const export837P = async () => {
+    if (selectedClaims.length === 0) {
+      toast('Select at least one claim to export');
+      return;
+    }
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/claims/export/837p`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ claimIds: selectedClaims })
+      });
+      if (res.ok) {
+        const blob = await res.blob();
+        const url = window.URL.createObjectURL(blob);
+        const a = document.createElement('a');
+        a.href = url;
+        a.download = `claims-837p-${new Date().toISOString().split('T')[0]}.edi`;
+        a.click();
+        loadClaims();
+        setSelectedClaims([]);
+      }
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const toggleClaimSelection = (claimId) => {
+    setSelectedClaims(prev => 
+      prev.includes(claimId) 
+        ? prev.filter(id => id !== claimId)
+        : [...prev, claimId]
+    );
+  };
+
+  const selectAllDraft = () => {
+    const draftIds = claims.filter(c => c.status === 'draft' || c.status === 'ready').map(c => c.id);
+    setSelectedClaims(draftIds);
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      draft: '#9e9e9e',
+      ready: '#2196f3',
+      submitted: '#ff9800',
+      accepted: '#8bc34a',
+      paid: '#4caf50',
+      rejected: '#f44336',
+      denied: '#f44336'
+    };
+    return (
+      <span style={{
+        padding: '4px 8px',
+        borderRadius: '4px',
+        fontSize: '0.8rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>💼 Claims Management</h2>
+        <div style={{ display: 'flex', gap: '0.5rem' }}>
+          <button className="btn btn-primary" onClick={() => { loadInvoices(); setShowCreateModal(true); }}>
+            + New Claim
+          </button>
+          <button 
+            className="btn btn-secondary" 
+            onClick={export837P}
+            disabled={selectedClaims.length === 0}
+          >
+            📤 Export 837P ({selectedClaims.length})
+          </button>
+        </div>
+      </div>
+
+      {/* Summary Cards */}
+      {summary && (
+        <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', marginBottom: '1rem' }}>
+          <div className="stat-card">
+            <h4>Pending</h4>
+            <div className="value">${(parseFloat(summary.aging?.under_30) || 0).toLocaleString()}</div>
+            <small>&lt; 30 days</small>
+          </div>
+          <div className="stat-card">
+            <h4>30-60 Days</h4>
+            <div className="value" style={{ color: '#ff9800' }}>${(parseFloat(summary.aging?.days_30_60) || 0).toLocaleString()}</div>
+          </div>
+          <div className="stat-card">
+            <h4>60-90 Days</h4>
+            <div className="value" style={{ color: '#f44336' }}>${(parseFloat(summary.aging?.days_60_90) || 0).toLocaleString()}</div>
+          </div>
+          <div className="stat-card">
+            <h4>90+ Days</h4>
+            <div className="value" style={{ color: '#b71c1c' }}>${(parseFloat(summary.aging?.over_90) || 0).toLocaleString()}</div>
+          </div>
+        </div>
+      )}
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', alignItems: 'center' }}>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Status</label>
+            <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+              <option value="">All Statuses</option>
+              <option value="draft">Draft</option>
+              <option value="ready">Ready</option>
+              <option value="submitted">Submitted</option>
+              <option value="accepted">Accepted</option>
+              <option value="paid">Paid</option>
+              <option value="rejected">Rejected</option>
+              <option value="denied">Denied</option>
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Payer</label>
+            <select value={filter.payerId} onChange={(e) => setFilter({ ...filter, payerId: e.target.value })}>
+              <option value="">All Payers</option>
+              {payers.map(p => (
+                <option key={p.id} value={p.id}>{p.name}</option>
+              ))}
+            </select>
+          </div>
+          <button className="btn btn-secondary" onClick={selectAllDraft} style={{ marginTop: '1.5rem' }}>
+            Select All Draft/Ready
+          </button>
+        </div>
+      </div>
+
+      {/* Claims Table */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : claims.length === 0 ? (
+          <p>No claims found. Create a claim from an invoice to get started.</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th style={{ width: '40px' }}>
+                  <input 
+                    type="checkbox" 
+                    onChange={(e) => e.target.checked ? selectAllDraft() : setSelectedClaims([])}
+                    checked={selectedClaims.length > 0}
+                  />
+                </th>
+                <th>Claim #</th>
+                <th>Client</th>
+                <th>Payer</th>
+                <th>Service Date</th>
+                <th>Amount</th>
+                <th>Status</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {claims.map(claim => (
+                <tr key={claim.id}>
+                  <td>
+                    <input 
+                      type="checkbox"
+                      checked={selectedClaims.includes(claim.id)}
+                      onChange={() => toggleClaimSelection(claim.id)}
+                      disabled={claim.status === 'paid' || claim.status === 'denied'}
+                    />
+                  </td>
+                  <td><strong>{claim.claim_number}</strong></td>
+                  <td>{claim.client_first_name} {claim.client_last_name}</td>
+                  <td>{claim.payer_name}</td>
+                  <td>{claim.service_date_from ? new Date(claim.service_date_from).toLocaleDateString() : '-'}</td>
+                  <td><strong>${(parseFloat(claim.charge_amount) || 0).toFixed(2)}</strong></td>
+                  <td>{getStatusBadge(claim.status)}</td>
+                  <td>
+                    <button 
+                      className="btn btn-sm btn-secondary"
+                      onClick={() => { setCurrentClaim(claim); setShowStatusModal(true); }}
+                    >
+                      Update
+                    </button>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Create Claim Modal */}
+      {showCreateModal && (
+        <div className="modal-overlay" onClick={() => setShowCreateModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Create Claim from Invoice</h3>
+              <button className="modal-close" onClick={() => setShowCreateModal(false)}>×</button>
+            </div>
+            <CreateClaimForm 
+              invoices={invoices} 
+              onSubmit={createClaim} 
+              onCancel={() => setShowCreateModal(false)} 
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Update Status Modal */}
+      {showStatusModal && currentClaim && (
+        <div className="modal-overlay" onClick={() => setShowStatusModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Update Claim Status</h3>
+              <button className="modal-close" onClick={() => setShowStatusModal(false)}>×</button>
+            </div>
+            <UpdateStatusForm 
+              claim={currentClaim} 
+              onSubmit={updateClaimStatus} 
+              onCancel={() => setShowStatusModal(false)} 
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Create Claim Form Component
+const CreateClaimForm = ({ invoices, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    invoiceId: '',
+    procedureCode: 'T1019',
+    diagnosisCode: 'Z7689',
+    modifier: '',
+    placeOfService: '12'
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.invoiceId) {
+      toast('Please select an invoice');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Invoice *</label>
+        <select 
+          value={formData.invoiceId} 
+          onChange={(e) => setFormData({ ...formData, invoiceId: e.target.value })}
+          required
+        >
+          <option value="">Select Invoice</option>
+          {invoices.map(inv => (
+            <option key={inv.id} value={inv.id}>
+              {inv.invoice_number} - {inv.client_first_name} {inv.client_last_name} - ${(parseFloat(inv.total) || 0).toFixed(2)}
+            </option>
+          ))}
+        </select>
+      </div>
+      <div className="form-group">
+        <label>Procedure Code (CPT/HCPCS)</label>
+        <input 
+          type="text" 
+          value={formData.procedureCode}
+          onChange={(e) => setFormData({ ...formData, procedureCode: e.target.value })}
+          placeholder="e.g., T1019, S5125"
+        />
+      </div>
+      <div className="form-group">
+        <label>Diagnosis Code (ICD-10)</label>
+        <input 
+          type="text" 
+          value={formData.diagnosisCode}
+          onChange={(e) => setFormData({ ...formData, diagnosisCode: e.target.value })}
+          placeholder="e.g., Z7689"
+        />
+      </div>
+      <div className="form-group">
+        <label>Modifier</label>
+        <input 
+          type="text" 
+          value={formData.modifier}
+          onChange={(e) => setFormData({ ...formData, modifier: e.target.value })}
+          placeholder="e.g., GT, 95"
+        />
+      </div>
+      <div className="form-group">
+        <label>Place of Service</label>
+        <select 
+          value={formData.placeOfService}
+          onChange={(e) => setFormData({ ...formData, placeOfService: e.target.value })}
+        >
+          <option value="12">12 - Home</option>
+          <option value="11">11 - Office</option>
+          <option value="99">99 - Other</option>
+        </select>
+      </div>
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Create Claim</button>
+      </div>
+    </form>
+  );
+};
+
+// Update Status Form Component
+const UpdateStatusForm = ({ claim, onSubmit, onCancel }) => {
+  const [status, setStatus] = useState(claim.status);
+  const [paidAmount, setPaidAmount] = useState('');
+  const [denialReason, setDenialReason] = useState('');
+  const [notes, setNotes] = useState('');
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    const additionalData = {};
+    if (status === 'paid') additionalData.paidAmount = parseFloat(paidAmount);
+    if (status === 'denied') additionalData.denialReason = denialReason;
+    additionalData.notes = notes;
+    onSubmit(status, additionalData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <p><strong>Claim:</strong> {claim.claim_number}</p>
+      <p><strong>Amount:</strong> ${(parseFloat(claim.charge_amount) || 0).toFixed(2)}</p>
+      
+      <div className="form-group">
+        <label>New Status</label>
+        <select value={status} onChange={(e) => setStatus(e.target.value)}>
+          <option value="draft">Draft</option>
+          <option value="ready">Ready to Submit</option>
+          <option value="submitted">Submitted</option>
+          <option value="accepted">Accepted</option>
+          <option value="paid">Paid</option>
+          <option value="rejected">Rejected</option>
+          <option value="denied">Denied</option>
+        </select>
+      </div>
+
+      {status === 'paid' && (
+        <div className="form-group">
+          <label>Paid Amount</label>
+          <input 
+            type="number" 
+            step="0.01"
+            value={paidAmount}
+            onChange={(e) => setPaidAmount(e.target.value)}
+            placeholder="Enter amount received"
+          />
+        </div>
+      )}
+
+      {status === 'denied' && (
+        <div className="form-group">
+          <label>Denial Reason</label>
+          <textarea 
+            value={denialReason}
+            onChange={(e) => setDenialReason(e.target.value)}
+            placeholder="Enter denial reason/code"
+          />
+        </div>
+      )}
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={notes}
+          onChange={(e) => setNotes(e.target.value)}
+          placeholder="Optional notes"
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Update Status</button>
+      </div>
+    </form>
+  );
+};
+
+export default ClaimsManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ClientModal.jsx b/templates/crm-homecare/frontend/src/components/admin/ClientModal.jsx
new file mode 100644
index 0000000..9efaca1
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ClientModal.jsx
@@ -0,0 +1,88 @@
+import { useState } from 'react';
+import { createClient } from '../../config.js';
+import { useToast } from '../../contexts/ToastContext.jsx';
+import { X } from 'lucide-react';
+
+const SERVICE_TYPES = ['personal_care', 'companionship', 'respite_care', 'skilled_nursing', 'homemaker'];
+
+export default function ClientModal({ onClose, onSaved }) {
+  const toast = useToast();
+  const [loading, setLoading] = useState(false);
+  const [form, setForm] = useState({
+    firstName: '', lastName: '', phone: '', email: '', address: '',
+    city: '', state: '', zip: '', serviceType: 'personal_care',
+    dateOfBirth: '', gender: '', insuranceProvider: '', insuranceId: '', notes: '',
+  });
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    if (!form.firstName || !form.lastName) return toast('First and last name required', 'error');
+    setLoading(true);
+    try {
+      await createClient(form);
+      toast('Client created', 'success');
+      onSaved();
+    } catch (err) { toast(err.message, 'error'); }
+    finally { setLoading(false); }
+  };
+
+  const field = (key, label, type = 'text', opts = {}) => (
+    <div>
+      <label className="block text-xs font-medium text-gray-600 mb-1">{label}</label>
+      <input type={type} value={form[key]} onChange={e => setForm(p => ({ ...p, [key]: e.target.value }))}
+        className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-1" {...opts} />
+    </div>
+  );
+
+  return (
+    <div className="fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4">
+      <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
+        <div className="flex items-center justify-between p-6 border-b">
+          <h2 className="font-bold text-lg">Add New Client</h2>
+          <button onClick={onClose}><X size={20} className="text-gray-400" /></button>
+        </div>
+        <form onSubmit={handleSubmit} className="p-6 space-y-4">
+          <div className="grid grid-cols-2 gap-4">
+            {field('firstName', 'First Name *')}
+            {field('lastName', 'Last Name *')}
+            {field('dateOfBirth', 'Date of Birth', 'date')}
+            <div>
+              <label className="block text-xs font-medium text-gray-600 mb-1">Gender</label>
+              <select value={form.gender} onChange={e => setForm(p => ({ ...p, gender: e.target.value }))}
+                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none">
+                <option value="">Select…</option>
+                {['Male', 'Female', 'Non-binary', 'Prefer not to say'].map(g => <option key={g} value={g}>{g}</option>)}
+              </select>
+            </div>
+            {field('phone', 'Phone', 'tel')}
+            {field('email', 'Email', 'email')}
+            {field('address', 'Address')}
+            {field('city', 'City')}
+            {field('state', 'State')}
+            {field('zip', 'ZIP')}
+            <div>
+              <label className="block text-xs font-medium text-gray-600 mb-1">Service Type</label>
+              <select value={form.serviceType} onChange={e => setForm(p => ({ ...p, serviceType: e.target.value }))}
+                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none">
+                {SERVICE_TYPES.map(t => <option key={t} value={t}>{t.replace(/_/g, ' ')}</option>)}
+              </select>
+            </div>
+            {field('insuranceProvider', 'Insurance Provider')}
+            {field('insuranceId', 'Insurance ID')}
+          </div>
+          <div>
+            <label className="block text-xs font-medium text-gray-600 mb-1">Notes</label>
+            <textarea value={form.notes} onChange={e => setForm(p => ({ ...p, notes: e.target.value }))}
+              rows={3} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none resize-none" />
+          </div>
+          <div className="flex gap-3 pt-2">
+            <button type="button" onClick={onClose} className="flex-1 py-2 border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50">Cancel</button>
+            <button type="submit" disabled={loading} className="flex-1 py-2 rounded-lg text-white text-sm font-medium disabled:opacity-70" style={{ backgroundColor: 'var(--color-primary)' }}>
+              {loading ? 'Saving…' : 'Create Client'}
+            </button>
+          </div>
+        </form>
+      </div>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/ClientOnboarding.jsx b/templates/crm-homecare/frontend/src/components/admin/ClientOnboarding.jsx
new file mode 100644
index 0000000..d847121
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ClientOnboarding.jsx
@@ -0,0 +1,377 @@
+// src/components/admin/ClientOnboarding.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ClientOnboarding = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [expandedClient, setExpandedClient] = useState(null);
+  const [expandedStep, setExpandedStep] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState('');
+  const [clientData, setClientData] = useState({});
+
+  useEffect(() => {
+    loadClients();
+  }, []);
+
+  const loadClients = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setClients(data);
+      
+      // Load onboarding data for each client
+      data.forEach(client => {
+        loadClientData(client.id);
+      });
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadClientData = async (clientId) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients/${clientId}/onboarding`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setClientData(prev => ({
+        ...prev,
+        [clientId]: data || {}
+      }));
+    } catch (error) {
+      console.error('Failed to load client onboarding data:', error);
+    }
+  };
+
+  const onboardingSteps = [
+    {
+      id: 'emergency_contacts',
+      label: 'Emergency Contacts',
+      description: 'Primary and secondary emergency contact information',
+      fields: ['emergency_contact_1_name', 'emergency_contact_1_phone', 'emergency_contact_1_relationship', 
+               'emergency_contact_2_name', 'emergency_contact_2_phone', 'emergency_contact_2_relationship']
+    },
+    {
+      id: 'medical_history',
+      label: 'Medical History',
+      description: 'Conditions, medications, allergies, and medical alerts',
+      fields: ['medical_conditions', 'current_medications', 'medication_allergies', 'medical_alerts']
+    },
+    {
+      id: 'insurance_info',
+      label: 'Insurance Information',
+      description: 'Insurance provider and policy details',
+      fields: ['insurance_provider', 'insurance_policy_number', 'insurance_group_number', 'insurance_contact']
+    },
+    {
+      id: 'care_preferences',
+      label: 'Care Preferences',
+      description: 'Client preferences and preferred caregivers',
+      fields: ['care_preferences', 'preferred_caregivers', 'mobility_assistance_needs', 'communication_preferences']
+    },
+    {
+      id: 'family_communication',
+      label: 'Family Communication Plan',
+      description: 'How and when to contact family',
+      fields: ['family_contact_name', 'family_contact_phone', 'family_contact_email', 'communication_frequency', 'communication_method']
+    },
+    {
+      id: 'initial_assessment',
+      label: 'Initial Assessment',
+      description: 'Comprehensive care assessment and goals',
+      fields: ['assessment_date', 'functional_status', 'care_goals', 'assessment_notes']
+    }
+  ];
+
+  const handleSaveStep = async (clientId, stepId, formValues) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients/${clientId}/onboarding/${stepId}`, {
+        method: 'PATCH',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formValues)
+      });
+
+      if (!response.ok) throw new Error('Failed to save');
+
+      await loadClientData(clientId);
+      setMessage('Onboarding step saved successfully!');
+      setTimeout(() => setMessage(''), 2000);
+      setExpandedStep(null);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const calculateProgress = (client) => {
+    const data = clientData[client.id] || {};
+    const completedSteps = onboardingSteps.filter(step => {
+      const hasData = step.fields.some(field => data[field]);
+      return hasData;
+    }).length;
+    return Math.round((completedSteps / onboardingSteps.length) * 100);
+  };
+
+  const getStepStatus = (client, stepId) => {
+    const data = clientData[client.id] || {};
+    const step = onboardingSteps.find(s => s.id === stepId);
+    if (!step) return false;
+    return step.fields.some(field => data[field]);
+  };
+
+  const renderStepForm = (client, step) => {
+    const data = clientData[client.id] || {};
+
+    const renderField = (fieldName, label, type = 'text') => (
+      <div key={fieldName} className="form-group">
+        <label>{label}</label>
+        {type === 'textarea' ? (
+          <textarea
+            id={fieldName}
+            defaultValue={data[fieldName] || ''}
+            rows="3"
+          ></textarea>
+        ) : (
+          <input
+            id={fieldName}
+            type={type}
+            defaultValue={data[fieldName] || ''}
+          />
+        )}
+      </div>
+    );
+
+    const getFormValues = () => {
+      const values = {};
+      step.fields.forEach(field => {
+        const element = document.getElementById(field);
+        if (element) {
+          values[field] = element.value;
+        }
+      });
+      return values;
+    };
+
+    return (
+      <div className="card card-form">
+        <h4>{step.label}</h4>
+
+        {step.id === 'emergency_contacts' && (
+          <div>
+            <h5 style={{ marginTop: '1rem', marginBottom: '0.5rem' }}>Primary Contact</h5>
+            <div className="form-grid-2">
+              {renderField('emergency_contact_1_name', 'Name')}
+              {renderField('emergency_contact_1_phone', 'Phone', 'tel')}
+              {renderField('emergency_contact_1_relationship', 'Relationship')}
+            </div>
+
+            <h5 style={{ marginTop: '1rem', marginBottom: '0.5rem' }}>Secondary Contact</h5>
+            <div className="form-grid-2">
+              {renderField('emergency_contact_2_name', 'Name')}
+              {renderField('emergency_contact_2_phone', 'Phone', 'tel')}
+              {renderField('emergency_contact_2_relationship', 'Relationship')}
+            </div>
+          </div>
+        )}
+
+        {step.id === 'medical_history' && (
+          <div className="form-grid">
+            {renderField('medical_conditions', 'Medical Conditions', 'textarea')}
+            {renderField('current_medications', 'Current Medications', 'textarea')}
+            {renderField('medication_allergies', 'Medication Allergies', 'textarea')}
+            {renderField('medical_alerts', 'Medical Alerts / Special Needs', 'textarea')}
+          </div>
+        )}
+
+        {step.id === 'insurance_info' && (
+          <div className="form-grid-2">
+            {renderField('insurance_provider', 'Insurance Provider')}
+            {renderField('insurance_policy_number', 'Policy Number')}
+            {renderField('insurance_group_number', 'Group Number')}
+            {renderField('insurance_contact', 'Insurance Contact Phone', 'tel')}
+          </div>
+        )}
+
+        {step.id === 'care_preferences' && (
+          <div className="form-grid">
+            {renderField('care_preferences', 'Care Preferences & Routines', 'textarea')}
+            {renderField('preferred_caregivers', 'Preferred Caregivers', 'textarea')}
+            {renderField('mobility_assistance_needs', 'Mobility Assistance Needs', 'textarea')}
+            {renderField('communication_preferences', 'Communication Preferences', 'textarea')}
+          </div>
+        )}
+
+        {step.id === 'family_communication' && (
+          <div className="form-grid-2">
+            {renderField('family_contact_name', 'Family Contact Name')}
+            {renderField('family_contact_phone', 'Phone', 'tel')}
+            {renderField('family_contact_email', 'Email', 'email')}
+            {renderField('communication_frequency', 'Communication Frequency')}
+            <div className="form-group" style={{ gridColumn: '1 / -1' }}>
+              <label>Communication Method</label>
+              <textarea id="communication_method" defaultValue={data.communication_method || ''} rows="2"></textarea>
+            </div>
+          </div>
+        )}
+
+        {step.id === 'initial_assessment' && (
+          <div className="form-grid">
+            {renderField('assessment_date', 'Assessment Date', 'date')}
+            {renderField('functional_status', 'Functional Status', 'textarea')}
+            {renderField('care_goals', 'Care Goals', 'textarea')}
+            {renderField('assessment_notes', 'Assessment Notes', 'textarea')}
+          </div>
+        )}
+
+        <div className="form-actions" style={{ marginTop: '1rem' }}>
+          <button
+            type="button"
+            className="btn btn-primary"
+            onClick={() => handleSaveStep(client.id, step.id, getFormValues())}
+          >
+            Save {step.label}
+          </button>
+          <button
+            type="button"
+            className="btn btn-secondary"
+            onClick={() => setExpandedStep(null)}
+          >
+            Cancel
+          </button>
+        </div>
+      </div>
+    );
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Client Onboarding</h2>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {loading ? (
+        <div className="loading">
+          <div className="spinner"></div>
+        </div>
+      ) : clients.length === 0 ? (
+        <div className="card card-centered">
+          <p>No clients yet. Create a client to begin onboarding.</p>
+        </div>
+      ) : (
+        <div className="onboarding-list">
+          {clients.map(client => {
+            const progress = calculateProgress(client);
+            const isExpanded = expandedClient === client.id;
+
+            return (
+              <div key={client.id} className="card" style={{ marginBottom: '1.5rem' }}>
+                <div 
+                  className="onboarding-header"
+                  onClick={() => setExpandedClient(isExpanded ? null : client.id)}
+                  style={{ cursor: 'pointer', paddingBottom: '1rem', borderBottom: '1px solid #ddd' }}
+                >
+                  <div className="onboarding-info">
+                    <h3 style={{ margin: '0 0 0.25rem 0' }}>{client.first_name} {client.last_name}</h3>
+                    <p style={{ margin: 0, fontSize: '0.9rem', color: '#666' }}>
+                      {client.service_type?.replace('_', ' ').toUpperCase()} - {client.city || 'No city'}
+                    </p>
+                  </div>
+
+                  <div className="onboarding-status" style={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-end', gap: '0.5rem' }}>
+                    <div style={{ display: 'flex', gap: '1rem', alignItems: 'center' }}>
+                      <div style={{ 
+                        width: '100px',
+                        height: '6px',
+                        background: '#e0e0e0',
+                        borderRadius: '3px',
+                        overflow: 'hidden'
+                      }}>
+                        <div 
+                          style={{ 
+                            width: `${progress}%`,
+                            height: '100%',
+                            background: progress === 100 ? '#4caf50' : '#2196f3',
+                            transition: 'width 0.3s'
+                          }}
+                        ></div>
+                      </div>
+                      <span style={{ fontSize: '0.9rem', fontWeight: 'bold', minWidth: '40px' }}>
+                        {progress}%
+                      </span>
+                    </div>
+                    {progress === 100 && <span className="badge badge-success">Complete</span>}
+                  </div>
+
+                  <span style={{ fontSize: '1.2rem' }}>
+                    {isExpanded ? '▼' : '▶'}
+                  </span>
+                </div>
+
+                {isExpanded && (
+                  <div style={{ paddingTop: '1rem' }}>
+                    {onboardingSteps.map(step => {
+                      const stepCompleted = getStepStatus(client, step.id);
+                      const stepExpanded = expandedStep === `${client.id}-${step.id}`;
+
+                      return (
+                        <div key={step.id} style={{ marginBottom: '1rem' }}>
+                          <div
+                            onClick={() => setExpandedStep(stepExpanded ? null : `${client.id}-${step.id}`)}
+                            style={{
+                              padding: '1rem',
+                              background: stepCompleted ? '#f0f8f0' : '#f5f5f5',
+                              borderLeft: `4px solid ${stepCompleted ? '#4caf50' : '#ccc'}`,
+                              cursor: 'pointer',
+                              display: 'flex',
+                              justifyContent: 'space-between',
+                              alignItems: 'center',
+                              borderRadius: '4px'
+                            }}
+                          >
+                            <div>
+                              <strong>{step.label}</strong>
+                              <p style={{ margin: '0.25rem 0 0 0', fontSize: '0.85rem', color: '#666' }}>
+                                {step.description}
+                              </p>
+                            </div>
+                            <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+                              {stepCompleted && <span style={{ color: '#4caf50', fontSize: '1.2rem' }}>✓</span>}
+                              <span style={{ fontSize: '1rem' }}>
+                                {stepExpanded ? '▼' : '▶'}
+                              </span>
+                            </div>
+                          </div>
+
+                          {stepExpanded && (
+                            <div style={{ paddingTop: '1rem' }}>
+                              {renderStepForm(client, step)}
+                            </div>
+                          )}
+                        </div>
+                      );
+                    })}
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ClientOnboarding;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ClientsManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/ClientsManagement.jsx
new file mode 100644
index 0000000..d7927b8
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ClientsManagement.jsx
@@ -0,0 +1,478 @@
+import { toast } from '../Toast';
+// src/components/admin/ClientsManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import EditClientModal from './EditClientModal';
+
+// AddressLink component - opens Google Maps
+const AddressLink = ({ address, city, state, zip }) => {
+  if (!address && !city) return <span>-</span>;
+  
+  const fullAddress = [address, city, state, zip].filter(Boolean).join(', ');
+  const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(fullAddress)}`;
+  
+  return (
+    <a 
+      href={mapsUrl} 
+      target="_blank" 
+      rel="noopener noreferrer"
+      title={`Open in Google Maps: ${fullAddress}`}
+      style={{ display: 'flex', alignItems: 'center', gap: '4px' }}
+    >
+      📍 {city || address}
+    </a>
+  );
+};
+
+// Mobile-friendly client card
+const ClientCard = ({ client, getReferralSourceName, getCareTypeName, onEdit }) => (
+  <div className="card" style={{ marginBottom: '0.75rem', padding: '1rem' }}>
+    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.75rem' }}>
+      <div>
+        <strong style={{ fontSize: '1.1rem' }}>{client.first_name} {client.last_name}</strong>
+        {client.date_of_birth && (
+          <div style={{ color: '#666', fontSize: '0.85rem' }}>
+            DOB: {new Date(client.date_of_birth).toLocaleDateString()}
+          </div>
+        )}
+      </div>
+      <button 
+        className="btn btn-sm btn-primary"
+        onClick={() => onEdit(client)}
+        style={{ flexShrink: 0 }}
+      >
+        ✏️ Edit
+      </button>
+    </div>
+    
+    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem', fontSize: '0.9rem' }}>
+      <div>
+        <span style={{ color: '#666' }}>📞</span>{' '}
+        {client.phone ? (
+          <a href={`tel:${client.phone}`}>{client.phone}</a>
+        ) : (
+          <span style={{ color: '#999' }}>N/A</span>
+        )}
+      </div>
+      <div>
+        <AddressLink 
+          address={client.address}
+          city={client.city}
+          state={client.state}
+          zip={client.zip}
+        />
+      </div>
+    </div>
+    
+    <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.75rem', flexWrap: 'wrap' }}>
+      {client.is_private_pay ? (
+        <span className="badge badge-info">Private Pay</span>
+      ) : (
+        <>
+          <span className="badge badge-success">Referred</span>
+          <span className="badge" style={{ backgroundColor: '#e0e0e0', color: '#333' }}>
+            {getReferralSourceName(client.referral_source_id)}
+          </span>
+        </>
+      )}
+      {client.care_type_id && (
+        <span className="badge" style={{ backgroundColor: '#fff3cd', color: '#856404' }}>
+          {getCareTypeName(client.care_type_id)}
+        </span>
+      )}
+    </div>
+  </div>
+);
+
+const ClientsManagement = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [referralSources, setReferralSources] = useState([]);
+  const [careTypes, setCareTypes] = useState([]);
+  const [showForm, setShowForm] = useState(false);
+  const [loading, setLoading] = useState(true);
+  const [selectedClient, setSelectedClient] = useState(null);
+  const [showEditModal, setShowEditModal] = useState(false);
+  const [searchTerm, setSearchTerm] = useState('');
+  const [filterReferral, setFilterReferral] = useState('');
+  const [filterCareType, setFilterCareType] = useState('');
+  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);
+  
+  // Listen for window resize
+  useEffect(() => {
+    const handleResize = () => setIsMobile(window.innerWidth < 768);
+    window.addEventListener('resize', handleResize);
+    return () => window.removeEventListener('resize', handleResize);
+  }, []);
+
+  const initialFormData = {
+    firstName: '',
+    lastName: '',
+    dateOfBirth: '',
+    gender: '',
+    phone: '',
+    email: '',
+    address: '',
+    city: '',
+    state: 'WI',
+    zip: '',
+    referralSourceId: '',
+    careTypeId: '',
+    isPrivatePay: false,
+    privatePayRate: '',
+    privatePayRateType: 'hourly',
+    weeklyAuthorizedUnits: '',
+    emergencyContactName: '',
+    emergencyContactPhone: '',
+    emergencyContactRelationship: '',
+    notes: ''
+  };
+
+  const [formData, setFormData] = useState(initialFormData);
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [clientRes, rsRes, ctRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/clients`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/referral-sources`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/care-types`, { headers: { 'Authorization': `Bearer ${token}` } })
+      ]);
+
+      setClients(await clientRes.json());
+      setReferralSources(await rsRes.json());
+      setCareTypes(await ctRes.json());
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    try {
+      const cleanedData = {
+        firstName: formData.firstName,
+        lastName: formData.lastName,
+        dateOfBirth: formData.dateOfBirth || null,
+        gender: formData.gender || null,
+        phone: formData.phone || null,
+        email: formData.email || null,
+        address: formData.address || null,
+        city: formData.city || null,
+        state: formData.state || null,
+        zip: formData.zip || null,
+        referralSourceId: formData.referralSourceId || null,
+        careTypeId: formData.careTypeId || null,
+        isPrivatePay: formData.isPrivatePay,
+        privatePayRate: formData.isPrivatePay ? parseFloat(formData.privatePayRate) : null,
+        privatePayRateType: formData.privatePayRateType,
+        weeklyAuthorizedUnits: formData.weeklyAuthorizedUnits ? parseInt(formData.weeklyAuthorizedUnits) : null,
+        emergencyContactName: formData.emergencyContactName || null,
+        emergencyContactPhone: formData.emergencyContactPhone || null,
+        emergencyContactRelationship: formData.emergencyContactRelationship || null,
+        notes: formData.notes || null
+      };
+
+      const response = await fetch(`${API_BASE_URL}/api/clients`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(cleanedData)
+      });
+
+      if (!response.ok) throw new Error('Failed to create client');
+
+      setFormData(initialFormData);
+      setShowForm(false);
+      loadData();
+      toast('Client added successfully!');
+    } catch (error) {
+      toast('Failed to create client: ' + error.message, 'error');
+    }
+  };
+
+  const handleViewClient = (client) => {
+    setSelectedClient(client);
+    setShowEditModal(true);
+  };
+
+  const getReferralSourceName = (id) => {
+    const rs = referralSources.find(r => r.id === id);
+    return rs ? rs.name : '-';
+  };
+
+  const getCareTypeName = (id) => {
+    const ct = careTypes.find(c => c.id === id);
+    return ct ? ct.name : '-';
+  };
+
+  const filteredClients = clients.filter(client => {
+    const matchesSearch = !searchTerm || 
+      `${client.first_name} ${client.last_name}`.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      (client.phone && client.phone.includes(searchTerm)) ||
+      (client.email && client.email.toLowerCase().includes(searchTerm.toLowerCase()));
+    
+    const matchesReferral = !filterReferral || client.referral_source_id === filterReferral;
+    const matchesCareType = !filterCareType || client.care_type_id === filterCareType;
+    
+    return matchesSearch && matchesReferral && matchesCareType;
+  });
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>👥 Clients</h2>
+        <button 
+          className="btn btn-primary"
+          onClick={() => setShowForm(!showForm)}
+        >
+          {showForm ? '✕ Cancel' : '➕ Add'}
+        </button>
+      </div>
+
+      {showForm && (
+        <div className="card card-form">
+          <h3>Add New Client</h3>
+          <form onSubmit={handleSubmit}>
+            <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>📋 Basic Information</h4>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>First Name *</label>
+                <input type="text" value={formData.firstName} onChange={(e) => setFormData({ ...formData, firstName: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Last Name *</label>
+                <input type="text" value={formData.lastName} onChange={(e) => setFormData({ ...formData, lastName: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Date of Birth</label>
+                <input type="date" value={formData.dateOfBirth} onChange={(e) => setFormData({ ...formData, dateOfBirth: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>Gender</label>
+                <select value={formData.gender} onChange={(e) => setFormData({ ...formData, gender: e.target.value })}>
+                  <option value="">Select...</option>
+                  <option value="M">Male</option>
+                  <option value="F">Female</option>
+                  <option value="Other">Other</option>
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Phone</label>
+                <input type="tel" value={formData.phone} onChange={(e) => setFormData({ ...formData, phone: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>Email</label>
+                <input type="email" value={formData.email} onChange={(e) => setFormData({ ...formData, email: e.target.value })} />
+              </div>
+            </div>
+
+            <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>🏠 Address</h4>
+            <div className="form-grid">
+              <div className="form-group" style={{ gridColumn: isMobile ? 'span 1' : 'span 2' }}>
+                <label>Street Address</label>
+                <input type="text" value={formData.address} onChange={(e) => setFormData({ ...formData, address: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>City</label>
+                <input type="text" value={formData.city} onChange={(e) => setFormData({ ...formData, city: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>State</label>
+                <input type="text" value={formData.state} onChange={(e) => setFormData({ ...formData, state: e.target.value })} maxLength="2" />
+              </div>
+              <div className="form-group">
+                <label>ZIP Code</label>
+                <input type="text" value={formData.zip} onChange={(e) => setFormData({ ...formData, zip: e.target.value })} />
+              </div>
+            </div>
+
+            <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>💰 Billing Information</h4>
+            <div className="form-grid">
+              <div className="form-group">
+                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                  <input type="checkbox" checked={formData.isPrivatePay} onChange={(e) => setFormData({ ...formData, isPrivatePay: e.target.checked })} style={{ width: 'auto' }} />
+                  Private Pay Client
+                </label>
+              </div>
+              
+              {!formData.isPrivatePay ? (
+                <>
+                  <div className="form-group">
+                    <label>Referral Source</label>
+                    <select value={formData.referralSourceId} onChange={(e) => setFormData({ ...formData, referralSourceId: e.target.value })}>
+                      <option value="">Select referral source...</option>
+                      {referralSources.map(rs => (<option key={rs.id} value={rs.id}>{rs.name}</option>))}
+                    </select>
+                  </div>
+                  <div className="form-group">
+                    <label>Care Type</label>
+                    <select value={formData.careTypeId} onChange={(e) => setFormData({ ...formData, careTypeId: e.target.value })}>
+                      <option value="">Select care type...</option>
+                      {careTypes.map(ct => (<option key={ct.id} value={ct.id}>{ct.name}</option>))}
+                    </select>
+                  </div>
+                </>
+              ) : (
+                <>
+                  <div className="form-group">
+                    <label>Care Type</label>
+                    <select value={formData.careTypeId} onChange={(e) => setFormData({ ...formData, careTypeId: e.target.value })}>
+                      <option value="">Select care type...</option>
+                      {careTypes.map(ct => (<option key={ct.id} value={ct.id}>{ct.name}</option>))}
+                    </select>
+                  </div>
+                  <div className="form-group">
+                    <label>Rate Type</label>
+                    <select value={formData.privatePayRateType} onChange={(e) => setFormData({ ...formData, privatePayRateType: e.target.value })}>
+                      <option value="hourly">Per Hour</option>
+                      <option value="15min">Per 15 Minutes</option>
+                    </select>
+                  </div>
+                  <div className="form-group">
+                    <label>Rate Amount *</label>
+                    <input type="number" step="0.01" min="0" value={formData.privatePayRate} onChange={(e) => setFormData({ ...formData, privatePayRate: e.target.value })} placeholder={formData.privatePayRateType === '15min' ? 'e.g., 6.25' : 'e.g., 25.00'} required={formData.isPrivatePay} />
+                  </div>
+                </>
+              )}
+            </div>
+
+            <div className="form-group" style={{ marginTop: '1rem' }}>
+              <label>Weekly Authorized Units</label>
+              <input 
+                type="number" 
+                step="1" 
+                min="0" 
+                max="672"
+                value={formData.weeklyAuthorizedUnits} 
+                onChange={(e) => setFormData({ ...formData, weeklyAuthorizedUnits: e.target.value })} 
+                placeholder="e.g., 80 units"
+              />
+              {formData.weeklyAuthorizedUnits && (
+                <div style={{ 
+                  marginTop: '0.5rem', 
+                  padding: '0.5rem', 
+                  background: '#E0F2FE', 
+                  borderRadius: '4px',
+                  fontSize: '0.9rem',
+                  color: '#0369A1'
+                }}>
+                  = <strong>{(parseFloat(formData.weeklyAuthorizedUnits) * 0.25).toFixed(2)} hours</strong> per week
+                </div>
+              )}
+              <small style={{ color: '#666', display: 'block', marginTop: '0.25rem' }}>
+                1 unit = 15 minutes. Used to track scheduling coverage.
+              </small>
+            </div>
+
+            <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>🚨 Emergency Contact</h4>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Contact Name</label>
+                <input type="text" value={formData.emergencyContactName} onChange={(e) => setFormData({ ...formData, emergencyContactName: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>Phone</label>
+                <input type="tel" value={formData.emergencyContactPhone} onChange={(e) => setFormData({ ...formData, emergencyContactPhone: e.target.value })} />
+              </div>
+              <div className="form-group">
+                <label>Relationship</label>
+                <input type="text" value={formData.emergencyContactRelationship} onChange={(e) => setFormData({ ...formData, emergencyContactRelationship: e.target.value })} placeholder="e.g., Spouse, Son, Daughter" />
+              </div>
+            </div>
+
+            <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>📝 Notes</h4>
+            <div className="form-group">
+              <textarea value={formData.notes} onChange={(e) => setFormData({ ...formData, notes: e.target.value })} placeholder="Any initial notes about the client..." rows="3" />
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Add Client</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Search and Filters */}
+      <div className="card" style={{ marginBottom: '1rem', padding: '1rem' }}>
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+          <input type="text" placeholder="🔍 Search by name, phone, or email..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} style={{ width: '100%' }} />
+          <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr', gap: '0.75rem' }}>
+            <select value={filterReferral} onChange={(e) => setFilterReferral(e.target.value)}>
+              <option value="">All Referral Sources</option>
+              {referralSources.map(rs => (<option key={rs.id} value={rs.id}>{rs.name}</option>))}
+            </select>
+            <select value={filterCareType} onChange={(e) => setFilterCareType(e.target.value)}>
+              <option value="">All Care Types</option>
+              {careTypes.map(ct => (<option key={ct.id} value={ct.id}>{ct.name}</option>))}
+            </select>
+          </div>
+        </div>
+      </div>
+
+      {/* Clients List */}
+      {loading ? (
+        <div className="loading"><div className="spinner"></div></div>
+      ) : filteredClients.length === 0 ? (
+        <div className="card card-centered">
+          <p>{clients.length === 0 ? 'No clients yet. Add one to get started.' : 'No clients match your filters.'}</p>
+        </div>
+      ) : isMobile ? (
+        <div>
+          {filteredClients.map(client => (
+            <ClientCard key={client.id} client={client} getReferralSourceName={getReferralSourceName} getCareTypeName={getCareTypeName} onEdit={handleViewClient} />
+          ))}
+        </div>
+      ) : (
+        <div style={{ overflowX: 'auto' }}>
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Name</th>
+                <th>Phone</th>
+                <th>Address</th>
+                <th>Referral Source</th>
+                <th>Care Type</th>
+                <th>Status</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {filteredClients.map(client => (
+                <tr key={client.id}>
+                  <td>
+                    <strong>{client.first_name} {client.last_name}</strong>
+                    {client.date_of_birth && (<small style={{ display: 'block', color: '#666' }}>DOB: {new Date(client.date_of_birth).toLocaleDateString()}</small>)}
+                  </td>
+                  <td><a href={`tel:${client.phone}`}>{client.phone || 'N/A'}</a></td>
+                  <td><AddressLink address={client.address} city={client.city} state={client.state} zip={client.zip} /></td>
+                  <td>{client.is_private_pay ? (<span className="text-muted">-</span>) : (getReferralSourceName(client.referral_source_id))}</td>
+                  <td>{getCareTypeName(client.care_type_id)}</td>
+                  <td>{client.is_private_pay ? (<span className="badge badge-info">Private Pay</span>) : (<span className="badge badge-success">Referred</span>)}</td>
+                  <td><button className="btn btn-sm btn-primary" onClick={() => handleViewClient(client)}>✏️ Edit</button></td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        </div>
+      )}
+
+      {!loading && clients.length > 0 && (
+        <div style={{ marginTop: '1rem', fontSize: '0.9rem', color: '#666' }}>
+          Showing {filteredClients.length} of {clients.length} clients
+        </div>
+      )}
+
+      <EditClientModal client={selectedClient} referralSources={referralSources} careTypes={careTypes} isOpen={showEditModal} onClose={() => { setShowEditModal(false); setSelectedClient(null); }} onSuccess={loadData} token={token} />
+    </div>
+  );
+};
+
+export default ClientsManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/CommunicationLog.jsx b/templates/crm-homecare/frontend/src/components/admin/CommunicationLog.jsx
new file mode 100644
index 0000000..7b22c0e
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CommunicationLog.jsx
@@ -0,0 +1,264 @@
+// CommunicationLog.jsx
+// Timestamped notes/calls/emails per client or caregiver
+// Can be embedded inside ClientDetail, CaregiverProfile, or used standalone
+
+import { useState, useEffect } from 'react';
+
+const API = import.meta.env.VITE_API_URL || '';
+
+const LOG_TYPES = [
+  { value: 'note',       label: 'Note',       icon: '📝', color: '#6B7280' },
+  { value: 'call',       label: 'Call',        icon: '📞', color: '#3B82F6' },
+  { value: 'email',      label: 'Email',       icon: '📧', color: '#8B5CF6' },
+  { value: 'text',       label: 'Text',        icon: '💬', color: '#10B981' },
+  { value: 'visit',      label: 'Visit',       icon: '🏠', color: '#F59E0B' },
+  { value: 'incident',   label: 'Incident',    icon: '⚠️', color: '#EF4444' },
+  { value: 'complaint',  label: 'Complaint',   icon: '🚨', color: '#DC2626' },
+  { value: 'compliment', label: 'Compliment',  icon: '⭐', color: '#F59E0B' },
+  { value: 'other',      label: 'Other',       icon: '📋', color: '#9CA3AF' },
+];
+
+const DIRECTIONS = ['inbound', 'outbound', 'internal'];
+
+export default function CommunicationLog({ token, entityType, entityId, entityName, compact = false }) {
+  const [logs, setLogs] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showForm, setShowForm] = useState(false);
+  const [filterType, setFilterType] = useState('');
+  const [followUps, setFollowUps] = useState([]);
+  const [form, setForm] = useState({ logType: 'note', direction: 'internal', subject: '', body: '', followUpDate: '' });
+  const [saving, setSaving] = useState(false);
+  const [editId, setEditId] = useState(null);
+  const [msg, setMsg] = useState('');
+
+  const headers = { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` };
+
+  const load = async () => {
+    setLoading(true);
+    try {
+      const params = new URLSearchParams({ limit: 100 });
+      if (filterType) params.set('type', filterType);
+      const r = await fetch(`${API}/api/communication-log/${entityType}/${entityId}?${params}`, { headers });
+      setLogs(await r.json());
+    } catch (e) { console.error(e); }
+    setLoading(false);
+  };
+
+  const loadFollowUps = async () => {
+    try {
+      const r = await fetch(`${API}/api/communication-log/follow-ups/pending`, { headers });
+      const data = await r.json();
+      setFollowUps(data.filter(f => f.entity_id === entityId));
+    } catch (e) {}
+  };
+
+  useEffect(() => { load(); loadFollowUps(); }, [entityId, filterType]);
+
+  const flash = (m) => { setMsg(m); setTimeout(() => setMsg(''), 3000); };
+
+  const save = async () => {
+    if (!form.body.trim()) return;
+    setSaving(true);
+    try {
+      const url = editId ? `${API}/api/communication-log/${editId}` : `${API}/api/communication-log`;
+      const method = editId ? 'PUT' : 'POST';
+      const body = editId ? { body: form.body, subject: form.subject } : { entityType, entityId, ...form };
+      await fetch(url, { method, headers, body: JSON.stringify(body) });
+      flash(editId ? 'Updated' : 'Entry saved');
+      setForm({ logType: 'note', direction: 'internal', subject: '', body: '', followUpDate: '' });
+      setEditId(null);
+      setShowForm(false);
+      load();
+    } catch (e) { flash('Error saving'); }
+    setSaving(false);
+  };
+
+  const togglePin = async (log) => {
+    await fetch(`${API}/api/communication-log/${log.id}`, {
+      method: 'PUT', headers, body: JSON.stringify({ isPinned: !log.is_pinned })
+    });
+    load();
+  };
+
+  const markFollowUpDone = async (id) => {
+    await fetch(`${API}/api/communication-log/${id}`, {
+      method: 'PUT', headers, body: JSON.stringify({ followUpDone: true })
+    });
+    load(); loadFollowUps();
+  };
+
+  const deleteLog = async (id) => {
+    if (!confirm('Delete this entry?')) return;
+    await fetch(`${API}/api/communication-log/${id}`, { method: 'DELETE', headers });
+    load();
+  };
+
+  const startEdit = (log) => {
+    setEditId(log.id);
+    setForm({ ...form, body: log.body, subject: log.subject || '' });
+    setShowForm(true);
+    window.scrollTo(0, 0);
+  };
+
+  const typeInfo = (t) => LOG_TYPES.find(l => l.value === t) || LOG_TYPES[0];
+
+  const fmt = (dt) => {
+    const d = new Date(dt);
+    return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })
+      + ' ' + d.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
+  };
+
+  return (
+    <div style={{ fontFamily: 'inherit' }}>
+      {msg && <div style={{ position: 'fixed', top: '1rem', right: '1rem', background: '#D1FAE5', color: '#065F46', padding: '0.75rem 1.25rem', borderRadius: '8px', zIndex: 9999, fontWeight: 600, boxShadow: '0 4px 12px rgba(0,0,0,0.15)' }}>{msg}</div>}
+
+      {/* Header */}
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', flexWrap: 'wrap', gap: '0.5rem' }}>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
+          <h3 style={{ margin: 0, fontSize: compact ? '1rem' : '1.15rem' }}>📋 Communication Log</h3>
+          {entityName && <span style={{ color: '#6B7280', fontSize: '0.88rem' }}>— {entityName}</span>}
+          <span style={{ background: '#F3F4F6', borderRadius: '12px', padding: '0.15rem 0.6rem', fontSize: '0.8rem', color: '#374151', fontWeight: 600 }}>{logs.length}</span>
+        </div>
+        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+          <select value={filterType} onChange={e => setFilterType(e.target.value)}
+            style={{ padding: '0.4rem 0.65rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem', color: '#374151' }}>
+            <option value=''>All types</option>
+            {LOG_TYPES.map(t => <option key={t.value} value={t.value}>{t.icon} {t.label}</option>)}
+          </select>
+          <button onClick={() => { setShowForm(!showForm); setEditId(null); }}
+            style={{ padding: '0.45rem 1rem', borderRadius: '8px', border: 'none', background: showForm ? '#E5E7EB' : '#3B82F6', color: showForm ? '#374151' : '#fff', cursor: 'pointer', fontWeight: 600, fontSize: '0.88rem' }}>
+            {showForm ? '✕ Cancel' : '+ Add Entry'}
+          </button>
+        </div>
+      </div>
+
+      {/* Pending follow-ups banner */}
+      {followUps.length > 0 && (
+        <div style={{ background: '#FEF3C7', border: '1px solid #FCD34D', borderRadius: '8px', padding: '0.75rem 1rem', marginBottom: '1rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.5rem' }}>
+          <span style={{ fontWeight: 600, color: '#92400E', fontSize: '0.88rem' }}>⏰ {followUps.length} follow-up{followUps.length > 1 ? 's' : ''} pending</span>
+          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+            {followUps.slice(0, 3).map(f => (
+              <span key={f.id} style={{ background: '#fff', border: '1px solid #FCD34D', borderRadius: '6px', padding: '0.2rem 0.6rem', fontSize: '0.78rem', color: '#374151' }}>
+                {f.subject || f.body.slice(0, 30)}
+                <button onClick={() => markFollowUpDone(f.id)} style={{ marginLeft: '0.4rem', background: 'none', border: 'none', color: '#10B981', cursor: 'pointer', fontWeight: 700, fontSize: '0.8rem' }}>✓</button>
+              </span>
+            ))}
+          </div>
+        </div>
+      )}
+
+      {/* Add / Edit form */}
+      {showForm && (
+        <div style={{ background: '#F9FAFB', border: '1px solid #E5E7EB', borderRadius: '10px', padding: '1rem', marginBottom: '1.25rem' }}>
+          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', marginBottom: '0.75rem' }}>
+            {!editId && (
+              <>
+                <div>
+                  <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Type</label>
+                  <select value={form.logType} onChange={e => setForm(f => ({ ...f, logType: e.target.value }))}
+                    style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }}>
+                    {LOG_TYPES.map(t => <option key={t.value} value={t.value}>{t.icon} {t.label}</option>)}
+                  </select>
+                </div>
+                <div>
+                  <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Direction</label>
+                  <select value={form.direction} onChange={e => setForm(f => ({ ...f, direction: e.target.value }))}
+                    style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }}>
+                    {DIRECTIONS.map(d => <option key={d} value={d}>{d.charAt(0).toUpperCase() + d.slice(1)}</option>)}
+                  </select>
+                </div>
+              </>
+            )}
+            <div style={{ gridColumn: editId ? '1 / -1' : '1 / -1' }}>
+              <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Subject (optional)</label>
+              <input value={form.subject} onChange={e => setForm(f => ({ ...f, subject: e.target.value }))}
+                placeholder='Brief subject...'
+                style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem', boxSizing: 'border-box' }} />
+            </div>
+          </div>
+          <div style={{ marginBottom: '0.75rem' }}>
+            <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Notes *</label>
+            <textarea value={form.body} onChange={e => setForm(f => ({ ...f, body: e.target.value }))}
+              placeholder='Enter your notes here...' rows={4}
+              style={{ width: '100%', padding: '0.6rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem', resize: 'vertical', boxSizing: 'border-box' }} />
+          </div>
+          {!editId && (
+            <div style={{ marginBottom: '0.75rem' }}>
+              <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Follow-up Date (optional)</label>
+              <input type='date' value={form.followUpDate} onChange={e => setForm(f => ({ ...f, followUpDate: e.target.value }))}
+                style={{ padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }} />
+            </div>
+          )}
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button onClick={save} disabled={saving || !form.body.trim()}
+              style={{ padding: '0.55rem 1.25rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 600, fontSize: '0.88rem', opacity: saving ? 0.7 : 1 }}>
+              {saving ? 'Saving...' : editId ? '✓ Update' : '✓ Save Entry'}
+            </button>
+          </div>
+        </div>
+      )}
+
+      {/* Log entries */}
+      {loading ? (
+        <div style={{ textAlign: 'center', padding: '2rem', color: '#9CA3AF' }}>Loading...</div>
+      ) : logs.length === 0 ? (
+        <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+          <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📋</div>
+          No communication log entries yet
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>
+          {logs.map(log => {
+            const ti = typeInfo(log.log_type);
+            const isPinned = log.is_pinned;
+            return (
+              <div key={log.id} style={{
+                background: isPinned ? '#FFFBEB' : '#fff',
+                border: `1px solid ${isPinned ? '#FCD34D' : '#E5E7EB'}`,
+                borderLeft: `4px solid ${ti.color}`,
+                borderRadius: '8px', padding: '0.85rem 1rem',
+                position: 'relative'
+              }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.4rem', flexWrap: 'wrap', gap: '0.4rem' }}>
+                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', flexWrap: 'wrap' }}>
+                    <span style={{ fontSize: '0.82rem', fontWeight: 700, background: ti.color + '18', color: ti.color, padding: '0.15rem 0.5rem', borderRadius: '12px' }}>
+                      {ti.icon} {ti.label}
+                    </span>
+                    {log.direction && log.direction !== 'internal' && (
+                      <span style={{ fontSize: '0.75rem', color: '#6B7280', background: '#F3F4F6', padding: '0.1rem 0.4rem', borderRadius: '10px' }}>
+                        {log.direction === 'inbound' ? '↙ In' : '↗ Out'}
+                      </span>
+                    )}
+                    {isPinned && <span style={{ fontSize: '0.75rem' }}>📌</span>}
+                    {log.follow_up_date && !log.follow_up_done && (
+                      <span style={{ fontSize: '0.75rem', background: '#FEF3C7', color: '#92400E', padding: '0.1rem 0.45rem', borderRadius: '10px', fontWeight: 600 }}>
+                        ⏰ Follow-up: {new Date(log.follow_up_date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
+                      </span>
+                    )}
+                  </div>
+                  <div style={{ display: 'flex', gap: '0.35rem' }}>
+                    <button onClick={() => togglePin(log)} title={isPinned ? 'Unpin' : 'Pin'}
+                      style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '0.85rem', opacity: 0.6, padding: '0.1rem' }}>📌</button>
+                    {log.follow_up_date && !log.follow_up_done && (
+                      <button onClick={() => markFollowUpDone(log.id)} title='Mark follow-up done'
+                        style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '0.85rem', color: '#10B981', padding: '0.1rem' }}>✓</button>
+                    )}
+                    <button onClick={() => startEdit(log)} title='Edit'
+                      style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '0.82rem', opacity: 0.5, padding: '0.1rem' }}>✏️</button>
+                    <button onClick={() => deleteLog(log.id)} title='Delete'
+                      style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '0.82rem', color: '#EF4444', opacity: 0.6, padding: '0.1rem' }}>🗑</button>
+                  </div>
+                </div>
+                {log.subject && <div style={{ fontWeight: 600, fontSize: '0.9rem', marginBottom: '0.3rem', color: '#111827' }}>{log.subject}</div>}
+                <div style={{ fontSize: '0.88rem', color: '#374151', lineHeight: 1.5, whiteSpace: 'pre-wrap' }}>{log.body}</div>
+                <div style={{ marginTop: '0.5rem', fontSize: '0.75rem', color: '#9CA3AF' }}>
+                  {log.logged_by_name || 'Admin'} · {fmt(log.created_at)}
+                </div>
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/CompanyOptimizer.jsx b/templates/crm-homecare/frontend/src/components/admin/CompanyOptimizer.jsx
new file mode 100644
index 0000000..2cd9c6e
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/CompanyOptimizer.jsx
@@ -0,0 +1,662 @@
+// src/components/admin/CompanyOptimizer.jsx
+// Company-Wide Smart Matching & Schedule Optimizer
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const CompanyOptimizer = ({ token }) => {
+  const [activeTab, setActiveTab] = useState('skills');
+  const [capabilities, setCapabilities] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState({ text: '', type: '' });
+
+  const [selectedCg, setSelectedCg] = useState('');
+  const [cgCaps, setCgCaps] = useState([]);
+  const [cgCapsLoading, setCgCapsLoading] = useState(false);
+
+  const [selectedClient, setSelectedClient] = useState('');
+  const [clientNeeds, setClientNeeds] = useState([]);
+  const [clientNeedsLoading, setClientNeedsLoading] = useState(false);
+  const [schedPrefs, setSchedPrefs] = useState({ daysPerWeek: 5, allowedDays: [1, 2, 3, 4, 5] });
+
+  const [restrictionsClient, setRestrictionsClient] = useState('');
+  const [restrictions, setRestrictions] = useState([]);
+  const [newRestriction, setNewRestriction] = useState({ caregiverId: '', type: 'preferred', reason: '' });
+
+  const [optimizerWeek, setOptimizerWeek] = useState(() => {
+    const d = new Date(); d.setDate(d.getDate() - d.getDay());
+    return d.toISOString().split('T')[0];
+  });
+  const [optimizerMode, setOptimizerMode] = useState('generate_fresh');
+  const [optimizerOptions, setOptimizerOptions] = useState({
+    balanceHours: true, minimizeDriving: true, respectPreferences: true
+  });
+  const [optimizerResults, setOptimizerResults] = useState(null);
+  const [optimizing, setOptimizing] = useState(false);
+  const [applying, setApplying] = useState(false);
+  const [clearExisting, setClearExisting] = useState(false);
+  const [expandedClient, setExpandedClient] = useState(null);
+
+  const [showNewCap, setShowNewCap] = useState(false);
+  const [newCap, setNewCap] = useState({ name: '', category: 'household', description: '', icon: '📋' });
+
+  const showMsg = (text, type = 'success') => {
+    setMessage({ text, type });
+    setTimeout(() => setMessage({ text: '', type: '' }), 5000);
+  };
+
+  const api = async (url, opts = {}) => {
+    const res = await fetch(`${API_BASE_URL}${url}`, {
+      ...opts,
+      headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}`, ...opts.headers }
+    });
+    if (!res.ok) { const err = await res.json().catch(() => ({})); throw new Error(err.error || `Failed (${res.status})`); }
+    return res.json();
+  };
+
+  useEffect(() => {
+    Promise.all([api('/api/matching/capabilities'), api('/api/caregivers'), api('/api/clients')])
+      .then(([caps, cgs, cls]) => {
+        setCapabilities(caps);
+        setCaregivers(Array.isArray(cgs) ? cgs : []);
+        setClients(Array.isArray(cls) ? cls.filter(c => c.is_active !== false) : []);
+      }).catch(console.error).finally(() => setLoading(false));
+  }, []);
+
+  useEffect(() => {
+    if (!selectedCg) { setCgCaps([]); return; }
+    setCgCapsLoading(true);
+    api(`/api/matching/caregiver/${selectedCg}/capabilities`).then(setCgCaps).catch(console.error).finally(() => setCgCapsLoading(false));
+  }, [selectedCg]);
+
+  useEffect(() => {
+    if (!selectedClient) { setClientNeeds([]); setSchedPrefs({ daysPerWeek: 5, allowedDays: [1, 2, 3, 4, 5] }); return; }
+    setClientNeedsLoading(true);
+    Promise.all([
+      api(`/api/matching/client/${selectedClient}/needs`),
+      api(`/api/matching/client/${selectedClient}/schedule-prefs`)
+    ]).then(([needs, prefs]) => {
+      setClientNeeds(needs);
+      setSchedPrefs(prefs);
+    }).catch(console.error).finally(() => setClientNeedsLoading(false));
+  }, [selectedClient]);
+
+  useEffect(() => {
+    if (!restrictionsClient) { setRestrictions([]); return; }
+    api(`/api/matching/client/${restrictionsClient}/restrictions`).then(setRestrictions).catch(console.error);
+  }, [restrictionsClient]);
+
+  // ── Caregiver skills helpers ──
+  const cgHasCap = (capId) => cgCaps.some(c => c.capability_id === capId);
+  const getCgCap = (capId) => cgCaps.find(c => c.capability_id === capId);
+  const toggleCgCap = (capId) => {
+    if (cgHasCap(capId)) setCgCaps(p => p.filter(c => c.capability_id !== capId));
+    else {
+      const cap = capabilities.find(c => c.id === capId);
+      setCgCaps(p => [...p, { capability_id: capId, proficiency: 'capable', name: cap?.name, category: cap?.category, icon: cap?.icon }]);
+    }
+  };
+  const updateCgProf = (capId, prof) => setCgCaps(p => p.map(c => c.capability_id === capId ? { ...c, proficiency: prof } : c));
+  const saveCgCaps = async () => {
+    try {
+      await api(`/api/matching/caregiver/${selectedCg}/capabilities`, {
+        method: 'PUT', body: JSON.stringify({ capabilities: cgCaps.map(c => ({ capabilityId: c.capability_id, proficiency: c.proficiency || 'capable' })) })
+      });
+      showMsg('Skills saved!');
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+
+  // ── Client needs helpers ──
+  const clientHasNeed = (capId) => clientNeeds.some(n => n.capability_id === capId);
+  const getClientNeed = (capId) => clientNeeds.find(n => n.capability_id === capId);
+  const toggleNeed = (capId) => {
+    if (clientHasNeed(capId)) setClientNeeds(p => p.filter(n => n.capability_id !== capId));
+    else {
+      const cap = capabilities.find(c => c.id === capId);
+      setClientNeeds(p => [...p, { capability_id: capId, priority: 'normal', frequency: 'every_visit', name: cap?.name, category: cap?.category, icon: cap?.icon }]);
+    }
+  };
+  const updateNeedPri = (capId, pri) => setClientNeeds(p => p.map(n => n.capability_id === capId ? { ...n, priority: pri } : n));
+  const updateNeedFreq = (capId, freq) => setClientNeeds(p => p.map(n => n.capability_id === capId ? { ...n, frequency: freq } : n));
+  const saveNeeds = async () => {
+    try {
+      await Promise.all([
+        api(`/api/matching/client/${selectedClient}/needs`, {
+          method: 'PUT', body: JSON.stringify({ needs: clientNeeds.map(n => ({ capabilityId: n.capability_id, priority: n.priority || 'normal', frequency: n.frequency || 'every_visit' })) })
+        }),
+        api(`/api/matching/client/${selectedClient}/schedule-prefs`, {
+          method: 'PUT', body: JSON.stringify(schedPrefs)
+        })
+      ]);
+      showMsg('Needs & schedule preferences saved!');
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+
+  // Day toggle helpers
+  const DAY_LABELS_FULL = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+  const toggleAllowedDay = (dayIdx) => {
+    setSchedPrefs(p => {
+      const days = p.allowedDays.includes(dayIdx)
+        ? p.allowedDays.filter(d => d !== dayIdx)
+        : [...p.allowedDays, dayIdx].sort((a, b) => a - b);
+      return { ...p, allowedDays: days, daysPerWeek: Math.min(p.daysPerWeek, days.length) };
+    });
+  };
+
+  // ── Restrictions helpers ──
+  const addRestriction = async () => {
+    if (!newRestriction.caregiverId) { showMsg('Select a caregiver', 'error'); return; }
+    try {
+      await api(`/api/matching/client/${restrictionsClient}/restrictions`, {
+        method: 'POST', body: JSON.stringify({ caregiverId: newRestriction.caregiverId, restrictionType: newRestriction.type, reason: newRestriction.reason || null })
+      });
+      const updated = await api(`/api/matching/client/${restrictionsClient}/restrictions`);
+      setRestrictions(updated);
+      setNewRestriction({ caregiverId: '', type: 'preferred', reason: '' });
+      showMsg('Restriction added');
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+  const removeRestriction = async (id) => {
+    try {
+      await api(`/api/matching/restrictions/${id}`, { method: 'DELETE' });
+      setRestrictions(p => p.filter(r => r.id !== id));
+      showMsg('Removed');
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+
+  // ── Optimizer ──
+  const runOptimizer = async () => {
+    setOptimizing(true); setOptimizerResults(null);
+    try {
+      const data = await api('/api/matching/optimize', {
+        method: 'POST', body: JSON.stringify({ weekStart: optimizerWeek, mode: optimizerMode, options: optimizerOptions })
+      });
+      setOptimizerResults(data);
+      showMsg(`${data.summary.coveragePercent}% coverage · ${data.summary.filledSlots}/${data.summary.totalSlots} slots filled · ${data.summary.swapIterations} optimization passes`);
+    } catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+    finally { setOptimizing(false); }
+  };
+
+  const applySchedule = async () => {
+    if (!optimizerResults) return;
+    setApplying(true);
+    try {
+      const data = await api('/api/matching/apply-schedule', {
+        method: 'POST',
+        body: JSON.stringify({
+          assignments: optimizerResults.assignments,
+          weekStart: optimizerResults.weekStart,
+          clearExisting
+        })
+      });
+      showMsg(data.message);
+      if (data.errors?.length) {
+        console.warn('Apply errors:', data.errors);
+      }
+    } catch (e) { showMsg('Apply failed: ' + e.message, 'error'); }
+    finally { setApplying(false); }
+  };
+
+  const addCapability = async () => {
+    if (!newCap.name) { showMsg('Name required', 'error'); return; }
+    try {
+      const cap = await api('/api/matching/capabilities', { method: 'POST', body: JSON.stringify(newCap) });
+      setCapabilities(p => [...p, cap]);
+      setNewCap({ name: '', category: 'household', description: '', icon: '📋' });
+      setShowNewCap(false);
+      showMsg('Added!');
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+
+  // ── Helpers ──
+  const grouped = (items) => {
+    const g = {};
+    items.forEach(i => { const cat = i.category || 'other'; if (!g[cat]) g[cat] = []; g[cat].push(i); });
+    return g;
+  };
+  const catLabel = { transportation: '🚗 Transportation', household: '🏠 Household', physical: '💪 Physical / Medical' };
+  const priColors = { critical: '#dc2626', high: '#ea580c', normal: '#2563eb', low: '#94a3b8' };
+  const typeColors = { preferred: '#16a34a', excluded: '#dc2626', locked: '#7c3aed' };
+  const typeLabels = { preferred: '💚 Preferred', excluded: '🚫 Excluded', locked: '🔒 Locked' };
+  const typeIcons = { preferred: '💚', excluded: '🚫', locked: '🔒' };
+
+  // ── Styles ──
+  const s = {
+    page: { maxWidth: '1100px', margin: '0 auto', padding: '1rem', fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif' },
+    tabs: { display: 'flex', gap: '4px', marginBottom: '1rem', overflowX: 'auto', borderBottom: '2px solid #e2e8f0', paddingBottom: '2px' },
+    tab: (a) => ({ padding: '0.55rem 1rem', border: 'none', cursor: 'pointer', fontSize: '0.82rem', fontWeight: a ? '700' : '500', background: a ? '#2563eb' : 'transparent', color: a ? '#fff' : '#555', borderRadius: '8px 8px 0 0', whiteSpace: 'nowrap' }),
+    card: { background: '#fff', borderRadius: '10px', padding: '1rem', boxShadow: '0 1px 4px rgba(0,0,0,0.07)', border: '1px solid #e8e8e8', marginBottom: '0.85rem' },
+    cardTitle: { fontWeight: '800', fontSize: '0.95rem', marginBottom: '0.65rem' },
+    label: { display: 'block', fontSize: '0.72rem', fontWeight: '700', color: '#888', textTransform: 'uppercase', marginBottom: '3px' },
+    select: { width: '100%', padding: '0.45rem 0.6rem', border: '1px solid #ddd', borderRadius: '6px', fontSize: '0.88rem' },
+    input: { width: '100%', padding: '0.45rem 0.6rem', border: '1px solid #ddd', borderRadius: '6px', fontSize: '0.88rem', boxSizing: 'border-box' },
+    btn: (bg, dis) => ({ padding: '0.5rem 1rem', border: 'none', borderRadius: '6px', cursor: dis ? 'not-allowed' : 'pointer', fontSize: '0.82rem', fontWeight: '700', color: '#fff', background: dis ? '#ccc' : bg, opacity: dis ? 0.6 : 1 }),
+    btnSm: (bg) => ({ padding: '0.3rem 0.6rem', border: 'none', borderRadius: '5px', cursor: 'pointer', fontSize: '0.75rem', fontWeight: '700', color: '#fff', background: bg }),
+    btnGhost: (c) => ({ padding: '0.3rem 0.6rem', border: `1px solid ${c}`, borderRadius: '5px', cursor: 'pointer', fontSize: '0.75rem', fontWeight: '700', color: c, background: 'transparent' }),
+    msg: (t) => ({ padding: '0.55rem 0.85rem', borderRadius: '8px', marginBottom: '0.75rem', fontSize: '0.82rem', fontWeight: '600', background: t === 'error' ? '#fef2f2' : t === 'warning' ? '#fffbeb' : '#f0fdf4', color: t === 'error' ? '#dc2626' : t === 'warning' ? '#92400e' : '#16a34a', border: `1px solid ${t === 'error' ? '#fecaca' : t === 'warning' ? '#fde68a' : '#bbf7d0'}` }),
+    badge: (bg) => ({ display: 'inline-block', padding: '2px 7px', borderRadius: '4px', fontSize: '0.68rem', fontWeight: '700', color: '#fff', background: bg, marginLeft: '4px' }),
+    capGrid: { display: 'grid', gap: '6px', marginBottom: '0.75rem' },
+    capItem: (a) => ({ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.5rem 0.65rem', border: `2px solid ${a ? '#2563eb' : '#e2e8f0'}`, borderRadius: '8px', cursor: 'pointer', background: a ? '#eff6ff' : '#fff' }),
+    stat: (c) => ({ flex: '1 1 80px', padding: '0.5rem', textAlign: 'center', borderRadius: '8px', background: `${c}08`, border: `1px solid ${c}22` }),
+    statVal: (c) => ({ fontSize: '1.2rem', fontWeight: '800', color: c }),
+    statLbl: { fontSize: '0.65rem', color: '#999', fontWeight: '600', textTransform: 'uppercase' },
+    emptyState: { textAlign: 'center', padding: '2rem', color: '#999' },
+    row: { display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '0.65rem' },
+    col: (f) => ({ flex: f || 1, minWidth: '140px' }),
+  };
+
+  // ═══════════════════════════════════════════════
+  // RENDER: Skills Tab
+  // ═══════════════════════════════════════════════
+  const renderSkills = () => {
+    const g = grouped(capabilities);
+    return (
+      <div>
+        <div style={s.card}>
+          <div style={s.cardTitle}>👤 Caregiver Skills & Capabilities</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>
+            Check off what each caregiver can do. The optimizer uses this to match them with client needs.
+          </div>
+          <div style={s.row}>
+            <div style={s.col(2)}>
+              <label style={s.label}>Caregiver</label>
+              <select style={s.select} value={selectedCg} onChange={e => setSelectedCg(e.target.value)}>
+                <option value="">— Select —</option>
+                {caregivers.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </div>
+            {selectedCg && <div style={{ ...s.col(1), display: 'flex', alignItems: 'flex-end', gap: '0.5rem' }}>
+              <button style={s.btn('#16a34a')} onClick={saveCgCaps}>💾 Save</button>
+              <span style={{ fontSize: '0.78rem', color: '#666' }}>{cgCaps.length}/{capabilities.length}</span>
+            </div>}
+          </div>
+        </div>
+        {selectedCg && !cgCapsLoading && Object.entries(g).map(([cat, caps]) => (
+          <div key={cat} style={s.card}>
+            <div style={s.cardTitle}>{catLabel[cat] || cat}</div>
+            <div style={s.capGrid}>
+              {caps.map(cap => {
+                const a = cgHasCap(cap.id);
+                return (
+                  <div key={cap.id} style={s.capItem(a)} onClick={() => toggleCgCap(cap.id)}>
+                    <input type="checkbox" checked={a} readOnly style={{ cursor: 'pointer', width: '16px', height: '16px' }} />
+                    <span style={{ fontSize: '1rem' }}>{cap.icon}</span>
+                    <div style={{ flex: 1 }}>
+                      <div style={{ fontWeight: '600', fontSize: '0.86rem' }}>{cap.name}</div>
+                      {cap.description && <div style={{ fontSize: '0.72rem', color: '#888' }}>{cap.description}</div>}
+                    </div>
+                    {a && <select value={getCgCap(cap.id)?.proficiency || 'capable'} onClick={e => e.stopPropagation()}
+                      onChange={e => { e.stopPropagation(); updateCgProf(cap.id, e.target.value); }}
+                      style={{ padding: '2px 4px', fontSize: '0.72rem', border: '1px solid #ddd', borderRadius: '4px' }}>
+                      <option value="capable">Capable</option><option value="experienced">Experienced</option><option value="specialized">Specialized</option>
+                    </select>}
+                  </div>
+                );
+              })}
+            </div>
+          </div>
+        ))}
+        <div style={s.card}>
+          {!showNewCap ? <button style={s.btnGhost('#2563eb')} onClick={() => setShowNewCap(true)}>+ Add Custom Capability</button> : (
+            <div>
+              <div style={s.row}>
+                <div style={s.col(2)}><label style={s.label}>Name</label><input style={s.input} value={newCap.name} onChange={e => setNewCap(p => ({ ...p, name: e.target.value }))} placeholder="e.g., Bilingual (Spanish)" /></div>
+                <div style={s.col(1)}><label style={s.label}>Category</label><select style={s.select} value={newCap.category} onChange={e => setNewCap(p => ({ ...p, category: e.target.value }))}><option value="transportation">Transportation</option><option value="household">Household</option><option value="physical">Physical</option></select></div>
+                <div style={s.col(0.5)}><label style={s.label}>Icon</label><input style={s.input} value={newCap.icon} onChange={e => setNewCap(p => ({ ...p, icon: e.target.value }))} maxLength="4" /></div>
+              </div>
+              <div style={{ display: 'flex', gap: '0.5rem' }}><button style={s.btn('#16a34a')} onClick={addCapability}>Add</button><button style={s.btnGhost('#888')} onClick={() => setShowNewCap(false)}>Cancel</button></div>
+            </div>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  // ═══════════════════════════════════════════════
+  // RENDER: Client Needs Tab
+  // ═══════════════════════════════════════════════
+  const renderNeeds = () => {
+    const g = grouped(capabilities);
+    return (
+      <div>
+        <div style={s.card}>
+          <div style={s.cardTitle}>📋 Client Service Needs</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>What services does each client need? Mark critical items so the optimizer prioritizes them.</div>
+          <div style={s.row}>
+            <div style={s.col(2)}>
+              <label style={s.label}>Client</label>
+              <select style={s.select} value={selectedClient} onChange={e => setSelectedClient(e.target.value)}>
+                <option value="">— Select —</option>
+                {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name} {c.weekly_authorized_units ? `(${c.weekly_authorized_units}u/wk)` : ''}</option>)}
+              </select>
+            </div>
+            {selectedClient && <div style={{ ...s.col(1), display: 'flex', alignItems: 'flex-end', gap: '0.5rem' }}>
+              <button style={s.btn('#16a34a')} onClick={saveNeeds}>💾 Save</button>
+              <span style={{ fontSize: '0.78rem', color: '#666' }}>{clientNeeds.length} needs{clientNeeds.filter(n => n.priority === 'critical').length > 0 && <span style={s.badge('#dc2626')}>{clientNeeds.filter(n => n.priority === 'critical').length} critical</span>}</span>
+            </div>}
+          </div>
+        </div>
+
+        {/* Schedule day preferences */}
+        {selectedClient && !clientNeedsLoading && (
+          <div style={s.card}>
+            <div style={s.cardTitle}>📅 Service Day Schedule</div>
+            <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.65rem' }}>
+              Which days can this client receive service? The optimizer will spread their weekly units across these days.
+            </div>
+            <div style={{ marginBottom: '0.65rem' }}>
+              <label style={s.label}>Allowed Days</label>
+              <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap' }}>
+                {DAY_LABELS_FULL.map((label, idx) => {
+                  const active = schedPrefs.allowedDays.includes(idx);
+                  return (
+                    <button key={idx} onClick={() => toggleAllowedDay(idx)} style={{
+                      padding: '0.4rem 0.7rem', border: `2px solid ${active ? '#2563eb' : '#e2e8f0'}`,
+                      borderRadius: '8px', cursor: 'pointer', fontSize: '0.82rem', fontWeight: active ? '700' : '500',
+                      background: active ? '#eff6ff' : '#fff', color: active ? '#2563eb' : '#aaa',
+                      minWidth: '48px', textAlign: 'center', transition: 'all 0.15s'
+                    }}>
+                      {label}
+                    </button>
+                  );
+                })}
+              </div>
+            </div>
+            <div>
+              <label style={s.label}>Days Per Week (how many of the allowed days to actually use)</label>
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.65rem' }}>
+                <input type="range" min="1" max={schedPrefs.allowedDays.length || 1} value={schedPrefs.daysPerWeek}
+                  onChange={e => setSchedPrefs(p => ({ ...p, daysPerWeek: parseInt(e.target.value) }))}
+                  style={{ flex: 1, cursor: 'pointer' }} />
+                <span style={{ fontSize: '1rem', fontWeight: '800', color: '#2563eb', minWidth: '50px', textAlign: 'center' }}>
+                  {schedPrefs.daysPerWeek} day{schedPrefs.daysPerWeek !== 1 ? 's' : ''}
+                </span>
+              </div>
+              {(() => {
+                const cl = clients.find(c => c.id === selectedClient);
+                const units = cl?.weekly_authorized_units || 0;
+                if (units > 0 && schedPrefs.daysPerWeek > 0) {
+                  const perDay = Math.floor(units / schedPrefs.daysPerWeek);
+                  const rem = units % schedPrefs.daysPerWeek;
+                  return (
+                    <div style={{ fontSize: '0.78rem', color: '#666', marginTop: '0.35rem' }}>
+                      {units} units/wk ÷ {schedPrefs.daysPerWeek} days = <strong>{perDay}u/day</strong> ({(perDay * 15)} min)
+                      {rem > 0 && <span> + {rem} extra unit{rem > 1 ? 's' : ''} spread across first {rem} day{rem > 1 ? 's' : ''}</span>}
+                    </div>
+                  );
+                }
+                return null;
+              })()}
+            </div>
+          </div>
+        )}
+
+        {selectedClient && !clientNeedsLoading && Object.entries(g).map(([cat, caps]) => (
+          <div key={cat} style={s.card}>
+            <div style={s.cardTitle}>{catLabel[cat] || cat}</div>
+            <div style={s.capGrid}>
+              {caps.map(cap => {
+                const a = clientHasNeed(cap.id), need = getClientNeed(cap.id);
+                return (
+                  <div key={cap.id} style={{ ...s.capItem(a), borderColor: a ? (priColors[need?.priority] || '#2563eb') : '#e2e8f0' }} onClick={() => toggleNeed(cap.id)}>
+                    <input type="checkbox" checked={a} readOnly style={{ cursor: 'pointer', width: '16px', height: '16px' }} />
+                    <span style={{ fontSize: '1rem' }}>{cap.icon}</span>
+                    <div style={{ flex: 1 }}><div style={{ fontWeight: '600', fontSize: '0.86rem' }}>{cap.name}</div></div>
+                    {a && <div style={{ display: 'flex', gap: '4px' }} onClick={e => e.stopPropagation()}>
+                      <select value={need?.priority || 'normal'} onChange={e => updateNeedPri(cap.id, e.target.value)} style={{ padding: '2px 4px', fontSize: '0.72rem', border: '1px solid #ddd', borderRadius: '4px', color: priColors[need?.priority || 'normal'], fontWeight: '700' }}>
+                        <option value="critical">🔴 Critical</option><option value="high">🟠 High</option><option value="normal">🔵 Normal</option><option value="low">⚪ Low</option>
+                      </select>
+                      <select value={need?.frequency || 'every_visit'} onChange={e => updateNeedFreq(cap.id, e.target.value)} style={{ padding: '2px 4px', fontSize: '0.72rem', border: '1px solid #ddd', borderRadius: '4px' }}>
+                        <option value="every_visit">Every Visit</option><option value="weekly">Weekly</option><option value="as_needed">As Needed</option>
+                      </select>
+                    </div>}
+                  </div>
+                );
+              })}
+            </div>
+          </div>
+        ))}
+      </div>
+    );
+  };
+
+  // ═══════════════════════════════════════════════
+  // RENDER: Restrictions Tab
+  // ═══════════════════════════════════════════════
+  const renderRestrictions = () => {
+    const g = {};
+    restrictions.forEach(r => { if (!g[r.restriction_type]) g[r.restriction_type] = []; g[r.restriction_type].push(r); });
+    return (
+      <div>
+        <div style={s.card}>
+          <div style={s.cardTitle}>🔒 Client-Caregiver Restrictions</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>
+            <strong>Preferred</strong> = send when possible · <strong>Excluded</strong> = never send · <strong>Locked</strong> = only this person
+          </div>
+          <div style={s.col(2)}><label style={s.label}>Client</label>
+            <select style={s.select} value={restrictionsClient} onChange={e => setRestrictionsClient(e.target.value)}>
+              <option value="">— Select —</option>
+              {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+            </select>
+          </div>
+        </div>
+        {restrictionsClient && (<>
+          <div style={s.card}>
+            <div style={s.cardTitle}>➕ Add Restriction</div>
+            <div style={s.row}>
+              <div style={s.col(2)}><label style={s.label}>Caregiver</label>
+                <select style={s.select} value={newRestriction.caregiverId} onChange={e => setNewRestriction(p => ({ ...p, caregiverId: e.target.value }))}>
+                  <option value="">— Select —</option>
+                  {caregivers.filter(c => !restrictions.some(r => r.caregiver_id === c.id)).map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+                </select>
+              </div>
+              <div style={s.col(1)}><label style={s.label}>Type</label>
+                <select style={s.select} value={newRestriction.type} onChange={e => setNewRestriction(p => ({ ...p, type: e.target.value }))}>
+                  <option value="preferred">💚 Preferred</option><option value="excluded">🚫 Excluded</option><option value="locked">🔒 Locked</option>
+                </select>
+              </div>
+            </div>
+            <div style={{ marginBottom: '0.5rem' }}><label style={s.label}>Reason (admin-only)</label>
+              <input style={s.input} value={newRestriction.reason} onChange={e => setNewRestriction(p => ({ ...p, reason: e.target.value }))} placeholder="Internal note — not visible to caregivers or families" />
+            </div>
+            <button style={s.btn('#2563eb')} onClick={addRestriction}>Add</button>
+          </div>
+          {restrictions.length === 0 ? <div style={{ ...s.card, ...s.emptyState }}>No restrictions set — all caregivers eligible</div>
+          : ['locked', 'preferred', 'excluded'].map(type => {
+            const items = g[type] || [];
+            if (!items.length) return null;
+            return (<div key={type} style={s.card}><div style={{ ...s.cardTitle, color: typeColors[type] }}>{typeLabels[type]} ({items.length})</div>
+              {items.map(r => (<div key={r.id} style={{ display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.5rem 0.65rem', borderRadius: '6px', marginBottom: '4px', background: `${typeColors[type]}08`, border: `1px solid ${typeColors[type]}22` }}>
+                <span style={{ fontSize: '1.1rem' }}>{typeIcons[type]}</span>
+                <div style={{ flex: 1 }}><div style={{ fontWeight: '700', fontSize: '0.88rem' }}>{r.cg_first_name} {r.cg_last_name}</div>
+                  {r.reason && <div style={{ fontSize: '0.72rem', color: '#888', fontStyle: 'italic' }}>{r.reason}</div>}
+                </div>
+                <button style={s.btnSm('#dc2626')} onClick={() => removeRestriction(r.id)}>Remove</button>
+              </div>))}
+            </div>);
+          })}
+        </>)}
+      </div>
+    );
+  };
+
+  // ═══════════════════════════════════════════════
+  // RENDER: Optimizer Tab
+  // ═══════════════════════════════════════════════
+  const renderOptimizer = () => {
+    const r = optimizerResults;
+    return (
+      <div>
+        <div style={s.card}>
+          <div style={s.cardTitle}>🧠 Company-Wide Schedule Optimizer</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>
+            Analyzes capabilities, restrictions, availability, and driving distances to produce optimal caregiver assignments. Spreads each client's weekly units across weekdays.
+          </div>
+          <div style={s.row}>
+            <div style={s.col(1)}><label style={s.label}>Week Starting</label><input type="date" style={s.input} value={optimizerWeek} onChange={e => setOptimizerWeek(e.target.value)} /></div>
+            <div style={s.col(1)}><label style={s.label}>Mode</label>
+              <select style={s.select} value={optimizerMode} onChange={e => setOptimizerMode(e.target.value)}>
+                <option value="generate_fresh">Generate Fresh Schedule</option>
+                <option value="optimize_existing">Optimize Around Existing</option>
+              </select>
+            </div>
+          </div>
+          <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', marginBottom: '0.75rem' }}>
+            {[{ k: 'balanceHours', l: '⚖️ Balance hours' }, { k: 'minimizeDriving', l: '🗺️ Minimize driving' }, { k: 'respectPreferences', l: '💚 Boost preferred' }].map(o => (
+              <label key={o.k} style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', cursor: 'pointer', fontSize: '0.82rem' }}>
+                <input type="checkbox" checked={optimizerOptions[o.k]} onChange={e => setOptimizerOptions(p => ({ ...p, [o.k]: e.target.checked }))} /> {o.l}
+              </label>
+            ))}
+          </div>
+          <button style={s.btn('#7c3aed', optimizing)} onClick={runOptimizer} disabled={optimizing}>
+            {optimizing ? '⏳ Optimizing...' : '🚀 Run Optimizer'}
+          </button>
+        </div>
+
+        {r && (<div>
+          {/* Summary */}
+          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.85rem' }}>
+            {[
+              { v: `${r.summary.coveragePercent}%`, l: 'Coverage', c: r.summary.coveragePercent >= 90 ? '#16a34a' : r.summary.coveragePercent >= 70 ? '#d97706' : '#dc2626' },
+              { v: r.summary.totalClients, l: 'Clients', c: '#2563eb' },
+              { v: `${r.summary.filledSlots}/${r.summary.totalSlots}`, l: 'Slots Filled', c: '#7c3aed' },
+              { v: `${r.summary.totalHoursAssigned}h`, l: 'Assigned', c: '#16a34a' },
+              { v: `${r.summary.totalHoursNeeded}h`, l: 'Needed', c: '#ea580c' },
+              { v: r.summary.swapIterations, l: 'Opt Passes', c: '#64748b' },
+            ].map((st, i) => <div key={i} style={s.stat(st.c)}><div style={s.statVal(st.c)}>{st.v}</div><div style={s.statLbl}>{st.l}</div></div>)}
+          </div>
+
+          {/* Apply controls */}
+          <div style={{ ...s.card, display: 'flex', alignItems: 'center', gap: '1rem', flexWrap: 'wrap' }}>
+            <button style={s.btn('#16a34a', applying)} onClick={applySchedule} disabled={applying}>
+              {applying ? '⏳ Applying...' : '✅ Apply All to Schedule'}
+            </button>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', fontSize: '0.82rem', cursor: 'pointer' }}>
+              <input type="checkbox" checked={clearExisting} onChange={e => setClearExisting(e.target.checked)} />
+              Clear previous optimizer entries for this week first
+            </label>
+            <div style={{ fontSize: '0.72rem', color: '#888', marginLeft: 'auto' }}>
+              Week: {r.weekStart} → {r.weekEnd}
+            </div>
+          </div>
+
+          {/* Client assignments */}
+          <div style={s.card}>
+            <div style={s.cardTitle}>📋 Assignments ({r.assignments.length} clients)</div>
+            {r.assignments.map(a => {
+              const expanded = expandedClient === a.clientId;
+              return (
+                <div key={a.clientId} style={{
+                  padding: '0.65rem', borderRadius: '8px', marginBottom: '6px',
+                  border: `1px solid ${a.unfilledSlots > 0 ? '#fecaca' : '#bbf7d0'}`,
+                  background: a.unfilledSlots > 0 ? '#fef2f2' : '#f0fdf4', cursor: 'pointer'
+                }} onClick={() => setExpandedClient(expanded ? null : a.clientId)}>
+
+                  {/* Header row */}
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.3rem' }}>
+                    <div>
+                      <span style={{ fontWeight: '700', fontSize: '0.9rem' }}>{expanded ? '▼' : '▶'} {a.clientName}</span>
+                      {a.clientCity && <span style={{ fontSize: '0.72rem', color: '#888', marginLeft: '6px' }}>{a.clientCity}</span>}
+                      {a.hasLocked && <span style={s.badge('#7c3aed')}>🔒</span>}
+                      {a.hasExcluded && <span style={s.badge('#dc2626')}>🚫</span>}
+                      {a.criticalNeedsCount > 0 && <span style={s.badge('#dc2626')}>🔴 {a.criticalNeedsCount}</span>}
+                    </div>
+                    <div style={{ fontSize: '0.78rem', fontWeight: '700' }}>
+                      <span style={{ color: '#16a34a' }}>{a.assignedHours}h</span>
+                      <span style={{ color: '#888' }}> / {a.hoursNeeded}h</span>
+                      {a.unfilledSlots > 0 && <span style={{ color: '#dc2626', marginLeft: '6px' }}>⚠️ {a.unfilledSlots} unfilled</span>}
+                    </div>
+                  </div>
+
+                  {/* Compact day summary */}
+                  {!expanded && (
+                    <div style={{ display: 'flex', gap: '4px', marginTop: '0.35rem', flexWrap: 'wrap' }}>
+                      {a.dailySlots.map((sl, i) => (
+                        <div key={i} style={{
+                          padding: '2px 8px', borderRadius: '4px', fontSize: '0.72rem', fontWeight: '600',
+                          background: sl.caregiverId ? '#e0f2fe' : '#fee2e2',
+                          color: sl.caregiverId ? '#0369a1' : '#dc2626'
+                        }}>
+                          {sl.dayLabel}: {sl.caregiverName ? sl.caregiverName.split(' ')[0] : '—'} ({sl.units}u)
+                        </div>
+                      ))}
+                    </div>
+                  )}
+
+                  {/* Expanded daily detail */}
+                  {expanded && (
+                    <div style={{ marginTop: '0.5rem' }} onClick={e => e.stopPropagation()}>
+                      {a.dailySlots.map((sl, i) => (
+                        <div key={i} style={{
+                          display: 'flex', alignItems: 'center', gap: '0.65rem',
+                          padding: '0.45rem 0.65rem', borderRadius: '6px', marginBottom: '3px',
+                          background: sl.caregiverId ? '#fff' : '#fee2e2', border: '1px solid #e2e8f0'
+                        }}>
+                          <div style={{ fontWeight: '700', fontSize: '0.82rem', minWidth: '35px', color: '#555' }}>{sl.dayLabel}</div>
+                          <div style={{ flex: 1 }}>
+                            {sl.caregiverName
+                              ? <span style={{ fontWeight: '600', fontSize: '0.85rem' }}>{sl.caregiverName}</span>
+                              : <span style={{ color: '#dc2626', fontWeight: '600', fontSize: '0.82rem' }}>⚠️ {sl.warning || 'Unfilled'}</span>
+                            }
+                          </div>
+                          <div style={{ fontSize: '0.75rem', color: '#888' }}>{sl.units}u ({sl.hours}h)</div>
+                          {sl.score > 0 && (
+                            <span style={{
+                              padding: '1px 5px', borderRadius: '3px', fontSize: '0.65rem', fontWeight: '700',
+                              background: sl.score >= 80 ? '#dcfce7' : sl.score >= 50 ? '#fef9c3' : '#fef2f2',
+                              color: sl.score >= 80 ? '#16a34a' : sl.score >= 50 ? '#a16207' : '#dc2626'
+                            }}>{sl.score}pts</span>
+                          )}
+                          {sl.factors?.length > 0 && (
+                            <div style={{ fontSize: '0.65rem', color: '#aaa' }}>{sl.factors.join(' · ')}</div>
+                          )}
+                        </div>
+                      ))}
+                    </div>
+                  )}
+                </div>
+              );
+            })}
+          </div>
+
+          {/* Utilization */}
+          <div style={s.card}>
+            <div style={s.cardTitle}>📊 Caregiver Utilization</div>
+            {r.caregiverUtilization.map(cg => (
+              <div key={cg.caregiverId} style={{ display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.3rem 0', fontSize: '0.82rem' }}>
+                <span style={{ fontWeight: '600', minWidth: '130px' }}>{cg.caregiverName}</span>
+                <div style={{ flex: 1, height: '14px', background: '#f1f5f9', borderRadius: '7px', overflow: 'hidden' }}>
+                  <div style={{ width: `${Math.min(100, cg.utilization)}%`, height: '100%', borderRadius: '7px', background: cg.utilization >= 90 ? '#dc2626' : cg.utilization >= 70 ? '#d97706' : '#16a34a' }} />
+                </div>
+                <span style={{ fontWeight: '700', minWidth: '40px', textAlign: 'right', color: cg.utilization >= 90 ? '#dc2626' : '#333' }}>{cg.utilization}%</span>
+                <span style={{ fontSize: '0.72rem', color: '#888', minWidth: '70px' }}>{cg.assignedHours}h/{cg.maxHours}h</span>
+                <span style={{ fontSize: '0.72rem', color: '#888' }}>{cg.clientCount} cl</span>
+              </div>
+            ))}
+          </div>
+        </div>)}
+      </div>
+    );
+  };
+
+  if (loading) return <div style={{ ...s.page, textAlign: 'center', padding: '3rem', color: '#aaa' }}>Loading...</div>;
+
+  return (
+    <div style={s.page}>
+      <h1 style={{ fontSize: '1.35rem', fontWeight: '800', marginBottom: '1rem' }}>🧠 Smart Matching & Optimizer</h1>
+      {message.text && <div style={s.msg(message.type)}>{message.text}</div>}
+      <div style={s.tabs}>
+        {[{ id: 'skills', i: '👤', l: 'Caregiver Skills' }, { id: 'needs', i: '📋', l: 'Client Needs' }, { id: 'restrictions', i: '🔒', l: 'Restrictions' }, { id: 'optimizer', i: '🧠', l: 'Run Optimizer' }].map(t => (
+          <button key={t.id} style={s.tab(activeTab === t.id)} onClick={() => setActiveTab(t.id)}>{t.i} {t.l}</button>
+        ))}
+      </div>
+      {activeTab === 'skills' && renderSkills()}
+      {activeTab === 'needs' && renderNeeds()}
+      {activeTab === 'restrictions' && renderRestrictions()}
+      {activeTab === 'optimizer' && renderOptimizer()}
+    </div>
+  );
+};
+
+export default CompanyOptimizer;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ComplianceTracking.jsx b/templates/crm-homecare/frontend/src/components/admin/ComplianceTracking.jsx
new file mode 100644
index 0000000..6c3f720
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ComplianceTracking.jsx
@@ -0,0 +1,783 @@
+import { confirm } from '../ConfirmModal';
+// src/components/admin/ComplianceTracking.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+const ComplianceTracking = ({ token }) => {
+  const [caregivers, setCaregivers] = useState([]);
+  const [selectedCaregiverId, setSelectedCaregiverId] = useState('');
+  const [backgroundCheck, setBackgroundCheck] = useState(null);
+  const [trainingRecords, setTrainingRecords] = useState([]);
+  const [complianceDocuments, setComplianceDocuments] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState('');
+  const [showBackgroundForm, setShowBackgroundForm] = useState(false);
+  const [showTrainingForm, setShowTrainingForm] = useState(false);
+  const [tab, setTab] = useState('background'); // background, training, documents, overview
+
+  const [backgroundFormData, setBackgroundFormData] = useState({
+    checkDate: '',
+    expirationDate: '',
+    status: 'pending', // pending, cleared, conditional, denied
+    clearanceNumber: '',
+    notes: ''
+  });
+
+  const [trainingFormData, setTrainingFormData] = useState({
+    trainingType: 'cpr',
+    completionDate: '',
+    expirationDate: '',
+    certificationNumber: '',
+    provider: '',
+    status: 'completed' // completed, in_progress, expired
+  });
+
+  const trainingTypes = [
+    { value: 'cpr', label: 'CPR Certification' },
+    { value: 'first_aid', label: 'First Aid' },
+    { value: 'hipaa', label: 'HIPAA Training' },
+    { value: 'infection_control', label: 'Infection Control' },
+    { value: 'bloodborne_pathogen', label: 'Bloodborne Pathogen' },
+    { value: 'safety', label: 'Workplace Safety' },
+    { value: 'dementia_care', label: 'Dementia Care' },
+    { value: 'fall_prevention', label: 'Fall Prevention' },
+    { value: 'manual_handling', label: 'Manual Handling' },
+    { value: 'other', label: 'Other' }
+  ];
+
+  useEffect(() => {
+    loadCaregivers();
+  }, []);
+
+  const loadCaregivers = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/users/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setCaregivers(data);
+      setLoading(false);
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+      setLoading(false);
+    }
+  };
+
+  const handleCaregiverSelect = async (caregiverId) => {
+    setSelectedCaregiverId(caregiverId);
+    setMessage('');
+    
+    try {
+      const [bgRes, trainingRes, docsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/background-check`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/training-records`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/caregivers/${caregiverId}/compliance-documents`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const bgData = await bgRes.json();
+      const trainingData = await trainingRes.json();
+      const docsData = await docsRes.json();
+
+      setBackgroundCheck(bgData || null);
+      setTrainingRecords(Array.isArray(trainingData) ? trainingData : []);
+      setComplianceDocuments(Array.isArray(docsData) ? docsData : []);
+    } catch (error) {
+      console.error('Failed to load compliance data:', error);
+    }
+  };
+
+  const handleSaveBackgroundCheck = async (e) => {
+    e.preventDefault();
+    
+    if (!backgroundFormData.checkDate) {
+      setMessage('Check date is required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${selectedCaregiverId}/background-check`, {
+        method: backgroundCheck ? 'PUT' : 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(backgroundFormData)
+      });
+
+      if (!response.ok) throw new Error('Failed to save background check');
+
+      setMessage('Background check record saved!');
+      setTimeout(() => setMessage(''), 2000);
+      setShowBackgroundForm(false);
+      handleCaregiverSelect(selectedCaregiverId);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleAddTraining = async (e) => {
+    e.preventDefault();
+    
+    if (!trainingFormData.completionDate) {
+      setMessage('Completion date is required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers/${selectedCaregiverId}/training-records`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(trainingFormData)
+      });
+
+      if (!response.ok) throw new Error('Failed to add training record');
+
+      setMessage('Training record added!');
+      setTimeout(() => setMessage(''), 2000);
+      setTrainingFormData({
+        trainingType: 'cpr',
+        completionDate: '',
+        expirationDate: '',
+        certificationNumber: '',
+        provider: '',
+        status: 'completed'
+      });
+      setShowTrainingForm(false);
+      handleCaregiverSelect(selectedCaregiverId);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeleteTraining = async (trainingId) => {
+    const _cok = await confirm('Delete this training record?', {danger: true}); if (!_cok) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/training-records/${trainingId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Training record deleted');
+      setTimeout(() => setMessage(''), 2000);
+      handleCaregiverSelect(selectedCaregiverId);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const isExpiringSoon = (expirationDate) => {
+    if (!expirationDate) return false;
+    const expDate = new Date(expirationDate);
+    const today = new Date();
+    const daysUntilExpire = Math.floor((expDate - today) / (1000 * 60 * 60 * 24));
+    return daysUntilExpire < 30 && daysUntilExpire >= 0;
+  };
+
+  const isExpired = (expirationDate) => {
+    if (!expirationDate) return false;
+    const expDate = new Date(expirationDate);
+    const today = new Date();
+    return expDate < today;
+  };
+
+  const getStatusColor = (status) => {
+    switch (status) {
+      case 'cleared':
+        return '#4caf50';
+      case 'completed':
+        return '#4caf50';
+      case 'conditional':
+        return '#ff9800';
+      case 'in_progress':
+        return '#2196f3';
+      case 'pending':
+        return '#fbc02d';
+      case 'denied':
+        return '#d32f2f';
+      case 'expired':
+        return '#d32f2f';
+      default:
+        return '#999';
+    }
+  };
+
+  const getTrainingTypeLabel = (type) => {
+    const training = trainingTypes.find(t => t.value === type);
+    return training ? training.label : type;
+  };
+
+  const getCaregiverName = (caregiverId) => {
+    const cg = caregivers.find(c => c.id === caregiverId);
+    return cg ? `${cg.first_name} ${cg.last_name}` : '';
+  };
+
+  const getComplianceOverview = () => {
+    let status = 'compliant';
+    let issues = [];
+
+    if (!backgroundCheck) {
+      issues.push('No background check on file');
+      status = 'non-compliant';
+    } else if (backgroundCheck.status === 'denied') {
+      issues.push('Background check denied');
+      status = 'non-compliant';
+    } else if (backgroundCheck.status === 'pending') {
+      issues.push('Background check pending');
+      status = 'incomplete';
+    } else if (isExpired(backgroundCheck.expiration_date)) {
+      issues.push('Background check expired');
+      status = 'non-compliant';
+    } else if (isExpiringSoon(backgroundCheck.expiration_date)) {
+      issues.push('Background check expiring soon');
+      status = 'at-risk';
+    }
+
+    const expiredTraining = trainingRecords.filter(t => isExpired(t.expiration_date));
+    if (expiredTraining.length > 0) {
+      issues.push(`${expiredTraining.length} training certification(s) expired`);
+      status = status === 'non-compliant' ? 'non-compliant' : 'at-risk';
+    }
+
+    const expiringTraining = trainingRecords.filter(t => !isExpired(t.expiration_date) && isExpiringSoon(t.expiration_date));
+    if (expiringTraining.length > 0) {
+      issues.push(`${expiringTraining.length} training certification(s) expiring soon`);
+      status = status === 'non-compliant' ? 'non-compliant' : 'at-risk';
+    }
+
+    return { status, issues };
+  };
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  const overview = selectedCaregiverId ? getComplianceOverview() : null;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Compliance & Training Tracking</h2>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Caregiver Selection */}
+      <div className="card">
+        <h3>Select Caregiver</h3>
+        <select
+          value={selectedCaregiverId}
+          onChange={(e) => handleCaregiverSelect(e.target.value)}
+          style={{ width: '100%', padding: '0.75rem', fontSize: '1rem', borderRadius: '4px', border: '1px solid #ddd' }}
+        >
+          <option value="">Select a caregiver...</option>
+          {caregivers.map(cg => (
+            <option key={cg.id} value={cg.id}>
+              {cg.first_name} {cg.last_name}
+            </option>
+          ))}
+        </select>
+      </div>
+
+      {selectedCaregiverId && (
+        <>
+          {/* Compliance Overview Card */}
+          {overview && (
+            <div className="card" style={{ marginBottom: '1.5rem' }}>
+              <h3>Compliance Status</h3>
+              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
+                <div style={{
+                  padding: '1rem',
+                  borderRadius: '50%',
+                  background: overview.status === 'compliant' ? '#4caf50' : overview.status === 'at-risk' ? '#ff9800' : '#d32f2f',
+                  color: 'white',
+                  fontSize: '1.2rem',
+                  fontWeight: 'bold',
+                  minWidth: '80px',
+                  textAlign: 'center'
+                }}>
+                  {overview.status === 'compliant' ? '✓' : '⚠'}
+                </div>
+                <div>
+                  <strong>{overview.status.toUpperCase()}</strong>
+                  {overview.issues.length > 0 && (
+                    <ul style={{ margin: '0.5rem 0 0 0', paddingLeft: '1.5rem' }}>
+                      {overview.issues.map((issue, idx) => (
+                        <li key={idx} style={{ color: '#d32f2f' }}>{issue}</li>
+                      ))}
+                    </ul>
+                  )}
+                </div>
+              </div>
+            </div>
+          )}
+
+          {/* Tab Navigation */}
+          <div className="card" style={{ marginBottom: '1.5rem' }}>
+            <div style={{ display: 'flex', gap: '0.5rem', borderBottom: '1px solid #ddd', marginBottom: '1rem' }}>
+              {['background', 'training', 'documents', 'overview'].map(t => (
+                <button
+                  key={t}
+                  onClick={() => setTab(t)}
+                  style={{
+                    padding: '1rem',
+                    background: tab === t ? '#2196f3' : 'transparent',
+                    color: tab === t ? 'white' : 'inherit',
+                    border: 'none',
+                    cursor: 'pointer',
+                    fontSize: '0.95rem',
+                    fontWeight: tab === t ? 'bold' : 'normal'
+                  }}
+                >
+                  {t.charAt(0).toUpperCase() + t.slice(1)}
+                </button>
+              ))}
+            </div>
+          </div>
+
+          {/* Background Check Tab */}
+          {tab === 'background' && (
+            <div className="card">
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #ddd' }}>
+                <h3 style={{ margin: 0 }}>Background Check</h3>
+                <button
+                  className="btn btn-sm btn-primary"
+                  onClick={() => setShowBackgroundForm(!showBackgroundForm)}
+                >
+                  {showBackgroundForm ? 'Cancel' : backgroundCheck ? 'Edit' : 'Add'}
+                </button>
+              </div>
+
+              {showBackgroundForm && (
+                <form onSubmit={handleSaveBackgroundCheck} style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+                  <div className="form-grid-2">
+                    <div className="form-group">
+                      <label>Check Date *</label>
+                      <input
+                        type="date"
+                        value={backgroundFormData.checkDate}
+                        onChange={(e) => setBackgroundFormData({ ...backgroundFormData, checkDate: e.target.value })}
+                        required
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Expiration Date</label>
+                      <input
+                        type="date"
+                        value={backgroundFormData.expirationDate}
+                        onChange={(e) => setBackgroundFormData({ ...backgroundFormData, expirationDate: e.target.value })}
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Status *</label>
+                      <select
+                        value={backgroundFormData.status}
+                        onChange={(e) => setBackgroundFormData({ ...backgroundFormData, status: e.target.value })}
+                      >
+                        <option value="pending">Pending</option>
+                        <option value="cleared">Cleared</option>
+                        <option value="conditional">Conditional</option>
+                        <option value="denied">Denied</option>
+                      </select>
+                    </div>
+
+                    <div className="form-group">
+                      <label>Clearance Number</label>
+                      <input
+                        type="text"
+                        value={backgroundFormData.clearanceNumber}
+                        onChange={(e) => setBackgroundFormData({ ...backgroundFormData, clearanceNumber: e.target.value })}
+                        placeholder="Reference number..."
+                      />
+                    </div>
+                  </div>
+
+                  <div className="form-group">
+                    <label>Notes</label>
+                    <textarea
+                      value={backgroundFormData.notes}
+                      onChange={(e) => setBackgroundFormData({ ...backgroundFormData, notes: e.target.value })}
+                      placeholder="Any notes or conditions..."
+                      rows="2"
+                    ></textarea>
+                  </div>
+
+                  <div className="form-actions">
+                    <button type="submit" className="btn btn-primary">Save Background Check</button>
+                    <button type="button" className="btn btn-secondary" onClick={() => setShowBackgroundForm(false)}>Cancel</button>
+                  </div>
+                </form>
+              )}
+
+              {backgroundCheck ? (
+                <div style={{
+                  padding: '1rem',
+                  background: '#f9f9f9',
+                  borderLeft: `4px solid ${getStatusColor(backgroundCheck.status)}`,
+                  borderRadius: '4px'
+                }}>
+                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+                    <div>
+                      <strong>Check Date:</strong>
+                      <p>{new Date(backgroundCheck.check_date).toLocaleDateString()}</p>
+                    </div>
+                    <div>
+                      <strong>Status:</strong>
+                      <p>
+                        <span className="badge" style={{ background: getStatusColor(backgroundCheck.status), color: 'white' }}>
+                          {backgroundCheck.status.toUpperCase()}
+                        </span>
+                      </p>
+                    </div>
+                    {backgroundCheck.expiration_date && (
+                      <div>
+                        <strong>Expiration:</strong>
+                        <p>
+                          {new Date(backgroundCheck.expiration_date).toLocaleDateString()}
+                          {isExpired(backgroundCheck.expiration_date) && <span style={{ color: '#d32f2f' }}> (EXPIRED)</span>}
+                          {isExpiringSoon(backgroundCheck.expiration_date) && <span style={{ color: '#ff9800' }}> (EXPIRING SOON)</span>}
+                        </p>
+                      </div>
+                    )}
+                    {backgroundCheck.clearance_number && (
+                      <div>
+                        <strong>Clearance #:</strong>
+                        <p>{backgroundCheck.clearance_number}</p>
+                      </div>
+                    )}
+                  </div>
+                  {backgroundCheck.notes && (
+                    <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #ddd' }}>
+                      <strong>Notes:</strong>
+                      <p>{backgroundCheck.notes}</p>
+                    </div>
+                  )}
+                </div>
+              ) : (
+                <p style={{ color: '#999', textAlign: 'center', padding: '1rem' }}>
+                  No background check on file.
+                </p>
+              )}
+            </div>
+          )}
+
+          {/* Training Tab */}
+          {tab === 'training' && (
+            <div className="card">
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #ddd' }}>
+                <h3 style={{ margin: 0 }}>Training Records</h3>
+                <button
+                  className="btn btn-sm btn-primary"
+                  onClick={() => setShowTrainingForm(!showTrainingForm)}
+                >
+                  {showTrainingForm ? 'Cancel' : 'Add Training'}
+                </button>
+              </div>
+
+              {showTrainingForm && (
+                <form onSubmit={handleAddTraining} style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+                  <div className="form-grid-2">
+                    <div className="form-group">
+                      <label>Training Type *</label>
+                      <select
+                        value={trainingFormData.trainingType}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, trainingType: e.target.value })}
+                      >
+                        {trainingTypes.map(t => (
+                          <option key={t.value} value={t.value}>{t.label}</option>
+                        ))}
+                      </select>
+                    </div>
+
+                    <div className="form-group">
+                      <label>Completion Date *</label>
+                      <input
+                        type="date"
+                        value={trainingFormData.completionDate}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, completionDate: e.target.value })}
+                        required
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Expiration Date</label>
+                      <input
+                        type="date"
+                        value={trainingFormData.expirationDate}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, expirationDate: e.target.value })}
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Certification #</label>
+                      <input
+                        type="text"
+                        value={trainingFormData.certificationNumber}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, certificationNumber: e.target.value })}
+                        placeholder="Reference number..."
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Provider</label>
+                      <input
+                        type="text"
+                        value={trainingFormData.provider}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, provider: e.target.value })}
+                        placeholder="Training provider name..."
+                      />
+                    </div>
+
+                    <div className="form-group">
+                      <label>Status</label>
+                      <select
+                        value={trainingFormData.status}
+                        onChange={(e) => setTrainingFormData({ ...trainingFormData, status: e.target.value })}
+                      >
+                        <option value="completed">Completed</option>
+                        <option value="in_progress">In Progress</option>
+                        <option value="expired">Expired</option>
+                      </select>
+                    </div>
+                  </div>
+
+                  <div className="form-actions">
+                    <button type="submit" className="btn btn-primary">Add Training Record</button>
+                    <button type="button" className="btn btn-secondary" onClick={() => setShowTrainingForm(false)}>Cancel</button>
+                  </div>
+                </form>
+              )}
+
+              {trainingRecords.length === 0 ? (
+                <p style={{ color: '#999', textAlign: 'center', padding: '1rem' }}>
+                  No training records on file.
+                </p>
+              ) : (
+                <div style={{ display: 'grid', gap: '0.75rem' }}>
+                  {trainingRecords
+                    .sort((a, b) => new Date(b.completion_date) - new Date(a.completion_date))
+                    .map(training => (
+                      <div
+                        key={training.id}
+                        style={{
+                          padding: '1rem',
+                          background: '#f9f9f9',
+                          borderLeft: `4px solid ${getStatusColor(training.status)}`,
+                          borderRadius: '4px',
+                          display: 'flex',
+                          justifyContent: 'space-between',
+                          alignItems: 'start'
+                        }}
+                      >
+                        <div>
+                          <strong>{getTrainingTypeLabel(training.training_type)}</strong>
+                          <div style={{ fontSize: '0.9rem', color: '#666', marginTop: '0.25rem' }}>
+                            Completed: {new Date(training.completion_date).toLocaleDateString()}
+                          </div>
+                          {training.expiration_date && (
+                            <div style={{ fontSize: '0.9rem', color: '#666' }}>
+                              Expires: {new Date(training.expiration_date).toLocaleDateString()}
+                              {isExpired(training.expiration_date) && <span style={{ color: '#d32f2f' }}> (EXPIRED)</span>}
+                              {isExpiringSoon(training.expiration_date) && <span style={{ color: '#ff9800' }}> (EXPIRING SOON)</span>}
+                            </div>
+                          )}
+                          {training.certification_number && (
+                            <div style={{ fontSize: '0.9rem', color: '#666' }}>
+                              Cert #: {training.certification_number}
+                            </div>
+                          )}
+                          {training.provider && (
+                            <div style={{ fontSize: '0.9rem', color: '#666' }}>
+                              Provider: {training.provider}
+                            </div>
+                          )}
+                        </div>
+                        <button
+                          className="btn btn-sm btn-danger"
+                          onClick={() => handleDeleteTraining(training.id)}
+                        >
+                          Delete
+                        </button>
+                      </div>
+                    ))}
+                </div>
+              )}
+            </div>
+          )}
+
+          {/* Documents Tab */}
+          {tab === 'documents' && (
+            <div className="card">
+              <h3>Compliance Documents</h3>
+              <p style={{ color: '#666', marginBottom: '1rem' }}>
+                Scans of background check clearance, certifications, training documentation, etc.
+              </p>
+              
+              {complianceDocuments.length === 0 ? (
+                <p style={{ color: '#999', textAlign: 'center', padding: '2rem' }}>
+                  No documents uploaded yet.
+                </p>
+              ) : (
+                <div style={{ display: 'grid', gap: '0.75rem' }}>
+                  {complianceDocuments.map(doc => (
+                    <div
+                      key={doc.id}
+                      style={{
+                        padding: '1rem',
+                        background: '#f9f9f9',
+                        borderRadius: '4px',
+                        display: 'flex',
+                        justifyContent: 'space-between',
+                        alignItems: 'center'
+                      }}
+                    >
+                      <div>
+                        <strong>{doc.document_name}</strong>
+                        <div style={{ fontSize: '0.9rem', color: '#666', marginTop: '0.25rem' }}>
+                          Uploaded: {new Date(doc.uploaded_date).toLocaleDateString()}
+                        </div>
+                      </div>
+                      <a
+                        href={doc.file_url}
+                        target="_blank"
+                        rel="noopener noreferrer"
+                        className="btn btn-sm btn-primary"
+                      >
+                        View
+                      </a>
+                    </div>
+                  ))}
+                </div>
+              )}
+            </div>
+          )}
+
+          {/* Overview Tab */}
+          {tab === 'overview' && (
+            <ExpiryOverview token={token} />
+          )}
+        </>
+      )}
+    </div>
+  );
+};
+
+// ─── All-Caregivers Expiry Overview ───────────────────────────────────────────
+const ExpiryOverview = ({ token }) => {
+  const [data, setData] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [days, setDays] = useState(60);
+  const [filter, setFilter] = useState('all'); // all, expiring_soon, expired, no_check, current
+
+  useEffect(() => { loadData(); }, [days]);
+
+  const loadData = async () => {
+    setLoading(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/background-checks/overview/expiring?days=${days}`, {
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      const result = await res.json();
+      setData(Array.isArray(result) ? result : []);
+    } catch { toast('Failed to load expiry overview', 'error'); }
+    finally { setLoading(false); }
+  };
+
+  const filtered = data.filter(d => filter === 'all' || d.expiry_status === filter);
+  const counts = {
+    expired: data.filter(d => d.expiry_status === 'expired').length,
+    expiring_soon: data.filter(d => d.expiry_status === 'expiring_soon').length,
+    no_check: data.filter(d => d.expiry_status === 'no_check').length,
+    current: data.filter(d => d.expiry_status === 'current').length,
+  };
+
+  const statusLabel = { expired: { label: 'Expired', color: '#DC2626', bg: '#FEF2F2', border: '#FCA5A5' }, expiring_soon: { label: 'Expiring Soon', color: '#D97706', bg: '#FFFBEB', border: '#FCD34D' }, no_check: { label: 'No Check on File', color: '#6B7280', bg: '#F9FAFB', border: '#D1D5DB' }, current: { label: 'Current', color: '#16A34A', bg: '#F0FDF4', border: '#BBF7D0' } };
+
+  return (
+    <div>
+      <h3 style={{ margin: '0 0 1rem' }}>🛡️ Background Check Expiry — All Caregivers</h3>
+
+      <div style={{ display: 'flex', gap: '0.75rem', marginBottom: '1rem', flexWrap: 'wrap', alignItems: 'center' }}>
+        <select value={days} onChange={e => setDays(Number(e.target.value))}
+          style={{ padding: '0.4rem 0.75rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }}>
+          <option value={30}>Expiring in 30 days</option>
+          <option value={60}>Expiring in 60 days</option>
+          <option value={90}>Expiring in 90 days</option>
+          <option value={180}>Expiring in 180 days</option>
+        </select>
+        <button onClick={loadData} style={{ padding: '0.4rem 0.875rem', background: '#2ABBA7', color: '#fff', border: 'none', borderRadius: '6px', cursor: 'pointer', fontSize: '0.85rem', fontWeight: '600' }}>Refresh</button>
+      </div>
+
+      {/* Summary cards */}
+      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '0.75rem', marginBottom: '1rem' }}>
+        {Object.entries(counts).map(([key, count]) => {
+          const s = statusLabel[key];
+          return (
+            <button key={key} onClick={() => setFilter(filter === key ? 'all' : key)}
+              style={{ padding: '0.75rem', background: filter === key ? s.bg : '#fff', border: `2px solid ${filter === key ? s.border : '#E5E7EB'}`, borderRadius: '8px', cursor: 'pointer', textAlign: 'center', transition: 'all 0.15s' }}>
+              <div style={{ fontSize: '1.4rem', fontWeight: '800', color: s.color }}>{count}</div>
+              <div style={{ fontSize: '0.72rem', color: '#6B7280', fontWeight: '600' }}>{s.label}</div>
+            </button>
+          );
+        })}
+      </div>
+
+      {loading ? <div style={{ textAlign: 'center', padding: '2rem', color: '#6B7280' }}>Loading...</div> : filtered.length === 0 ? (
+        <div style={{ textAlign: 'center', padding: '2rem', color: '#6B7280' }}>
+          {filter === 'all' ? 'No caregivers found.' : `No caregivers with "${statusLabel[filter]?.label}" status.`}
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+          {filtered.map(cg => {
+            const s = statusLabel[cg.expiry_status] || statusLabel.no_check;
+            const daysUntil = cg.days_until_expiry ? parseInt(cg.days_until_expiry) : null;
+            return (
+              <div key={cg.caregiver_id} style={{ padding: '0.875rem', background: '#fff', borderRadius: '8px', border: `1px solid ${s.border}`, display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.5rem' }}>
+                <div>
+                  <div style={{ fontWeight: '700', color: '#111827' }}>{cg.first_name} {cg.last_name}</div>
+                  <div style={{ fontSize: '0.82rem', color: '#6B7280' }}>
+                    {cg.email} {cg.phone && `• ${cg.phone}`}
+                  </div>
+                </div>
+                <div style={{ textAlign: 'right' }}>
+                  <span style={{ padding: '0.2rem 0.6rem', borderRadius: '6px', fontSize: '0.78rem', fontWeight: '700', background: s.bg, color: s.color, border: `1px solid ${s.border}` }}>
+                    {s.label}
+                  </span>
+                  <div style={{ fontSize: '0.78rem', color: '#6B7280', marginTop: '0.2rem' }}>
+                    {cg.expiration_date ? `Expires: ${new Date(cg.expiration_date).toLocaleDateString()}` : 'No check on file'}
+                    {daysUntil !== null && daysUntil > 0 && ` (${daysUntil} days)`}
+                    {daysUntil !== null && daysUntil <= 0 && ` (${Math.abs(daysUntil)} days ago)`}
+                  </div>
+                </div>
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ComplianceTracking;
diff --git a/templates/crm-homecare/frontend/src/components/admin/DashboardOverview.jsx b/templates/crm-homecare/frontend/src/components/admin/DashboardOverview.jsx
new file mode 100644
index 0000000..867257c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/DashboardOverview.jsx
@@ -0,0 +1,191 @@
+// src/components/admin/DashboardOverview.jsx
+import React, { useState, useEffect } from 'react';
+import { getDashboardReferrals, getDashboardHours } from '../../config';
+
+const DashboardOverview = ({ summary, token, onNavigate }) => {
+  const [referrals, setReferrals] = useState([]);
+  const [caregiverHours, setCaregiverHours] = useState([]);
+  const [loading, setLoading] = useState(true);
+
+  useEffect(() => {
+    loadAnalytics();
+  }, []);
+
+  const loadAnalytics = async () => {
+    try {
+      const [refData, hourData] = await Promise.all([
+        getDashboardReferrals(token),
+        getDashboardHours(token)
+      ]);
+      setReferrals(refData);
+      setCaregiverHours(hourData);
+    } catch (error) {
+      console.error('Failed to load analytics:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // Helper to safely format currency (handles strings from PostgreSQL)
+  const formatCurrency = (value) => {
+    const num = parseFloat(value) || 0;
+    return num.toFixed(2);
+  };
+
+  if (loading) return (
+    <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(200px, 1fr))", gap: "1rem" }}>
+      {[1,2,3,4].map(i => (
+        <div key={i} style={{ height: "80px", borderRadius: "10px", background: "linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%)", backgroundSize: "200% 100%", animation: "shimmer 1.5s infinite" }} />
+      ))}
+      <style>{"@keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }"}</style>
+    </div>
+  );
+
+  return (
+    <>
+      {/* Key Metrics */}
+      <div className="grid">
+        <div className="stat-card">
+          <h3>Active Clients</h3>
+          <div className="value">{summary?.totalClients || 0}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Active Caregivers</h3>
+          <div className="value">{summary?.activeCaregivers || 0}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Pending Invoices</h3>
+          <div className="value value-danger">
+            ${formatCurrency(summary?.pendingInvoices?.amount)}
+          </div>
+          <p className="stat-subtext">
+            {summary?.pendingInvoices?.count || 0} invoices
+          </p>
+        </div>
+        <div className="stat-card">
+          <h3>This Month Revenue</h3>
+          <div className="value value-success">
+            ${formatCurrency(summary?.thisMonthRevenue)}
+          </div>
+        </div>
+      </div>
+
+      {/* Referral Sources Performance */}
+      <div className="card">
+        <div className="card-title">🏥 Referral Sources Performance</div>
+        
+        {referrals.length === 0 ? (
+          <p className="card-empty-state">No referral data yet</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Referral Source</th>
+                <th>Type</th>
+                <th>Referrals</th>
+                <th>Revenue</th>
+              </tr>
+            </thead>
+            <tbody>
+              {referrals.map(ref => (
+                <tr key={ref.name}>
+                  <td><strong>{ref.name}</strong></td>
+                  <td>
+                    <span className="badge badge-info">
+                      {ref.type || 'General'}
+                    </span>
+                  </td>
+                  <td>{ref.referral_count || 0}</td>
+                  <td>${formatCurrency(ref.total_revenue)}</td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Caregiver Hours & Performance */}
+      <div className="card">
+        <div className="card-title">👔 Caregiver Hours & Performance</div>
+        
+        {caregiverHours.length === 0 ? (
+          <p className="card-empty-state">No caregiver data yet</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Caregiver</th>
+                <th>Shifts</th>
+                <th>Total Hours</th>
+                <th>Avg Satisfaction</th>
+              </tr>
+            </thead>
+            <tbody>
+              {caregiverHours.map(cg => (
+                <tr key={cg.id}>
+                  <td><strong>{cg.first_name} {cg.last_name}</strong></td>
+                  <td>{cg.shifts || 0}</td>
+                  <td>{cg.total_hours || 0} hrs</td>
+                  <td>
+                    {cg.avg_satisfaction ? (
+                      <>
+                        <span className="star-icon">★</span> {parseFloat(cg.avg_satisfaction).toFixed(2)}
+                      </>
+                    ) : (
+                      'N/A'
+                    )}
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Today Panel */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div className="card-title">📅 Today — {new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</div>
+        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '0.75rem' }}>
+          {[
+            { label: 'Shifts Today', value: summary?.todayShifts || 0, icon: '📋', color: '#2563EB' },
+            { label: 'Clocked In Now', value: summary?.clockedInNow || 0, icon: '✅', color: '#16A34A' },
+            { label: 'Shifts Remaining', value: summary?.remainingShifts || 0, icon: '⏰', color: '#D97706' },
+            { label: 'Coverage Gaps', value: summary?.coverageGaps || 0, icon: '🚨', color: summary?.coverageGaps > 0 ? '#DC2626' : '#16A34A' },
+          ].map(s => (
+            <div key={s.label} style={{ padding: '0.75rem', background: '#F9FAFB', borderRadius: '8px', textAlign: 'center', border: '1px solid #E5E7EB' }}>
+              <div style={{ fontSize: '1.3rem' }}>{s.icon}</div>
+              <div style={{ fontSize: '1.5rem', fontWeight: '800', color: s.color, lineHeight: 1.1 }}>{s.value}</div>
+              <div style={{ fontSize: '0.72rem', color: '#6B7280', fontWeight: '600', marginTop: '0.2rem' }}>{s.label}</div>
+            </div>
+          ))}
+        </div>
+        {summary?.coverageGaps > 0 && (
+          <div style={{ marginTop: '0.75rem', padding: '0.6rem 0.875rem', background: '#FEF2F2', borderRadius: '6px', border: '1px solid #FCA5A5', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+            <span style={{ fontSize: '0.875rem', color: '#DC2626', fontWeight: '600' }}>
+              ⚠️ {summary.coverageGaps} shift{summary.coverageGaps !== 1 ? 's' : ''} need{summary.coverageGaps === 1 ? 's' : ''} coverage
+            </span>
+            <button onClick={() => onNavigate && onNavigate('emergency-coverage')}
+              style={{ padding: '0.3rem 0.75rem', background: '#DC2626', color: '#fff', border: 'none', borderRadius: '6px', cursor: 'pointer', fontSize: '0.8rem', fontWeight: '600' }}>
+              Find Coverage →
+            </button>
+          </div>
+        )}
+      </div>
+
+      {/* Quick Actions */}
+      <div className="card">
+        <div className="card-title">⚡ Quick Actions</div>
+        <div className="quick-actions-grid">
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('onboarding')}>➕ New Client</button>
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('caregivers')}>➕ New Caregiver</button>
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('billing')}>📄 Billing</button>
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('reports')}>📊 Reports</button>
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('emergency-coverage')}>🚨 Emergency Coverage</button>
+          <button className="btn btn-primary" onClick={() => onNavigate && onNavigate('background-checks')}>🔍 Background Checks</button>
+        </div>
+      </div>
+    </>
+  );
+};
+
+export default DashboardOverview;
diff --git a/templates/crm-homecare/frontend/src/components/admin/DocumentsManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/DocumentsManagement.jsx
new file mode 100644
index 0000000..b4dd70a
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/DocumentsManagement.jsx
@@ -0,0 +1,465 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/DocumentsManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const DocumentsManagement = ({ token }) => {
+  const [documents, setDocuments] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ entityType: '', category: '' });
+  const [showUploadModal, setShowUploadModal] = useState(false);
+  const [clients, setClients] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+
+  useEffect(() => {
+    loadDocuments();
+    loadClients();
+    loadCaregivers();
+  }, [filter]);
+
+  const loadDocuments = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.entityType) params.append('entityType', filter.entityType);
+      if (filter.category) params.append('category', filter.category);
+      
+      const res = await fetch(`${API_BASE_URL}/api/documents?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setDocuments(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load documents:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const loadCaregivers = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setCaregivers(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+    }
+  };
+
+  const uploadDocument = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/documents`, {
+        method: 'POST',
+        headers: { 'Authorization': `Bearer ${token}` },
+        body: formData
+      });
+      if (res.ok) {
+        setShowUploadModal(false);
+        loadDocuments();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed to upload: ' + error.message, 'error');
+    }
+  };
+
+  const deleteDocument = async (docId) => {
+    const _cok = await confirm('Delete this document? This cannot be undone.', {danger: true}); if (!_cok) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/documents/${docId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadDocuments();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const downloadDocument = async (doc) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/documents/${doc.id}/download`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        const blob = await res.blob();
+        const url = window.URL.createObjectURL(blob);
+        const a = document.createElement('a');
+        a.href = url;
+        a.download = doc.file_name;
+        a.click();
+        window.URL.revokeObjectURL(url);
+      }
+    } catch (error) {
+      toast('Failed to download: ' + error.message, 'error');
+    }
+  };
+
+  const getCategoryBadge = (category) => {
+    const colors = {
+      medical: '#e91e63',
+      legal: '#9c27b0',
+      insurance: '#3f51b5',
+      care_plan: '#00bcd4',
+      assessment: '#009688',
+      contract: '#ff9800',
+      certification: '#8bc34a',
+      background_check: '#795548',
+      other: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[category] || '#9e9e9e'
+      }}>
+        {category?.replace('_', ' ').toUpperCase()}
+      </span>
+    );
+  };
+
+  const getFileIcon = (fileName) => {
+    const ext = fileName?.split('.').pop()?.toLowerCase();
+    const icons = {
+      pdf: '📄',
+      doc: '📝',
+      docx: '📝',
+      xls: '📊',
+      xlsx: '📊',
+      jpg: '🖼️',
+      jpeg: '🖼️',
+      png: '🖼️',
+      txt: '📃'
+    };
+    return icons[ext] || '📁';
+  };
+
+  const formatFileSize = (bytes) => {
+    if (!bytes) return '-';
+    if (bytes < 1024) return bytes + ' B';
+    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
+    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
+  };
+
+  const clientDocs = documents.filter(d => d.entity_type === 'client');
+  const caregiverDocs = documents.filter(d => d.entity_type === 'caregiver');
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📁 Document Management</h2>
+        <button className="btn btn-primary" onClick={() => setShowUploadModal(true)}>
+          + Upload Document
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, entityType: '' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Total</h4>
+          <div className="value">{documents.length}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, entityType: 'client' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Client Docs</h4>
+          <div className="value" style={{ color: '#2196f3' }}>{clientDocs.length}</div>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ ...filter, entityType: 'caregiver' })}
+          style={{ cursor: 'pointer' }}
+        >
+          <h4>Caregiver Docs</h4>
+          <div className="value" style={{ color: '#4caf50' }}>{caregiverDocs.length}</div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Type</label>
+            <select value={filter.entityType} onChange={(e) => setFilter({ ...filter, entityType: e.target.value })}>
+              <option value="">All Types</option>
+              <option value="client">Client</option>
+              <option value="caregiver">Caregiver</option>
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Category</label>
+            <select value={filter.category} onChange={(e) => setFilter({ ...filter, category: e.target.value })}>
+              <option value="">All Categories</option>
+              <option value="medical">Medical</option>
+              <option value="legal">Legal</option>
+              <option value="insurance">Insurance</option>
+              <option value="care_plan">Care Plan</option>
+              <option value="assessment">Assessment</option>
+              <option value="contract">Contract</option>
+              <option value="certification">Certification</option>
+              <option value="background_check">Background Check</option>
+              <option value="other">Other</option>
+            </select>
+          </div>
+        </div>
+      </div>
+
+      {/* Documents Table */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : documents.length === 0 ? (
+          <p>No documents found. Upload a document to get started.</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th style={{ width: '40px' }}></th>
+                <th>Document Name</th>
+                <th>For</th>
+                <th>Category</th>
+                <th>Size</th>
+                <th>Uploaded</th>
+                <th>Expires</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {documents.map(doc => (
+                <tr key={doc.id}>
+                  <td style={{ fontSize: '1.5rem' }}>{getFileIcon(doc.file_name)}</td>
+                  <td>
+                    <strong>{doc.document_name || doc.file_name}</strong>
+                    <div style={{ fontSize: '0.8rem', color: '#666' }}>{doc.file_name}</div>
+                  </td>
+                  <td>
+                    <span style={{ 
+                      padding: '2px 6px', 
+                      borderRadius: '4px', 
+                      fontSize: '0.7rem',
+                      backgroundColor: doc.entity_type === 'client' ? '#e3f2fd' : '#e8f5e9',
+                      color: doc.entity_type === 'client' ? '#1565c0' : '#2e7d32'
+                    }}>
+                      {doc.entity_type?.toUpperCase()}
+                    </span>
+                    <div style={{ fontWeight: 'bold', marginTop: '2px' }}>
+                      {doc.entity_first_name} {doc.entity_last_name}
+                    </div>
+                  </td>
+                  <td>{getCategoryBadge(doc.category)}</td>
+                  <td>{formatFileSize(doc.file_size)}</td>
+                  <td style={{ fontSize: '0.85rem' }}>
+                    {new Date(doc.uploaded_at).toLocaleDateString()}
+                  </td>
+                  <td>
+                    {doc.expiration_date ? (
+                      <span style={{ 
+                        color: new Date(doc.expiration_date) < new Date() ? '#f44336' : '#333'
+                      }}>
+                        {new Date(doc.expiration_date).toLocaleDateString()}
+                      </span>
+                    ) : '-'}
+                  </td>
+                  <td>
+                    <div style={{ display: 'flex', gap: '0.25rem' }}>
+                      <button 
+                        className="btn btn-sm btn-secondary"
+                        onClick={() => downloadDocument(doc)}
+                        title="Download"
+                      >
+                        ⬇️
+                      </button>
+                      <button 
+                        className="btn btn-sm btn-danger"
+                        onClick={() => deleteDocument(doc.id)}
+                        title="Delete"
+                      >
+                        🗑️
+                      </button>
+                    </div>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Upload Modal */}
+      {showUploadModal && (
+        <div className="modal-overlay" onClick={() => setShowUploadModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Upload Document</h3>
+              <button className="modal-close" onClick={() => setShowUploadModal(false)}>×</button>
+            </div>
+            <UploadForm 
+              clients={clients}
+              caregivers={caregivers}
+              onSubmit={uploadDocument}
+              onCancel={() => setShowUploadModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Upload Form Component
+const UploadForm = ({ clients, caregivers, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    entityType: 'client',
+    entityId: '',
+    category: 'other',
+    documentName: '',
+    expirationDate: '',
+    notes: ''
+  });
+  const [file, setFile] = useState(null);
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!file) {
+      toast('Please select a file');
+      return;
+    }
+    if (!formData.entityId) {
+      toast('Please select a client or caregiver');
+      return;
+    }
+
+    const data = new FormData();
+    data.append('file', file);
+    data.append('entityType', formData.entityType);
+    data.append('entityId', formData.entityId);
+    data.append('category', formData.category);
+    data.append('documentName', formData.documentName || file.name);
+    if (formData.expirationDate) data.append('expirationDate', formData.expirationDate);
+    if (formData.notes) data.append('notes', formData.notes);
+
+    onSubmit(data);
+  };
+
+  const entities = formData.entityType === 'client' ? clients : caregivers;
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Document Type *</label>
+        <select 
+          value={formData.entityType}
+          onChange={(e) => setFormData({ ...formData, entityType: e.target.value, entityId: '' })}
+        >
+          <option value="client">Client Document</option>
+          <option value="caregiver">Caregiver Document</option>
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>{formData.entityType === 'client' ? 'Client' : 'Caregiver'} *</label>
+        <select 
+          value={formData.entityId}
+          onChange={(e) => setFormData({ ...formData, entityId: e.target.value })}
+          required
+        >
+          <option value="">Select {formData.entityType === 'client' ? 'Client' : 'Caregiver'}</option>
+          {entities.map(e => (
+            <option key={e.id} value={e.id}>{e.first_name} {e.last_name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Category</label>
+        <select 
+          value={formData.category}
+          onChange={(e) => setFormData({ ...formData, category: e.target.value })}
+        >
+          <option value="medical">Medical</option>
+          <option value="legal">Legal</option>
+          <option value="insurance">Insurance</option>
+          <option value="care_plan">Care Plan</option>
+          <option value="assessment">Assessment</option>
+          <option value="contract">Contract</option>
+          <option value="certification">Certification</option>
+          <option value="background_check">Background Check</option>
+          <option value="other">Other</option>
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Document Name</label>
+        <input 
+          type="text"
+          value={formData.documentName}
+          onChange={(e) => setFormData({ ...formData, documentName: e.target.value })}
+          placeholder="Optional display name"
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Expiration Date</label>
+        <input 
+          type="date"
+          value={formData.expirationDate}
+          onChange={(e) => setFormData({ ...formData, expirationDate: e.target.value })}
+        />
+      </div>
+
+      <div className="form-group">
+        <label>File *</label>
+        <input 
+          type="file"
+          onChange={(e) => setFile(e.target.files[0])}
+          accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.txt"
+          required
+        />
+        <small style={{ color: '#666' }}>Max 10MB. Accepted: PDF, Word, Excel, Images, Text</small>
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Optional notes about this document"
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Upload</button>
+      </div>
+    </form>
+  );
+};
+
+export default DocumentsManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/DragDropScheduler.jsx b/templates/crm-homecare/frontend/src/components/admin/DragDropScheduler.jsx
new file mode 100644
index 0000000..3698ebd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/DragDropScheduler.jsx
@@ -0,0 +1,616 @@
+// SchedulerGrid.jsx - Weekly schedule grid: click cell to create, click shift to edit/delete
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const PALETTE = [
+  '#3B82F6','#10B981','#F59E0B','#EF4444','#8B5CF6',
+  '#06B6D4','#F97316','#EC4899','#14B8A6','#6366F1',
+];
+
+function clientColor(clientId, clientMap) {
+  const ids = Object.keys(clientMap).sort();
+  return PALETTE[ids.indexOf(clientId) % PALETTE.length];
+}
+
+function timeToMinutes(t) {
+  if (!t) return 0;
+  const [h, m] = t.split(':').map(Number);
+  return h * 60 + m;
+}
+
+function formatTime(t) {
+  if (!t) return '';
+  const [h, m] = t.split(':').map(Number);
+  return `${h % 12 || 12}:${m.toString().padStart(2,'0')} ${h >= 12 ? 'PM' : 'AM'}`;
+}
+
+function getWeekStart(date) {
+  const d = new Date(date);
+  d.setDate(d.getDate() - d.getDay());
+  d.setHours(0,0,0,0);
+  return d;
+}
+
+function getWeekDates(weekStart) {
+  return Array.from({ length: 7 }, (_, i) => {
+    const d = new Date(weekStart);
+    d.setDate(d.getDate() + i);
+    return d;
+  });
+}
+
+const DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
+const DAY_FULL  = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
+
+export default function SchedulerGrid({ token, onScheduleChange }) {
+  const [weekOf, setWeekOf]             = useState(getWeekStart(new Date()));
+  const [caregivers, setCaregivers]     = useState([]);
+  const [clients, setClients]           = useState([]);
+  const [schedules, setSchedules]       = useState([]);
+  const [loading, setLoading]           = useState(true);
+  const [saving, setSaving]             = useState(false);
+  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);
+  const [mobileDay, setMobileDay] = useState(new Date().getDay());
+  const [toast, setToast]               = useState(null);
+  const [newShift, setNewShift]         = useState(null);
+  const [newShiftForm, setNewShiftForm] = useState({ clientId:'', startTime:'09:00', endTime:'13:00', notes:'' });
+  const [editShift, setEditShift]         = useState(null);
+  const [editShiftForm, setEditShiftForm] = useState({ clientId:'', startTime:'', endTime:'', notes:'' });
+  const [editScope, setEditScope]         = useState('all'); // 'all' | 'once'
+  const [editDate, setEditDate]           = useState('');
+
+  const clientMap = Object.fromEntries(clients.map(c => [c.id, c]));
+
+  const showToast = (msg, type = 'success') => {
+    setToast({ msg, type });
+    setTimeout(() => setToast(null), 3500);
+  };
+
+  const loadAll = useCallback(async () => {
+    setLoading(true);
+    try {
+      const [cgRes, clRes, schRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers`,     { headers: { Authorization: `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/clients`,        { headers: { Authorization: `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/schedules-all`,  { headers: { Authorization: `Bearer ${token}` } }),
+      ]);
+      const [cgs, cls, schs] = await Promise.all([cgRes.json(), clRes.json(), schRes.json()]);
+      setCaregivers(Array.isArray(cgs) ? cgs : []);
+      setClients(Array.isArray(cls) ? cls : []);
+      setSchedules(Array.isArray(schs) ? schs : []);
+    } catch {
+      showToast('Failed to load schedule data', 'error');
+    } finally {
+      setLoading(false);
+    }
+  }, [token]);
+
+  useEffect(() => { loadAll(); }, [loadAll]);
+
+  const weekDates    = getWeekDates(weekOf);
+  const weekDateStrs = weekDates.map(d => d.toISOString().split('T')[0]);
+  const todayStr     = new Date().toISOString().split('T')[0];
+  const todayIdx     = weekDateStrs.indexOf(todayStr);
+
+  function getShiftsForCell(caregiverId, dayIndex) {
+    const dateStr  = weekDateStrs[dayIndex];
+    const cellDate = new Date(dateStr + 'T00:00:00');
+
+    return schedules.filter(s => {
+      if (s.caregiver_id !== caregiverId) return false;
+
+      // One-off
+      if (s.date) return s.date.slice(0,10) === dateStr;
+
+      // Recurring — only show from creation week forward
+      if (s.day_of_week !== null && s.day_of_week !== undefined) {
+        if (Number(s.day_of_week) !== dayIndex) return false;
+        const effectiveFrom = s.effective_date || s.anchor_date || s.created_at;
+        if (effectiveFrom) {
+          const from = new Date(effectiveFrom);
+          from.setHours(0,0,0,0);
+          if (cellDate < from) return false;
+        }
+        return true;
+      }
+      return false;
+    });
+  }
+
+  function weeklyHours(caregiverId) {
+    let total = 0;
+    for (let d = 0; d < 7; d++) {
+      getShiftsForCell(caregiverId, d).forEach(s => {
+        total += (timeToMinutes(s.end_time) - timeToMinutes(s.start_time)) / 60;
+      });
+    }
+    return total;
+  }
+
+  function prevWeek() { const d = new Date(weekOf); d.setDate(d.getDate()-7); setWeekOf(d); }
+  function nextWeek() { const d = new Date(weekOf); d.setDate(d.getDate()+7); setWeekOf(d); }
+  function goToday()  { setWeekOf(getWeekStart(new Date())); }
+
+  function handleCellClick(caregiverId, dayIndex) {
+    if (saving) return;
+    setNewShift({ caregiverId, dayIndex });
+    setNewShiftForm({ clientId:'', startTime:'09:00', endTime:'13:00', notes:'' });
+  }
+
+  async function handleCreateShift() {
+    if (!newShiftForm.clientId) return showToast('Select a client', 'error');
+    setSaving(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/schedules-enhanced`, {
+        method: 'POST',
+        headers: { 'Content-Type':'application/json', Authorization:`Bearer ${token}` },
+        body: JSON.stringify({
+          caregiverId:  newShift.caregiverId,
+          clientId:     newShiftForm.clientId,
+          scheduleType: 'one-time',
+          date:         weekDateStrs[newShift.dayIndex],
+          startTime:    newShiftForm.startTime,
+          endTime:      newShiftForm.endTime,
+          notes:        newShiftForm.notes,
+        }),
+      });
+      if (!res.ok) throw new Error('Failed to create shift');
+      showToast('Shift created ✓');
+      setNewShift(null);
+      await loadAll();
+      onScheduleChange && onScheduleChange();
+    } catch (err) {
+      showToast(err.message, 'error');
+    } finally {
+      setSaving(false);
+    }
+  }
+
+  async function handleDeleteShift(scheduleId) {
+    if (!window.confirm('Delete this shift?')) return;
+    setSaving(true);
+    try {
+      await fetch(`${API_BASE_URL}/api/schedules-all/${scheduleId}`, {
+        method: 'DELETE',
+        headers: { Authorization:`Bearer ${token}` },
+      });
+      showToast('Shift deleted ✓');
+      setEditShift(null);
+      await loadAll();
+      onScheduleChange && onScheduleChange();
+    } catch {
+      showToast('Delete failed', 'error');
+    } finally {
+      setSaving(false);
+    }
+  }
+
+  function openEditShift(s, cellDate) {
+    setEditShift(s);
+    setEditDate(cellDate || '');
+    setEditScope('all');
+    setEditShiftForm({
+      clientId:  s.client_id || '',
+      startTime: s.start_time ? s.start_time.slice(0,5) : '09:00',
+      endTime:   s.end_time   ? s.end_time.slice(0,5)   : '13:00',
+      notes:     s.notes || '',
+    });
+  }
+
+  async function handleSaveShift() {
+    if (!editShiftForm.clientId) return showToast('Select a client', 'error');
+    if (editShiftForm.startTime >= editShiftForm.endTime) return showToast('End time must be after start', 'error');
+    setSaving(true);
+    try {
+      if (editScope === 'once') {
+        // Create a one-time override for just this date
+        const res = await fetch(`${API_BASE_URL}/api/schedules-enhanced`, {
+          method: 'POST',
+          headers: { 'Content-Type':'application/json', Authorization:`Bearer ${token}` },
+          body: JSON.stringify({
+            caregiverId:  editShift.caregiver_id,
+            clientId:     editShiftForm.clientId,
+            scheduleType: 'one-time',
+            date:         editDate,
+            startTime:    editShiftForm.startTime,
+            endTime:      editShiftForm.endTime,
+            notes:        editShiftForm.notes,
+          }),
+        });
+        if (!res.ok) throw new Error('Failed to create one-time shift');
+        showToast(`One-time shift created for ${new Date(editDate + 'T12:00:00').toLocaleDateString('en-US', { weekday:'short', month:'short', day:'numeric' })} ✓`);
+      } else {
+        // Update the recurring schedule itself
+        const res = await fetch(`${API_BASE_URL}/api/schedules-all/${editShift.id}`, {
+          method: 'PUT',
+          headers: { 'Content-Type':'application/json', Authorization:`Bearer ${token}` },
+          body: JSON.stringify({
+            clientId:   editShiftForm.clientId,
+            startTime:  editShiftForm.startTime,
+            endTime:    editShiftForm.endTime,
+            notes:      editShiftForm.notes,
+            dayOfWeek:  editShift.day_of_week,
+            date:       editShift.date ? editShift.date.slice(0,10) : null,
+            frequency:  editShift.frequency || 'weekly',
+            anchorDate: editShift.anchor_date || null,
+          }),
+        });
+        if (!res.ok) throw new Error('Failed to save');
+        showToast('Shift updated ✓');
+      }
+      setEditShift(null);
+      await loadAll();
+      onScheduleChange && onScheduleChange();
+    } catch (err) {
+      showToast(err.message, 'error');
+    } finally {
+      setSaving(false);
+    }
+  }
+
+  if (loading) return (
+    <div style={{ display:'flex', alignItems:'center', justifyContent:'center', height:300, color:'#6B7280' }}>
+      <div style={{ textAlign:'center' }}>
+        <div style={{ fontSize:32, marginBottom:12 }}>📅</div>
+        Loading schedule...
+      </div>
+    </div>
+  );
+
+  return (
+    <div style={{ fontFamily:"'Segoe UI', sans-serif", background:'#F8FAFC' }}>
+
+      {/* Toast */}
+      {toast && (
+        <div style={{
+          position:'fixed', top:20, right:20, zIndex:9999,
+          background: toast.type === 'error' ? '#EF4444' : '#10B981',
+          color:'#fff', padding:'10px 18px', borderRadius:8,
+          fontWeight:600, fontSize:14, boxShadow:'0 4px 16px rgba(0,0,0,0.15)',
+        }}>
+          {toast.msg}
+        </div>
+      )}
+
+      {/* Header */}
+      <div style={{ background:'#fff', borderBottom:'1px solid #E5E7EB', padding:'12px 20px', display:'flex', alignItems:'center', gap:12, flexWrap:'wrap' }}>
+        <div style={{ display:'flex', gap:6 }}>
+          <button onClick={prevWeek} style={navBtn}>‹</button>
+          <button onClick={goToday}  style={{ ...navBtn, padding:'6px 14px', fontSize:13 }}>Today</button>
+          <button onClick={nextWeek} style={navBtn}>›</button>
+        </div>
+        <span style={{ fontWeight:700, fontSize:16, color:'#111827', flex:1 }}>
+          {weekDates[0].toLocaleDateString('en-US', { month:'short', day:'numeric' })}
+          {' – '}
+          {weekDates[6].toLocaleDateString('en-US', { month:'short', day:'numeric', year:'numeric' })}
+        </span>
+        <span style={{ fontSize:12, color:'#9CA3AF' }}>Click any cell to add a shift</span>
+      </div>
+
+      {/* Mobile Day Picker */}
+      {isMobile && (
+        <div style={{ background:'#fff', borderBottom:'1px solid #E5E7EB', padding:'8px 12px', overflowX:'auto', display:'flex', gap:6 }}>
+          {weekDates.map((d, i) => (
+            <button key={i} onClick={() => setMobileDay(i)} style={{
+              flexShrink: 0,
+              padding: '6px 12px',
+              borderRadius: 8,
+              border: 'none',
+              background: mobileDay === i ? '#2ABBA7' : i === todayIdx ? '#EFF6FF' : '#F3F4F6',
+              color: mobileDay === i ? '#fff' : i === todayIdx ? '#2563EB' : '#374151',
+              fontWeight: mobileDay === i ? 700 : 500,
+              fontSize: 13,
+              cursor: 'pointer',
+            }}>
+              <div style={{ fontSize: 10, textTransform: 'uppercase', letterSpacing: 1 }}>{DAY_NAMES[i]}</div>
+              <div style={{ fontSize: 16, fontWeight: 800 }}>{d.getDate()}</div>
+            </button>
+          ))}
+        </div>
+      )}
+
+      {/* Mobile Day View */}
+      {isMobile && (
+        <div style={{ padding: '0.75rem' }}>
+          {caregivers.length === 0 && (
+            <div style={{ textAlign:'center', padding:'40px 20px', color:'#9CA3AF' }}>No caregivers found.</div>
+          )}
+          {caregivers.map(cg => {
+            const shifts = getShiftsForCell(cg.id, mobileDay);
+            return (
+              <div key={cg.id} style={{ background:'#fff', borderRadius:12, border:'1px solid #E5E7EB', marginBottom:'0.75rem', overflow:'hidden' }}>
+                <div style={{ padding:'10px 14px', background:'#FAFAFA', borderBottom:'1px solid #F3F4F6', display:'flex', justifyContent:'space-between', alignItems:'center' }}>
+                  <div>
+                    <div style={{ fontWeight:700, fontSize:14, color:'#111827' }}>{cg.first_name} {cg.last_name}</div>
+                    <div style={{ fontSize:11, color:'#6B7280' }}>{weeklyHours(cg.id).toFixed(2)}h this week</div>
+                  </div>
+                  <button onClick={() => handleCellClick(cg.id, mobileDay)} style={{
+                    padding:'6px 14px', borderRadius:8, border:'none',
+                    background:'#2ABBA7', color:'#fff', fontSize:13, fontWeight:600, cursor:'pointer'
+                  }}>+ Shift</button>
+                </div>
+                {shifts.length === 0 ? (
+                  <div style={{ padding:'12px 14px', color:'#9CA3AF', fontSize:13 }}>No shifts</div>
+                ) : (
+                  shifts.map(s => {
+                    const cl = clientMap[s.client_id];
+                    const color = clientColor(s.client_id, clientMap);
+                    const durH = ((timeToMinutes(s.end_time) - timeToMinutes(s.start_time)) / 60).toFixed(2);
+                    return (
+                      <div key={s.id} onClick={() => openEditShift(s, weekDateStrs[mobileDay])} style={{
+                        padding:'10px 14px', borderLeft:`4px solid ${color}`,
+                        borderBottom:'1px solid #F9FAFB', cursor:'pointer', display:'flex', justifyContent:'space-between', alignItems:'center'
+                      }}>
+                        <div>
+                          <div style={{ fontWeight:600, fontSize:14 }}>{cl ? `${cl.first_name} ${cl.last_name}` : 'Unknown'}</div>
+                          <div style={{ fontSize:12, color:'#6B7280', marginTop:2 }}>{formatTime(s.start_time)} – {formatTime(s.end_time)} · {durH}h</div>
+                        </div>
+                        <span style={{ fontSize:12, color:'#9CA3AF' }}>✏️</span>
+                      </div>
+                    );
+                  })
+                )}
+              </div>
+            );
+          })}
+        </div>
+      )}
+
+      {/* Desktop Grid */}
+      {!isMobile && <div style={{ overflowX:'auto' }}>
+        <div style={{ minWidth:860 }}>
+
+          {/* Day headers */}
+          <div style={{ display:'grid', gridTemplateColumns:'160px repeat(7, 1fr)', background:'#fff', borderBottom:'2px solid #E5E7EB', position:'sticky', top:0, zIndex:10 }}>
+            <div style={{ padding:'10px 16px', fontSize:11, fontWeight:700, color:'#9CA3AF' }}>CAREGIVER</div>
+            {weekDates.map((d, i) => (
+              <div key={i} style={{
+                padding:'10px 8px', textAlign:'center',
+                borderLeft:'1px solid #F3F4F6',
+                background: i === todayIdx ? '#EFF6FF' : 'transparent',
+              }}>
+                <div style={{ fontSize:11, fontWeight:700, color: i === todayIdx ? '#3B82F6' : '#6B7280', textTransform:'uppercase', letterSpacing:1 }}>
+                  {DAY_NAMES[i]}
+                </div>
+                <div style={{ fontSize:18, fontWeight:800, color: i === todayIdx ? '#3B82F6' : '#111827' }}>
+                  {d.getDate()}
+                </div>
+              </div>
+            ))}
+          </div>
+
+          {/* Rows */}
+          {caregivers.length === 0 && (
+            <div style={{ textAlign:'center', padding:'60px 20px', color:'#9CA3AF' }}>
+              No caregivers found.
+            </div>
+          )}
+
+          {caregivers.map(cg => {
+            const hrs    = weeklyHours(cg.id).toFixed(2);
+            const isOver = parseFloat(hrs) > 40;
+            return (
+              <div key={cg.id} style={{ display:'grid', gridTemplateColumns:'160px repeat(7, 1fr)', borderBottom:'1px solid #F3F4F6', background:'#fff', minHeight:72 }}>
+
+                {/* Name */}
+                <div style={{ padding:'10px 14px', borderRight:'1px solid #F3F4F6', background:'#FAFAFA' }}>
+                  <div style={{ fontWeight:700, fontSize:13, color:'#111827', whiteSpace:'nowrap', overflow:'hidden', textOverflow:'ellipsis' }}>
+                    {cg.first_name} {cg.last_name}
+                  </div>
+                  <div style={{ fontSize:11, color: isOver ? '#EF4444' : '#6B7280', fontWeight: isOver ? 700 : 400, marginTop:2 }}>
+                    {hrs}h{isOver ? ' ⚠️ OT' : ''}
+                  </div>
+                </div>
+
+                {/* Day cells */}
+                {weekDates.map((_, dayIndex) => {
+                  const shifts  = getShiftsForCell(cg.id, dayIndex);
+                  const isToday = dayIndex === todayIdx;
+                  return (
+                    <div
+                      key={dayIndex}
+                      onClick={() => handleCellClick(cg.id, dayIndex)}
+                      style={{
+                        borderLeft:'1px solid #F3F4F6',
+                        padding:'5px 4px',
+                        minHeight:72,
+                        background: isToday ? '#F0F9FF' : 'transparent',
+                        cursor:'pointer',
+                        transition:'background 0.1s',
+                      }}
+                      onMouseEnter={e => e.currentTarget.style.background = isToday ? '#DBEAFE' : '#F9FAFB'}
+                      onMouseLeave={e => e.currentTarget.style.background = isToday ? '#F0F9FF' : 'transparent'}
+                    >
+                      {shifts.map(s => {
+                        const client = clientMap[s.client_id];
+                        const color  = clientColor(s.client_id, clientMap);
+                        const durH   = ((timeToMinutes(s.end_time) - timeToMinutes(s.start_time)) / 60).toFixed(2);
+                        return (
+                          <div
+                            key={s.id}
+                            onClick={e => { e.stopPropagation(); openEditShift(s, weekDateStrs[dayIndex]); }}
+                            style={{
+                              background: color,
+                              color:'#fff',
+                              borderRadius:5,
+                              padding:'3px 6px',
+                              marginBottom:3,
+                              fontSize:11,
+                              fontWeight:600,
+                              cursor:'pointer',
+                              userSelect:'none',
+                              boxShadow:'0 1px 3px rgba(0,0,0,0.15)',
+                            }}
+                          >
+                            <div style={{ whiteSpace:'nowrap', overflow:'hidden', textOverflow:'ellipsis', fontWeight:700 }}>
+                              {client ? `${client.first_name} ${client.last_name}` : 'Unknown'}
+                            </div>
+                            <div style={{ opacity:0.9, fontSize:10 }}>
+                              {formatTime(s.start_time)}–{formatTime(s.end_time)} ({durH}h)
+                              {!s.date && <span style={{ marginLeft:4, opacity:0.7 }}>↻</span>}
+                            </div>
+                          </div>
+                        );
+                      })}
+                    </div>
+                  );
+                })}
+              </div>
+            );
+          })}
+        </div>
+      </div>}
+
+      {/* Client legend */}
+      {clients.length > 0 && (
+        <div style={{ padding:'12px 20px', background:'#fff', borderTop:'1px solid #E5E7EB', display:'flex', flexWrap:'wrap', gap:10, alignItems:'center' }}>
+          <span style={{ fontSize:11, fontWeight:700, color:'#9CA3AF', textTransform:'uppercase', letterSpacing:1 }}>Clients:</span>
+          {clients.map((c, i) => (
+            <div key={c.id} style={{ display:'flex', alignItems:'center', gap:5, fontSize:12, color:'#374151' }}>
+              <div style={{ width:10, height:10, borderRadius:2, background:PALETTE[i % PALETTE.length] }} />
+              {c.first_name} {c.last_name}
+            </div>
+          ))}
+        </div>
+      )}
+
+      {/* Create shift modal */}
+      {newShift && (
+        <Modal
+          title={`New Shift — ${DAY_FULL[newShift.dayIndex]}, ${weekDates[newShift.dayIndex].toLocaleDateString('en-US',{ month:'long', day:'numeric' })}`}
+          onClose={() => setNewShift(null)}
+        >
+          <Field label="Client">
+            <select value={newShiftForm.clientId} onChange={e => setNewShiftForm(f => ({ ...f, clientId:e.target.value }))} style={inputStyle}>
+              <option value="">— Select client —</option>
+              {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+            </select>
+          </Field>
+          <div style={{ display:'grid', gridTemplateColumns:'1fr 1fr', gap:12, marginTop:12 }}>
+            <Field label="Start">
+              <input type="time" value={newShiftForm.startTime} onChange={e => setNewShiftForm(f => ({ ...f, startTime:e.target.value }))} style={inputStyle} />
+            </Field>
+            <Field label="End">
+              <input type="time" value={newShiftForm.endTime} onChange={e => setNewShiftForm(f => ({ ...f, endTime:e.target.value }))} style={inputStyle} />
+            </Field>
+          </div>
+          <Field label="Notes (optional)" style={{ marginTop:12 }}>
+            <input type="text" value={newShiftForm.notes} onChange={e => setNewShiftForm(f => ({ ...f, notes:e.target.value }))} style={inputStyle} placeholder="Any notes..." />
+          </Field>
+          <div style={{ display:'flex', justifyContent:'flex-end', gap:8, marginTop:16 }}>
+            <button onClick={() => setNewShift(null)} style={cancelBtn}>Cancel</button>
+            <button onClick={handleCreateShift} disabled={saving} style={primaryBtn}>
+              {saving ? 'Creating...' : 'Create Shift'}
+            </button>
+          </div>
+        </Modal>
+      )}
+
+      {/* Edit/delete shift modal */}
+      {editShift && (() => {
+        const color = clientColor(editShiftForm.clientId || editShift.client_id, clientMap);
+        const durH  = editShiftForm.startTime && editShiftForm.endTime
+          ? ((timeToMinutes(editShiftForm.endTime) - timeToMinutes(editShiftForm.startTime)) / 60).toFixed(2)
+          : '0';
+        const isRecurring = editShift.day_of_week !== null && editShift.day_of_week !== undefined;
+        return (
+          <Modal title="Edit Shift" onClose={() => setEditShift(null)}>
+            {isRecurring && (
+              <div style={{ marginBottom:12 }}>
+                <div style={{ fontSize:12, fontWeight:700, color:'#374151', marginBottom:6 }}>Apply changes to:</div>
+                <div style={{ display:'flex', gap:8 }}>
+                  <button type="button" onClick={() => setEditScope('all')} style={{
+                    flex:1, padding:'8px 0', borderRadius:8, border:'2px solid', cursor:'pointer', fontWeight:600, fontSize:13,
+                    borderColor: editScope === 'all' ? '#F59E0B' : '#E5E7EB',
+                    background: editScope === 'all' ? '#FFFBEB' : '#fff',
+                    color: editScope === 'all' ? '#92400E' : '#6B7280',
+                  }}>↻ All future occurrences</button>
+                  <button type="button" onClick={() => setEditScope('once')} style={{
+                    flex:1, padding:'8px 0', borderRadius:8, border:'2px solid', cursor:'pointer', fontWeight:600, fontSize:13,
+                    borderColor: editScope === 'once' ? '#3B82F6' : '#E5E7EB',
+                    background: editScope === 'once' ? '#EFF6FF' : '#fff',
+                    color: editScope === 'once' ? '#1D4ED8' : '#6B7280',
+                  }}>📅 This date only{editDate ? ` (${new Date(editDate + 'T12:00:00').toLocaleDateString('en-US', { month:'short', day:'numeric' })})` : ''}</button>
+                </div>
+                {editScope === 'once' && (
+                  <div style={{ marginTop:6, fontSize:12, color:'#2563EB', background:'#EFF6FF', padding:'6px 10px', borderRadius:6 }}>
+                    A one-time shift will be created for this date. The recurring schedule stays unchanged.
+                  </div>
+                )}
+                {editScope === 'all' && (
+                  <div style={{ marginTop:6, fontSize:12, color:'#92400E', background:'#FFFBEB', padding:'6px 10px', borderRadius:6 }}>
+                    Changes will apply to all future instances of this recurring shift.
+                  </div>
+                )}
+              </div>
+            )}
+            <Field label="Client">
+              <select value={editShiftForm.clientId} onChange={e => setEditShiftForm(f => ({ ...f, clientId: e.target.value }))} style={inputStyle}>
+                <option value=''>Select client...</option>
+                {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </Field>
+            <div style={{ display:'grid', gridTemplateColumns:'1fr 1fr', gap:10, marginTop:10 }}>
+              <Field label="Start Time">
+                <input type="time" value={editShiftForm.startTime} onChange={e => setEditShiftForm(f => ({ ...f, startTime: e.target.value }))} style={inputStyle} />
+              </Field>
+              <Field label="End Time">
+                <input type="time" value={editShiftForm.endTime} onChange={e => setEditShiftForm(f => ({ ...f, endTime: e.target.value }))} style={inputStyle} />
+              </Field>
+            </div>
+            {editShiftForm.startTime && editShiftForm.endTime && (
+              <div style={{ textAlign:'center', fontSize:12, color:'#6B7280', margin:'6px 0 2px', background:'#F3F4F6', borderRadius:6, padding:'4px 0' }}>
+                {formatTime(editShiftForm.startTime)} – {formatTime(editShiftForm.endTime)} · <strong>{durH}h</strong>
+              </div>
+            )}
+            <Field label="Notes (optional)" style={{ marginTop:10 }}>
+              <input type="text" value={editShiftForm.notes} onChange={e => setEditShiftForm(f => ({ ...f, notes: e.target.value }))} style={inputStyle} placeholder="Any notes..." />
+            </Field>
+            <div style={{ display:'flex', justifyContent:'space-between', marginTop:16 }}>
+              <button onClick={() => handleDeleteShift(editShift.id)} disabled={saving} style={{ ...cancelBtn, color:'#EF4444', borderColor:'#FECACA' }}>
+                {saving ? '...' : 'Delete Shift'}
+              </button>
+              <div style={{ display:'flex', gap:8 }}>
+                <button onClick={() => setEditShift(null)} style={cancelBtn}>Cancel</button>
+                <button onClick={handleSaveShift} disabled={saving} style={primaryBtn}>
+                  {saving ? 'Saving...' : 'Save Changes'}
+                </button>
+              </div>
+            </div>
+          </Modal>
+        );
+      })()}
+    </div>
+  );
+}
+
+function Modal({ title, onClose, children }) {
+  return (
+    <div
+      style={{ position:'fixed', inset:0, background:'rgba(0,0,0,0.4)', zIndex:1000, display:'flex', alignItems:'center', justifyContent:'center', padding:16 }}
+      onClick={e => e.target === e.currentTarget && onClose()}
+    >
+      <div style={{ background:'#fff', borderRadius:12, width:'100%', maxWidth:420, boxShadow:'0 20px 60px rgba(0,0,0,0.2)' }}>
+        <div style={{ padding:'14px 20px', borderBottom:'1px solid #E5E7EB', display:'flex', justifyContent:'space-between', alignItems:'center' }}>
+          <h3 style={{ margin:0, fontSize:15, fontWeight:700, color:'#111827' }}>{title}</h3>
+          <button onClick={onClose} style={{ background:'none', border:'none', cursor:'pointer', fontSize:20, color:'#9CA3AF', lineHeight:1 }}>×</button>
+        </div>
+        <div style={{ padding:20 }}>{children}</div>
+      </div>
+    </div>
+  );
+}
+
+function Field({ label, children, style }) {
+  return (
+    <div style={style}>
+      <label style={{ display:'block', fontSize:11, fontWeight:700, color:'#374151', marginBottom:4, textTransform:'uppercase', letterSpacing:0.5 }}>{label}</label>
+      {children}
+    </div>
+  );
+}
+
+const inputStyle  = { width:'100%', padding:'8px 10px', border:'1px solid #D1D5DB', borderRadius:6, fontSize:14, boxSizing:'border-box' };
+const primaryBtn  = { background:'#3B82F6', color:'#fff', border:'none', borderRadius:7, padding:'9px 20px', fontWeight:700, fontSize:14, cursor:'pointer' };
+const cancelBtn   = { background:'#fff', color:'#6B7280', border:'1px solid #D1D5DB', borderRadius:7, padding:'9px 16px', fontWeight:600, fontSize:14, cursor:'pointer' };
+const navBtn      = { background:'#F3F4F6', border:'1px solid #E5E7EB', borderRadius:7, padding:'6px 12px', cursor:'pointer', fontSize:15, color:'#374151', fontWeight:600 };
diff --git a/templates/crm-homecare/frontend/src/components/admin/EditClientModal.jsx b/templates/crm-homecare/frontend/src/components/admin/EditClientModal.jsx
new file mode 100644
index 0000000..d935cde
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/EditClientModal.jsx
@@ -0,0 +1,859 @@
+// src/components/admin/EditClientModal.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const formatDateForInput = (dateString) => {
+  if (!dateString) return '';
+  const date = new Date(dateString);
+  return date.toISOString().split('T')[0];
+};
+
+const EditClientModal = ({ client, referralSources = [], careTypes = [], isOpen, onClose, onSuccess, token }) => {
+  const [activeTab, setActiveTab] = useState('basic');
+  const [formData, setFormData] = useState({});
+  const [loading, setLoading] = useState(false);
+  const [message, setMessage] = useState('');
+  const [deleteConfirm, setDeleteConfirm] = useState(false);
+
+  // ── Portal state ──────────────────────────────────────────────────────────
+  const [portalStatus, setPortalStatus]   = useState(null);
+  const [portalEmail, setPortalEmail]     = useState('');
+  const [portalLoading, setPortalLoading] = useState(false);
+  const [portalMessage, setPortalMessage] = useState({ text: '', type: '' });
+  const [inviteUrl, setInviteUrl]         = useState('');
+
+  useEffect(() => {
+    if (client && isOpen) {
+      setFormData({
+        // Basic Info
+        firstName: client.first_name || '',
+        lastName: client.last_name || '',
+        dateOfBirth: formatDateForInput(client.date_of_birth),
+        gender: client.gender || '',
+        phone: client.phone || '',
+        email: client.email || '',
+        // Address
+        address: client.address || '',
+        city: client.city || '',
+        state: client.state || 'WI',
+        zip: client.zip || '',
+        // Billing/Referral
+        referralSourceId: client.referral_source_id || '',
+        careTypeId: client.care_type_id || '',
+        isPrivatePay: client.is_private_pay || false,
+        privatePayRate: client.private_pay_rate || '',
+        privatePayRateType: client.private_pay_rate_type || 'hourly',
+        billingNotes: client.billing_notes || '',
+        weeklyAuthorizedUnits: client.weekly_authorized_units || '',
+        // Emergency Contact
+        emergencyContactName: client.emergency_contact_name || '',
+        emergencyContactPhone: client.emergency_contact_phone || '',
+        emergencyContactRelationship: client.emergency_contact_relationship || '',
+        // Medical
+        medicalConditions: client.medical_conditions || '',
+        medications: client.medications || '',
+        allergies: client.allergies || '',
+        medicalNotes: client.medical_notes || '',
+        mobilityAssistanceNeeds: client.mobility_assistance_needs || '',
+        // Insurance
+        insuranceProvider: client.insurance_provider || '',
+        insuranceId: client.insurance_id || '',
+        insuranceGroup: client.insurance_group || '',
+        // Caregiver Preferences
+        carePreferences: client.care_preferences || '',
+        preferredCaregivers: client.preferred_caregivers || '',
+        doNotUseCaregivers: client.do_not_use_caregivers || '',
+        // Notes
+        notes: client.notes || ''
+      });
+      setActiveTab('basic');
+      setDeleteConfirm(false);
+      setMessage('');
+
+      // Load portal status for this client
+      setPortalStatus(null);
+      setPortalEmail(client.email || '');
+      setInviteUrl('');
+      setPortalMessage({ text: '', type: '' });
+      fetch(`${API_BASE_URL}/api/client-portal/admin/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      })
+        .then(r => r.json())
+        .then(data => {
+          const found = Array.isArray(data) ? data.find(c => c.id === client.id) : null;
+          if (found) {
+            setPortalStatus(found.portal_status);
+            if (found.portal_email) setPortalEmail(found.portal_email);
+          } else {
+            setPortalStatus('not_invited');
+          }
+        })
+        .catch(() => setPortalStatus('not_invited'));
+    }
+  }, [client, isOpen]);
+
+  const handleSave = async (e) => {
+    e.preventDefault();
+    setLoading(true);
+    setMessage('');
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients/${client.id}`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          firstName: formData.firstName,
+          lastName: formData.lastName,
+          dateOfBirth: formData.dateOfBirth || null,
+          gender: formData.gender || null,
+          phone: formData.phone || null,
+          email: formData.email || null,
+          address: formData.address || null,
+          city: formData.city || null,
+          state: formData.state || null,
+          zip: formData.zip || null,
+          referralSourceId: formData.referralSourceId || null,
+          careTypeId: formData.careTypeId || null,
+          isPrivatePay: formData.isPrivatePay,
+          privatePayRate: formData.isPrivatePay ? parseFloat(formData.privatePayRate) : null,
+          privatePayRateType: formData.privatePayRateType,
+          billingNotes: formData.billingNotes || null,
+          weeklyAuthorizedUnits: formData.weeklyAuthorizedUnits ? parseInt(formData.weeklyAuthorizedUnits) : null,
+          emergencyContactName: formData.emergencyContactName || null,
+          emergencyContactPhone: formData.emergencyContactPhone || null,
+          emergencyContactRelationship: formData.emergencyContactRelationship || null,
+          medicalConditions: formData.medicalConditions || null,
+          medications: formData.medications || null,
+          allergies: formData.allergies || null,
+          medicalNotes: formData.medicalNotes || null,
+          mobilityAssistanceNeeds: formData.mobilityAssistanceNeeds || null,
+          insuranceProvider: formData.insuranceProvider || null,
+          insuranceId: formData.insuranceId || null,
+          insuranceGroup: formData.insuranceGroup || null,
+          carePreferences: formData.carePreferences || null,
+          preferredCaregivers: formData.preferredCaregivers || null,
+          doNotUseCaregivers: formData.doNotUseCaregivers || null,
+          notes: formData.notes || null
+        })
+      });
+
+      if (!response.ok) {
+        const errorData = await response.json();
+        throw new Error(errorData.error || 'Failed to update client');
+      }
+
+      setMessage('Client updated successfully!');
+      setTimeout(() => {
+        onSuccess();
+        onClose();
+      }, 1000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleDelete = async () => {
+    if (!deleteConfirm) {
+      setDeleteConfirm(true);
+      return;
+    }
+
+    setLoading(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/clients/${client.id}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete client');
+
+      setMessage('Client deleted.');
+      setTimeout(() => {
+        onSuccess();
+        onClose();
+      }, 1000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+      setDeleteConfirm(false);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  if (!isOpen || !client) return null;
+
+  const tabs = [
+    { id: 'basic',     label: '📋 Basic Info' },
+    { id: 'billing',   label: '💰 Billing'    },
+    { id: 'medical',   label: '🏥 Medical'    },
+    { id: 'caregivers',label: '👤 Caregivers' },
+    { id: 'portal',    label: '🌐 Portal'     },
+  ];
+
+  // ── Portal handlers ───────────────────────────────────────────────────────
+  const handleSendInvite = async () => {
+    if (!portalEmail.trim()) {
+      return setPortalMessage({ text: 'Enter an email address first.', type: 'error' });
+    }
+    setPortalLoading(true);
+    setPortalMessage({ text: '', type: '' });
+    setInviteUrl('');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/client-portal/admin/invite`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ clientId: client.id, email: portalEmail.trim() }),
+      });
+      const data = await res.json();
+      if (!res.ok) throw new Error(data.error || 'Failed to create invite');
+      setInviteUrl(data.inviteUrl);
+      setPortalStatus('invite_pending');
+      setPortalMessage({ text: `Invite created for ${portalEmail}. Copy the link below and send it to the client.`, type: 'success' });
+    } catch (err) {
+      setPortalMessage({ text: err.message, type: 'error' });
+    } finally {
+      setPortalLoading(false);
+    }
+  };
+
+  const handleTogglePortal = async (enable) => {
+    setPortalLoading(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/client-portal/admin/clients/${client.id}/toggle`, {
+        method: 'PUT',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ enabled: enable }),
+      });
+      if (!res.ok) throw new Error('Failed to update portal access');
+      setPortalStatus(enable ? 'active' : 'disabled');
+      setPortalMessage({ text: `Portal access ${enable ? 'enabled' : 'disabled'}.`, type: enable ? 'success' : 'warning' });
+    } catch (err) {
+      setPortalMessage({ text: err.message, type: 'error' });
+    } finally {
+      setPortalLoading(false);
+    }
+  };
+
+  const copyInviteUrl = () => {
+    navigator.clipboard.writeText(inviteUrl).then(() => {
+      setPortalMessage({ text: 'Invite link copied to clipboard!', type: 'success' });
+    });
+  };
+
+  const portalStatusDisplay = () => {
+    const map = {
+      not_invited:    { bg: '#f5f5f5', color: '#666',    icon: '○', label: 'Not Invited'    },
+      invite_pending: { bg: '#fef9e7', color: '#d68910', icon: '⏳', label: 'Invite Sent'    },
+      invite_expired: { bg: '#fdf2f2', color: '#c0392b', icon: '⚠️', label: 'Invite Expired' },
+      active:         { bg: '#eafaf1', color: '#1e8449', icon: '✓', label: 'Active'          },
+      disabled:       { bg: '#f0f0f0', color: '#888',    icon: '✕', label: 'Disabled'        },
+    };
+    const s = map[portalStatus] || map.not_invited;
+    return (
+      <span style={{
+        background: s.bg, color: s.color,
+        padding: '4px 12px', borderRadius: '12px',
+        fontSize: '0.82rem', fontWeight: 700,
+      }}>
+        {s.icon} {s.label}
+      </span>
+    );
+  };
+
+  return (
+    <div className="modal active">
+      <div className="modal-content modal-large">
+        <div className="modal-header">
+          <h2>Edit: {client.first_name} {client.last_name}</h2>
+          <button className="close-btn" onClick={onClose}>×</button>
+        </div>
+
+        {message && (
+          <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+            {message}
+          </div>
+        )}
+
+        {/* Tabs */}
+        <div className="tabs" style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', borderBottom: '2px solid #eee', paddingBottom: '0.5rem' }}>
+          {tabs.map(tab => (
+            <button
+              key={tab.id}
+              type="button"
+              className={`btn ${activeTab === tab.id ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setActiveTab(tab.id)}
+              style={{ flex: 1 }}
+            >
+              {tab.label}
+            </button>
+          ))}
+        </div>
+
+        <form onSubmit={handleSave}>
+          
+          {/* Basic Info Tab */}
+          {activeTab === 'basic' && (
+            <div>
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Personal Information</h4>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>First Name *</label>
+                  <input
+                    type="text"
+                    value={formData.firstName}
+                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
+                    required
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Last Name *</label>
+                  <input
+                    type="text"
+                    value={formData.lastName}
+                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
+                    required
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Date of Birth</label>
+                  <input
+                    type="date"
+                    value={formData.dateOfBirth}
+                    onChange={(e) => setFormData({ ...formData, dateOfBirth: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Gender</label>
+                  <select
+                    value={formData.gender}
+                    onChange={(e) => setFormData({ ...formData, gender: e.target.value })}
+                  >
+                    <option value="">Select...</option>
+                    <option value="M">Male</option>
+                    <option value="F">Female</option>
+                    <option value="Other">Other</option>
+                  </select>
+                </div>
+                <div className="form-group">
+                  <label>Phone</label>
+                  <input
+                    type="tel"
+                    value={formData.phone}
+                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Email</label>
+                  <input
+                    type="email"
+                    value={formData.email}
+                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}
+                  />
+                </div>
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Address</h4>
+              <div className="form-grid-2">
+                <div className="form-group" style={{ gridColumn: '1 / -1' }}>
+                  <label>Street Address</label>
+                  <input
+                    type="text"
+                    value={formData.address}
+                    onChange={(e) => setFormData({ ...formData, address: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>City</label>
+                  <input
+                    type="text"
+                    value={formData.city}
+                    onChange={(e) => setFormData({ ...formData, city: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>State</label>
+                  <input
+                    type="text"
+                    value={formData.state}
+                    onChange={(e) => setFormData({ ...formData, state: e.target.value })}
+                    maxLength="2"
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Zip Code</label>
+                  <input
+                    type="text"
+                    value={formData.zip}
+                    onChange={(e) => setFormData({ ...formData, zip: e.target.value })}
+                  />
+                </div>
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Emergency Contact</h4>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Contact Name</label>
+                  <input
+                    type="text"
+                    value={formData.emergencyContactName}
+                    onChange={(e) => setFormData({ ...formData, emergencyContactName: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Phone</label>
+                  <input
+                    type="tel"
+                    value={formData.emergencyContactPhone}
+                    onChange={(e) => setFormData({ ...formData, emergencyContactPhone: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Relationship</label>
+                  <input
+                    type="text"
+                    value={formData.emergencyContactRelationship}
+                    onChange={(e) => setFormData({ ...formData, emergencyContactRelationship: e.target.value })}
+                    placeholder="e.g., Spouse, Son, Daughter"
+                  />
+                </div>
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Notes</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.notes}
+                  onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+                  placeholder="General notes about the client..."
+                  rows="3"
+                />
+              </div>
+            </div>
+          )}
+
+          {/* Billing Tab */}
+          {activeTab === 'billing' && (
+            <div>
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Billing Type</h4>
+              <div className="form-group">
+                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                  <input
+                    type="checkbox"
+                    checked={formData.isPrivatePay}
+                    onChange={(e) => setFormData({ ...formData, isPrivatePay: e.target.checked })}
+                  />
+                  Private Pay (Client pays directly, no referral source)
+                </label>
+              </div>
+
+              {!formData.isPrivatePay ? (
+                <>
+                  <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Referral Information</h4>
+                  <div className="form-grid-2">
+                    <div className="form-group">
+                      <label>Referral Source</label>
+                      <select
+                        value={formData.referralSourceId}
+                        onChange={(e) => setFormData({ ...formData, referralSourceId: e.target.value })}
+                      >
+                        <option value="">Select referral source...</option>
+                        {referralSources.map(rs => (
+                          <option key={rs.id} value={rs.id}>{rs.name}</option>
+                        ))}
+                      </select>
+                    </div>
+                    <div className="form-group">
+                      <label>Care Type</label>
+                      <select
+                        value={formData.careTypeId}
+                        onChange={(e) => setFormData({ ...formData, careTypeId: e.target.value })}
+                      >
+                        <option value="">Select care type...</option>
+                        {careTypes.map(ct => (
+                          <option key={ct.id} value={ct.id}>{ct.name}</option>
+                        ))}
+                      </select>
+                    </div>
+                  </div>
+                  <div className="alert alert-info">
+                    <strong>Rate:</strong> Billing rate is determined by the Referral Source + Care Type combination. 
+                    Manage rates in the Billing Dashboard.
+                  </div>
+                </>
+              ) : (
+                <>
+                  <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Private Pay Rate</h4>
+                  <div className="form-grid-2">
+                    <div className="form-group">
+                      <label>Care Type</label>
+                      <select
+                        value={formData.careTypeId}
+                        onChange={(e) => setFormData({ ...formData, careTypeId: e.target.value })}
+                      >
+                        <option value="">Select care type...</option>
+                        {careTypes.map(ct => (
+                          <option key={ct.id} value={ct.id}>{ct.name}</option>
+                        ))}
+                      </select>
+                    </div>
+                    <div className="form-group">
+                      <label>Rate Type</label>
+                      <select
+                        value={formData.privatePayRateType}
+                        onChange={(e) => setFormData({ ...formData, privatePayRateType: e.target.value })}
+                      >
+                        <option value="hourly">Per Hour</option>
+                        <option value="15min">Per 15 Minutes</option>
+                      </select>
+                    </div>
+                    <div className="form-group">
+                      <label>Rate Amount</label>
+                      <input
+                        type="number"
+                        step="0.01"
+                        min="0"
+                        value={formData.privatePayRate}
+                        onChange={(e) => setFormData({ ...formData, privatePayRate: e.target.value })}
+                        placeholder="e.g., 25.00"
+                      />
+                    </div>
+                  </div>
+                </>
+              )}
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Insurance Information</h4>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Insurance Provider</label>
+                  <input
+                    type="text"
+                    value={formData.insuranceProvider}
+                    onChange={(e) => setFormData({ ...formData, insuranceProvider: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Policy Number</label>
+                  <input
+                    type="text"
+                    value={formData.insuranceId}
+                    onChange={(e) => setFormData({ ...formData, insuranceId: e.target.value })}
+                  />
+                </div>
+                <div className="form-group">
+                  <label>Group Number</label>
+                  <input
+                    type="text"
+                    value={formData.insuranceGroup}
+                    onChange={(e) => setFormData({ ...formData, insuranceGroup: e.target.value })}
+                  />
+                </div>
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Weekly Authorized Units</h4>
+              <div className="form-group">
+                <label>Authorized Units Per Week</label>
+                <input
+                  type="number"
+                  step="1"
+                  min="0"
+                  max="672"
+                  value={formData.weeklyAuthorizedUnits}
+                  onChange={(e) => setFormData({ ...formData, weeklyAuthorizedUnits: e.target.value })}
+                  placeholder="e.g., 80 units"
+                />
+                {formData.weeklyAuthorizedUnits && (
+                  <div style={{ 
+                    marginTop: '0.5rem', 
+                    padding: '0.5rem', 
+                    background: '#E0F2FE', 
+                    borderRadius: '4px',
+                    fontSize: '0.9rem',
+                    color: '#0369A1'
+                  }}>
+                    = <strong>{(parseFloat(formData.weeklyAuthorizedUnits) * 0.25).toFixed(2)} hours</strong> per week
+                  </div>
+                )}
+                <small style={{ color: '#666', display: 'block', marginTop: '0.25rem' }}>
+                  1 unit = 15 minutes. Used to track if client is fully scheduled.
+                </small>
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Billing Notes</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.billingNotes}
+                  onChange={(e) => setFormData({ ...formData, billingNotes: e.target.value })}
+                  placeholder="Any special billing instructions..."
+                  rows="3"
+                />
+              </div>
+            </div>
+          )}
+
+          {/* Medical Tab */}
+          {activeTab === 'medical' && (
+            <div>
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Medical Conditions</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.medicalConditions}
+                  onChange={(e) => setFormData({ ...formData, medicalConditions: e.target.value })}
+                  placeholder="List any medical conditions (diabetes, heart disease, etc.)..."
+                  rows="3"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Medications</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.medications}
+                  onChange={(e) => setFormData({ ...formData, medications: e.target.value })}
+                  placeholder="List current medications and dosages..."
+                  rows="3"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Allergies</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.allergies}
+                  onChange={(e) => setFormData({ ...formData, allergies: e.target.value })}
+                  placeholder="List any allergies (medications, foods, etc.)..."
+                  rows="2"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Mobility & Assistance Needs</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.mobilityAssistanceNeeds}
+                  onChange={(e) => setFormData({ ...formData, mobilityAssistanceNeeds: e.target.value })}
+                  placeholder="Describe mobility limitations, equipment needs (walker, wheelchair), transfer assistance..."
+                  rows="3"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Medical Notes</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.medicalNotes}
+                  onChange={(e) => setFormData({ ...formData, medicalNotes: e.target.value })}
+                  placeholder="Additional medical notes, care instructions, doctor contacts..."
+                  rows="4"
+                />
+              </div>
+            </div>
+          )}
+
+          {/* Caregivers Tab */}
+          {activeTab === 'caregivers' && (
+            <div>
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Care Preferences & Routines</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.carePreferences}
+                  onChange={(e) => setFormData({ ...formData, carePreferences: e.target.value })}
+                  placeholder="Client preferences, daily routines, likes/dislikes, communication style..."
+                  rows="4"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Preferred Caregivers</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.preferredCaregivers}
+                  onChange={(e) => setFormData({ ...formData, preferredCaregivers: e.target.value })}
+                  placeholder="List preferred caregivers or qualities the client prefers..."
+                  rows="3"
+                />
+              </div>
+
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginTop: '1rem', marginBottom: '1rem' }}>Do Not Assign</h4>
+              <div className="form-group">
+                <textarea
+                  value={formData.doNotUseCaregivers}
+                  onChange={(e) => setFormData({ ...formData, doNotUseCaregivers: e.target.value })}
+                  placeholder="List any caregivers who should NOT be assigned to this client..."
+                  rows="3"
+                />
+              </div>
+
+              <div className="alert alert-info">
+                <strong>Note:</strong> Caregiver pay rates are set by care type in Caregiver Management. 
+                When a caregiver works with this client, they'll be paid based on the client's care type.
+              </div>
+            </div>
+          )}
+
+          {/* Portal Tab */}
+          {activeTab === 'portal' && (
+            <div style={{ padding: '0.5rem 0' }}>
+              <h4 style={{ borderBottom: '2px solid #007bff', paddingBottom: '0.5rem', marginBottom: '1.5rem' }}>
+                🌐 Client Portal Access
+              </h4>
+
+              {/* Status row */}
+              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '1.5rem' }}>
+                <span style={{ fontWeight: 600, color: '#444' }}>Status:</span>
+                {portalStatus ? portalStatusDisplay() : (
+                  <span style={{ color: '#aaa', fontSize: '0.85rem' }}>Loading...</span>
+                )}
+              </div>
+
+              {/* Portal message */}
+              {portalMessage.text && (
+                <div className={`alert ${portalMessage.type === 'error' ? 'alert-error' : portalMessage.type === 'warning' ? 'alert-warning' : 'alert-success'}`}
+                  style={{ marginBottom: '1.5rem' }}>
+                  {portalMessage.text}
+                </div>
+              )}
+
+              {/* Invite link display */}
+              {inviteUrl && (
+                <div style={{
+                  background: '#f8f9fa', border: '1px solid #dee2e6',
+                  borderRadius: '8px', padding: '14px 16px', marginBottom: '1.5rem',
+                }}>
+                  <div style={{ fontSize: '0.8rem', color: '#666', marginBottom: '6px', fontWeight: 600 }}>
+                    INVITE LINK (expires in 48 hours)
+                  </div>
+                  <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
+                    <input
+                      type="text"
+                      readOnly
+                      value={inviteUrl}
+                      style={{ flex: 1, fontSize: '0.8rem', background: '#fff', color: '#333' }}
+                      onClick={e => e.target.select()}
+                    />
+                    <button
+                      type="button"
+                      className="btn btn-secondary"
+                      onClick={copyInviteUrl}
+                      style={{ flexShrink: 0 }}
+                    >
+                      📋 Copy
+                    </button>
+                  </div>
+                </div>
+              )}
+
+              {/* Invite form — shown when not yet invited or expired */}
+              {(portalStatus === 'not_invited' || portalStatus === 'invite_expired' || portalStatus === 'invite_pending') && (
+                <div style={{ marginBottom: '1.5rem' }}>
+                  <h5 style={{ marginBottom: '0.75rem', color: '#333' }}>
+                    {portalStatus === 'invite_pending' ? 'Resend Invite' : 'Invite Client to Portal'}
+                  </h5>
+                  <div style={{ display: 'flex', gap: '8px' }}>
+                    <div className="form-group" style={{ flex: 1, margin: 0 }}>
+                      <input
+                        type="email"
+                        value={portalEmail}
+                        onChange={e => setPortalEmail(e.target.value)}
+                        placeholder="client@email.com"
+                      />
+                    </div>
+                    <button
+                      type="button"
+                      className="btn btn-primary"
+                      onClick={handleSendInvite}
+                      disabled={portalLoading}
+                      style={{ flexShrink: 0 }}
+                    >
+                      {portalLoading ? 'Creating...' : '✉️ Create Invite'}
+                    </button>
+                  </div>
+                  <small style={{ color: '#666', marginTop: '6px', display: 'block' }}>
+                    An invite link will be generated. Copy it and send it to the client — they'll set their own password.
+                  </small>
+                </div>
+              )}
+
+              {/* Enable/Disable toggle — shown when portal account exists */}
+              {(portalStatus === 'active' || portalStatus === 'disabled') && (
+                <div style={{
+                  background: '#f8f9fa', borderRadius: '8px',
+                  padding: '16px', marginBottom: '1.5rem',
+                }}>
+                  <div style={{ fontWeight: 600, marginBottom: '8px', color: '#333' }}>
+                    Portal Access Control
+                  </div>
+                  {portalStatus === 'active' ? (
+                    <button
+                      type="button"
+                      className="btn btn-danger"
+                      onClick={() => handleTogglePortal(false)}
+                      disabled={portalLoading}
+                    >
+                      {portalLoading ? 'Updating...' : '🚫 Disable Portal Access'}
+                    </button>
+                  ) : (
+                    <button
+                      type="button"
+                      className="btn btn-primary"
+                      onClick={() => handleTogglePortal(true)}
+                      disabled={portalLoading}
+                    >
+                      {portalLoading ? 'Updating...' : '✓ Re-enable Portal Access'}
+                    </button>
+                  )}
+                </div>
+              )}
+
+              {/* What the client can see */}
+              <div style={{
+                background: '#eaf4fd', borderRadius: '8px',
+                padding: '14px 16px', fontSize: '0.85rem', color: '#1a5276',
+              }}>
+                <div style={{ fontWeight: 700, marginBottom: '8px' }}>What clients see in their portal:</div>
+                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '6px' }}>
+                  {['📅 Upcoming scheduled visits', '🕐 Visit history', '👤 Assigned caregivers', '📄 Invoices & billing', '🔔 Notifications & alerts', '📞 Caregiver contact info'].map(item => (
+                    <div key={item} style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
+                      {item}
+                    </div>
+                  ))}
+                </div>
+              </div>
+            </div>
+          )}
+
+          {/* Actions */}
+          <div className="modal-actions" style={{ marginTop: '1.5rem', borderTop: '1px solid #eee', paddingTop: '1rem' }}>
+            <button type="submit" className="btn btn-primary" disabled={loading}>
+              {loading ? 'Saving...' : 'Save Changes'}
+            </button>
+            <button type="button" className="btn btn-secondary" onClick={onClose} disabled={loading}>
+              Cancel
+            </button>
+            {!deleteConfirm ? (
+              <button
+                type="button"
+                className="btn btn-danger"
+                onClick={handleDelete}
+                disabled={loading}
+                style={{ marginLeft: 'auto' }}
+              >
+                Delete Client
+              </button>
+            ) : (
+              <button
+                type="button"
+                className="btn btn-danger"
+                onClick={handleDelete}
+                disabled={loading}
+                style={{ marginLeft: 'auto', background: '#8B0000' }}
+              >
+                ⚠️ Confirm Delete
+              </button>
+            )}
+          </div>
+        </form>
+      </div>
+    </div>
+  );
+};
+
+export default EditClientModal;
diff --git a/templates/crm-homecare/frontend/src/components/admin/EmergencyCoverage.jsx b/templates/crm-homecare/frontend/src/components/admin/EmergencyCoverage.jsx
new file mode 100644
index 0000000..7f8ef41
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/EmergencyCoverage.jsx
@@ -0,0 +1,284 @@
+// src/components/admin/EmergencyCoverage.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+import { confirm } from '../ConfirmModal';
+
+const EmergencyCoverage = ({ token }) => {
+  const [missReports, setMissReports] = useState([]);
+  const [availableCaregivers, setAvailableCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [searching, setSearching] = useState(false);
+  const [selectedReport, setSelectedReport] = useState(null);
+  const [searchForm, setSearchForm] = useState({
+    date: new Date().toISOString().split('T')[0],
+    startTime: '08:00',
+    endTime: '16:00',
+    clientId: '',
+  });
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [reportsRes, clientsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/emergency/miss-reports`, { headers: { Authorization: `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/clients`, { headers: { Authorization: `Bearer ${token}` } }),
+      ]);
+      const reports = await reportsRes.json();
+      const clientList = await clientsRes.json();
+      setMissReports(Array.isArray(reports) ? reports : []);
+      setClients(Array.isArray(clientList) ? clientList : []);
+    } catch (e) {
+      toast('Failed to load data', 'error');
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const searchCoverage = async (report = null) => {
+    const form = report ? {
+      date: report.date?.split('T')[0] || searchForm.date,
+      startTime: report.start_time || searchForm.startTime,
+      endTime: report.end_time || searchForm.endTime,
+      clientId: report.client_id || searchForm.clientId,
+    } : searchForm;
+
+    setSearching(true);
+    if (report) setSelectedReport(report);
+
+    try {
+      const params = new URLSearchParams({
+        date: form.date,
+        startTime: form.startTime,
+        endTime: form.endTime,
+        ...(form.clientId && { clientId: form.clientId }),
+      });
+      const res = await fetch(`${API_BASE_URL}/api/emergency/available-caregivers?${params}`, {
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setAvailableCaregivers(Array.isArray(data) ? data : []);
+    } catch (e) {
+      toast('Failed to search for available caregivers', 'error');
+    } finally {
+      setSearching(false);
+    }
+  };
+
+  const assignCoverage = async (caregiver) => {
+    const ok = await confirm(
+      `Assign ${caregiver.first_name} ${caregiver.last_name} as emergency coverage?`,
+      { confirmLabel: 'Assign', danger: false }
+    );
+    if (!ok) return;
+
+    try {
+      const form = selectedReport ? {
+        date: selectedReport.date?.split('T')[0] || searchForm.date,
+        startTime: selectedReport.start_time || searchForm.startTime,
+        endTime: selectedReport.end_time || searchForm.endTime,
+        clientId: selectedReport.client_id || searchForm.clientId,
+      } : searchForm;
+
+      await fetch(`${API_BASE_URL}/api/emergency/assign-coverage`, {
+        method: 'POST',
+        headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
+        body: JSON.stringify({
+          absenceId: selectedReport?.id,
+          caregiverId: caregiver.id,
+          ...form,
+        }),
+      });
+      toast(`Coverage assigned to ${caregiver.first_name} ${caregiver.last_name}. They have been notified.`, 'success');
+      loadData();
+      setAvailableCaregivers([]);
+      setSelectedReport(null);
+    } catch (e) {
+      toast('Failed to assign coverage', 'error');
+    }
+  };
+
+  const statusBadge = (hours) => {
+    if (hours > 35) return { color: '#DC2626', label: 'Near Overtime' };
+    if (hours > 25) return { color: '#D97706', label: 'Moderate Hours' };
+    return { color: '#16A34A', label: 'Available' };
+  };
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '3rem', color: '#6B7280' }}>Loading...</div>;
+
+  return (
+    <div>
+      <div style={{ marginBottom: '1.5rem' }}>
+        <h2 style={{ margin: 0, fontSize: '1.25rem', color: '#111827' }}>🚨 Emergency Coverage</h2>
+        <p style={{ margin: '0.25rem 0 0 0', color: '#6B7280', fontSize: '0.9rem' }}>
+          Find available caregivers to cover uncovered shifts
+        </p>
+      </div>
+
+      {/* Pending Miss Reports */}
+      {missReports.length > 0 && (
+        <div className="card" style={{ marginBottom: '1.5rem', border: '1px solid #FCA5A5' }}>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '1rem' }}>
+            <span style={{ fontSize: '1.2rem' }}>🔴</span>
+            <h3 style={{ margin: 0, fontSize: '1rem', color: '#991B1B' }}>
+              {missReports.length} Shift{missReports.length !== 1 ? 's' : ''} Need Coverage
+            </h3>
+          </div>
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+            {missReports.map(report => (
+              <div key={report.id} style={{
+                padding: '0.875rem', background: '#FEF2F2', borderRadius: '8px',
+                border: '1px solid #FCA5A5', display: 'flex', justifyContent: 'space-between',
+                alignItems: 'center', flexWrap: 'wrap', gap: '0.75rem'
+              }}>
+                <div>
+                  <div style={{ fontWeight: '700', color: '#111827' }}>
+                    {report.first_name} {report.last_name} — Called Out
+                  </div>
+                  <div style={{ fontSize: '0.85rem', color: '#6B7280', marginTop: '0.25rem' }}>
+                    📅 {new Date(report.date).toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}
+                    {report.start_time && ` • ${report.start_time} – ${report.end_time}`}
+                    {report.client_name && ` • Client: ${report.client_name}`}
+                  </div>
+                  <div style={{ fontSize: '0.82rem', color: '#B91C1C', marginTop: '0.2rem' }}>
+                    Reason: {report.reason || 'No reason provided'}
+                  </div>
+                </div>
+                <button
+                  onClick={() => searchCoverage(report)}
+                  style={{
+                    padding: '0.5rem 1rem', background: '#DC2626', color: '#fff',
+                    border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', fontSize: '0.85rem'
+                  }}
+                >
+                  Find Coverage
+                </button>
+              </div>
+            ))}
+          </div>
+        </div>
+      )}
+
+      {/* Manual Search */}
+      <div className="card" style={{ marginBottom: '1.5rem' }}>
+        <h3 style={{ margin: '0 0 1rem 0', fontSize: '1rem', color: '#374151' }}>🔍 Find Available Caregivers</h3>
+        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '0.75rem', marginBottom: '1rem' }}>
+          <div>
+            <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: '600', color: '#374151', marginBottom: '0.3rem' }}>Date *</label>
+            <input type="date" value={searchForm.date}
+              onChange={e => setSearchForm(p => ({ ...p, date: e.target.value }))}
+              style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }} />
+          </div>
+          <div>
+            <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: '600', color: '#374151', marginBottom: '0.3rem' }}>Start Time *</label>
+            <input type="time" value={searchForm.startTime}
+              onChange={e => setSearchForm(p => ({ ...p, startTime: e.target.value }))}
+              style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }} />
+          </div>
+          <div>
+            <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: '600', color: '#374151', marginBottom: '0.3rem' }}>End Time *</label>
+            <input type="time" value={searchForm.endTime}
+              onChange={e => setSearchForm(p => ({ ...p, endTime: e.target.value }))}
+              style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }} />
+          </div>
+          <div>
+            <label style={{ display: 'block', fontSize: '0.82rem', fontWeight: '600', color: '#374151', marginBottom: '0.3rem' }}>Client (optional)</label>
+            <select value={searchForm.clientId}
+              onChange={e => setSearchForm(p => ({ ...p, clientId: e.target.value }))}
+              style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.9rem' }}>
+              <option value="">Any client</option>
+              {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+            </select>
+          </div>
+        </div>
+        <button
+          onClick={() => searchCoverage()}
+          disabled={searching}
+          style={{
+            padding: '0.6rem 1.5rem', background: '#2ABBA7', color: '#fff',
+            border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', fontSize: '0.9rem',
+            opacity: searching ? 0.7 : 1
+          }}
+        >
+          {searching ? 'Searching...' : '🔍 Search Available Caregivers'}
+        </button>
+      </div>
+
+      {/* Results */}
+      {availableCaregivers.length > 0 && (
+        <div className="card">
+          <h3 style={{ margin: '0 0 1rem 0', fontSize: '1rem', color: '#374151' }}>
+            ✅ {availableCaregivers.length} Caregiver{availableCaregivers.length !== 1 ? 's' : ''} Available
+            {selectedReport && <span style={{ fontWeight: '400', color: '#6B7280' }}> for {new Date(selectedReport.date).toLocaleDateString()}</span>}
+          </h3>
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+            {availableCaregivers.map(cg => {
+              const sb = statusBadge(parseFloat(cg.scheduled_hours_this_week) || 0);
+              return (
+                <div key={cg.id} style={{
+                  padding: '0.875rem', background: '#F9FAFB', borderRadius: '8px',
+                  border: '1px solid #E5E7EB', display: 'flex', justifyContent: 'space-between',
+                  alignItems: 'center', flexWrap: 'wrap', gap: '0.75rem'
+                }}>
+                  <div>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.25rem' }}>
+                      <span style={{ fontWeight: '700', color: '#111827', fontSize: '0.95rem' }}>
+                        {cg.first_name} {cg.last_name}
+                      </span>
+                      {cg.is_preferred && (
+                        <span style={{ padding: '0.1rem 0.4rem', background: '#FEF3C7', color: '#92400E', borderRadius: '4px', fontSize: '0.72rem', fontWeight: '600' }}>
+                          ⭐ Preferred
+                        </span>
+                      )}
+                      <span style={{ padding: '0.1rem 0.4rem', background: '#F0FDF4', color: sb.color, borderRadius: '4px', fontSize: '0.72rem', fontWeight: '600', border: `1px solid ${sb.color}20` }}>
+                        {sb.label}
+                      </span>
+                    </div>
+                    <div style={{ fontSize: '0.82rem', color: '#6B7280', display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+                      {cg.phone && <span>📞 {cg.phone}</span>}
+                      <span>📊 {parseFloat(cg.scheduled_hours_this_week || 0).toFixed(2)}h this week</span>
+                      {parseFloat(cg.avg_rating) > 0 && <span>⭐ {cg.avg_rating} avg rating</span>}
+                      {cg.certifications?.length > 0 && <span>🎓 {cg.certifications.join(', ')}</span>}
+                    </div>
+                  </div>
+                  <div style={{ display: 'flex', gap: '0.5rem' }}>
+                    {cg.phone && (
+                      <a href={`tel:${cg.phone}`} style={{
+                        padding: '0.5rem 0.875rem', background: '#fff', color: '#374151',
+                        border: '1px solid #D1D5DB', borderRadius: '8px', cursor: 'pointer',
+                        fontWeight: '500', fontSize: '0.85rem', textDecoration: 'none'
+                      }}>📞 Call</a>
+                    )}
+                    <button
+                      onClick={() => assignCoverage(cg)}
+                      style={{
+                        padding: '0.5rem 0.875rem', background: '#2ABBA7', color: '#fff',
+                        border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: '600', fontSize: '0.85rem'
+                      }}
+                    >
+                      Assign Coverage
+                    </button>
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        </div>
+      )}
+
+      {!searching && availableCaregivers.length === 0 && missReports.length === 0 && (
+        <div className="card" style={{ padding: '2rem', textAlign: 'center', color: '#6B7280' }}>
+          <div style={{ fontSize: '2.5rem', marginBottom: '0.75rem' }}>✅</div>
+          <p style={{ fontWeight: '600', color: '#374151' }}>No coverage issues reported</p>
+          <p style={{ fontSize: '0.85rem' }}>Use the search above to find available caregivers for a specific shift.</p>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default EmergencyCoverage;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ExpenseManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/ExpenseManagement.jsx
new file mode 100644
index 0000000..afe9580
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ExpenseManagement.jsx
@@ -0,0 +1,549 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/ExpenseManagement.jsx
+// Complete expense tracking: Categories, Filtering, Reports, Receipt Management, Budgets
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ExpenseManagement = ({ token }) => {
+  const [expenses, setExpenses] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showForm, setShowForm] = useState(false);
+  const [showBudgetModal, setShowBudgetModal] = useState(false);
+  const [editingExpense, setEditingExpense] = useState(null);
+  const [message, setMessage] = useState('');
+  
+  // Filters
+  const [dateRange, setDateRange] = useState({
+    startDate: new Date(new Date().getFullYear(), new Date().getMonth(), 1).toISOString().split('T')[0],
+    endDate: new Date().toISOString().split('T')[0]
+  });
+  const [categoryFilter, setCategoryFilter] = useState('all');
+  const [searchTerm, setSearchTerm] = useState('');
+
+  // Budget tracking
+  const [budgets, setBudgets] = useState({
+    equipment: 5000,
+    supplies: 2000,
+    utilities: 1500,
+    maintenance: 1000,
+    training: 3000,
+    marketing: 1500,
+    office: 1000,
+    travel: 2000,
+    insurance: 5000,
+    other: 1000
+  });
+
+  const [formData, setFormData] = useState({
+    expenseDate: new Date().toISOString().split('T')[0],
+    category: 'supplies',
+    vendor: '',
+    description: '',
+    amount: '',
+    paymentMethod: 'credit_card',
+    reimbursable: false,
+    reimbursedTo: '',
+    taxDeductible: true,
+    notes: '',
+    receiptUrl: ''
+  });
+
+  const categories = [
+    { id: 'equipment', label: 'Equipment', icon: '🖥️', color: '#3498db' },
+    { id: 'supplies', label: 'Supplies', icon: '📦', color: '#9b59b6' },
+    { id: 'utilities', label: 'Utilities', icon: '💡', color: '#f39c12' },
+    { id: 'maintenance', label: 'Maintenance', icon: '🔧', color: '#95a5a6' },
+    { id: 'training', label: 'Training', icon: '📚', color: '#27ae60' },
+    { id: 'marketing', label: 'Marketing', icon: '📣', color: '#e74c3c' },
+    { id: 'office', label: 'Office', icon: '🏢', color: '#1abc9c' },
+    { id: 'travel', label: 'Travel', icon: '✈️', color: '#e67e22' },
+    { id: 'insurance', label: 'Insurance', icon: '🛡️', color: '#2c3e50' },
+    { id: 'payroll', label: 'Payroll Tax', icon: '💰', color: '#16a085' },
+    { id: 'professional', label: 'Professional Services', icon: '👔', color: '#8e44ad' },
+    { id: 'other', label: 'Other', icon: '📋', color: '#7f8c8d' }
+  ];
+
+  const paymentMethods = [
+    { id: 'cash', label: '💵 Cash' },
+    { id: 'check', label: '🏦 Check' },
+    { id: 'credit_card', label: '💳 Credit Card' },
+    { id: 'debit_card', label: '💳 Debit Card' },
+    { id: 'bank_transfer', label: '🏦 Bank Transfer' },
+    { id: 'paypal', label: '📱 PayPal' },
+    { id: 'other', label: '📋 Other' }
+  ];
+
+  useEffect(() => {
+    loadExpenses();
+  }, [dateRange]);
+
+  const loadExpenses = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/expenses?startDate=${dateRange.startDate}&endDate=${dateRange.endDate}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      setExpenses(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load expenses:', error);
+      setExpenses([]);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    try {
+      const url = editingExpense 
+        ? `${API_BASE_URL}/api/expenses/${editingExpense.id}`
+        : `${API_BASE_URL}/api/expenses`;
+      
+      const response = await fetch(url, {
+        method: editingExpense ? 'PUT' : 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ ...formData, amount: parseFloat(formData.amount) })
+      });
+
+      if (!response.ok) throw new Error('Failed to save expense');
+
+      resetForm();
+      loadExpenses();
+      setMessage(editingExpense ? '✓ Expense updated' : '✓ Expense recorded');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleEdit = (expense) => {
+    setEditingExpense(expense);
+    setFormData({
+      expenseDate: expense.expense_date?.split('T')[0] || '',
+      category: expense.category || 'other',
+      vendor: expense.vendor || '',
+      description: expense.description || '',
+      amount: expense.amount?.toString() || '',
+      paymentMethod: expense.payment_method || 'credit_card',
+      reimbursable: expense.reimbursable || false,
+      reimbursedTo: expense.reimbursed_to || '',
+      taxDeductible: expense.tax_deductible !== false,
+      notes: expense.notes || '',
+      receiptUrl: expense.receipt_url || ''
+    });
+    setShowForm(true);
+  };
+
+  const handleDelete = async (expenseId) => {
+    const _cok = await confirm('Delete this expense?', {danger: true}); if (!_cok) return;
+    try {
+      await fetch(`${API_BASE_URL}/api/expenses/${expenseId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      loadExpenses();
+      setMessage('✓ Expense deleted');
+      setTimeout(() => setMessage(''), 2000);
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const resetForm = () => {
+    setFormData({
+      expenseDate: new Date().toISOString().split('T')[0],
+      category: 'supplies',
+      vendor: '',
+      description: '',
+      amount: '',
+      paymentMethod: 'credit_card',
+      reimbursable: false,
+      reimbursedTo: '',
+      taxDeductible: true,
+      notes: '',
+      receiptUrl: ''
+    });
+    setEditingExpense(null);
+    setShowForm(false);
+  };
+
+  const handleExportCSV = () => {
+    const headers = ['Date', 'Category', 'Vendor', 'Description', 'Amount', 'Payment Method', 'Tax Deductible', 'Notes'];
+    const rows = filteredExpenses.map(e => [
+      e.expense_date?.split('T')[0],
+      e.category,
+      e.vendor || '',
+      e.description || '',
+      e.amount,
+      e.payment_method,
+      e.tax_deductible ? 'Yes' : 'No',
+      e.notes || ''
+    ]);
+    
+    const csv = [headers.join(','), ...rows.map(r => r.map(cell => `"${cell}"`).join(','))].join('\n');
+    const blob = new Blob([csv], { type: 'text/csv' });
+    const url = window.URL.createObjectURL(blob);
+    const a = document.createElement('a');
+    a.href = url;
+    a.download = `expenses-${dateRange.startDate}-to-${dateRange.endDate}.csv`;
+    a.click();
+  };
+
+  // Filter expenses
+  const filteredExpenses = expenses.filter(expense => {
+    const matchesCategory = categoryFilter === 'all' || expense.category === categoryFilter;
+    const matchesSearch = !searchTerm || 
+      expense.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      expense.vendor?.toLowerCase().includes(searchTerm.toLowerCase()) ||
+      expense.notes?.toLowerCase().includes(searchTerm.toLowerCase());
+    return matchesCategory && matchesSearch;
+  });
+
+  // Calculate totals
+  const calculateTotals = () => {
+    const byCategory = {};
+    categories.forEach(c => { byCategory[c.id] = 0; });
+    
+    let total = 0;
+    let taxDeductible = 0;
+    let reimbursable = 0;
+
+    filteredExpenses.forEach(expense => {
+      const amount = parseFloat(expense.amount) || 0;
+      total += amount;
+      if (expense.category) byCategory[expense.category] = (byCategory[expense.category] || 0) + amount;
+      if (expense.tax_deductible) taxDeductible += amount;
+      if (expense.reimbursable) reimbursable += amount;
+    });
+
+    return { total, byCategory, taxDeductible, reimbursable };
+  };
+
+  const totals = calculateTotals();
+
+  const getCategoryInfo = (categoryId) => {
+    return categories.find(c => c.id === categoryId) || { label: categoryId, icon: '📋', color: '#999' };
+  };
+
+  const getPaymentMethodLabel = (methodId) => {
+    const method = paymentMethods.find(m => m.id === methodId);
+    return method ? method.label : methodId;
+  };
+
+  const formatCurrency = (amount) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount || 0);
+
+  const getBudgetStatus = (category, spent) => {
+    const budget = budgets[category] || 0;
+    if (budget === 0) return { percentage: 0, status: 'none' };
+    const percentage = (spent / budget) * 100;
+    return {
+      percentage,
+      status: percentage >= 100 ? 'over' : percentage >= 80 ? 'warning' : 'good'
+    };
+  };
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>💰 Expense Management</h2>
+        <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+          <button className="btn btn-primary" onClick={() => { resetForm(); setShowForm(!showForm); }}>
+            {showForm ? '✕ Cancel' : '➕ Add Expense'}
+          </button>
+          <button className="btn btn-secondary" onClick={() => setShowBudgetModal(true)}>📊 Budgets</button>
+          <button className="btn btn-secondary" onClick={handleExportCSV}>📥 Export CSV</button>
+        </div>
+      </div>
+
+      {message && <div className="alert alert-success">{message}</div>}
+
+      {/* Summary Cards */}
+      <div className="grid">
+        <div className="stat-card">
+          <h3>Total Expenses</h3>
+          <div className="value" style={{ color: '#dc3545' }}>{formatCurrency(totals.total)}</div>
+          <div className="stat-subtext">{filteredExpenses.length} transactions</div>
+        </div>
+        <div className="stat-card">
+          <h3>Tax Deductible</h3>
+          <div className="value" style={{ color: '#28a745' }}>{formatCurrency(totals.taxDeductible)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Reimbursable</h3>
+          <div className="value" style={{ color: '#17a2b8' }}>{formatCurrency(totals.reimbursable)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Avg per Transaction</h3>
+          <div className="value">{formatCurrency(filteredExpenses.length > 0 ? totals.total / filteredExpenses.length : 0)}</div>
+        </div>
+      </div>
+
+      {/* Category Breakdown */}
+      <div className="card">
+        <h3>Spending by Category</h3>
+        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '1rem', marginTop: '1rem' }}>
+          {categories.filter(c => totals.byCategory[c.id] > 0).map(category => {
+            const spent = totals.byCategory[category.id];
+            const budget = getBudgetStatus(category.id, spent);
+            return (
+              <div key={category.id} style={{ padding: '1rem', background: '#f9f9f9', borderRadius: '8px', borderLeft: `4px solid ${category.color}` }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                  <span>{category.icon} {category.label}</span>
+                  <strong>{formatCurrency(spent)}</strong>
+                </div>
+                {budgets[category.id] > 0 && (
+                  <div style={{ marginTop: '0.5rem' }}>
+                    <div style={{ height: '6px', background: '#e0e0e0', borderRadius: '3px', overflow: 'hidden' }}>
+                      <div style={{ 
+                        width: `${Math.min(budget.percentage, 100)}%`, 
+                        height: '100%', 
+                        background: budget.status === 'over' ? '#dc3545' : budget.status === 'warning' ? '#ffc107' : '#28a745',
+                        transition: 'width 0.3s'
+                      }} />
+                    </div>
+                    <small className="text-muted">{budget.percentage.toFixed(0)}% of {formatCurrency(budgets[category.id])} budget</small>
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      </div>
+
+      {/* Expense Form */}
+      {showForm && (
+        <div className="card card-form">
+          <h3>{editingExpense ? 'Edit Expense' : 'Record New Expense'}</h3>
+          <form onSubmit={handleSubmit}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Date *</label>
+                <input type="date" value={formData.expenseDate} onChange={(e) => setFormData({ ...formData, expenseDate: e.target.value })} required />
+              </div>
+              <div className="form-group">
+                <label>Category *</label>
+                <select value={formData.category} onChange={(e) => setFormData({ ...formData, category: e.target.value })} required>
+                  {categories.map(c => <option key={c.id} value={c.id}>{c.icon} {c.label}</option>)}
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Amount *</label>
+                <input type="number" step="0.01" min="0" value={formData.amount} onChange={(e) => setFormData({ ...formData, amount: e.target.value })} placeholder="0.00" required />
+              </div>
+              <div className="form-group">
+                <label>Payment Method</label>
+                <select value={formData.paymentMethod} onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}>
+                  {paymentMethods.map(m => <option key={m.id} value={m.id}>{m.label}</option>)}
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Vendor</label>
+                <input type="text" value={formData.vendor} onChange={(e) => setFormData({ ...formData, vendor: e.target.value })} placeholder="e.g., Amazon, Office Depot" />
+              </div>
+              <div className="form-group">
+                <label>Description</label>
+                <input type="text" value={formData.description} onChange={(e) => setFormData({ ...formData, description: e.target.value })} placeholder="What was purchased?" />
+              </div>
+            </div>
+            
+            <div className="form-grid-2" style={{ marginTop: '1rem' }}>
+              <div className="form-group">
+                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                  <input type="checkbox" checked={formData.taxDeductible} onChange={(e) => setFormData({ ...formData, taxDeductible: e.target.checked })} />
+                  Tax Deductible
+                </label>
+              </div>
+              <div className="form-group">
+                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                  <input type="checkbox" checked={formData.reimbursable} onChange={(e) => setFormData({ ...formData, reimbursable: e.target.checked })} />
+                  Reimbursable
+                </label>
+              </div>
+            </div>
+
+            {formData.reimbursable && (
+              <div className="form-group">
+                <label>Reimburse To</label>
+                <input type="text" value={formData.reimbursedTo} onChange={(e) => setFormData({ ...formData, reimbursedTo: e.target.value })} placeholder="Employee name" />
+              </div>
+            )}
+
+            <div className="form-group">
+              <label>Notes</label>
+              <textarea value={formData.notes} onChange={(e) => setFormData({ ...formData, notes: e.target.value })} rows="2" placeholder="Additional details..." />
+            </div>
+
+            <div className="form-group">
+              <label>Receipt URL</label>
+              <input type="url" value={formData.receiptUrl} onChange={(e) => setFormData({ ...formData, receiptUrl: e.target.value })} placeholder="https://..." />
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">{editingExpense ? 'Update' : 'Record'} Expense</button>
+              <button type="button" className="btn btn-secondary" onClick={resetForm}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Filters */}
+      <div className="card">
+        <div className="filter-controls">
+          <div className="form-group" style={{ marginBottom: 0 }}>
+            <label>Start Date</label>
+            <input type="date" value={dateRange.startDate} onChange={(e) => setDateRange({ ...dateRange, startDate: e.target.value })} />
+          </div>
+          <div className="form-group" style={{ marginBottom: 0 }}>
+            <label>End Date</label>
+            <input type="date" value={dateRange.endDate} onChange={(e) => setDateRange({ ...dateRange, endDate: e.target.value })} />
+          </div>
+          <div className="form-group" style={{ marginBottom: 0 }}>
+            <label>Category</label>
+            <select value={categoryFilter} onChange={(e) => setCategoryFilter(e.target.value)}>
+              <option value="all">All Categories</option>
+              {categories.map(c => <option key={c.id} value={c.id}>{c.icon} {c.label}</option>)}
+            </select>
+          </div>
+          <div className="form-group" style={{ marginBottom: 0, flex: 1 }}>
+            <label>Search</label>
+            <input type="text" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} placeholder="Search description, vendor..." />
+          </div>
+        </div>
+      </div>
+
+      {/* Expenses Table */}
+      {filteredExpenses.length === 0 ? (
+        <div className="card card-centered">
+          <p>No expenses found for the selected filters.</p>
+        </div>
+      ) : (
+        <table className="table">
+          <thead>
+            <tr>
+              <th>Date</th>
+              <th>Category</th>
+              <th>Vendor</th>
+              <th>Description</th>
+              <th>Amount</th>
+              <th>Payment</th>
+              <th>Tax Ded.</th>
+              <th>Actions</th>
+            </tr>
+          </thead>
+          <tbody>
+            {filteredExpenses.map(expense => {
+              const categoryInfo = getCategoryInfo(expense.category);
+              return (
+                <tr key={expense.id}>
+                  <td>{new Date(expense.expense_date).toLocaleDateString()}</td>
+                  <td>
+                    <span style={{ 
+                      display: 'inline-flex', 
+                      alignItems: 'center', 
+                      gap: '0.25rem',
+                      padding: '0.25rem 0.5rem',
+                      background: categoryInfo.color + '20',
+                      borderRadius: '4px',
+                      fontSize: '0.85rem'
+                    }}>
+                      {categoryInfo.icon} {categoryInfo.label}
+                    </span>
+                  </td>
+                  <td>{expense.vendor || '-'}</td>
+                  <td>{expense.description || '-'}</td>
+                  <td><strong style={{ color: '#dc3545' }}>{formatCurrency(expense.amount)}</strong></td>
+                  <td>{getPaymentMethodLabel(expense.payment_method)}</td>
+                  <td>{expense.tax_deductible ? <span className="badge badge-success">Yes</span> : <span className="badge badge-secondary">No</span>}</td>
+                  <td>
+                    <div style={{ display: 'flex', gap: '0.25rem' }}>
+                      <button className="btn btn-sm btn-secondary" onClick={() => handleEdit(expense)}>Edit</button>
+                      <button className="btn btn-sm btn-danger" onClick={() => handleDelete(expense.id)}>Delete</button>
+                      {expense.receipt_url && (
+                        <a href={expense.receipt_url} target="_blank" rel="noopener noreferrer" className="btn btn-sm btn-primary">📎</a>
+                      )}
+                    </div>
+                  </td>
+                </tr>
+              );
+            })}
+          </tbody>
+          <tfoot>
+            <tr style={{ background: '#f5f5f5', fontWeight: 'bold' }}>
+              <td colSpan="4" style={{ textAlign: 'right' }}>Total:</td>
+              <td style={{ color: '#dc3545' }}>{formatCurrency(totals.total)}</td>
+              <td colSpan="3"></td>
+            </tr>
+          </tfoot>
+        </table>
+      )}
+
+      {/* Budget Modal */}
+      {showBudgetModal && (
+        <div className="modal active">
+          <div className="modal-content modal-large">
+            <div className="modal-header">
+              <h2>📊 Monthly Budgets</h2>
+              <button className="close-btn" onClick={() => setShowBudgetModal(false)}>×</button>
+            </div>
+            
+            <p className="text-muted">Set monthly budget limits for each category to track spending.</p>
+            
+            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(250px, 1fr))', gap: '1rem', marginTop: '1rem' }}>
+              {categories.map(category => {
+                const spent = totals.byCategory[category.id] || 0;
+                const budget = budgets[category.id] || 0;
+                const status = getBudgetStatus(category.id, spent);
+                
+                return (
+                  <div key={category.id} style={{ padding: '1rem', border: '1px solid #e0e0e0', borderRadius: '8px' }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>
+                      <span style={{ fontWeight: 'bold' }}>{category.icon} {category.label}</span>
+                      <span style={{ color: status.status === 'over' ? '#dc3545' : status.status === 'warning' ? '#ffc107' : '#28a745' }}>
+                        {formatCurrency(spent)} spent
+                      </span>
+                    </div>
+                    <div className="form-group" style={{ marginBottom: 0 }}>
+                      <label style={{ fontSize: '0.85rem' }}>Monthly Budget</label>
+                      <input 
+                        type="number" 
+                        step="100" 
+                        min="0" 
+                        value={budgets[category.id] || ''} 
+                        onChange={(e) => setBudgets({ ...budgets, [category.id]: parseFloat(e.target.value) || 0 })}
+                        placeholder="0.00"
+                      />
+                    </div>
+                    {budget > 0 && (
+                      <div style={{ marginTop: '0.5rem' }}>
+                        <div style={{ height: '8px', background: '#e0e0e0', borderRadius: '4px', overflow: 'hidden' }}>
+                          <div style={{ 
+                            width: `${Math.min(status.percentage, 100)}%`, 
+                            height: '100%', 
+                            background: status.status === 'over' ? '#dc3545' : status.status === 'warning' ? '#ffc107' : '#28a745'
+                          }} />
+                        </div>
+                        <small style={{ color: status.status === 'over' ? '#dc3545' : '#666' }}>
+                          {status.percentage.toFixed(0)}% used ({formatCurrency(budget - spent)} remaining)
+                        </small>
+                      </div>
+                    )}
+                  </div>
+                );
+              })}
+            </div>
+
+            <div className="modal-actions">
+              <button className="btn btn-primary" onClick={() => setShowBudgetModal(false)}>Save Budgets</button>
+              <button className="btn btn-secondary" onClick={() => setShowBudgetModal(false)}>Close</button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ExpenseManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/FamilyPortalAdmin.jsx b/templates/crm-homecare/frontend/src/components/admin/FamilyPortalAdmin.jsx
new file mode 100644
index 0000000..c7cc895
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/FamilyPortalAdmin.jsx
@@ -0,0 +1,647 @@
+import { toast } from '../Toast';
+// src/components/admin/FamilyPortalAdmin.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const FamilyPortalAdmin = ({ token }) => {
+  const [familyMembers, setFamilyMembers] = useState([]);
+  const [messages, setMessages] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [activeTab, setActiveTab] = useState('members');
+  const [filter, setFilter] = useState({ status: '', clientId: '' });
+  const [showAddModal, setShowAddModal] = useState(false);
+  const [showMessageModal, setShowMessageModal] = useState(false);
+  const [selectedMember, setSelectedMember] = useState(null);
+  const [clients, setClients] = useState([]);
+
+  useEffect(() => {
+    loadFamilyMembers();
+    loadClients();
+  }, [filter]);
+
+  useEffect(() => {
+    if (activeTab === 'messages') {
+      loadMessages();
+    }
+  }, [activeTab]);
+
+  const loadFamilyMembers = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.status) params.append('status', filter.status);
+      if (filter.clientId) params.append('clientId', filter.clientId);
+      
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/members?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setFamilyMembers(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load family members:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const loadMessages = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/messages`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setMessages(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load messages:', error);
+    }
+  };
+
+  const createFamilyMember = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/members`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowAddModal(false);
+        loadFamilyMembers();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const updateMemberStatus = async (memberId, isActive) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/members/${memberId}/status`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ isActive })
+      });
+      if (res.ok) {
+        loadFamilyMembers();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const resetPassword = async (memberId) => {
+    const newPassword = prompt('Enter new password (min 8 characters):');
+    if (!newPassword || newPassword.length < 8) {
+      toast('Password must be at least 8 characters');
+      return;
+    }
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/members/${memberId}/reset-password`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ password: newPassword })
+      });
+      if (res.ok) {
+        toast('Password reset successfully');
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const replyToMessage = async (messageId, reply) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/family-portal/admin/messages/${messageId}/reply`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ reply })
+      });
+      if (res.ok) {
+        setShowMessageModal(false);
+        loadMessages();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getStatusBadge = (isActive) => (
+    <span style={{
+      padding: '2px 6px',
+      borderRadius: '4px',
+      fontSize: '0.75rem',
+      fontWeight: 'bold',
+      color: 'white',
+      backgroundColor: isActive ? '#4caf50' : '#9e9e9e'
+    }}>
+      {isActive ? 'ACTIVE' : 'INACTIVE'}
+    </span>
+  );
+
+  const getRelationshipBadge = (relationship) => {
+    const colors = {
+      spouse: '#e91e63',
+      child: '#2196f3',
+      parent: '#9c27b0',
+      sibling: '#00bcd4',
+      guardian: '#ff9800',
+      other: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[relationship] || '#9e9e9e'
+      }}>
+        {relationship?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const activeCount = familyMembers.filter(m => m.is_active).length;
+  const unreadMessages = messages.filter(m => !m.is_read).length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>👨‍👩‍👧 Family Portal Management</h2>
+        <button className="btn btn-primary" onClick={() => setShowAddModal(true)}>
+          + Add Family Member
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div className="stat-card">
+          <h4>Total Members</h4>
+          <div className="value">{familyMembers.length}</div>
+        </div>
+        <div className="stat-card">
+          <h4>Active</h4>
+          <div className="value" style={{ color: '#4caf50' }}>{activeCount}</div>
+        </div>
+        <div className="stat-card" onClick={() => setActiveTab('messages')} style={{ cursor: 'pointer' }}>
+          <h4>Unread Messages</h4>
+          <div className="value" style={{ color: unreadMessages > 0 ? '#f44336' : '#333' }}>
+            {unreadMessages}
+          </div>
+        </div>
+      </div>
+
+      {/* Tabs */}
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+        <button 
+          className={`btn ${activeTab === 'members' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setActiveTab('members')}
+        >
+          Family Members ({familyMembers.length})
+        </button>
+        <button 
+          className={`btn ${activeTab === 'messages' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setActiveTab('messages')}
+        >
+          Messages {unreadMessages > 0 && `(${unreadMessages} new)`}
+        </button>
+      </div>
+
+      {/* Members Tab */}
+      {activeTab === 'members' && (
+        <>
+          {/* Filters */}
+          <div className="card" style={{ marginBottom: '1rem' }}>
+            <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>Status</label>
+                <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+                  <option value="">All</option>
+                  <option value="active">Active</option>
+                  <option value="inactive">Inactive</option>
+                </select>
+              </div>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>Client</label>
+                <select value={filter.clientId} onChange={(e) => setFilter({ ...filter, clientId: e.target.value })}>
+                  <option value="">All Clients</option>
+                  {clients.map(c => (
+                    <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+                  ))}
+                </select>
+              </div>
+            </div>
+          </div>
+
+          {/* Members Table */}
+          <div className="card">
+            {loading ? (
+              <div className="loading"><div className="spinner"></div></div>
+            ) : familyMembers.length === 0 ? (
+              <p>No family members found. Add family members to give them portal access.</p>
+            ) : (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Name</th>
+                    <th>Email</th>
+                    <th>Phone</th>
+                    <th>Client</th>
+                    <th>Relationship</th>
+                    <th>Status</th>
+                    <th>Last Login</th>
+                    <th>Actions</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {familyMembers.map(member => (
+                    <tr key={member.id}>
+                      <td><strong>{member.first_name} {member.last_name}</strong></td>
+                      <td>{member.email}</td>
+                      <td>{member.phone || '-'}</td>
+                      <td>{member.client_first_name} {member.client_last_name}</td>
+                      <td>{getRelationshipBadge(member.relationship)}</td>
+                      <td>{getStatusBadge(member.is_active)}</td>
+                      <td style={{ fontSize: '0.85rem' }}>
+                        {member.last_login ? new Date(member.last_login).toLocaleString() : 'Never'}
+                      </td>
+                      <td>
+                        <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap' }}>
+                          <button 
+                            className="btn btn-sm btn-secondary"
+                            onClick={() => resetPassword(member.id)}
+                            title="Reset Password"
+                          >
+                            🔑
+                          </button>
+                          {member.is_active ? (
+                            <button 
+                              className="btn btn-sm btn-danger"
+                              onClick={() => updateMemberStatus(member.id, false)}
+                              title="Deactivate"
+                            >
+                              ✗
+                            </button>
+                          ) : (
+                            <button 
+                              className="btn btn-sm btn-success"
+                              onClick={() => updateMemberStatus(member.id, true)}
+                              title="Activate"
+                            >
+                              ✓
+                            </button>
+                          )}
+                        </div>
+                      </td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            )}
+          </div>
+        </>
+      )}
+
+      {/* Messages Tab */}
+      {activeTab === 'messages' && (
+        <div className="card">
+          {messages.length === 0 ? (
+            <p>No messages from family members.</p>
+          ) : (
+            <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
+              {messages.map(msg => (
+                <div 
+                  key={msg.id} 
+                  style={{ 
+                    border: '1px solid #ddd', 
+                    borderRadius: '8px', 
+                    padding: '1rem',
+                    backgroundColor: msg.is_read ? '#fff' : '#fff3e0'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                    <div>
+                      <strong>{msg.sender_first_name} {msg.sender_last_name}</strong>
+                      <span style={{ marginLeft: '0.5rem', color: '#666', fontSize: '0.85rem' }}>
+                        (Family of {msg.client_first_name} {msg.client_last_name})
+                      </span>
+                    </div>
+                    <span style={{ fontSize: '0.85rem', color: '#666' }}>
+                      {new Date(msg.created_at).toLocaleString()}
+                    </span>
+                  </div>
+                  
+                  {msg.subject && (
+                    <div style={{ fontWeight: 'bold', marginTop: '0.5rem' }}>
+                      {msg.subject}
+                    </div>
+                  )}
+                  
+                  <div style={{ 
+                    marginTop: '0.5rem', 
+                    padding: '0.75rem',
+                    backgroundColor: '#f5f5f5',
+                    borderRadius: '4px'
+                  }}>
+                    {msg.message}
+                  </div>
+
+                  {msg.reply && (
+                    <div style={{ 
+                      marginTop: '0.5rem', 
+                      marginLeft: '1rem',
+                      padding: '0.75rem',
+                      backgroundColor: '#e3f2fd',
+                      borderRadius: '4px',
+                      borderLeft: '3px solid #2196f3'
+                    }}>
+                      <strong>Your Reply:</strong> {msg.reply}
+                    </div>
+                  )}
+
+                  {!msg.reply && (
+                    <button 
+                      className="btn btn-sm btn-primary"
+                      style={{ marginTop: '0.5rem' }}
+                      onClick={() => { setSelectedMember(msg); setShowMessageModal(true); }}
+                    >
+                      Reply
+                    </button>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+
+      {/* Add Family Member Modal */}
+      {showAddModal && (
+        <div className="modal-overlay" onClick={() => setShowAddModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Add Family Member</h3>
+              <button className="modal-close" onClick={() => setShowAddModal(false)}>×</button>
+            </div>
+            <AddMemberForm 
+              clients={clients}
+              onSubmit={createFamilyMember}
+              onCancel={() => setShowAddModal(false)}
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Reply Modal */}
+      {showMessageModal && selectedMember && (
+        <div className="modal-overlay" onClick={() => setShowMessageModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Reply to Message</h3>
+              <button className="modal-close" onClick={() => setShowMessageModal(false)}>×</button>
+            </div>
+            <ReplyForm 
+              message={selectedMember}
+              onSubmit={(reply) => replyToMessage(selectedMember.id, reply)}
+              onCancel={() => setShowMessageModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Add Member Form Component
+const AddMemberForm = ({ clients, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    clientId: '',
+    firstName: '',
+    lastName: '',
+    email: '',
+    phone: '',
+    relationship: 'child',
+    password: '',
+    canViewSchedule: true,
+    canViewCarePlan: true,
+    canViewMedications: false,
+    canMessage: true
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.clientId || !formData.firstName || !formData.email || !formData.password) {
+      toast('Client, name, email and password are required');
+      return;
+    }
+    if (formData.password.length < 8) {
+      toast('Password must be at least 8 characters');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Client *</label>
+        <select 
+          value={formData.clientId}
+          onChange={(e) => setFormData({ ...formData, clientId: e.target.value })}
+          required
+        >
+          <option value="">Select Client</option>
+          {clients.filter(c => c.status === 'active').map(c => (
+            <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>First Name *</label>
+          <input 
+            type="text"
+            value={formData.firstName}
+            onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}
+            required
+          />
+        </div>
+        <div className="form-group">
+          <label>Last Name *</label>
+          <input 
+            type="text"
+            value={formData.lastName}
+            onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}
+            required
+          />
+        </div>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Email *</label>
+          <input 
+            type="email"
+            value={formData.email}
+            onChange={(e) => setFormData({ ...formData, email: e.target.value })}
+            required
+          />
+        </div>
+        <div className="form-group">
+          <label>Phone</label>
+          <input 
+            type="tel"
+            value={formData.phone}
+            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
+          />
+        </div>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Relationship *</label>
+          <select 
+            value={formData.relationship}
+            onChange={(e) => setFormData({ ...formData, relationship: e.target.value })}
+          >
+            <option value="spouse">Spouse</option>
+            <option value="child">Child</option>
+            <option value="parent">Parent</option>
+            <option value="sibling">Sibling</option>
+            <option value="guardian">Guardian</option>
+            <option value="other">Other</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Password *</label>
+          <input 
+            type="password"
+            value={formData.password}
+            onChange={(e) => setFormData({ ...formData, password: e.target.value })}
+            placeholder="Min 8 characters"
+            required
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Portal Permissions</label>
+        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '1rem' }}>
+          <label>
+            <input 
+              type="checkbox"
+              checked={formData.canViewSchedule}
+              onChange={(e) => setFormData({ ...formData, canViewSchedule: e.target.checked })}
+              style={{ marginRight: '0.5rem' }}
+            />
+            View Schedule
+          </label>
+          <label>
+            <input 
+              type="checkbox"
+              checked={formData.canViewCarePlan}
+              onChange={(e) => setFormData({ ...formData, canViewCarePlan: e.target.checked })}
+              style={{ marginRight: '0.5rem' }}
+            />
+            View Care Plan
+          </label>
+          <label>
+            <input 
+              type="checkbox"
+              checked={formData.canViewMedications}
+              onChange={(e) => setFormData({ ...formData, canViewMedications: e.target.checked })}
+              style={{ marginRight: '0.5rem' }}
+            />
+            View Medications
+          </label>
+          <label>
+            <input 
+              type="checkbox"
+              checked={formData.canMessage}
+              onChange={(e) => setFormData({ ...formData, canMessage: e.target.checked })}
+              style={{ marginRight: '0.5rem' }}
+            />
+            Send Messages
+          </label>
+        </div>
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Create Account</button>
+      </div>
+    </form>
+  );
+};
+
+// Reply Form Component
+const ReplyForm = ({ message, onSubmit, onCancel }) => {
+  const [reply, setReply] = useState('');
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!reply.trim()) {
+      toast('Please enter a reply');
+      return;
+    }
+    onSubmit(reply);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div style={{ marginBottom: '1rem', padding: '0.75rem', backgroundColor: '#f5f5f5', borderRadius: '4px' }}>
+        <strong>Original Message from {message.sender_first_name}:</strong>
+        <p style={{ margin: '0.5rem 0 0 0' }}>{message.message}</p>
+      </div>
+
+      <div className="form-group">
+        <label>Your Reply *</label>
+        <textarea 
+          value={reply}
+          onChange={(e) => setReply(e.target.value)}
+          placeholder="Type your reply..."
+          rows={4}
+          required
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Send Reply</button>
+      </div>
+    </form>
+  );
+};
+
+export default FamilyPortalAdmin;
diff --git a/templates/crm-homecare/frontend/src/components/admin/FormBuilder.jsx b/templates/crm-homecare/frontend/src/components/admin/FormBuilder.jsx
new file mode 100644
index 0000000..813784c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/FormBuilder.jsx
@@ -0,0 +1,408 @@
+// FormBuilder.jsx — Create custom forms, fill & submit against clients/caregivers
+
+import { useState, useEffect } from 'react';
+
+const API = import.meta.env.VITE_API_URL || '';
+
+const FIELD_TYPES = [
+  { value: 'text',     label: 'Text Input',     icon: '✏️' },
+  { value: 'textarea', label: 'Long Text',       icon: '📄' },
+  { value: 'select',   label: 'Dropdown',        icon: '🔽' },
+  { value: 'checkbox', label: 'Checkbox',        icon: '☑️' },
+  { value: 'radio',    label: 'Multiple Choice', icon: '🔘' },
+  { value: 'number',   label: 'Number',          icon: '🔢' },
+];
+
+const CATEGORIES = ['assessment','incident','physician_order','consent','intake','hr','general'];
+
+const genId = () => Math.random().toString(36).slice(2, 8);
+
+export default function FormBuilder({ token }) {
+  const [tab, setTab] = useState('templates');
+  const [templates, setTemplates] = useState([]);
+  const [submissions, setSubmissions] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [editTemplate, setEditTemplate] = useState(null); // null = list, obj = edit
+  const [viewSubmission, setViewSubmission] = useState(null);
+  const [fillModal, setFillModal] = useState(null); // { template, entityType, entityId }
+  const [clients, setClients] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [msg, setMsg] = useState('');
+  const [filterCat, setFilterCat] = useState('');
+
+  const h = { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` };
+  const flash = (m, ok = true) => { setMsg({ text: m, ok }); setTimeout(() => setMsg(''), 3500); };
+
+  const load = async () => {
+    setLoading(true);
+    try {
+      const [tR, sR, cR, cgR] = await Promise.all([
+        fetch(`${API}/api/forms/templates?active=all`, { headers: h }),
+        fetch(`${API}/api/forms/submissions?limit=100`, { headers: h }),
+        fetch(`${API}/api/clients`, { headers: h }),
+        fetch(`${API}/api/caregivers`, { headers: h }),
+      ]);
+      setTemplates(await tR.json());
+      setSubmissions(await sR.json());
+      const cData = await cR.json(); setClients(Array.isArray(cData) ? cData : cData.clients || []);
+      const cgData = await cgR.json(); setCaregivers(Array.isArray(cgData) ? cgData : cgData.caregivers || []);
+    } catch (e) {}
+    setLoading(false);
+  };
+
+  useEffect(() => { load(); }, []);
+
+  const newTemplate = () => setEditTemplate({
+    id: null, name: '', description: '', category: 'general',
+    requires_signature: false, auto_attach_to: 'client', is_active: true,
+    fields: []
+  });
+
+  const saveTemplate = async () => {
+    if (!editTemplate.name) return flash('Name is required', false);
+    try {
+      const method = editTemplate.id ? 'PUT' : 'POST';
+      const url = editTemplate.id ? `${API}/api/forms/templates/${editTemplate.id}` : `${API}/api/forms/templates`;
+      const body = { name: editTemplate.name, description: editTemplate.description, category: editTemplate.category,
+        fields: editTemplate.fields, requiresSignature: editTemplate.requires_signature,
+        autoAttachTo: editTemplate.auto_attach_to, isActive: editTemplate.is_active };
+      await fetch(url, { method, headers: h, body: JSON.stringify(body) });
+      flash('Template saved');
+      setEditTemplate(null);
+      load();
+    } catch (e) { flash('Error saving', false); }
+  };
+
+  const deleteTemplate = async (id) => {
+    if (!confirm('Deactivate this template?')) return;
+    await fetch(`${API}/api/forms/templates/${id}`, { method: 'DELETE', headers: h });
+    flash('Deactivated'); load();
+  };
+
+  // Field editing
+  const addField = () => {
+    const field = { id: genId(), type: 'text', label: '', required: false, options: [] };
+    setEditTemplate(t => ({ ...t, fields: [...t.fields, field] }));
+  };
+  const updateField = (idx, updates) => setEditTemplate(t => {
+    const fields = [...t.fields]; fields[idx] = { ...fields[idx], ...updates }; return { ...t, fields };
+  });
+  const removeField = (idx) => setEditTemplate(t => ({ ...t, fields: t.fields.filter((_, i) => i !== idx) }));
+  const moveField = (idx, dir) => setEditTemplate(t => {
+    const fields = [...t.fields];
+    const swap = idx + dir;
+    if (swap < 0 || swap >= fields.length) return t;
+    [fields[idx], fields[swap]] = [fields[swap], fields[idx]];
+    return { ...t, fields };
+  });
+
+  const catColor = (c) => ({ assessment:'#3B82F6', incident:'#EF4444', physician_order:'#8B5CF6', consent:'#F59E0B', intake:'#10B981', hr:'#6366F1', general:'#6B7280' }[c] || '#6B7280');
+
+  const tabStyle = (t) => ({ padding: '0.5rem 1rem', border: 'none', borderBottom: `3px solid ${tab === t ? '#3B82F6' : 'transparent'}`, background: 'none', cursor: 'pointer', fontWeight: tab === t ? 700 : 400, color: tab === t ? '#1D4ED8' : '#6B7280', fontSize: '0.92rem' });
+
+  const filteredTemplates = filterCat ? templates.filter(t => t.category === filterCat) : templates;
+
+  // ── FORM FILLER ──
+  const FormFiller = ({ template, onClose }) => {
+    const [formData, setFormData] = useState({});
+    const [entityType, setEntityType] = useState(template.auto_attach_to === 'caregiver' ? 'caregiver' : 'client');
+    const [entityId, setEntityId] = useState('');
+    const [signature, setSignature] = useState('');
+    const [saving, setSaving] = useState(false);
+
+    const submit = async () => {
+      setSaving(true);
+      try {
+        await fetch(`${API}/api/forms/submissions`, {
+          method: 'POST', headers: h,
+          body: JSON.stringify({ templateId: template.id, entityType, entityId: entityId || null, data: formData, status: 'submitted', signature: template.requires_signature ? signature : undefined })
+        });
+        flash('Form submitted');
+        onClose(); load();
+      } catch (e) { flash('Error submitting', false); }
+      setSaving(false);
+    };
+
+    return (
+      <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', zIndex: 2000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={onClose}>
+        <div style={{ background: '#fff', borderRadius: '12px', padding: '1.5rem', maxWidth: '560px', width: '100%', maxHeight: '90vh', overflowY: 'auto', boxShadow: '0 20px 60px rgba(0,0,0,0.3)' }} onClick={e => e.stopPropagation()}>
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1.25rem' }}>
+            <div>
+              <h3 style={{ margin: 0 }}>{template.name}</h3>
+              {template.description && <p style={{ margin: '0.25rem 0 0', color: '#6B7280', fontSize: '0.85rem' }}>{template.description}</p>}
+            </div>
+            <button onClick={onClose} style={{ background: 'none', border: 'none', fontSize: '1.2rem', cursor: 'pointer', color: '#9CA3AF' }}>✕</button>
+          </div>
+
+          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', marginBottom: '1.25rem', paddingBottom: '1.25rem', borderBottom: '1px solid #E5E7EB' }}>
+            <div>
+              <label style={{ display: 'block', fontWeight: 600, fontSize: '0.85rem', marginBottom: '0.3rem' }}>Attach to</label>
+              <select value={entityType} onChange={e => { setEntityType(e.target.value); setEntityId(''); }}
+                style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }}>
+                <option value='client'>Client</option>
+                <option value='caregiver'>Caregiver</option>
+              </select>
+            </div>
+            <div>
+              <label style={{ display: 'block', fontWeight: 600, fontSize: '0.85rem', marginBottom: '0.3rem' }}>
+                {entityType === 'client' ? 'Client' : 'Caregiver'}
+              </label>
+              <select value={entityId} onChange={e => setEntityId(e.target.value)}
+                style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }}>
+                <option value=''>Select...</option>
+                {(entityType === 'client' ? clients : caregivers).map(e => (
+                  <option key={e.id} value={e.id}>{e.first_name} {e.last_name}</option>
+                ))}
+              </select>
+            </div>
+          </div>
+
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', marginBottom: '1.25rem' }}>
+            {template.fields.map((field) => (
+              <div key={field.id}>
+                <label style={{ display: 'block', fontWeight: 600, fontSize: '0.88rem', marginBottom: '0.3rem', color: '#374151' }}>
+                  {field.label} {field.required && <span style={{ color: '#EF4444' }}>*</span>}
+                </label>
+                {field.type === 'textarea' && (
+                  <textarea value={formData[field.id] || ''} onChange={e => setFormData(d => ({ ...d, [field.id]: e.target.value }))}
+                    rows={3} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem', resize: 'vertical', boxSizing: 'border-box' }} />
+                )}
+                {(field.type === 'text' || field.type === 'number') && (
+                  <input type={field.inputType || field.type} value={formData[field.id] || ''}
+                    onChange={e => setFormData(d => ({ ...d, [field.id]: e.target.value }))}
+                    style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem', boxSizing: 'border-box' }} />
+                )}
+                {field.type === 'select' && (
+                  <select value={formData[field.id] || ''} onChange={e => setFormData(d => ({ ...d, [field.id]: e.target.value }))}
+                    style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }}>
+                    <option value=''>Select...</option>
+                    {(field.options || []).map(o => <option key={o} value={o}>{o}</option>)}
+                  </select>
+                )}
+                {field.type === 'checkbox' && (
+                  <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
+                    <input type='checkbox' checked={!!formData[field.id]} onChange={e => setFormData(d => ({ ...d, [field.id]: e.target.checked }))} />
+                    <span style={{ fontSize: '0.88rem' }}>Yes</span>
+                  </label>
+                )}
+                {field.type === 'radio' && (
+                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
+                    {(field.options || []).map(o => (
+                      <label key={o} style={{ display: 'flex', alignItems: 'center', gap: '0.35rem', cursor: 'pointer', padding: '0.3rem 0.75rem', border: `1px solid ${formData[field.id] === o ? '#3B82F6' : '#D1D5DB'}`, borderRadius: '20px', background: formData[field.id] === o ? '#EFF6FF' : '#fff', fontSize: '0.85rem' }}>
+                        <input type='radio' name={field.id} value={o} checked={formData[field.id] === o} onChange={() => setFormData(d => ({ ...d, [field.id]: o }))} style={{ display: 'none' }} />
+                        {o}
+                      </label>
+                    ))}
+                  </div>
+                )}
+              </div>
+            ))}
+          </div>
+
+          {template.requires_signature && (
+            <div style={{ marginBottom: '1.25rem', padding: '0.85rem', background: '#FFF7ED', border: '1px solid #FED7AA', borderRadius: '8px' }}>
+              <label style={{ display: 'block', fontWeight: 700, fontSize: '0.88rem', marginBottom: '0.35rem', color: '#92400E' }}>✍️ Signature Required</label>
+              <input value={signature} onChange={e => setSignature(e.target.value)} placeholder='Type full name to sign...'
+                style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #FCD34D', fontSize: '0.95rem', fontFamily: 'cursive', boxSizing: 'border-box' }} />
+            </div>
+          )}
+
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button onClick={submit} disabled={saving || (template.requires_signature && !signature)}
+              style={{ flex: 1, padding: '0.7rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 700, fontSize: '0.92rem', opacity: saving ? 0.7 : 1 }}>
+              {saving ? 'Submitting...' : '✓ Submit Form'}
+            </button>
+          </div>
+        </div>
+      </div>
+    );
+  };
+
+  // ── TEMPLATE EDITOR ──
+  if (editTemplate) return (
+    <div>
+      <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1.5rem', paddingBottom: '1rem', borderBottom: '2px solid #E5E7EB' }}>
+        <button onClick={() => setEditTemplate(null)} style={{ background: '#F3F4F6', border: 'none', borderRadius: '8px', padding: '0.5rem 0.85rem', cursor: 'pointer', fontWeight: 600 }}>← Back</button>
+        <h2 style={{ margin: 0 }}>{editTemplate.id ? 'Edit Template' : 'New Template'}</h2>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', maxWidth: '700px', marginBottom: '1.25rem' }}>
+        <div>
+          <label style={{ display: 'block', fontWeight: 600, fontSize: '0.88rem', marginBottom: '0.3rem' }}>Form Name *</label>
+          <input value={editTemplate.name} onChange={e => setEditTemplate(t => ({ ...t, name: e.target.value }))}
+            placeholder='e.g. Initial Client Assessment'
+            style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.92rem', boxSizing: 'border-box' }} />
+        </div>
+        <div>
+          <label style={{ display: 'block', fontWeight: 600, fontSize: '0.88rem', marginBottom: '0.3rem' }}>Category</label>
+          <select value={editTemplate.category} onChange={e => setEditTemplate(t => ({ ...t, category: e.target.value }))}
+            style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.92rem' }}>
+            {CATEGORIES.map(c => <option key={c} value={c}>{c.replace(/_/g, ' ')}</option>)}
+          </select>
+        </div>
+        <div style={{ gridColumn: '1 / -1' }}>
+          <label style={{ display: 'block', fontWeight: 600, fontSize: '0.88rem', marginBottom: '0.3rem' }}>Description</label>
+          <input value={editTemplate.description || ''} onChange={e => setEditTemplate(t => ({ ...t, description: e.target.value }))}
+            placeholder='Brief description...'
+            style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.92rem', boxSizing: 'border-box' }} />
+        </div>
+        <div style={{ display: 'flex', gap: '1.5rem', alignItems: 'center', gridColumn: '1 / -1' }}>
+          <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
+            <input type='checkbox' checked={editTemplate.requires_signature} onChange={e => setEditTemplate(t => ({ ...t, requires_signature: e.target.checked }))} />
+            <span style={{ fontSize: '0.88rem', fontWeight: 600 }}>Requires Signature</span>
+          </label>
+          <div>
+            <select value={editTemplate.auto_attach_to || 'client'} onChange={e => setEditTemplate(t => ({ ...t, auto_attach_to: e.target.value }))}
+              style={{ padding: '0.4rem 0.65rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem' }}>
+              <option value='client'>Attach to Client</option>
+              <option value='caregiver'>Attach to Caregiver</option>
+              <option value='both'>Both</option>
+            </select>
+          </div>
+        </div>
+      </div>
+
+      <div style={{ maxWidth: '700px' }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
+          <h4 style={{ margin: 0 }}>Fields ({editTemplate.fields.length})</h4>
+          <button onClick={addField} style={{ padding: '0.4rem 0.9rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 600, fontSize: '0.85rem' }}>+ Add Field</button>
+        </div>
+
+        {editTemplate.fields.length === 0 && (
+          <div style={{ textAlign: 'center', padding: '2rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB', marginBottom: '1rem' }}>
+            No fields yet — click "Add Field" to start building
+          </div>
+        )}
+
+        {editTemplate.fields.map((field, idx) => (
+          <div key={field.id} style={{ background: '#F9FAFB', border: '1px solid #E5E7EB', borderRadius: '10px', padding: '1rem', marginBottom: '0.6rem' }}>
+            <div style={{ display: 'grid', gridTemplateColumns: '1fr 140px auto', gap: '0.6rem', alignItems: 'center', marginBottom: '0.6rem' }}>
+              <input value={field.label} onChange={e => updateField(idx, { label: e.target.value })} placeholder={`Field ${idx + 1} label...`}
+                style={{ padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem' }} />
+              <select value={field.type} onChange={e => updateField(idx, { type: e.target.value })}
+                style={{ padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem' }}>
+                {FIELD_TYPES.map(t => <option key={t.value} value={t.value}>{t.icon} {t.label}</option>)}
+              </select>
+              <div style={{ display: 'flex', gap: '0.3rem' }}>
+                <button onClick={() => moveField(idx, -1)} disabled={idx === 0} style={{ background: 'none', border: '1px solid #E5E7EB', borderRadius: '4px', cursor: 'pointer', padding: '0.25rem 0.4rem', opacity: idx === 0 ? 0.3 : 1 }}>↑</button>
+                <button onClick={() => moveField(idx, 1)} disabled={idx === editTemplate.fields.length - 1} style={{ background: 'none', border: '1px solid #E5E7EB', borderRadius: '4px', cursor: 'pointer', padding: '0.25rem 0.4rem', opacity: idx === editTemplate.fields.length - 1 ? 0.3 : 1 }}>↓</button>
+                <button onClick={() => removeField(idx)} style={{ background: 'none', border: '1px solid #FCA5A5', borderRadius: '4px', cursor: 'pointer', padding: '0.25rem 0.4rem', color: '#EF4444' }}>✕</button>
+              </div>
+            </div>
+            <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>
+              <label style={{ display: 'flex', alignItems: 'center', gap: '0.35rem', fontSize: '0.82rem', cursor: 'pointer' }}>
+                <input type='checkbox' checked={field.required} onChange={e => updateField(idx, { required: e.target.checked })} />
+                Required
+              </label>
+              {(field.type === 'select' || field.type === 'radio') && (
+                <div style={{ flex: 1 }}>
+                  <input value={(field.options || []).join(', ')} onChange={e => updateField(idx, { options: e.target.value.split(',').map(s => s.trim()).filter(Boolean) })}
+                    placeholder='Options: Option 1, Option 2, Option 3'
+                    style={{ width: '100%', padding: '0.4rem 0.6rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.82rem', boxSizing: 'border-box' }} />
+                </div>
+              )}
+            </div>
+          </div>
+        ))}
+
+        <div style={{ display: 'flex', gap: '0.75rem', marginTop: '1.25rem' }}>
+          <button onClick={saveTemplate} style={{ padding: '0.7rem 1.5rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 700, fontSize: '0.92rem' }}>✓ Save Template</button>
+          <button onClick={() => setEditTemplate(null)} style={{ padding: '0.7rem 1.25rem', borderRadius: '8px', border: '1px solid #D1D5DB', background: '#fff', color: '#374151', cursor: 'pointer', fontWeight: 600, fontSize: '0.92rem' }}>Cancel</button>
+        </div>
+      </div>
+    </div>
+  );
+
+  // ── MAIN VIEW ──
+  return (
+    <div>
+      {msg && <div style={{ position: 'fixed', top: '1rem', right: '1rem', background: msg.ok ? '#D1FAE5' : '#FEE2E2', color: msg.ok ? '#065F46' : '#991B1B', padding: '0.75rem 1.25rem', borderRadius: '8px', zIndex: 9999, fontWeight: 600, boxShadow: '0 4px 12px rgba(0,0,0,0.15)' }}>{msg.text}</div>}
+      {fillModal && <FormFiller template={fillModal} onClose={() => setFillModal(null)} />}
+
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem', flexWrap: 'wrap', gap: '0.5rem' }}>
+        <h2 style={{ margin: 0 }}>📝 Form Builder</h2>
+        <button onClick={newTemplate} style={{ padding: '0.5rem 1.1rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 700, fontSize: '0.88rem' }}>+ New Template</button>
+      </div>
+
+      <div style={{ display: 'flex', borderBottom: '2px solid #E5E7EB', marginBottom: '1.25rem' }}>
+        <button style={tabStyle('templates')} onClick={() => setTab('templates')}>📋 Templates ({templates.length})</button>
+        <button style={tabStyle('submissions')} onClick={() => setTab('submissions')}>📨 Submissions ({submissions.length})</button>
+      </div>
+
+      {tab === 'templates' && (
+        <>
+          <div style={{ display: 'flex', gap: '0.4rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
+            <button onClick={() => setFilterCat('')} style={{ padding: '0.3rem 0.8rem', borderRadius: '20px', border: `1px solid ${!filterCat ? '#3B82F6' : '#E5E7EB'}`, background: !filterCat ? '#3B82F6' : '#fff', color: !filterCat ? '#fff' : '#374151', cursor: 'pointer', fontSize: '0.8rem', fontWeight: !filterCat ? 700 : 400 }}>All</button>
+            {CATEGORIES.map(c => (
+              <button key={c} onClick={() => setFilterCat(c === filterCat ? '' : c)} style={{ padding: '0.3rem 0.8rem', borderRadius: '20px', border: `1px solid ${filterCat === c ? catColor(c) : '#E5E7EB'}`, background: filterCat === c ? catColor(c) : '#fff', color: filterCat === c ? '#fff' : '#374151', cursor: 'pointer', fontSize: '0.8rem', fontWeight: filterCat === c ? 700 : 400 }}>{c.replace(/_/g,' ')}</button>
+            ))}
+          </div>
+
+          {loading ? <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF' }}>Loading...</div>
+          : filteredTemplates.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+              <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📝</div>
+              No templates yet — click "New Template" to create one
+            </div>
+          ) : (
+            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: '0.75rem' }}>
+              {filteredTemplates.map(t => (
+                <div key={t.id} style={{ background: '#fff', border: `1px solid ${t.is_active ? '#E5E7EB' : '#F3F4F6'}`, borderTop: `3px solid ${catColor(t.category)}`, borderRadius: '10px', padding: '1rem', opacity: t.is_active ? 1 : 0.6 }}>
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.5rem' }}>
+                    <span style={{ fontWeight: 700, fontSize: '0.95rem', color: '#111827' }}>{t.name}</span>
+                    <span style={{ background: catColor(t.category) + '18', color: catColor(t.category), padding: '0.1rem 0.45rem', borderRadius: '10px', fontSize: '0.7rem', fontWeight: 700, whiteSpace: 'nowrap', marginLeft: '0.5rem' }}>{t.category.replace(/_/g,' ')}</span>
+                  </div>
+                  {t.description && <p style={{ margin: '0 0 0.5rem', fontSize: '0.8rem', color: '#6B7280', lineHeight: 1.4 }}>{t.description}</p>}
+                  <div style={{ fontSize: '0.75rem', color: '#9CA3AF', marginBottom: '0.75rem', display: 'flex', gap: '0.75rem', flexWrap: 'wrap' }}>
+                    <span>{t.fields?.length || 0} fields</span>
+                    <span>{t.submission_count || 0} submissions</span>
+                    {t.requires_signature && <span>✍️ Signature</span>}
+                  </div>
+                  <div style={{ display: 'flex', gap: '0.4rem' }}>
+                    <button onClick={() => setFillModal(t)} style={{ flex: 1, padding: '0.4rem', borderRadius: '6px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 600, fontSize: '0.8rem' }}>Fill Out</button>
+                    <button onClick={() => setEditTemplate({ ...t, fields: typeof t.fields === 'string' ? JSON.parse(t.fields) : t.fields })} style={{ padding: '0.4rem 0.65rem', borderRadius: '6px', border: '1px solid #E5E7EB', background: '#fff', color: '#374151', cursor: 'pointer', fontSize: '0.8rem' }}>Edit</button>
+                    <button onClick={() => deleteTemplate(t.id)} style={{ padding: '0.4rem 0.65rem', borderRadius: '6px', border: '1px solid #FCA5A5', background: '#fff', color: '#EF4444', cursor: 'pointer', fontSize: '0.8rem' }}>✕</button>
+                  </div>
+                </div>
+              ))}
+            </div>
+          )}
+        </>
+      )}
+
+      {tab === 'submissions' && (
+        loading ? <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF' }}>Loading...</div>
+        : submissions.length === 0 ? (
+          <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+            <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📨</div>
+            No submissions yet
+          </div>
+        ) : (
+          <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.88rem' }}>
+            <thead>
+              <tr style={{ background: '#F9FAFB', borderBottom: '2px solid #E5E7EB' }}>
+                {['Form','Category','Attached To','Submitted By','Date','Status'].map(h => (
+                  <th key={h} style={{ textAlign: 'left', padding: '0.65rem 0.85rem', fontWeight: 700, color: '#374151', fontSize: '0.82rem' }}>{h}</th>
+                ))}
+              </tr>
+            </thead>
+            <tbody>
+              {submissions.map((s, i) => (
+                <tr key={s.id} style={{ borderBottom: '1px solid #F3F4F6', background: i % 2 === 0 ? '#fff' : '#FAFAFA' }}>
+                  <td style={{ padding: '0.65rem 0.85rem', fontWeight: 600 }}>{s.template_name || s.form_name}</td>
+                  <td style={{ padding: '0.65rem 0.85rem' }}><span style={{ background: catColor(s.category) + '18', color: catColor(s.category), padding: '0.1rem 0.45rem', borderRadius: '10px', fontSize: '0.72rem', fontWeight: 700 }}>{(s.category || 'general').replace(/_/g,' ')}</span></td>
+                  <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280' }}>{s.entity_type || '—'}</td>
+                  <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280' }}>{s.submitted_by_name}</td>
+                  <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280' }}>{new Date(s.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</td>
+                  <td style={{ padding: '0.65rem 0.85rem' }}>
+                    <span style={{ background: s.status === 'signed' ? '#D1FAE5' : '#EFF6FF', color: s.status === 'signed' ? '#065F46' : '#1D4ED8', padding: '0.15rem 0.5rem', borderRadius: '10px', fontSize: '0.75rem', fontWeight: 700 }}>{s.status}</span>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )
+      )}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/IncidentReporting.jsx b/templates/crm-homecare/frontend/src/components/admin/IncidentReporting.jsx
new file mode 100644
index 0000000..3fbaafe
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/IncidentReporting.jsx
@@ -0,0 +1,531 @@
+import { confirm } from '../ConfirmModal';
+// src/components/admin/IncidentReporting.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const IncidentReporting = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [incidents, setIncidents] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [showForm, setShowForm] = useState(false);
+  const [filter, setFilter] = useState('all'); // all, critical, severe, moderate, minor
+  const [searchTerm, setSearchTerm] = useState('');
+  const [message, setMessage] = useState('');
+  const [formData, setFormData] = useState({
+    clientId: '',
+    caregiverId: '',
+    incidentType: 'accident',
+    severity: 'moderate',
+    incidentDate: new Date().toISOString().split('T')[0],
+    incidentTime: new Date().toISOString().split('T')[1].slice(0, 5),
+    description: '',
+    witnesses: '',
+    injuriesOrDamage: '',
+    actionsTaken: '',
+    followUpRequired: false,
+    followUpNotes: '',
+    reportedBy: '',
+    reportedDate: new Date().toISOString().split('T')[0]
+  });
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [clientsRes, caregiversRes, incidentsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/incidents`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const clientsData = await clientsRes.json();
+      const caregiversData = await caregiversRes.json();
+      const incidentsData = await incidentsRes.json();
+
+      setClients(clientsData);
+      setCaregivers(caregiversData);
+      setIncidents(Array.isArray(incidentsData) ? incidentsData : []);
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSubmitIncident = async (e) => {
+    e.preventDefault();
+    setMessage('');
+
+    if (!formData.clientId || !formData.incidentType) {
+      setMessage('Client and incident type are required');
+      return;
+    }
+
+    if (!formData.description.trim()) {
+      setMessage('Description is required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/incidents`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) {
+        const error = await response.json();
+        throw new Error(error.error || 'Failed to report incident');
+      }
+
+      setMessage('Incident reported successfully!');
+      setFormData({
+        clientId: '',
+        caregiverId: '',
+        incidentType: 'accident',
+        severity: 'moderate',
+        incidentDate: new Date().toISOString().split('T')[0],
+        incidentTime: new Date().toISOString().split('T')[1].slice(0, 5),
+        description: '',
+        witnesses: '',
+        injuriesOrDamage: '',
+        actionsTaken: '',
+        followUpRequired: false,
+        followUpNotes: '',
+        reportedBy: '',
+        reportedDate: new Date().toISOString().split('T')[0]
+      });
+      setShowForm(false);
+      loadData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeleteIncident = async (incidentId) => {
+    const _cok = await confirm('Delete this incident report? This cannot be undone.', {danger: true}); if (!_cok) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/incidents/${incidentId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Incident deleted');
+      setTimeout(() => setMessage(''), 2000);
+      loadData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const getClientName = (clientId) => {
+    const client = clients.find(c => c.id === clientId);
+    return client ? `${client.first_name} ${client.last_name}` : 'Unknown Client';
+  };
+
+  const getCaregiverName = (caregiverId) => {
+    const caregiver = caregivers.find(c => c.id === caregiverId);
+    return caregiver ? `${caregiver.first_name} ${caregiver.last_name}` : 'Unknown Caregiver';
+  };
+
+  const getSeverityColor = (severity) => {
+    switch (severity) {
+      case 'critical':
+        return '#d32f2f';
+      case 'severe':
+        return '#f57c00';
+      case 'moderate':
+        return '#fbc02d';
+      case 'minor':
+        return '#388e3c';
+      default:
+        return '#999';
+    }
+  };
+
+  const getSeverityLabel = (severity) => {
+    return severity.charAt(0).toUpperCase() + severity.slice(1);
+  };
+
+  const getIncidentTypeLabel = (type) => {
+    const labels = {
+      'accident': 'Accident',
+      'fall': 'Fall',
+      'medication_error': 'Medication Error',
+      'behavioral': 'Behavioral Issue',
+      'injury': 'Injury',
+      'property_damage': 'Property Damage',
+      'health_emergency': 'Health Emergency',
+      'other': 'Other'
+    };
+    return labels[type] || type;
+  };
+
+  const filteredIncidents = incidents
+    .filter(incident => {
+      if (filter !== 'all' && incident.severity !== filter) return false;
+      if (searchTerm) {
+        const term = searchTerm.toLowerCase();
+        return (
+          getClientName(incident.client_id).toLowerCase().includes(term) ||
+          incident.description.toLowerCase().includes(term) ||
+          incident.incident_type.toLowerCase().includes(term)
+        );
+      }
+      return true;
+    })
+    .sort((a, b) => new Date(b.incident_date) - new Date(a.incident_date));
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Incident & Accident Reporting</h2>
+        <button
+          className="btn btn-primary"
+          onClick={() => setShowForm(!showForm)}
+        >
+          {showForm ? 'Cancel' : 'Report Incident'}
+        </button>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Report Form */}
+      {showForm && (
+        <div className="card card-form">
+          <h3>Report New Incident</h3>
+          <form onSubmit={handleSubmitIncident}>
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Client *</label>
+                <select
+                  value={formData.clientId}
+                  onChange={(e) => setFormData({ ...formData, clientId: e.target.value })}
+                  required
+                >
+                  <option value="">Select client...</option>
+                  {clients.map(client => (
+                    <option key={client.id} value={client.id}>
+                      {client.first_name} {client.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Caregiver Involved</label>
+                <select
+                  value={formData.caregiverId}
+                  onChange={(e) => setFormData({ ...formData, caregiverId: e.target.value })}
+                >
+                  <option value="">Select caregiver (if applicable)...</option>
+                  {caregivers.map(cg => (
+                    <option key={cg.id} value={cg.id}>
+                      {cg.first_name} {cg.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Incident Type *</label>
+                <select
+                  value={formData.incidentType}
+                  onChange={(e) => setFormData({ ...formData, incidentType: e.target.value })}
+                >
+                  <option value="accident">Accident</option>
+                  <option value="fall">Fall</option>
+                  <option value="medication_error">Medication Error</option>
+                  <option value="behavioral">Behavioral Issue</option>
+                  <option value="injury">Injury</option>
+                  <option value="property_damage">Property Damage</option>
+                  <option value="health_emergency">Health Emergency</option>
+                  <option value="other">Other</option>
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Severity *</label>
+                <select
+                  value={formData.severity}
+                  onChange={(e) => setFormData({ ...formData, severity: e.target.value })}
+                >
+                  <option value="minor">Minor</option>
+                  <option value="moderate">Moderate</option>
+                  <option value="severe">Severe</option>
+                  <option value="critical">Critical</option>
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Incident Date *</label>
+                <input
+                  type="date"
+                  value={formData.incidentDate}
+                  onChange={(e) => setFormData({ ...formData, incidentDate: e.target.value })}
+                  required
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Incident Time</label>
+                <input
+                  type="time"
+                  value={formData.incidentTime}
+                  onChange={(e) => setFormData({ ...formData, incidentTime: e.target.value })}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Reported By</label>
+                <input
+                  type="text"
+                  value={formData.reportedBy}
+                  onChange={(e) => setFormData({ ...formData, reportedBy: e.target.value })}
+                  placeholder="Name of person reporting"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Report Date</label>
+                <input
+                  type="date"
+                  value={formData.reportedDate}
+                  onChange={(e) => setFormData({ ...formData, reportedDate: e.target.value })}
+                />
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Incident Description *</label>
+              <textarea
+                value={formData.description}
+                onChange={(e) => setFormData({ ...formData, description: e.target.value })}
+                placeholder="Detailed description of what happened..."
+                rows="4"
+                required
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Witnesses</label>
+              <textarea
+                value={formData.witnesses}
+                onChange={(e) => setFormData({ ...formData, witnesses: e.target.value })}
+                placeholder="Names and contact info of witnesses..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Injuries or Damage</label>
+              <textarea
+                value={formData.injuriesOrDamage}
+                onChange={(e) => setFormData({ ...formData, injuriesOrDamage: e.target.value })}
+                placeholder="Description of any injuries or property damage..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Actions Taken</label>
+              <textarea
+                value={formData.actionsTaken}
+                onChange={(e) => setFormData({ ...formData, actionsTaken: e.target.value })}
+                placeholder="What actions were taken in response to the incident..."
+                rows="2"
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+                <input
+                  type="checkbox"
+                  checked={formData.followUpRequired}
+                  onChange={(e) => setFormData({ ...formData, followUpRequired: e.target.checked })}
+                />
+                <span>Follow-up Required</span>
+              </label>
+            </div>
+
+            {formData.followUpRequired && (
+              <div className="form-group">
+                <label>Follow-up Notes</label>
+                <textarea
+                  value={formData.followUpNotes}
+                  onChange={(e) => setFormData({ ...formData, followUpNotes: e.target.value })}
+                  placeholder="What follow-up actions are needed..."
+                  rows="2"
+                ></textarea>
+              </div>
+            )}
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Report Incident</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Filters */}
+      <div className="card">
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', alignItems: 'center' }}>
+          <input
+            type="text"
+            placeholder="Search incidents..."
+            value={searchTerm}
+            onChange={(e) => setSearchTerm(e.target.value)}
+            style={{ flex: 1, minWidth: '200px', padding: '0.75rem', border: '1px solid #ddd', borderRadius: '4px' }}
+          />
+        </div>
+
+        <div className="filter-tabs" style={{ marginTop: '1rem' }}>
+          {['all', 'critical', 'severe', 'moderate', 'minor'].map(f => (
+            <button
+              key={f}
+              className={`filter-tab ${filter === f ? 'active' : ''}`}
+              onClick={() => setFilter(f)}
+            >
+              {f.charAt(0).toUpperCase() + f.slice(1)}
+              {f !== 'all' && ` (${incidents.filter(i => i.severity === f).length})`}
+            </button>
+          ))}
+        </div>
+      </div>
+
+      {/* Incidents List */}
+      {filteredIncidents.length === 0 ? (
+        <div className="card card-centered">
+          <p>No incidents reported.</p>
+        </div>
+      ) : (
+        <div style={{ display: 'grid', gap: '1rem' }}>
+          {filteredIncidents.map(incident => (
+            <div
+              key={incident.id}
+              style={{
+                padding: '1rem',
+                border: `2px solid ${getSeverityColor(incident.severity)}`,
+                borderRadius: '6px',
+                background: '#f9f9f9'
+              }}
+            >
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '1rem' }}>
+                <div>
+                  <h4 style={{ margin: '0 0 0.25rem 0' }}>
+                    {getClientName(incident.client_id)} - {getIncidentTypeLabel(incident.incident_type)}
+                  </h4>
+                  <small style={{ color: '#666' }}>
+                    {new Date(incident.incident_date).toLocaleDateString()} at {incident.incident_time || 'Unknown time'}
+                  </small>
+                </div>
+                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+                  <span
+                    className="badge"
+                    style={{
+                      background: getSeverityColor(incident.severity),
+                      color: 'white'
+                    }}
+                  >
+                    {getSeverityLabel(incident.severity).toUpperCase()}
+                  </span>
+                  <button
+                    className="btn btn-sm btn-danger"
+                    onClick={() => handleDeleteIncident(incident.id)}
+                  >
+                    Delete
+                  </button>
+                </div>
+              </div>
+
+              <div style={{ marginBottom: '0.75rem' }}>
+                <strong>Description:</strong>
+                <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                  {incident.description}
+                </p>
+              </div>
+
+              {incident.caregiver_id && (
+                <div style={{ marginBottom: '0.75rem', fontSize: '0.9rem' }}>
+                  <strong>Caregiver:</strong> {getCaregiverName(incident.caregiver_id)}
+                </div>
+              )}
+
+              {incident.witnesses && (
+                <div style={{ marginBottom: '0.75rem', fontSize: '0.9rem' }}>
+                  <strong>Witnesses:</strong>
+                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                    {incident.witnesses}
+                  </p>
+                </div>
+              )}
+
+              {incident.injuries_or_damage && (
+                <div style={{ marginBottom: '0.75rem', fontSize: '0.9rem', padding: '0.75rem', background: '#ffe6e6', borderRadius: '4px' }}>
+                  <strong style={{ color: '#d32f2f' }}>Injuries/Damage:</strong>
+                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                    {incident.injuries_or_damage}
+                  </p>
+                </div>
+              )}
+
+              {incident.actions_taken && (
+                <div style={{ marginBottom: '0.75rem', fontSize: '0.9rem' }}>
+                  <strong>Actions Taken:</strong>
+                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                    {incident.actions_taken}
+                  </p>
+                </div>
+              )}
+
+              {incident.follow_up_required && (
+                <div style={{ padding: '0.75rem', background: '#fff3cd', borderRadius: '4px', fontSize: '0.9rem' }}>
+                  <strong>Follow-up Required:</strong>
+                  {incident.follow_up_notes && (
+                    <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                      {incident.follow_up_notes}
+                    </p>
+                  )}
+                </div>
+              )}
+
+              <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #ddd', fontSize: '0.85rem', color: '#999' }}>
+                Reported by {incident.reported_by || 'Unknown'} on {new Date(incident.reported_date).toLocaleDateString()}
+              </div>
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default IncidentReporting;
diff --git a/templates/crm-homecare/frontend/src/components/admin/IntegrationsHub.jsx b/templates/crm-homecare/frontend/src/components/admin/IntegrationsHub.jsx
new file mode 100644
index 0000000..fc50653
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/IntegrationsHub.jsx
@@ -0,0 +1,770 @@
+// src/components/admin/IntegrationsHub.jsx
+// Unified command center: EVV, Authorizations, EDI 837, Remittance, Gusto
+import React, { useState, useEffect, useCallback, useRef } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+// ─── HELPERS ──────────────────────────────────────────────────────────────────
+const fmt$ = (n) => n != null ? `$${parseFloat(n||0).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,',')}` : '—';
+const fmtDate = (d) => d ? new Date(d).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : '—';
+const fmtNum = (n) => n != null ? parseFloat(n||0).toFixed(2) : '—';
+
+const STATUS_COLORS = {
+  accepted: ['#D1FAE5','#065F46'], submitted: ['#DBEAFE','#1E40AF'],
+  ready: ['#D1FAE5','#065F46'], pending: ['#FEF3C7','#92400E'],
+  exception: ['#FEE2E2','#991B1B'], rejected: ['#FEE2E2','#991B1B'],
+  matched: ['#D1FAE5','#065F46'], partial: ['#FEF3C7','#92400E'],
+  unmatched: ['#F3F4F6','#374151'], pending_match: ['#DBEAFE','#1E40AF'],
+  active: ['#D1FAE5','#065F46'], expired: ['#FEE2E2','#991B1B'],
+  exhausted: ['#FEE2E2','#991B1B'], low: ['#FEF3C7','#92400E'],
+  ok: ['#D1FAE5','#065F46'], expiring_soon: ['#FEF3C7','#92400E'],
+};
+
+const Badge = ({ status, label }) => {
+  const [bg, color] = STATUS_COLORS[status] || ['#F3F4F6','#374151'];
+  return <span style={{padding:'2px 10px',borderRadius:'99px',fontSize:'0.72rem',fontWeight:'700',background:bg,color}}>{label||status}</span>;
+};
+
+const Card = ({children, style}) => (
+  <div style={{background:'#fff',borderRadius:'14px',border:'1px solid #E5E7EB',padding:'1.25rem',...style}}>{children}</div>
+);
+
+const SectionHeader = ({icon, title, sub, action}) => (
+  <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'1.25rem'}}>
+    <div>
+      <h3 style={{margin:0,fontSize:'1rem',fontWeight:'800',color:'#111827'}}>{icon} {title}</h3>
+      {sub && <p style={{margin:'0.15rem 0 0',fontSize:'0.78rem',color:'#6B7280'}}>{sub}</p>}
+    </div>
+    {action}
+  </div>
+);
+
+const Btn = ({onClick,children,color='#2ABBA7',disabled,small,outline}) => (
+  <button onClick={onClick} disabled={disabled} style={{
+    padding: small?'0.35rem 0.75rem':'0.6rem 1.25rem',
+    background: outline?'#fff':disabled?'#D1D5DB':color,
+    color: outline?color:disabled?'#9CA3AF':'#fff',
+    border: outline?`2px solid ${color}`:'none',
+    borderRadius:'8px', cursor:disabled?'not-allowed':'pointer',
+    fontWeight:'700', fontSize:small?'0.78rem':'0.85rem', whiteSpace:'nowrap'
+  }}>{children}</button>
+);
+
+// ─── TABS ─────────────────────────────────────────────────────────────────────
+const TABS = [
+  { id: 'overview', label: '📊 Overview' },
+  { id: 'evv', label: '🏠 EVV' },
+  { id: 'authorizations', label: '📋 Authorizations' },
+  { id: 'claims', label: '📄 EDI Claims' },
+  { id: 'remittance', label: '💵 Remittance' },
+  { id: 'payroll', label: '💰 Payroll' },
+];
+
+// ─── MAIN COMPONENT ───────────────────────────────────────────────────────────
+const IntegrationsHub = ({ token }) => {
+  const [tab, setTab] = useState('overview');
+  const [sandataConfig, setSandataConfig] = useState(null);
+  const [gustoConfig, setGustoConfig] = useState(null);
+  const [evvData, setEvvData] = useState(null);
+  const [authSummary, setAuthSummary] = useState(null);
+  const [authorizations, setAuthorizations] = useState([]);
+  const [ediBatches, setEdiBatches] = useState([]);
+  const [remittanceBatches, setRemittanceBatches] = useState([]);
+  const [payerSummary, setPayerSummary] = useState([]);
+  const [payrollPreview, setPayrollPreview] = useState(null);
+  const [clients, setClients] = useState([]);
+  const [payers, setPayers] = useState([]);
+  const [serviceCodes, setServiceCodes] = useState([]);
+  const [openIssues, setOpenIssues] = useState([]);
+  const [loading, setLoading] = useState({});
+  const [selected, setSelected] = useState([]);
+
+  const headers = { 'Content-Type':'application/json', Authorization:`Bearer ${token}` };
+  const get = useCallback(async (url) => {
+    try {
+      const r = await fetch(`${API_BASE_URL}${url}`,{headers:{Authorization:`Bearer ${token}`}});
+      if (r.status === 429) { console.warn('[Rate limited]', url); return null; }
+      return r.ok ? r.json() : null;
+    } catch(e) { return null; }
+  }, [token]);
+
+  // Payroll form
+  const [payPeriod, setPayPeriod] = useState({ start: '', end: '' });
+
+  // Authorization form
+  const [authForm, setAuthForm] = useState({ clientId:'', payerId:'', authNumber:'', procedureCode:'T1019', authorizedUnits:'', startDate:'', endDate:'', notes:'' });
+  const [showAuthForm, setShowAuthForm] = useState(false);
+
+  // Remittance upload
+  const [uploadState, setUploadState] = useState(null); // null | 'uploading' | result
+  const [remitForm, setRemitForm] = useState({ payerId:'', payerName:'', checkNumber:'', checkDate:'', paymentDate:'', totalAmount:'', notes:'', lineItems:[] });
+  const fileRef = useRef(null);
+
+  // Stagger requests to avoid rate limiting on Render free tier
+  useEffect(() => {
+    const delay = (ms) => new Promise(r => setTimeout(r, ms));
+    const loadCore = async () => {
+      // Batch 1: small config calls
+      await Promise.all([
+        get('/api/sandata/config').then(d => d && setSandataConfig(d)),
+        get('/api/gusto/config').then(d => d && setGustoConfig(d)),
+      ]);
+      await delay(400);
+      // Batch 2: summary data
+      await Promise.all([
+        get('/api/authorizations/summary').then(d => d && setAuthSummary(d)),
+        get('/api/remittance/payer-summary').then(d => d && setPayerSummary(d)).catch(() => {}),
+      ]);
+      await delay(400);
+      // Batch 3: list data
+      await Promise.all([
+        get('/api/clients').then(d => d && setClients(d)),
+        get('/api/remittance/payers').then(d => d && setPayers(d)),
+      ]);
+      await delay(400);
+      // Batch 4: integration-specific (graceful fail until migration_v4.sql runs)
+      get('/api/sandata/status').then(d => d && setEvvData(d)).catch(() => {});
+      get('/api/failsafe/issues').then(d => d && setOpenIssues(d)).catch(() => {});
+      get('/api/edi/service-codes').then(d => d && setServiceCodes(d)).catch(() => {});
+    };
+    loadCore();
+  }, []);
+
+  useEffect(() => {
+    const delay = (ms) => new Promise(r => setTimeout(r, ms));
+    const loadTab = async () => {
+      await delay(300);
+      if (tab === 'authorizations') get('/api/authorizations').then(d => d && setAuthorizations(d)).catch(() => {});
+      if (tab === 'claims') get('/api/edi/batches').then(d => d && setEdiBatches(d)).catch(() => {});
+      if (tab === 'remittance') get('/api/remittance/batches').then(d => d && setRemittanceBatches(d)).catch(() => {});
+    };
+    loadTab();
+  }, [tab]);
+
+  const setLoad = (key, val) => setLoading(p => ({...p,[key]:val}));
+
+  // ── Overview Tab ─────────────────────────────────────────────────────────────
+  const renderOverview = () => {
+    const totalOutstanding = payerSummary.reduce((s,p) => s+parseFloat(p.total_outstanding||0),0);
+    const totalBilled = payerSummary.reduce((s,p) => s+parseFloat(p.total_billed||0),0);
+    const totalReceived = payerSummary.reduce((s,p) => s+parseFloat(p.total_received||0),0);
+
+    return (
+      <div style={{display:'grid',gap:'1rem'}}>
+        {/* Integration status row */}
+        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit,minmax(200px,1fr))',gap:'0.75rem'}}>
+          {/* Sandata */}
+          <Card style={{borderLeft:`4px solid ${sandataConfig?.isConfigured?'#2ABBA7':'#F59E0B'}`}}>
+            <div style={{fontWeight:'700',fontSize:'0.85rem',marginBottom:'0.4rem'}}>🏠 Sandata EVV</div>
+            {sandataConfig?.isConfigured
+              ? <><Badge status="active" label="✓ Connected"/><p style={{fontSize:'0.78rem',color:'#6B7280',margin:'0.4rem 0 0'}}>{evvData?.summary?.accepted||0} accepted · {evvData?.summary?.exceptions||0} exceptions</p></>
+              : <><Badge status="pending" label="⚠ Not Configured"/><p style={{fontSize:'0.75rem',color:'#92400E',margin:'0.4rem 0 0'}}>Call (833) 931-2035 to get credentials</p></>
+            }
+          </Card>
+          {/* Gusto */}
+          <Card style={{borderLeft:`4px solid ${gustoConfig?.isConfigured?'#2ABBA7':'#6B7280'}`}}>
+            <div style={{fontWeight:'700',fontSize:'0.85rem',marginBottom:'0.4rem'}}>💰 Gusto Payroll</div>
+            {gustoConfig?.isConfigured
+              ? <Badge status="active" label="✓ Connected"/>
+              : <><Badge status="unmatched" label="Not Connected"/><p style={{fontSize:'0.75rem',color:'#6B7280',margin:'0.4rem 0 0'}}>Add GUSTO_API_KEY to connect</p></>
+            }
+          </Card>
+          {/* Open issues */}
+          <Card style={{borderLeft:`4px solid ${openIssues.filter(i=>i.status==='fail').length>0?'#EF4444':'#2ABBA7'}`}}>
+            <div style={{fontWeight:'700',fontSize:'0.85rem',marginBottom:'0.4rem'}}>🛡️ Failsafe</div>
+            {openIssues.filter(i=>i.status==='fail').length > 0
+              ? <><Badge status="exception" label={`${openIssues.filter(i=>i.status==='fail').length} Blocking Issues`}/><p style={{fontSize:'0.75rem',color:'#991B1B',margin:'0.4rem 0 0'}}>Fix before submitting claims</p></>
+              : <Badge status="active" label="✓ All Clear"/>
+            }
+          </Card>
+          {/* Authorizations */}
+          <Card style={{borderLeft:`4px solid ${parseInt(authSummary?.expiring_soon||0)+parseInt(authSummary?.expired||0)>0?'#F59E0B':'#2ABBA7'}`}}>
+            <div style={{fontWeight:'700',fontSize:'0.85rem',marginBottom:'0.4rem'}}>📋 Authorizations</div>
+            <p style={{margin:0,fontSize:'1.1rem',fontWeight:'800',color:'#111827'}}>{authSummary?.active||0} Active</p>
+            <p style={{margin:'0.15rem 0 0',fontSize:'0.78rem',color:parseInt(authSummary?.expiring_soon||0)>0?'#92400E':'#6B7280'}}>
+              {authSummary?.expiring_soon||0} expiring soon · {authSummary?.low_units||0} low units
+            </p>
+          </Card>
+        </div>
+
+        {/* Payer AR summary */}
+        <Card>
+          <SectionHeader icon="💵" title="Accounts Receivable by Payer" sub="Outstanding balances and aging" />
+          <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:'0.75rem',marginBottom:'1rem'}}>
+            <div style={{padding:'0.75rem',background:'#F9FAFB',borderRadius:'10px',textAlign:'center'}}>
+              <div style={{fontSize:'1.4rem',fontWeight:'800',color:'#111827'}}>{fmt$(totalBilled)}</div>
+              <div style={{fontSize:'0.75rem',color:'#6B7280'}}>Total Billed</div>
+            </div>
+            <div style={{padding:'0.75rem',background:'#F0FDFB',borderRadius:'10px',textAlign:'center'}}>
+              <div style={{fontSize:'1.4rem',fontWeight:'800',color:'#2ABBA7'}}>{fmt$(totalReceived)}</div>
+              <div style={{fontSize:'0.75rem',color:'#6B7280'}}>Received</div>
+            </div>
+            <div style={{padding:'0.75rem',background:'#FEF3C7',borderRadius:'10px',textAlign:'center'}}>
+              <div style={{fontSize:'1.4rem',fontWeight:'800',color:'#92400E'}}>{fmt$(totalOutstanding)}</div>
+              <div style={{fontSize:'0.75rem',color:'#6B7280'}}>Outstanding</div>
+            </div>
+          </div>
+          <div style={{overflowX:'auto'}}>
+            <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+              <thead>
+                <tr style={{background:'#F9FAFB'}}>
+                  {['Payer','Billed','Paid','Outstanding','0-30d','31-60d','61-90d','90d+','Last Payment'].map(h=>(
+                    <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+                  ))}
+                </tr>
+              </thead>
+              <tbody>
+                {payerSummary.map(p => (
+                  <tr key={p.payer_id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'600',color:'#111827'}}>{p.payer_name}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#374151'}}>{fmt$(p.total_billed)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#2ABBA7'}}>{fmt$(p.total_paid)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'700',color:parseFloat(p.total_outstanding)>0?'#92400E':'#065F46'}}>{fmt$(p.total_outstanding)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#374151'}}>{fmt$(p.days_0_30)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:parseFloat(p.days_31_60)>0?'#92400E':'#374151'}}>{fmt$(p.days_31_60)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:parseFloat(p.days_61_90)>0?'#DC2626':'#374151'}}>{fmt$(p.days_61_90)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'700',color:parseFloat(p.over_90_days)>0?'#DC2626':'#374151'}}>{fmt$(p.over_90_days)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{fmtDate(p.last_payment_date)}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          </div>
+        </Card>
+
+        {/* Open issues */}
+        {openIssues.length > 0 && (
+          <Card style={{border:'1px solid #FCA5A5'}}>
+            <SectionHeader icon="⚠️" title="Open Validation Issues" sub="Fix these before generating claims" />
+            {openIssues.slice(0,10).map(issue => (
+              <div key={issue.id} style={{display:'flex',justifyContent:'space-between',alignItems:'center',padding:'0.6rem 0.75rem',marginBottom:'0.4rem',background:issue.status==='fail'?'#FEF2F2':'#FFFBEB',borderRadius:'8px',border:`1px solid ${issue.status==='fail'?'#FCA5A5':'#FCD34D'}`}}>
+                <div>
+                  <span style={{fontWeight:'700',fontSize:'0.82rem',color:issue.status==='fail'?'#991B1B':'#92400E'}}>{issue.validation_type}</span>
+                  <span style={{marginLeft:'0.5rem',fontSize:'0.82rem',color:'#374151'}}>{issue.message}</span>
+                </div>
+                <Btn small onClick={async()=>{await fetch(`${API_BASE_URL}/api/failsafe/issues/${issue.id}/resolve`,{method:'PUT',headers});setOpenIssues(p=>p.filter(i=>i.id!==issue.id));toast('Issue resolved','success');}}>Resolve</Btn>
+              </div>
+            ))}
+          </Card>
+        )}
+      </div>
+    );
+  };
+
+  // ── EVV Tab ──────────────────────────────────────────────────────────────────
+  const renderEVV = () => (
+    <div style={{display:'grid',gap:'1rem'}}>
+      {!sandataConfig?.isConfigured && (
+        <Card style={{background:'#FFFBEB',border:'1px solid #FCD34D'}}>
+          <h4 style={{margin:'0 0 0.5rem',color:'#92400E'}}>⚠️ Sandata Credentials Not Configured</h4>
+          <p style={{margin:'0 0 0.5rem',fontSize:'0.875rem',color:'#92400E'}}>EVV records are being created automatically when caregivers clock out, but visits can't be submitted to Sandata yet.</p>
+          <div style={{fontSize:'0.82rem',color:'#78350F',display:'grid',gap:'0.2rem'}}>
+            <div><strong>Step 1:</strong> Call Wisconsin EVV Customer Care: <strong>(833) 931-2035</strong></div>
+            <div><strong>Step 2:</strong> Request Alt-EVV API credentials for your agency</div>
+            <div><strong>Step 3:</strong> In Render → Environment → add: SANDATA_USERNAME, SANDATA_PASSWORD, SANDATA_ACCOUNT_ID</div>
+          </div>
+        </Card>
+      )}
+
+      {/* Summary cards */}
+      {evvData && (
+        <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit,minmax(120px,1fr))',gap:'0.75rem'}}>
+          {[
+            {label:'Total',val:evvData.summary?.total||0,color:'#374151'},
+            {label:'Verified',val:evvData.summary?.verified||0,color:'#2ABBA7'},
+            {label:'Ready to Submit',val:evvData.summary?.ready||0,color:'#6366F1'},
+            {label:'Submitted',val:evvData.summary?.submitted||0,color:'#2563EB'},
+            {label:'Accepted',val:evvData.summary?.accepted||0,color:'#16A34A'},
+            {label:'Exceptions',val:evvData.summary?.exceptions||0,color:'#DC2626'},
+          ].map(s=>(
+            <div key={s.label} style={{padding:'0.75rem',background:'#F9FAFB',borderRadius:'10px',textAlign:'center'}}>
+              <div style={{fontSize:'1.5rem',fontWeight:'800',color:s.color}}>{s.val}</div>
+              <div style={{fontSize:'0.72rem',color:'#6B7280'}}>{s.label}</div>
+            </div>
+          ))}
+        </div>
+      )}
+
+      {/* EVV table */}
+      <Card>
+        <SectionHeader icon="🏠" title="EVV Visits" sub="Last 7 days"
+          action={
+            <Btn disabled={!sandataConfig?.isConfigured||selected.length===0}
+              onClick={async()=>{
+                setLoad('submit',true);
+                const r = await fetch(`${API_BASE_URL}/api/sandata/submit`,{method:'POST',headers,body:JSON.stringify({visitIds:selected})});
+                const d = await r.json();
+                if(r.ok){toast(`Submitted ${d.submitted} visits to Sandata`,'success');setSelected([]);}
+                else toast(d.error||'Submission failed','error');
+                setLoad('submit',false);
+              }}>
+              {loading.submit?'Submitting...':'📤 Submit to Sandata'}{selected.length>0?` (${selected.length})`:''}
+            </Btn>
+          }
+        />
+        <div style={{overflowX:'auto'}}>
+          <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+            <thead>
+              <tr style={{background:'#F9FAFB'}}>
+                <th style={{padding:'0.5rem',width:'32px'}}><input type="checkbox" onChange={e=>{if(e.target.checked)setSelected((evvData?.visits||[]).filter(v=>v.sandata_status==='ready').map(v=>v.id));else setSelected([]);}}/></th>
+                {['Date','Client','Caregiver','Code','Units','GPS','EVV Status','Sandata'].map(h=>(
+                  <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+                ))}
+              </tr>
+            </thead>
+            <tbody>
+              {(evvData?.visits||[]).map(v=>(
+                <tr key={v.id} style={{borderBottom:'1px solid #F3F4F6',background:selected.includes(v.id)?'#F0FDFB':'#fff'}}>
+                  <td style={{padding:'0.5rem',textAlign:'center'}}>
+                    {v.sandata_status==='ready'&&<input type="checkbox" checked={selected.includes(v.id)} onChange={e=>setSelected(p=>e.target.checked?[...p,v.id]:p.filter(id=>id!==v.id))}/>}
+                  </td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{fmtDate(v.service_date)}</td>
+                  <td style={{padding:'0.5rem 0.75rem',fontWeight:'600'}}>{v.client_first} {v.client_last}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{v.cg_first} {v.cg_last}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}><code style={{fontSize:'0.78rem',background:'#F3F4F6',padding:'1px 5px',borderRadius:'4px'}}>{v.service_code}{v.modifier?` ${v.modifier}`:''}</code></td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{fmtNum(v.units_of_service)}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}>{v.gps_in_lat?'✅ In':'⚠️'} {v.gps_out_lat?'/ Out':''}</td>
+                  <td style={{padding:'0.5rem 0.75rem'}}><Badge status={v.is_verified?'active':'pending'} label={v.is_verified?'Verified':'Pending'}/></td>
+                  <td style={{padding:'0.5rem 0.75rem'}}><Badge status={v.sandata_status} label={v.sandata_status}/></td>
+                </tr>
+              ))}
+              {(!evvData?.visits||evvData.visits.length===0)&&<tr><td colSpan="9" style={{padding:'2rem',textAlign:'center',color:'#9CA3AF'}}>No EVV visits in this period</td></tr>}
+            </tbody>
+          </table>
+        </div>
+      </Card>
+    </div>
+  );
+
+  // ── Authorizations Tab ────────────────────────────────────────────────────────
+  const renderAuthorizations = () => (
+    <div style={{display:'grid',gap:'1rem'}}>
+      <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit,minmax(130px,1fr))',gap:'0.75rem'}}>
+        {[
+          {label:'Active',val:authSummary?.active||0,color:'#2ABBA7'},
+          {label:'Expiring Soon',val:authSummary?.expiring_soon||0,color:'#F59E0B'},
+          {label:'Low Units',val:authSummary?.low_units||0,color:'#EF4444'},
+          {label:'Exhausted',val:authSummary?.exhausted||0,color:'#DC2626'},
+          {label:'Expired',val:authSummary?.expired||0,color:'#6B7280'},
+        ].map(s=>(
+          <div key={s.label} style={{padding:'0.75rem',background:'#F9FAFB',borderRadius:'10px',textAlign:'center'}}>
+            <div style={{fontSize:'1.5rem',fontWeight:'800',color:s.color}}>{s.val}</div>
+            <div style={{fontSize:'0.72rem',color:'#6B7280'}}>{s.label}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* MIDAS import info */}
+      <Card style={{background:'#EEF2FF',border:'1px solid #C7D2FE'}}>
+        <div style={{display:'flex',gap:'0.75rem',alignItems:'flex-start'}}>
+          <span style={{fontSize:'1.5rem'}}>📥</span>
+          <div>
+            <p style={{margin:'0 0 0.25rem',fontWeight:'700',color:'#3730A3',fontSize:'0.875rem'}}>Import from MIDAS</p>
+            <p style={{margin:'0 0 0.5rem',fontSize:'0.82rem',color:'#4338CA'}}>Export authorizations from the MIDAS portal as CSV, then import here. Expected columns: MemberID, AuthNumber, ServiceCode, AuthorizedUnits, StartDate, EndDate</p>
+            <label style={{padding:'0.4rem 0.875rem',background:'#6366F1',color:'#fff',borderRadius:'8px',cursor:'pointer',fontWeight:'700',fontSize:'0.82rem'}}>
+              📂 Import MIDAS CSV
+              <input type="file" accept=".csv" style={{display:'none'}} onChange={async e=>{
+                const file = e.target.files[0]; if(!file) return;
+                const text = await file.text();
+                const lines = text.split('\n'); const headers = lines[0].split(',').map(h=>h.trim());
+                const rows = lines.slice(1).filter(l=>l.trim()).map(l=>{
+                  const vals = l.split(','); const obj={};
+                  headers.forEach((h,i)=>obj[h]=vals[i]?.trim()||''); return obj;
+                });
+                const r = await fetch(`${API_BASE_URL}/api/authorizations/import-csv`,{method:'POST',headers,body:JSON.stringify({rows})});
+                const d = await r.json();
+                if(r.ok){toast(`Imported ${d.imported} authorizations`,'success');get('/api/authorizations').then(d=>d&&setAuthorizations(d));}
+                else toast(d.error||'Import failed','error');
+              }}/>
+            </label>
+          </div>
+        </div>
+      </Card>
+
+      <Card>
+        <SectionHeader icon="📋" title="Authorization Tracker" sub="MIDAS authorizations and burn-down"
+          action={<Btn onClick={()=>setShowAuthForm(p=>!p)}>{showAuthForm?'Cancel':'+ Add Auth'}</Btn>}
+        />
+
+        {showAuthForm && (
+          <div style={{background:'#F9FAFB',borderRadius:'10px',padding:'1rem',marginBottom:'1rem',display:'grid',gridTemplateColumns:'1fr 1fr',gap:'0.75rem'}}>
+            <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Client *</label>
+              <select value={authForm.clientId} onChange={e=>setAuthForm(p=>({...p,clientId:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}>
+                <option value="">Select client...</option>
+                {clients.map(c=><option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </div>
+            <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Payer</label>
+              <select value={authForm.payerId} onChange={e=>setAuthForm(p=>({...p,payerId:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}>
+                <option value="">Select payer...</option>
+                {payers.map(p=><option key={p.id} value={p.id}>{p.name}</option>)}
+              </select>
+            </div>
+            <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Auth Number</label>
+              <input value={authForm.authNumber} onChange={e=>setAuthForm(p=>({...p,authNumber:e.target.value}))} placeholder="e.g. 12345678" style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+            </div>
+            <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Service Code</label>
+              <select value={authForm.procedureCode} onChange={e=>setAuthForm(p=>({...p,procedureCode:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}>
+                {serviceCodes.map(sc=><option key={sc.id} value={sc.code}>{sc.code}{sc.modifier1?` ${sc.modifier1}`:''} — {sc.description}</option>)}
+              </select>
+            </div>
+            <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Authorized Units *</label>
+              <input type="number" value={authForm.authorizedUnits} onChange={e=>setAuthForm(p=>({...p,authorizedUnits:e.target.value}))} placeholder="e.g. 312" style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+            </div>
+            <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'0.5rem'}}>
+              <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Start Date *</label>
+                <input type="date" value={authForm.startDate} onChange={e=>setAuthForm(p=>({...p,startDate:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+              <div><label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>End Date *</label>
+                <input type="date" value={authForm.endDate} onChange={e=>setAuthForm(p=>({...p,endDate:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+            </div>
+            <div style={{gridColumn:'span 2'}}>
+              <Btn onClick={async()=>{
+                const r = await fetch(`${API_BASE_URL}/api/authorizations`,{method:'POST',headers,body:JSON.stringify(authForm)});
+                const d = await r.json();
+                if(r.ok){toast('Authorization saved','success');setShowAuthForm(false);setAuthForm({clientId:'',payerId:'',authNumber:'',procedureCode:'T1019',authorizedUnits:'',startDate:'',endDate:'',notes:''});get('/api/authorizations').then(d=>d&&setAuthorizations(d));}
+                else toast(d.error||'Failed','error');
+              }}>Save Authorization</Btn>
+            </div>
+          </div>
+        )}
+
+        <div style={{overflowX:'auto'}}>
+          <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+            <thead>
+              <tr style={{background:'#F9FAFB'}}>
+                {['Client','Payer','Auth #','Code','Units Used/Auth','Remaining','Expires','Status'].map(h=>(
+                  <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB',whiteSpace:'nowrap'}}>{h}</th>
+                ))}
+              </tr>
+            </thead>
+            <tbody>
+              {authorizations.map(a=>{
+                const pctUsed = a.authorized_units > 0 ? (a.used_units/a.authorized_units*100) : 0;
+                const barColor = pctUsed>90?'#EF4444':pctUsed>70?'#F59E0B':'#2ABBA7';
+                return (
+                  <tr key={a.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'600'}}>{a.client_first} {a.client_last}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{a.payer_name||'—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}><code style={{fontSize:'0.78rem',background:'#F3F4F6',padding:'1px 5px',borderRadius:'4px'}}>{a.auth_number||'—'}</code></td>
+                    <td style={{padding:'0.5rem 0.75rem'}}><code style={{fontSize:'0.78rem',background:'#F3F4F6',padding:'1px 5px',borderRadius:'4px'}}>{a.procedure_code}</code></td>
+                    <td style={{padding:'0.5rem 0.75rem',minWidth:'140px'}}>
+                      <div style={{display:'flex',alignItems:'center',gap:'0.5rem'}}>
+                        <div style={{flex:1,height:'6px',background:'#E5E7EB',borderRadius:'99px',overflow:'hidden'}}>
+                          <div style={{width:`${Math.min(pctUsed,100)}%`,height:'100%',background:barColor,borderRadius:'99px'}}/>
+                        </div>
+                        <span style={{fontSize:'0.72rem',color:'#374151',whiteSpace:'nowrap'}}>{fmtNum(a.used_units)}/{fmtNum(a.authorized_units)}</span>
+                      </div>
+                    </td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'700',color:parseFloat(a.remaining_units||0)<20?'#DC2626':'#374151'}}>{fmtNum(a.remaining_units)}</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:new Date(a.end_date)<new Date(Date.now()+30*86400000)?'#DC2626':'#374151'}}>{fmtDate(a.end_date)}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}><Badge status={a.health_status} label={a.health_status==='ok'?'Good':a.health_status==='low'?'⚠ Low':a.health_status==='expiring_soon'?'Expiring':a.health_status}/></td>
+                  </tr>
+                );
+              })}
+              {authorizations.length===0&&<tr><td colSpan="8" style={{padding:'2rem',textAlign:'center',color:'#9CA3AF'}}>No authorizations yet. Add one manually or import from MIDAS.</td></tr>}
+            </tbody>
+          </table>
+        </div>
+      </Card>
+    </div>
+  );
+
+  // ── Claims / EDI Tab ──────────────────────────────────────────────────────────
+  const renderClaims = () => (
+    <div style={{display:'grid',gap:'1rem'}}>
+      <Card>
+        <SectionHeader icon="📄" title="EDI 837 Claim Batches" sub="Generated claim files for WPS/clearinghouse"
+          action={
+            <div style={{display:'flex',gap:'0.5rem'}}>
+              <Btn outline onClick={()=>{toast('Select claims from Billing → Claims first, then generate','info')}}>ℹ️ How to Use</Btn>
+            </div>
+          }
+        />
+        <div style={{background:'#F0FDFB',border:'1px solid #A7F3D0',borderRadius:'10px',padding:'0.875rem 1rem',marginBottom:'1rem',fontSize:'0.82rem',color:'#065F46'}}>
+          <strong>Workflow:</strong> Billing → Claims → select approved claims → Generate EDI 837 → download .edi file → upload to WPS Provider Portal or your clearinghouse (Availity, Change Healthcare, etc.)
+        </div>
+        <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+          <thead>
+            <tr style={{background:'#F9FAFB'}}>
+              {['Batch #','Payer','Claims','Total Billed','Generated','Status',''].map(h=>(
+                <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+              ))}
+            </tr>
+          </thead>
+          <tbody>
+            {ediBatches.map(b=>(
+              <tr key={b.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                <td style={{padding:'0.5rem 0.75rem'}}><code style={{fontSize:'0.78rem',background:'#F3F4F6',padding:'1px 5px',borderRadius:'4px'}}>{b.batch_number}</code></td>
+                <td style={{padding:'0.5rem 0.75rem'}}>{b.payer_name||'—'}</td>
+                <td style={{padding:'0.5rem 0.75rem'}}>{b.claim_count}</td>
+                <td style={{padding:'0.5rem 0.75rem',fontWeight:'700'}}>{fmt$(b.total_billed)}</td>
+                <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{fmtDate(b.created_at)}</td>
+                <td style={{padding:'0.5rem 0.75rem'}}><Badge status={b.status} label={b.status}/></td>
+                <td style={{padding:'0.5rem 0.75rem'}}>
+                  <a href={`${API_BASE_URL}/api/edi/batch/${b.id}/download`} download style={{color:'#2ABBA7',fontWeight:'700',fontSize:'0.78rem',textDecoration:'none'}}>⬇ Download .edi</a>
+                </td>
+              </tr>
+            ))}
+            {ediBatches.length===0&&<tr><td colSpan="7" style={{padding:'2rem',textAlign:'center',color:'#9CA3AF'}}>No EDI batches yet</td></tr>}
+          </tbody>
+        </table>
+      </Card>
+
+      {/* Service codes reference */}
+      <Card>
+        <SectionHeader icon="🗂️" title="Service Code Reference" sub="Wisconsin Medicaid procedure codes in your system"/>
+        <div style={{overflowX:'auto'}}>
+          <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.78rem'}}>
+            <thead>
+              <tr style={{background:'#F9FAFB'}}>
+                {['Code','Modifier','Description','Category','Payer','Unit','EVV Required'].map(h=>(
+                  <th key={h} style={{padding:'0.4rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+                ))}
+              </tr>
+            </thead>
+            <tbody>
+              {serviceCodes.map(sc=>(
+                <tr key={sc.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                  <td style={{padding:'0.4rem 0.75rem'}}><code style={{fontWeight:'800',color:'#6366F1'}}>{sc.code}</code></td>
+                  <td style={{padding:'0.4rem 0.75rem'}}>{sc.modifier1||'—'}</td>
+                  <td style={{padding:'0.4rem 0.75rem',color:'#374151'}}>{sc.description}</td>
+                  <td style={{padding:'0.4rem 0.75rem',color:'#6B7280'}}>{sc.service_category}</td>
+                  <td style={{padding:'0.4rem 0.75rem'}}>{sc.payer_type==='all'?'All':sc.payer_type}</td>
+                  <td style={{padding:'0.4rem 0.75rem'}}>{sc.unit_type}</td>
+                  <td style={{padding:'0.4rem 0.75rem'}}>{sc.requires_evv?'✅ Yes':'No'}</td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        </div>
+      </Card>
+    </div>
+  );
+
+  // ── Remittance Tab ────────────────────────────────────────────────────────────
+  const renderRemittance = () => (
+    <div style={{display:'grid',gap:'1rem'}}>
+      <Card>
+        <SectionHeader icon="📷" title="Upload Remittance / Check"
+          sub="Photo or scan → OCR reads it → match to claims automatically"
+          action={<Btn onClick={()=>fileRef.current?.click()} disabled={uploadState==='uploading'}>📷 Upload Check / Statement</Btn>}
+        />
+        <input ref={fileRef} type="file" accept="image/*,application/pdf" style={{display:'none'}} onChange={async e=>{
+          const file = e.target.files[0]; if(!file) return;
+          setUploadState('uploading');
+          const fd = new FormData(); fd.append('remittance', file);
+          try {
+            const r = await fetch(`${API_BASE_URL}/api/remittance/upload`,{method:'POST',headers:{Authorization:`Bearer ${token}`},body:fd});
+            const d = await r.json();
+            if(r.ok){
+              setUploadState(d);
+              setRemitForm(p=>({...p,
+                payerName:d.ocr.payerName||'',checkNumber:d.ocr.checkNumber||'',
+                checkDate:d.ocr.checkDate||'',totalAmount:d.ocr.totalAmount||'',
+                payerId:d.suggestedPayer?.id||'',
+                lineItems:(d.ocr.lineItems||[]).map(li=>({...li,clientId:'',invoiceId:''}))
+              }));
+            } else { toast(d.error||'OCR failed','error'); setUploadState(null); }
+          } catch(e){ toast('Upload failed','error'); setUploadState(null); }
+        }}/>
+
+        {uploadState && uploadState !== 'uploading' && (
+          <div style={{background:'#F0FDFB',border:'1px solid #A7F3D0',borderRadius:'10px',padding:'1rem',marginBottom:'1rem'}}>
+            <p style={{margin:'0 0 0.75rem',fontWeight:'700',color:'#065F46'}}>✅ OCR Complete — Verify and Save</p>
+            <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'0.75rem'}}>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Payer Name *</label>
+                <input value={remitForm.payerName} onChange={e=>setRemitForm(p=>({...p,payerName:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Match to Existing Payer</label>
+                <select value={remitForm.payerId} onChange={e=>setRemitForm(p=>({...p,payerId:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}>
+                  <option value="">— Select payer —</option>
+                  {payers.map(p=><option key={p.id} value={p.id}>{p.name}</option>)}
+                </select>
+              </div>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Check Number</label>
+                <input value={remitForm.checkNumber} onChange={e=>setRemitForm(p=>({...p,checkNumber:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Total Amount *</label>
+                <input type="number" value={remitForm.totalAmount} onChange={e=>setRemitForm(p=>({...p,totalAmount:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Check Date</label>
+                <input type="date" value={remitForm.checkDate} onChange={e=>setRemitForm(p=>({...p,checkDate:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+              <div>
+                <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Payment Date</label>
+                <input type="date" value={remitForm.paymentDate} onChange={e=>setRemitForm(p=>({...p,paymentDate:e.target.value}))} style={{width:'100%',padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem',boxSizing:'border-box'}}/>
+              </div>
+            </div>
+            <div style={{marginTop:'0.75rem',display:'flex',gap:'0.5rem'}}>
+              <Btn onClick={async()=>{
+                const r = await fetch(`${API_BASE_URL}/api/remittance/batch`,{method:'POST',headers,body:JSON.stringify(remitForm)});
+                const d = await r.json();
+                if(r.ok){toast(`Saved. ${d.matchedCount} of ${d.totalItems} line items matched.`,'success');setUploadState(null);setRemitForm({payerId:'',payerName:'',checkNumber:'',checkDate:'',paymentDate:'',totalAmount:'',notes:'',lineItems:[]});get('/api/remittance/batches').then(d=>d&&setRemittanceBatches(d));}
+                else toast(d.error||'Save failed','error');
+              }}>💾 Save Remittance</Btn>
+              <Btn outline onClick={()=>setUploadState(null)}>Cancel</Btn>
+            </div>
+          </div>
+        )}
+
+        <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+          <thead>
+            <tr style={{background:'#F9FAFB'}}>
+              {['Payer','Check #','Date','Amount','Items Matched','Status'].map(h=>(
+                <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+              ))}
+            </tr>
+          </thead>
+          <tbody>
+            {remittanceBatches.map(b=>(
+              <tr key={b.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                <td style={{padding:'0.5rem 0.75rem',fontWeight:'600'}}>{b.payer_display_name||b.payer_name}</td>
+                <td style={{padding:'0.5rem 0.75rem'}}>{b.check_number||'—'}</td>
+                <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{fmtDate(b.payment_date)}</td>
+                <td style={{padding:'0.5rem 0.75rem',fontWeight:'700',color:'#2ABBA7'}}>{fmt$(b.total_amount)}</td>
+                <td style={{padding:'0.5rem 0.75rem'}}>{b.line_item_count||0}</td>
+                <td style={{padding:'0.5rem 0.75rem'}}><Badge status={b.status} label={b.status}/></td>
+              </tr>
+            ))}
+            {remittanceBatches.length===0&&<tr><td colSpan="6" style={{padding:'2rem',textAlign:'center',color:'#9CA3AF'}}>No remittances recorded yet. Upload a check to get started.</td></tr>}
+          </tbody>
+        </table>
+      </Card>
+    </div>
+  );
+
+  // ── Payroll Tab ───────────────────────────────────────────────────────────────
+  const renderPayroll = () => (
+    <div style={{display:'grid',gap:'1rem'}}>
+      {!gustoConfig?.isConfigured && (
+        <Card style={{background:'#F9FAFB',border:'1px solid #E5E7EB'}}>
+          <h4 style={{margin:'0 0 0.5rem',color:'#374151'}}>💰 Gusto Not Connected</h4>
+          <p style={{margin:'0 0 0.75rem',fontSize:'0.875rem',color:'#6B7280'}}>You can still export hours as CSV for manual payroll. To connect Gusto:</p>
+          <div style={{fontSize:'0.82rem',color:'#374151',display:'grid',gap:'0.25rem',marginBottom:'0.75rem'}}>
+            <div>1. Sign up at <strong>gusto.com</strong> — starts at $40/mo + $6/caregiver/mo</div>
+            <div>2. Settings → Integrations → API → create API key</div>
+            <div>3. Add <code style={{background:'#E5E7EB',padding:'1px 4px',borderRadius:'3px'}}>GUSTO_API_KEY</code> and <code style={{background:'#E5E7EB',padding:'1px 4px',borderRadius:'3px'}}>GUSTO_COMPANY_ID</code> to Render env vars</div>
+          </div>
+        </Card>
+      )}
+
+      <Card>
+        <SectionHeader icon="💰" title="Payroll Export" sub="Based on verified clock-in/out records"/>
+        <div style={{display:'flex',gap:'0.75rem',alignItems:'flex-end',marginBottom:'1rem',flexWrap:'wrap'}}>
+          <div>
+            <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Pay Period Start</label>
+            <input type="date" value={payPeriod.start} onChange={e=>setPayPeriod(p=>({...p,start:e.target.value}))} style={{padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}/>
+          </div>
+          <div>
+            <label style={{display:'block',fontWeight:'600',fontSize:'0.78rem',marginBottom:'0.3rem'}}>Pay Period End</label>
+            <input type="date" value={payPeriod.end} onChange={e=>setPayPeriod(p=>({...p,end:e.target.value}))} style={{padding:'0.5rem',border:'1px solid #D1D5DB',borderRadius:'6px',fontSize:'0.85rem'}}/>
+          </div>
+          <Btn disabled={!payPeriod.start||!payPeriod.end||loading.preview} onClick={async()=>{
+            setLoad('preview',true);
+            const d = await get(`/api/gusto/preview?startDate=${payPeriod.start}&endDate=${payPeriod.end}`);
+            if(d) setPayrollPreview(d); else toast('Could not load preview','error');
+            setLoad('preview',false);
+          }}>{loading.preview?'Loading...':'Preview'}</Btn>
+          {payrollPreview && <>
+            <a href={`${API_BASE_URL}/api/gusto/export-csv?startDate=${payPeriod.start}&endDate=${payPeriod.end}`} download style={{textDecoration:'none'}}>
+              <Btn outline>⬇ CSV Export</Btn>
+            </a>
+            {gustoConfig?.isConfigured && (
+              <Btn color="#7C3AED" disabled={loading.gusto} onClick={async()=>{
+                setLoad('gusto',true);
+                const r = await fetch(`${API_BASE_URL}/api/gusto/export`,{method:'POST',headers,body:JSON.stringify({startDate:payPeriod.start,endDate:payPeriod.end})});
+                const d = await r.json();
+                if(r.ok) toast(`Exported ${d.exported} caregivers to Gusto`,'success');
+                else toast(d.error||'Export failed','error');
+                setLoad('gusto',false);
+              }}>{loading.gusto?'Exporting...':'🚀 Send to Gusto'}</Btn>
+            )}
+          </>}
+        </div>
+
+        {payrollPreview && (
+          <>
+            <div style={{display:'grid',gridTemplateColumns:'repeat(3,1fr)',gap:'0.75rem',marginBottom:'1rem'}}>
+              <div style={{padding:'0.75rem',background:'#F9FAFB',borderRadius:'10px',textAlign:'center'}}>
+                <div style={{fontSize:'1.3rem',fontWeight:'800'}}>{payrollPreview.totals.employees}</div>
+                <div style={{fontSize:'0.72rem',color:'#6B7280'}}>Caregivers</div>
+              </div>
+              <div style={{padding:'0.75rem',background:'#F9FAFB',borderRadius:'10px',textAlign:'center'}}>
+                <div style={{fontSize:'1.3rem',fontWeight:'800'}}>{payrollPreview.totals.totalHours}h</div>
+                <div style={{fontSize:'0.72rem',color:'#6B7280'}}>Total Hours</div>
+              </div>
+              <div style={{padding:'0.75rem',background:'#F0FDFB',borderRadius:'10px',textAlign:'center'}}>
+                <div style={{fontSize:'1.3rem',fontWeight:'800',color:'#2ABBA7'}}>{fmt$(payrollPreview.totals.totalGross)}</div>
+                <div style={{fontSize:'0.72rem',color:'#6B7280'}}>Gross Pay</div>
+              </div>
+            </div>
+            {payrollPreview.totals.unmapped > 0 && (
+              <div style={{background:'#FEF3C7',border:'1px solid #FCD34D',borderRadius:'8px',padding:'0.75rem',marginBottom:'1rem',fontSize:'0.82rem',color:'#92400E'}}>
+                ⚠️ {payrollPreview.totals.unmapped} caregiver(s) not mapped to Gusto — CSV export still works, Gusto sync will skip them.
+              </div>
+            )}
+            <table style={{width:'100%',borderCollapse:'collapse',fontSize:'0.82rem'}}>
+              <thead>
+                <tr style={{background:'#F9FAFB'}}>
+                  {['Caregiver','Hours','Weekend Hrs','Rate','Gross Pay','Gusto'].map(h=>(
+                    <th key={h} style={{padding:'0.5rem 0.75rem',textAlign:'left',fontWeight:'700',color:'#374151',borderBottom:'1px solid #E5E7EB'}}>{h}</th>
+                  ))}
+                </tr>
+              </thead>
+              <tbody>
+                {payrollPreview.preview.map(r=>(
+                  <tr key={r.id} style={{borderBottom:'1px solid #F3F4F6'}}>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'600'}}>{r.first_name} {r.last_name}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>{r.total_hours}h</td>
+                    <td style={{padding:'0.5rem 0.75rem',color:'#6B7280'}}>{r.weekend_hours}h</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>{r.hourly_rate?fmt$(r.hourly_rate)+'/hr':'—'}</td>
+                    <td style={{padding:'0.5rem 0.75rem',fontWeight:'700',color:'#2ABBA7'}}>{fmt$(r.gross_pay)}</td>
+                    <td style={{padding:'0.5rem 0.75rem'}}>{r.gusto_mapped?<Badge status="active" label="✓ Mapped"/>:<Badge status="pending" label="Not Mapped"/>}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          </>
+        )}
+      </Card>
+    </div>
+  );
+
+  return (
+    <div style={{maxWidth:'1100px'}}>
+      <div style={{marginBottom:'1.25rem'}}>
+        <h2 style={{margin:'0 0 0.25rem',fontSize:'1.3rem',fontWeight:'800',color:'#111827'}}>🔌 Integrations Hub</h2>
+        <p style={{margin:0,fontSize:'0.82rem',color:'#6B7280'}}>EVV · MIDAS Authorizations · EDI 837 Claims · Remittance · Payroll</p>
+      </div>
+
+      {/* Tabs */}
+      <div style={{display:'flex',gap:'0.25rem',marginBottom:'1.25rem',borderBottom:'2px solid #E5E7EB',paddingBottom:'0'}}>
+        {TABS.map(t=>(
+          <button key={t.id} onClick={()=>setTab(t.id)} style={{
+            padding:'0.6rem 1rem', border:'none', background:'none', cursor:'pointer',
+            fontWeight:tab===t.id?'800':'500', fontSize:'0.85rem',
+            color:tab===t.id?'#2ABBA7':'#6B7280',
+            borderBottom:tab===t.id?'2px solid #2ABBA7':'2px solid transparent',
+            marginBottom:'-2px', whiteSpace:'nowrap', transition:'all 0.15s'
+          }}>{t.label}</button>
+        ))}
+      </div>
+
+      {tab==='overview' && renderOverview()}
+      {tab==='evv' && renderEVV()}
+      {tab==='authorizations' && renderAuthorizations()}
+      {tab==='claims' && renderClaims()}
+      {tab==='remittance' && renderRemittance()}
+      {tab==='payroll' && renderPayroll()}
+    </div>
+  );
+};
+
+export default IntegrationsHub;
diff --git a/templates/crm-homecare/frontend/src/components/admin/LoginActivity.jsx b/templates/crm-homecare/frontend/src/components/admin/LoginActivity.jsx
new file mode 100644
index 0000000..a347e05
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/LoginActivity.jsx
@@ -0,0 +1,258 @@
+// src/components/admin/LoginActivity.jsx
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+// Parses a user-agent string into a human-readable device/browser summary
+function parseUserAgent(ua) {
+  if (!ua) return '—';
+  let browser = 'Unknown browser';
+  let os = '';
+
+  if (/Chrome\//.test(ua) && !/Chromium|Edg/.test(ua)) browser = 'Chrome';
+  else if (/Firefox\//.test(ua)) browser = 'Firefox';
+  else if (/Safari\//.test(ua) && !/Chrome/.test(ua)) browser = 'Safari';
+  else if (/Edg\//.test(ua)) browser = 'Edge';
+
+  if (/iPhone/.test(ua)) os = 'iPhone';
+  else if (/iPad/.test(ua)) os = 'iPad';
+  else if (/Android/.test(ua)) os = 'Android';
+  else if (/Windows NT/.test(ua)) os = 'Windows';
+  else if (/Mac OS X/.test(ua)) os = 'macOS';
+  else if (/Linux/.test(ua)) os = 'Linux';
+
+  return os ? `${browser} / ${os}` : browser;
+}
+
+function timeAgo(dateStr) {
+  const diff = Date.now() - new Date(dateStr).getTime();
+  const mins = Math.floor(diff / 60000);
+  if (mins < 1) return 'just now';
+  if (mins < 60) return `${mins}m ago`;
+  const hrs = Math.floor(mins / 60);
+  if (hrs < 24) return `${hrs}h ago`;
+  const days = Math.floor(hrs / 24);
+  return `${days}d ago`;
+}
+
+const FAIL_LABELS = {
+  user_not_found: 'Unknown email',
+  invalid_password: 'Wrong password',
+  account_inactive: 'Inactive account',
+};
+
+const LoginActivity = ({ token }) => {
+  const [activity, setActivity] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [pagination, setPagination] = useState({ total: 0, page: 1, pages: 1 });
+  const [filters, setFilters] = useState({ email: '', success: '' });
+  const [appliedFilters, setAppliedFilters] = useState({ email: '', success: '' });
+
+  const loadActivity = useCallback(async (page = 1, filt = appliedFilters) => {
+    setLoading(true);
+    try {
+      const params = new URLSearchParams({ page, limit: 50 });
+      if (filt.email) params.set('email', filt.email);
+      if (filt.success !== '') params.set('success', filt.success);
+
+      const res = await fetch(`${API_BASE_URL}/api/auth/login-activity?${params}`, {
+        headers: { Authorization: `Bearer ${token}` },
+      });
+      const data = await res.json();
+      if (!res.ok) throw new Error(data.error || 'Failed to load');
+      setActivity(data.activity || []);
+      setPagination(data.pagination || { total: 0, page: 1, pages: 1 });
+    } catch (err) {
+      console.error('Login activity error:', err);
+    } finally {
+      setLoading(false);
+    }
+  }, [token, appliedFilters]);
+
+  useEffect(() => { loadActivity(1); }, []);
+
+  const handleSearch = () => {
+    setAppliedFilters({ ...filters });
+    loadActivity(1, filters);
+  };
+
+  const handleReset = () => {
+    const reset = { email: '', success: '' };
+    setFilters(reset);
+    setAppliedFilters(reset);
+    loadActivity(1, reset);
+  };
+
+  // Stats derived from current page
+  const total = pagination.total;
+  const failedCount = activity.filter(a => !a.success).length;
+  const uniqueIPs = new Set(activity.map(a => a.ip_address).filter(Boolean)).size;
+
+  return (
+    <div className="container">
+      <div className="page-header">
+        <div>
+          <h2>Login Activity</h2>
+          <p style={{ color: 'var(--color-text-light)', margin: 0 }}>
+            All login attempts — who, when, where, and whether it worked
+          </p>
+        </div>
+        <button className="btn btn-secondary btn-sm" onClick={() => loadActivity(pagination.page)}>
+          ↻ Refresh
+        </button>
+      </div>
+
+      {/* Summary stats */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(160px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
+        {[
+          { label: 'Total Records', value: total, color: '#3B82F6' },
+          { label: 'This Page — Failed', value: failedCount, color: '#EF4444' },
+          { label: 'This Page — Succeeded', value: activity.length - failedCount, color: '#10B981' },
+          { label: 'Unique IPs', value: uniqueIPs, color: '#8B5CF6' },
+        ].map(s => (
+          <div key={s.label} className="card" style={{ textAlign: 'center', padding: '1rem' }}>
+            <div style={{ fontSize: '1.75rem', fontWeight: 800, color: s.color }}>{s.value}</div>
+            <div style={{ fontSize: '0.75rem', color: 'var(--color-text-light)', marginTop: '0.25rem' }}>{s.label}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1.25rem' }}>
+        <div style={{ display: 'flex', gap: '0.75rem', flexWrap: 'wrap', alignItems: 'flex-end' }}>
+          <div className="form-group" style={{ margin: 0, flex: '1 1 200px' }}>
+            <label>Search email</label>
+            <input
+              type="text"
+              className="form-control"
+              placeholder="Filter by email..."
+              value={filters.email}
+              onChange={e => setFilters(f => ({ ...f, email: e.target.value }))}
+              onKeyDown={e => e.key === 'Enter' && handleSearch()}
+            />
+          </div>
+          <div className="form-group" style={{ margin: 0, minWidth: '160px' }}>
+            <label>Result</label>
+            <select
+              className="form-control"
+              value={filters.success}
+              onChange={e => setFilters(f => ({ ...f, success: e.target.value }))}
+            >
+              <option value="">All attempts</option>
+              <option value="true">✅ Successful only</option>
+              <option value="false">❌ Failed only</option>
+            </select>
+          </div>
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button className="btn btn-primary btn-sm" onClick={handleSearch}>Search</button>
+            <button className="btn btn-secondary btn-sm" onClick={handleReset}>Reset</button>
+          </div>
+        </div>
+      </div>
+
+      {/* Table */}
+      <div className="card" style={{ padding: 0, overflow: 'hidden' }}>
+        {loading ? (
+          <div style={{ padding: '3rem', textAlign: 'center' }}>
+            <div className="spinner" />
+          </div>
+        ) : activity.length === 0 ? (
+          <div style={{ padding: '3rem', textAlign: 'center', color: 'var(--color-text-light)' }}>
+            No login activity found.
+          </div>
+        ) : (
+          <div style={{ overflowX: 'auto' }}>
+            <table className="table" style={{ margin: 0, minWidth: '700px' }}>
+              <thead>
+                <tr>
+                  <th>Status</th>
+                  <th>Email</th>
+                  <th>Name / Role</th>
+                  <th>IP Address</th>
+                  <th>Device / Browser</th>
+                  <th>When</th>
+                  <th>Fail Reason</th>
+                </tr>
+              </thead>
+              <tbody>
+                {activity.map(row => {
+                  const name = row.first_name
+                    ? `${row.first_name} ${row.last_name}`
+                    : '—';
+                  return (
+                    <tr key={row.id} style={{ background: row.success ? undefined : '#FFF5F5' }}>
+                      <td>
+                        <span
+                          className="badge"
+                          style={{
+                            background: row.success ? '#D1FAE5' : '#FEE2E2',
+                            color: row.success ? '#065F46' : '#991B1B',
+                            fontWeight: 700,
+                          }}
+                        >
+                          {row.success ? '✅ Success' : '❌ Failed'}
+                        </span>
+                      </td>
+                      <td style={{ fontFamily: 'monospace', fontSize: '0.85rem' }}>{row.email}</td>
+                      <td>
+                        {name !== '—' ? (
+                          <div>
+                            <div style={{ fontWeight: 600 }}>{name}</div>
+                            <div style={{ fontSize: '0.75rem', color: 'var(--color-text-light)' }}>{row.role}</div>
+                          </div>
+                        ) : '—'}
+                      </td>
+                      <td style={{ fontFamily: 'monospace', fontSize: '0.82rem' }}>{row.ip_address || '—'}</td>
+                      <td style={{ fontSize: '0.82rem', color: 'var(--color-text-light)' }}>
+                        {parseUserAgent(row.user_agent)}
+                      </td>
+                      <td>
+                        <div style={{ fontWeight: 600, fontSize: '0.85rem' }}>
+                          {timeAgo(row.created_at)}
+                        </div>
+                        <div style={{ fontSize: '0.72rem', color: 'var(--color-text-light)' }}>
+                          {new Date(row.created_at).toLocaleString()}
+                        </div>
+                      </td>
+                      <td>
+                        {row.fail_reason ? (
+                          <span className="badge" style={{ background: '#FEF3C7', color: '#92400E' }}>
+                            {FAIL_LABELS[row.fail_reason] || row.fail_reason}
+                          </span>
+                        ) : '—'}
+                      </td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          </div>
+        )}
+      </div>
+
+      {/* Pagination */}
+      {pagination.pages > 1 && (
+        <div style={{ display: 'flex', justifyContent: 'center', gap: '0.5rem', marginTop: '1rem', alignItems: 'center' }}>
+          <button
+            className="btn btn-secondary btn-sm"
+            disabled={pagination.page <= 1}
+            onClick={() => loadActivity(pagination.page - 1)}
+          >
+            ← Prev
+          </button>
+          <span style={{ fontSize: '0.85rem', color: 'var(--color-text-light)' }}>
+            Page {pagination.page} of {pagination.pages} &nbsp;·&nbsp; {pagination.total} records
+          </span>
+          <button
+            className="btn btn-secondary btn-sm"
+            disabled={pagination.page >= pagination.pages}
+            onClick={() => loadActivity(pagination.page + 1)}
+          >
+            Next →
+          </button>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default LoginActivity;
diff --git a/templates/crm-homecare/frontend/src/components/admin/MedicationsManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/MedicationsManagement.jsx
new file mode 100644
index 0000000..b11cf88
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/MedicationsManagement.jsx
@@ -0,0 +1,645 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/MedicationsManagement.jsx
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const MedicationsManagement = ({ token }) => {
+  const [clients, setClients] = useState([]);
+  const [selectedClient, setSelectedClient] = useState('');
+  const [medications, setMedications] = useState([]);
+  const [logs, setLogs] = useState([]);
+  const [loading, setLoading] = useState(false);
+  const [activeTab, setActiveTab] = useState('medications');
+  const [showAddModal, setShowAddModal] = useState(false);
+  const [showLogModal, setShowLogModal] = useState(false);
+  const [editingMed, setEditingMed] = useState(null);
+
+  useEffect(() => {
+    const fn = (e) => { if (isDirty) { e.preventDefault(); e.returnValue = "You have unsaved changes. Leave anyway?"; return e.returnValue; } };
+    window.addEventListener("beforeunload", fn);
+    return () => window.removeEventListener("beforeunload", fn);
+  }, [isDirty]);
+
+  useEffect(() => {
+    loadClients();
+  }, []);
+
+  useEffect(() => {
+    if (selectedClient) {
+      loadMedications();
+      loadLogs();
+    }
+  }, [selectedClient]);
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data.filter(c => c.status === 'active') : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const loadMedications = async () => {
+    setLoading(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/medications/client/${selectedClient}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setMedications(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load medications:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadLogs = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/medications/logs/client/${selectedClient}?startDate=${getDateRange().start}&endDate=${getDateRange().end}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setLogs(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load logs:', error);
+    }
+  };
+
+  const getDateRange = () => {
+    const end = new Date();
+    const start = new Date();
+    start.setDate(start.getDate() - 30);
+    return {
+      start: start.toISOString().split('T')[0],
+      end: end.toISOString().split('T')[0]
+    };
+  };
+
+  const saveMedication = async (formData) => {
+    try {
+      const url = editingMed 
+        ? `${API_BASE_URL}/api/medications/${editingMed.id}`
+        : `${API_BASE_URL}/api/medications`;
+      
+      const res = await fetch(url, {
+        method: editingMed ? 'PUT' : 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ ...formData, clientId: selectedClient })
+      });
+      
+      if (res.ok) {
+        setShowAddModal(false);
+        setEditingMed(null);
+        loadMedications();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed to save: ' + error.message, 'error');
+    }
+  };
+
+  const discontinueMedication = async (medId) => {
+    const _cok = await confirm('Discontinue this medication?', {danger: true}); if (!_cok) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/medications/${medId}/discontinue`, {
+        method: 'PUT',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadMedications();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const logAdministration = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/medications/log`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ ...formData, clientId: selectedClient })
+      });
+      if (res.ok) {
+        setShowLogModal(false);
+        loadLogs();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getStatusBadge = (isActive) => (
+    <span style={{
+      padding: '2px 6px',
+      borderRadius: '4px',
+      fontSize: '0.75rem',
+      fontWeight: 'bold',
+      color: 'white',
+      backgroundColor: isActive ? '#4caf50' : '#9e9e9e'
+    }}>
+      {isActive ? 'ACTIVE' : 'DISCONTINUED'}
+    </span>
+  );
+
+  const getLogStatusBadge = (status) => {
+    const colors = {
+      administered: '#4caf50',
+      refused: '#ff9800',
+      missed: '#f44336',
+      held: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const activeMeds = medications.filter(m => m.is_active);
+  const inactiveMeds = medications.filter(m => !m.is_active);
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>💊 Medication Management</h2>
+      </div>
+
+      {/* Client Selector */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div className="form-group" style={{ margin: 0, maxWidth: '400px' }}>
+          <label>Select Client</label>
+          <select 
+            value={selectedClient} 
+            onChange={(e) => setSelectedClient(e.target.value)}
+          >
+            <option value="">-- Select a Client --</option>
+            {clients.map(c => (
+              <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+            ))}
+          </select>
+        </div>
+      </div>
+
+      {!selectedClient ? (
+        <div className="card">
+          <p style={{ color: '#666' }}>Select a client to view their medications.</p>
+        </div>
+      ) : (
+        <>
+          {/* Tabs */}
+          <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+            <button 
+              className={`btn ${activeTab === 'medications' ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setActiveTab('medications')}
+            >
+              Medications ({activeMeds.length})
+            </button>
+            <button 
+              className={`btn ${activeTab === 'logs' ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setActiveTab('logs')}
+            >
+              Administration Log ({logs.length})
+            </button>
+            <div style={{ marginLeft: 'auto' }}>
+              {activeTab === 'medications' && (
+                <button className="btn btn-primary" onClick={() => { setEditingMed(null); setShowAddModal(true); }}>
+                  + Add Medication
+                </button>
+              )}
+              {activeTab === 'logs' && (
+                <button className="btn btn-primary" onClick={() => setShowLogModal(true)}>
+                  + Log Administration
+                </button>
+              )}
+            </div>
+          </div>
+
+          {/* Medications Tab */}
+          {activeTab === 'medications' && (
+            <div className="card">
+              {loading ? (
+                <div className="loading"><div className="spinner"></div></div>
+              ) : activeMeds.length === 0 && inactiveMeds.length === 0 ? (
+                <p>No medications recorded for this client.</p>
+              ) : (
+                <>
+                  {activeMeds.length > 0 && (
+                    <>
+                      <h4 style={{ marginBottom: '1rem' }}>Active Medications</h4>
+                      <table className="table">
+                        <thead>
+                          <tr>
+                            <th>Medication</th>
+                            <th>Dosage</th>
+                            <th>Frequency</th>
+                            <th>Route</th>
+                            <th>Prescriber</th>
+                            <th>PRN</th>
+                            <th>Actions</th>
+                          </tr>
+                        </thead>
+                        <tbody>
+                          {activeMeds.map(med => (
+                            <tr key={med.id}>
+                              <td>
+                                <strong>{med.medication_name}</strong>
+                                {med.instructions && (
+                                  <div style={{ fontSize: '0.8rem', color: '#666' }}>{med.instructions}</div>
+                                )}
+                              </td>
+                              <td>{med.dosage || '-'}</td>
+                              <td>{med.frequency || '-'}</td>
+                              <td>{med.route || '-'}</td>
+                              <td>{med.prescriber || '-'}</td>
+                              <td>{med.is_prn ? '✓ Yes' : 'No'}</td>
+                              <td>
+                                <div style={{ display: 'flex', gap: '0.25rem' }}>
+                                  <button 
+                                    className="btn btn-sm btn-secondary"
+                                    onClick={() => { setEditingMed(med); setShowAddModal(true); }}
+                                  >
+                                    Edit
+                                  </button>
+                                  <button 
+                                    className="btn btn-sm btn-danger"
+                                    onClick={() => discontinueMedication(med.id)}
+                                  >
+                                    D/C
+                                  </button>
+                                </div>
+                              </td>
+                            </tr>
+                          ))}
+                        </tbody>
+                      </table>
+                    </>
+                  )}
+
+                  {inactiveMeds.length > 0 && (
+                    <>
+                      <h4 style={{ marginTop: '2rem', marginBottom: '1rem', color: '#666' }}>Discontinued Medications</h4>
+                      <table className="table">
+                        <thead>
+                          <tr>
+                            <th>Medication</th>
+                            <th>Dosage</th>
+                            <th>End Date</th>
+                            <th>Status</th>
+                          </tr>
+                        </thead>
+                        <tbody>
+                          {inactiveMeds.map(med => (
+                            <tr key={med.id} style={{ opacity: 0.6 }}>
+                              <td>{med.medication_name}</td>
+                              <td>{med.dosage || '-'}</td>
+                              <td>{med.end_date ? new Date(med.end_date).toLocaleDateString() : '-'}</td>
+                              <td>{getStatusBadge(false)}</td>
+                            </tr>
+                          ))}
+                        </tbody>
+                      </table>
+                    </>
+                  )}
+                </>
+              )}
+            </div>
+          )}
+
+          {/* Logs Tab */}
+          {activeTab === 'logs' && (
+            <div className="card">
+              {logs.length === 0 ? (
+                <p>No administration logs for the past 30 days.</p>
+              ) : (
+                <table className="table">
+                  <thead>
+                    <tr>
+                      <th>Date/Time</th>
+                      <th>Medication</th>
+                      <th>Dosage</th>
+                      <th>Status</th>
+                      <th>Caregiver</th>
+                      <th>Notes</th>
+                    </tr>
+                  </thead>
+                  <tbody>
+                    {logs.map(log => (
+                      <tr key={log.id}>
+                        <td>{new Date(log.administered_time).toLocaleString()}</td>
+                        <td><strong>{log.medication_name}</strong></td>
+                        <td>{log.dosage_given || log.dosage || '-'}</td>
+                        <td>{getLogStatusBadge(log.status)}</td>
+                        <td>{log.caregiver_first} {log.caregiver_last}</td>
+                        <td>{log.notes || '-'}</td>
+                      </tr>
+                    ))}
+                  </tbody>
+                </table>
+              )}
+            </div>
+          )}
+        </>
+      )}
+
+      {/* Add/Edit Medication Modal */}
+      {showAddModal && (
+        <div className="modal-overlay" onClick={() => setShowAddModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
+            <div className="modal-header">
+              <h3>{editingMed ? 'Edit Medication' : 'Add Medication'}</h3>
+              <button className="modal-close" onClick={() => setShowAddModal(false)}>×</button>
+            </div>
+            <MedicationForm 
+              medication={editingMed}
+              onSubmit={saveMedication}
+              onCancel={() => setShowAddModal(false)}
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Log Administration Modal */}
+      {showLogModal && (
+        <div className="modal-overlay" onClick={() => setShowLogModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Log Medication Administration</h3>
+              <button className="modal-close" onClick={() => setShowLogModal(false)}>×</button>
+            </div>
+            <LogForm 
+              medications={activeMeds}
+              onSubmit={logAdministration}
+              onCancel={() => setShowLogModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Medication Form Component
+const MedicationForm = ({ medication, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    medicationName: medication?.medication_name || '',
+    dosage: medication?.dosage || '',
+    frequency: medication?.frequency || '',
+    route: medication?.route || 'oral',
+    prescriber: medication?.prescriber || '',
+    pharmacy: medication?.pharmacy || '',
+    rxNumber: medication?.rx_number || '',
+    startDate: medication?.start_date?.split('T')[0] || '',
+    endDate: medication?.end_date?.split('T')[0] || '',
+    instructions: medication?.instructions || '',
+    sideEffects: medication?.side_effects || '',
+    isPrn: medication?.is_prn || false,
+    isActive: medication?.is_active ?? true
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.medicationName) {
+      toast('Medication name is required');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Medication Name *</label>
+        <input 
+          type="text"
+          value={formData.medicationName}
+          onChange={(e) => setFormData({ ...formData, medicationName: e.target.value })}
+          placeholder="e.g., Metformin"
+          required
+        />
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Dosage</label>
+          <input 
+            type="text"
+            value={formData.dosage}
+            onChange={(e) => setFormData({ ...formData, dosage: e.target.value })}
+            placeholder="e.g., 500mg"
+          />
+        </div>
+        <div className="form-group">
+          <label>Frequency</label>
+          <input 
+            type="text"
+            value={formData.frequency}
+            onChange={(e) => setFormData({ ...formData, frequency: e.target.value })}
+            placeholder="e.g., Twice daily"
+          />
+        </div>
+        <div className="form-group">
+          <label>Route</label>
+          <select 
+            value={formData.route}
+            onChange={(e) => setFormData({ ...formData, route: e.target.value })}
+          >
+            <option value="oral">Oral</option>
+            <option value="topical">Topical</option>
+            <option value="injection">Injection</option>
+            <option value="inhaled">Inhaled</option>
+            <option value="sublingual">Sublingual</option>
+            <option value="rectal">Rectal</option>
+            <option value="other">Other</option>
+          </select>
+        </div>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Prescriber</label>
+          <input 
+            type="text"
+            value={formData.prescriber}
+            onChange={(e) => setFormData({ ...formData, prescriber: e.target.value })}
+            placeholder="Dr. Smith"
+          />
+        </div>
+        <div className="form-group">
+          <label>Pharmacy</label>
+          <input 
+            type="text"
+            value={formData.pharmacy}
+            onChange={(e) => setFormData({ ...formData, pharmacy: e.target.value })}
+            placeholder="Walgreens"
+          />
+        </div>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>RX Number</label>
+          <input 
+            type="text"
+            value={formData.rxNumber}
+            onChange={(e) => setFormData({ ...formData, rxNumber: e.target.value })}
+          />
+        </div>
+        <div className="form-group">
+          <label>Start Date</label>
+          <input 
+            type="date"
+            value={formData.startDate}
+            onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}
+          />
+        </div>
+        <div className="form-group">
+          <label>End Date</label>
+          <input 
+            type="date"
+            value={formData.endDate}
+            onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Instructions</label>
+        <textarea 
+          value={formData.instructions}
+          onChange={(e) => setFormData({ ...formData, instructions: e.target.value })}
+          placeholder="Take with food..."
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Side Effects</label>
+        <textarea 
+          value={formData.sideEffects}
+          onChange={(e) => setFormData({ ...formData, sideEffects: e.target.value })}
+          placeholder="May cause drowsiness..."
+        />
+      </div>
+
+      <div className="form-group">
+        <label>
+          <input 
+            type="checkbox"
+            checked={formData.isPrn}
+            onChange={(e) => setFormData({ ...formData, isPrn: e.target.checked })}
+            style={{ marginRight: '0.5rem' }}
+          />
+          PRN (As Needed)
+        </label>
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Save Medication</button>
+      </div>
+    </form>
+  );
+};
+
+// Log Administration Form
+const LogForm = ({ medications, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    medicationId: '',
+    status: 'administered',
+    dosageGiven: '',
+    notes: ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.medicationId) {
+      toast('Select a medication');
+      return;
+    }
+    onSubmit({
+      ...formData,
+      administeredTime: new Date().toISOString()
+    });
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Medication *</label>
+        <select 
+          value={formData.medicationId}
+          onChange={(e) => setFormData({ ...formData, medicationId: e.target.value })}
+          required
+        >
+          <option value="">Select Medication</option>
+          {medications.map(med => (
+            <option key={med.id} value={med.id}>
+              {med.medication_name} - {med.dosage}
+            </option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Status *</label>
+          <select 
+            value={formData.status}
+            onChange={(e) => setFormData({ ...formData, status: e.target.value })}
+          >
+            <option value="administered">Administered</option>
+            <option value="refused">Refused</option>
+            <option value="missed">Missed</option>
+            <option value="held">Held</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Dosage Given</label>
+          <input 
+            type="text"
+            value={formData.dosageGiven}
+            onChange={(e) => setFormData({ ...formData, dosageGiven: e.target.value })}
+            placeholder="e.g., 500mg"
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Any observations..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Log Administration</button>
+      </div>
+    </form>
+  );
+};
+
+export default MedicationsManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/MessageBoard.jsx b/templates/crm-homecare/frontend/src/components/admin/MessageBoard.jsx
new file mode 100644
index 0000000..219c096
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/MessageBoard.jsx
@@ -0,0 +1,348 @@
+// src/components/admin/MessageBoard.jsx
+// Company message board — send individual, group, or broadcast messages
+import React, { useState, useEffect, useRef, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+const MessageBoard = ({ token }) => {
+  const [view, setView] = useState('inbox'); // inbox | thread | compose
+  const [threads, setThreads] = useState([]);
+  const [activeThread, setActiveThread] = useState(null);
+  const [messages, setMessages] = useState([]);
+  const [users, setUsers] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [sending, setSending] = useState(false);
+  const [replyBody, setReplyBody] = useState('');
+  const [compose, setCompose] = useState({ subject: '', body: '', recipientIds: [] });
+  const [broadcastMode, setBroadcastMode] = useState(false);
+  const [userSearch, setUserSearch] = useState('');
+  const messagesEndRef = useRef(null);
+  const pollRef = useRef(null);
+
+  const headers = { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` };
+
+  const loadInbox = useCallback(async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/inbox`, { headers });
+      if (res.ok) setThreads(await res.json());
+    } catch (e) { /* silent */ }
+    finally { setLoading(false); }
+  }, [token]);
+
+  const loadUsers = useCallback(async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/users`, { headers });
+      if (res.ok) setUsers(await res.json());
+    } catch (e) { /* silent */ }
+  }, [token]);
+
+  useEffect(() => {
+    loadInbox();
+    loadUsers();
+    pollRef.current = setInterval(loadInbox, 15000);
+    return () => clearInterval(pollRef.current);
+  }, [loadInbox, loadUsers]);
+
+  useEffect(() => {
+    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
+  }, [messages]);
+
+  const openThread = async (thread) => {
+    setActiveThread(thread);
+    setView('thread');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/thread/${thread.id}`, { headers });
+      if (res.ok) {
+        const data = await res.json();
+        setMessages(data.messages);
+        setThreads(prev => prev.map(t => t.id === thread.id ? { ...t, unread_count: 0 } : t));
+      }
+    } catch (e) { toast('Could not load messages', 'error'); }
+  };
+
+  const sendReply = async () => {
+    if (!replyBody.trim()) return;
+    setSending(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/thread/${activeThread.id}/reply`, {
+        method: 'POST', headers, body: JSON.stringify({ body: replyBody })
+      });
+      if (res.ok) {
+        const msg = await res.json();
+        setMessages(prev => [...prev, msg]);
+        setReplyBody('');
+      } else toast('Failed to send', 'error');
+    } catch (e) { toast('Failed to send', 'error'); }
+    finally { setSending(false); }
+  };
+
+  const sendNew = async () => {
+    if (!compose.body.trim()) return toast('Message body is required', 'error');
+    const recipients = broadcastMode ? 'all' : compose.recipientIds;
+    if (!broadcastMode && recipients.length === 0) return toast('Select at least one recipient', 'error');
+    setSending(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/send`, {
+        method: 'POST', headers,
+        body: JSON.stringify({ subject: compose.subject || 'New Message', body: compose.body, recipientIds: recipients })
+      });
+      if (res.ok) {
+        const data = await res.json();
+        toast(`Sent to ${data.recipientCount} recipient${data.recipientCount !== 1 ? 's' : ''}`, 'success');
+        setCompose({ subject: '', body: '', recipientIds: [] });
+        setBroadcastMode(false);
+        await loadInbox();
+        setView('inbox');
+      } else toast('Failed to send message', 'error');
+    } catch (e) { toast('Failed to send message', 'error'); }
+    finally { setSending(false); }
+  };
+
+  const toggleRecipient = (userId) => {
+    setCompose(prev => ({
+      ...prev,
+      recipientIds: prev.recipientIds.includes(userId)
+        ? prev.recipientIds.filter(id => id !== userId)
+        : [...prev.recipientIds, userId]
+    }));
+  };
+
+  const formatTime = (ts) => {
+    if (!ts) return '';
+    const d = new Date(ts);
+    const now = new Date();
+    const diff = now - d;
+    if (diff < 60000) return 'just now';
+    if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
+    if (diff < 86400000) return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
+    return d.toLocaleDateString([], { month: 'short', day: 'numeric' });
+  };
+
+  const totalUnread = threads.reduce((sum, t) => sum + (parseInt(t.unread_count) || 0), 0);
+  const filteredUsers = users.filter(u =>
+    !userSearch || `${u.first_name} ${u.last_name}`.toLowerCase().includes(userSearch.toLowerCase()) || u.role.includes(userSearch.toLowerCase())
+  );
+
+  const roleColor = (role) => role === 'admin' ? '#7C3AED' : '#2ABBA7';
+  const roleLabel = (role) => role === 'admin' ? 'Admin' : 'Caregiver';
+
+  // ─── INBOX ────────────────────────────────────────────────────────────────
+  if (view === 'inbox') return (
+    <div style={{ maxWidth: '800px' }}>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem' }}>
+        <div>
+          <h2 style={{ margin: 0, fontSize: '1.3rem', fontWeight: '800' }}>
+            💬 Messages {totalUnread > 0 && <span style={{ background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.7rem', padding: '2px 8px', marginLeft: '0.4rem', verticalAlign: 'middle' }}>{totalUnread}</span>}
+          </h2>
+          <p style={{ margin: '0.1rem 0 0', fontSize: '0.82rem', color: '#6B7280' }}>Company message board</p>
+        </div>
+        <button onClick={() => setView('compose')}
+          style={{ padding: '0.6rem 1.25rem', background: '#2ABBA7', color: '#fff', border: 'none', borderRadius: '10px', cursor: 'pointer', fontWeight: '700', fontSize: '0.9rem' }}>
+          ✏️ New Message
+        </button>
+      </div>
+
+      {loading ? (
+        <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF' }}>Loading...</div>
+      ) : threads.length === 0 ? (
+        <div style={{ textAlign: 'center', padding: '4rem 2rem', color: '#9CA3AF' }}>
+          <div style={{ fontSize: '3rem', marginBottom: '0.75rem' }}>💬</div>
+          <p style={{ fontWeight: '700', margin: '0 0 0.5rem', color: '#374151' }}>No messages yet</p>
+          <p style={{ margin: 0, fontSize: '0.875rem' }}>Click "New Message" to send one to the team.</p>
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+          {threads.map(thread => {
+            const unread = parseInt(thread.unread_count) || 0;
+            const others = thread.other_participants || [];
+            const label = thread.is_broadcast ? '📢 All Staff'
+              : others.length === 0 ? 'Just you'
+              : others.length === 1 ? `${others[0].first_name} ${others[0].last_name}`
+              : `${others[0].first_name} +${others.length - 1} others`;
+
+            return (
+              <div key={thread.id} onClick={() => openThread(thread)}
+                style={{ padding: '1rem 1.25rem', background: unread > 0 ? '#F0FDFB' : '#fff', border: `1px solid ${unread > 0 ? '#A7F3D0' : '#E5E7EB'}`, borderRadius: '12px', cursor: 'pointer', transition: 'all 0.15s', display: 'flex', gap: '1rem', alignItems: 'center' }}>
+                <div style={{ width: '42px', height: '42px', borderRadius: '50%', background: unread > 0 ? '#2ABBA7' : '#E5E7EB', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.1rem', flexShrink: 0 }}>
+                  {thread.is_broadcast ? '📢' : '💬'}
+                </div>
+                <div style={{ flex: 1, minWidth: 0 }}>
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.2rem' }}>
+                    <span style={{ fontWeight: unread > 0 ? '800' : '600', fontSize: '0.9rem', color: '#111827' }}>{label}</span>
+                    <span style={{ fontSize: '0.75rem', color: '#9CA3AF', flexShrink: 0, marginLeft: '0.5rem' }}>{formatTime(thread.last_message_at)}</span>
+                  </div>
+                  <div style={{ fontSize: '0.82rem', color: '#374151', fontWeight: unread > 0 ? '600' : '400' }}>{thread.subject}</div>
+                  <div style={{ fontSize: '0.8rem', color: '#6B7280', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>{thread.last_message || 'No messages yet'}</div>
+                </div>
+                {unread > 0 && (
+                  <div style={{ background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.7rem', fontWeight: '700', padding: '2px 8px', flexShrink: 0 }}>{unread}</div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+
+  // ─── THREAD VIEW ──────────────────────────────────────────────────────────
+  if (view === 'thread') return (
+    <div style={{ maxWidth: '800px', display: 'flex', flexDirection: 'column', height: 'calc(100vh - 200px)' }}>
+      <div style={{ display: 'flex', alignItems: 'center', gap: '0.875rem', marginBottom: '1rem' }}>
+        <button onClick={() => { setView('inbox'); loadInbox(); }}
+          style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '1rem', padding: 0 }}>← Inbox</button>
+        <div style={{ flex: 1 }}>
+          <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '800' }}>{activeThread?.subject}</h3>
+          <p style={{ margin: 0, fontSize: '0.78rem', color: '#6B7280' }}>
+            {activeThread?.is_broadcast ? 'Sent to all staff' : `${(activeThread?.other_participants || []).map(p => `${p.first_name} ${p.last_name}`).join(', ')}`}
+          </p>
+        </div>
+      </div>
+
+      {/* Messages */}
+      <div style={{ flex: 1, overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: '0.75rem', padding: '0.5rem 0', marginBottom: '1rem' }}>
+        {messages.map(msg => {
+          const isMe = msg.sender_id === (token && JSON.parse(atob(token.split('.')[1])).id);
+          return (
+            <div key={msg.id} style={{ display: 'flex', flexDirection: 'column', alignItems: isMe ? 'flex-end' : 'flex-start' }}>
+              <div style={{ fontSize: '0.75rem', color: '#9CA3AF', marginBottom: '0.2rem', paddingLeft: isMe ? 0 : '0.5rem', paddingRight: isMe ? '0.5rem' : 0 }}>
+                {isMe ? 'You' : `${msg.first_name} ${msg.last_name}`} · {formatTime(msg.created_at)}
+              </div>
+              <div style={{ maxWidth: '75%', padding: '0.75rem 1rem', borderRadius: isMe ? '18px 18px 4px 18px' : '18px 18px 18px 4px', background: isMe ? '#2ABBA7' : '#F3F4F6', color: isMe ? '#fff' : '#111827', fontSize: '0.9rem', lineHeight: 1.6 }}>
+                {msg.body}
+              </div>
+            </div>
+          );
+        })}
+        <div ref={messagesEndRef} />
+      </div>
+
+      {/* Reply */}
+      <div style={{ display: 'flex', gap: '0.5rem', borderTop: '1px solid #E5E7EB', paddingTop: '1rem' }}>
+        <textarea
+          value={replyBody}
+          onChange={e => setReplyBody(e.target.value)}
+          onKeyDown={e => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendReply(); } }}
+          placeholder="Type a reply... (Enter to send, Shift+Enter for new line)"
+          rows={2}
+          style={{ flex: 1, padding: '0.75rem', border: '1px solid #D1D5DB', borderRadius: '10px', resize: 'none', fontSize: '0.9rem', outline: 'none', fontFamily: 'inherit' }}
+        />
+        <button onClick={sendReply} disabled={sending || !replyBody.trim()}
+          style={{ padding: '0.75rem 1.25rem', background: replyBody.trim() ? '#2ABBA7' : '#D1D5DB', color: '#fff', border: 'none', borderRadius: '10px', cursor: replyBody.trim() ? 'pointer' : 'default', fontWeight: '700', alignSelf: 'flex-end' }}>
+          {sending ? '...' : '→'}
+        </button>
+      </div>
+    </div>
+  );
+
+  // ─── COMPOSE ──────────────────────────────────────────────────────────────
+  return (
+    <div style={{ maxWidth: '700px' }}>
+      <div style={{ display: 'flex', alignItems: 'center', gap: '0.875rem', marginBottom: '1.5rem' }}>
+        <button onClick={() => setView('inbox')}
+          style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '1rem', padding: 0 }}>← Inbox</button>
+        <h2 style={{ margin: 0, fontSize: '1.2rem', fontWeight: '800' }}>✏️ New Message</h2>
+      </div>
+
+      {/* Broadcast toggle */}
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.25rem' }}>
+        <button onClick={() => setBroadcastMode(false)}
+          style={{ padding: '0.5rem 1rem', borderRadius: '8px', border: `2px solid ${!broadcastMode ? '#2ABBA7' : '#E5E7EB'}`, background: !broadcastMode ? '#F0FDFB' : '#fff', color: !broadcastMode ? '#2ABBA7' : '#374151', fontWeight: '700', cursor: 'pointer', fontSize: '0.85rem' }}>
+          👤 Individual / Group
+        </button>
+        <button onClick={() => setBroadcastMode(true)}
+          style={{ padding: '0.5rem 1rem', borderRadius: '8px', border: `2px solid ${broadcastMode ? '#2ABBA7' : '#E5E7EB'}`, background: broadcastMode ? '#F0FDFB' : '#fff', color: broadcastMode ? '#2ABBA7' : '#374151', fontWeight: '700', cursor: 'pointer', fontSize: '0.85rem' }}>
+          📢 Send to Everyone
+        </button>
+      </div>
+
+      {broadcastMode && (
+        <div style={{ background: '#FEF3C7', border: '1px solid #FCD34D', borderRadius: '10px', padding: '0.875rem 1rem', marginBottom: '1.25rem' }}>
+          <p style={{ margin: 0, fontSize: '0.875rem', color: '#92400E', fontWeight: '600' }}>📢 Broadcast to all {users.length} active staff members. Everyone will receive this message and a push notification.</p>
+        </div>
+      )}
+
+      {/* Recipient picker */}
+      {!broadcastMode && (
+        <div style={{ marginBottom: '1.25rem' }}>
+          <label style={{ display: 'block', fontWeight: '700', fontSize: '0.875rem', marginBottom: '0.5rem', color: '#374151' }}>
+            Recipients {compose.recipientIds.length > 0 && <span style={{ background: '#2ABBA7', color: '#fff', borderRadius: '99px', padding: '1px 8px', fontSize: '0.75rem', marginLeft: '0.4rem' }}>{compose.recipientIds.length}</span>}
+          </label>
+          <input
+            placeholder="Search by name or role..."
+            value={userSearch}
+            onChange={e => setUserSearch(e.target.value)}
+            style={{ width: '100%', padding: '0.6rem 0.875rem', border: '1px solid #D1D5DB', borderRadius: '8px', marginBottom: '0.5rem', fontSize: '0.875rem', boxSizing: 'border-box', outline: 'none' }}
+          />
+          <div style={{ border: '1px solid #E5E7EB', borderRadius: '10px', maxHeight: '200px', overflowY: 'auto' }}>
+            {filteredUsers.map((user, i) => {
+              const selected = compose.recipientIds.includes(user.id);
+              return (
+                <div key={user.id} onClick={() => toggleRecipient(user.id)}
+                  style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '0.625rem 1rem', cursor: 'pointer', background: selected ? '#F0FDFB' : i % 2 === 0 ? '#fff' : '#F9FAFB', borderBottom: i < filteredUsers.length - 1 ? '1px solid #F3F4F6' : 'none' }}>
+                  <div style={{ width: '20px', height: '20px', borderRadius: '4px', border: `2px solid ${selected ? '#2ABBA7' : '#D1D5DB'}`, background: selected ? '#2ABBA7' : '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>
+                    {selected && <span style={{ color: '#fff', fontSize: '0.75rem', fontWeight: '800' }}>✓</span>}
+                  </div>
+                  <div style={{ flex: 1 }}>
+                    <span style={{ fontWeight: '600', fontSize: '0.875rem', color: '#111827' }}>{user.first_name} {user.last_name}</span>
+                    <span style={{ marginLeft: '0.5rem', fontSize: '0.75rem', background: `${roleColor(user.role)}22`, color: roleColor(user.role), borderRadius: '4px', padding: '1px 6px', fontWeight: '600' }}>{roleLabel(user.role)}</span>
+                  </div>
+                </div>
+              );
+            })}
+            {filteredUsers.length === 0 && <div style={{ padding: '1rem', textAlign: 'center', color: '#9CA3AF', fontSize: '0.875rem' }}>No staff found</div>}
+          </div>
+          {compose.recipientIds.length > 0 && (
+            <div style={{ marginTop: '0.5rem', display: 'flex', flexWrap: 'wrap', gap: '0.4rem' }}>
+              {compose.recipientIds.map(id => {
+                const u = users.find(u => u.id === id);
+                return u ? (
+                  <span key={id} style={{ background: '#2ABBA7', color: '#fff', borderRadius: '99px', padding: '3px 10px', fontSize: '0.78rem', fontWeight: '600', display: 'flex', alignItems: 'center', gap: '0.3rem' }}>
+                    {u.first_name} {u.last_name}
+                    <button onClick={() => toggleRecipient(id)} style={{ background: 'none', border: 'none', color: '#fff', cursor: 'pointer', padding: 0, fontSize: '0.9rem', lineHeight: 1 }}>×</button>
+                  </span>
+                ) : null;
+              })}
+            </div>
+          )}
+        </div>
+      )}
+
+      {/* Subject */}
+      <div style={{ marginBottom: '1rem' }}>
+        <label style={{ display: 'block', fontWeight: '700', fontSize: '0.875rem', marginBottom: '0.4rem', color: '#374151' }}>Subject</label>
+        <input
+          placeholder="e.g. Schedule change this week, Team reminder..."
+          value={compose.subject}
+          onChange={e => setCompose(p => ({ ...p, subject: e.target.value }))}
+          style={{ width: '100%', padding: '0.6rem 0.875rem', border: '1px solid #D1D5DB', borderRadius: '8px', fontSize: '0.875rem', boxSizing: 'border-box', outline: 'none' }}
+        />
+      </div>
+
+      {/* Body */}
+      <div style={{ marginBottom: '1.25rem' }}>
+        <label style={{ display: 'block', fontWeight: '700', fontSize: '0.875rem', marginBottom: '0.4rem', color: '#374151' }}>Message *</label>
+        <textarea
+          placeholder="Type your message here..."
+          value={compose.body}
+          onChange={e => setCompose(p => ({ ...p, body: e.target.value }))}
+          rows={6}
+          style={{ width: '100%', padding: '0.75rem', border: '1px solid #D1D5DB', borderRadius: '8px', fontSize: '0.9rem', resize: 'vertical', boxSizing: 'border-box', outline: 'none', fontFamily: 'inherit' }}
+        />
+      </div>
+
+      <div style={{ display: 'flex', gap: '0.75rem' }}>
+        <button onClick={() => setView('inbox')}
+          style={{ padding: '0.75rem 1.5rem', border: '1px solid #D1D5DB', borderRadius: '10px', background: '#fff', cursor: 'pointer', fontWeight: '600', color: '#374151' }}>
+          Cancel
+        </button>
+        <button onClick={sendNew} disabled={sending}
+          style={{ padding: '0.75rem 2rem', background: '#2ABBA7', color: '#fff', border: 'none', borderRadius: '10px', cursor: sending ? 'default' : 'pointer', fontWeight: '700', fontSize: '0.9rem' }}>
+          {sending ? 'Sending...' : `📤 Send${broadcastMode ? ' to Everyone' : compose.recipientIds.length > 0 ? ` (${compose.recipientIds.length})` : ''}`}
+        </button>
+      </div>
+    </div>
+  );
+};
+
+export default MessageBoard;
diff --git a/templates/crm-homecare/frontend/src/components/admin/NoShowAlerts.jsx b/templates/crm-homecare/frontend/src/components/admin/NoShowAlerts.jsx
new file mode 100644
index 0000000..7144f23
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/NoShowAlerts.jsx
@@ -0,0 +1,256 @@
+// NoShowAlerts.jsx — monitor + configure automated no-show detection
+
+import { useState, useEffect } from 'react';
+
+const API = import.meta.env.VITE_API_URL || '';
+
+export default function NoShowAlerts({ token }) {
+  const [alerts, setAlerts] = useState([]);
+  const [stats, setStats] = useState({});
+  const [config, setConfig] = useState({ grace_minutes: 15, notify_admin: true, notify_caregiver: true, notify_client_family: false, admin_phone: '', admin_email: '', is_active: true });
+  const [tab, setTab] = useState('alerts');
+  const [filter, setFilter] = useState('open');
+  const [loading, setLoading] = useState(true);
+  const [checking, setChecking] = useState(false);
+  const [savingConfig, setSavingConfig] = useState(false);
+  const [resolveModal, setResolveModal] = useState(null);
+  const [resolveNote, setResolveNote] = useState('');
+  const [msg, setMsg] = useState('');
+
+  const h = { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` };
+  const flash = (m, ok = true) => { setMsg({ text: m, ok }); setTimeout(() => setMsg(''), 3500); };
+
+  const load = async () => {
+    setLoading(true);
+    try {
+      const [aR, sR, cR] = await Promise.all([
+        fetch(`${API}/api/no-show/alerts?status=${filter}&limit=100`, { headers: h }),
+        fetch(`${API}/api/no-show/stats`, { headers: h }),
+        fetch(`${API}/api/no-show/config`, { headers: h }),
+      ]);
+      setAlerts(await aR.json());
+      setStats(await sR.json());
+      const cfg = await cR.json();
+      if (cfg && cfg.grace_minutes) setConfig(cfg);
+    } catch (e) {}
+    setLoading(false);
+  };
+
+  useEffect(() => { load(); }, [filter]);
+
+  const runCheck = async () => {
+    setChecking(true);
+    try {
+      const r = await fetch(`${API}/api/no-show/run-check`, { method: 'POST', headers: h });
+      const data = await r.json();
+      flash(`✓ Check complete — ${data.alerts} new alert${data.alerts !== 1 ? 's' : ''} created (${data.checked} shifts checked)`);
+      load();
+    } catch (e) { flash('Check failed', false); }
+    setChecking(false);
+  };
+
+  const resolve = async (id, status) => {
+    try {
+      await fetch(`${API}/api/no-show/alerts/${id}/resolve`, {
+        method: 'PUT', headers: h,
+        body: JSON.stringify({ resolutionNote: resolveNote, status })
+      });
+      flash('Resolved');
+      setResolveModal(null);
+      setResolveNote('');
+      load();
+    } catch (e) { flash('Error', false); }
+  };
+
+  const saveConfig = async () => {
+    setSavingConfig(true);
+    try {
+      await fetch(`${API}/api/no-show/config`, {
+        method: 'PUT', headers: h,
+        body: JSON.stringify({
+          graceMinutes: config.grace_minutes,
+          notifyAdmin: config.notify_admin,
+          notifyCaregiver: config.notify_caregiver,
+          notifyClientFamily: config.notify_client_family,
+          adminPhone: config.admin_phone,
+          adminEmail: config.admin_email,
+          isActive: config.is_active
+        })
+      });
+      flash('Settings saved');
+    } catch (e) { flash('Error saving', false); }
+    setSavingConfig(false);
+  };
+
+  const tabStyle = (t) => ({
+    padding: '0.5rem 1rem', border: 'none', borderBottom: `3px solid ${tab === t ? '#3B82F6' : 'transparent'}`,
+    background: 'none', cursor: 'pointer', fontWeight: tab === t ? 700 : 400,
+    color: tab === t ? '#1D4ED8' : '#6B7280', fontSize: '0.92rem'
+  });
+
+  const statusBadge = (s) => {
+    const map = { open: ['#FEF2F2','#DC2626'], resolved: ['#D1FAE5','#059669'], false_alarm: ['#F3F4F6','#6B7280'] };
+    const [bg, color] = map[s] || ['#F3F4F6','#6B7280'];
+    return <span style={{ background: bg, color, padding: '0.15rem 0.55rem', borderRadius: '12px', fontSize: '0.75rem', fontWeight: 700 }}>{s.replace('_', ' ')}</span>;
+  };
+
+  return (
+    <div>
+      {msg && <div style={{ position: 'fixed', top: '1rem', right: '1rem', background: msg.ok ? '#D1FAE5' : '#FEE2E2', color: msg.ok ? '#065F46' : '#991B1B', padding: '0.75rem 1.25rem', borderRadius: '8px', zIndex: 9999, fontWeight: 600, boxShadow: '0 4px 12px rgba(0,0,0,0.15)' }}>{msg.text}</div>}
+
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem', flexWrap: 'wrap', gap: '0.75rem' }}>
+        <h2 style={{ margin: 0 }}>🚨 No-Show Alerts</h2>
+        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+          <span style={{ fontSize: '0.82rem', color: config.is_active ? '#10B981' : '#EF4444', fontWeight: 600 }}>
+            {config.is_active ? '● Active' : '○ Disabled'}
+          </span>
+          <button onClick={runCheck} disabled={checking}
+            style={{ padding: '0.5rem 1.1rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 600, fontSize: '0.88rem', opacity: checking ? 0.7 : 1 }}>
+            {checking ? '⏳ Checking...' : '▶ Run Check Now'}
+          </button>
+        </div>
+      </div>
+
+      {/* Stats row */}
+      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '0.75rem', marginBottom: '1.5rem' }}>
+        {[
+          { label: 'Open Alerts', val: stats.open_count || 0, color: '#EF4444', bg: '#FEF2F2' },
+          { label: 'Today', val: stats.today_count || 0, color: '#F59E0B', bg: '#FFFBEB' },
+          { label: 'This Week', val: stats.week_count || 0, color: '#3B82F6', bg: '#EFF6FF' },
+          { label: 'Resolved', val: stats.resolved_count || 0, color: '#10B981', bg: '#D1FAE5' },
+        ].map(s => (
+          <div key={s.label} style={{ background: s.bg, borderRadius: '10px', padding: '1rem', textAlign: 'center', border: `1px solid ${s.color}28` }}>
+            <div style={{ fontSize: '1.75rem', fontWeight: 800, color: s.color }}>{s.val}</div>
+            <div style={{ fontSize: '0.78rem', color: '#6B7280', fontWeight: 600, marginTop: '0.2rem' }}>{s.label}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* Tabs */}
+      <div style={{ display: 'flex', borderBottom: '2px solid #E5E7EB', marginBottom: '1.25rem' }}>
+        <button style={tabStyle('alerts')} onClick={() => setTab('alerts')}>🚨 Alerts</button>
+        <button style={tabStyle('settings')} onClick={() => setTab('settings')}>⚙️ Settings</button>
+      </div>
+
+      {tab === 'alerts' && (
+        <>
+          <div style={{ display: 'flex', gap: '0.4rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
+            {['open','resolved','false_alarm','all'].map(s => (
+              <button key={s} onClick={() => setFilter(s)}
+                style={{ padding: '0.35rem 0.85rem', borderRadius: '20px', border: `1px solid ${filter === s ? '#3B82F6' : '#E5E7EB'}`,
+                  background: filter === s ? '#3B82F6' : '#fff', color: filter === s ? '#fff' : '#374151',
+                  cursor: 'pointer', fontSize: '0.82rem', fontWeight: filter === s ? 700 : 400 }}>
+                {s.replace('_', ' ')}
+              </button>
+            ))}
+          </div>
+
+          {loading ? <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF' }}>Loading...</div>
+          : alerts.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+              <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>✅</div>
+              <div style={{ fontWeight: 600 }}>No {filter !== 'all' ? filter : ''} alerts</div>
+            </div>
+          ) : (
+            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>
+              {alerts.map(a => (
+                <div key={a.id} style={{ background: '#fff', border: `1px solid ${a.status === 'open' ? '#FCA5A5' : '#E5E7EB'}`, borderLeft: `4px solid ${a.status === 'open' ? '#EF4444' : '#10B981'}`, borderRadius: '8px', padding: '1rem', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.75rem' }}>
+                  <div>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.35rem', flexWrap: 'wrap' }}>
+                      <span style={{ fontWeight: 700, fontSize: '0.95rem' }}>{a.caregiver_name || 'Unknown'}</span>
+                      <span style={{ color: '#6B7280', fontSize: '0.82rem' }}>→ {a.client_name || 'Unknown client'}</span>
+                      {statusBadge(a.status)}
+                    </div>
+                    <div style={{ fontSize: '0.82rem', color: '#6B7280' }}>
+                      Shift: {a.shift_date} at {a.expected_start?.slice(0,5)}
+                      {a.caregiver_phone && <span style={{ marginLeft: '0.75rem' }}>📞 {a.caregiver_phone}</span>}
+                    </div>
+                    {a.sms_sent && <div style={{ fontSize: '0.75rem', color: '#10B981', marginTop: '0.2rem' }}>✓ SMS sent</div>}
+                    {a.resolution_note && <div style={{ fontSize: '0.82rem', color: '#374151', marginTop: '0.35rem', fontStyle: 'italic' }}>"{a.resolution_note}"</div>}
+                  </div>
+                  {a.status === 'open' && (
+                    <button onClick={() => { setResolveModal(a); setResolveNote(''); }}
+                      style={{ padding: '0.4rem 0.9rem', borderRadius: '8px', border: 'none', background: '#D1FAE5', color: '#065F46', cursor: 'pointer', fontWeight: 600, fontSize: '0.82rem' }}>
+                      Resolve
+                    </button>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </>
+      )}
+
+      {tab === 'settings' && (
+        <div style={{ maxWidth: '480px' }}>
+          <div style={{ background: '#F9FAFB', borderRadius: '10px', padding: '1.25rem', border: '1px solid #E5E7EB' }}>
+            <h4 style={{ margin: '0 0 1rem' }}>Alert Configuration</h4>
+
+            <div style={{ marginBottom: '1rem' }}>
+              <label style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>
+                <span style={{ fontWeight: 600, fontSize: '0.9rem' }}>Monitoring Active</span>
+                <input type='checkbox' checked={config.is_active} onChange={e => setConfig(c => ({ ...c, is_active: e.target.checked }))} style={{ width: '1.1rem', height: '1.1rem' }} />
+              </label>
+              <label style={{ display: 'block', fontSize: '0.85rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Grace Period (minutes)</label>
+              <input type='number' value={config.grace_minutes} onChange={e => setConfig(c => ({ ...c, grace_minutes: parseInt(e.target.value) }))} min={5} max={60}
+                style={{ width: '100px', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.9rem' }} />
+              <div style={{ fontSize: '0.75rem', color: '#9CA3AF', marginTop: '0.25rem' }}>Alert triggers if no clock-in after this many minutes past shift start</div>
+            </div>
+
+            <div style={{ marginBottom: '1rem' }}>
+              <div style={{ fontWeight: 600, fontSize: '0.9rem', marginBottom: '0.5rem' }}>Notify</div>
+              {[
+                { key: 'notify_admin', label: 'Admin / Office' },
+                { key: 'notify_caregiver', label: 'Caregiver (via SMS)' },
+                { key: 'notify_client_family', label: "Client's Family" },
+              ].map(({ key, label }) => (
+                <label key={key} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.4rem', cursor: 'pointer' }}>
+                  <input type='checkbox' checked={config[key]} onChange={e => setConfig(c => ({ ...c, [key]: e.target.checked }))} />
+                  <span style={{ fontSize: '0.88rem' }}>{label}</span>
+                </label>
+              ))}
+            </div>
+
+            <div style={{ marginBottom: '1rem' }}>
+              <label style={{ display: 'block', fontSize: '0.85rem', fontWeight: 600, marginBottom: '0.3rem', color: '#374151' }}>Admin Phone (for SMS)</label>
+              <input value={config.admin_phone || ''} onChange={e => setConfig(c => ({ ...c, admin_phone: e.target.value }))}
+                placeholder='+17155551234'
+                style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.88rem', boxSizing: 'border-box' }} />
+            </div>
+
+            <button onClick={saveConfig} disabled={savingConfig}
+              style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: 'none', background: '#3B82F6', color: '#fff', cursor: 'pointer', fontWeight: 700, fontSize: '0.92rem' }}>
+              {savingConfig ? 'Saving...' : '✓ Save Settings'}
+            </button>
+          </div>
+
+          <div style={{ marginTop: '1rem', padding: '0.85rem 1rem', background: '#EFF6FF', borderRadius: '8px', border: '1px solid #BFDBFE' }}>
+            <div style={{ fontWeight: 700, color: '#1E40AF', fontSize: '0.88rem', marginBottom: '0.35rem' }}>💡 How it works</div>
+            <div style={{ fontSize: '0.82rem', color: '#374151', lineHeight: 1.6 }}>
+              Click "Run Check Now" anytime to scan all shifts that should have started in the last 4 hours. For fully automated checks, set up a cron job calling <code style={{ background: '#DBEAFE', padding: '0.1rem 0.3rem', borderRadius: '3px' }}>POST /api/no-show/run-check</code> every 15–30 minutes.
+            </div>
+          </div>
+        </div>
+      )}
+
+      {/* Resolve modal */}
+      {resolveModal && (
+        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', zIndex: 2000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={() => setResolveModal(null)}>
+          <div style={{ background: '#fff', borderRadius: '12px', padding: '1.5rem', maxWidth: '420px', width: '100%', boxShadow: '0 20px 60px rgba(0,0,0,0.3)' }} onClick={e => e.stopPropagation()}>
+            <h4 style={{ margin: '0 0 0.5rem' }}>Resolve Alert</h4>
+            <p style={{ fontSize: '0.88rem', color: '#6B7280', margin: '0 0 1rem' }}>
+              {resolveModal.caregiver_name} → {resolveModal.client_name}
+            </p>
+            <textarea value={resolveNote} onChange={e => setResolveNote(e.target.value)}
+              placeholder='Resolution note (optional)...' rows={3}
+              style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '1px solid #D1D5DB', fontSize: '0.88rem', resize: 'vertical', boxSizing: 'border-box', marginBottom: '1rem' }} />
+            <div style={{ display: 'flex', gap: '0.5rem' }}>
+              <button onClick={() => resolve(resolveModal.id, 'resolved')} style={{ flex: 1, padding: '0.6rem', borderRadius: '8px', border: 'none', background: '#10B981', color: '#fff', cursor: 'pointer', fontWeight: 700 }}>✓ Resolved</button>
+              <button onClick={() => resolve(resolveModal.id, 'false_alarm')} style={{ flex: 1, padding: '0.6rem', borderRadius: '8px', border: '1px solid #D1D5DB', background: '#fff', color: '#374151', cursor: 'pointer', fontWeight: 600 }}>False Alarm</button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/NotificationCenter.jsx b/templates/crm-homecare/frontend/src/components/admin/NotificationCenter.jsx
new file mode 100644
index 0000000..eb8398f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/NotificationCenter.jsx
@@ -0,0 +1,470 @@
+// src/components/admin/NotificationCenter.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const NotificationCenter = ({ token }) => {
+  const [tab, setTab] = useState('log'); // log or settings
+  const [notifications, setNotifications] = useState([]);
+  const [settings, setSettings] = useState({});
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState('');
+  const [showManualForm, setShowManualForm] = useState(false);
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [filter, setFilter] = useState('all'); // all, sent, pending, failed
+  const [manualNotification, setManualNotification] = useState({
+    recipientType: 'caregiver', // caregiver or admin
+    recipientId: '',
+    notificationType: 'general',
+    subject: '',
+    message: ''
+  });
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [notificationsRes, settingsRes, caregiversRes, clientsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/notifications`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/notification-settings`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const notificationsData = await notificationsRes.json();
+      const settingsData = await settingsRes.json();
+      const caregiversData = await caregiversRes.json();
+      const clientsData = await clientsRes.json();
+
+      setNotifications(Array.isArray(notificationsData) ? notificationsData : []);
+      setSettings(settingsData || {});
+      setCaregivers(caregiversData);
+      setClients(clientsData);
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleSaveSettings = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/notification-settings`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(settings)
+      });
+
+      if (!response.ok) throw new Error('Failed to save settings');
+
+      setMessage('Notification settings saved!');
+      setTimeout(() => setMessage(''), 2000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleSendManualNotification = async (e) => {
+    e.preventDefault();
+    setMessage('');
+
+    if (!manualNotification.recipientId || !manualNotification.subject || !manualNotification.message) {
+      setMessage('Recipient, subject, and message are required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/notifications/send`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(manualNotification)
+      });
+
+      if (!response.ok) {
+        const error = await response.json();
+        throw new Error(error.error || 'Failed to send notification');
+      }
+
+      setMessage('Notification sent successfully!');
+      setManualNotification({
+        recipientType: 'caregiver',
+        recipientId: '',
+        notificationType: 'general',
+        subject: '',
+        message: ''
+      });
+      setShowManualForm(false);
+      loadData();
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const getRecipientName = (type, id) => {
+    if (type === 'caregiver') {
+      const cg = caregivers.find(c => c.id === id);
+      return cg ? `${cg.first_name} ${cg.last_name}` : 'Unknown';
+    } else {
+      return 'Administrator';
+    }
+  };
+
+  const getNotificationTypeLabel = (type) => {
+    const labels = {
+      'schedule_confirmation': 'Schedule Confirmation',
+      'absence_alert': 'Absence Alert',
+      'incident_alert': 'Incident Alert',
+      'certification_warning': 'Certification Warning',
+      'general': 'General Message'
+    };
+    return labels[type] || type;
+  };
+
+  const getStatusColor = (status) => {
+    switch (status) {
+      case 'sent':
+        return '#4caf50';
+      case 'pending':
+        return '#2196f3';
+      case 'failed':
+        return '#d32f2f';
+      default:
+        return '#999';
+    }
+  };
+
+  const filteredNotifications = notifications
+    .filter(notif => filter === 'all' || notif.status === filter)
+    .sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Notification Center</h2>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Tab Navigation */}
+      <div className="card" style={{ marginBottom: '1.5rem' }}>
+        <div style={{ display: 'flex', gap: '0.5rem', borderBottom: '1px solid #ddd', marginBottom: '1rem' }}>
+          <button
+            onClick={() => setTab('log')}
+            style={{
+              padding: '1rem',
+              background: tab === 'log' ? '#2196f3' : 'transparent',
+              color: tab === 'log' ? 'white' : 'inherit',
+              border: 'none',
+              cursor: 'pointer',
+              fontSize: '1rem',
+              borderBottom: tab === 'log' ? '3px solid #2196f3' : 'none'
+            }}
+          >
+            Notification Log
+          </button>
+          <button
+            onClick={() => setTab('settings')}
+            style={{
+              padding: '1rem',
+              background: tab === 'settings' ? '#2196f3' : 'transparent',
+              color: tab === 'settings' ? 'white' : 'inherit',
+              border: 'none',
+              cursor: 'pointer',
+              fontSize: '1rem',
+              borderBottom: tab === 'settings' ? '3px solid #2196f3' : 'none'
+            }}
+          >
+            Settings
+          </button>
+        </div>
+      </div>
+
+      {/* Notification Log Tab */}
+      {tab === 'log' && (
+        <>
+          <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', marginBottom: '1.5rem' }}>
+            <div className="filter-tabs">
+              {['all', 'sent', 'pending', 'failed'].map(f => (
+                <button
+                  key={f}
+                  className={`filter-tab ${filter === f ? 'active' : ''}`}
+                  onClick={() => setFilter(f)}
+                >
+                  {f.charAt(0).toUpperCase() + f.slice(1)}
+                  {f !== 'all' && ` (${filteredNotifications.filter(n => n.status === f).length})`}
+                </button>
+              ))}
+            </div>
+            <button
+              className="btn btn-primary"
+              onClick={() => setShowManualForm(!showManualForm)}
+            >
+              {showManualForm ? 'Cancel' : 'Send Notification'}
+            </button>
+          </div>
+
+          {/* Manual Send Form */}
+          {showManualForm && (
+            <div className="card card-form">
+              <h3>Send Manual Notification</h3>
+              <form onSubmit={handleSendManualNotification}>
+                <div className="form-grid-2">
+                  <div className="form-group">
+                    <label>Recipient Type *</label>
+                    <select
+                      value={manualNotification.recipientType}
+                      onChange={(e) => setManualNotification({ ...manualNotification, recipientType: e.target.value, recipientId: '' })}
+                    >
+                      <option value="caregiver">Caregiver</option>
+                      <option value="admin">Administrator</option>
+                    </select>
+                  </div>
+
+                  {manualNotification.recipientType === 'caregiver' && (
+                    <div className="form-group">
+                      <label>Caregiver *</label>
+                      <select
+                        value={manualNotification.recipientId}
+                        onChange={(e) => setManualNotification({ ...manualNotification, recipientId: e.target.value })}
+                        required
+                      >
+                        <option value="">Select caregiver...</option>
+                        {caregivers.map(cg => (
+                          <option key={cg.id} value={cg.id}>
+                            {cg.first_name} {cg.last_name}
+                          </option>
+                        ))}
+                      </select>
+                    </div>
+                  )}
+
+                  <div className="form-group">
+                    <label>Notification Type</label>
+                    <select
+                      value={manualNotification.notificationType}
+                      onChange={(e) => setManualNotification({ ...manualNotification, notificationType: e.target.value })}
+                    >
+                      <option value="general">General Message</option>
+                      <option value="schedule_confirmation">Schedule Confirmation</option>
+                      <option value="absence_alert">Absence Alert</option>
+                      <option value="incident_alert">Incident Alert</option>
+                      <option value="certification_warning">Certification Warning</option>
+                    </select>
+                  </div>
+                </div>
+
+                <div className="form-group">
+                  <label>Subject *</label>
+                  <input
+                    type="text"
+                    value={manualNotification.subject}
+                    onChange={(e) => setManualNotification({ ...manualNotification, subject: e.target.value })}
+                    placeholder="Email subject line..."
+                    required
+                  />
+                </div>
+
+                <div className="form-group">
+                  <label>Message *</label>
+                  <textarea
+                    value={manualNotification.message}
+                    onChange={(e) => setManualNotification({ ...manualNotification, message: e.target.value })}
+                    placeholder="Email body text..."
+                    rows="5"
+                    required
+                  ></textarea>
+                </div>
+
+                <div className="form-actions">
+                  <button type="submit" className="btn btn-primary">Send Notification</button>
+                  <button type="button" className="btn btn-secondary" onClick={() => setShowManualForm(false)}>Cancel</button>
+                </div>
+              </form>
+            </div>
+          )}
+
+          {/* Notifications List */}
+          {filteredNotifications.length === 0 ? (
+            <div className="card card-centered">
+              <p>No notifications in this filter.</p>
+            </div>
+          ) : (
+            <div style={{ display: 'grid', gap: '1rem' }}>
+              {filteredNotifications.map(notif => (
+                <div
+                  key={notif.id}
+                  style={{
+                    padding: '1rem',
+                    border: `1px solid #ddd`,
+                    borderLeft: `4px solid ${getStatusColor(notif.status)}`,
+                    borderRadius: '4px',
+                    background: '#f9f9f9'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '0.75rem' }}>
+                    <div>
+                      <h4 style={{ margin: '0 0 0.25rem 0' }}>{notif.subject}</h4>
+                      <small style={{ color: '#666' }}>
+                        To: {getRecipientName(notif.recipient_type, notif.recipient_id)}
+                      </small>
+                    </div>
+                    <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+                      <span
+                        className="badge"
+                        style={{
+                          background: getStatusColor(notif.status),
+                          color: 'white',
+                          fontSize: '0.85rem'
+                        }}
+                      >
+                        {notif.status.toUpperCase()}
+                      </span>
+                      <span className="badge badge-secondary" style={{ fontSize: '0.85rem' }}>
+                        {getNotificationTypeLabel(notif.notification_type)}
+                      </span>
+                    </div>
+                  </div>
+
+                  <p style={{ margin: '0.5rem 0', whiteSpace: 'pre-wrap', lineHeight: '1.5' }}>
+                    {notif.message}
+                  </p>
+
+                  <div style={{ marginTop: '0.75rem', paddingTop: '0.75rem', borderTop: '1px solid #e0e0e0', fontSize: '0.85rem', color: '#999' }}>
+                    Sent: {new Date(notif.sent_at || notif.created_at).toLocaleString()}
+                    {notif.status === 'failed' && notif.error_message && (
+                      <div style={{ color: '#d32f2f', marginTop: '0.25rem' }}>
+                        Error: {notif.error_message}
+                      </div>
+                    )}
+                  </div>
+                </div>
+              ))}
+            </div>
+          )}
+        </>
+      )}
+
+      {/* Settings Tab */}
+      {tab === 'settings' && (
+        <div className="card card-form">
+          <h3>Notification Settings</h3>
+          <p style={{ color: '#666', marginBottom: '1.5rem' }}>
+            Configure when and how notifications are sent automatically
+          </p>
+
+          <h4>Schedule Notifications</h4>
+          <div style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_schedule_confirmations !== false}
+                onChange={(e) => setSettings({ ...settings, send_schedule_confirmations: e.target.checked })}
+              />
+              <span>Send confirmation when caregiver is scheduled</span>
+            </label>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_schedule_reminders !== false}
+                onChange={(e) => setSettings({ ...settings, send_schedule_reminders: e.target.checked })}
+              />
+              <span>Send shift reminders 24 hours before scheduled shifts</span>
+            </label>
+          </div>
+
+          <h4>Absence Notifications</h4>
+          <div style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_absence_alerts !== false}
+                onChange={(e) => setSettings({ ...settings, send_absence_alerts: e.target.checked })}
+              />
+              <span>Notify admin when caregiver reports absence</span>
+            </label>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_absence_decisions !== false}
+                onChange={(e) => setSettings({ ...settings, send_absence_decisions: e.target.checked })}
+              />
+              <span>Notify caregiver when absence is approved/denied</span>
+            </label>
+          </div>
+
+          <h4>Incident Notifications</h4>
+          <div style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_incident_alerts !== false}
+                onChange={(e) => setSettings({ ...settings, send_incident_alerts: e.target.checked })}
+              />
+              <span>Notify admin for critical/severe incidents immediately</span>
+            </label>
+          </div>
+
+          <h4>Certification Notifications</h4>
+          <div style={{ marginBottom: '1.5rem', paddingBottom: '1.5rem', borderBottom: '1px solid #ddd' }}>
+            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem', cursor: 'pointer' }}>
+              <input
+                type="checkbox"
+                checked={settings.send_certification_warnings !== false}
+                onChange={(e) => setSettings({ ...settings, send_certification_warnings: e.target.checked })}
+              />
+              <span>Notify admin when certification is expiring in 30 days</span>
+            </label>
+          </div>
+
+          <h4>Email Configuration</h4>
+          <div className="form-group" style={{ marginBottom: '1.5rem' }}>
+            <label>Admin Email for Alerts</label>
+            <input
+              type="email"
+              value={settings.admin_email || ''}
+              onChange={(e) => setSettings({ ...settings, admin_email: e.target.value })}
+              placeholder="admin@example.com"
+            />
+            <small style={{ color: '#666' }}>Where critical alerts will be sent</small>
+          </div>
+
+          <div className="form-actions">
+            <button className="btn btn-primary" onClick={handleSaveSettings}>
+              Save Settings
+            </button>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default NotificationCenter;
diff --git a/templates/crm-homecare/frontend/src/components/admin/OpenShifts.jsx b/templates/crm-homecare/frontend/src/components/admin/OpenShifts.jsx
new file mode 100644
index 0000000..510d528
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/OpenShifts.jsx
@@ -0,0 +1,539 @@
+// src/components/admin/OpenShifts.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const OpenShifts = ({ token }) => {
+  const [shifts, setShifts] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ status: 'open', urgency: '' });
+  const [showCreateModal, setShowCreateModal] = useState(false);
+  const [showClaimsModal, setShowClaimsModal] = useState(false);
+  const [currentShift, setCurrentShift] = useState(null);
+  const [claims, setClaims] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [careTypes, setCareTypes] = useState([]);
+
+  useEffect(() => {
+    loadShifts();
+    loadClients();
+    loadCareTypes();
+  }, [filter]);
+
+  const loadShifts = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.status) params.append('status', filter.status);
+      if (filter.urgency) params.append('urgency', filter.urgency);
+      
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setShifts(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load shifts:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const loadCareTypes = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/care-types`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setCareTypes(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load care types:', error);
+    }
+  };
+
+  const loadClaims = async (shiftId) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/claims`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClaims(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load claims:', error);
+    }
+  };
+
+  const createShift = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowCreateModal(false);
+        loadShifts();
+      } else {
+        const err = await res.json();
+        alert('Failed: ' + err.error);
+      }
+    } catch (error) {
+      alert('Failed to create shift: ' + error.message);
+    }
+  };
+
+  const approveShift = async (shiftId) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/approve`, {
+        method: 'POST',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadShifts();
+        setShowClaimsModal(false);
+      } else {
+        const err = await res.json();
+        alert('Failed: ' + err.error);
+      }
+    } catch (error) {
+      alert('Failed to approve: ' + error.message);
+    }
+  };
+
+  const rejectShift = async (shiftId) => {
+    const reason = prompt('Rejection reason (optional):');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/reject`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ reason })
+      });
+      if (res.ok) {
+        loadShifts();
+        setShowClaimsModal(false);
+      }
+    } catch (error) {
+      alert('Failed to reject: ' + error.message);
+    }
+  };
+
+  const broadcastShift = async (shiftId) => {
+    if (!confirm('Send SMS to all available caregivers?')) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/broadcast`, {
+        method: 'POST',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      if (res.ok) {
+        alert(`Broadcast sent to ${data.caregiverCount} caregivers`);
+        loadShifts();
+      }
+    } catch (error) {
+      alert('Failed to broadcast: ' + error.message);
+    }
+  };
+
+  const getUrgencyBadge = (urgency) => {
+    const colors = {
+      normal: '#4caf50',
+      high: '#ff9800',
+      critical: '#f44336'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[urgency] || '#9e9e9e'
+      }}>
+        {urgency?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      open: '#2196f3',
+      claimed: '#ff9800',
+      filled: '#4caf50',
+      cancelled: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const openShiftCount = shifts.filter(s => s.status === 'open').length;
+  const claimedCount = shifts.filter(s => s.status === 'claimed').length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📋 Open Shift Board</h2>
+        <button className="btn btn-primary" onClick={() => setShowCreateModal(true)}>
+          + Post Open Shift
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, status: 'open' })} style={{ cursor: 'pointer' }}>
+          <h4>Open</h4>
+          <div className="value" style={{ color: '#2196f3' }}>{openShiftCount}</div>
+        </div>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, status: 'claimed' })} style={{ cursor: 'pointer' }}>
+          <h4>Claimed (Pending)</h4>
+          <div className="value" style={{ color: '#ff9800' }}>{claimedCount}</div>
+        </div>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, status: '' })} style={{ cursor: 'pointer' }}>
+          <h4>Total</h4>
+          <div className="value">{shifts.length}</div>
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Status</label>
+            <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+              <option value="">All</option>
+              <option value="open">Open</option>
+              <option value="claimed">Claimed</option>
+              <option value="filled">Filled</option>
+              <option value="cancelled">Cancelled</option>
+            </select>
+          </div>
+          <div className="form-group" style={{ margin: 0 }}>
+            <label>Urgency</label>
+            <select value={filter.urgency} onChange={(e) => setFilter({ ...filter, urgency: e.target.value })}>
+              <option value="">All</option>
+              <option value="critical">Critical</option>
+              <option value="high">High</option>
+              <option value="normal">Normal</option>
+            </select>
+          </div>
+        </div>
+      </div>
+
+      {/* Shifts Table */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : shifts.length === 0 ? (
+          <p>No open shifts found.</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Date</th>
+                <th>Time</th>
+                <th>Client</th>
+                <th>Care Type</th>
+                <th>Rate</th>
+                <th>Bonus</th>
+                <th>Urgency</th>
+                <th>Status</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {shifts.map(shift => (
+                <tr key={shift.id}>
+                  <td>
+                    <strong>{new Date(shift.shift_date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</strong>
+                  </td>
+                  <td>{shift.start_time?.slice(0,5)} - {shift.end_time?.slice(0,5)}</td>
+                  <td>{shift.client_first_name} {shift.client_last_name}</td>
+                  <td>{shift.care_type_name || '-'}</td>
+                  <td>${(parseFloat(shift.hourly_rate) || 0).toFixed(2)}/hr</td>
+                  <td>
+                    {parseFloat(shift.bonus_amount) > 0 ? (
+                      <span style={{ color: '#4caf50', fontWeight: 'bold' }}>+${shift.bonus_amount}</span>
+                    ) : '-'}
+                  </td>
+                  <td>{getUrgencyBadge(shift.urgency)}</td>
+                  <td>
+                    {getStatusBadge(shift.status)}
+                    {shift.status === 'claimed' && (
+                      <div style={{ fontSize: '0.8rem', marginTop: '2px' }}>
+                        by {shift.claimed_by_first} {shift.claimed_by_last}
+                      </div>
+                    )}
+                  </td>
+                  <td>
+                    <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap' }}>
+                      {shift.status === 'open' && (
+                        <>
+                          <button 
+                            className="btn btn-sm btn-secondary"
+                            onClick={() => broadcastShift(shift.id)}
+                            title="Send SMS to caregivers"
+                          >
+                            📢
+                          </button>
+                        </>
+                      )}
+                      {shift.status === 'claimed' && (
+                        <>
+                          <button 
+                            className="btn btn-sm btn-success"
+                            onClick={() => approveShift(shift.id)}
+                          >
+                            ✓ Approve
+                          </button>
+                          <button 
+                            className="btn btn-sm btn-danger"
+                            onClick={() => rejectShift(shift.id)}
+                          >
+                            ✗
+                          </button>
+                        </>
+                      )}
+                      <button 
+                        className="btn btn-sm btn-secondary"
+                        onClick={() => { setCurrentShift(shift); loadClaims(shift.id); setShowClaimsModal(true); }}
+                      >
+                        View
+                      </button>
+                    </div>
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Create Shift Modal */}
+      {showCreateModal && (
+        <div className="modal-overlay" onClick={() => setShowCreateModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Post Open Shift</h3>
+              <button className="modal-close" onClick={() => setShowCreateModal(false)}>×</button>
+            </div>
+            <CreateShiftForm 
+              clients={clients}
+              careTypes={careTypes}
+              onSubmit={createShift} 
+              onCancel={() => setShowCreateModal(false)} 
+            />
+          </div>
+        </div>
+      )}
+
+      {/* View Claims Modal */}
+      {showClaimsModal && currentShift && (
+        <div className="modal-overlay" onClick={() => setShowClaimsModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>Shift Details</h3>
+              <button className="modal-close" onClick={() => setShowClaimsModal(false)}>×</button>
+            </div>
+            <div>
+              <p><strong>Client:</strong> {currentShift.client_first_name} {currentShift.client_last_name}</p>
+              <p><strong>Date:</strong> {new Date(currentShift.shift_date).toLocaleDateString()}</p>
+              <p><strong>Time:</strong> {currentShift.start_time?.slice(0,5)} - {currentShift.end_time?.slice(0,5)}</p>
+              <p><strong>Rate:</strong> ${(parseFloat(currentShift.hourly_rate) || 0).toFixed(2)}/hr</p>
+              {parseFloat(currentShift.bonus_amount) > 0 && (
+                <p><strong>Bonus:</strong> <span style={{ color: '#4caf50' }}>+${currentShift.bonus_amount}</span></p>
+              )}
+              <p><strong>Status:</strong> {getStatusBadge(currentShift.status)}</p>
+              {currentShift.notes && <p><strong>Notes:</strong> {currentShift.notes}</p>}
+
+              <hr style={{ margin: '1rem 0' }} />
+              
+              <h4>Claims ({claims.length})</h4>
+              {claims.length === 0 ? (
+                <p style={{ color: '#666' }}>No caregivers have claimed this shift yet.</p>
+              ) : (
+                <table className="table">
+                  <thead>
+                    <tr>
+                      <th>Caregiver</th>
+                      <th>Phone</th>
+                      <th>Status</th>
+                      <th>Submitted</th>
+                    </tr>
+                  </thead>
+                  <tbody>
+                    {claims.map(claim => (
+                      <tr key={claim.id}>
+                        <td>{claim.first_name} {claim.last_name}</td>
+                        <td>{claim.phone}</td>
+                        <td>{claim.status}</td>
+                        <td>{new Date(claim.created_at).toLocaleString()}</td>
+                      </tr>
+                    ))}
+                  </tbody>
+                </table>
+              )}
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Create Shift Form Component
+const CreateShiftForm = ({ clients, careTypes, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    clientId: '',
+    shiftDate: '',
+    startTime: '08:00',
+    endTime: '16:00',
+    careTypeId: '',
+    hourlyRate: '',
+    bonusAmount: '0',
+    urgency: 'normal',
+    notes: ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.clientId || !formData.shiftDate) {
+      alert('Client and date are required');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Client *</label>
+        <select 
+          value={formData.clientId} 
+          onChange={(e) => setFormData({ ...formData, clientId: e.target.value })}
+          required
+        >
+          <option value="">Select Client</option>
+          {clients.filter(c => c.status === 'active').map(c => (
+            <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Date *</label>
+          <input 
+            type="date" 
+            value={formData.shiftDate}
+            onChange={(e) => setFormData({ ...formData, shiftDate: e.target.value })}
+            required
+          />
+        </div>
+        <div className="form-group">
+          <label>Start Time</label>
+          <input 
+            type="time" 
+            value={formData.startTime}
+            onChange={(e) => setFormData({ ...formData, startTime: e.target.value })}
+          />
+        </div>
+        <div className="form-group">
+          <label>End Time</label>
+          <input 
+            type="time" 
+            value={formData.endTime}
+            onChange={(e) => setFormData({ ...formData, endTime: e.target.value })}
+          />
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Care Type</label>
+        <select 
+          value={formData.careTypeId}
+          onChange={(e) => setFormData({ ...formData, careTypeId: e.target.value })}
+        >
+          <option value="">Select Care Type</option>
+          {careTypes.map(ct => (
+            <option key={ct.id} value={ct.id}>{ct.name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem' }}>
+        <div className="form-group">
+          <label>Hourly Rate ($)</label>
+          <input 
+            type="number" 
+            step="0.01"
+            value={formData.hourlyRate}
+            onChange={(e) => setFormData({ ...formData, hourlyRate: e.target.value })}
+            placeholder="20.00"
+          />
+        </div>
+        <div className="form-group">
+          <label>Bonus ($)</label>
+          <input 
+            type="number" 
+            step="0.01"
+            value={formData.bonusAmount}
+            onChange={(e) => setFormData({ ...formData, bonusAmount: e.target.value })}
+            placeholder="0.00"
+          />
+        </div>
+        <div className="form-group">
+          <label>Urgency</label>
+          <select 
+            value={formData.urgency}
+            onChange={(e) => setFormData({ ...formData, urgency: e.target.value })}
+          >
+            <option value="normal">Normal</option>
+            <option value="high">High</option>
+            <option value="critical">Critical</option>
+          </select>
+        </div>
+      </div>
+
+      <div className="form-group">
+        <label>Notes</label>
+        <textarea 
+          value={formData.notes}
+          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
+          placeholder="Any special requirements..."
+        />
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Post Shift</button>
+      </div>
+    </form>
+  );
+};
+
+export default OpenShifts;
diff --git a/templates/crm-homecare/frontend/src/components/admin/PayrollProcessing.jsx b/templates/crm-homecare/frontend/src/components/admin/PayrollProcessing.jsx
new file mode 100644
index 0000000..d13e8c6
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/PayrollProcessing.jsx
@@ -0,0 +1,821 @@
+import { toast } from '../Toast';
+// src/components/admin/PayrollProcessing.jsx
+// Complete payroll: Overtime, Mileage, PTO, Shift Differentials, Pay Stubs, Exports
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const PayrollProcessing = ({ token }) => {
+  const [payPeriod, setPayPeriod] = useState({
+    startDate: new Date(new Date().setDate(new Date().getDate() - 14)).toISOString().split('T')[0],
+    endDate: new Date().toISOString().split('T')[0]
+  });
+  const [payrollData, setPayrollData] = useState([]);
+  const [loading, setLoading] = useState(false);
+  const [selectedPayroll, setSelectedPayroll] = useState(null);
+  const [filter, setFilter] = useState('all');
+  const [message, setMessage] = useState('');
+  const [showPayStubModal, setShowPayStubModal] = useState(false);
+  const [showMileageModal, setShowMileageModal] = useState(false);
+  const [showPTOModal, setShowPTOModal] = useState(false);
+  const [showSettingsModal, setShowSettingsModal] = useState(false);
+  const [caregivers, setCaregivers] = useState([]);
+  const [activeTab, setActiveTab] = useState('payroll');
+  const [discrepancies, setDiscrepancies] = useState(null);
+  const [discrepancyLoading, setDiscrepancyLoading] = useState(false);
+  
+  // Payroll settings
+  const [settings, setSettings] = useState({
+    overtimeThreshold: 40,
+    overtimeRate: 1.5,
+    dailyOvertimeEnabled: false,
+    dailyOvertimeThreshold: 8,
+    weekendDifferential: 0,
+    nightDifferential: 0,
+    mileageRate: 0.67, // 2024 IRS rate
+    federalTaxRate: 0.22,
+    stateTaxRate: 0.0765, // WI rate
+    socialSecurityRate: 0.062,
+    medicareRate: 0.0145
+  });
+
+  // Mileage form
+  const [mileageForm, setMileageForm] = useState({
+    caregiverId: '',
+    date: new Date().toISOString().split('T')[0],
+    miles: '',
+    fromLocation: '',
+    toLocation: '',
+    notes: ''
+  });
+
+  // PTO form
+  const [ptoForm, setPtoForm] = useState({
+    caregiverId: '',
+    type: 'vacation',
+    startDate: '',
+    endDate: '',
+    hours: '',
+    notes: ''
+  });
+
+  useEffect(() => {
+    loadCaregivers();
+    calculatePayroll();
+  }, []);
+
+  const loadCaregivers = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      setCaregivers(await response.json());
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+    }
+  };
+
+  const calculatePayroll = async () => {
+    setLoading(true);
+    setMessage('');
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/calculate`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          startDate: payPeriod.startDate,
+          endDate: payPeriod.endDate,
+          settings
+        })
+      });
+      const data = await response.json();
+      
+      // Enhance payroll data with calculations
+      const enhanced = (data.payrollData || []).map(p => {
+        const regularHours = Math.min(p.total_hours || 0, settings.overtimeThreshold);
+        const overtimeHours = Math.max((p.total_hours || 0) - settings.overtimeThreshold, 0);
+        const hourlyRate = parseFloat(p.hourly_rate || 15);
+        
+        const regularPay = regularHours * hourlyRate;
+        const overtimePay = overtimeHours * hourlyRate * settings.overtimeRate;
+        const mileageReimbursement = parseFloat(p.total_miles || 0) * settings.mileageRate;
+        const weekendPay = parseFloat(p.weekend_hours || 0) * settings.weekendDifferential;
+        const nightPay = parseFloat(p.night_hours || 0) * settings.nightDifferential;
+        const ptoPay = parseFloat(p.pto_hours || 0) * hourlyRate;
+        
+        const grossPay = regularPay + overtimePay + mileageReimbursement + weekendPay + nightPay + ptoPay;
+        
+        const federalTax = grossPay * settings.federalTaxRate;
+        const stateTax = grossPay * settings.stateTaxRate;
+        const socialSecurity = grossPay * settings.socialSecurityRate;
+        const medicare = grossPay * settings.medicareRate;
+        const totalDeductions = federalTax + stateTax + socialSecurity + medicare;
+        
+        const netPay = grossPay - totalDeductions + mileageReimbursement; // Mileage is reimbursement, not taxed
+        
+        return {
+          ...p,
+          regular_hours: regularHours,
+          overtime_hours: overtimeHours,
+          regular_pay: regularPay,
+          overtime_pay: overtimePay,
+          mileage_reimbursement: mileageReimbursement,
+          weekend_pay: weekendPay,
+          night_pay: nightPay,
+          pto_pay: ptoPay,
+          gross_pay: grossPay,
+          federal_tax: federalTax,
+          state_tax: stateTax,
+          social_security: socialSecurity,
+          medicare: medicare,
+          total_deductions: totalDeductions,
+          net_pay: netPay,
+          status: p.status || 'draft'
+        };
+      });
+      
+      setPayrollData(enhanced);
+    } catch (error) {
+      setMessage('Error: Failed to calculate payroll');
+      console.error('Failed to calculate payroll:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleApprovePayroll = async (caregiverId) => {
+    try {
+      await fetch(`${API_BASE_URL}/api/payroll/${caregiverId}/approve`, {
+        method: 'POST',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      setPayrollData(payrollData.map(p => p.caregiver_id === caregiverId ? { ...p, status: 'approved' } : p));
+      setMessage('✓ Payroll approved');
+      setTimeout(() => setMessage(''), 2000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleApproveAll = async () => {
+    const drafts = payrollData.filter(p => p.status === 'draft');
+    for (const p of drafts) {
+      await handleApprovePayroll(p.caregiver_id);
+    }
+    setMessage(`✓ Approved ${drafts.length} payroll records`);
+    setTimeout(() => setMessage(''), 3000);
+  };
+
+  const handleProcessPaycheck = async (caregiverId) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/${caregiverId}/process`, {
+        method: 'POST',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const result = await response.json();
+      setPayrollData(payrollData.map(p => p.caregiver_id === caregiverId ? { ...p, status: 'processed', check_number: result.checkNumber } : p));
+      setMessage(`✓ Check #${result.checkNumber} processed`);
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleAddMileage = async (e) => {
+    e.preventDefault();
+    try {
+      await fetch(`${API_BASE_URL}/api/mileage`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(mileageForm)
+      });
+      setMileageForm({ caregiverId: '', date: new Date().toISOString().split('T')[0], miles: '', fromLocation: '', toLocation: '', notes: '' });
+      setShowMileageModal(false);
+      setMessage('✓ Mileage recorded');
+      setTimeout(() => setMessage(''), 2000);
+      calculatePayroll();
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleAddPTO = async (e) => {
+    e.preventDefault();
+    try {
+      await fetch(`${API_BASE_URL}/api/pto`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify(ptoForm)
+      });
+      setPtoForm({ caregiverId: '', type: 'vacation', startDate: '', endDate: '', hours: '', notes: '' });
+      setShowPTOModal(false);
+      setMessage('✓ PTO recorded');
+      setTimeout(() => setMessage(''), 2000);
+      calculatePayroll();
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const handleExportPayroll = async (format) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/export`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ startDate: payPeriod.startDate, endDate: payPeriod.endDate, format })
+      });
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `payroll-${payPeriod.startDate}-to-${payPeriod.endDate}.${format}`;
+      a.click();
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const handleExportQuickBooks = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/export/quickbooks`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ startDate: payPeriod.startDate, endDate: payPeriod.endDate, payrollData })
+      });
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `quickbooks-payroll-${payPeriod.startDate}.iif`;
+      a.click();
+      setMessage('✓ QuickBooks export downloaded');
+      setTimeout(() => setMessage(''), 3000);
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const generatePayStub = (payroll) => {
+    setSelectedPayroll(payroll);
+    setShowPayStubModal(true);
+  };
+
+  const printPayStub = () => {
+    window.print();
+  };
+
+  const filteredPayroll = payrollData.filter(p => filter === 'all' || p.status === filter);
+
+  const totals = {
+    totalHours: payrollData.reduce((sum, p) => sum + (p.total_hours || 0), 0),
+    totalOvertimeHours: payrollData.reduce((sum, p) => sum + (p.overtime_hours || 0), 0),
+    totalMiles: payrollData.reduce((sum, p) => sum + parseFloat(p.total_miles || 0), 0),
+    totalGrossPay: payrollData.reduce((sum, p) => sum + (p.gross_pay || 0), 0),
+    totalDeductions: payrollData.reduce((sum, p) => sum + (p.total_deductions || 0), 0),
+    totalNetPay: payrollData.reduce((sum, p) => sum + (p.net_pay || 0), 0),
+    totalMileageReimbursement: payrollData.reduce((sum, p) => sum + (p.mileage_reimbursement || 0), 0)
+  };
+
+  const getStatusBadge = (status) => {
+    switch (status) {
+      case 'draft': return 'badge-secondary';
+      case 'approved': return 'badge-warning';
+      case 'processed': return 'badge-info';
+      case 'paid': return 'badge-success';
+      default: return 'badge-secondary';
+    }
+  };
+
+  const formatCurrency = (amount) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount || 0);
+
+  const loadDiscrepancies = async () => {
+    setDiscrepancyLoading(true);
+    try {
+      const r = await fetch(`${API_BASE_URL}/api/payroll/discrepancies?startDate=${payPeriod.startDate}&endDate=${payPeriod.endDate}`, {
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      if (r.ok) setDiscrepancies(await r.json());
+    } catch(e) {}
+    setDiscrepancyLoading(false);
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>💰 Payroll Processing</h2>
+        <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+          <button className="btn btn-primary" onClick={() => setShowMileageModal(true)}>🚗 Add Mileage</button>
+          <button className="btn btn-primary" onClick={() => setShowPTOModal(true)}>🏖️ Add PTO</button>
+          <button className="btn btn-secondary" onClick={() => setShowSettingsModal(true)}>⚙️ Settings</button>
+          <button className="btn btn-secondary" onClick={() => handleExportPayroll('csv')}>📥 CSV</button>
+          <button className="btn btn-secondary" onClick={handleExportQuickBooks}>📤 QuickBooks</button>
+        </div>
+      </div>
+
+      {message && <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>{message}</div>}
+
+      {/* Tab selector */}
+      <div style={{ display: 'flex', gap: 0, borderBottom: '2px solid #E5E7EB', marginBottom: '1.25rem' }}>
+        {[['payroll','💰 Payroll'],['discrepancies','⚠️ Hour Discrepancies']].map(([id,label]) => (
+          <button key={id} onClick={() => { setActiveTab(id); if(id==='discrepancies') loadDiscrepancies(); }}
+            style={{ padding:'0.55rem 1.25rem', border:'none', background:'none', cursor:'pointer',
+              fontWeight: activeTab===id ? 800 : 500, fontSize:'0.875rem',
+              color: activeTab===id ? '#2ABBA7' : '#6B7280',
+              borderBottom: `2px solid ${activeTab===id ? '#2ABBA7' : 'transparent'}`,
+              marginBottom: -2 }}>
+            {label}
+          </button>
+        ))}
+      </div>
+
+      {/* Discrepancies Tab */}
+      {activeTab === 'discrepancies' && (
+        <div>
+          <div style={{ background:'#FEF3C7', border:'1px solid #FCD34D', borderRadius:12, padding:'1rem 1.25rem', marginBottom:'1rem', fontSize:'0.875rem', color:'#92400E' }}>
+            <strong>📋 How payroll hours work:</strong> Caregivers are paid for <strong>allotted hours only</strong> — the hours authorized per client per shift. 
+            If a caregiver clocks in late, their shift end adjusts forward by the late amount so they still get their full allotted time. 
+            If they work over their allotted hours, only the allotted hours are billable. Discrepancies of 5+ minutes are flagged here.
+          </div>
+          <div style={{ display:'flex', gap:'0.75rem', marginBottom:'1rem', flexWrap:'wrap', alignItems:'flex-end' }}>
+            <div>
+              <label style={{ display:'block', fontWeight:700, fontSize:'0.75rem', color:'#6B7280', marginBottom:4 }}>FROM</label>
+              <input type="date" value={payPeriod.startDate} onChange={e=>setPayPeriod(p=>({...p,startDate:e.target.value}))}
+                style={{ padding:'0.5rem', border:'1px solid #D1D5DB', borderRadius:8, fontSize:'0.875rem' }}/>
+            </div>
+            <div>
+              <label style={{ display:'block', fontWeight:700, fontSize:'0.75rem', color:'#6B7280', marginBottom:4 }}>TO</label>
+              <input type="date" value={payPeriod.endDate} onChange={e=>setPayPeriod(p=>({...p,endDate:e.target.value}))}
+                style={{ padding:'0.5rem', border:'1px solid #D1D5DB', borderRadius:8, fontSize:'0.875rem' }}/>
+            </div>
+            <button onClick={loadDiscrepancies} style={{ padding:'0.55rem 1.25rem', background:'#2ABBA7', color:'#fff', border:'none', borderRadius:8, cursor:'pointer', fontWeight:700 }}>
+              {discrepancyLoading ? 'Loading...' : 'Run Report'}
+            </button>
+          </div>
+
+          {discrepancies && (
+            <>
+              {/* Summary */}
+              <div style={{ display:'flex', gap:'0.75rem', marginBottom:'1rem', flexWrap:'wrap' }}>
+                {[
+                  { label:'Shifts with Discrepancies', val: discrepancies.totals.totalShifts, color:'#6366F1' },
+                  { label:'Over Allotted', val: discrepancies.totals.overageCount + ' shifts', color:'#EF4444' },
+                  { label:'Under Allotted', val: discrepancies.totals.underageCount + ' shifts', color:'#F59E0B' },
+                  { label:'Total Overage Cost', val: '$' + parseFloat(discrepancies.totals.totalOverageCost||0).toFixed(2), color:'#DC2626' },
+                ].map(s => (
+                  <div key={s.label} style={{ flex:1, minWidth:140, padding:'1rem', background:'#F9FAFB', borderRadius:12, borderLeft:`4px solid ${s.color}` }}>
+                    <div style={{ fontSize:'1.25rem', fontWeight:800, color:s.color }}>{s.val}</div>
+                    <div style={{ fontSize:'0.72rem', color:'#6B7280', marginTop:2 }}>{s.label}</div>
+                  </div>
+                ))}
+              </div>
+
+              {/* Table */}
+              {discrepancies.discrepancies.length === 0 ? (
+                <div style={{ textAlign:'center', padding:'2rem', color:'#9CA3AF', background:'#F9FAFB', borderRadius:12 }}>
+                  ✅ No significant discrepancies found in this period
+                </div>
+              ) : (
+                <div style={{ overflowX:'auto' }}>
+                  <table style={{ width:'100%', borderCollapse:'collapse', fontSize:'0.82rem' }}>
+                    <thead>
+                      <tr style={{ background:'#F9FAFB' }}>
+                        {['Caregiver','Client','Date','Allotted','Actual','Billable','Discrepancy','Allotted Pay','Actual Cost','Overage $'].map(h => (
+                          <th key={h} style={{ padding:'0.5rem 0.75rem', textAlign:'left', fontWeight:700, color:'#374151', borderBottom:'1px solid #E5E7EB', whiteSpace:'nowrap' }}>{h}</th>
+                        ))}
+                      </tr>
+                    </thead>
+                    <tbody>
+                      {discrepancies.discrepancies.map(d => {
+                        const over = parseFloat(d.discrepancy_hours) > 0;
+                        const under = parseFloat(d.discrepancy_hours) < 0;
+                        return (
+                          <tr key={d.id} style={{ borderBottom:'1px solid #F3F4F6', background: over ? '#FFF5F5' : under ? '#FFFBEB' : '#fff' }}>
+                            <td style={{ padding:'0.5rem 0.75rem', fontWeight:600 }}>{d.caregiver_first} {d.caregiver_last}</td>
+                            <td style={{ padding:'0.5rem 0.75rem' }}>{d.client_first} {d.client_last}</td>
+                            <td style={{ padding:'0.5rem 0.75rem', color:'#6B7280' }}>{new Date(d.start_time).toLocaleDateString('en-US',{month:'short',day:'numeric'})}</td>
+                            <td style={{ padding:'0.5rem 0.75rem' }}>{d.allotted_hours}h</td>
+                            <td style={{ padding:'0.5rem 0.75rem' }}>{d.actual_hours}h</td>
+                            <td style={{ padding:'0.5rem 0.75rem', fontWeight:700, color:'#2ABBA7' }}>{d.billable_hours}h</td>
+                            <td style={{ padding:'0.5rem 0.75rem', fontWeight:700, color: over?'#DC2626':under?'#F59E0B':'#374151' }}>
+                              {over ? '+' : ''}{d.discrepancy_hours}h {over ? '⚠️ Over' : under ? '⬇️ Short' : ''}
+                            </td>
+                            <td style={{ padding:'0.5rem 0.75rem', color:'#065F46' }}>${d.billable_pay}</td>
+                            <td style={{ padding:'0.5rem 0.75rem', color:'#6B7280' }}>${d.actual_pay}</td>
+                            <td style={{ padding:'0.5rem 0.75rem', fontWeight:700, color: over?'#DC2626':'#9CA3AF' }}>
+                              {over ? `$${d.overage_cost}` : '—'}
+                            </td>
+                          </tr>
+                        );
+                      })}
+                    </tbody>
+                  </table>
+                </div>
+              )}
+            </>
+          )}
+        </div>
+      )}
+
+      {activeTab === 'payroll' && (
+      <div>
+      {/* Summary Cards */}
+      <div className="grid">
+        <div className="stat-card">
+          <h3>Total Hours</h3>
+          <div className="value">{totals.totalHours.toFixed(2)}</div>
+          <div className="stat-subtext">{totals.totalOvertimeHours.toFixed(2)} overtime</div>
+        </div>
+        <div className="stat-card">
+          <h3>Gross Pay</h3>
+          <div className="value">{formatCurrency(totals.totalGrossPay)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Deductions</h3>
+          <div className="value" style={{ color: '#dc3545' }}>{formatCurrency(totals.totalDeductions)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Net Pay</h3>
+          <div className="value" style={{ color: '#28a745' }}>{formatCurrency(totals.totalNetPay)}</div>
+        </div>
+        <div className="stat-card">
+          <h3>Mileage</h3>
+          <div className="value">{totals.totalMiles.toFixed(2)} mi</div>
+          <div className="stat-subtext">{formatCurrency(totals.totalMileageReimbursement)} reimbursement</div>
+        </div>
+      </div>
+
+      {/* Pay Period Selection */}
+      <div className="card">
+        <h3>Pay Period</h3>
+        <div style={{ display: 'flex', gap: '1rem', alignItems: 'flex-end', flexWrap: 'wrap' }}>
+          <div className="form-group" style={{ marginBottom: 0 }}>
+            <label>Start Date</label>
+            <input type="date" value={payPeriod.startDate} onChange={(e) => setPayPeriod({ ...payPeriod, startDate: e.target.value })} />
+          </div>
+          <div className="form-group" style={{ marginBottom: 0 }}>
+            <label>End Date</label>
+            <input type="date" value={payPeriod.endDate} onChange={(e) => setPayPeriod({ ...payPeriod, endDate: e.target.value })} />
+          </div>
+          <button className="btn btn-primary" onClick={calculatePayroll} disabled={loading}>{loading ? 'Calculating...' : 'Calculate'}</button>
+          <button className="btn btn-success" onClick={handleApproveAll} disabled={!payrollData.some(p => p.status === 'draft')}>Approve All</button>
+        </div>
+      </div>
+
+      {/* Status Filters */}
+      <div className="card">
+        <div className="filter-tabs">
+          {['all', 'draft', 'approved', 'processed', 'paid'].map(f => (
+            <button key={f} className={`filter-tab ${filter === f ? 'active' : ''}`} onClick={() => setFilter(f)}>
+              {f.charAt(0).toUpperCase() + f.slice(1)}
+              <span className="filter-count">({payrollData.filter(p => f === 'all' || p.status === f).length})</span>
+            </button>
+          ))}
+        </div>
+      </div>
+
+      {/* Payroll Table */}
+      {loading ? (
+        <div className="loading"><div className="spinner"></div></div>
+      ) : filteredPayroll.length === 0 ? (
+        <div className="card card-centered"><p>No payroll data for this period.</p></div>
+      ) : (
+        <table className="table">
+          <thead>
+            <tr>
+              <th>Caregiver</th>
+              <th>Regular</th>
+              <th>OT</th>
+              <th>PTO</th>
+              <th>Miles</th>
+              <th>Rate</th>
+              <th>Gross</th>
+              <th>Deduct</th>
+              <th>Net</th>
+              <th>Status</th>
+              <th>Actions</th>
+            </tr>
+          </thead>
+          <tbody>
+            {filteredPayroll.map(payroll => (
+              <tr key={payroll.caregiver_id}>
+                <td><strong>{payroll.first_name} {payroll.last_name}</strong></td>
+                <td>{payroll.regular_hours?.toFixed(2)}</td>
+                <td style={{ color: payroll.overtime_hours > 0 ? '#fd7e14' : undefined }}>{payroll.overtime_hours?.toFixed(2)}</td>
+                <td>{payroll.pto_hours?.toFixed(2) || '0.0'}</td>
+                <td>{parseFloat(payroll.total_miles || 0).toFixed(2)}</td>
+                <td>${payroll.hourly_rate?.toFixed(2)}</td>
+                <td style={{ color: '#28a745' }}>{formatCurrency(payroll.gross_pay)}</td>
+                <td style={{ color: '#dc3545' }}>{formatCurrency(payroll.total_deductions)}</td>
+                <td><strong style={{ color: '#2196f3' }}>{formatCurrency(payroll.net_pay)}</strong></td>
+                <td><span className={`badge ${getStatusBadge(payroll.status)}`}>{payroll.status?.toUpperCase()}</span></td>
+                <td>
+                  <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap' }}>
+                    <button className="btn btn-sm btn-primary" onClick={() => generatePayStub(payroll)}>Stub</button>
+                    {payroll.status === 'draft' && <button className="btn btn-sm btn-warning" onClick={() => handleApprovePayroll(payroll.caregiver_id)}>Approve</button>}
+                    {payroll.status === 'approved' && <button className="btn btn-sm btn-success" onClick={() => handleProcessPaycheck(payroll.caregiver_id)}>Process</button>}
+                  </div>
+                </td>
+              </tr>
+            ))}
+          </tbody>
+        </table>
+      )}
+
+      {/* Totals Summary */}
+      {filteredPayroll.length > 0 && (
+        <div className="card" style={{ marginTop: '1rem', background: '#f5f5f5' }}>
+          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '1rem' }}>
+            <div><p style={{ margin: 0, fontSize: '0.85rem', color: '#666' }}>Total Hours</p><p style={{ margin: '0.25rem 0 0', fontSize: '1.3rem', fontWeight: 'bold' }}>{totals.totalHours.toFixed(2)}</p></div>
+            <div><p style={{ margin: 0, fontSize: '0.85rem', color: '#666' }}>Overtime</p><p style={{ margin: '0.25rem 0 0', fontSize: '1.3rem', fontWeight: 'bold', color: '#fd7e14' }}>{totals.totalOvertimeHours.toFixed(2)}</p></div>
+            <div><p style={{ margin: 0, fontSize: '0.85rem', color: '#666' }}>Gross Pay</p><p style={{ margin: '0.25rem 0 0', fontSize: '1.3rem', fontWeight: 'bold', color: '#28a745' }}>{formatCurrency(totals.totalGrossPay)}</p></div>
+            <div><p style={{ margin: 0, fontSize: '0.85rem', color: '#666' }}>Deductions</p><p style={{ margin: '0.25rem 0 0', fontSize: '1.3rem', fontWeight: 'bold', color: '#dc3545' }}>{formatCurrency(totals.totalDeductions)}</p></div>
+            <div><p style={{ margin: 0, fontSize: '0.85rem', color: '#666' }}>Net Pay</p><p style={{ margin: '0.25rem 0 0', fontSize: '1.3rem', fontWeight: 'bold', color: '#2196f3' }}>{formatCurrency(totals.totalNetPay)}</p></div>
+          </div>
+        </div>
+      )}
+
+      {/* PAY STUB MODAL */}
+      {showPayStubModal && selectedPayroll && (
+        <div className="modal active">
+          <div className="modal-content modal-large" id="pay-stub">
+            <div className="modal-header">
+              <h2>Pay Stub</h2>
+              <button className="close-btn" onClick={() => setShowPayStubModal(false)}>×</button>
+            </div>
+            
+            <div style={{ border: '2px solid #333', padding: '1.5rem', background: 'white' }}>
+              {/* Company Header */}
+              <div style={{ textAlign: 'center', marginBottom: '1.5rem', borderBottom: '2px solid #333', paddingBottom: '1rem' }}>
+                <h2 style={{ margin: 0, color: '#1E9A89' }}>Chippewa Valley Home Care</h2>
+                <p style={{ margin: '0.25rem 0 0', color: '#666' }}>Pay Statement</p>
+              </div>
+
+              {/* Employee & Pay Period Info */}
+              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1.5rem' }}>
+                <div>
+                  <p style={{ margin: 0 }}><strong>Employee:</strong> {selectedPayroll.first_name} {selectedPayroll.last_name}</p>
+                  <p style={{ margin: '0.25rem 0 0' }}><strong>Employee ID:</strong> {selectedPayroll.caregiver_id}</p>
+                </div>
+                <div style={{ textAlign: 'right' }}>
+                  <p style={{ margin: 0 }}><strong>Pay Period:</strong> {payPeriod.startDate} to {payPeriod.endDate}</p>
+                  <p style={{ margin: '0.25rem 0 0' }}><strong>Pay Date:</strong> {new Date().toLocaleDateString()}</p>
+                  {selectedPayroll.check_number && <p style={{ margin: '0.25rem 0 0' }}><strong>Check #:</strong> {selectedPayroll.check_number}</p>}
+                </div>
+              </div>
+
+              {/* Earnings */}
+              <div style={{ marginBottom: '1.5rem' }}>
+                <h4 style={{ borderBottom: '1px solid #333', paddingBottom: '0.25rem', marginBottom: '0.5rem' }}>Earnings</h4>
+                <table style={{ width: '100%', borderCollapse: 'collapse' }}>
+                  <thead>
+                    <tr style={{ background: '#f0f0f0' }}>
+                      <th style={{ padding: '0.5rem', textAlign: 'left', border: '1px solid #ddd' }}>Description</th>
+                      <th style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>Hours</th>
+                      <th style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>Rate</th>
+                      <th style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>Amount</th>
+                    </tr>
+                  </thead>
+                  <tbody>
+                    <tr>
+                      <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Regular Hours</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{selectedPayroll.regular_hours?.toFixed(2)}</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>${selectedPayroll.hourly_rate?.toFixed(2)}</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.regular_pay)}</td>
+                    </tr>
+                    {selectedPayroll.overtime_hours > 0 && (
+                      <tr>
+                        <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Overtime (1.5x)</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{selectedPayroll.overtime_hours?.toFixed(2)}</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>${(selectedPayroll.hourly_rate * settings.overtimeRate).toFixed(2)}</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.overtime_pay)}</td>
+                      </tr>
+                    )}
+                    {selectedPayroll.pto_hours > 0 && (
+                      <tr>
+                        <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>PTO</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{selectedPayroll.pto_hours?.toFixed(2)}</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>${selectedPayroll.hourly_rate?.toFixed(2)}</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.pto_pay)}</td>
+                      </tr>
+                    )}
+                    {selectedPayroll.mileage_reimbursement > 0 && (
+                      <tr>
+                        <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Mileage Reimbursement</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{parseFloat(selectedPayroll.total_miles || 0).toFixed(2)} mi</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>${settings.mileageRate}/mi</td>
+                        <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.mileage_reimbursement)}</td>
+                      </tr>
+                    )}
+                  </tbody>
+                  <tfoot>
+                    <tr style={{ background: '#f0f0f0', fontWeight: 'bold' }}>
+                      <td colSpan="3" style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>Gross Pay</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.gross_pay)}</td>
+                    </tr>
+                  </tfoot>
+                </table>
+              </div>
+
+              {/* Deductions */}
+              <div style={{ marginBottom: '1.5rem' }}>
+                <h4 style={{ borderBottom: '1px solid #333', paddingBottom: '0.25rem', marginBottom: '0.5rem' }}>Deductions</h4>
+                <table style={{ width: '100%', borderCollapse: 'collapse' }}>
+                  <tbody>
+                    <tr>
+                      <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Federal Income Tax</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.federal_tax)}</td>
+                    </tr>
+                    <tr>
+                      <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>State Income Tax (WI)</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.state_tax)}</td>
+                    </tr>
+                    <tr>
+                      <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Social Security</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.social_security)}</td>
+                    </tr>
+                    <tr>
+                      <td style={{ padding: '0.5rem', border: '1px solid #ddd' }}>Medicare</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>{formatCurrency(selectedPayroll.medicare)}</td>
+                    </tr>
+                  </tbody>
+                  <tfoot>
+                    <tr style={{ background: '#f0f0f0', fontWeight: 'bold' }}>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd' }}>Total Deductions</td>
+                      <td style={{ padding: '0.5rem', textAlign: 'right', border: '1px solid #ddd', color: '#dc3545' }}>{formatCurrency(selectedPayroll.total_deductions)}</td>
+                    </tr>
+                  </tfoot>
+                </table>
+              </div>
+
+              {/* Net Pay */}
+              <div style={{ background: '#e8f5e9', padding: '1rem', borderRadius: '8px', textAlign: 'center' }}>
+                <h3 style={{ margin: 0, color: '#666' }}>Net Pay</h3>
+                <p style={{ margin: '0.5rem 0 0', fontSize: '2rem', fontWeight: 'bold', color: '#28a745' }}>{formatCurrency(selectedPayroll.net_pay)}</p>
+              </div>
+            </div>
+
+            <div className="modal-actions">
+              <button className="btn btn-primary" onClick={printPayStub}>🖨️ Print</button>
+              <button className="btn btn-secondary" onClick={() => setShowPayStubModal(false)}>Close</button>
+            </div>
+          </div>
+        </div>
+      )}
+
+      {/* MILEAGE MODAL */}
+      {showMileageModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header">
+              <h2>🚗 Add Mileage</h2>
+              <button className="close-btn" onClick={() => setShowMileageModal(false)}>×</button>
+            </div>
+            <form onSubmit={handleAddMileage}>
+              <div className="form-group">
+                <label>Caregiver *</label>
+                <select value={mileageForm.caregiverId} onChange={(e) => setMileageForm({ ...mileageForm, caregiverId: e.target.value })} required>
+                  <option value="">Select caregiver...</option>
+                  {caregivers.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+                </select>
+              </div>
+              <div className="form-grid-2">
+                <div className="form-group"><label>Date *</label><input type="date" value={mileageForm.date} onChange={(e) => setMileageForm({ ...mileageForm, date: e.target.value })} required /></div>
+                <div className="form-group"><label>Miles *</label><input type="number" step="0.1" min="0" value={mileageForm.miles} onChange={(e) => setMileageForm({ ...mileageForm, miles: e.target.value })} required /></div>
+                <div className="form-group"><label>From</label><input type="text" value={mileageForm.fromLocation} onChange={(e) => setMileageForm({ ...mileageForm, fromLocation: e.target.value })} placeholder="Starting location" /></div>
+                <div className="form-group"><label>To</label><input type="text" value={mileageForm.toLocation} onChange={(e) => setMileageForm({ ...mileageForm, toLocation: e.target.value })} placeholder="Destination" /></div>
+              </div>
+              <div className="form-group"><label>Notes</label><textarea value={mileageForm.notes} onChange={(e) => setMileageForm({ ...mileageForm, notes: e.target.value })} rows="2" /></div>
+              <p className="text-muted">Current IRS rate: ${settings.mileageRate}/mile</p>
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Add Mileage</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowMileageModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* PTO MODAL */}
+      {showPTOModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header">
+              <h2>🏖️ Add PTO / Time Off</h2>
+              <button className="close-btn" onClick={() => setShowPTOModal(false)}>×</button>
+            </div>
+            <form onSubmit={handleAddPTO}>
+              <div className="form-group">
+                <label>Caregiver *</label>
+                <select value={ptoForm.caregiverId} onChange={(e) => setPtoForm({ ...ptoForm, caregiverId: e.target.value })} required>
+                  <option value="">Select caregiver...</option>
+                  {caregivers.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+                </select>
+              </div>
+              <div className="form-group">
+                <label>Type *</label>
+                <select value={ptoForm.type} onChange={(e) => setPtoForm({ ...ptoForm, type: e.target.value })}>
+                  <option value="vacation">Vacation</option>
+                  <option value="sick">Sick Leave</option>
+                  <option value="personal">Personal Day</option>
+                  <option value="bereavement">Bereavement</option>
+                  <option value="jury_duty">Jury Duty</option>
+                  <option value="unpaid">Unpaid Leave</option>
+                </select>
+              </div>
+              <div className="form-grid-2">
+                <div className="form-group"><label>Start Date *</label><input type="date" value={ptoForm.startDate} onChange={(e) => setPtoForm({ ...ptoForm, startDate: e.target.value })} required /></div>
+                <div className="form-group"><label>End Date *</label><input type="date" value={ptoForm.endDate} onChange={(e) => setPtoForm({ ...ptoForm, endDate: e.target.value })} required /></div>
+              </div>
+              <div className="form-group"><label>Hours *</label><input type="number" step="0.5" min="0" value={ptoForm.hours} onChange={(e) => setPtoForm({ ...ptoForm, hours: e.target.value })} required /></div>
+              <div className="form-group"><label>Notes</label><textarea value={ptoForm.notes} onChange={(e) => setPtoForm({ ...ptoForm, notes: e.target.value })} rows="2" /></div>
+              <div className="modal-actions">
+                <button type="submit" className="btn btn-primary">Add PTO</button>
+                <button type="button" className="btn btn-secondary" onClick={() => setShowPTOModal(false)}>Cancel</button>
+              </div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* SETTINGS MODAL */}
+      {showSettingsModal && (
+        <div className="modal active">
+          <div className="modal-content modal-large">
+            <div className="modal-header">
+              <h2>⚙️ Payroll Settings</h2>
+              <button className="close-btn" onClick={() => setShowSettingsModal(false)}>×</button>
+            </div>
+            
+            <div className="form-section">
+              <h3>Overtime Rules</h3>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Weekly OT Threshold (hours)</label>
+                  <input type="number" value={settings.overtimeThreshold} onChange={(e) => setSettings({ ...settings, overtimeThreshold: parseFloat(e.target.value) })} />
+                </div>
+                <div className="form-group">
+                  <label>OT Rate Multiplier</label>
+                  <input type="number" step="0.1" value={settings.overtimeRate} onChange={(e) => setSettings({ ...settings, overtimeRate: parseFloat(e.target.value) })} />
+                </div>
+              </div>
+            </div>
+
+            <div className="form-section">
+              <h3>Shift Differentials</h3>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Weekend Differential ($/hr)</label>
+                  <input type="number" step="0.25" value={settings.weekendDifferential} onChange={(e) => setSettings({ ...settings, weekendDifferential: parseFloat(e.target.value) })} />
+                </div>
+                <div className="form-group">
+                  <label>Night Differential ($/hr)</label>
+                  <input type="number" step="0.25" value={settings.nightDifferential} onChange={(e) => setSettings({ ...settings, nightDifferential: parseFloat(e.target.value) })} />
+                </div>
+              </div>
+            </div>
+
+            <div className="form-section">
+              <h3>Mileage</h3>
+              <div className="form-group">
+                <label>Mileage Rate ($/mile)</label>
+                <input type="number" step="0.01" value={settings.mileageRate} onChange={(e) => setSettings({ ...settings, mileageRate: parseFloat(e.target.value) })} />
+                <small className="text-muted">2024 IRS standard rate is $0.67/mile</small>
+              </div>
+            </div>
+
+            <div className="form-section">
+              <h3>Tax Rates</h3>
+              <div className="form-grid-2">
+                <div className="form-group">
+                  <label>Federal Tax Rate (%)</label>
+                  <input type="number" step="0.01" value={settings.federalTaxRate * 100} onChange={(e) => setSettings({ ...settings, federalTaxRate: parseFloat(e.target.value) / 100 })} />
+                </div>
+                <div className="form-group">
+                  <label>State Tax Rate (%)</label>
+                  <input type="number" step="0.01" value={settings.stateTaxRate * 100} onChange={(e) => setSettings({ ...settings, stateTaxRate: parseFloat(e.target.value) / 100 })} />
+                </div>
+                <div className="form-group">
+                  <label>Social Security (%)</label>
+                  <input type="number" step="0.01" value={settings.socialSecurityRate * 100} onChange={(e) => setSettings({ ...settings, socialSecurityRate: parseFloat(e.target.value) / 100 })} />
+                </div>
+                <div className="form-group">
+                  <label>Medicare (%)</label>
+                  <input type="number" step="0.01" value={settings.medicareRate * 100} onChange={(e) => setSettings({ ...settings, medicareRate: parseFloat(e.target.value) / 100 })} />
+                </div>
+              </div>
+            </div>
+
+            <div className="modal-actions">
+              <button className="btn btn-primary" onClick={() => { setShowSettingsModal(false); calculatePayroll(); }}>Save & Recalculate</button>
+              <button className="btn btn-secondary" onClick={() => setShowSettingsModal(false)}>Cancel</button>
+            </div>
+          </div>
+        </div>
+      )}
+      </div>
+      )}
+    </div>
+
+  );
+};
+
+export default PayrollProcessing;
diff --git a/templates/crm-homecare/frontend/src/components/admin/PerformanceRatings.jsx b/templates/crm-homecare/frontend/src/components/admin/PerformanceRatings.jsx
new file mode 100644
index 0000000..ecb0857
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/PerformanceRatings.jsx
@@ -0,0 +1,429 @@
+import { confirm } from '../ConfirmModal';
+// src/components/admin/PerformanceRatings.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const PerformanceRatings = ({ token }) => {
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [reviews, setReviews] = useState({});
+  const [selectedCaregiverId, setSelectedCaregiverId] = useState(null);
+  const [showForm, setShowForm] = useState(false);
+  const [message, setMessage] = useState('');
+  const [expandedCaregiverId, setExpandedCaregiverId] = useState(null);
+  const [formData, setFormData] = useState({
+    caregiverId: '',
+    clientId: '',
+    reviewDate: new Date().toISOString().split('T')[0],
+    performanceNotes: '',
+    strengths: '',
+    areasForImprovement: '',
+    overallAssessment: 'satisfactory' // excellent, satisfactory, needs_improvement
+  });
+
+  useEffect(() => {
+    loadData();
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [caregiversRes, clientsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      const caregiversData = await caregiversRes.json();
+      const clientsData = await clientsRes.json();
+
+      setCaregivers(caregiversData);
+      setClients(clientsData);
+      loadReviews(caregiversData);
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadReviews = async (caregiversList) => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/performance-reviews`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await response.json();
+      
+      const reviewsByCaregiver = {};
+      caregiversList.forEach(cg => {
+        reviewsByCaregiver[cg.id] = [];
+      });
+      
+      data.forEach(review => {
+        if (reviewsByCaregiver[review.caregiver_id]) {
+          reviewsByCaregiver[review.caregiver_id].push(review);
+        }
+      });
+
+      setReviews(reviewsByCaregiver);
+    } catch (error) {
+      console.error('Failed to load reviews:', error);
+    }
+  };
+
+  const handleSubmitReview = async (e) => {
+    e.preventDefault();
+    setMessage('');
+
+    if (!formData.caregiverId || !formData.clientId) {
+      setMessage('Caregiver and Client are required');
+      return;
+    }
+
+    if (!formData.performanceNotes.trim()) {
+      setMessage('Performance notes are required');
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/performance-reviews`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          caregiverId: formData.caregiverId,
+          clientId: formData.clientId,
+          reviewDate: formData.reviewDate,
+          performanceNotes: formData.performanceNotes,
+          strengths: formData.strengths,
+          areasForImprovement: formData.areasForImprovement,
+          overallAssessment: formData.overallAssessment
+        })
+      });
+
+      if (!response.ok) {
+        const error = await response.json();
+        throw new Error(error.error || 'Failed to submit review');
+      }
+
+      setMessage('Performance review saved successfully!');
+      setFormData({
+        caregiverId: '',
+        clientId: '',
+        reviewDate: new Date().toISOString().split('T')[0],
+        performanceNotes: '',
+        strengths: '',
+        areasForImprovement: '',
+        overallAssessment: 'satisfactory'
+      });
+      setShowForm(false);
+      loadReviews(caregivers);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const handleDeleteReview = async (reviewId) => {
+    const _cok = await confirm('Delete this review? This cannot be undone.', {danger: true}); if (!_cok) return;
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/performance-reviews/${reviewId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+
+      if (!response.ok) throw new Error('Failed to delete');
+
+      setMessage('Review deleted');
+      setTimeout(() => setMessage(''), 2000);
+      loadReviews(caregivers);
+    } catch (error) {
+      setMessage('Error: ' + error.message);
+    }
+  };
+
+  const getClientName = (clientId) => {
+    const client = clients.find(c => c.id === clientId);
+    return client ? `${client.first_name} ${client.last_name}` : 'Unknown Client';
+  };
+
+  const getAssessmentColor = (assessment) => {
+    switch (assessment) {
+      case 'excellent':
+        return '#4caf50';
+      case 'satisfactory':
+        return '#2196f3';
+      case 'needs_improvement':
+        return '#ff9800';
+      default:
+        return '#999';
+    }
+  };
+
+  const getAssessmentLabel = (assessment) => {
+    switch (assessment) {
+      case 'excellent':
+        return 'Excellent';
+      case 'satisfactory':
+        return 'Satisfactory';
+      case 'needs_improvement':
+        return 'Needs Improvement';
+      default:
+        return assessment;
+    }
+  };
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>Performance Reviews</h2>
+        <button
+          className="btn btn-primary"
+          onClick={() => setShowForm(!showForm)}
+        >
+          {showForm ? 'Cancel' : 'Add Review'}
+        </button>
+      </div>
+
+      {message && (
+        <div className={`alert ${message.includes('Error') ? 'alert-error' : 'alert-success'}`}>
+          {message}
+        </div>
+      )}
+
+      {/* Review Form */}
+      {showForm && (
+        <div className="card card-form">
+          <h3>Add Performance Review</h3>
+          <form onSubmit={handleSubmitReview}>
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Caregiver *</label>
+                <select
+                  value={formData.caregiverId}
+                  onChange={(e) => setFormData({ ...formData, caregiverId: e.target.value })}
+                  required
+                >
+                  <option value="">Select caregiver...</option>
+                  {caregivers.map(cg => (
+                    <option key={cg.id} value={cg.id}>
+                      {cg.first_name} {cg.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Client *</label>
+                <select
+                  value={formData.clientId}
+                  onChange={(e) => setFormData({ ...formData, clientId: e.target.value })}
+                  required
+                >
+                  <option value="">Select client...</option>
+                  {clients.map(client => (
+                    <option key={client.id} value={client.id}>
+                      {client.first_name} {client.last_name}
+                    </option>
+                  ))}
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Review Date *</label>
+                <input
+                  type="date"
+                  value={formData.reviewDate}
+                  onChange={(e) => setFormData({ ...formData, reviewDate: e.target.value })}
+                  required
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Overall Assessment *</label>
+                <select
+                  value={formData.overallAssessment}
+                  onChange={(e) => setFormData({ ...formData, overallAssessment: e.target.value })}
+                >
+                  <option value="excellent">Excellent</option>
+                  <option value="satisfactory">Satisfactory</option>
+                  <option value="needs_improvement">Needs Improvement</option>
+                </select>
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Performance Notes *</label>
+              <textarea
+                value={formData.performanceNotes}
+                onChange={(e) => setFormData({ ...formData, performanceNotes: e.target.value })}
+                placeholder="Detailed notes about this caregiver's performance with this client..."
+                rows="4"
+                required
+              ></textarea>
+            </div>
+
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Strengths</label>
+                <textarea
+                  value={formData.strengths}
+                  onChange={(e) => setFormData({ ...formData, strengths: e.target.value })}
+                  placeholder="What did this caregiver do well?"
+                  rows="3"
+                ></textarea>
+              </div>
+
+              <div className="form-group">
+                <label>Areas for Improvement</label>
+                <textarea
+                  value={formData.areasForImprovement}
+                  onChange={(e) => setFormData({ ...formData, areasForImprovement: e.target.value })}
+                  placeholder="What could be improved?"
+                  rows="3"
+                ></textarea>
+              </div>
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">Save Review</button>
+              <button type="button" className="btn btn-secondary" onClick={() => setShowForm(false)}>Cancel</button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {/* Caregivers & Reviews */}
+      {caregivers.length === 0 ? (
+        <div className="card card-centered">
+          <p>No caregivers to review.</p>
+        </div>
+      ) : (
+        <div style={{ display: 'grid', gap: '1.5rem' }}>
+          {caregivers.map(caregiver => {
+            const caregiversReviews = reviews[caregiver.id] || [];
+            const isExpanded = expandedCaregiverId === caregiver.id;
+
+            return (
+              <div key={caregiver.id} className="card">
+                <div
+                  onClick={() => setExpandedCaregiverId(isExpanded ? null : caregiver.id)}
+                  style={{
+                    cursor: 'pointer',
+                    display: 'flex',
+                    justifyContent: 'space-between',
+                    alignItems: 'center',
+                    paddingBottom: '1rem',
+                    borderBottom: '1px solid #ddd'
+                  }}
+                >
+                  <div>
+                    <h3 style={{ margin: 0 }}>{caregiver.first_name} {caregiver.last_name}</h3>
+                    <small style={{ color: '#666' }}>
+                      {caregiversReviews.length} review{caregiversReviews.length !== 1 ? 's' : ''}
+                    </small>
+                  </div>
+                  <span style={{ fontSize: '1.2rem' }}>
+                    {isExpanded ? '▼' : '▶'}
+                  </span>
+                </div>
+
+                {isExpanded && (
+                  <div style={{ paddingTop: '1rem' }}>
+                    {caregiversReviews.length === 0 ? (
+                      <p style={{ color: '#999', textAlign: 'center', paddingTop: '1rem' }}>
+                        No reviews yet for this caregiver.
+                      </p>
+                    ) : (
+                      <div style={{ display: 'grid', gap: '1rem' }}>
+                        {caregiversReviews
+                          .sort((a, b) => new Date(b.review_date) - new Date(a.review_date))
+                          .map(review => (
+                            <div
+                              key={review.id}
+                              style={{
+                                padding: '1rem',
+                                background: '#f9f9f9',
+                                borderLeft: `4px solid ${getAssessmentColor(review.overall_assessment)}`,
+                                borderRadius: '4px'
+                              }}
+                            >
+                              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '0.5rem' }}>
+                                <div>
+                                  <strong>{getClientName(review.client_id)}</strong>
+                                  <div style={{ fontSize: '0.85rem', color: '#666' }}>
+                                    {new Date(review.review_date).toLocaleDateString()}
+                                  </div>
+                                </div>
+                                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+                                  <span
+                                    className="badge"
+                                    style={{
+                                      background: getAssessmentColor(review.overall_assessment),
+                                      color: 'white'
+                                    }}
+                                  >
+                                    {getAssessmentLabel(review.overall_assessment)}
+                                  </span>
+                                  <button
+                                    className="btn btn-sm btn-danger"
+                                    onClick={() => handleDeleteReview(review.id)}
+                                  >
+                                    Delete
+                                  </button>
+                                </div>
+                              </div>
+
+                              <div style={{ marginBottom: '0.75rem' }}>
+                                <strong>Notes:</strong>
+                                <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                  {review.performance_notes}
+                                </p>
+                              </div>
+
+                              {review.strengths && (
+                                <div style={{ marginBottom: '0.75rem' }}>
+                                  <strong>Strengths:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {review.strengths}
+                                  </p>
+                                </div>
+                              )}
+
+                              {review.areas_for_improvement && (
+                                <div>
+                                  <strong>Areas for Improvement:</strong>
+                                  <p style={{ margin: '0.25rem 0', whiteSpace: 'pre-wrap' }}>
+                                    {review.areas_for_improvement}
+                                  </p>
+                                </div>
+                              )}
+                            </div>
+                          ))}
+                      </div>
+                    )}
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default PerformanceRatings;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ReferralSources.jsx b/templates/crm-homecare/frontend/src/components/admin/ReferralSources.jsx
new file mode 100644
index 0000000..b8bd933
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ReferralSources.jsx
@@ -0,0 +1,295 @@
+// src/components/admin/ReferralSources.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL, getReferralSources, createReferralSource } from '../../config';
+
+const ReferralSources = ({ token }) => {
+  const [sources, setSources] = useState([]);
+  const [showForm, setShowForm] = useState(false);
+  const [loading, setLoading] = useState(true);
+  const [editingId, setEditingId] = useState(null);
+  const [formData, setFormData] = useState({
+    name: '',
+    type: 'doctor',
+    contactName: '',
+    email: '',
+    phone: '',
+    address: '',
+    city: '',
+    state: 'WI',
+    zip: ''
+  });
+
+  const emptyForm = {
+    name: '',
+    type: 'doctor',
+    contactName: '',
+    email: '',
+    phone: '',
+    address: '',
+    city: '',
+    state: 'WI',
+    zip: ''
+  };
+
+  useEffect(() => {
+    loadSources();
+  }, []);
+
+  const loadSources = async () => {
+    try {
+      const data = await getReferralSources(token);
+      setSources(data);
+    } catch (error) {
+      console.error('Failed to load referral sources:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleEdit = (source) => {
+    setEditingId(source.id);
+    setFormData({
+      name: source.name || '',
+      type: source.type || 'doctor',
+      contactName: source.contact_name || '',
+      email: source.email || '',
+      phone: source.phone || '',
+      address: source.address || '',
+      city: source.city || '',
+      state: source.state || 'WI',
+      zip: source.zip || ''
+    });
+    setShowForm(true);
+  };
+
+  const handleCancel = () => {
+    setShowForm(false);
+    setEditingId(null);
+    setFormData(emptyForm);
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    try {
+      if (editingId) {
+        // Update existing
+        const response = await fetch(`${API_BASE_URL}/api/referral-sources/${editingId}`, {
+          method: 'PUT',
+          headers: {
+            'Content-Type': 'application/json',
+            'Authorization': `Bearer ${token}`
+          },
+          body: JSON.stringify(formData)
+        });
+        if (!response.ok) throw new Error('Failed to update');
+      } else {
+        // Create new
+        await createReferralSource(formData, token);
+      }
+      
+      setFormData(emptyForm);
+      setShowForm(false);
+      setEditingId(null);
+      loadSources();
+    } catch (error) {
+      alert(`Failed to ${editingId ? 'update' : 'create'} referral source: ` + error.message);
+    }
+  };
+
+  const handleDelete = async (id, name) => {
+    if (!window.confirm(`Are you sure you want to delete "${name}"? This cannot be undone.`)) {
+      return;
+    }
+    
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/referral-sources/${id}`, {
+        method: 'DELETE',
+        headers: {
+          'Authorization': `Bearer ${token}`
+        }
+      });
+      if (!response.ok) throw new Error('Failed to delete');
+      loadSources();
+    } catch (error) {
+      alert('Failed to delete referral source: ' + error.message);
+    }
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🏥 Referral Sources</h2>
+        <button 
+          className="btn btn-primary"
+          onClick={() => {
+            if (showForm) {
+              handleCancel();
+            } else {
+              setShowForm(true);
+            }
+          }}
+        >
+          {showForm ? '✕ Cancel' : '➕ Add Referral Source'}
+        </button>
+      </div>
+
+      {showForm && (
+        <div className="card card-form">
+          <h3>{editingId ? 'Edit Referral Source' : 'Add New Referral Source'}</h3>
+          <form onSubmit={handleSubmit}>
+            <div className="form-grid">
+              <div className="form-group">
+                <label>Organization Name *</label>
+                <input
+                  type="text"
+                  value={formData.name}
+                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}
+                  required
+                  placeholder="Hospital, Doctor's Office, etc."
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Type *</label>
+                <select
+                  value={formData.type}
+                  onChange={(e) => setFormData({ ...formData, type: e.target.value })}
+                >
+                  <option value="hospital">Hospital</option>
+                  <option value="doctor">Doctor</option>
+                  <option value="agency">Agency</option>
+                  <option value="social_services">Social Services</option>
+                  <option value="family">Family</option>
+                </select>
+              </div>
+
+              <div className="form-group">
+                <label>Contact Name</label>
+                <input
+                  type="text"
+                  value={formData.contactName}
+                  onChange={(e) => setFormData({ ...formData, contactName: e.target.value })}
+                  placeholder="John Doe"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Email</label>
+                <input
+                  type="email"
+                  value={formData.email}
+                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Phone</label>
+                <input
+                  type="tel"
+                  value={formData.phone}
+                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>Address</label>
+                <input
+                  type="text"
+                  value={formData.address}
+                  onChange={(e) => setFormData({ ...formData, address: e.target.value })}
+                  placeholder="123 Main St"
+                />
+              </div>
+
+              <div className="form-group">
+                <label>City</label>
+                <input
+                  type="text"
+                  value={formData.city}
+                  onChange={(e) => setFormData({ ...formData, city: e.target.value })}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>State</label>
+                <input
+                  type="text"
+                  value={formData.state}
+                  onChange={(e) => setFormData({ ...formData, state: e.target.value })}
+                  maxLength={2}
+                />
+              </div>
+
+              <div className="form-group">
+                <label>ZIP</label>
+                <input
+                  type="text"
+                  value={formData.zip}
+                  onChange={(e) => setFormData({ ...formData, zip: e.target.value })}
+                  maxLength={10}
+                />
+              </div>
+            </div>
+
+            <div className="form-actions">
+              <button type="submit" className="btn btn-primary">
+                {editingId ? 'Update Referral Source' : 'Save Referral Source'}
+              </button>
+              <button type="button" className="btn btn-secondary" onClick={handleCancel}>
+                Cancel
+              </button>
+            </div>
+          </form>
+        </div>
+      )}
+
+      {loading ? (
+        <div className="loading"><div className="spinner"></div></div>
+      ) : sources.length === 0 ? (
+        <div className="card card-centered">
+          <p>No referral sources yet. Create one to get started.</p>
+        </div>
+      ) : (
+        <div className="grid">
+          {sources.map(source => (
+            <div key={source.id} className="card">
+              <div className="source-card-header">
+                <h4>{source.name}</h4>
+                <span className="badge badge-info">{source.type}</span>
+              </div>
+
+              {source.contact_name && <p><strong>Contact:</strong> {source.contact_name}</p>}
+              {source.phone && <p><strong>Phone:</strong> <a href={`tel:${source.phone}`}>{source.phone}</a></p>}
+              {source.email && <p><strong>Email:</strong> <a href={`mailto:${source.email}`}>{source.email}</a></p>}
+              {(source.address || source.city) && (
+                <p><strong>Location:</strong> {source.address && `${source.address}, `}{source.city}, {source.state} {source.zip}</p>
+              )}
+
+              <div className="source-card-footer" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #eee' }}>
+                <p style={{ margin: 0 }}><strong>{source.referral_count || 0} referrals</strong></p>
+                <div style={{ display: 'flex', gap: '0.5rem' }}>
+                  <button 
+                    className="btn btn-secondary" 
+                    style={{ padding: '0.25rem 0.75rem', fontSize: '0.875rem' }}
+                    onClick={() => handleEdit(source)}
+                  >
+                    ✏️ Edit
+                  </button>
+                  <button 
+                    className="btn btn-danger" 
+                    style={{ padding: '0.25rem 0.75rem', fontSize: '0.875rem' }}
+                    onClick={() => handleDelete(source.id, source.name)}
+                  >
+                    🗑️ Delete
+                  </button>
+                </div>
+              </div>
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ReferralSources;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ReportsAnalytics.jsx b/templates/crm-homecare/frontend/src/components/admin/ReportsAnalytics.jsx
new file mode 100644
index 0000000..d49e245
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ReportsAnalytics.jsx
@@ -0,0 +1,675 @@
+import { toast } from '../Toast';
+// src/components/admin/ReportsAnalytics.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ReportsAnalytics = ({ token }) => {
+  const [reportType, setReportType] = useState('overview');
+  const [dateRange, setDateRange] = useState({
+    startDate: new Date(new Date().setMonth(new Date().getMonth() - 1)).toISOString().split('T')[0],
+    endDate: new Date().toISOString().split('T')[0]
+  });
+  const [reportData, setReportData] = useState(null);
+  const [loading, setLoading] = useState(false);
+  const [caregiverFilter, setCaregiverFilter] = useState('');
+  const [clientFilter, setClientFilter] = useState('');
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+
+  useEffect(() => {
+    loadFilters();
+  }, []);
+
+  useEffect(() => {
+    if (reportType) {
+      generateReport();
+    }
+  }, [reportType, dateRange, caregiverFilter, clientFilter]);
+
+  const loadFilters = async () => {
+    try {
+      const [cgRes, clRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+      const caregiverData = await cgRes.json();
+      const clientData = await clRes.json();
+      setCaregivers(caregiverData);
+      setClients(clientData);
+    } catch (error) {
+      console.error('Failed to load filters:', error);
+    }
+  };
+
+  const generateReport = async () => {
+    setLoading(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/reports/${reportType}`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          startDate: dateRange.startDate,
+          endDate: dateRange.endDate,
+          caregiverId: caregiverFilter || null,
+          clientId: clientFilter || null
+        })
+      });
+      const data = await response.json();
+      setReportData(data);
+    } catch (error) {
+      console.error('Failed to generate report:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const exportReport = async (format) => {
+    try {
+      const endpoint = format === 'pdf'
+        ? `${API_BASE_URL}/api/reports/${reportType}/export-pdf`
+        : `${API_BASE_URL}/api/reports/${reportType}/export`;
+      const response = await fetch(endpoint, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ startDate: dateRange.startDate, endDate: dateRange.endDate,
+          caregiverId: caregiverFilter || null, clientId: clientFilter || null, format })
+      });
+      if (!response.ok) throw new Error('Export failed');
+      const blob = await response.blob();
+      const url = window.URL.createObjectURL(blob);
+      const a = document.createElement('a');
+      a.href = url;
+      a.download = `cvhc-${reportType}-report-${dateRange.startDate}-to-${dateRange.endDate}.${format}`;
+      a.click();
+      window.URL.revokeObjectURL(url);
+      toast(`${format.toUpperCase()} export downloaded!`, 'success');
+    } catch (error) {
+      toast('Failed to export: ' + error.message, 'error');
+    }
+  };
+
+  const renderOverviewReport = () => {
+    if (!reportData) return null;
+    const { summary = {}, topCaregivers, topClients } = reportData;
+
+    return (
+      <div>
+        {/* Key Metrics */}
+        <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))' }}>
+          <div className="stat-card">
+            <h3>Total Hours</h3>
+            <div className="value">{(parseFloat(summary.totalHours) || 0).toFixed(2)}</div>
+            <p className="stat-subtext">Across all caregivers</p>
+          </div>
+          <div className="stat-card">
+            <h3>Total Revenue</h3>
+            <div className="value value-success">
+              ${(parseFloat(summary.totalRevenue) || 0).toFixed(2)}
+            </div>
+            <p className="stat-subtext">Billable hours</p>
+          </div>
+          <div className="stat-card">
+            <h3>Active Shifts</h3>
+            <div className="value">{summary.totalShifts || 0}</div>
+            <p className="stat-subtext">Completed</p>
+          </div>
+          <div className="stat-card">
+            <h3>Avg Satisfaction</h3>
+            <div className="value">
+              {summary.avgSatisfaction ? `${parseFloat(summary.avgSatisfaction).toFixed(2)}⭐` : 'N/A'}
+            </div>
+            <p className="stat-subtext">Client ratings</p>
+          </div>
+        </div>
+
+        {/* Top Caregivers */}
+        <div className="card">
+          <h3>📊 Top Performing Caregivers</h3>
+          {topCaregivers && topCaregivers.length > 0 ? (
+            <table className="table">
+              <thead>
+                <tr>
+                  <th>Caregiver</th>
+                  <th>Hours</th>
+                  <th>Revenue</th>
+                  <th>Avg Rating</th>
+                  <th>Clients</th>
+                </tr>
+              </thead>
+              <tbody>
+                {topCaregivers.map(cg => (
+                  <tr key={cg.id}>
+                    <td><strong>{cg.first_name} {cg.last_name}</strong></td>
+                    <td>{(parseFloat(cg.total_hours) || 0).toFixed(2)} hrs</td>
+                    <td>${(parseFloat(cg.total_revenue) || 0).toFixed(2)}</td>
+                    <td>
+                      {cg.avg_satisfaction ? (
+                        <span>⭐ {parseFloat(cg.avg_satisfaction).toFixed(2)}</span>
+                      ) : (
+                        'N/A'
+                      )}
+                    </td>
+                    <td>{cg.clients_served || 0}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          ) : (
+            <p>No caregiver data available</p>
+          )}
+        </div>
+
+        {/* Top Clients */}
+        <div className="card">
+          <h3>👥 Most Active Clients</h3>
+          {topClients && topClients.length > 0 ? (
+            <table className="table">
+              <thead>
+                <tr>
+                  <th>Client</th>
+                  <th>Service Type</th>
+                  <th>Hours</th>
+                  <th>Cost</th>
+                  <th>Assigned Caregivers</th>
+                </tr>
+              </thead>
+              <tbody>
+                {topClients.map(cl => (
+                  <tr key={cl.id}>
+                    <td><strong>{cl.first_name} {cl.last_name}</strong></td>
+                    <td>
+                      <span className="badge badge-success">
+                        {cl.service_type?.replace('_', ' ').toUpperCase() || 'N/A'}
+                      </span>
+                    </td>
+                    <td>{(parseFloat(cl.total_hours) || 0).toFixed(2)} hrs</td>
+                    <td>${(parseFloat(cl.total_cost) || 0).toFixed(2)}</td>
+                    <td>{cl.caregiver_count || 0}</td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          ) : (
+            <p>No client data available</p>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  const renderHoursReport = () => {
+    if (!reportData) return null;
+    const { hoursByWeek, hoursByType, caregiverBreakdown } = reportData;
+
+    return (
+      <div>
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+          <div className="card">
+            <h3>Hours by Service Type</h3>
+            {hoursByType && hoursByType.length > 0 ? (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Service Type</th>
+                    <th>Hours</th>
+                    <th>Percentage</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {hoursByType.map((type, idx) => (
+                    <tr key={idx}>
+                      <td>{type.service_type?.replace('_', ' ').toUpperCase() || 'N/A'}</td>
+                      <td>{(parseFloat(type.hours) || 0).toFixed(2)}</td>
+                      <td>
+                        <div style={{ width: '100px', height: '6px', background: '#e0e0e0', borderRadius: '3px', overflow: 'hidden' }}>
+                          <div style={{ width: `${parseFloat(type.percentage) || 0}%`, height: '100%', background: '#2196f3' }}></div>
+                        </div>
+                        <small>{(parseFloat(type.percentage) || 0).toFixed(2)}%</small>
+                      </td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            ) : (
+              <p>No data available</p>
+            )}
+          </div>
+
+          <div className="card">
+            <h3>Hours by Week</h3>
+            {hoursByWeek && hoursByWeek.length > 0 ? (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Week</th>
+                    <th>Hours</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {hoursByWeek.map((week, idx) => (
+                    <tr key={idx}>
+                      <td>{week.week}</td>
+                      <td>{(parseFloat(week.hours) || 0).toFixed(2)}</td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            ) : (
+              <p>No data available</p>
+            )}
+          </div>
+        </div>
+
+        <div className="card">
+          <h3>Caregiver Hours Breakdown</h3>
+          {caregiverBreakdown && caregiverBreakdown.length > 0 ? (
+            <table className="table">
+              <thead>
+                <tr>
+                  <th>Caregiver</th>
+                  <th>Regular Hours</th>
+                  <th>Overtime Hours</th>
+                  <th>Total</th>
+                  <th>Utilization</th>
+                </tr>
+              </thead>
+              <tbody>
+                {caregiverBreakdown.map(cg => {
+                  const regularHours = parseFloat(cg.regular_hours) || 0;
+                  const overtimeHours = parseFloat(cg.overtime_hours) || 0;
+                  const totalHours = parseFloat(cg.total_hours) || 0;
+                  return (
+                    <tr key={cg.id}>
+                      <td><strong>{cg.first_name} {cg.last_name}</strong></td>
+                      <td>{regularHours.toFixed(2)}</td>
+                      <td className={overtimeHours > 0 ? 'value-warning' : ''}>{overtimeHours.toFixed(2)}</td>
+                      <td><strong>{totalHours.toFixed(2)}</strong></td>
+                      <td>
+                        <div style={{ width: '100px', height: '6px', background: '#e0e0e0', borderRadius: '3px', overflow: 'hidden' }}>
+                          <div style={{ 
+                            width: `${Math.min((totalHours / 40) * 100, 100)}%`, 
+                            height: '100%', 
+                            background: totalHours > 40 ? '#ff9800' : '#4caf50' 
+                          }}></div>
+                        </div>
+                        <small>{((totalHours / 40) * 100).toFixed(0)}%</small>
+                      </td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          ) : (
+            <p>No caregiver data available</p>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  const renderPerformanceReport = () => {
+    if (!reportData) return null;
+    const { performance } = reportData;
+
+    return (
+      <div>
+        <div className="card">
+          <h3>Caregiver Performance Metrics</h3>
+          {performance && performance.length > 0 ? (
+            <table className="table">
+              <thead>
+                <tr>
+                  <th>Caregiver</th>
+                  <th>Avg Rating</th>
+                  <th>Attendance</th>
+                  <th>Incidents</th>
+                  <th>Training Hours</th>
+                  <th>Status</th>
+                </tr>
+              </thead>
+              <tbody>
+                {performance.map(perf => {
+                  const avgRating = parseFloat(perf.avg_rating) || 0;
+                  const attendanceRate = parseFloat(perf.attendance_rate) || 0;
+                  const trainingHours = parseFloat(perf.training_hours) || 0;
+                  const performanceScore = parseFloat(perf.performance_score) || 0;
+                  return (
+                    <tr key={perf.id}>
+                      <td><strong>{perf.first_name} {perf.last_name}</strong></td>
+                      <td>
+                        {perf.avg_rating ? (
+                          <span style={{ fontSize: '1.1em' }}>
+                            ⭐ {avgRating.toFixed(2)} ({perf.rating_count || 0})
+                          </span>
+                        ) : (
+                          'N/A'
+                        )}
+                      </td>
+                      <td>
+                        <span className={attendanceRate >= 95 ? 'value-success' : 'value-warning'}>
+                          {attendanceRate.toFixed(2)}%
+                        </span>
+                      </td>
+                      <td>
+                        {(perf.incident_count || 0) > 0 ? (
+                          <span className="value-danger">{perf.incident_count}</span>
+                        ) : (
+                          '0 ✓'
+                        )}
+                      </td>
+                      <td>{trainingHours.toFixed(2)}</td>
+                      <td>
+                        <span className={`badge ${performanceScore >= 85 ? 'badge-success' : performanceScore >= 70 ? 'badge-warning' : 'badge-danger'}`}>
+                          {performanceScore.toFixed(0)}/100
+                        </span>
+                      </td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          ) : (
+            <p>No performance data available</p>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  const renderSatisfactionReport = () => {
+    if (!reportData) return null;
+    const { satisfaction = {}, trends } = reportData;
+    const distribution = satisfaction.distribution || {};
+
+    return (
+      <div>
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+          <div className="stat-card">
+            <h3>Overall Satisfaction</h3>
+            <div className="value" style={{ fontSize: '3rem' }}>
+              {satisfaction.overall ? (parseFloat(satisfaction.overall) || 0).toFixed(2) : 'N/A'}⭐
+            </div>
+            <p className="stat-subtext">{satisfaction.total_ratings || 0} ratings</p>
+          </div>
+
+          <div className="stat-card">
+            <h3>Satisfaction Distribution</h3>
+            <div style={{ fontSize: '0.9rem' }}>
+              <p>5 ⭐: {distribution[5] || 0}</p>
+              <p>4 ⭐: {distribution[4] || 0}</p>
+              <p>3 ⭐: {distribution[3] || 0}</p>
+              <p>2 ⭐: {distribution[2] || 0}</p>
+              <p>1 ⭐: {distribution[1] || 0}</p>
+            </div>
+          </div>
+        </div>
+
+        <div className="card">
+          <h3>Satisfaction Trends</h3>
+          {trends && trends.length > 0 ? (
+            <table className="table">
+              <thead>
+                <tr>
+                  <th>Period</th>
+                  <th>Avg Rating</th>
+                  <th>Trend</th>
+                  <th>Ratings</th>
+                </tr>
+              </thead>
+              <tbody>
+                {trends.map((trend, idx) => {
+                  const rating = parseFloat(trend.rating) || 0;
+                  const change = parseFloat(trend.change) || 0;
+                  return (
+                    <tr key={idx}>
+                      <td>{trend.period}</td>
+                      <td>⭐ {rating.toFixed(2)}</td>
+                      <td>
+                        {change > 0 ? (
+                          <span style={{ color: '#4caf50' }}>↑ {change.toFixed(2)}</span>
+                        ) : change < 0 ? (
+                          <span style={{ color: '#f44336' }}>↓ {Math.abs(change).toFixed(2)}</span>
+                        ) : (
+                          <span style={{ color: '#999' }}>→ Stable</span>
+                        )}
+                      </td>
+                      <td>{trend.count || 0}</td>
+                    </tr>
+                  );
+                })}
+              </tbody>
+            </table>
+          ) : (
+            <p>No satisfaction data available</p>
+          )}
+        </div>
+
+        <div className="card">
+          <h3>Feedback Themes</h3>
+          {satisfaction.feedback_themes && satisfaction.feedback_themes.length > 0 ? (
+            <div style={{ display: 'grid', gap: '1rem' }}>
+              {satisfaction.feedback_themes.map((theme, idx) => (
+                <div key={idx} style={{ padding: '1rem', background: '#f5f5f5', borderRadius: '6px' }}>
+                  <strong>{theme.theme}</strong>
+                  <p style={{ margin: '0.5rem 0 0 0', fontSize: '0.9rem', color: '#666' }}>
+                    Mentioned {theme.count || 0} times
+                  </p>
+                </div>
+              ))}
+            </div>
+          ) : (
+            <p>No feedback themes available</p>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  const renderRevenueReport = () => {
+    if (!reportData) return null;
+    const { revenue = {}, byClient, byServiceType } = reportData;
+    const revenueTotal = parseFloat(revenue.total) || 0;
+
+    return (
+      <div>
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr 1fr' }}>
+          <div className="stat-card">
+            <h3>Total Revenue</h3>
+            <div className="value value-success">
+              ${revenueTotal.toFixed(2)}
+            </div>
+          </div>
+          <div className="stat-card">
+            <h3>Avg Per Hour</h3>
+            <div className="value">
+              ${(parseFloat(revenue.avgPerHour) || 0).toFixed(2)}
+            </div>
+          </div>
+          <div className="stat-card">
+            <h3>Billable Hours</h3>
+            <div className="value">
+              {(parseFloat(revenue.billableHours) || 0).toFixed(2)}
+            </div>
+          </div>
+        </div>
+
+        <div className="grid" style={{ gridTemplateColumns: '1fr 1fr' }}>
+          <div className="card">
+            <h3>Revenue by Service Type</h3>
+            {byServiceType && byServiceType.length > 0 ? (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Service Type</th>
+                    <th>Hours</th>
+                    <th>Revenue</th>
+                    <th>%</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {byServiceType.map((st, idx) => {
+                    const stRevenue = parseFloat(st.revenue) || 0;
+                    return (
+                      <tr key={idx}>
+                        <td>{st.service_type?.replace('_', ' ').toUpperCase() || 'N/A'}</td>
+                        <td>{(parseFloat(st.hours) || 0).toFixed(2)}</td>
+                        <td><strong>${stRevenue.toFixed(2)}</strong></td>
+                        <td>{revenueTotal > 0 ? ((stRevenue / revenueTotal) * 100).toFixed(2) : 0}%</td>
+                      </tr>
+                    );
+                  })}
+                </tbody>
+              </table>
+            ) : (
+              <p>No data available</p>
+            )}
+          </div>
+
+          <div className="card">
+            <h3>Top Clients by Revenue</h3>
+            {byClient && byClient.length > 0 ? (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th>Client</th>
+                    <th>Revenue</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {byClient.slice(0, 10).map(cl => (
+                    <tr key={cl.id}>
+                      <td>{cl.first_name} {cl.last_name}</td>
+                      <td><strong>${(parseFloat(cl.revenue) || 0).toFixed(2)}</strong></td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            ) : (
+              <p>No client data available</p>
+            )}
+          </div>
+        </div>
+      </div>
+    );
+  };
+
+  const renderReport = () => {
+    switch (reportType) {
+      case 'overview':
+        return renderOverviewReport();
+      case 'hours':
+        return renderHoursReport();
+      case 'performance':
+        return renderPerformanceReport();
+      case 'satisfaction':
+        return renderSatisfactionReport();
+      case 'revenue':
+        return renderRevenueReport();
+      default:
+        return null;
+    }
+  };
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📊 Reports & Analytics</h2>
+      </div>
+
+      {/* Report Type Selection */}
+      <div className="card">
+        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '0.75rem', marginBottom: '1rem' }}>
+          {[
+            { value: 'overview', label: 'Overview' },
+            { value: 'hours', label: 'Hours Worked' },
+            { value: 'performance', label: 'Performance' },
+            { value: 'satisfaction', label: 'Satisfaction' },
+            { value: 'revenue', label: 'Revenue' }
+          ].map(type => (
+            <button
+              key={type.value}
+              className={`btn ${reportType === type.value ? 'btn-primary' : 'btn-secondary'}`}
+              onClick={() => setReportType(type.value)}
+            >
+              {type.label}
+            </button>
+          ))}
+        </div>
+      </div>
+
+      {/* Filters */}
+      <div className="card">
+        <div className="filter-controls" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>
+          <div className="form-group">
+            <label>Start Date</label>
+            <input
+              type="date"
+              value={dateRange.startDate}
+              onChange={(e) => setDateRange({ ...dateRange, startDate: e.target.value })}
+            />
+          </div>
+
+          <div className="form-group">
+            <label>End Date</label>
+            <input
+              type="date"
+              value={dateRange.endDate}
+              onChange={(e) => setDateRange({ ...dateRange, endDate: e.target.value })}
+            />
+          </div>
+
+          <div className="form-group">
+            <label>Caregiver (Optional)</label>
+            <select value={caregiverFilter} onChange={(e) => setCaregiverFilter(e.target.value)}>
+              <option value="">All Caregivers</option>
+              {caregivers.map(cg => (
+                <option key={cg.id} value={cg.id}>
+                  {cg.first_name} {cg.last_name}
+                </option>
+              ))}
+            </select>
+          </div>
+
+          <div className="form-group">
+            <label>Client (Optional)</label>
+            <select value={clientFilter} onChange={(e) => setClientFilter(e.target.value)}>
+              <option value="">All Clients</option>
+              {clients.map(cl => (
+                <option key={cl.id} value={cl.id}>
+                  {cl.first_name} {cl.last_name}
+                </option>
+              ))}
+            </select>
+          </div>
+
+          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'flex-end' }}>
+            <button className="btn btn-secondary" onClick={() => exportReport('csv')}>
+              📥 CSV
+            </button>
+            <button className="btn btn-secondary" onClick={() => exportReport('pdf')}>
+              📄 PDF
+            </button>
+          </div>
+        </div>
+      </div>
+
+      {/* Report Content */}
+      {loading ? (
+        <div className="loading">
+          <div className="spinner"></div>
+        </div>
+      ) : (
+        renderReport()
+      )}
+    </div>
+  );
+};
+
+export default ReportsAnalytics;
diff --git a/templates/crm-homecare/frontend/src/components/admin/RevenueForecast.jsx b/templates/crm-homecare/frontend/src/components/admin/RevenueForecast.jsx
new file mode 100644
index 0000000..60a04fd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/RevenueForecast.jsx
@@ -0,0 +1,294 @@
+// RevenueForecast.jsx — projected vs actual revenue, auth utilization, weekly outlook
+
+import { useState, useEffect } from 'react';
+
+const API = import.meta.env.VITE_API_URL || '';
+
+const fmt$ = (n) => '$' + parseFloat(n || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
+const fmtH = (n) => parseFloat(n || 0).toFixed(1) + 'h';
+
+export default function RevenueForecast({ token }) {
+  const [data, setData] = useState(null);
+  const [utilData, setUtilData] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [tab, setTab] = useState('overview');
+  const [months, setMonths] = useState(3);
+
+  const h = { Authorization: `Bearer ${token}` };
+
+  const load = async () => {
+    setLoading(true);
+    try {
+      const [fR, uR] = await Promise.all([
+        fetch(`${API}/api/forecast/revenue?months=${months}`, { headers: h }),
+        fetch(`${API}/api/forecast/caregiver-utilization`, { headers: h }),
+      ]);
+      setData(await fR.json());
+      setUtilData(await uR.json());
+    } catch (e) {}
+    setLoading(false);
+  };
+
+  useEffect(() => { load(); }, [months]);
+
+  const tabStyle = (t) => ({ padding: '0.5rem 1rem', border: 'none', borderBottom: `3px solid ${tab === t ? '#3B82F6' : 'transparent'}`, background: 'none', cursor: 'pointer', fontWeight: tab === t ? 700 : 400, color: tab === t ? '#1D4ED8' : '#6B7280', fontSize: '0.92rem' });
+
+  const barWidth = (val, max) => `${Math.min((parseFloat(val || 0) / Math.max(parseFloat(max || 1), 1)) * 100, 100)}%`;
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '4rem', color: '#9CA3AF' }}>Loading forecast data...</div>;
+
+  const summary = data?.authSummary || {};
+  const actual = data?.actual || [];
+  const projected = data?.projected || [];
+  const weekly = data?.weekly || [];
+  const topClients = data?.topClients || [];
+
+  const totalActualBilled = actual.reduce((s, r) => s + parseFloat(r.billed || 0), 0);
+  const totalActualCollected = actual.reduce((s, r) => s + parseFloat(r.collected || 0), 0);
+  const totalProjectedRemaining = parseFloat(summary.total_projected_remaining || 0);
+  const nextWeek = weekly[0] || {};
+
+  return (
+    <div>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem', flexWrap: 'wrap', gap: '0.5rem' }}>
+        <h2 style={{ margin: 0 }}>📈 Revenue Forecast</h2>
+        <div style={{ display: 'flex', gap: '0.4rem', alignItems: 'center' }}>
+          <span style={{ fontSize: '0.85rem', color: '#6B7280' }}>History:</span>
+          {[1, 3, 6].map(m => (
+            <button key={m} onClick={() => setMonths(m)}
+              style={{ padding: '0.3rem 0.7rem', borderRadius: '20px', border: `1px solid ${months === m ? '#3B82F6' : '#E5E7EB'}`, background: months === m ? '#3B82F6' : '#fff', color: months === m ? '#fff' : '#374151', cursor: 'pointer', fontSize: '0.82rem', fontWeight: months === m ? 700 : 400 }}>
+              {m}mo
+            </button>
+          ))}
+          <button onClick={load} style={{ padding: '0.35rem 0.75rem', borderRadius: '8px', border: '1px solid #E5E7EB', background: '#fff', color: '#374151', cursor: 'pointer', fontSize: '0.82rem' }}>↻</button>
+        </div>
+      </div>
+
+      {/* KPI summary row */}
+      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '0.75rem', marginBottom: '1.5rem' }}>
+        {[
+          { label: `Billed (${months}mo)`, val: fmt$(totalActualBilled), sub: `${fmt$(totalActualCollected)} collected`, color: '#3B82F6', bg: '#EFF6FF' },
+          { label: 'Projected Remaining', val: fmt$(totalProjectedRemaining), sub: `From ${summary.total_active_auths || 0} active auths`, color: '#10B981', bg: '#D1FAE5' },
+          { label: 'Auth Utilization', val: `${summary.avg_utilization_pct || 0}%`, sub: `${fmtH(summary.total_used_hours)} / ${fmtH(summary.total_auth_hours)} hrs`, color: '#F59E0B', bg: '#FFFBEB' },
+          { label: 'Est. Next Week', val: fmt$(nextWeek.estimated_revenue || 0), sub: `${fmtH(nextWeek.scheduled_hours)} scheduled`, color: '#8B5CF6', bg: '#F5F3FF' },
+        ].map(k => (
+          <div key={k.label} style={{ background: k.bg, borderRadius: '10px', padding: '1rem 1.1rem', border: `1px solid ${k.color}28` }}>
+            <div style={{ fontSize: '0.75rem', color: '#6B7280', fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.05em', marginBottom: '0.3rem' }}>{k.label}</div>
+            <div style={{ fontSize: '1.6rem', fontWeight: 800, color: k.color, lineHeight: 1 }}>{k.val}</div>
+            <div style={{ fontSize: '0.75rem', color: '#6B7280', marginTop: '0.3rem' }}>{k.sub}</div>
+          </div>
+        ))}
+      </div>
+
+      {/* Tabs */}
+      <div style={{ display: 'flex', borderBottom: '2px solid #E5E7EB', marginBottom: '1.25rem' }}>
+        <button style={tabStyle('overview')} onClick={() => setTab('overview')}>📊 Monthly History</button>
+        <button style={tabStyle('weekly')} onClick={() => setTab('weekly')}>📅 4-Week Outlook</button>
+        <button style={tabStyle('auths')} onClick={() => setTab('auths')}>📋 Authorizations</button>
+        <button style={tabStyle('clients')} onClick={() => setTab('clients')}>👤 Top Clients</button>
+        <button style={tabStyle('staff')} onClick={() => setTab('staff')}>🧑‍⚕️ Staff Utilization</button>
+      </div>
+
+      {tab === 'overview' && (
+        <div>
+          <h4 style={{ margin: '0 0 1rem', color: '#374151' }}>Billed vs Collected — Last {months} Month{months > 1 ? 's' : ''}</h4>
+          {actual.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+              No billing data for this period. Billing data will appear here once claims are submitted.
+            </div>
+          ) : (
+            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>
+              {actual.map((row, i) => {
+                const billed = parseFloat(row.billed || 0);
+                const collected = parseFloat(row.collected || 0);
+                const maxBilled = Math.max(...actual.map(r => parseFloat(r.billed || 0)), 1);
+                const collRate = billed > 0 ? Math.round((collected / billed) * 100) : 0;
+                const period = new Date(row.period).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
+                return (
+                  <div key={i} style={{ background: '#fff', border: '1px solid #E5E7EB', borderRadius: '10px', padding: '1rem' }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.6rem' }}>
+                      <span style={{ fontWeight: 700, fontSize: '0.95rem' }}>{period}</span>
+                      <div style={{ display: 'flex', gap: '1.25rem', fontSize: '0.85rem' }}>
+                        <span style={{ color: '#3B82F6', fontWeight: 700 }}>Billed: {fmt$(billed)}</span>
+                        <span style={{ color: '#10B981', fontWeight: 700 }}>Collected: {fmt$(collected)}</span>
+                        <span style={{ color: collRate >= 90 ? '#10B981' : collRate >= 70 ? '#F59E0B' : '#EF4444', fontWeight: 700 }}>{collRate}% rate</span>
+                        <span style={{ color: '#9CA3AF' }}>{row.claim_count} claims</span>
+                      </div>
+                    </div>
+                    <div style={{ height: '8px', background: '#F3F4F6', borderRadius: '4px', overflow: 'hidden' }}>
+                      <div style={{ height: '100%', width: barWidth(billed, maxBilled), background: '#BFDBFE', borderRadius: '4px', position: 'relative', transition: 'width 0.3s' }}>
+                        <div style={{ position: 'absolute', top: 0, left: 0, height: '100%', width: barWidth(collected, billed), background: '#3B82F6', borderRadius: '4px' }} />
+                      </div>
+                    </div>
+                  </div>
+                );
+              })}
+            </div>
+          )}
+        </div>
+      )}
+
+      {tab === 'weekly' && (
+        <div>
+          <h4 style={{ margin: '0 0 1rem', color: '#374151' }}>Next 4 Weeks — Projected Revenue from Scheduled Shifts</h4>
+          {weekly.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+              No scheduled shifts found for the next 4 weeks.
+            </div>
+          ) : (
+            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '0.75rem' }}>
+              {weekly.map((w, i) => {
+                const weekStart = new Date(w.week_start);
+                const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate() + 6);
+                const label = weekStart.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) + ' – ' + weekEnd.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
+                return (
+                  <div key={i} style={{ background: i === 0 ? '#EFF6FF' : '#fff', border: `1px solid ${i === 0 ? '#BFDBFE' : '#E5E7EB'}`, borderRadius: '10px', padding: '1rem', textAlign: 'center' }}>
+                    {i === 0 && <div style={{ fontSize: '0.72rem', color: '#1D4ED8', fontWeight: 700, textTransform: 'uppercase', marginBottom: '0.35rem' }}>This Week</div>}
+                    <div style={{ fontSize: '0.75rem', color: '#6B7280', marginBottom: '0.5rem' }}>{label}</div>
+                    <div style={{ fontSize: '1.5rem', fontWeight: 800, color: '#1D4ED8' }}>{fmt$(w.estimated_revenue)}</div>
+                    <div style={{ fontSize: '0.78rem', color: '#6B7280', marginTop: '0.3rem' }}>{fmtH(w.scheduled_hours)} · {w.shift_count} shifts · {w.caregiver_count} caregivers</div>
+                  </div>
+                );
+              })}
+            </div>
+          )}
+          <div style={{ marginTop: '1rem', padding: '0.75rem 1rem', background: '#FFFBEB', border: '1px solid #FCD34D', borderRadius: '8px', fontSize: '0.8rem', color: '#92400E' }}>
+            💡 Estimated at $18.50/hr average rate. Actual revenue depends on payer rates and billing outcomes.
+          </div>
+        </div>
+      )}
+
+      {tab === 'auths' && (
+        <div>
+          <h4 style={{ margin: '0 0 1rem', color: '#374151' }}>Active Authorization Remaining Value</h4>
+          {projected.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>
+              No active authorizations with remaining hours.
+            </div>
+          ) : (
+            <div style={{ overflowX: 'auto' }}>
+              <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.85rem' }}>
+                <thead>
+                  <tr style={{ background: '#F9FAFB', borderBottom: '2px solid #E5E7EB' }}>
+                    {['Client','Service','Auth Hrs','Used Hrs','Remaining','Rate','Projected $','Expires'].map(c => (
+                      <th key={c} style={{ textAlign: 'left', padding: '0.65rem 0.85rem', fontWeight: 700, color: '#374151', fontSize: '0.8rem', whiteSpace: 'nowrap' }}>{c}</th>
+                    ))}
+                  </tr>
+                </thead>
+                <tbody>
+                  {projected.map((r, i) => {
+                    const pct = r.authorized_hours > 0 ? Math.round((r.used_hours / r.authorized_hours) * 100) : 0;
+                    return (
+                      <tr key={i} style={{ borderBottom: '1px solid #F3F4F6', background: i % 2 === 0 ? '#fff' : '#FAFAFA' }}>
+                        <td style={{ padding: '0.65rem 0.85rem', fontWeight: 600 }}>{r.client_name}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280' }}>{r.service_type?.replace(/_/g,' ')}</td>
+                        <td style={{ padding: '0.65rem 0.85rem' }}>{fmtH(r.authorized_hours)}</td>
+                        <td style={{ padding: '0.65rem 0.85rem' }}>
+                          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                            {fmtH(r.used_hours)}
+                            <div style={{ width: '50px', height: '6px', background: '#E5E7EB', borderRadius: '3px', overflow: 'hidden' }}>
+                              <div style={{ width: `${pct}%`, height: '100%', background: pct > 90 ? '#EF4444' : pct > 70 ? '#F59E0B' : '#10B981' }} />
+                            </div>
+                            <span style={{ fontSize: '0.72rem', color: '#9CA3AF' }}>{pct}%</span>
+                          </div>
+                        </td>
+                        <td style={{ padding: '0.65rem 0.85rem', fontWeight: 700, color: '#10B981' }}>{fmtH(r.remaining_hours)}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280' }}>{r.hourly_rate ? fmt$(r.hourly_rate) + '/hr' : '—'}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', fontWeight: 700, color: '#3B82F6' }}>{fmt$(r.projected_remaining_revenue)}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', color: new Date(r.end_date) < new Date(Date.now() + 30*86400000) ? '#EF4444' : '#6B7280', fontSize: '0.82rem' }}>
+                          {r.end_date ? new Date(r.end_date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : '—'}
+                        </td>
+                      </tr>
+                    );
+                  })}
+                </tbody>
+                <tfoot>
+                  <tr style={{ borderTop: '2px solid #E5E7EB', background: '#F9FAFB' }}>
+                    <td colSpan={6} style={{ padding: '0.65rem 0.85rem', fontWeight: 700, textAlign: 'right' }}>Total Projected:</td>
+                    <td style={{ padding: '0.65rem 0.85rem', fontWeight: 800, color: '#3B82F6', fontSize: '1rem' }}>{fmt$(totalProjectedRemaining)}</td>
+                    <td />
+                  </tr>
+                </tfoot>
+              </table>
+            </div>
+          )}
+        </div>
+      )}
+
+      {tab === 'clients' && (
+        <div>
+          <h4 style={{ margin: '0 0 1rem', color: '#374151' }}>Top Clients by Revenue — Last 90 Days</h4>
+          {topClients.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>No billing data in the last 90 days.</div>
+          ) : (
+            <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+              {topClients.map((c, i) => {
+                const maxBilled = parseFloat(topClients[0]?.total_billed || 1);
+                return (
+                  <div key={i} style={{ background: '#fff', border: '1px solid #E5E7EB', borderRadius: '10px', padding: '1rem' }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>
+                      <span style={{ fontWeight: 700 }}>{i + 1}. {c.client_name}</span>
+                      <div style={{ display: 'flex', gap: '1rem', fontSize: '0.85rem' }}>
+                        <span style={{ fontWeight: 700, color: '#3B82F6' }}>{fmt$(c.total_billed)}</span>
+                        <span style={{ color: '#10B981' }}>Collected: {fmt$(c.total_collected)}</span>
+                        <span style={{ color: '#9CA3AF' }}>{c.claim_count} claims</span>
+                      </div>
+                    </div>
+                    <div style={{ height: '6px', background: '#F3F4F6', borderRadius: '3px', overflow: 'hidden' }}>
+                      <div style={{ height: '100%', width: barWidth(c.total_billed, maxBilled), background: '#3B82F6', borderRadius: '3px' }} />
+                    </div>
+                  </div>
+                );
+              })}
+            </div>
+          )}
+        </div>
+      )}
+
+      {tab === 'staff' && (
+        <div>
+          <h4 style={{ margin: '0 0 1rem', color: '#374151' }}>Caregiver Weekly Utilization</h4>
+          {utilData.length === 0 ? (
+            <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '10px', border: '2px dashed #E5E7EB' }}>No utilization data.</div>
+          ) : (
+            <div style={{ overflowX: 'auto' }}>
+              <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.85rem' }}>
+                <thead>
+                  <tr style={{ background: '#F9FAFB', borderBottom: '2px solid #E5E7EB' }}>
+                    {['Caregiver','Type','Clients','Weekly Hrs','Est. Weekly Rev','Utilization'].map(c => (
+                      <th key={c} style={{ textAlign: 'left', padding: '0.65rem 0.85rem', fontWeight: 700, color: '#374151', fontSize: '0.8rem' }}>{c}</th>
+                    ))}
+                  </tr>
+                </thead>
+                <tbody>
+                  {utilData.map((u, i) => {
+                    const hrs = parseFloat(u.weekly_hours || 0);
+                    const maxHrs = parseFloat(utilData[0]?.weekly_hours || 40);
+                    const pct = Math.min(Math.round((hrs / 40) * 100), 100);
+                    return (
+                      <tr key={i} style={{ borderBottom: '1px solid #F3F4F6', background: i % 2 === 0 ? '#fff' : '#FAFAFA' }}>
+                        <td style={{ padding: '0.65rem 0.85rem', fontWeight: 600 }}>{u.caregiver_name}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', color: '#6B7280', fontSize: '0.8rem' }}>{u.employment_type || 'staff'}</td>
+                        <td style={{ padding: '0.65rem 0.85rem' }}>{u.client_count || 0}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', fontWeight: 700 }}>{fmtH(hrs)}</td>
+                        <td style={{ padding: '0.65rem 0.85rem', color: '#3B82F6', fontWeight: 700 }}>{fmt$(u.weekly_revenue)}</td>
+                        <td style={{ padding: '0.65rem 0.85rem' }}>
+                          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                            <div style={{ width: '80px', height: '8px', background: '#E5E7EB', borderRadius: '4px', overflow: 'hidden' }}>
+                              <div style={{ width: `${pct}%`, height: '100%', background: pct >= 90 ? '#EF4444' : pct >= 70 ? '#F59E0B' : '#10B981', borderRadius: '4px' }} />
+                            </div>
+                            <span style={{ fontSize: '0.78rem', color: '#6B7280' }}>{pct}%</span>
+                          </div>
+                        </td>
+                      </tr>
+                    );
+                  })}
+                </tbody>
+              </table>
+            </div>
+          )}
+        </div>
+      )}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/RosterOptimizer.jsx b/templates/crm-homecare/frontend/src/components/admin/RosterOptimizer.jsx
new file mode 100644
index 0000000..268cd11
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/RosterOptimizer.jsx
@@ -0,0 +1,646 @@
+// RosterOptimizer.jsx
+// Full-roster schedule optimizer. Loads ALL active caregivers and clients,
+// lets the admin set target hours per caretaker and visits/hours per client,
+// runs the algorithm, reviews the proposed schedule, then applies it.
+// Zero impact on live schedules until "Apply" is clicked.
+
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const DAY_NAMES = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+const DAY_COLORS = ['#8B5CF6', '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#EC4899', '#06B6D4'];
+const CG_COLORS  = ['#3B82F6','#10B981','#F59E0B','#EF4444','#8B5CF6','#EC4899','#06B6D4','#84CC16','#F97316','#6366F1'];
+
+function fmtTime(t) {
+  if (!t) return '';
+  const [h, m] = t.slice(0, 5).split(':');
+  const hour = parseInt(h);
+  return `${hour % 12 || 12}:${m}${hour >= 12 ? 'pm' : 'am'}`;
+}
+
+function suggestVisits(hrs) {
+  if (!hrs || hrs <= 0) return 3;
+  if (hrs <= 5)  return 2;
+  if (hrs <= 10) return 3;
+  if (hrs <= 20) return 4;
+  if (hrs <= 30) return 5;
+  return 6;
+}
+
+export default function RosterOptimizer({ token }) {
+  // ── Data ─────────────────────────────────────────────────────────────────
+  const [roster, setRoster]         = useState(null);   // raw roster from API
+  const [caregivers, setCaregivers] = useState([]);     // [{id,name,targetHours,...}]
+  const [clients, setClients]       = useState([]);     // [{id,name,hoursPerWeek,visitsPerWeek,...}]
+  const [loading, setLoading]       = useState(true);
+  const [loadError, setLoadError]   = useState(null);
+
+  // ── UI state ──────────────────────────────────────────────────────────────
+  const [step, setStep]         = useState('setup');   // 'setup' | 'results'
+  const [running, setRunning]   = useState(false);
+  const [applying, setApplying] = useState(false);
+  const [result, setResult]     = useState(null);
+  const [viewMode, setViewMode] = useState('grid');    // 'grid' | 'list'
+  const [selected, setSelected] = useState(new Set()); // proposal ids to apply
+  const [toast, setToast]       = useState(null);
+  const [cgFilter, setCgFilter] = useState('');
+  const [clFilter, setClFilter] = useState('');
+
+  const showToast = (msg, type = 'success') => {
+    setToast({ msg, type });
+    setTimeout(() => setToast(null), 4500);
+  };
+
+  const api = useCallback(async (url, opts = {}) => {
+    const res = await fetch(`${API_BASE_URL}${url}`, {
+      ...opts,
+      headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}`, ...opts.headers },
+    });
+    if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.error || `${res.status}`); }
+    return res.json();
+  }, [token]);
+
+  // ── Load roster ───────────────────────────────────────────────────────────
+  useEffect(() => {
+    (async () => {
+      try {
+        const data = await api('/api/roster-optimizer/roster');
+        setRoster(data);
+        setCaregivers(data.caregivers.map(cg => ({
+          ...cg,
+          targetHours: parseFloat(cg.max_hours_per_week) || 40,
+          enabled: true,
+        })));
+        setClients(data.clients.map(cl => ({
+          ...cl,
+          hoursPerWeek: parseFloat(cl.assigned_hours_per_week) || 0,
+          visitsPerWeek: suggestVisits(parseFloat(cl.assigned_hours_per_week)),
+          enabled: true,
+        })));
+      } catch (err) {
+        setLoadError(err.message);
+      } finally {
+        setLoading(false);
+      }
+    })();
+  }, [api]);
+
+  // ── Caregiver helpers ─────────────────────────────────────────────────────
+  const updateCg = (id, field, value) =>
+    setCaregivers(prev => prev.map(c => c.id === id ? { ...c, [field]: value } : c));
+
+  const toggleAllCg = (val) =>
+    setCaregivers(prev => prev.map(c => ({ ...c, enabled: val })));
+
+  // ── Client helpers ────────────────────────────────────────────────────────
+  const updateCl = (id, field, value) =>
+    setClients(prev => prev.map(c => c.id === id ? { ...c, [field]: parseFloat(value) || 0 } : c));
+
+  const toggleAllCl = (val) =>
+    setClients(prev => prev.map(c => ({ ...c, enabled: val })));
+
+  // ── Run optimizer ─────────────────────────────────────────────────────────
+  const runOptimizer = async () => {
+    const activeCg = caregivers.filter(c => c.enabled);
+    const activeCl = clients.filter(c => c.enabled && c.hoursPerWeek > 0 && c.visitsPerWeek > 0);
+
+    if (!activeCg.length) { showToast('Enable at least one caretaker', 'error'); return; }
+    if (!activeCl.length) { showToast('Enable at least one client with hours set', 'error'); return; }
+
+    setRunning(true);
+    setResult(null);
+    try {
+      const data = await api('/api/roster-optimizer/run', {
+        method: 'POST',
+        body: JSON.stringify({
+          caregivers: activeCg.map(c => ({ id: c.id, targetHours: c.targetHours })),
+          clients: activeCl.map(c => ({ id: c.id, hoursPerWeek: c.hoursPerWeek, visitsPerWeek: c.visitsPerWeek })),
+        }),
+      });
+      setResult(data);
+      // Auto-select all non-conflicting proposals
+      setSelected(new Set(data.proposals.filter(p => !p.hasConflict).map(p => p.id)));
+      setStep('results');
+    } catch (err) {
+      showToast('Optimizer failed: ' + err.message, 'error');
+    } finally {
+      setRunning(false);
+    }
+  };
+
+  // ── Apply proposals ───────────────────────────────────────────────────────
+  const applyProposals = async () => {
+    if (!result || selected.size === 0) return;
+    const toApply = result.proposals.filter(p => selected.has(p.id));
+    setApplying(true);
+    try {
+      const data = await api('/api/roster-optimizer/apply', {
+        method: 'POST',
+        body: JSON.stringify({ proposals: toApply }),
+      });
+      showToast(`✅ Applied ${data.created} schedule${data.created !== 1 ? 's' : ''} to live schedule!`);
+      if (data.errors > 0) showToast(`⚠️ ${data.errors} failed`, 'error');
+      setStep('setup');
+      setResult(null);
+    } catch (err) {
+      showToast('Apply failed: ' + err.message, 'error');
+    } finally {
+      setApplying(false);
+    }
+  };
+
+  const toggleProposal = (id) => setSelected(prev => {
+    const next = new Set(prev);
+    next.has(id) ? next.delete(id) : next.add(id);
+    return next;
+  });
+
+  const cgColorFor = (id) => {
+    const idx = caregivers.findIndex(c => c.id === id);
+    return CG_COLORS[idx % CG_COLORS.length] || '#6B7280';
+  };
+
+  // ── Loading / error ───────────────────────────────────────────────────────
+  if (loading) return (
+    <div style={{ textAlign: 'center', padding: '3rem', color: '#6B7280' }}>
+      <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>⏳</div>
+      Loading your full roster...
+    </div>
+  );
+
+  if (loadError) return (
+    <div style={{ textAlign: 'center', padding: '3rem', color: '#DC2626' }}>
+      <div style={{ fontSize: '1.5rem', marginBottom: '0.5rem' }}>❌</div>
+      Failed to load roster: {loadError}
+    </div>
+  );
+
+  const activeCgCount = caregivers.filter(c => c.enabled).length;
+  const activeClCount = clients.filter(c => c.enabled).length;
+  const totalTargetHrs = caregivers.filter(c => c.enabled).reduce((s, c) => s + c.targetHours, 0);
+  const totalNeededHrs = clients.filter(c => c.enabled).reduce((s, c) => s + c.hoursPerWeek, 0);
+
+  // ── Render ────────────────────────────────────────────────────────────────
+  return (
+    <div>
+
+      {/* Toast */}
+      {toast && (
+        <div style={{
+          position: 'fixed', top: '1rem', right: '1rem', zIndex: 9999,
+          padding: '0.75rem 1.25rem', borderRadius: '10px', fontWeight: '600',
+          background: toast.type === 'error' ? '#FEE2E2' : '#D1FAE5',
+          color: toast.type === 'error' ? '#DC2626' : '#065F46',
+          boxShadow: '0 4px 12px rgba(0,0,0,0.2)',
+        }}>{toast.msg}</div>
+      )}
+
+      {/* Header Banner */}
+      <div style={{
+        background: 'linear-gradient(135deg, #1e3a5f 0%, #0f766e 100%)',
+        borderRadius: '12px', padding: '1.25rem 1.5rem', marginBottom: '1.5rem', color: '#fff',
+      }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.75rem' }}>
+          <div>
+            <h3 style={{ margin: '0 0 0.35rem', fontSize: '1.15rem' }}>📊 Roster Schedule Optimizer</h3>
+            <p style={{ margin: 0, fontSize: '0.87rem', opacity: 0.88 }}>
+              Automatically analyzes your entire team and client roster to build the best weekly schedule.
+              Nothing changes until you review and apply.
+            </p>
+          </div>
+          <div style={{ display: 'flex', gap: '1.25rem', flexShrink: 0 }}>
+            <div style={{ textAlign: 'center' }}>
+              <div style={{ fontSize: '1.5rem', fontWeight: '800' }}>{caregivers.length}</div>
+              <div style={{ fontSize: '0.72rem', opacity: 0.8 }}>Caretakers</div>
+            </div>
+            <div style={{ textAlign: 'center' }}>
+              <div style={{ fontSize: '1.5rem', fontWeight: '800' }}>{clients.length}</div>
+              <div style={{ fontSize: '0.72rem', opacity: 0.8 }}>Clients</div>
+            </div>
+          </div>
+        </div>
+      </div>
+
+      {/* ═══════════════════════════ SETUP STEP ═══════════════════════════ */}
+      {step === 'setup' && (
+        <>
+          {/* Capacity check bar */}
+          {activeCgCount > 0 && activeClCount > 0 && (
+            <div style={{
+              padding: '0.75rem 1rem', borderRadius: '8px', marginBottom: '1.25rem',
+              background: totalTargetHrs >= totalNeededHrs ? '#F0FDF4' : '#FFFBEB',
+              border: `1px solid ${totalTargetHrs >= totalNeededHrs ? '#A7F3D0' : '#FDE68A'}`,
+              display: 'flex', alignItems: 'center', gap: '1rem', flexWrap: 'wrap',
+            }}>
+              <span style={{ fontSize: '0.88rem', fontWeight: '600',
+                color: totalTargetHrs >= totalNeededHrs ? '#065F46' : '#92400E' }}>
+                {totalTargetHrs >= totalNeededHrs ? '✅' : '⚠️'} Capacity Check
+              </span>
+              <span style={{ fontSize: '0.85rem', color: '#374151' }}>
+                Available caretaker hours: <strong>{totalTargetHrs}h</strong> &nbsp;|&nbsp;
+                Client hours needed: <strong>{totalNeededHrs}h</strong> &nbsp;|&nbsp;
+                {totalTargetHrs >= totalNeededHrs
+                  ? <span style={{ color: '#059669' }}>+{(totalTargetHrs - totalNeededHrs).toFixed(1)}h buffer</span>
+                  : <span style={{ color: '#D97706' }}>⚠ {(totalNeededHrs - totalTargetHrs).toFixed(1)}h shortfall</span>
+                }
+              </span>
+            </div>
+          )}
+
+          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1.25rem', marginBottom: '1.5rem' }}>
+
+            {/* ── Caretakers Panel ── */}
+            <div className="card">
+              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>
+                <h4 style={{ margin: 0, color: '#1E40AF' }}>
+                  👤 Caretakers
+                  <span style={{ marginLeft: '0.5rem', fontSize: '0.75rem', background: '#DBEAFE', color: '#1E40AF', padding: '0.2rem 0.5rem', borderRadius: '12px' }}>
+                    {activeCgCount} / {caregivers.length} active
+                  </span>
+                </h4>
+                <div style={{ display: 'flex', gap: '0.4rem' }}>
+                  <button onClick={() => toggleAllCg(true)} style={{ fontSize: '0.72rem', padding: '0.2rem 0.5rem', borderRadius: '5px', border: '1px solid #BFDBFE', background: '#EFF6FF', cursor: 'pointer', color: '#1E40AF' }}>All</button>
+                  <button onClick={() => toggleAllCg(false)} style={{ fontSize: '0.72rem', padding: '0.2rem 0.5rem', borderRadius: '5px', border: '1px solid #E5E7EB', background: '#F9FAFB', cursor: 'pointer', color: '#6B7280' }}>None</button>
+                </div>
+              </div>
+
+              <input
+                placeholder="🔍 Filter caretakers..."
+                value={cgFilter}
+                onChange={e => setCgFilter(e.target.value)}
+                style={{ width: '100%', padding: '0.45rem 0.6rem', borderRadius: '7px', border: '1px solid #E5E7EB', fontSize: '0.85rem', marginBottom: '0.75rem', boxSizing: 'border-box' }}
+              />
+
+              <div style={{ maxHeight: '420px', overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+                {caregivers
+                  .filter(cg => !cgFilter || `${cg.first_name} ${cg.last_name}`.toLowerCase().includes(cgFilter.toLowerCase()))
+                  .map((cg, idx) => (
+                  <div key={cg.id} style={{
+                    display: 'flex', alignItems: 'center', gap: '0.6rem',
+                    padding: '0.6rem 0.75rem', borderRadius: '8px',
+                    background: cg.enabled ? '#F0F9FF' : '#F9FAFB',
+                    border: `1.5px solid ${cg.enabled ? cgColorFor(cg.id) + '40' : '#E5E7EB'}`,
+                    opacity: cg.enabled ? 1 : 0.55,
+                  }}>
+                    <input type="checkbox" checked={cg.enabled}
+                      onChange={e => updateCg(cg.id, 'enabled', e.target.checked)}
+                      style={{ cursor: 'pointer', width: 'auto', flexShrink: 0 }} />
+                    <div style={{ width: '9px', height: '9px', borderRadius: '50%', background: cgColorFor(cg.id), flexShrink: 0 }} />
+                    <div style={{ flex: 1, minWidth: 0 }}>
+                      <div style={{ fontWeight: '600', fontSize: '0.88rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
+                        {cg.first_name} {cg.last_name}
+                      </div>
+                      <div style={{ fontSize: '0.72rem', color: '#6B7280' }}>
+                        {cg.current_weekly_hours}h existing · {cg.active_client_count} clients
+                      </div>
+                    </div>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.3rem', flexShrink: 0 }}>
+                      <span style={{ fontSize: '0.72rem', color: '#6B7280' }}>Target:</span>
+                      <input
+                        type="number" min="1" max="80" step="0.5"
+                        value={cg.targetHours}
+                        onChange={e => updateCg(cg.id, 'targetHours', parseFloat(e.target.value) || 0)}
+                        disabled={!cg.enabled}
+                        style={{ width: '52px', padding: '0.25rem 0.3rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem', textAlign: 'center' }}
+                      />
+                      <span style={{ fontSize: '0.72rem', color: '#6B7280' }}>h</span>
+                    </div>
+                  </div>
+                ))}
+              </div>
+            </div>
+
+            {/* ── Clients Panel ── */}
+            <div className="card">
+              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>
+                <h4 style={{ margin: 0, color: '#065F46' }}>
+                  🏥 Clients
+                  <span style={{ marginLeft: '0.5rem', fontSize: '0.75rem', background: '#D1FAE5', color: '#065F46', padding: '0.2rem 0.5rem', borderRadius: '12px' }}>
+                    {activeClCount} / {clients.length} active
+                  </span>
+                </h4>
+                <div style={{ display: 'flex', gap: '0.4rem' }}>
+                  <button onClick={() => toggleAllCl(true)} style={{ fontSize: '0.72rem', padding: '0.2rem 0.5rem', borderRadius: '5px', border: '1px solid #A7F3D0', background: '#ECFDF5', cursor: 'pointer', color: '#065F46' }}>All</button>
+                  <button onClick={() => toggleAllCl(false)} style={{ fontSize: '0.72rem', padding: '0.2rem 0.5rem', borderRadius: '5px', border: '1px solid #E5E7EB', background: '#F9FAFB', cursor: 'pointer', color: '#6B7280' }}>None</button>
+                </div>
+              </div>
+
+              <input
+                placeholder="🔍 Filter clients..."
+                value={clFilter}
+                onChange={e => setClFilter(e.target.value)}
+                style={{ width: '100%', padding: '0.45rem 0.6rem', borderRadius: '7px', border: '1px solid #E5E7EB', fontSize: '0.85rem', marginBottom: '0.75rem', boxSizing: 'border-box' }}
+              />
+
+              <div style={{ maxHeight: '420px', overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+                {clients
+                  .filter(cl => !clFilter || `${cl.first_name} ${cl.last_name}`.toLowerCase().includes(clFilter.toLowerCase()))
+                  .map(cl => (
+                  <div key={cl.id} style={{
+                    padding: '0.6rem 0.75rem', borderRadius: '8px',
+                    background: cl.enabled ? '#F0FDF4' : '#F9FAFB',
+                    border: `1.5px solid ${cl.enabled ? '#A7F3D0' : '#E5E7EB'}`,
+                    opacity: cl.enabled ? 1 : 0.55,
+                  }}>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.6rem', marginBottom: cl.enabled ? '0.5rem' : 0 }}>
+                      <input type="checkbox" checked={cl.enabled}
+                        onChange={e => updateCl(cl.id, 'enabled', e.target.checked ? 1 : 0)}
+                        style={{ cursor: 'pointer', width: 'auto', flexShrink: 0 }} />
+                      <div style={{ flex: 1, minWidth: 0 }}>
+                        <div style={{ fontWeight: '600', fontSize: '0.88rem', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
+                          {cl.first_name} {cl.last_name}
+                        </div>
+                        {cl.scheduled_days?.length > 0 && (
+                          <div style={{ display: 'flex', gap: '0.2rem', flexWrap: 'wrap', marginTop: '0.15rem' }}>
+                            {cl.scheduled_days.map(d => (
+                              <span key={d} style={{ fontSize: '0.65rem', padding: '0.1rem 0.3rem', borderRadius: '3px', background: DAY_COLORS[d] + '25', color: DAY_COLORS[d], fontWeight: '700' }}>
+                                {DAY_NAMES[d]}
+                              </span>
+                            ))}
+                          </div>
+                        )}
+                      </div>
+                    </div>
+                    {cl.enabled && (
+                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.4rem' }}>
+                        <div>
+                          <label style={{ fontSize: '0.68rem', fontWeight: '700', color: '#374151', display: 'block', marginBottom: '0.15rem' }}>Hrs / Week</label>
+                          <input type="number" min="0" max="80" step="0.25"
+                            value={cl.hoursPerWeek}
+                            onChange={e => updateCl(cl.id, 'hoursPerWeek', e.target.value)}
+                            style={{ width: '100%', padding: '0.3rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem', boxSizing: 'border-box' }}
+                          />
+                        </div>
+                        <div>
+                          <label style={{ fontSize: '0.68rem', fontWeight: '700', color: '#374151', display: 'block', marginBottom: '0.15rem' }}>Visits / Week</label>
+                          <input type="number" min="1" max="7"
+                            value={cl.visitsPerWeek}
+                            onChange={e => updateCl(cl.id, 'visitsPerWeek', e.target.value)}
+                            style={{ width: '100%', padding: '0.3rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.85rem', boxSizing: 'border-box' }}
+                          />
+                        </div>
+                        {cl.hoursPerWeek > 0 && cl.visitsPerWeek > 0 && (
+                          <div style={{ gridColumn: '1/-1', fontSize: '0.7rem', color: '#6B7280' }}>
+                            ≈ {(cl.hoursPerWeek / cl.visitsPerWeek).toFixed(1)}h per visit
+                          </div>
+                        )}
+                      </div>
+                    )}
+                  </div>
+                ))}
+              </div>
+            </div>
+
+          </div>
+
+          {/* Generate button */}
+          <div style={{ textAlign: 'center' }}>
+            <button
+              onClick={runOptimizer}
+              disabled={running || activeCgCount === 0 || activeClCount === 0}
+              style={{
+                padding: '0.95rem 2.75rem', borderRadius: '10px', border: 'none', cursor: 'pointer',
+                fontWeight: '700', fontSize: '1.05rem',
+                background: running || activeCgCount === 0 || activeClCount === 0
+                  ? '#9CA3AF'
+                  : 'linear-gradient(135deg, #1e3a5f, #0f766e)',
+                color: '#fff',
+                boxShadow: running ? 'none' : '0 4px 18px rgba(15,118,110,0.4)',
+                transition: 'all 0.2s',
+              }}>
+              {running ? '⏳ Analyzing roster...' : `✨ Generate Optimized Schedule (${activeCgCount} caretakers · ${activeClCount} clients)`}
+            </button>
+            {(activeCgCount === 0 || activeClCount === 0) && (
+              <p style={{ margin: '0.5rem 0 0', fontSize: '0.82rem', color: '#9CA3AF' }}>
+                Enable at least one caretaker and one client to continue
+              </p>
+            )}
+          </div>
+        </>
+      )}
+
+      {/* ═══════════════════════════ RESULTS STEP ═════════════════════════ */}
+      {step === 'results' && result && (
+        <div>
+          {/* Summary stats */}
+          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4,1fr)', gap: '0.75rem', marginBottom: '1.25rem' }}>
+            {[
+              { label: 'Proposals', value: result.summary.totalProposals, color: '#2563EB', bg: '#EFF6FF' },
+              { label: 'Clients Covered', value: `${result.summary.fullyScheduledClients}/${result.summary.totalClients}`, color: '#059669', bg: '#F0FDF4' },
+              { label: 'Conflicts', value: result.summary.conflictCount, color: result.summary.conflictCount > 0 ? '#DC2626' : '#059669', bg: result.summary.conflictCount > 0 ? '#FEF2F2' : '#F0FDF4' },
+              { label: 'Unscheduled', value: result.summary.unscheduledCount, color: result.summary.unscheduledCount > 0 ? '#D97706' : '#059669', bg: result.summary.unscheduledCount > 0 ? '#FFFBEB' : '#F0FDF4' },
+            ].map(s => (
+              <div key={s.label} className="card" style={{ textAlign: 'center', padding: '0.75rem', background: s.bg }}>
+                <div style={{ fontSize: '1.85rem', fontWeight: '800', color: s.color }}>{s.value}</div>
+                <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{s.label}</div>
+              </div>
+            ))}
+          </div>
+
+          {/* Caregiver utilization bars */}
+          <div className="card" style={{ marginBottom: '1.25rem' }}>
+            <h4 style={{ margin: '0 0 0.75rem' }}>👤 Caretaker Utilization</h4>
+            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.75rem' }}>
+              {result.summary.caregivers.map(cg => (
+                <div key={cg.id} style={{ flex: '1 1 200px', padding: '0.75rem', background: '#F9FAFB', borderRadius: '8px', borderLeft: `4px solid ${cgColorFor(cg.id)}` }}>
+                  <div style={{ fontWeight: '700', fontSize: '0.88rem', marginBottom: '0.3rem' }}>{cg.name}</div>
+                  <div style={{ fontSize: '0.75rem', color: '#6B7280', marginBottom: '0.35rem' }}>
+                    {cg.existingHours}h existing + {cg.proposedNewHours}h new = <strong style={{ color: '#111' }}>{cg.totalHours}h</strong> / {cg.targetHours}h target
+                  </div>
+                  <div style={{ height: '7px', background: '#E5E7EB', borderRadius: '4px', overflow: 'hidden' }}>
+                    <div style={{
+                      width: `${cg.utilizationPct}%`, height: '100%',
+                      background: cg.utilizationPct > 100 ? '#DC2626' : cgColorFor(cg.id),
+                      transition: 'width 0.4s',
+                    }} />
+                  </div>
+                  <div style={{ fontSize: '0.7rem', marginTop: '0.25rem', color: cg.remainingCapacity > 0 ? '#059669' : '#6B7280' }}>
+                    {cg.utilizationPct}% utilized
+                    {cg.remainingCapacity > 0 && ` · ${cg.remainingCapacity}h open`}
+                  </div>
+                </div>
+              ))}
+            </div>
+          </div>
+
+          {/* Client coverage */}
+          <div className="card" style={{ marginBottom: '1.25rem' }}>
+            <h4 style={{ margin: '0 0 0.75rem' }}>🏥 Client Coverage</h4>
+            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.6rem' }}>
+              {result.summary.clients.map(cl => (
+                <div key={cl.id} style={{
+                  flex: '1 1 150px', padding: '0.6rem 0.75rem', borderRadius: '8px',
+                  background: cl.fullyScheduled ? '#F0FDF4' : '#FFFBEB',
+                  border: `1.5px solid ${cl.fullyScheduled ? '#A7F3D0' : '#FDE68A'}`,
+                }}>
+                  <div style={{ fontWeight: '700', fontSize: '0.85rem', marginBottom: '0.2rem' }}>{cl.name}</div>
+                  <div style={{ fontSize: '0.8rem' }}>
+                    {cl.fullyScheduled
+                      ? <span style={{ color: '#059669' }}>✅ {cl.visitsPlaced}/{cl.visitsNeeded} visits</span>
+                      : <span style={{ color: '#D97706' }}>⚠ {cl.visitsPlaced}/{cl.visitsNeeded} visits</span>}
+                  </div>
+                  <div style={{ fontSize: '0.72rem', color: '#6B7280' }}>{cl.hoursPerWeek}h/wk</div>
+                </div>
+              ))}
+            </div>
+          </div>
+
+          {/* Unscheduled warnings */}
+          {result.unscheduled.length > 0 && (
+            <div style={{ padding: '0.875rem 1rem', background: '#FFFBEB', border: '1px solid #FDE68A', borderRadius: '8px', marginBottom: '1.25rem' }}>
+              <div style={{ fontWeight: '700', color: '#92400E', marginBottom: '0.4rem' }}>⚠️ Could Not Schedule</div>
+              {result.unscheduled.map((u, i) => (
+                <div key={i} style={{ fontSize: '0.85rem', color: '#B45309' }}>
+                  {u.clientName} — Visit {u.visitNumber}: {u.reason}
+                </div>
+              ))}
+            </div>
+          )}
+
+          {/* View toggle + proposals */}
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem', flexWrap: 'wrap', gap: '0.5rem' }}>
+            <h4 style={{ margin: 0 }}>📋 Proposed Schedule
+              <span style={{ marginLeft: '0.5rem', fontSize: '0.8rem', color: '#6B7280', fontWeight: '400' }}>
+                ({selected.size} of {result.proposals.length} selected)
+              </span>
+            </h4>
+            <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+              <button onClick={() => setSelected(result.proposals.size === selected.size ? new Set() : new Set(result.proposals.map(p => p.id)))}
+                style={{ padding: '0.3rem 0.75rem', borderRadius: '6px', border: '1px solid #D1D5DB', background: '#fff', fontSize: '0.78rem', cursor: 'pointer' }}>
+                {selected.size === result.proposals.length ? 'Deselect All' : 'Select All'}
+              </button>
+              {['grid','list'].map(v => (
+                <button key={v} onClick={() => setViewMode(v)}
+                  style={{ padding: '0.3rem 0.75rem', borderRadius: '6px', border: 'none', fontSize: '0.78rem', cursor: 'pointer',
+                    background: viewMode === v ? '#1d4ed8' : '#F3F4F6',
+                    color: viewMode === v ? '#fff' : '#374151' }}>
+                  {v.charAt(0).toUpperCase() + v.slice(1)}
+                </button>
+              ))}
+            </div>
+          </div>
+
+          {/* GRID VIEW */}
+          {viewMode === 'grid' && (
+            <div style={{ overflowX: 'auto', marginBottom: '1.25rem' }}>
+              <table style={{ width: '100%', borderCollapse: 'collapse', minWidth: '700px' }}>
+                <thead>
+                  <tr style={{ background: '#F9FAFB' }}>
+                    <th style={{ padding: '0.6rem 0.75rem', textAlign: 'left', fontSize: '0.8rem', color: '#6B7280', fontWeight: '600', borderBottom: '2px solid #E5E7EB', whiteSpace: 'nowrap' }}>Caretaker</th>
+                    {DAY_NAMES.map(d => (
+                      <th key={d} style={{ padding: '0.6rem 0.4rem', textAlign: 'center', fontSize: '0.8rem', color: '#6B7280', fontWeight: '600', borderBottom: '2px solid #E5E7EB', minWidth: '85px' }}>{d}</th>
+                    ))}
+                  </tr>
+                </thead>
+                <tbody>
+                  {result.summary.caregivers.map(cg => (
+                    <tr key={cg.id} style={{ borderBottom: '1px solid #F3F4F6' }}>
+                      <td style={{ padding: '0.4rem 0.75rem', verticalAlign: 'top' }}>
+                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>
+                          <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: cgColorFor(cg.id), flexShrink: 0 }} />
+                          <span style={{ fontSize: '0.83rem', fontWeight: '600', whiteSpace: 'nowrap' }}>{cg.name.split(' ')[0]}</span>
+                        </div>
+                        <div style={{ fontSize: '0.68rem', color: '#9CA3AF', paddingLeft: '1.1rem' }}>{cg.totalHours}/{cg.targetHours}h</div>
+                      </td>
+                      {[0,1,2,3,4,5,6].map(day => {
+                        const existing = result.existingSchedules.filter(s => s.caregiverId === cg.id && s.dayOfWeek === day);
+                        const proposed = result.proposals.filter(p => p.caregiverId === cg.id && p.dayOfWeek === day);
+                        return (
+                          <td key={day} style={{ padding: '0.2rem', verticalAlign: 'top' }}>
+                            {existing.map(s => (
+                              <div key={s.id} title="Existing — not changed" style={{ fontSize: '0.65rem', padding: '0.2rem 0.3rem', marginBottom: '0.15rem', borderRadius: '4px', background: '#F3F4F6', borderLeft: `3px solid ${cgColorFor(cg.id)}60`, color: '#9CA3AF' }}>
+                                <div style={{ fontWeight: '600', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{s.clientName?.split(' ')[0]}</div>
+                                <div>{fmtTime(s.startTime)}</div>
+                              </div>
+                            ))}
+                            {proposed.map(p => (
+                              <div key={p.id} onClick={() => toggleProposal(p.id)}
+                                title={p.hasConflict ? `⚠ Overlaps: ${p.conflictsWith.map(c => c.clientName).join(', ')}` : 'Click to toggle'}
+                                style={{ fontSize: '0.65rem', padding: '0.2rem 0.3rem', marginBottom: '0.15rem', borderRadius: '4px', cursor: 'pointer',
+                                  background: selected.has(p.id) ? (p.hasConflict ? '#FEE2E2' : '#DBEAFE') : '#fff',
+                                  borderLeft: `3px solid ${p.hasConflict ? '#DC2626' : cgColorFor(p.caregiverId)}`,
+                                  border: `1px solid ${p.hasConflict ? '#FCA5A5' : '#BFDBFE'}`,
+                                  opacity: selected.has(p.id) ? 1 : 0.45,
+                                }}>
+                                <div style={{ fontWeight: '700', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
+                                  {p.hasConflict ? '⚠ ' : '✦ '}{p.clientName?.split(' ')[0]}
+                                </div>
+                                <div>{fmtTime(p.startTime)}–{fmtTime(p.endTime)}</div>
+                              </div>
+                            ))}
+                          </td>
+                        );
+                      })}
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+              <div style={{ display: 'flex', gap: '1.25rem', fontSize: '0.72rem', color: '#6B7280', marginTop: '0.5rem', flexWrap: 'wrap' }}>
+                <span>◻ Grey = existing (unchanged)</span>
+                <span style={{ color: '#1D4ED8' }}>🔷 Blue = proposed new (selected)</span>
+                <span style={{ color: '#DC2626' }}>🔴 Red = conflict (review before applying)</span>
+                <span>Click any proposal to toggle</span>
+              </div>
+            </div>
+          )}
+
+          {/* LIST VIEW */}
+          {viewMode === 'list' && (
+            <div style={{ marginBottom: '1.25rem', display: 'flex', flexDirection: 'column', gap: '0.4rem' }}>
+              {result.proposals.map(p => (
+                <div key={p.id} onClick={() => toggleProposal(p.id)}
+                  style={{
+                    display: 'flex', alignItems: 'flex-start', gap: '0.75rem',
+                    padding: '0.7rem 0.9rem', borderRadius: '8px', cursor: 'pointer',
+                    background: selected.has(p.id) ? (p.hasConflict ? '#FEF2F2' : '#EFF6FF') : '#FAFAFA',
+                    border: `1.5px solid ${selected.has(p.id) ? (p.hasConflict ? '#FCA5A5' : '#BFDBFE') : '#E5E7EB'}`,
+                  }}>
+                  <input type="checkbox" checked={selected.has(p.id)} onChange={() => {}} style={{ width: 'auto', cursor: 'pointer', marginTop: '2px' }} />
+                  <div style={{ width: '9px', height: '9px', borderRadius: '50%', background: cgColorFor(p.caregiverId), flexShrink: 0, marginTop: '4px' }} />
+                  <div style={{ flex: 1 }}>
+                    <div style={{ fontWeight: '600', fontSize: '0.88rem' }}>
+                      {p.clientName}
+                      {p.hasConflict && <span style={{ marginLeft: '0.4rem', fontSize: '0.68rem', padding: '0.1rem 0.4rem', background: '#FEE2E2', color: '#DC2626', borderRadius: '4px' }}>⚠ CONFLICT</span>}
+                    </div>
+                    <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>
+                      {p.caregiverName} · {p.dayName} {fmtTime(p.startTime)}–{fmtTime(p.endTime)} ({p.hoursPerVisit}h)
+                    </div>
+                    {p.hasConflict && p.conflictsWith.map((c, i) => (
+                      <div key={i} style={{ fontSize: '0.73rem', color: '#DC2626', marginTop: '0.15rem' }}>
+                        ⚠ Overlaps {c.clientName} ({fmtTime(c.start)}–{fmtTime(c.end)})
+                      </div>
+                    ))}
+                  </div>
+                </div>
+              ))}
+            </div>
+          )}
+
+          {/* Action bar */}
+          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end', alignItems: 'center', padding: '1rem', background: '#F9FAFB', borderRadius: '10px' }}>
+            <button onClick={() => setStep('setup')}
+              style={{ padding: '0.7rem 1.4rem', borderRadius: '8px', border: '1.5px solid #D1D5DB', background: '#fff', cursor: 'pointer', fontWeight: '600', fontSize: '0.88rem' }}>
+              ← Back to Setup
+            </button>
+            <button onClick={runOptimizer} disabled={running}
+              style={{ padding: '0.7rem 1.4rem', borderRadius: '8px', border: 'none', background: '#F3F4F6', cursor: 'pointer', fontWeight: '600', fontSize: '0.88rem' }}>
+              🔄 Re-run
+            </button>
+            <button onClick={applyProposals} disabled={applying || selected.size === 0}
+              style={{
+                padding: '0.7rem 1.75rem', borderRadius: '8px', border: 'none', cursor: 'pointer',
+                fontWeight: '700', fontSize: '0.95rem',
+                background: applying || selected.size === 0 ? '#9CA3AF' : 'linear-gradient(135deg, #059669, #0f766e)',
+                color: '#fff', boxShadow: applying || selected.size === 0 ? 'none' : '0 4px 12px rgba(5,150,105,0.35)',
+              }}>
+              {applying ? 'Applying...' : `✅ Apply ${selected.size} to Live Schedule`}
+            </button>
+          </div>
+          <p style={{ fontSize: '0.75rem', color: '#9CA3AF', textAlign: 'center', margin: '0.5rem 0 0' }}>
+            Only checked proposals apply. Conflicts are unchecked by default — review before including.
+          </p>
+        </div>
+      )}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/RouteOptimizer.jsx b/templates/crm-homecare/frontend/src/components/admin/RouteOptimizer.jsx
new file mode 100644
index 0000000..896a7d7
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/RouteOptimizer.jsx
@@ -0,0 +1,1307 @@
+// src/components/admin/RouteOptimizer.jsx
+// Route & Schedule Optimizer v2 — Complete rebuild
+import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const RouteOptimizer = ({ token }) => {
+  // ── Core state ──────────────────────────────────────────────
+  const [activeTab, setActiveTab] = useState('planner');
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [message, setMessage] = useState({ text: '', type: '' });
+  const [apiStatus, setApiStatus] = useState(null);
+
+  // ── Route Planner state ─────────────────────────────────────
+  const [selectedCaregiver, setSelectedCaregiver] = useState('');
+  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
+  const [routeStops, setRouteStops] = useState([]);
+  const [optimizedRoute, setOptimizedRoute] = useState(null);
+  const [preOptimizeMiles, setPreOptimizeMiles] = useState(null);
+  const [optimizing, setOptimizing] = useState(false);
+  const [saving, setSaving] = useState(false);
+  const [startTime, setStartTime] = useState('08:00');
+  const [bufferMinutes, setBufferMinutes] = useState(10);
+  const [mileageRate, setMileageRate] = useState(0.67);
+  const [clientSearch, setClientSearch] = useState('');
+  const [loadingSchedule, setLoadingSchedule] = useState(false);
+  const [existingSavedPlan, setExistingSavedPlan] = useState(null);
+
+  // ── Daily view state ────────────────────────────────────────
+  const [dailyDate, setDailyDate] = useState(new Date().toISOString().split('T')[0]);
+  const [dailyRoutes, setDailyRoutes] = useState([]);
+  const [dailyLoading, setDailyLoading] = useState(false);
+
+  // ── Hours dashboard state ───────────────────────────────────
+  const [hoursData, setHoursData] = useState(null);
+  const [hoursLoading, setHoursLoading] = useState(false);
+  const [hoursStartDate, setHoursStartDate] = useState(() => {
+    const d = new Date(); d.setDate(d.getDate() - d.getDay());
+    return d.toISOString().split('T')[0];
+  });
+  const [hoursEndDate, setHoursEndDate] = useState(() => {
+    const d = new Date(); d.setDate(d.getDate() + (6 - d.getDay()));
+    return d.toISOString().split('T')[0];
+  });
+
+  // ── Saved Routes state ──────────────────────────────────────
+  const [savedRoutes, setSavedRoutes] = useState([]);
+  const [savedRoutesLoading, setSavedRoutesLoading] = useState(false);
+  const [savedFilter, setSavedFilter] = useState({ status: '', caregiverId: '' });
+
+  // ── Geofence state ──────────────────────────────────────────
+  const [geofenceSettings, setGeofenceSettings] = useState([]);
+  const [geofenceLoading, setGeofenceLoading] = useState(false);
+  const [editGeofence, setEditGeofence] = useState(null);
+  const [geocoding, setGeocoding] = useState(false);
+  const [geocodeResults, setGeocodeResults] = useState(null);
+
+  // ── Drag state ──────────────────────────────────────────────
+  const dragItem = useRef(null);
+  const dragOverItem = useRef(null);
+
+  // ── Print ref ───────────────────────────────────────────────
+  const printRef = useRef(null);
+
+  // ════════════════════════════════════════════════════════════
+  // Data Loading
+  // ════════════════════════════════════════════════════════════
+  useEffect(() => {
+    loadData();
+    fetch(`${API_BASE_URL}/api/route-optimizer/config-status`, {
+      headers: { 'Authorization': `Bearer ${token}` }
+    }).then(r => r.ok ? r.json() : null).then(setApiStatus).catch(() => {});
+  }, []);
+
+  useEffect(() => {
+    if (activeTab === 'daily') loadDailyView();
+    if (activeTab === 'hours') loadHoursSummary();
+    if (activeTab === 'geofence') loadGeofenceSettings();
+    if (activeTab === 'saved') loadSavedRoutes();
+  }, [activeTab]);
+
+  const loadData = async () => {
+    try {
+      const [cgRes, clRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/caregivers`, { headers: { 'Authorization': `Bearer ${token}` } }),
+        fetch(`${API_BASE_URL}/api/clients`, { headers: { 'Authorization': `Bearer ${token}` } })
+      ]);
+      const cgData = await cgRes.json();
+      const clData = await clRes.json();
+      setCaregivers(Array.isArray(cgData) ? cgData : []);
+      setClients(Array.isArray(clData) ? clData : []);
+    } catch (e) {
+      console.error('Load error:', e);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const showMsg = (text, type = 'success') => {
+    setMessage({ text, type });
+    setTimeout(() => setMessage({ text: '', type: '' }), 5000);
+  };
+
+  const api = async (url, opts = {}) => {
+    const res = await fetch(`${API_BASE_URL}${url}`, {
+      ...opts,
+      headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}`, ...opts.headers }
+    });
+    if (!res.ok) {
+      const err = await res.json().catch(() => ({}));
+      throw new Error(err.error || `Request failed (${res.status})`);
+    }
+    return res.json();
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Route Planner Logic
+  // ════════════════════════════════════════════════════════════
+
+  // Load from existing schedule
+  const loadFromSchedule = async () => {
+    if (!selectedCaregiver) { showMsg('Select a caregiver first', 'error'); return; }
+    setLoadingSchedule(true);
+    try {
+      const data = await api(`/api/route-optimizer/load-schedule/${selectedCaregiver}/${selectedDate}`);
+      if (data.stops.length === 0) {
+        showMsg(`No schedules found for ${selectedDate}`, 'error');
+        return;
+      }
+      setRouteStops(data.stops);
+      setExistingSavedPlan(data.savedPlan);
+      setOptimizedRoute(null);
+      setPreOptimizeMiles(null);
+      showMsg(`Loaded ${data.stops.length} visits from schedule${data.savedPlan ? ' (saved plan exists)' : ''}`);
+    } catch (e) {
+      showMsg(e.message, 'error');
+    } finally {
+      setLoadingSchedule(false);
+    }
+  };
+
+  // Client search filtering
+  const filteredClients = useMemo(() => {
+    const existing = new Set(routeStops.map(s => s.clientId));
+    return clients
+      .filter(c => c.is_active !== false && !existing.has(c.id))
+      .filter(c => {
+        if (!clientSearch.trim()) return true;
+        const term = clientSearch.toLowerCase();
+        return `${c.first_name} ${c.last_name}`.toLowerCase().includes(term) ||
+          (c.address || '').toLowerCase().includes(term) ||
+          (c.city || '').toLowerCase().includes(term);
+      })
+      .slice(0, 15); // Cap dropdown to prevent performance issues
+  }, [clients, routeStops, clientSearch]);
+
+  const addStopToRoute = (clientId) => {
+    if (routeStops.find(s => s.clientId === clientId)) return;
+    const client = clients.find(c => c.id === clientId);
+    if (!client) return;
+    setRouteStops(prev => [...prev, {
+      clientId: client.id,
+      clientName: `${client.first_name} ${client.last_name}`,
+      address: [client.address, client.city, client.state, client.zip].filter(Boolean).join(', '),
+      latitude: client.latitude, longitude: client.longitude,
+      serviceUnits: client.weekly_authorized_units ? Math.min(client.weekly_authorized_units, 16) : 4,
+      weeklyAuthorizedUnits: client.weekly_authorized_units || 0,
+      startTime: '', endTime: '',
+      hasCoords: !!(client.latitude && client.longitude)
+    }]);
+    setOptimizedRoute(null);
+    setPreOptimizeMiles(null);
+    setClientSearch('');
+  };
+
+  const removeStop = (idx) => {
+    setRouteStops(prev => prev.filter((_, i) => i !== idx));
+    setOptimizedRoute(null);
+  };
+
+  const updateStop = (idx, field, value) => {
+    setRouteStops(prev => prev.map((s, i) => i === idx ? { ...s, [field]: field === 'serviceUnits' ? (parseInt(value) || 0) : value } : s));
+    setOptimizedRoute(null);
+  };
+
+  // Drag and drop
+  const handleDragStart = (idx) => { dragItem.current = idx; };
+  const handleDragEnter = (idx) => { dragOverItem.current = idx; };
+  const handleDragEnd = () => {
+    if (dragItem.current === null || dragOverItem.current === null) return;
+    const items = [...routeStops];
+    const dragged = items.splice(dragItem.current, 1)[0];
+    items.splice(dragOverItem.current, 0, dragged);
+    setRouteStops(items);
+    setOptimizedRoute(null);
+    dragItem.current = null;
+    dragOverItem.current = null;
+  };
+
+  // Optimize
+  const optimizeRoute = async () => {
+    if (!selectedCaregiver) { showMsg('Select a caregiver first', 'error'); return; }
+    if (routeStops.length === 0) { showMsg('Add at least one client', 'error'); return; }
+    const missingCoords = routeStops.filter(s => !s.hasCoords);
+    if (missingCoords.length > 0) {
+      showMsg(`${missingCoords.length} client(s) need geocoded addresses. Go to GPS & Geofence tab → Geocode All.`, 'error');
+      return;
+    }
+    setOptimizing(true);
+    try {
+      const data = await api('/api/route-optimizer/optimize', {
+        method: 'POST',
+        body: JSON.stringify({
+          caregiverId: selectedCaregiver, date: selectedDate, startTime,
+          bufferMinutes, mileageRate,
+          stops: routeStops.map(s => ({
+            clientId: s.clientId, serviceUnits: s.serviceUnits,
+            startTime: s.startTime || undefined, endTime: s.endTime || undefined
+          }))
+        })
+      });
+
+      // Store pre-optimization miles from real calculation
+      if (data.preOptimization) {
+        setPreOptimizeMiles(data.preOptimization.totalMiles);
+      }
+
+      setOptimizedRoute(data);
+      // Update stops to match optimized order
+      setRouteStops(data.stops.map(s => ({
+        clientId: s.clientId, clientName: s.clientName, address: s.address,
+        latitude: s.latitude, longitude: s.longitude,
+        serviceUnits: s.serviceUnits, weeklyAuthorizedUnits: s.weeklyAuthorizedUnits,
+        startTime: s.scheduledStartTime || '', endTime: s.scheduledEndTime || '',
+        hasCoords: true
+      })));
+      const savedMsg = data.summary.milesSaved > 0
+        ? `Saves ${data.summary.milesSaved} mi vs current schedule!`
+        : 'Schedule order is already optimal.';
+      showMsg(`Route optimized! ${data.summary.totalMiles} mi · ${data.summary.totalStops} stops · ${savedMsg}`);
+    } catch (e) {
+      showMsg('Optimization failed: ' + e.message, 'error');
+    } finally {
+      setOptimizing(false);
+    }
+  };
+
+  // Save
+  const saveRoute = async (status = 'draft') => {
+    if (!optimizedRoute) { showMsg('Optimize the route first', 'error'); return; }
+    setSaving(true);
+    try {
+      await api('/api/route-optimizer/save-route', {
+        method: 'POST',
+        body: JSON.stringify({
+          caregiverId: selectedCaregiver, date: selectedDate,
+          stops: optimizedRoute.stops,
+          totalMiles: optimizedRoute.summary.totalMiles,
+          totalDriveMinutes: optimizedRoute.summary.totalDriveMinutes,
+          totalServiceMinutes: optimizedRoute.summary.totalServiceMinutes,
+          status
+        })
+      });
+      showMsg(`Route ${status === 'published' ? 'published' : 'saved as draft'}!`);
+    } catch (e) {
+      showMsg('Save failed: ' + e.message, 'error');
+    } finally {
+      setSaving(false);
+    }
+  };
+
+  // Print route sheet
+  const printRouteSheet = () => {
+    if (!optimizedRoute) return;
+    const r = optimizedRoute;
+    const w = window.open('', '_blank');
+    w.document.write(`<!DOCTYPE html><html><head><title>Route Sheet - ${r.caregiver.name} - ${selectedDate}</title>
+    <style>
+      * { margin: 0; padding: 0; box-sizing: border-box; }
+      body { font-family: Arial, sans-serif; padding: 20px; font-size: 12px; }
+      h1 { font-size: 18px; margin-bottom: 4px; }
+      .meta { color: #666; margin-bottom: 16px; font-size: 11px; }
+      .summary { display: flex; gap: 20px; margin-bottom: 16px; padding: 10px; background: #f5f5f5; border-radius: 6px; }
+      .summary div { text-align: center; }
+      .summary .val { font-size: 18px; font-weight: 800; }
+      .summary .lbl { font-size: 9px; text-transform: uppercase; color: #888; }
+      table { width: 100%; border-collapse: collapse; margin-bottom: 16px; }
+      th { background: #333; color: #fff; padding: 8px; text-align: left; font-size: 10px; text-transform: uppercase; }
+      td { padding: 8px; border-bottom: 1px solid #ddd; vertical-align: top; }
+      tr:nth-child(even) { background: #f9f9f9; }
+      .stop-num { display: inline-block; width: 22px; height: 22px; border-radius: 50%; background: #2563eb; color: #fff; text-align: center; line-height: 22px; font-weight: 800; font-size: 11px; }
+      .notes-area { border: 1px solid #ddd; border-radius: 4px; padding: 8px; min-height: 30px; margin-top: 4px; }
+      .footer { margin-top: 20px; font-size: 10px; color: #999; border-top: 1px solid #ddd; padding-top: 8px; }
+      @media print { body { padding: 10px; } }
+    </style></head><body>
+    <h1>🗺️ Route Sheet — ${r.caregiver.name}</h1>
+    <div class="meta">${selectedDate} · Start: ${r.summary.estimatedStartTime} · End: ~${r.summary.estimatedEndTime} · Home: ${r.caregiver.homeAddress}</div>
+    <div class="summary">
+      <div><div class="val">${r.summary.totalMiles}</div><div class="lbl">Miles</div></div>
+      <div><div class="val">${r.summary.totalStops}</div><div class="lbl">Stops</div></div>
+      <div><div class="val">${r.summary.totalServiceHours}h</div><div class="lbl">Service</div></div>
+      <div><div class="val">${r.summary.totalDriveMinutes}m</div><div class="lbl">Drive</div></div>
+      <div><div class="val">$${r.summary.mileageReimbursement}</div><div class="lbl">Mileage</div></div>
+    </div>
+    <table>
+      <thead><tr><th>#</th><th>Client</th><th>Address</th><th>Arrive</th><th>Depart</th><th>Units</th><th>Miles</th><th>Drive</th><th>Notes / Signature</th></tr></thead>
+      <tbody>
+        <tr style="background:#e8f5e9"><td>🏠</td><td colspan="2"><strong>START: Home</strong> — ${r.caregiver.homeAddress}</td><td>${r.summary.estimatedStartTime}</td><td></td><td></td><td></td><td></td><td></td></tr>
+        ${r.stops.map((s, i) => `
+          <tr><td><span class="stop-num">${i + 1}</span></td>
+          <td><strong>${s.clientName}</strong></td>
+          <td style="font-size:11px">${s.address}</td>
+          <td><strong>${s.calculatedArrival}</strong></td>
+          <td>${s.calculatedDeparture}</td>
+          <td>${s.serviceUnits} (${s.serviceMinutes}m)</td>
+          <td>${s.milesFromPrevious} mi</td>
+          <td>~${s.driveMinutesFromPrevious}m</td>
+          <td><div class="notes-area"></div></td></tr>
+        `).join('')}
+        <tr style="background:#e8f5e9"><td>🏠</td><td colspan="2"><strong>RETURN: Home</strong></td><td>~${r.summary.estimatedEndTime}</td><td></td><td></td><td>${r.summary.returnMiles} mi</td><td>~${r.summary.returnDriveMinutes}m</td><td></td></tr>
+      </tbody>
+    </table>
+    <div class="footer">
+      Generated ${new Date().toLocaleString()} · ${r.summary.routingSource === 'google_routes_api' ? 'Google Routes API (actual road miles)' : 'Estimated distances'} · Mileage rate: $${mileageRate}/mi
+    </div>
+    <script>window.onload = () => window.print();</script>
+    </body></html>`);
+    w.document.close();
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Daily View
+  // ════════════════════════════════════════════════════════════
+  const loadDailyView = async () => {
+    setDailyLoading(true);
+    try {
+      const data = await api(`/api/route-optimizer/daily/${dailyDate}`);
+      setDailyRoutes(data.routes || []);
+    } catch (e) { console.error(e); }
+    finally { setDailyLoading(false); }
+  };
+  useEffect(() => { if (activeTab === 'daily') loadDailyView(); }, [dailyDate]);
+
+  // ════════════════════════════════════════════════════════════
+  // Hours Summary
+  // ════════════════════════════════════════════════════════════
+  const loadHoursSummary = async () => {
+    setHoursLoading(true);
+    try {
+      const data = await api(`/api/route-optimizer/hours-summary?startDate=${hoursStartDate}&endDate=${hoursEndDate}`);
+      setHoursData(data);
+    } catch (e) { console.error(e); }
+    finally { setHoursLoading(false); }
+  };
+  useEffect(() => { if (activeTab === 'hours') loadHoursSummary(); }, [hoursStartDate, hoursEndDate]);
+
+  // ════════════════════════════════════════════════════════════
+  // Saved Routes
+  // ════════════════════════════════════════════════════════════
+  const loadSavedRoutes = async () => {
+    setSavedRoutesLoading(true);
+    try {
+      const params = new URLSearchParams({ limit: '50' });
+      if (savedFilter.status) params.set('status', savedFilter.status);
+      if (savedFilter.caregiverId) params.set('caregiverId', savedFilter.caregiverId);
+      const data = await api(`/api/route-optimizer/saved-routes?${params}`);
+      setSavedRoutes(data.routes || []);
+    } catch (e) { console.error(e); }
+    finally { setSavedRoutesLoading(false); }
+  };
+  useEffect(() => { if (activeTab === 'saved') loadSavedRoutes(); }, [savedFilter]);
+
+  const loadSavedPlanIntoPlanner = async (planId) => {
+    try {
+      const data = await api(`/api/route-optimizer/plans/${planId}/full`);
+      setSelectedCaregiver(data.plan.caregiver_id);
+      setSelectedDate(data.plan.route_date);
+      setRouteStops(data.stops.map(s => ({
+        clientId: s.client_id, clientName: s.clientName,
+        address: s.address, latitude: s.latitude, longitude: s.longitude,
+        serviceUnits: s.service_units || 4,
+        weeklyAuthorizedUnits: s.weekly_authorized_units || 0,
+        startTime: s.arrival_time?.slice(0, 5) || '', endTime: s.departure_time?.slice(0, 5) || '',
+        hasCoords: !!(s.latitude && s.longitude)
+      })));
+      setOptimizedRoute(null);
+      setActiveTab('planner');
+      showMsg(`Loaded saved route: ${data.caregiver.name} · ${data.plan.route_date}`);
+    } catch (e) {
+      showMsg('Failed to load route: ' + e.message, 'error');
+    }
+  };
+
+  const deleteSavedPlan = async (planId) => {
+    if (!window.confirm('Delete this saved route?')) return;
+    try {
+      await api(`/api/route-optimizer/plans/${planId}`, { method: 'DELETE' });
+      showMsg('Route deleted');
+      loadSavedRoutes();
+    } catch (e) { showMsg('Delete failed', 'error'); }
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Geofence
+  // ════════════════════════════════════════════════════════════
+  const loadGeofenceSettings = async () => {
+    setGeofenceLoading(true);
+    try { setGeofenceSettings(await api('/api/route-optimizer/geofence')); }
+    catch (e) { console.error(e); }
+    finally { setGeofenceLoading(false); }
+  };
+
+  const saveGeofence = async (data) => {
+    try {
+      await api('/api/route-optimizer/geofence', { method: 'POST', body: JSON.stringify(data) });
+      showMsg('Geofence saved');
+      loadGeofenceSettings();
+      setEditGeofence(null);
+    } catch (e) { showMsg('Save failed', 'error'); }
+  };
+
+  const geocodeAll = async (type) => {
+    setGeocoding(true);
+    try {
+      const data = await api('/api/route-optimizer/geocode-all', { method: 'POST', body: JSON.stringify({ entityType: type }) });
+      setGeocodeResults(data);
+      showMsg(`Geocoded ${data.success} of ${data.total} ${type} (${data.source})`);
+      loadData();
+    } catch (e) { showMsg('Geocoding failed', 'error'); }
+    finally { setGeocoding(false); }
+  };
+
+  const geocodeSingle = async (entityType, entityId, address, city, state, zip) => {
+    try {
+      await api('/api/route-optimizer/geocode', {
+        method: 'POST', body: JSON.stringify({ address, city, state, zip, entityType, entityId })
+      });
+      showMsg('Address geocoded');
+      loadData();
+    } catch (e) { showMsg(e.message, 'error'); }
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Helper components & computed values
+  // ════════════════════════════════════════════════════════════
+  const totalUnits = routeStops.reduce((sum, s) => sum + s.serviceUnits, 0);
+  const totalHours = (totalUnits * 0.25).toFixed(2);
+  const cg = caregivers.find(c => c.id === selectedCaregiver);
+  const cgHasCoords = cg && cg.latitude && cg.longitude;
+
+  const dayName = (dateStr) => {
+    try { return new Date(dateStr + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }); }
+    catch { return dateStr; }
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Styles
+  // ════════════════════════════════════════════════════════════
+  const s = {
+    page: { padding: '1.25rem', maxWidth: '1440px', margin: '0 auto', fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif', color: '#1a1a2e' },
+    header: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.75rem', marginBottom: '1.25rem' },
+    title: { fontSize: '1.4rem', fontWeight: '800', margin: 0 },
+    tabs: { display: 'flex', gap: '2px', background: '#f0f0f4', borderRadius: '10px', padding: '3px', marginBottom: '1.25rem', overflowX: 'auto' },
+    tab: (active) => ({
+      padding: '0.55rem 1rem', borderRadius: '8px', border: 'none', cursor: 'pointer', fontWeight: '600',
+      fontSize: '0.82rem', transition: 'all 0.15s', whiteSpace: 'nowrap',
+      background: active ? '#fff' : 'transparent', color: active ? '#1a1a2e' : '#888',
+      boxShadow: active ? '0 1px 3px rgba(0,0,0,0.1)' : 'none'
+    }),
+    card: { background: '#fff', borderRadius: '12px', border: '1px solid #e5e5ec', padding: '1.15rem', marginBottom: '0.85rem' },
+    cardTitle: { fontSize: '0.95rem', fontWeight: '700', marginBottom: '0.65rem', display: 'flex', alignItems: 'center', gap: '0.5rem' },
+    row: { display: 'flex', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '0.65rem' },
+    col: (flex = 1) => ({ flex, minWidth: '180px' }),
+    label: { display: 'block', fontSize: '0.72rem', fontWeight: '700', color: '#777', marginBottom: '3px', textTransform: 'uppercase', letterSpacing: '0.4px' },
+    select: { width: '100%', padding: '0.55rem', border: '1px solid #ddd', borderRadius: '8px', fontSize: '0.88rem', background: '#fff', color: '#333' },
+    input: { width: '100%', padding: '0.55rem', border: '1px solid #ddd', borderRadius: '8px', fontSize: '0.88rem', boxSizing: 'border-box' },
+    inputSm: { width: '68px', padding: '0.45rem', border: '1px solid #ddd', borderRadius: '6px', fontSize: '0.82rem', textAlign: 'center' },
+    btn: (bg = '#2563eb', disabled = false) => ({
+      padding: '0.55rem 1.1rem', borderRadius: '8px', border: 'none', cursor: disabled ? 'not-allowed' : 'pointer',
+      fontWeight: '700', fontSize: '0.82rem', color: '#fff', background: disabled ? '#ccc' : bg,
+      transition: 'all 0.15s', opacity: disabled ? 0.6 : 1
+    }),
+    btnSm: (bg = '#2563eb') => ({
+      padding: '0.3rem 0.65rem', borderRadius: '6px', border: 'none', cursor: 'pointer',
+      fontWeight: '700', fontSize: '0.75rem', color: '#fff', background: bg
+    }),
+    btnGhost: (color = '#2563eb') => ({
+      padding: '0.55rem 1.1rem', borderRadius: '8px', border: `2px solid ${color}`, cursor: 'pointer',
+      fontWeight: '700', fontSize: '0.82rem', color, background: 'transparent'
+    }),
+    msg: (type) => ({
+      padding: '0.7rem 1rem', borderRadius: '8px', marginBottom: '0.85rem', fontWeight: '600', fontSize: '0.85rem',
+      background: type === 'error' ? '#fef2f2' : type === 'warning' ? '#fffbeb' : '#f0fdf4',
+      color: type === 'error' ? '#dc2626' : type === 'warning' ? '#92400e' : '#16a34a',
+      border: `1px solid ${type === 'error' ? '#fecaca' : type === 'warning' ? '#fde68a' : '#bbf7d0'}`,
+      display: 'flex', alignItems: 'center', gap: '0.5rem'
+    }),
+    badge: (color) => ({
+      display: 'inline-flex', alignItems: 'center', padding: '0.15rem 0.55rem', borderRadius: '20px',
+      fontSize: '0.7rem', fontWeight: '800', background: color + '15', color, whiteSpace: 'nowrap'
+    }),
+    stat: (color = '#1a1a2e') => ({
+      background: '#fff', borderRadius: '10px', border: '1px solid #e5e5ec', padding: '0.85rem',
+      textAlign: 'center', flex: '1 1 140px'
+    }),
+    statVal: (color) => ({ fontSize: '1.5rem', fontWeight: '800', color, lineHeight: 1.1 }),
+    statLbl: { fontSize: '0.68rem', fontWeight: '700', color: '#999', textTransform: 'uppercase', letterSpacing: '0.3px', marginTop: '3px' },
+    table: { width: '100%', borderCollapse: 'separate', borderSpacing: 0, fontSize: '0.83rem' },
+    th: { padding: '0.6rem', textAlign: 'left', fontWeight: '800', color: '#666', fontSize: '0.7rem', textTransform: 'uppercase', letterSpacing: '0.5px', borderBottom: '2px solid #e5e5ec', background: '#fafafa' },
+    td: { padding: '0.6rem', borderBottom: '1px solid #f0f0f4', verticalAlign: 'middle' },
+    emptyState: { textAlign: 'center', padding: '2.5rem 1rem', color: '#aaa' },
+    grid2: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.85rem' },
+    stopCard: { display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.65rem 0.75rem', marginBottom: '6px', background: '#fafafa', borderRadius: '10px', border: '1px solid #e8e8ee', cursor: 'grab', transition: 'all 0.1s', userSelect: 'none' }
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // RENDER: Route Planner Tab
+  // ════════════════════════════════════════════════════════════
+  const renderPlanner = () => (
+    <div>
+      {/* Config bar */}
+      <div style={s.card}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.5rem' }}>
+          <div style={s.cardTitle}>⚙️ Route Setup</div>
+          {existingSavedPlan && (
+            <span style={s.badge('#7c3aed')}>
+              Saved plan exists ({existingSavedPlan.status}) · {existingSavedPlan.total_miles} mi
+            </span>
+          )}
+        </div>
+        <div style={s.row}>
+          <div style={s.col(2)}>
+            <label style={s.label}>Caregiver</label>
+            <select style={s.select} value={selectedCaregiver} onChange={e => { setSelectedCaregiver(e.target.value); setOptimizedRoute(null); setRouteStops([]); setExistingSavedPlan(null); }}>
+              <option value="">— Select Caregiver —</option>
+              {caregivers.filter(c => c.is_active !== false).map(c => (
+                <option key={c.id} value={c.id}>
+                  {c.first_name} {c.last_name} {c.latitude ? '📍' : '⚠️'}
+                </option>
+              ))}
+            </select>
+          </div>
+          <div style={s.col(1)}>
+            <label style={s.label}>Date</label>
+            <input type="date" style={s.input} value={selectedDate} onChange={e => { setSelectedDate(e.target.value); setOptimizedRoute(null); }} />
+          </div>
+          <div style={s.col(0.7)}>
+            <label style={s.label}>Start Time</label>
+            <input type="time" style={s.input} value={startTime} onChange={e => setStartTime(e.target.value)} />
+          </div>
+          <div style={s.col(0.6)}>
+            <label style={s.label}>Buffer (min)</label>
+            <input type="number" min="0" max="30" style={s.input} value={bufferMinutes} onChange={e => setBufferMinutes(parseInt(e.target.value) || 0)} />
+          </div>
+          <div style={s.col(0.7)}>
+            <label style={s.label}>$/Mile</label>
+            <input type="number" step="0.01" min="0" style={s.input} value={mileageRate} onChange={e => setMileageRate(parseFloat(e.target.value) || 0)} />
+          </div>
+        </div>
+
+        {/* Caregiver status messages */}
+        {cg && !cg.address && (
+          <div style={s.msg('warning')}>
+            ⚠️ <strong>{cg.first_name} {cg.last_name}</strong> has no home address on file. Go to <strong>Caregivers → Edit</strong> to add their address first, then geocode it here.
+          </div>
+        )}
+        {cg && cg.address && !cgHasCoords && (
+          <div style={s.msg('warning')}>
+            ⚠️ <strong>{cg.first_name} {cg.last_name}</strong> has an address but it's not geocoded yet.
+            <button style={s.btnSm('#d97706')} onClick={() => geocodeSingle('caregiver', cg.id, cg.address, cg.city, cg.state, cg.zip)}>Geocode Now</button>
+          </div>
+        )}
+        {cg && cgHasCoords && (
+          <div style={{ fontSize: '0.8rem', color: '#666', display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>
+            <span>📍 Home: {[cg.address, cg.city, cg.state, cg.zip].filter(Boolean).join(', ') || 'On file'}</span>
+            <button style={s.btn('#2563eb', loadingSchedule)} onClick={loadFromSchedule} disabled={loadingSchedule}>
+              {loadingSchedule ? '⏳ Loading...' : '📅 Load from Schedule'}
+            </button>
+          </div>
+        )}
+      </div>
+
+      <div style={{ ...s.grid2, gridTemplateColumns: optimizedRoute ? '1fr 1fr' : '1fr' }}>
+        {/* ── Left: Client picker + stops ── */}
+        <div>
+          {/* Client search */}
+          <div style={s.card}>
+            <div style={s.cardTitle}>➕ Add Clients</div>
+            <div style={{ position: 'relative' }}>
+              <input type="text" style={s.input} value={clientSearch}
+                onChange={e => setClientSearch(e.target.value)}
+                placeholder="Search by name or address..."
+              />
+              {clientSearch.trim() && filteredClients.length > 0 && (
+                <div style={{ position: 'absolute', top: '100%', left: 0, right: 0, zIndex: 10, background: '#fff', border: '1px solid #ddd', borderRadius: '0 0 8px 8px', maxHeight: '260px', overflowY: 'auto', boxShadow: '0 4px 12px rgba(0,0,0,0.1)' }}>
+                  {filteredClients.map(c => (
+                    <div key={c.id} onClick={() => addStopToRoute(c.id)}
+                      style={{ padding: '0.55rem 0.75rem', cursor: 'pointer', borderBottom: '1px solid #f5f5f5', transition: 'background 0.1s' }}
+                      onMouseOver={e => e.currentTarget.style.background = '#f0f7ff'}
+                      onMouseOut={e => e.currentTarget.style.background = '#fff'}>
+                      <div style={{ fontWeight: '600', fontSize: '0.88rem' }}>
+                        {c.first_name} {c.last_name}
+                        {!c.latitude && <span style={s.badge('#dc2626')}>⚠️ No GPS</span>}
+                      </div>
+                      <div style={{ fontSize: '0.75rem', color: '#888' }}>
+                        {[c.address, c.city].filter(Boolean).join(', ') || 'No address'}
+                        {c.weekly_authorized_units ? ` · ${c.weekly_authorized_units} units/wk` : ''}
+                      </div>
+                    </div>
+                  ))}
+                </div>
+              )}
+              {clientSearch.trim() && filteredClients.length === 0 && (
+                <div style={{ position: 'absolute', top: '100%', left: 0, right: 0, zIndex: 10, background: '#fff', border: '1px solid #ddd', borderRadius: '0 0 8px 8px', padding: '1rem', textAlign: 'center', color: '#999', fontSize: '0.85rem' }}>
+                  No matching clients found
+                </div>
+              )}
+            </div>
+            {!clientSearch.trim() && (
+              <div style={{ fontSize: '0.75rem', color: '#aaa', marginTop: '4px' }}>
+                Type a name or address to search · {clients.filter(c => c.is_active !== false).length - routeStops.length} clients available
+              </div>
+            )}
+          </div>
+
+          {/* Stops list */}
+          <div style={s.card}>
+            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.65rem' }}>
+              <div style={s.cardTitle}>🗺️ Stops ({routeStops.length})</div>
+              <div style={{ fontSize: '0.78rem', fontWeight: '700', color: '#2563eb' }}>
+                {totalUnits} units · {totalHours}h
+              </div>
+            </div>
+
+            {routeStops.length === 0 ? (
+              <div style={s.emptyState}>
+                <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📋</div>
+                <div style={{ fontWeight: '700', marginBottom: '0.25rem' }}>No stops yet</div>
+                <div style={{ fontSize: '0.82rem' }}>Search for clients above, or click <strong>"Load from Schedule"</strong> to auto-fill</div>
+              </div>
+            ) : (
+              <>
+                <div style={{ fontSize: '0.72rem', color: '#aaa', marginBottom: '0.5rem' }}>
+                  Drag to reorder · Click Optimize for shortest route
+                </div>
+                {routeStops.map((stop, idx) => (
+                  <div key={stop.clientId} style={s.stopCard}
+                    draggable onDragStart={() => handleDragStart(idx)}
+                    onDragEnter={() => handleDragEnter(idx)}
+                    onDragEnd={handleDragEnd} onDragOver={e => e.preventDefault()}>
+                    {/* Number */}
+                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', minWidth: '28px' }}>
+                      <div style={{ fontSize: '0.65rem', color: '#ccc', lineHeight: 1 }}>⋮⋮</div>
+                      <div style={{ width: '22px', height: '22px', borderRadius: '50%', background: '#2563eb', color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.7rem', fontWeight: '800' }}>
+                        {idx + 1}
+                      </div>
+                    </div>
+                    {/* Info */}
+                    <div style={{ flex: 1, minWidth: 0 }}>
+                      <div style={{ fontWeight: '700', fontSize: '0.86rem', display: 'flex', alignItems: 'center', gap: '0.3rem' }}>
+                        {stop.clientName}
+                        {!stop.hasCoords && <span style={s.badge('#dc2626')}>No GPS</span>}
+                      </div>
+                      <div style={{ fontSize: '0.73rem', color: '#999', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
+                        {stop.address || 'No address'}
+                      </div>
+                    </div>
+                    {/* Inputs */}
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '6px', flexShrink: 0 }}>
+                      <div style={{ textAlign: 'center' }}>
+                        <div style={{ fontSize: '0.62rem', color: '#aaa', fontWeight: '700' }}>UNITS</div>
+                        <input type="number" min="1" max="96" value={stop.serviceUnits}
+                          style={s.inputSm} onClick={e => e.stopPropagation()}
+                          onChange={e => updateStop(idx, 'serviceUnits', e.target.value)} />
+                      </div>
+                      <div style={{ fontSize: '0.72rem', color: '#666', whiteSpace: 'nowrap' }}>
+                        {(stop.serviceUnits * 0.25).toFixed(2)}h
+                      </div>
+                    </div>
+                    {/* Remove */}
+                    <button onClick={() => removeStop(idx)}
+                      style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '1rem', color: '#dc2626', padding: '2px 4px', borderRadius: '4px' }}>✕</button>
+                  </div>
+                ))}
+
+                {/* Actions */}
+                <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.85rem', flexWrap: 'wrap' }}>
+                  <button style={s.btn('#2563eb', optimizing)} onClick={optimizeRoute} disabled={optimizing}>
+                    {optimizing ? '⏳ Optimizing...' : '🧠 Optimize Route'}
+                  </button>
+                  {optimizedRoute && (
+                    <>
+                      <button style={s.btn('#16a34a', saving)} onClick={() => saveRoute('draft')} disabled={saving}>💾 Save Draft</button>
+                      <button style={s.btn('#7c3aed', saving)} onClick={() => saveRoute('published')} disabled={saving}>📤 Publish</button>
+                      <button style={s.btnGhost('#333')} onClick={printRouteSheet}>🖨️ Print Sheet</button>
+                      {optimizedRoute.googleMapsUrl && (
+                        <a href={optimizedRoute.googleMapsUrl} target="_blank" rel="noopener noreferrer"
+                          style={{ ...s.btnGhost('#ea580c'), textDecoration: 'none', display: 'inline-flex', alignItems: 'center' }}>
+                          📱 Open in Google Maps
+                        </a>
+                      )}
+                    </>
+                  )}
+                  <button style={{ ...s.btnGhost('#dc2626'), marginLeft: 'auto' }}
+                    onClick={() => { setRouteStops([]); setOptimizedRoute(null); setPreOptimizeMiles(null); }}>Clear All</button>
+                </div>
+              </>
+            )}
+          </div>
+        </div>
+
+        {/* ── Right: Optimized results ── */}
+        {optimizedRoute && (
+          <div>
+            {/* Savings banner */}
+            {optimizedRoute.summary.milesSaved > 0 && (
+              <div style={{ padding: '0.65rem 0.85rem', background: 'linear-gradient(135deg, #f0fdf4, #ecfdf5)', borderRadius: '10px', border: '1px solid #bbf7d0', marginBottom: '0.85rem', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1.5rem', flexWrap: 'wrap' }}>
+                <span style={{ fontSize: '0.85rem', fontWeight: '800', color: '#16a34a' }}>
+                  ✅ Optimization saves {optimizedRoute.summary.milesSaved} mi &amp; {optimizedRoute.summary.drivingMinutesSaved} min driving
+                </span>
+                <span style={{ fontSize: '0.78rem', color: '#15803d' }}>
+                  💰 ${(optimizedRoute.summary.milesSaved * mileageRate).toFixed(2)} less in mileage
+                </span>
+              </div>
+            )}
+            {optimizedRoute.summary.milesSaved <= 0 && (
+              <div style={{ padding: '0.65rem 0.85rem', background: '#f8fafc', borderRadius: '10px', border: '1px solid #e2e8f0', marginBottom: '0.85rem', textAlign: 'center' }}>
+                <span style={{ fontSize: '0.85rem', fontWeight: '700', color: '#64748b' }}>
+                  📍 Schedule order is already optimal — no changes needed
+                </span>
+              </div>
+            )}
+
+            {/* Stats */}
+            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.85rem' }}>
+              {[
+                { val: `${optimizedRoute.summary.totalMiles}`, lbl: 'Miles', color: '#2563eb' },
+                { val: `${optimizedRoute.summary.totalStops}`, lbl: 'Stops', color: '#7c3aed' },
+                { val: `${optimizedRoute.summary.totalServiceHours}h`, lbl: 'Service', color: '#16a34a' },
+                { val: `${optimizedRoute.summary.totalDriveMinutes}m`, lbl: 'Driving', color: '#ea580c' },
+                { val: `$${optimizedRoute.summary.mileageReimbursement}`, lbl: 'Mileage $', color: '#0891b2' },
+              ].map((st, i) => (
+                <div key={i} style={s.stat(st.color)}>
+                  <div style={s.statVal(st.color)}>{st.val}</div>
+                  <div style={s.statLbl}>{st.lbl}</div>
+                </div>
+              ))}
+            </div>
+
+            {/* Current Schedule vs Optimized comparison */}
+            {optimizedRoute.preOptimization && optimizedRoute.summary.milesSaved > 0 && (
+              <div style={s.card}>
+                <div style={s.cardTitle}>📅 Current Schedule Order</div>
+                <div style={{ fontSize: '0.78rem', color: '#888', marginBottom: '0.5rem' }}>
+                  {optimizedRoute.preOptimization.totalMiles} mi · {optimizedRoute.preOptimization.totalDriveMinutes}m driving · ${optimizedRoute.preOptimization.mileageReimbursement} mileage
+                </div>
+                {/* Mini stop list */}
+                {optimizedRoute.preOptimization.stops.map((stop, idx) => (
+                  <div key={stop.clientId} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.35rem 0.5rem', borderBottom: '1px solid #f0f0f0', fontSize: '0.8rem' }}>
+                    <div style={{ width: '20px', height: '20px', borderRadius: '50%', background: '#94a3b8', color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.65rem', fontWeight: '800', flexShrink: 0 }}>{idx + 1}</div>
+                    <div style={{ flex: 1, minWidth: 0 }}>
+                      <span style={{ fontWeight: '600' }}>{stop.clientName}</span>
+                    </div>
+                    <div style={{ fontSize: '0.72rem', color: '#999', flexShrink: 0 }}>
+                      {stop.scheduledStartTime && stop.scheduledEndTime
+                        ? <span>{stop.scheduledStartTime} – {stop.scheduledEndTime} <span style={{ color: '#d97706', fontWeight: '600' }}>scheduled</span></span>
+                        : <span>{stop.calculatedArrival} – {stop.calculatedDeparture}</span>
+                      }
+                    </div>
+                    {idx < optimizedRoute.preOptimization.stops.length - 1 && (
+                      <div style={{ fontSize: '0.68rem', color: '#ccc', flexShrink: 0 }}>
+                        → {optimizedRoute.preOptimization.stops[idx + 1]?.milesFromPrevious} mi
+                      </div>
+                    )}
+                  </div>
+                ))}
+                <div style={{ padding: '0.35rem 0.5rem', fontSize: '0.72rem', color: '#999' }}>
+                  🏠 Return: {optimizedRoute.preOptimization.returnMiles} mi · ~{optimizedRoute.preOptimization.returnDriveMinutes}m
+                </div>
+              </div>
+            )}
+
+            {/* Optimized Route detail */}
+            <div style={s.card} ref={printRef}>
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.5rem', marginBottom: '0.75rem' }}>
+                <div style={s.cardTitle}>🧠 Optimized Route</div>
+                <span style={s.badge(optimizedRoute.summary.routingSource === 'google_routes_api' ? '#16a34a' : '#d97706')}>
+                  {optimizedRoute.summary.routingSource === 'google_routes_api' ? '🗺️ Google Road Miles' : '📐 Estimated'}
+                </span>
+              </div>
+              <div style={{ fontSize: '0.78rem', color: '#888', marginBottom: '0.75rem' }}>
+                {optimizedRoute.caregiver.name} · {dayName(selectedDate)} · {optimizedRoute.summary.estimatedStartTime} – ~{optimizedRoute.summary.estimatedEndTime}
+                {bufferMinutes > 0 && ` · ${bufferMinutes}min buffer between stops`}
+              </div>
+
+              {/* Home start */}
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.55rem 0.65rem', background: '#f0fdf4', borderRadius: '8px', marginBottom: '2px' }}>
+                <div style={{ width: '26px', height: '26px', borderRadius: '50%', background: '#16a34a', color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.75rem' }}>🏠</div>
+                <div style={{ flex: 1 }}>
+                  <div style={{ fontWeight: '700', fontSize: '0.82rem', color: '#16a34a' }}>Start: Home</div>
+                  <div style={{ fontSize: '0.72rem', color: '#666' }}>{optimizedRoute.caregiver.homeAddress}</div>
+                </div>
+                <div style={{ fontSize: '0.78rem', fontWeight: '700', color: '#16a34a' }}>{optimizedRoute.summary.estimatedStartTime}</div>
+              </div>
+
+              {/* Stops */}
+              {optimizedRoute.stops.map((stop, idx) => (
+                <React.Fragment key={stop.clientId}>
+                  <div style={{ display: 'flex', alignItems: 'center', paddingLeft: '12px', height: '28px' }}>
+                    <div style={{ width: '2px', height: '100%', background: '#e0e0e0', marginRight: '1.5rem' }} />
+                    <span style={{ fontSize: '0.7rem', color: '#bbb' }}>🚗 {stop.milesFromPrevious} mi · ~{stop.driveMinutesFromPrevious} min</span>
+                  </div>
+                  <div style={{ display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.55rem 0.65rem', background: '#fafafa', borderRadius: '8px', border: '1px solid #eee' }}>
+                    <div style={{ width: '26px', height: '26px', borderRadius: '50%', background: '#2563eb', color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.7rem', fontWeight: '800' }}>{idx + 1}</div>
+                    <div style={{ flex: 1, minWidth: 0 }}>
+                      <div style={{ fontWeight: '700', fontSize: '0.84rem' }}>{stop.clientName}</div>
+                      <div style={{ fontSize: '0.72rem', color: '#888', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{stop.address}</div>
+                    </div>
+                    <div style={{ textAlign: 'right', flexShrink: 0 }}>
+                      <div style={{ fontWeight: '700', fontSize: '0.8rem', color: '#2563eb' }}>{stop.calculatedArrival} – {stop.calculatedDeparture}</div>
+                      <div style={{ fontSize: '0.68rem', color: '#aaa' }}>{stop.serviceUnits}u · {stop.serviceMinutes}min</div>
+                      {stop.scheduledStartTime && stop.scheduledStartTime !== stop.calculatedArrival && (
+                        <div style={{ fontSize: '0.65rem', color: '#d97706' }}>was {stop.scheduledStartTime} – {stop.scheduledEndTime}</div>
+                      )}
+                    </div>
+                  </div>
+                </React.Fragment>
+              ))}
+
+              {/* Return home */}
+              <div style={{ display: 'flex', alignItems: 'center', paddingLeft: '12px', height: '28px' }}>
+                <div style={{ width: '2px', height: '100%', background: '#e0e0e0', marginRight: '1.5rem' }} />
+                <span style={{ fontSize: '0.7rem', color: '#bbb' }}>🚗 {optimizedRoute.summary.returnMiles} mi · ~{optimizedRoute.summary.returnDriveMinutes} min return</span>
+              </div>
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.65rem', padding: '0.55rem 0.65rem', background: '#f0fdf4', borderRadius: '8px' }}>
+                <div style={{ width: '26px', height: '26px', borderRadius: '50%', background: '#16a34a', color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '0.75rem' }}>🏠</div>
+                <div style={{ fontWeight: '700', fontSize: '0.82rem', color: '#16a34a' }}>Return Home</div>
+                <div style={{ marginLeft: 'auto', fontWeight: '700', fontSize: '0.8rem', color: '#16a34a' }}>~{optimizedRoute.summary.estimatedEndTime}</div>
+              </div>
+
+              {/* Mileage summary */}
+              <div style={{ marginTop: '0.75rem', padding: '0.6rem 0.75rem', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '0.78rem', display: 'flex', justifyContent: 'space-between', flexWrap: 'wrap', gap: '0.5rem' }}>
+                <span>💰 Mileage: {optimizedRoute.summary.totalMiles} mi × ${mileageRate}/mi = <strong>${optimizedRoute.summary.mileageReimbursement}</strong></span>
+                {bufferMinutes > 0 && <span>⏱️ Buffer: {optimizedRoute.summary.totalBufferMinutes} min total</span>}
+              </div>
+            </div>
+          </div>
+        )}
+      </div>
+    </div>
+  );
+
+  // ════════════════════════════════════════════════════════════
+  // RENDER: Daily Overview Tab
+  // ════════════════════════════════════════════════════════════
+  const renderDaily = () => (
+    <div>
+      <div style={{ ...s.card, display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>
+        <div style={s.cardTitle}>📅 Daily Overview</div>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', marginLeft: 'auto' }}>
+          <button style={s.btnSm('#888')} onClick={() => { const d = new Date(dailyDate); d.setDate(d.getDate() - 1); setDailyDate(d.toISOString().split('T')[0]); }}>◀</button>
+          <input type="date" style={{ ...s.input, width: 'auto' }} value={dailyDate} onChange={e => setDailyDate(e.target.value)} />
+          <button style={s.btnSm('#888')} onClick={() => { const d = new Date(dailyDate); d.setDate(d.getDate() + 1); setDailyDate(d.toISOString().split('T')[0]); }}>▶</button>
+        </div>
+        <div style={{ fontSize: '0.82rem', color: '#666', fontWeight: '600' }}>{dayName(dailyDate)}</div>
+      </div>
+
+      {dailyLoading ? <div style={s.emptyState}>Loading...</div> : dailyRoutes.length === 0 ? (
+        <div style={{ ...s.card, ...s.emptyState }}>
+          <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>📭</div>
+          <div style={{ fontWeight: '700' }}>No routes for {dayName(dailyDate)}</div>
+        </div>
+      ) : (
+        <>
+          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.85rem' }}>
+            {[
+              { val: dailyRoutes.length, lbl: 'Caregivers', color: '#2563eb' },
+              { val: dailyRoutes.reduce((s, r) => s + r.visits.length, 0), lbl: 'Visits', color: '#7c3aed' },
+              { val: `${dailyRoutes.reduce((s, r) => s + r.totalMiles, 0).toFixed(2)}`, lbl: 'Total Miles', color: '#ea580c' },
+              { val: `${(dailyRoutes.reduce((s, r) => s + r.totalServiceMinutes, 0) / 60).toFixed(2)}h`, lbl: 'Service', color: '#16a34a' },
+              { val: `$${(dailyRoutes.reduce((s, r) => s + r.totalMiles, 0) * mileageRate).toFixed(2)}`, lbl: 'Mileage $', color: '#0891b2' }
+            ].map((st, i) => <div key={i} style={s.stat(st.color)}><div style={s.statVal(st.color)}>{st.val}</div><div style={s.statLbl}>{st.lbl}</div></div>)}
+          </div>
+
+          {dailyRoutes.map(route => (
+            <div key={route.caregiverId} style={s.card}>
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '0.5rem', marginBottom: '0.65rem' }}>
+                <div>
+                  <div style={{ fontWeight: '700', fontSize: '1rem' }}>{route.caregiverName}</div>
+                  <div style={{ fontSize: '0.75rem', color: '#888' }}>{route.visits.length} visits · {route.homeAddress || 'No home address'}</div>
+                </div>
+                <div style={{ display: 'flex', gap: '1rem' }}>
+                  {[
+                    { v: `${route.totalMiles} mi`, c: '#ea580c' },
+                    { v: `${(route.totalServiceMinutes / 60).toFixed(2)}h`, c: '#16a34a' },
+                    { v: `~${route.totalDriveMinutes}m`, c: '#2563eb' }
+                  ].map((m, i) => <div key={i} style={{ textAlign: 'center' }}><div style={{ fontWeight: '800', fontSize: '1.05rem', color: m.c }}>{m.v}</div></div>)}
+                </div>
+              </div>
+              <div style={{ overflowX: 'auto' }}>
+                <table style={s.table}>
+                  <thead><tr>
+                    <th style={s.th}>#</th><th style={s.th}>Client</th><th style={s.th}>Address</th>
+                    <th style={s.th}>Time</th><th style={s.th}>Units</th><th style={s.th}>Miles</th>
+                  </tr></thead>
+                  <tbody>
+                    {route.visits.map((v, idx) => (
+                      <tr key={idx}>
+                        <td style={s.td}><span style={s.badge('#2563eb')}>{idx + 1}</span></td>
+                        <td style={{ ...s.td, fontWeight: '600' }}>{v.clientName}</td>
+                        <td style={{ ...s.td, fontSize: '0.78rem', color: '#888', maxWidth: '180px', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{v.address || '—'}</td>
+                        <td style={s.td}>{v.startTime?.slice(0, 5)} – {v.endTime?.slice(0, 5)}</td>
+                        <td style={s.td}>{v.serviceUnits}</td>
+                        <td style={{ ...s.td, fontWeight: '700', color: '#ea580c' }}>{v.milesFromPrevious}</td>
+                      </tr>
+                    ))}
+                  </tbody>
+                </table>
+              </div>
+            </div>
+          ))}
+        </>
+      )}
+    </div>
+  );
+
+  // ════════════════════════════════════════════════════════════
+  // RENDER: Hours Dashboard Tab
+  // ════════════════════════════════════════════════════════════
+  const renderHours = () => (
+    <div>
+      <div style={{ ...s.card, display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>
+        <div style={s.cardTitle}>⏱️ Hours Dashboard</div>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', marginLeft: 'auto', flexWrap: 'wrap' }}>
+          <input type="date" style={{ ...s.input, width: 'auto' }} value={hoursStartDate} onChange={e => setHoursStartDate(e.target.value)} />
+          <span style={{ color: '#aaa', fontSize: '0.82rem' }}>to</span>
+          <input type="date" style={{ ...s.input, width: 'auto' }} value={hoursEndDate} onChange={e => setHoursEndDate(e.target.value)} />
+          <button style={s.btnSm('#2563eb')} onClick={loadHoursSummary}>↻</button>
+        </div>
+      </div>
+
+      {hoursLoading ? <div style={s.emptyState}>Loading...</div> : hoursData ? (
+        <>
+          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.85rem' }}>
+            {[
+              { val: hoursData.totals.totalCaregivers, lbl: 'Caregivers', color: '#2563eb' },
+              { val: hoursData.totals.totalScheduledHours.toFixed(2), lbl: 'Scheduled', color: '#7c3aed' },
+              { val: hoursData.totals.totalClockedHours.toFixed(2), lbl: 'Clocked', color: '#16a34a' },
+              { val: hoursData.totals.totalMiles.toFixed(0), lbl: 'Miles', color: '#ea580c' },
+              { val: `${hoursData.totals.totalCompletedVisits}/${hoursData.totals.totalScheduledVisits}`, lbl: 'Visits', color: '#0891b2' },
+              { val: hoursData.totals.activeCaregivers, lbl: 'Active Now', color: '#16a34a' }
+            ].map((st, i) => <div key={i} style={s.stat(st.color)}><div style={s.statVal(st.color)}>{st.val}</div><div style={s.statLbl}>{st.lbl}</div></div>)}
+          </div>
+
+          <div style={s.card}>
+            <div style={{ overflowX: 'auto' }}>
+              <table style={s.table}>
+                <thead><tr>
+                  <th style={s.th}>Caregiver</th><th style={s.th}>Scheduled</th><th style={s.th}>Clocked</th>
+                  <th style={s.th}>Remaining</th><th style={s.th}>OT</th>
+                  <th style={{ ...s.th, minWidth: '180px' }}>Utilization</th>
+                  <th style={s.th}>Visits</th><th style={s.th}>Miles</th><th style={s.th}>Status</th>
+                </tr></thead>
+                <tbody>
+                  {hoursData.caregivers.map(cg => {
+                    const pct = Math.min(cg.utilizationPct, 100);
+                    const barColor = pct >= 90 ? '#dc2626' : pct >= 70 ? '#ea580c' : pct >= 40 ? '#2563eb' : '#ccc';
+                    return (
+                      <tr key={cg.id}>
+                        <td style={{ ...s.td, fontWeight: '700' }}>
+                          {cg.name}
+                          {cg.activeShift && <span style={{ ...s.badge('#16a34a'), marginLeft: '0.4rem' }}>🔴 LIVE</span>}
+                        </td>
+                        <td style={{ ...s.td, fontWeight: '700' }}>{cg.scheduledHours}h</td>
+                        <td style={{ ...s.td, fontWeight: '700', color: '#16a34a' }}>{cg.clockedHours}h</td>
+                        <td style={s.td}>{cg.remainingHours}h</td>
+                        <td style={{ ...s.td, color: cg.overtimeHours > 0 ? '#dc2626' : '#ccc', fontWeight: cg.overtimeHours > 0 ? '700' : '400' }}>
+                          {cg.overtimeHours > 0 ? `${cg.overtimeHours}h ⚠️` : '—'}
+                        </td>
+                        <td style={s.td}>
+                          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                            <div style={{ flex: 1, height: '8px', borderRadius: '4px', background: '#eee', overflow: 'hidden' }}>
+                              <div style={{ height: '100%', width: `${pct}%`, background: barColor, borderRadius: '4px', transition: 'width 0.3s' }} />
+                            </div>
+                            <span style={{ fontSize: '0.75rem', fontWeight: '700', color: barColor, minWidth: '32px' }}>{pct}%</span>
+                          </div>
+                        </td>
+                        <td style={s.td}>{cg.completedVisits}/{cg.scheduledVisits}</td>
+                        <td style={{ ...s.td, fontWeight: '600', color: '#ea580c' }}>{cg.totalMiles > 0 ? `${cg.totalMiles} mi` : '—'}</td>
+                        <td style={s.td}>
+                          {cg.activeShift ? (
+                            <span style={{ fontSize: '0.75rem', color: '#16a34a' }}>
+                              w/ {cg.activeShift.client_name}
+                            </span>
+                          ) : cg.clockedHours > 0 ? (
+                            <span style={s.badge('#2563eb')}>Done</span>
+                          ) : (
+                            <span style={{ color: '#ccc', fontSize: '0.78rem' }}>—</span>
+                          )}
+                        </td>
+                      </tr>
+                    );
+                  })}
+                </tbody>
+              </table>
+            </div>
+          </div>
+        </>
+      ) : null}
+    </div>
+  );
+
+  // ════════════════════════════════════════════════════════════
+  // RENDER: Saved Routes Tab
+  // ════════════════════════════════════════════════════════════
+  const renderSaved = () => (
+    <div>
+      <div style={{ ...s.card, display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap' }}>
+        <div style={s.cardTitle}>📁 Saved Routes</div>
+        <div style={{ display: 'flex', gap: '0.4rem', marginLeft: 'auto', flexWrap: 'wrap' }}>
+          <select style={{ ...s.select, width: 'auto' }} value={savedFilter.status} onChange={e => setSavedFilter(p => ({ ...p, status: e.target.value }))}>
+            <option value="">All statuses</option>
+            <option value="draft">Drafts</option>
+            <option value="published">Published</option>
+          </select>
+          <select style={{ ...s.select, width: 'auto' }} value={savedFilter.caregiverId} onChange={e => setSavedFilter(p => ({ ...p, caregiverId: e.target.value }))}>
+            <option value="">All caregivers</option>
+            {caregivers.filter(c => c.is_active !== false).map(c => (
+              <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>
+            ))}
+          </select>
+          <button style={s.btnSm('#2563eb')} onClick={loadSavedRoutes}>↻</button>
+        </div>
+      </div>
+
+      {savedRoutesLoading ? <div style={s.emptyState}>Loading...</div> : savedRoutes.length === 0 ? (
+        <div style={{ ...s.card, ...s.emptyState }}>
+          <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>📁</div>
+          <div style={{ fontWeight: '700' }}>No saved routes found</div>
+          <div style={{ fontSize: '0.82rem' }}>Routes you save from the Route Planner will appear here</div>
+        </div>
+      ) : (
+        <div style={s.card}>
+          <div style={{ overflowX: 'auto' }}>
+            <table style={s.table}>
+              <thead><tr>
+                <th style={s.th}>Date</th><th style={s.th}>Caregiver</th><th style={s.th}>Stops</th>
+                <th style={s.th}>Miles</th><th style={s.th}>Service</th><th style={s.th}>Drive</th>
+                <th style={s.th}>Status</th><th style={s.th}>Actions</th>
+              </tr></thead>
+              <tbody>
+                {savedRoutes.map(r => (
+                  <tr key={r.id}>
+                    <td style={{ ...s.td, fontWeight: '600' }}>{r.route_date}</td>
+                    <td style={{ ...s.td, fontWeight: '600' }}>{r.caregiverName}</td>
+                    <td style={s.td}>{r.stop_count || r.actual_stop_count}</td>
+                    <td style={{ ...s.td, fontWeight: '700', color: '#ea580c' }}>{parseFloat(r.total_miles || 0).toFixed(2)} mi</td>
+                    <td style={s.td}>{r.total_service_minutes ? `${(r.total_service_minutes / 60).toFixed(2)}h` : '—'}</td>
+                    <td style={s.td}>{r.total_drive_minutes ? `${r.total_drive_minutes}m` : '—'}</td>
+                    <td style={s.td}>
+                      <span style={s.badge(r.status === 'published' ? '#16a34a' : '#d97706')}>
+                        {r.status}
+                      </span>
+                    </td>
+                    <td style={s.td}>
+                      <div style={{ display: 'flex', gap: '4px' }}>
+                        <button style={s.btnSm('#2563eb')} onClick={() => loadSavedPlanIntoPlanner(r.id)}>Load</button>
+                        <button style={s.btnSm('#dc2626')} onClick={() => deleteSavedPlan(r.id)}>✕</button>
+                      </div>
+                    </td>
+                  </tr>
+                ))}
+              </tbody>
+            </table>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+
+  // ════════════════════════════════════════════════════════════
+  // RENDER: GPS & Geofence Tab
+  // ════════════════════════════════════════════════════════════
+  const renderGeofence = () => {
+    const clientsWithoutCoords = clients.filter(c => c.is_active !== false && (!c.latitude || !c.longitude));
+    const cgWithoutCoords = caregivers.filter(c => c.is_active !== false && (!c.latitude || !c.longitude));
+    const cgWithoutAddress = caregivers.filter(c => c.is_active !== false && !c.address);
+
+    return (
+      <div>
+        {/* Geocoding */}
+        <div style={s.card}>
+          <div style={s.cardTitle}>🌐 Address Geocoding</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>
+            Convert addresses to GPS coordinates. Required for route optimization and geofencing.
+          </div>
+
+          {cgWithoutAddress.length > 0 && (
+            <div style={s.msg('warning')}>
+              🏠 {cgWithoutAddress.length} caregiver(s) have <strong>no home address</strong> on file — add via Caregivers → Edit before geocoding:
+              <div style={{ fontSize: '0.78rem', marginTop: '4px' }}>
+                {cgWithoutAddress.map(c => c.first_name + ' ' + c.last_name).join(', ')}
+              </div>
+            </div>
+          )}
+
+          {(clientsWithoutCoords.length > 0 || cgWithoutCoords.length > 0) && (
+            <div style={s.msg('warning')}>
+              ⚠️ {clientsWithoutCoords.length} client(s) and {cgWithoutCoords.length} caregiver(s) need geocoding
+            </div>
+          )}
+
+          <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap', marginBottom: '0.75rem' }}>
+            <button style={s.btn('#2563eb', geocoding)} onClick={() => geocodeAll('clients')} disabled={geocoding}>
+              {geocoding ? '⏳ Geocoding...' : `📍 Geocode Clients (${clientsWithoutCoords.length} missing)`}
+            </button>
+            <button style={s.btn('#7c3aed', geocoding)} onClick={() => geocodeAll('caregivers')} disabled={geocoding}>
+              {geocoding ? '⏳ Geocoding...' : `📍 Geocode Caregivers (${cgWithoutCoords.length} missing)`}
+            </button>
+          </div>
+
+          {geocodeResults && (
+            <div style={{ fontSize: '0.82rem', padding: '0.6rem', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
+              ✅ {geocodeResults.success} geocoded · ❌ {geocodeResults.failed} failed · Source: {geocodeResults.source}
+              {geocodeResults.errors?.length > 0 && (
+                <div style={{ marginTop: '0.5rem', color: '#dc2626' }}>
+                  {geocodeResults.errors.slice(0, 5).map((e, i) => (
+                    <div key={i} style={{ fontSize: '0.75rem' }}>• {e.address}: {e.error}</div>
+                  ))}
+                </div>
+              )}
+            </div>
+          )}
+        </div>
+
+        {/* Geofence setup */}
+        <div style={s.card}>
+          <div style={s.cardTitle}>📍 Geofence Configuration</div>
+          <div style={{ fontSize: '0.82rem', color: '#666', marginBottom: '0.75rem' }}>
+            Set up automatic clock-in/out when caregivers arrive at or leave client locations.
+          </div>
+
+          {!editGeofence ? (
+            <div style={s.row}>
+              <div style={s.col(2)}>
+                <label style={s.label}>Select Client</label>
+                <select style={s.select} onChange={e => {
+                  if (!e.target.value) return;
+                  const cl = clients.find(c => c.id === e.target.value);
+                  const existing = geofenceSettings.find(g => g.client_id === e.target.value);
+                  setEditGeofence({
+                    clientId: e.target.value, clientName: cl ? `${cl.first_name} ${cl.last_name}` : '',
+                    radiusFeet: existing?.radius_feet || 300,
+                    autoClockIn: existing?.auto_clock_in ?? true,
+                    autoClockOut: existing?.auto_clock_out ?? true,
+                    requireGps: existing?.require_gps ?? true,
+                    notifyAdminOnOverride: existing?.notify_admin_on_override ?? true
+                  });
+                  e.target.value = '';
+                }}>
+                  <option value="">— Select client to configure —</option>
+                  {clients.filter(c => c.is_active !== false).map(c => (
+                    <option key={c.id} value={c.id}>
+                      {c.first_name} {c.last_name} {c.latitude ? '📍' : '⚠️'}
+                    </option>
+                  ))}
+                </select>
+              </div>
+            </div>
+          ) : (
+            <div style={{ background: '#f8fafc', borderRadius: '10px', padding: '1rem', border: '1px solid #e2e8f0' }}>
+              <div style={{ fontWeight: '700', fontSize: '0.9rem', marginBottom: '0.75rem' }}>
+                ✏️ {editGeofence.clientName || 'Configure Geofence'}
+              </div>
+              <div style={s.row}>
+                <div style={s.col(1)}>
+                  <label style={s.label}>Radius (feet)</label>
+                  <input type="number" min="50" max="1000" style={s.input} value={editGeofence.radiusFeet}
+                    onChange={e => setEditGeofence(p => ({ ...p, radiusFeet: parseInt(e.target.value) || 300 }))} />
+                  <div style={{ fontSize: '0.7rem', color: '#999', marginTop: '2px' }}>200ft = apartment, 300ft = house, 500ft = rural</div>
+                </div>
+                <div style={s.col(2)}>
+                  <label style={s.label}>Options</label>
+                  <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>
+                    {[
+                      { key: 'autoClockIn', label: 'Auto clock-in when entering geofence' },
+                      { key: 'autoClockOut', label: 'Auto clock-out when leaving geofence' },
+                      { key: 'requireGps', label: 'Require GPS (block clock-in without location)' },
+                      { key: 'notifyAdminOnOverride', label: 'Notify admin on manual override' }
+                    ].map(opt => (
+                      <label key={opt.key} style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', cursor: 'pointer', fontSize: '0.83rem' }}>
+                        <input type="checkbox" checked={editGeofence[opt.key]}
+                          onChange={e => setEditGeofence(p => ({ ...p, [opt.key]: e.target.checked }))} />
+                        {opt.label}
+                      </label>
+                    ))}
+                  </div>
+                </div>
+              </div>
+              <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.75rem' }}>
+                <button style={s.btn('#16a34a')} onClick={() => saveGeofence(editGeofence)}>Save</button>
+                <button style={s.btnGhost('#888')} onClick={() => setEditGeofence(null)}>Cancel</button>
+              </div>
+            </div>
+          )}
+        </div>
+
+        {/* Existing settings table */}
+        <div style={s.card}>
+          <div style={s.cardTitle}>📋 Geofence Settings ({geofenceSettings.length})</div>
+          {geofenceLoading ? <div style={s.emptyState}>Loading...</div> : geofenceSettings.length === 0 ? (
+            <div style={s.emptyState}>
+              <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📍</div>
+              <div style={{ fontWeight: '700' }}>No geofences yet</div>
+              <div style={{ fontSize: '0.82rem' }}>Select a client above to set up auto clock-in/out</div>
+            </div>
+          ) : (
+            <div style={{ overflowX: 'auto' }}>
+              <table style={s.table}>
+                <thead><tr>
+                  <th style={s.th}>Client</th><th style={s.th}>Radius</th>
+                  <th style={s.th}>Auto In</th><th style={s.th}>Auto Out</th>
+                  <th style={s.th}>GPS Req</th><th style={s.th}>Actions</th>
+                </tr></thead>
+                <tbody>
+                  {geofenceSettings.map(gs => (
+                    <tr key={gs.id}>
+                      <td style={{ ...s.td, fontWeight: '600' }}>
+                        {gs.first_name} {gs.last_name}
+                        <div style={{ fontSize: '0.72rem', color: '#999' }}>{[gs.address, gs.city].filter(Boolean).join(', ')}</div>
+                      </td>
+                      <td style={{ ...s.td, fontWeight: '700' }}>{gs.radius_feet} ft</td>
+                      <td style={s.td}>{gs.auto_clock_in ? '✅' : '❌'}</td>
+                      <td style={s.td}>{gs.auto_clock_out ? '✅' : '❌'}</td>
+                      <td style={s.td}>{gs.require_gps ? '✅' : '❌'}</td>
+                      <td style={s.td}>
+                        <button style={s.btnSm('#2563eb')} onClick={() => setEditGeofence({
+                          clientId: gs.client_id, clientName: `${gs.first_name} ${gs.last_name}`,
+                          radiusFeet: gs.radius_feet, autoClockIn: gs.auto_clock_in,
+                          autoClockOut: gs.auto_clock_out, requireGps: gs.require_gps,
+                          notifyAdminOnOverride: gs.notify_admin_on_override
+                        })}>Edit</button>
+                      </td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            </div>
+          )}
+        </div>
+      </div>
+    );
+  };
+
+  // ════════════════════════════════════════════════════════════
+  // Main Render
+  // ════════════════════════════════════════════════════════════
+  if (loading) return <div style={{ ...s.page, textAlign: 'center', padding: '3rem', color: '#aaa' }}>Loading route optimizer...</div>;
+
+  return (
+    <div style={s.page}>
+      {/* Header */}
+      <div style={s.header}>
+        <h1 style={s.title}>🗺️ Route & Schedule Optimizer</h1>
+        {apiStatus && (
+          <div style={{
+            display: 'flex', alignItems: 'center', gap: '0.4rem', padding: '0.35rem 0.7rem',
+            borderRadius: '8px', fontSize: '0.75rem', fontWeight: '700',
+            background: apiStatus.googleApiKeyConfigured ? '#f0fdf4' : '#fffbeb',
+            color: apiStatus.googleApiKeyConfigured ? '#16a34a' : '#92400e',
+            border: `1px solid ${apiStatus.googleApiKeyConfigured ? '#bbf7d0' : '#fde68a'}`
+          }}>
+            {apiStatus.googleApiKeyConfigured ? '🟢 Google Routes API' : '🟡 Haversine Estimates'}
+          </div>
+        )}
+      </div>
+
+      {/* Message */}
+      {message.text && <div style={s.msg(message.type)}>{message.text}</div>}
+
+      {/* Tabs */}
+      <div style={s.tabs}>
+        {[
+          { id: 'planner', icon: '🧭', label: 'Route Planner' },
+          { id: 'daily', icon: '📅', label: 'Daily Overview' },
+          { id: 'hours', icon: '⏱️', label: 'Hours' },
+          { id: 'saved', icon: '📁', label: 'Saved Routes' },
+          { id: 'geofence', icon: '📍', label: 'GPS & Geofence' },
+        ].map(t => (
+          <button key={t.id} style={s.tab(activeTab === t.id)} onClick={() => setActiveTab(t.id)}>
+            {t.icon} {t.label}
+          </button>
+        ))}
+      </div>
+
+      {/* Content */}
+      {activeTab === 'planner' && renderPlanner()}
+      {activeTab === 'daily' && renderDaily()}
+      {activeTab === 'hours' && renderHours()}
+      {activeTab === 'saved' && renderSaved()}
+      {activeTab === 'geofence' && renderGeofence()}
+    </div>
+  );
+};
+
+export default RouteOptimizer;
diff --git a/templates/crm-homecare/frontend/src/components/admin/SMSManagement.jsx b/templates/crm-homecare/frontend/src/components/admin/SMSManagement.jsx
new file mode 100644
index 0000000..24e53cc
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/SMSManagement.jsx
@@ -0,0 +1,666 @@
+import { confirm } from '../ConfirmModal';
+import { toast } from '../Toast';
+// src/components/admin/SMSManagement.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const SMSManagement = ({ token }) => {
+  const [messages, setMessages] = useState([]);
+  const [templates, setTemplates] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [activeTab, setActiveTab] = useState('messages');
+  const [filter, setFilter] = useState({ direction: '', status: '' });
+  const [showSendModal, setShowSendModal] = useState(false);
+  const [showTemplateModal, setShowTemplateModal] = useState(false);
+  const [editingTemplate, setEditingTemplate] = useState(null);
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients] = useState([]);
+
+  useEffect(() => {
+    loadMessages();
+    loadTemplates();
+    loadCaregivers();
+    loadClients();
+  }, [filter]);
+
+  const loadMessages = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.direction) params.append('direction', filter.direction);
+      if (filter.status) params.append('status', filter.status);
+      
+      const res = await fetch(`${API_BASE_URL}/api/sms/messages?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setMessages(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load messages:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadTemplates = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/sms/templates`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setTemplates(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load templates:', error);
+    }
+  };
+
+  const loadCaregivers = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregivers`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setCaregivers(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load caregivers:', error);
+    }
+  };
+
+  const loadClients = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/clients`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setClients(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load clients:', error);
+    }
+  };
+
+  const sendMessage = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/sms/send`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        const result = await res.json();
+        toast(`Message sent successfully! SID: ${result.sid}`);
+        setShowSendModal(false);
+        loadMessages();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed to send: ' + error.message, 'error');
+    }
+  };
+
+  const sendBulk = async (formData) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/sms/send-bulk`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        const result = await res.json();
+        toast(`Sent ${result.sent} messages successfully!`);
+        setShowSendModal(false);
+        loadMessages();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed to send: ' + error.message, 'error');
+    }
+  };
+
+  const saveTemplate = async (formData) => {
+    try {
+      const url = editingTemplate 
+        ? `${API_BASE_URL}/api/sms/templates/${editingTemplate.id}`
+        : `${API_BASE_URL}/api/sms/templates`;
+      
+      const res = await fetch(url, {
+        method: editingTemplate ? 'PUT' : 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify(formData)
+      });
+      if (res.ok) {
+        setShowTemplateModal(false);
+        setEditingTemplate(null);
+        loadTemplates();
+      } else {
+        const err = await res.json();
+        toast('Failed: ' + err.error, 'error');
+      }
+    } catch (error) {
+      toast('Failed to save: ' + error.message, 'error');
+    }
+  };
+
+  const deleteTemplate = async (templateId) => {
+    const _cok = await confirm('Delete this template?', {danger: true}); if (!_cok) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/sms/templates/${templateId}`, {
+        method: 'DELETE',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadTemplates();
+      }
+    } catch (error) {
+      toast('Failed: ' + error.message, 'error');
+    }
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      queued: '#9e9e9e',
+      sending: '#2196f3',
+      sent: '#4caf50',
+      delivered: '#4caf50',
+      failed: '#f44336',
+      undelivered: '#ff9800',
+      received: '#8bc34a'
+    };
+    return (
+      <span style={{
+        padding: '2px 6px',
+        borderRadius: '4px',
+        fontSize: '0.7rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const getDirectionIcon = (direction) => {
+    return direction === 'outbound' ? '📤' : '📥';
+  };
+
+  const sentCount = messages.filter(m => m.direction === 'outbound').length;
+  const receivedCount = messages.filter(m => m.direction === 'inbound').length;
+  const failedCount = messages.filter(m => m.status === 'failed' || m.status === 'undelivered').length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>📱 SMS Management</h2>
+        <button className="btn btn-primary" onClick={() => setShowSendModal(true)}>
+          + Send Message
+        </button>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, direction: '' })} style={{ cursor: 'pointer' }}>
+          <h4>Total</h4>
+          <div className="value">{messages.length}</div>
+        </div>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, direction: 'outbound' })} style={{ cursor: 'pointer' }}>
+          <h4>Sent</h4>
+          <div className="value" style={{ color: '#2196f3' }}>{sentCount}</div>
+        </div>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, direction: 'inbound' })} style={{ cursor: 'pointer' }}>
+          <h4>Received</h4>
+          <div className="value" style={{ color: '#4caf50' }}>{receivedCount}</div>
+        </div>
+        <div className="stat-card" onClick={() => setFilter({ ...filter, status: 'failed' })} style={{ cursor: 'pointer' }}>
+          <h4>Failed</h4>
+          <div className="value" style={{ color: '#f44336' }}>{failedCount}</div>
+        </div>
+      </div>
+
+      {/* Tabs */}
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+        <button 
+          className={`btn ${activeTab === 'messages' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setActiveTab('messages')}
+        >
+          Messages ({messages.length})
+        </button>
+        <button 
+          className={`btn ${activeTab === 'templates' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setActiveTab('templates')}
+        >
+          Templates ({templates.length})
+        </button>
+        {activeTab === 'templates' && (
+          <button 
+            className="btn btn-primary" 
+            style={{ marginLeft: 'auto' }}
+            onClick={() => { setEditingTemplate(null); setShowTemplateModal(true); }}
+          >
+            + New Template
+          </button>
+        )}
+      </div>
+
+      {/* Messages Tab */}
+      {activeTab === 'messages' && (
+        <>
+          {/* Filters */}
+          <div className="card" style={{ marginBottom: '1rem' }}>
+            <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap' }}>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>Direction</label>
+                <select value={filter.direction} onChange={(e) => setFilter({ ...filter, direction: e.target.value })}>
+                  <option value="">All</option>
+                  <option value="outbound">Sent</option>
+                  <option value="inbound">Received</option>
+                </select>
+              </div>
+              <div className="form-group" style={{ margin: 0 }}>
+                <label>Status</label>
+                <select value={filter.status} onChange={(e) => setFilter({ ...filter, status: e.target.value })}>
+                  <option value="">All</option>
+                  <option value="sent">Sent</option>
+                  <option value="delivered">Delivered</option>
+                  <option value="failed">Failed</option>
+                  <option value="received">Received</option>
+                </select>
+              </div>
+            </div>
+          </div>
+
+          {/* Messages Table */}
+          <div className="card">
+            {loading ? (
+              <div className="loading"><div className="spinner"></div></div>
+            ) : messages.length === 0 ? (
+              <p>No messages found.</p>
+            ) : (
+              <table className="table">
+                <thead>
+                  <tr>
+                    <th style={{ width: '40px' }}></th>
+                    <th>To/From</th>
+                    <th>Message</th>
+                    <th>Status</th>
+                    <th>Date</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {messages.map(msg => (
+                    <tr key={msg.id}>
+                      <td style={{ fontSize: '1.3rem' }}>{getDirectionIcon(msg.direction)}</td>
+                      <td>
+                        <strong>{msg.direction === 'outbound' ? msg.to_number : msg.from_number}</strong>
+                        {msg.recipient_name && (
+                          <div style={{ fontSize: '0.8rem', color: '#666' }}>{msg.recipient_name}</div>
+                        )}
+                      </td>
+                      <td style={{ maxWidth: '400px' }}>
+                        <div style={{ 
+                          overflow: 'hidden', 
+                          textOverflow: 'ellipsis',
+                          whiteSpace: 'nowrap'
+                        }}>
+                          {msg.body}
+                        </div>
+                      </td>
+                      <td>{getStatusBadge(msg.status)}</td>
+                      <td style={{ fontSize: '0.85rem' }}>
+                        {new Date(msg.created_at).toLocaleString()}
+                      </td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            )}
+          </div>
+        </>
+      )}
+
+      {/* Templates Tab */}
+      {activeTab === 'templates' && (
+        <div className="card">
+          {templates.length === 0 ? (
+            <p>No templates found. Create templates to quickly send common messages.</p>
+          ) : (
+            <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))', gap: '1rem' }}>
+              {templates.map(template => (
+                <div key={template.id} style={{ 
+                  border: '1px solid #ddd', 
+                  borderRadius: '8px', 
+                  padding: '1rem',
+                  backgroundColor: '#fafafa'
+                }}>
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                    <strong>{template.name}</strong>
+                    <div style={{ display: 'flex', gap: '0.25rem' }}>
+                      <button 
+                        className="btn btn-sm btn-secondary"
+                        onClick={() => { setEditingTemplate(template); setShowTemplateModal(true); }}
+                      >
+                        ✏️
+                      </button>
+                      <button 
+                        className="btn btn-sm btn-danger"
+                        onClick={() => deleteTemplate(template.id)}
+                      >
+                        🗑️
+                      </button>
+                    </div>
+                  </div>
+                  <div style={{ 
+                    marginTop: '0.5rem', 
+                    padding: '0.5rem',
+                    backgroundColor: '#fff',
+                    borderRadius: '4px',
+                    fontSize: '0.9rem',
+                    color: '#333'
+                  }}>
+                    {template.body}
+                  </div>
+                  <div style={{ marginTop: '0.5rem', fontSize: '0.8rem', color: '#666' }}>
+                    <strong>Category:</strong> {template.category || 'General'}
+                  </div>
+                  {template.variables && (
+                    <div style={{ marginTop: '0.25rem', fontSize: '0.75rem', color: '#999' }}>
+                      Variables: {template.variables}
+                    </div>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+
+      {/* Send Message Modal */}
+      {showSendModal && (
+        <div className="modal-overlay" onClick={() => setShowSendModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
+            <div className="modal-header">
+              <h3>Send SMS</h3>
+              <button className="modal-close" onClick={() => setShowSendModal(false)}>×</button>
+            </div>
+            <SendMessageForm 
+              templates={templates}
+              caregivers={caregivers}
+              clients={clients}
+              onSend={sendMessage}
+              onSendBulk={sendBulk}
+              onCancel={() => setShowSendModal(false)}
+            />
+          </div>
+        </div>
+      )}
+
+      {/* Template Modal */}
+      {showTemplateModal && (
+        <div className="modal-overlay" onClick={() => setShowTemplateModal(false)}>
+          <div className="modal" onClick={(e) => e.stopPropagation()}>
+            <div className="modal-header">
+              <h3>{editingTemplate ? 'Edit Template' : 'New Template'}</h3>
+              <button className="modal-close" onClick={() => setShowTemplateModal(false)}>×</button>
+            </div>
+            <TemplateForm 
+              template={editingTemplate}
+              onSubmit={saveTemplate}
+              onCancel={() => setShowTemplateModal(false)}
+            />
+          </div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+// Send Message Form Component
+const SendMessageForm = ({ templates, caregivers, clients, onSend, onSendBulk, onCancel }) => {
+  const [mode, setMode] = useState('single'); // single or bulk
+  const [formData, setFormData] = useState({
+    to: '',
+    body: '',
+    recipientType: 'caregiver',
+    recipientIds: []
+  });
+  const [selectedTemplate, setSelectedTemplate] = useState('');
+
+  const handleTemplateSelect = (templateId) => {
+    setSelectedTemplate(templateId);
+    const template = templates.find(t => t.id === parseInt(templateId));
+    if (template) {
+      setFormData({ ...formData, body: template.body });
+    }
+  };
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (mode === 'single') {
+      if (!formData.to || !formData.body) {
+        toast('Phone number and message are required');
+        return;
+      }
+      onSend({ to: formData.to, body: formData.body });
+    } else {
+      if (formData.recipientIds.length === 0 || !formData.body) {
+        toast('Select recipients and enter a message');
+        return;
+      }
+      onSendBulk({ 
+        recipientType: formData.recipientType,
+        recipientIds: formData.recipientIds,
+        body: formData.body 
+      });
+    }
+  };
+
+  const recipients = formData.recipientType === 'caregiver' ? caregivers : clients;
+
+  const toggleRecipient = (id) => {
+    setFormData(prev => ({
+      ...prev,
+      recipientIds: prev.recipientIds.includes(id)
+        ? prev.recipientIds.filter(r => r !== id)
+        : [...prev.recipientIds, id]
+    }));
+  };
+
+  const selectAll = () => {
+    setFormData({ ...formData, recipientIds: recipients.map(r => r.id) });
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      {/* Mode Toggle */}
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+        <button 
+          type="button"
+          className={`btn ${mode === 'single' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setMode('single')}
+        >
+          Single Message
+        </button>
+        <button 
+          type="button"
+          className={`btn ${mode === 'bulk' ? 'btn-primary' : 'btn-secondary'}`}
+          onClick={() => setMode('bulk')}
+        >
+          Bulk Message
+        </button>
+      </div>
+
+      {mode === 'single' ? (
+        <div className="form-group">
+          <label>Phone Number *</label>
+          <input 
+            type="tel"
+            value={formData.to}
+            onChange={(e) => setFormData({ ...formData, to: e.target.value })}
+            placeholder="+1234567890"
+            required
+          />
+        </div>
+      ) : (
+        <>
+          <div className="form-group">
+            <label>Recipient Type</label>
+            <select 
+              value={formData.recipientType}
+              onChange={(e) => setFormData({ ...formData, recipientType: e.target.value, recipientIds: [] })}
+            >
+              <option value="caregiver">Caregivers</option>
+              <option value="client">Clients</option>
+            </select>
+          </div>
+          <div className="form-group">
+            <label>
+              Recipients ({formData.recipientIds.length} selected)
+              <button type="button" className="btn btn-sm btn-secondary" style={{ marginLeft: '0.5rem' }} onClick={selectAll}>
+                Select All
+              </button>
+            </label>
+            <div style={{ 
+              maxHeight: '150px', 
+              overflowY: 'auto', 
+              border: '1px solid #ddd', 
+              borderRadius: '4px',
+              padding: '0.5rem'
+            }}>
+              {recipients.map(r => (
+                <label key={r.id} style={{ display: 'block', padding: '0.25rem', cursor: 'pointer' }}>
+                  <input 
+                    type="checkbox"
+                    checked={formData.recipientIds.includes(r.id)}
+                    onChange={() => toggleRecipient(r.id)}
+                    style={{ marginRight: '0.5rem' }}
+                  />
+                  {r.first_name} {r.last_name} {r.phone ? `(${r.phone})` : '(no phone)'}
+                </label>
+              ))}
+            </div>
+          </div>
+        </>
+      )}
+
+      <div className="form-group">
+        <label>Template (Optional)</label>
+        <select value={selectedTemplate} onChange={(e) => handleTemplateSelect(e.target.value)}>
+          <option value="">-- Select Template --</option>
+          {templates.map(t => (
+            <option key={t.id} value={t.id}>{t.name}</option>
+          ))}
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>Message *</label>
+        <textarea 
+          value={formData.body}
+          onChange={(e) => setFormData({ ...formData, body: e.target.value })}
+          placeholder="Type your message..."
+          rows={4}
+          required
+        />
+        <small style={{ color: '#666' }}>{formData.body.length} characters</small>
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">
+          {mode === 'single' ? 'Send Message' : `Send to ${formData.recipientIds.length} Recipients`}
+        </button>
+      </div>
+    </form>
+  );
+};
+
+// Template Form Component
+const TemplateForm = ({ template, onSubmit, onCancel }) => {
+  const [formData, setFormData] = useState({
+    name: template?.name || '',
+    body: template?.body || '',
+    category: template?.category || 'general',
+    variables: template?.variables || ''
+  });
+
+  const handleSubmit = (e) => {
+    e.preventDefault();
+    if (!formData.name || !formData.body) {
+      toast('Name and message body are required');
+      return;
+    }
+    onSubmit(formData);
+  };
+
+  const insertVariable = (variable) => {
+    setFormData({ ...formData, body: formData.body + `{{${variable}}}` });
+  };
+
+  return (
+    <form onSubmit={handleSubmit}>
+      <div className="form-group">
+        <label>Template Name *</label>
+        <input 
+          type="text"
+          value={formData.name}
+          onChange={(e) => setFormData({ ...formData, name: e.target.value })}
+          placeholder="e.g., Shift Reminder"
+          required
+        />
+      </div>
+
+      <div className="form-group">
+        <label>Category</label>
+        <select 
+          value={formData.category}
+          onChange={(e) => setFormData({ ...formData, category: e.target.value })}
+        >
+          <option value="general">General</option>
+          <option value="scheduling">Scheduling</option>
+          <option value="reminder">Reminder</option>
+          <option value="emergency">Emergency</option>
+          <option value="payroll">Payroll</option>
+        </select>
+      </div>
+
+      <div className="form-group">
+        <label>
+          Message Body *
+          <span style={{ marginLeft: '1rem', fontSize: '0.8rem' }}>
+            Insert: 
+            <button type="button" className="btn btn-sm btn-secondary" style={{ marginLeft: '0.25rem' }} onClick={() => insertVariable('first_name')}>First Name</button>
+            <button type="button" className="btn btn-sm btn-secondary" style={{ marginLeft: '0.25rem' }} onClick={() => insertVariable('last_name')}>Last Name</button>
+            <button type="button" className="btn btn-sm btn-secondary" style={{ marginLeft: '0.25rem' }} onClick={() => insertVariable('date')}>Date</button>
+            <button type="button" className="btn btn-sm btn-secondary" style={{ marginLeft: '0.25rem' }} onClick={() => insertVariable('time')}>Time</button>
+          </span>
+        </label>
+        <textarea 
+          value={formData.body}
+          onChange={(e) => setFormData({ ...formData, body: e.target.value })}
+          placeholder="Hi {{first_name}}, your shift is scheduled for {{date}} at {{time}}."
+          rows={4}
+          required
+        />
+        <small style={{ color: '#666' }}>{formData.body.length} characters</small>
+      </div>
+
+      <div className="modal-actions">
+        <button type="button" className="btn btn-secondary" onClick={onCancel}>Cancel</button>
+        <button type="submit" className="btn btn-primary">Save Template</button>
+      </div>
+    </form>
+  );
+};
+
+export default SMSManagement;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ScheduleCalendar.jsx b/templates/crm-homecare/frontend/src/components/admin/ScheduleCalendar.jsx
new file mode 100644
index 0000000..886ea67
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ScheduleCalendar.jsx
@@ -0,0 +1,587 @@
+// src/components/admin/ScheduleCalendar.jsx
+// Professional scheduling calendar modeled after When I Work / Deputy
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ScheduleCalendar = ({ token }) => {
+  const [currentDate, setCurrentDate] = useState(new Date());
+  const [viewMode, setViewMode] = useState('month'); // 'month' or 'week'
+  const [schedules, setSchedules] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [caregivers, setCaregivers] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [selectedDay, setSelectedDay] = useState(null);
+  const [daySchedules, setDaySchedules] = useState([]);
+  const [filterCaregiver, setFilterCaregiver] = useState('');
+  const [isMobile, setIsMobile] = useState(window.innerWidth <= 640);
+
+  useEffect(() => {
+    loadData();
+    const handleResize = () => setIsMobile(window.innerWidth <= 640);
+    window.addEventListener('resize', handleResize);
+    return () => window.removeEventListener('resize', handleResize);
+  }, []);
+
+  const loadData = async () => {
+    try {
+      const [schedulesRes, clientsRes, caregiversRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/schedules-all`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/users/caregivers`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        })
+      ]);
+
+      if (schedulesRes.ok) {
+        const schedulesData = await schedulesRes.json();
+        setSchedules(Array.isArray(schedulesData) ? schedulesData : []);
+      }
+      if (clientsRes.ok) {
+        const clientsData = await clientsRes.json();
+        setClients(Array.isArray(clientsData) ? clientsData : []);
+      }
+      if (caregiversRes.ok) {
+        const caregiversData = await caregiversRes.json();
+        setCaregivers(Array.isArray(caregiversData) ? caregiversData : []);
+      }
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // Helper functions
+  const getDaysInMonth = (date) => new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
+  const getFirstDayOfMonth = (date) => new Date(date.getFullYear(), date.getMonth(), 1).getDay();
+
+  const formatTime = (timeStr) => {
+    if (!timeStr) return '';
+    const [hours, minutes] = timeStr.split(':');
+    const h = parseInt(hours);
+    const ampm = h >= 12 ? 'pm' : 'am';
+    const hour12 = h % 12 || 12;
+    return `${hour12}:${minutes}${ampm}`;
+  };
+
+  const getCaregiverName = (id) => {
+    if (!id) return 'Unassigned';
+    const cg = caregivers.find(c => c.id === id);
+    return cg ? `${cg.first_name} ${cg.last_name}` : 'Unknown';
+  };
+
+  const getCaregiverInitials = (id) => {
+    if (!id) return '?';
+    const cg = caregivers.find(c => c.id === id);
+    return cg ? `${cg.first_name?.[0] || ''}${cg.last_name?.[0] || ''}` : '?';
+  };
+
+  const getClientName = (id) => {
+    if (!id) return 'No Client';
+    const cl = clients.find(c => c.id === id);
+    return cl ? `${cl.first_name} ${cl.last_name}` : 'Unknown Client';
+  };
+
+  // Get color for caregiver (consistent color per person)
+  const getCaregiverColor = (id) => {
+    const colors = [
+      '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6',
+      '#EC4899', '#06B6D4', '#84CC16', '#F97316', '#6366F1'
+    ];
+    if (!id) return '#9CA3AF';
+    const index = caregivers.findIndex(c => c.id === id);
+    return colors[index % colors.length];
+  };
+
+  // Get schedules for a specific day - FIXED logic
+  const getSchedulesForDay = (day) => {
+    const targetDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
+    const targetDayOfWeek = targetDate.getDay();
+    
+    // Format date for comparison (YYYY-MM-DD)
+    const year = targetDate.getFullYear();
+    const month = String(targetDate.getMonth() + 1).padStart(2, '0');
+    const dayStr = String(day).padStart(2, '0');
+    const dateStr = `${year}-${month}-${dayStr}`;
+
+    let filtered = schedules.filter(schedule => {
+      // Check one-time schedules (specific date)
+      if (schedule.date) {
+        const scheduleDate = schedule.date.split('T')[0]; // Handle ISO format
+        return scheduleDate === dateStr;
+      }
+      // Check recurring schedules (day of week)
+      if (schedule.day_of_week !== null && schedule.day_of_week !== undefined) {
+        return schedule.day_of_week === targetDayOfWeek;
+      }
+      return false;
+    });
+
+    // Apply caregiver filter if set
+    if (filterCaregiver) {
+      filtered = filtered.filter(s => s.caregiver_id === filterCaregiver);
+    }
+
+    // Sort by start time
+    return filtered.sort((a, b) => (a.start_time || '').localeCompare(b.start_time || ''));
+  };
+
+  const handleDayClick = (day) => {
+    const dayScheds = getSchedulesForDay(day);
+    setDaySchedules(dayScheds);
+    setSelectedDay(day);
+  };
+
+  // Navigation
+  const previousMonth = () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1));
+  const nextMonth = () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1));
+  const goToToday = () => setCurrentDate(new Date());
+
+  // Calculate stats
+  const getTotalSchedulesToday = () => {
+    const today = new Date();
+    if (currentDate.getMonth() === today.getMonth() && currentDate.getFullYear() === today.getFullYear()) {
+      return getSchedulesForDay(today.getDate()).length;
+    }
+    return 0;
+  };
+
+  const getTotalSchedulesThisMonth = () => {
+    let total = 0;
+    const daysInMonth = getDaysInMonth(currentDate);
+    for (let day = 1; day <= daysInMonth; day++) {
+      total += getSchedulesForDay(day).length;
+    }
+    return total;
+  };
+
+  // Build calendar grid
+  const monthName = currentDate.toLocaleString('default', { month: 'long', year: 'numeric' });
+  const daysInMonth = getDaysInMonth(currentDate);
+  const firstDay = getFirstDayOfMonth(currentDate);
+  const days = [];
+
+  for (let i = 0; i < firstDay; i++) days.push(null);
+  for (let day = 1; day <= daysInMonth; day++) days.push(day);
+
+  const today = new Date();
+  const isToday = (day) => 
+    day === today.getDate() && 
+    currentDate.getMonth() === today.getMonth() && 
+    currentDate.getFullYear() === today.getFullYear();
+
+  if (loading) {
+    return (
+      <div className="loading">
+        <div className="spinner"></div>
+      </div>
+    );
+  }
+
+  return (
+    <div className="schedule-calendar">
+      {/* Header */}
+      <div className="page-header" style={{ marginBottom: '1.5rem' }}>
+        <div>
+          <h2 style={{ margin: 0 }}>📅 Schedule Calendar</h2>
+          <p style={{ margin: '0.25rem 0 0 0', color: '#666', fontSize: '0.9rem' }}>
+            {getTotalSchedulesThisMonth()} shifts this month • {getTotalSchedulesToday()} today
+          </p>
+        </div>
+      </div>
+
+      {/* Controls Bar */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div style={{ 
+          display: 'flex', 
+          flexWrap: 'wrap',
+          gap: '1rem', 
+          alignItems: 'center',
+          justifyContent: 'space-between'
+        }}>
+          {/* Navigation */}
+          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+            <button className="btn btn-secondary btn-sm" onClick={previousMonth}>‹</button>
+            <button className="btn btn-secondary btn-sm" onClick={goToToday}>Today</button>
+            <button className="btn btn-secondary btn-sm" onClick={nextMonth}>›</button>
+            <h3 style={{ margin: '0 0.5rem', fontSize: '1.1rem', minWidth: '150px' }}>{monthName}</h3>
+          </div>
+
+          {/* Filters */}
+          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center', flexWrap: 'wrap' }}>
+            <select
+              value={filterCaregiver}
+              onChange={(e) => setFilterCaregiver(e.target.value)}
+              style={{ padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd', fontSize: '0.9rem' }}
+            >
+              <option value="">All Caregivers</option>
+              {caregivers.map(cg => (
+                <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>
+              ))}
+            </select>
+          </div>
+        </div>
+      </div>
+
+      {/* Calendar Grid */}
+      <div className="card" style={{ padding: 0, overflow: 'visible' }}>
+        {/* Day Headers */}
+        <div style={{ 
+          display: 'grid', 
+          gridTemplateColumns: 'repeat(7, 1fr)',
+          background: '#f8f9fa',
+          borderBottom: '1px solid #e5e7eb'
+        }}>
+          {(isMobile ? ['S', 'M', 'T', 'W', 'T', 'F', 'S'] : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']).map((day, idx) => (
+            <div key={idx} style={{ 
+              padding: isMobile ? '0.5rem 0.25rem' : '0.75rem 0.5rem', 
+              textAlign: 'center', 
+              fontWeight: '600',
+              fontSize: isMobile ? '0.75rem' : '0.85rem',
+              color: '#374151'
+            }}>
+              {day}
+            </div>
+          ))}
+        </div>
+
+        {/* Calendar Cells */}
+        <div style={{ 
+          display: 'grid', 
+          gridTemplateColumns: 'repeat(7, 1fr)',
+          minHeight: isMobile ? '300px' : '500px'
+        }}>
+          {days.map((day, idx) => {
+            if (day === null) {
+              return (
+                <div key={`empty-${idx}`} style={{ 
+                  background: '#f9fafb',
+                  borderRight: '1px solid #e5e7eb',
+                  borderBottom: '1px solid #e5e7eb'
+                }} />
+              );
+            }
+
+            const dayScheds = getSchedulesForDay(day);
+            const hasSchedules = dayScheds.length > 0;
+
+            return (
+              <div
+                key={day}
+                onClick={() => handleDayClick(day)}
+                style={{ 
+                  minHeight: isMobile ? '60px' : '100px',
+                  padding: isMobile ? '0.25rem' : '0.5rem',
+                  borderRight: '1px solid #e5e7eb',
+                  borderBottom: '1px solid #e5e7eb',
+                  cursor: 'pointer',
+                  background: isToday(day) ? '#EFF6FF' : '#fff',
+                  transition: 'background 0.15s'
+                }}
+                onMouseEnter={(e) => !isMobile && (e.currentTarget.style.background = isToday(day) ? '#DBEAFE' : '#f3f4f6')}
+                onMouseLeave={(e) => !isMobile && (e.currentTarget.style.background = isToday(day) ? '#EFF6FF' : '#fff')}
+              >
+                {/* Day Number */}
+                <div style={{ 
+                  display: 'flex', 
+                  justifyContent: 'space-between', 
+                  alignItems: 'center',
+                  marginBottom: isMobile ? '0.125rem' : '0.25rem'
+                }}>
+                  <span style={{ 
+                    fontWeight: isToday(day) ? '700' : '500',
+                    fontSize: isMobile ? '0.75rem' : '0.9rem',
+                    color: isToday(day) ? '#2563EB' : '#374151',
+                    width: isMobile ? '20px' : '24px',
+                    height: isMobile ? '20px' : '24px',
+                    display: 'flex',
+                    alignItems: 'center',
+                    justifyContent: 'center',
+                    borderRadius: '50%',
+                    background: isToday(day) ? '#2563EB' : 'transparent',
+                    ...(isToday(day) && { color: '#fff' })
+                  }}>
+                    {day}
+                  </span>
+                  {hasSchedules && !isMobile && (
+                    <span style={{ 
+                      fontSize: '0.7rem', 
+                      color: '#6B7280',
+                      background: '#E5E7EB',
+                      padding: '0.125rem 0.375rem',
+                      borderRadius: '10px'
+                    }}>
+                      {dayScheds.length}
+                    </span>
+                  )}
+                </div>
+
+                {/* Schedule Pills - Desktop: show details, Mobile: show dots */}
+                {isMobile ? (
+                  hasSchedules && (
+                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '2px', justifyContent: 'center' }}>
+                      {dayScheds.slice(0, 3).map((schedule, i) => (
+                        <div
+                          key={schedule.id || i}
+                          style={{
+                            width: '6px',
+                            height: '6px',
+                            borderRadius: '50%',
+                            background: getCaregiverColor(schedule.caregiver_id)
+                          }}
+                        />
+                      ))}
+                      {dayScheds.length > 3 && (
+                        <span style={{ fontSize: '0.6rem', color: '#6B7280' }}>+{dayScheds.length - 3}</span>
+                      )}
+                    </div>
+                  )
+                ) : (
+                  <div style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
+                    {dayScheds.slice(0, 4).map((schedule, i) => (
+                      <div
+                        key={schedule.id || i}
+                        style={{
+                          background: getCaregiverColor(schedule.caregiver_id),
+                          color: '#fff',
+                          padding: '2px 6px',
+                          borderRadius: '4px',
+                          fontSize: '0.7rem',
+                          whiteSpace: 'nowrap',
+                          overflow: 'hidden',
+                          textOverflow: 'ellipsis'
+                        }}
+                      >
+                        {formatTime(schedule.start_time)} {getCaregiverInitials(schedule.caregiver_id)}
+                      </div>
+                    ))}
+                    {dayScheds.length > 4 && (
+                      <div style={{ 
+                        fontSize: '0.7rem', 
+                        color: '#6B7280',
+                        textAlign: 'center',
+                        fontWeight: '500'
+                      }}>
+                        +{dayScheds.length - 4} more
+                      </div>
+                    )}
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </div>
+      </div>
+
+      {/* Caregiver Legend */}
+      {caregivers.length > 0 && (
+        <div className="card" style={{ marginTop: '1rem' }}>
+          <h4 style={{ margin: '0 0 0.75rem 0', fontSize: '0.9rem', color: '#374151' }}>Caregivers</h4>
+          <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.75rem' }}>
+            {caregivers.map(cg => (
+              <div 
+                key={cg.id} 
+                style={{ 
+                  display: 'flex', 
+                  alignItems: 'center', 
+                  gap: '0.5rem',
+                  cursor: 'pointer',
+                  padding: '0.25rem 0.5rem',
+                  borderRadius: '6px',
+                  background: filterCaregiver === cg.id ? '#E5E7EB' : 'transparent'
+                }}
+                onClick={() => setFilterCaregiver(filterCaregiver === cg.id ? '' : cg.id)}
+              >
+                <div style={{
+                  width: '12px',
+                  height: '12px',
+                  borderRadius: '3px',
+                  background: getCaregiverColor(cg.id)
+                }} />
+                <span style={{ fontSize: '0.85rem' }}>{cg.first_name} {cg.last_name}</span>
+              </div>
+            ))}
+          </div>
+        </div>
+      )}
+
+      {/* Day Detail Modal */}
+      {selectedDay && (
+        <div 
+          className="modal active" 
+          onClick={(e) => e.target === e.currentTarget && setSelectedDay(null)}
+          style={{
+            position: 'fixed',
+            top: 0,
+            left: 0,
+            right: 0,
+            bottom: 0,
+            background: 'rgba(0,0,0,0.5)',
+            display: 'flex',
+            alignItems: 'center',
+            justifyContent: 'center',
+            zIndex: 1000,
+            padding: '1rem'
+          }}
+        >
+          <div style={{
+            background: '#fff',
+            borderRadius: '12px',
+            width: '100%',
+            maxWidth: '500px',
+            maxHeight: '80vh',
+            overflow: 'hidden',
+            display: 'flex',
+            flexDirection: 'column'
+          }}>
+            {/* Modal Header */}
+            <div style={{
+              padding: '1rem 1.25rem',
+              borderBottom: '1px solid #e5e7eb',
+              display: 'flex',
+              justifyContent: 'space-between',
+              alignItems: 'center'
+            }}>
+              <div>
+                <h3 style={{ margin: 0, fontSize: '1.1rem' }}>
+                  {new Date(currentDate.getFullYear(), currentDate.getMonth(), selectedDay).toLocaleDateString('en-US', { 
+                    weekday: 'long', 
+                    month: 'long', 
+                    day: 'numeric' 
+                  })}
+                </h3>
+                <p style={{ margin: '0.25rem 0 0 0', fontSize: '0.85rem', color: '#6B7280' }}>
+                  {daySchedules.length} appointment{daySchedules.length !== 1 ? 's' : ''}
+                </p>
+              </div>
+              <button 
+                onClick={() => setSelectedDay(null)}
+                style={{
+                  background: 'none',
+                  border: 'none',
+                  fontSize: '1.5rem',
+                  cursor: 'pointer',
+                  color: '#9CA3AF',
+                  padding: '0.25rem'
+                }}
+              >
+                ×
+              </button>
+            </div>
+
+            {/* Schedule List */}
+            <div style={{ 
+              flex: 1, 
+              overflow: 'auto',
+              padding: '1rem'
+            }}>
+              {daySchedules.length === 0 ? (
+                <div style={{ 
+                  textAlign: 'center', 
+                  padding: '3rem 1rem',
+                  color: '#6B7280'
+                }}>
+                  <p style={{ fontSize: '2rem', margin: '0 0 0.5rem 0' }}>📅</p>
+                  <p style={{ margin: 0 }}>No appointments scheduled</p>
+                </div>
+              ) : (
+                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+                  {daySchedules.map((schedule, idx) => (
+                    <div 
+                      key={schedule.id || idx}
+                      style={{
+                        display: 'flex',
+                        gap: '1rem',
+                        padding: '1rem',
+                        background: '#f9fafb',
+                        borderRadius: '8px',
+                        borderLeft: `4px solid ${getCaregiverColor(schedule.caregiver_id)}`
+                      }}
+                    >
+                      {/* Time */}
+                      <div style={{ 
+                        minWidth: '80px',
+                        textAlign: 'center'
+                      }}>
+                        <div style={{ fontWeight: '600', fontSize: '0.95rem' }}>
+                          {formatTime(schedule.start_time)}
+                        </div>
+                        <div style={{ fontSize: '0.8rem', color: '#6B7280' }}>
+                          {formatTime(schedule.end_time)}
+                        </div>
+                      </div>
+
+                      {/* Details */}
+                      <div style={{ flex: 1 }}>
+                        <div style={{ fontWeight: '600', marginBottom: '0.25rem' }}>
+                          {getClientName(schedule.client_id)}
+                        </div>
+                        <div style={{ fontSize: '0.85rem', color: '#6B7280', marginBottom: '0.25rem' }}>
+                          <span style={{
+                            display: 'inline-block',
+                            width: '8px',
+                            height: '8px',
+                            borderRadius: '50%',
+                            background: getCaregiverColor(schedule.caregiver_id),
+                            marginRight: '0.5rem'
+                          }} />
+                          {getCaregiverName(schedule.caregiver_id)}
+                        </div>
+                        {schedule.day_of_week !== null && (
+                          <span style={{
+                            display: 'inline-block',
+                            fontSize: '0.7rem',
+                            background: '#DBEAFE',
+                            color: '#1D4ED8',
+                            padding: '0.125rem 0.5rem',
+                            borderRadius: '10px',
+                            marginRight: '0.5rem'
+                          }}>
+                            Recurring
+                          </span>
+                        )}
+                        {schedule.notes && (
+                          <p style={{ 
+                            margin: '0.5rem 0 0 0', 
+                            fontSize: '0.8rem', 
+                            color: '#6B7280',
+                            fontStyle: 'italic'
+                          }}>
+                            {schedule.notes}
+                          </p>
+                        )}
+                      </div>
+                    </div>
+                  ))}
+                </div>
+              )}
+            </div>
+
+            {/* Modal Footer */}
+            <div style={{
+              padding: '1rem 1.25rem',
+              borderTop: '1px solid #e5e7eb',
+              display: 'flex',
+              justifyContent: 'flex-end'
+            }}>
+              <button 
+                className="btn btn-secondary"
+                onClick={() => setSelectedDay(null)}
+              >
+                Close
+              </button>
+            </div>
+          </div>
+        </div>
+      )}
+
+      {/* Responsive handled via isMobile state */}
+    </div>
+  );
+};
+
+export default ScheduleCalendar;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ScheduleOptimizer.jsx b/templates/crm-homecare/frontend/src/components/admin/ScheduleOptimizer.jsx
new file mode 100644
index 0000000..fc94630
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ScheduleOptimizer.jsx
@@ -0,0 +1,604 @@
+// ScheduleOptimizer.jsx
+// Sandbox schedule builder — pick clients & caregivers, set hours/visits,
+// generate an optimized proposal, review it, then apply to live schedules.
+// Does NOT touch any live data until "Apply to Schedule" is clicked.
+
+import React, { useState, useEffect, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const DAY_NAMES = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+const DAY_COLORS = ['#8B5CF6','#3B82F6','#10B981','#F59E0B','#EF4444','#EC4899','#06B6D4'];
+
+export default function ScheduleOptimizer({ token, caregivers: allCaregivers, clients: allClients }) {
+  // ── State ──────────────────────────────────────────────────────────────────
+  const [selectedCaregivers, setSelectedCaregivers] = useState([]); // [{id, name, allocatedHours}]
+  const [selectedClients, setSelectedClients]       = useState([]); // [{id, name, hoursPerWeek, visitsPerWeek, auth}]
+  const [cgDropdown, setCgDropdown]   = useState('');
+  const [clDropdown, setClDropdown]   = useState('');
+  const [loadingClient, setLoadingClient] = useState(null);
+
+  const [result, setResult]       = useState(null); // optimizer result
+  const [running, setRunning]     = useState(false);
+  const [applying, setApplying]   = useState(false);
+  const [toast, setToast]         = useState(null);
+  const [activeView, setActiveView] = useState('grid'); // 'grid' | 'list'
+  const [selectedProposals, setSelectedProposals] = useState(new Set()); // which proposals to apply
+
+  const showToast = (msg, type = 'success') => {
+    setToast({ msg, type });
+    setTimeout(() => setToast(null), 4000);
+  };
+
+  const api = useCallback(async (url, opts = {}) => {
+    const res = await fetch(`${API_BASE_URL}${url}`, {
+      ...opts,
+      headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}`, ...opts.headers }
+    });
+    if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.error || `${res.status}`); }
+    return res.json();
+  }, [token]);
+
+  // ── Add / Remove Caregivers ────────────────────────────────────────────────
+  const addCaregiver = (id) => {
+    if (!id || selectedCaregivers.find(c => c.id === id)) return;
+    const cg = allCaregivers.find(c => c.id === id);
+    if (!cg) return;
+    setSelectedCaregivers(prev => [...prev, { id, name: `${cg.first_name} ${cg.last_name}`, allocatedHours: 40 }]);
+    setCgDropdown('');
+  };
+
+  const removeCaregiver = (id) => setSelectedCaregivers(prev => prev.filter(c => c.id !== id));
+
+  const updateCgHours = (id, hours) =>
+    setSelectedCaregivers(prev => prev.map(c => c.id === id ? { ...c, allocatedHours: parseFloat(hours) || 0 } : c));
+
+  // ── Add / Remove Clients ───────────────────────────────────────────────────
+  const addClient = async (id) => {
+    if (!id || selectedClients.find(c => c.id === id)) return;
+    const cl = allClients.find(c => c.id === id);
+    if (!cl) return;
+
+    setLoadingClient(id);
+    setClDropdown('');
+    try {
+      const data = await api(`/api/optimizer/client-data/${id}`);
+      setSelectedClients(prev => [...prev, {
+        id,
+        name: `${cl.first_name} ${cl.last_name}`,
+        hoursPerWeek: data.assignedHoursPerWeek || data.authorizedHoursPerWeek || 0,
+        visitsPerWeek: suggestVisits(data.assignedHoursPerWeek || data.authorizedHoursPerWeek || 0),
+        authorizedHoursPerWeek: data.authorizedHoursPerWeek,
+        remainingHours: data.remainingHours,
+        existingDays: data.existingScheduleDays || [],
+        auth: data.authorization
+      }]);
+    } catch {
+      setSelectedClients(prev => [...prev, {
+        id, name: `${cl.first_name} ${cl.last_name}`,
+        hoursPerWeek: 0, visitsPerWeek: 3,
+        authorizedHoursPerWeek: 0, remainingHours: 0,
+        existingDays: [], auth: null
+      }]);
+    } finally {
+      setLoadingClient(null);
+    }
+  };
+
+  const removeClient = (id) => setSelectedClients(prev => prev.filter(c => c.id !== id));
+
+  const updateClientField = (id, field, value) =>
+    setSelectedClients(prev => prev.map(c => c.id === id ? { ...c, [field]: parseFloat(value) || 0 } : c));
+
+  // ── Run Optimizer ──────────────────────────────────────────────────────────
+  const runOptimizer = async () => {
+    if (!selectedCaregivers.length || !selectedClients.length) {
+      showToast('Add at least one caregiver and one client', 'error'); return;
+    }
+    setRunning(true);
+    setResult(null);
+    try {
+      const data = await api('/api/optimizer/run', {
+        method: 'POST',
+        body: JSON.stringify({
+          caregivers: selectedCaregivers.map(c => ({ id: c.id, allocatedHours: c.allocatedHours })),
+          clients: selectedClients.map(c => ({ id: c.id, visitsPerWeek: c.visitsPerWeek, hoursPerWeek: c.hoursPerWeek }))
+        })
+      });
+      setResult(data);
+      // Select all non-conflict proposals by default
+      setSelectedProposals(new Set(data.proposals.filter(p => !p.hasConflict).map(p => p.id)));
+    } catch (e) {
+      showToast('Optimizer failed: ' + e.message, 'error');
+    } finally {
+      setRunning(false);
+    }
+  };
+
+  // ── Apply Selected Proposals ───────────────────────────────────────────────
+  const applyProposals = async () => {
+    if (!result || selectedProposals.size === 0) return;
+    const toApply = result.proposals.filter(p => selectedProposals.has(p.id));
+    setApplying(true);
+    try {
+      const data = await api('/api/optimizer/apply', {
+        method: 'POST',
+        body: JSON.stringify({ proposals: toApply })
+      });
+      showToast(`✅ Applied ${data.created} schedule${data.created !== 1 ? 's' : ''} to live schedule!`);
+      if (data.errors > 0) showToast(`⚠️ ${data.errors} failed to save`, 'error');
+      setResult(null);
+      setSelectedCaregivers([]);
+      setSelectedClients([]);
+    } catch (e) {
+      showToast('Failed to apply: ' + e.message, 'error');
+    } finally {
+      setApplying(false);
+    }
+  };
+
+  const toggleProposal = (id) => {
+    setSelectedProposals(prev => {
+      const next = new Set(prev);
+      if (next.has(id)) next.delete(id); else next.add(id);
+      return next;
+    });
+  };
+
+  const toggleAll = () => {
+    if (selectedProposals.size === result?.proposals.length) setSelectedProposals(new Set());
+    else setSelectedProposals(new Set(result?.proposals.map(p => p.id)));
+  };
+
+  // ── Helpers ────────────────────────────────────────────────────────────────
+  const fmtTime = (t) => {
+    if (!t) return '';
+    const [h, m] = t.split(':');
+    const hour = parseInt(h);
+    return `${hour % 12 || 12}:${m}${hour >= 12 ? 'pm' : 'am'}`;
+  };
+
+  const cgColor = (id) => {
+    const idx = allCaregivers.findIndex(c => c.id === id);
+    const colors = ['#3B82F6','#10B981','#F59E0B','#EF4444','#8B5CF6','#EC4899','#06B6D4','#84CC16'];
+    return colors[idx % colors.length] || '#6B7280';
+  };
+
+  // ── Render ─────────────────────────────────────────────────────────────────
+  const availCaregivers = allCaregivers.filter(c => !selectedCaregivers.find(s => s.id === c.id));
+  const availClients = allClients.filter(c => !selectedClients.find(s => s.id === c.id));
+
+  return (
+    <div>
+      {/* Toast */}
+      {toast && (
+        <div style={{
+          position: 'fixed', top: '1rem', right: '1rem', zIndex: 9999,
+          padding: '0.75rem 1.25rem', borderRadius: '10px', fontWeight: '600',
+          background: toast.type === 'error' ? '#FEE2E2' : '#D1FAE5',
+          color: toast.type === 'error' ? '#DC2626' : '#065F46',
+          boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
+        }}>{toast.msg}</div>
+      )}
+
+      {/* Intro Banner */}
+      <div style={{ background: 'linear-gradient(135deg, #0f766e 0%, #1d4ed8 100%)', borderRadius: '12px', padding: '1.25rem 1.5rem', marginBottom: '1.5rem', color: '#fff' }}>
+        <h3 style={{ margin: '0 0 0.4rem', fontSize: '1.1rem' }}>🧠 Schedule Optimizer</h3>
+        <p style={{ margin: 0, fontSize: '0.88rem', opacity: 0.9 }}>
+          Pick the clients and caretakers you want to work with. Set how many hours each caretaker gets and how many visits each client needs.
+          The optimizer reads existing schedules and builds the best arrangement — then you review it before anything changes.
+        </p>
+      </div>
+
+      {/* Setup Panel */}
+      {!result && (
+        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1.25rem', marginBottom: '1.5rem' }}>
+          {/* Caretakers Column */}
+          <div className="card">
+            <h4 style={{ margin: '0 0 1rem', color: '#1E40AF', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+              👤 Caretakers
+              <span style={{ marginLeft: 'auto', fontSize: '0.75rem', background: '#DBEAFE', color: '#1E40AF', padding: '0.2rem 0.5rem', borderRadius: '12px' }}>
+                {selectedCaregivers.length} added
+              </span>
+            </h4>
+
+            {/* Add Caretaker Dropdown */}
+            <select value={cgDropdown} onChange={e => addCaregiver(e.target.value)}
+              style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #BFDBFE', marginBottom: '1rem', fontSize: '0.9rem' }}>
+              <option value="">+ Add a caretaker...</option>
+              {availCaregivers.map(cg => (
+                <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>
+              ))}
+            </select>
+
+            {/* Caretaker Cards */}
+            {selectedCaregivers.length === 0 ? (
+              <div style={{ textAlign: 'center', padding: '1.5rem', color: '#9CA3AF', fontSize: '0.88rem' }}>
+                No caretakers added yet
+              </div>
+            ) : (
+              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>
+                {selectedCaregivers.map(cg => (
+                  <div key={cg.id} style={{
+                    display: 'flex', alignItems: 'center', gap: '0.75rem',
+                    padding: '0.75rem', borderRadius: '8px',
+                    background: '#F8FAFF', border: `2px solid ${cgColor(cg.id)}30`
+                  }}>
+                    <div style={{ width: '10px', height: '10px', borderRadius: '50%', background: cgColor(cg.id), flexShrink: 0 }} />
+                    <div style={{ flex: 1, fontWeight: '600', fontSize: '0.9rem' }}>{cg.name}</div>
+                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>
+                      <label style={{ fontSize: '0.78rem', color: '#6B7280', whiteSpace: 'nowrap' }}>Hrs/wk:</label>
+                      <input
+                        type="number" min="1" max="80" step="0.5"
+                        value={cg.allocatedHours}
+                        onChange={e => updateCgHours(cg.id, e.target.value)}
+                        style={{ width: '60px', padding: '0.3rem 0.4rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.9rem', textAlign: 'center' }}
+                      />
+                    </div>
+                    <button onClick={() => removeCaregiver(cg.id)}
+                      style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontSize: '1rem', padding: '0.2rem' }}>✕</button>
+                  </div>
+                ))}
+              </div>
+            )}
+          </div>
+
+          {/* Clients Column */}
+          <div className="card">
+            <h4 style={{ margin: '0 0 1rem', color: '#065F46', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+              🏥 Clients
+              <span style={{ marginLeft: 'auto', fontSize: '0.75rem', background: '#D1FAE5', color: '#065F46', padding: '0.2rem 0.5rem', borderRadius: '12px' }}>
+                {selectedClients.length} added
+              </span>
+            </h4>
+
+            {/* Add Client Dropdown */}
+            <select value={clDropdown} onChange={e => addClient(e.target.value)}
+              disabled={loadingClient !== null}
+              style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #A7F3D0', marginBottom: '1rem', fontSize: '0.9rem' }}>
+              <option value="">{loadingClient ? 'Loading...' : '+ Add a client...'}</option>
+              {availClients.map(cl => (
+                <option key={cl.id} value={cl.id}>{cl.first_name} {cl.last_name}</option>
+              ))}
+            </select>
+
+            {/* Client Cards */}
+            {selectedClients.length === 0 ? (
+              <div style={{ textAlign: 'center', padding: '1.5rem', color: '#9CA3AF', fontSize: '0.88rem' }}>
+                No clients added yet
+              </div>
+            ) : (
+              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.6rem' }}>
+                {selectedClients.map(cl => (
+                  <div key={cl.id} style={{
+                    padding: '0.75rem', borderRadius: '8px',
+                    background: '#F0FDF4', border: '1.5px solid #A7F3D0'
+                  }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.5rem' }}>
+                      <div style={{ fontWeight: '600', fontSize: '0.9rem' }}>{cl.name}</div>
+                      <button onClick={() => removeClient(cl.id)}
+                        style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontSize: '1rem', padding: '0' }}>✕</button>
+                    </div>
+
+                    {/* Auth info badge */}
+                    {cl.auth && (
+                      <div style={{ fontSize: '0.75rem', color: '#065F46', background: '#D1FAE5', padding: '0.2rem 0.5rem', borderRadius: '6px', display: 'inline-block', marginBottom: '0.5rem' }}>
+                        ✓ Auth: {cl.authorizedHoursPerWeek}h/wk · {cl.remainingHours}h remaining
+                      </div>
+                    )}
+                    {!cl.auth && (
+                      <div style={{ fontSize: '0.75rem', color: '#D97706', background: '#FEF3C7', padding: '0.2rem 0.5rem', borderRadius: '6px', display: 'inline-block', marginBottom: '0.5rem' }}>
+                        ⚠ No active authorization found
+                      </div>
+                    )}
+
+                    {/* Existing schedule days */}
+                    {cl.existingDays?.length > 0 && (
+                      <div style={{ display: 'flex', gap: '0.3rem', flexWrap: 'wrap', marginBottom: '0.5rem' }}>
+                        <span style={{ fontSize: '0.72rem', color: '#6B7280' }}>Already scheduled:</span>
+                        {cl.existingDays.map(d => (
+                          <span key={d} style={{ fontSize: '0.72rem', padding: '0.1rem 0.4rem', borderRadius: '4px', background: DAY_COLORS[d] + '20', color: DAY_COLORS[d], fontWeight: '600' }}>
+                            {DAY_NAMES[d]}
+                          </span>
+                        ))}
+                      </div>
+                    )}
+
+                    {/* Editable fields */}
+                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}>
+                      <div>
+                        <label style={{ fontSize: '0.72rem', fontWeight: '700', color: '#374151', display: 'block', marginBottom: '0.2rem' }}>Hours/Week</label>
+                        <input
+                          type="number" min="0" max="80" step="0.25"
+                          value={cl.hoursPerWeek}
+                          onChange={e => updateClientField(cl.id, 'hoursPerWeek', e.target.value)}
+                          style={{ width: '100%', padding: '0.35rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.9rem' }}
+                        />
+                      </div>
+                      <div>
+                        <label style={{ fontSize: '0.72rem', fontWeight: '700', color: '#374151', display: 'block', marginBottom: '0.2rem' }}>Visits/Week</label>
+                        <input
+                          type="number" min="1" max="7"
+                          value={cl.visitsPerWeek}
+                          onChange={e => updateClientField(cl.id, 'visitsPerWeek', e.target.value)}
+                          style={{ width: '100%', padding: '0.35rem', borderRadius: '6px', border: '1px solid #D1D5DB', fontSize: '0.9rem' }}
+                        />
+                      </div>
+                    </div>
+                    {cl.hoursPerWeek > 0 && cl.visitsPerWeek > 0 && (
+                      <div style={{ fontSize: '0.72rem', color: '#6B7280', marginTop: '0.35rem' }}>
+                        ≈ {(cl.hoursPerWeek / cl.visitsPerWeek).toFixed(1)}h per visit
+                      </div>
+                    )}
+                  </div>
+                ))}
+              </div>
+            )}
+          </div>
+        </div>
+      )}
+
+      {/* Generate Button */}
+      {!result && (
+        <div style={{ textAlign: 'center', marginBottom: '1.5rem' }}>
+          <button
+            onClick={runOptimizer}
+            disabled={running || !selectedCaregivers.length || !selectedClients.length}
+            style={{
+              padding: '0.9rem 2.5rem', borderRadius: '10px', border: 'none', cursor: 'pointer',
+              fontWeight: '700', fontSize: '1.05rem',
+              background: running ? '#9CA3AF' : 'linear-gradient(135deg, #0f766e, #1d4ed8)',
+              color: '#fff', boxShadow: running ? 'none' : '0 4px 15px rgba(15,118,110,0.4)'
+            }}>
+            {running ? '⏳ Analyzing schedules...' : '✨ Generate Optimized Schedule'}
+          </button>
+          {(!selectedCaregivers.length || !selectedClients.length) && (
+            <p style={{ margin: '0.5rem 0 0', fontSize: '0.82rem', color: '#9CA3AF' }}>
+              Add at least one caretaker and one client to begin
+            </p>
+          )}
+        </div>
+      )}
+
+      {/* ── RESULTS ───────────────────────────────────────────────────────── */}
+      {result && (
+        <div>
+          {/* Summary Bar */}
+          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '0.75rem', marginBottom: '1.25rem' }}>
+            {[
+              { label: 'Proposals', value: result.summary.totalProposals, color: '#2563EB', bg: '#EFF6FF' },
+              { label: 'Clean', value: result.summary.totalProposals - result.summary.conflictCount, color: '#059669', bg: '#F0FDF4' },
+              { label: 'Conflicts', value: result.summary.conflictCount, color: result.summary.conflictCount > 0 ? '#DC2626' : '#059669', bg: result.summary.conflictCount > 0 ? '#FEF2F2' : '#F0FDF4' },
+              { label: 'Unscheduled', value: result.summary.unscheduledCount, color: result.summary.unscheduledCount > 0 ? '#D97706' : '#059669', bg: result.summary.unscheduledCount > 0 ? '#FFFBEB' : '#F0FDF4' }
+            ].map(s => (
+              <div key={s.label} className="card" style={{ textAlign: 'center', padding: '0.75rem', background: s.bg }}>
+                <div style={{ fontSize: '1.8rem', fontWeight: '800', color: s.color }}>{s.value}</div>
+                <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{s.label}</div>
+              </div>
+            ))}
+          </div>
+
+          {/* Caregiver Summary */}
+          <div className="card" style={{ marginBottom: '1.25rem' }}>
+            <h4 style={{ margin: '0 0 0.75rem' }}>👤 Caretaker Hour Summary</h4>
+            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.75rem' }}>
+              {result.summary.caregivers.map(cg => (
+                <div key={cg.id} style={{ flex: '1 1 180px', padding: '0.75rem', background: '#F9FAFB', borderRadius: '8px', borderLeft: `4px solid ${cgColor(cg.id)}` }}>
+                  <div style={{ fontWeight: '700', fontSize: '0.9rem', marginBottom: '0.35rem' }}>{cg.name}</div>
+                  <div style={{ fontSize: '0.78rem', color: '#6B7280', marginBottom: '0.4rem' }}>
+                    {cg.existingHours}h existing + {cg.proposedNewHours}h new = <strong style={{ color: '#374151' }}>{cg.totalHours}h</strong> / {cg.allocatedHours}h
+                  </div>
+                  <div style={{ height: '6px', background: '#E5E7EB', borderRadius: '3px', overflow: 'hidden' }}>
+                    <div style={{
+                      width: `${Math.min((cg.totalHours / cg.allocatedHours) * 100, 100)}%`,
+                      height: '100%',
+                      background: cg.totalHours > cg.allocatedHours ? '#DC2626' : cgColor(cg.id)
+                    }} />
+                  </div>
+                  {cg.remainingHours > 0 && (
+                    <div style={{ fontSize: '0.72rem', color: '#059669', marginTop: '0.25rem' }}>{cg.remainingHours}h remaining capacity</div>
+                  )}
+                </div>
+              ))}
+            </div>
+          </div>
+
+          {/* Client Summary */}
+          <div className="card" style={{ marginBottom: '1.25rem' }}>
+            <h4 style={{ margin: '0 0 0.75rem' }}>🏥 Client Coverage</h4>
+            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.75rem' }}>
+              {result.summary.clients.map(cl => (
+                <div key={cl.id} style={{
+                  flex: '1 1 160px', padding: '0.75rem', borderRadius: '8px',
+                  background: cl.fullyScheduled ? '#F0FDF4' : '#FFFBEB',
+                  border: `1.5px solid ${cl.fullyScheduled ? '#A7F3D0' : '#FDE68A'}`
+                }}>
+                  <div style={{ fontWeight: '700', fontSize: '0.88rem', marginBottom: '0.25rem' }}>{cl.name}</div>
+                  <div style={{ fontSize: '0.82rem' }}>
+                    {cl.fullyScheduled
+                      ? <span style={{ color: '#059669' }}>✅ {cl.visitsPlaced}/{cl.visitsNeeded} visits</span>
+                      : <span style={{ color: '#D97706' }}>⚠ {cl.visitsPlaced}/{cl.visitsNeeded} visits</span>}
+                  </div>
+                  <div style={{ fontSize: '0.75rem', color: '#6B7280' }}>{cl.hoursPerWeek}h/week</div>
+                </div>
+              ))}
+            </div>
+          </div>
+
+          {/* Unscheduled Warnings */}
+          {result.unscheduled.length > 0 && (
+            <div style={{ padding: '0.875rem 1rem', background: '#FFFBEB', border: '1px solid #FDE68A', borderRadius: '8px', marginBottom: '1.25rem' }}>
+              <div style={{ fontWeight: '700', color: '#92400E', marginBottom: '0.4rem' }}>⚠️ Could Not Schedule</div>
+              {result.unscheduled.map((u, i) => (
+                <div key={i} style={{ fontSize: '0.85rem', color: '#B45309' }}>
+                  {u.clientName} — Visit {u.visitNumber}: {u.reason}
+                </div>
+              ))}
+            </div>
+          )}
+
+          {/* View Toggle */}
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
+            <h4 style={{ margin: 0 }}>📋 Proposed Schedule</h4>
+            <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
+              <button onClick={toggleAll} style={{ padding: '0.3rem 0.75rem', borderRadius: '6px', border: '1px solid #D1D5DB', background: '#fff', fontSize: '0.8rem', cursor: 'pointer' }}>
+                {selectedProposals.size === result.proposals.length ? 'Deselect All' : 'Select All'}
+              </button>
+              <button onClick={() => setActiveView('grid')}
+                style={{ padding: '0.3rem 0.75rem', borderRadius: '6px', border: 'none', fontSize: '0.8rem', cursor: 'pointer',
+                  background: activeView === 'grid' ? '#1d4ed8' : '#F3F4F6', color: activeView === 'grid' ? '#fff' : '#374151' }}>
+                Grid
+              </button>
+              <button onClick={() => setActiveView('list')}
+                style={{ padding: '0.3rem 0.75rem', borderRadius: '6px', border: 'none', fontSize: '0.8rem', cursor: 'pointer',
+                  background: activeView === 'list' ? '#1d4ed8' : '#F3F4F6', color: activeView === 'list' ? '#fff' : '#374151' }}>
+                List
+              </button>
+            </div>
+          </div>
+
+          {/* GRID VIEW */}
+          {activeView === 'grid' && (
+            <div style={{ overflowX: 'auto', marginBottom: '1.25rem' }}>
+              <table style={{ width: '100%', borderCollapse: 'collapse', minWidth: '650px' }}>
+                <thead>
+                  <tr style={{ background: '#F9FAFB' }}>
+                    <th style={{ padding: '0.6rem 0.75rem', textAlign: 'left', fontSize: '0.82rem', color: '#6B7280', fontWeight: '600', borderBottom: '2px solid #E5E7EB' }}>Caretaker</th>
+                    {DAY_NAMES.map((d, i) => (
+                      <th key={d} style={{ padding: '0.6rem 0.5rem', textAlign: 'center', fontSize: '0.82rem', color: '#6B7280', fontWeight: '600', borderBottom: '2px solid #E5E7EB', minWidth: '90px' }}>
+                        {d}
+                      </th>
+                    ))}
+                  </tr>
+                </thead>
+                <tbody>
+                  {result.summary.caregivers.map(cg => (
+                    <tr key={cg.id} style={{ borderBottom: '1px solid #F3F4F6' }}>
+                      <td style={{ padding: '0.5rem 0.75rem', verticalAlign: 'top' }}>
+                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>
+                          <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: cgColor(cg.id) }} />
+                          <span style={{ fontSize: '0.85rem', fontWeight: '600' }}>{cg.name.split(' ')[0]}</span>
+                        </div>
+                      </td>
+                      {[0,1,2,3,4,5,6].map(day => {
+                        // Existing schedules for this caregiver on this day
+                        const existing = result.existingSchedules.filter(s => s.caregiverId === cg.id && s.dayOfWeek === day);
+                        // New proposals for this caregiver on this day
+                        const proposed = result.proposals.filter(p => p.caregiverId === cg.id && p.dayOfWeek === day);
+                        return (
+                          <td key={day} style={{ padding: '0.25rem', verticalAlign: 'top' }}>
+                            {/* Existing (greyed) */}
+                            {existing.map(s => (
+                              <div key={s.id} style={{ fontSize: '0.68rem', padding: '0.2rem 0.3rem', marginBottom: '0.2rem', borderRadius: '4px', background: '#F3F4F6', borderLeft: `3px solid ${cgColor(cg.id)}80`, color: '#6B7280' }}
+                                title="Existing schedule">
+                                <div style={{ fontWeight: '600', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{s.clientName?.split(' ')[0]}</div>
+                                <div>{fmtTime(s.startTime)}</div>
+                              </div>
+                            ))}
+                            {/* Proposed */}
+                            {proposed.map(p => (
+                              <div key={p.id}
+                                onClick={() => toggleProposal(p.id)}
+                                style={{ fontSize: '0.68rem', padding: '0.2rem 0.3rem', marginBottom: '0.2rem', borderRadius: '4px', cursor: 'pointer',
+                                  background: selectedProposals.has(p.id) ? (p.hasConflict ? '#FEE2E2' : '#DBEAFE') : '#fff',
+                                  borderLeft: `3px solid ${p.hasConflict ? '#DC2626' : cgColor(cg.id)}`,
+                                  border: `1px solid ${p.hasConflict ? '#FCA5A5' : '#BFDBFE'}`,
+                                  opacity: selectedProposals.has(p.id) ? 1 : 0.5
+                                }}
+                                title={p.hasConflict ? `⚠ Conflict: ${p.conflictsWith.map(c => c.clientName).join(', ')}` : 'New proposal — click to toggle'}>
+                                <div style={{ fontWeight: '700', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
+                                  {p.hasConflict ? '⚠ ' : '✦ '}{p.clientName?.split(' ')[0]}
+                                </div>
+                                <div>{fmtTime(p.startTime)}–{fmtTime(p.endTime)}</div>
+                              </div>
+                            ))}
+                          </td>
+                        );
+                      })}
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+              <div style={{ fontSize: '0.75rem', color: '#6B7280', marginTop: '0.5rem', display: 'flex', gap: '1rem' }}>
+                <span>◻ Greyed = existing schedule (unchanged)</span>
+                <span style={{ color: '#1D4ED8' }}>🔷 Blue = proposed new visit (selected)</span>
+                <span style={{ color: '#DC2626' }}>🔴 Red = proposed but has time conflict</span>
+                <span>Click to toggle selection</span>
+              </div>
+            </div>
+          )}
+
+          {/* LIST VIEW */}
+          {activeView === 'list' && (
+            <div style={{ marginBottom: '1.25rem' }}>
+              {result.proposals.map(p => (
+                <div key={p.id}
+                  onClick={() => toggleProposal(p.id)}
+                  style={{
+                    display: 'flex', alignItems: 'center', gap: '0.75rem',
+                    padding: '0.75rem', marginBottom: '0.5rem', borderRadius: '8px', cursor: 'pointer',
+                    background: selectedProposals.has(p.id) ? (p.hasConflict ? '#FEF2F2' : '#EFF6FF') : '#FAFAFA',
+                    border: `1.5px solid ${selectedProposals.has(p.id) ? (p.hasConflict ? '#FCA5A5' : '#BFDBFE') : '#E5E7EB'}`
+                  }}>
+                  <input type="checkbox" checked={selectedProposals.has(p.id)} onChange={() => {}} style={{ width: 'auto', cursor: 'pointer' }} />
+                  <div style={{ width: '10px', height: '10px', borderRadius: '50%', background: cgColor(p.caregiverId), flexShrink: 0 }} />
+                  <div style={{ flex: 1 }}>
+                    <div style={{ fontWeight: '600', fontSize: '0.9rem' }}>
+                      {p.clientName}
+                      {p.isNew && <span style={{ marginLeft: '0.4rem', fontSize: '0.7rem', padding: '0.1rem 0.4rem', background: '#DBEAFE', color: '#1D4ED8', borderRadius: '4px' }}>NEW DAY</span>}
+                      {p.hasConflict && <span style={{ marginLeft: '0.4rem', fontSize: '0.7rem', padding: '0.1rem 0.4rem', background: '#FEE2E2', color: '#DC2626', borderRadius: '4px' }}>⚠ CONFLICT</span>}
+                    </div>
+                    <div style={{ fontSize: '0.8rem', color: '#6B7280' }}>
+                      with {p.caregiverName} · {p.dayName} {fmtTime(p.startTime)}–{fmtTime(p.endTime)} ({p.hoursPerVisit}h)
+                    </div>
+                    {p.hasConflict && p.conflictsWith.map((c, i) => (
+                      <div key={i} style={{ fontSize: '0.75rem', color: '#DC2626', marginTop: '0.2rem' }}>
+                        ⚠ Overlaps with {c.clientName} ({fmtTime(c.start)}–{fmtTime(c.end)}) — {c.suggestion}
+                      </div>
+                    ))}
+                  </div>
+                </div>
+              ))}
+            </div>
+          )}
+
+          {/* Action Buttons */}
+          <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end', padding: '1rem', background: '#F9FAFB', borderRadius: '10px' }}>
+            <button onClick={() => { setResult(null); }}
+              style={{ padding: '0.7rem 1.5rem', borderRadius: '8px', border: '1.5px solid #D1D5DB', background: '#fff', cursor: 'pointer', fontWeight: '600', fontSize: '0.9rem' }}>
+              ← Start Over
+            </button>
+            <button onClick={() => { setResult(null); runOptimizer(); }}
+              disabled={running}
+              style={{ padding: '0.7rem 1.5rem', borderRadius: '8px', border: 'none', background: '#F3F4F6', cursor: 'pointer', fontWeight: '600', fontSize: '0.9rem' }}>
+              🔄 Re-run
+            </button>
+            <button
+              onClick={applyProposals}
+              disabled={applying || selectedProposals.size === 0}
+              style={{
+                padding: '0.7rem 1.75rem', borderRadius: '8px', border: 'none', cursor: 'pointer',
+                fontWeight: '700', fontSize: '0.95rem',
+                background: applying || selectedProposals.size === 0 ? '#9CA3AF' : 'linear-gradient(135deg, #059669, #0f766e)',
+                color: '#fff', boxShadow: applying || selectedProposals.size === 0 ? 'none' : '0 4px 12px rgba(5,150,105,0.35)'
+              }}>
+              {applying ? 'Applying...' : `✅ Apply ${selectedProposals.size} Schedule${selectedProposals.size !== 1 ? 's' : ''} to Live`}
+            </button>
+          </div>
+          <p style={{ fontSize: '0.78rem', color: '#9CA3AF', textAlign: 'center', margin: '0.5rem 0 0' }}>
+            Only checked proposals will be applied. Conflicts are unchecked by default — review them before including.
+          </p>
+        </div>
+      )}
+    </div>
+  );
+}
+
+// ─── Helper ────────────────────────────────────────────────────────────────────
+function suggestVisits(hoursPerWeek) {
+  if (!hoursPerWeek || hoursPerWeek <= 0) return 3;
+  if (hoursPerWeek <= 5) return 2;
+  if (hoursPerWeek <= 10) return 3;
+  if (hoursPerWeek <= 20) return 4;
+  if (hoursPerWeek <= 30) return 5;
+  return 6;
+}
diff --git a/templates/crm-homecare/frontend/src/components/admin/SchedulingHub.jsx b/templates/crm-homecare/frontend/src/components/admin/SchedulingHub.jsx
new file mode 100644
index 0000000..736f16a
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/SchedulingHub.jsx
@@ -0,0 +1,1564 @@
+// src/components/admin/SchedulingHub.jsx
+// Unified scheduling hub — 3 main tabs, slide-in create panel, fluid workflows
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import AutoFillButton from './AutoFillButton';
+import DragDropScheduler from './DragDropScheduler';
+import ScheduleOptimizer from './ScheduleOptimizer';
+import RosterOptimizer from './RosterOptimizer';
+import { confirm } from '../ConfirmModal';
+
+function getWeekStart(date) {
+  const d = new Date(date);
+  d.setDate(d.getDate() - d.getDay());
+  d.setHours(0, 0, 0, 0);
+  return d;
+}
+
+const SchedulingHub = ({ token }) => {
+  // ── Navigation state ──
+  const [mainTab, setMainTab]           = useState('schedule');
+  const [scheduleView, setScheduleView] = useState('grid');
+  const [toolsTab, setToolsTab]         = useState('coverage');
+  const [staffingTab, setStaffingTab]   = useState('open-shifts');
+  const [isMobile, setIsMobile]         = useState(window.innerWidth < 768);
+
+  // ── Shared data ──
+  const [caregivers, setCaregivers] = useState([]);
+  const [clients, setClients]       = useState([]);
+  const [loading, setLoading]       = useState(true);
+  const [careTypes, setCareTypes]   = useState([]);
+
+  // ── Toast ──
+  const [message, setMessage] = useState({ text: '', type: '' });
+  const showMsg = (text, type = 'success') => {
+    setMessage({ text, type });
+    setTimeout(() => setMessage({ text: '', type: '' }), 4000);
+  };
+
+  // ── Slide-in Create Panel ──
+  const [createPanelOpen, setCreatePanelOpen] = useState(false);
+
+  // ── Create Schedule state ──
+  const [selectedCaregiverId, setSelectedCaregiverId] = useState('');
+  const [showForm, setShowForm]                       = useState(false);
+  const [caregiverSchedules, setCaregiverSchedules]   = useState([]);
+  const [saving, setSaving]                           = useState(false);
+  const [formData, setFormData] = useState({
+    caregiverId: '', clientId: '', scheduleType: 'one-time',
+    dayOfWeek: '', date: new Date().toISOString().split('T')[0],
+    startTime: '09:00', endTime: '13:00', notes: ''
+  });
+  const [selectedDays, setSelectedDays]             = useState([]);
+  const [conflicts, setConflicts]                   = useState([]);
+  const [biWeeklyAnchorDate, setBiWeeklyAnchorDate] = useState(() => {
+    const d = new Date(); d.setDate(d.getDate() - d.getDay()); return d.toISOString().split('T')[0];
+  });
+
+  // ── Edit Schedule Modal ──
+  const [editModal, setEditModal]   = useState(null);
+  const [editSaving, setEditSaving] = useState(false);
+
+  // ── Week View state ──
+  const [weekOf, setWeekOf]               = useState(getWeekStart(new Date()).toISOString().split('T')[0]);
+  const [weekData, setWeekData]           = useState(null);
+  const [reassignModal, setReassignModal] = useState(null);
+
+  // ── Calendar state ──
+  const [calCurrentDate, setCalCurrentDate]         = useState(new Date());
+  const [calSchedules, setCalSchedules]             = useState([]);
+  const [calSelectedDay, setCalSelectedDay]         = useState(null);
+  const [calDaySchedules, setCalDaySchedules]       = useState([]);
+  const [calFilterCaregiver, setCalFilterCaregiver] = useState('');
+
+  // ── Prospects state ──
+  const [prospects, setProspects]               = useState([]);
+  const [prospectAppts, setProspectAppts]       = useState([]);
+  const [showProspectForm, setShowProspectForm] = useState(false);
+  const [prospectForm, setProspectForm]         = useState({ firstName: '', lastName: '', phone: '', email: '', notes: '', source: '' });
+  const [showProspectApptForm, setShowProspectApptForm] = useState(false);
+  const [prospectApptForm, setProspectApptForm] = useState({ prospectId: '', caregiverId: '', appointmentDate: '', startTime: '10:00', endTime: '11:00', appointmentType: 'assessment', location: '', notes: '' });
+  const [prospectSaving, setProspectSaving]     = useState(false);
+
+  // ── Coverage state ──
+  const [coverageData, setCoverageData]       = useState(null);
+  const [coverageLoading, setCoverageLoading] = useState(false);
+  const [coverageWeekOf, setCoverageWeekOf]   = useState(getWeekStart(new Date()).toISOString().split('T')[0]);
+
+  // ── Open Shifts state ──
+  const [openShifts, setOpenShifts]                 = useState([]);
+  const [openShiftsLoading, setOpenShiftsLoading]   = useState(false);
+  const [openShiftFilter, setOpenShiftFilter]       = useState('open');
+  const [showCreateShift, setShowCreateShift]       = useState(false);
+  const [createShiftPreFill, setCreateShiftPreFill] = useState({});
+  const [shiftClaims, setShiftClaims]               = useState([]);
+  const [currentShift, setCurrentShift]             = useState(null);
+
+  // ── Shift Swaps state ──
+  const [swaps, setSwaps]             = useState([]);
+  const [swapsLoading, setSwapsLoading] = useState(false);
+  const [swapFilter, setSwapFilter]   = useState('');
+
+  // ── Absences state ──
+  const [absences, setAbsences]               = useState([]);
+  const [absencesLoading, setAbsencesLoading] = useState(false);
+  const [showAbsenceForm, setShowAbsenceForm] = useState(false);
+  const [absenceForm, setAbsenceForm]         = useState({ caregiverId: '', date: '', type: 'call_out', reason: '' });
+  const [pendingAbsenceShift, setPendingAbsenceShift] = useState(null);
+
+  // ── Availability state ──
+  const [availCaregiver, setAvailCaregiver]     = useState('');
+  const [availData, setAvailData]               = useState(null);
+  const [blackoutDates, setBlackoutDates]       = useState([]);
+  const [showBlackoutForm, setShowBlackoutForm] = useState(false);
+  const [newBlackout, setNewBlackout]           = useState({ startDate: '', endDate: '', reason: '' });
+  const [availForm, setAvailForm] = useState({
+    status: 'available', maxHoursPerWeek: 40,
+    mondayAvailable: true,    mondayStartTime: '08:00',    mondayEndTime: '17:00',
+    tuesdayAvailable: true,   tuesdayStartTime: '08:00',   tuesdayEndTime: '17:00',
+    wednesdayAvailable: true, wednesdayStartTime: '08:00', wednesdayEndTime: '17:00',
+    thursdayAvailable: true,  thursdayStartTime: '08:00',  thursdayEndTime: '17:00',
+    fridayAvailable: true,    fridayStartTime: '08:00',    fridayEndTime: '17:00',
+    saturdayAvailable: false,  saturdayStartTime: '08:00',  saturdayEndTime: '17:00',
+    sundayAvailable: false,    sundayStartTime: '08:00',    sundayEndTime: '17:00',
+  });
+  const daysOfWeek = [
+    { key: 'monday', label: 'Mon' }, { key: 'tuesday', label: 'Tue' },
+    { key: 'wednesday', label: 'Wed' }, { key: 'thursday', label: 'Thu' },
+    { key: 'friday', label: 'Fri' }, { key: 'saturday', label: 'Sat' },
+    { key: 'sunday', label: 'Sun' }
+  ];
+
+  // ═══════════════════════════════════════════════
+  // DATA LOADING
+  // ═══════════════════════════════════════════════
+
+  useEffect(() => {
+    loadCoreData();
+    const handleResize = () => setIsMobile(window.innerWidth < 768);
+    window.addEventListener('resize', handleResize);
+    return () => window.removeEventListener('resize', handleResize);
+  }, []);
+
+  useEffect(() => { if (scheduleView === 'week') loadWeekView(); }, [scheduleView, weekOf]);
+  useEffect(() => { if (scheduleView === 'month') loadCalendarData(); }, [scheduleView, calCurrentDate]);
+  useEffect(() => { if (mainTab === 'tools' && toolsTab === 'coverage') loadCoverage(); }, [mainTab, toolsTab, coverageWeekOf]);
+  useEffect(() => { if (mainTab === 'staffing' && staffingTab === 'open-shifts') loadOpenShifts(); }, [mainTab, staffingTab, openShiftFilter]);
+  useEffect(() => { if (mainTab === 'staffing' && staffingTab === 'swaps') { loadSwaps(); loadAbsences(); } }, [mainTab, staffingTab, swapFilter]);
+
+  const api = async (url, opts = {}) => {
+    const res = await fetch(`${API_BASE_URL}${url}`, {
+      ...opts, headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}`, ...opts.headers }
+    });
+    if (!res.ok) throw new Error(`Request failed (${res.status})`);
+    return res.json();
+  };
+
+  const loadCoreData = async () => {
+    try {
+      const [cg, cl, ct, pr] = await Promise.all([
+        api('/api/caregivers'), api('/api/clients'),
+        api('/api/care-types').catch(() => []), api('/api/prospects').catch(() => [])
+      ]);
+      setCaregivers(Array.isArray(cg) ? cg : []);
+      setClients(Array.isArray(cl) ? cl : []);
+      setCareTypes(Array.isArray(ct) ? ct : []);
+      setProspects(Array.isArray(pr) ? pr : []);
+    } catch (e) { console.error('Failed to load data:', e); }
+    finally { setLoading(false); }
+  };
+
+  const loadWeekView = async () => {
+    try { const data = await api(`/api/scheduling/week-view?weekOf=${weekOf}`); setWeekData(data); }
+    catch (e) { console.error(e); }
+  };
+
+  const loadCoverage = async () => {
+    setCoverageLoading(true);
+    try { const data = await api(`/api/scheduling/coverage-overview?weekOf=${coverageWeekOf}`); setCoverageData(data); }
+    catch (e) { console.error(e); }
+    finally { setCoverageLoading(false); }
+  };
+
+  const loadCalendarData = async () => {
+    try {
+      const [schedData, prospData, apptData] = await Promise.all([
+        api('/api/schedules-all'),
+        api('/api/prospects').catch(() => []),
+        api(`/api/prospect-appointments?month=${calCurrentDate.getMonth() + 1}&year=${calCurrentDate.getFullYear()}`).catch(() => [])
+      ]);
+      setCalSchedules(Array.isArray(schedData) ? schedData : []);
+      setProspects(Array.isArray(prospData) ? prospData : []);
+      setProspectAppts(Array.isArray(apptData) ? apptData : []);
+    } catch (e) { console.error(e); }
+  };
+
+  const loadProspects = async () => { try { const d = await api('/api/prospects'); setProspects(Array.isArray(d) ? d : []); } catch (e) { console.error(e); } };
+  const loadProspectAppts = async () => { try { const d = await api(`/api/prospect-appointments?month=${calCurrentDate.getMonth() + 1}&year=${calCurrentDate.getFullYear()}`); setProspectAppts(Array.isArray(d) ? d : []); } catch (e) { console.error(e); } };
+
+  const loadOpenShifts = async () => {
+    setOpenShiftsLoading(true);
+    try { const data = await api(`/api/open-shifts${openShiftFilter ? `?status=${openShiftFilter}` : ''}`); setOpenShifts(Array.isArray(data) ? data : []); }
+    catch (e) { console.error(e); }
+    finally { setOpenShiftsLoading(false); }
+  };
+
+  const loadSwaps = async () => {
+    setSwapsLoading(true);
+    try { const data = await api(`/api/shift-swaps${swapFilter ? `?status=${swapFilter}` : ''}`); setSwaps(Array.isArray(data) ? data : []); }
+    catch (e) { console.error(e); }
+    finally { setSwapsLoading(false); }
+  };
+
+  const loadAbsences = async () => {
+    setAbsencesLoading(true);
+    try { const data = await api('/api/absences'); setAbsences(Array.isArray(data) ? data : []); }
+    catch (e) { console.error(e); }
+    finally { setAbsencesLoading(false); }
+  };
+
+  // ═══════════════════════════════════════════════
+  // HELPERS
+  // ═══════════════════════════════════════════════
+
+  const formatTime = (t) => {
+    if (!t) return '';
+    const [h, m] = t.split(':');
+    const hour = parseInt(h);
+    return `${hour % 12 || 12}:${m}${hour >= 12 ? 'pm' : 'am'}`;
+  };
+
+  const getClientName    = (id) => { const c = clients.find(cl => cl.id === id); return c ? `${c.first_name} ${c.last_name}` : 'Unknown'; };
+  const getCaregiverName = (id) => { const c = caregivers.find(cg => cg.id === id); return c ? `${c.first_name} ${c.last_name}` : 'Unknown'; };
+  const cgColor = (id) => {
+    const colors = ['#3B82F6','#10B981','#F59E0B','#EF4444','#8B5CF6','#EC4899','#06B6D4','#84CC16'];
+    return colors[caregivers.findIndex(c => c.id === id) % colors.length];
+  };
+  const navigateWeek = (dir) => {
+    const d = new Date(weekOf + 'T12:00:00'); d.setDate(d.getDate() + dir * 7);
+    setWeekOf(getWeekStart(d).toISOString().split('T')[0]);
+  };
+  const shiftPresets = [
+    { label: 'Morning (8–12)', start: '08:00', end: '12:00' },
+    { label: 'Afternoon (12–4)', start: '12:00', end: '16:00' },
+    { label: 'Evening (4–8)', start: '16:00', end: '20:00' },
+    { label: 'Full Day (8–4)', start: '08:00', end: '16:00' },
+    { label: 'Half AM (8–12)', start: '08:00', end: '12:00' },
+    { label: 'Half PM (1–5)', start: '13:00', end: '17:00' },
+  ];
+  const calculateHours = (start, end) => {
+    if (!start || !end) return 0;
+    return ((new Date(`2000-01-01T${end}`) - new Date(`2000-01-01T${start}`)) / 3600000).toFixed(2);
+  };
+  const getDayName = (dow) => ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'][dow] || 'Unknown';
+  const calculateTotalHours = (list) => list.reduce((t, s) => {
+    const hrs = parseFloat(calculateHours(s.start_time, s.end_time));
+    return t + (s.frequency === 'biweekly' ? hrs / 2 : hrs);
+  }, 0).toFixed(2);
+  const groupSchedules = () => {
+    const recurringByDay = {}, oneTimeByDate = {};
+    caregiverSchedules.forEach(s => {
+      if (s.day_of_week !== null && s.day_of_week !== undefined) {
+        if (!recurringByDay[s.day_of_week]) recurringByDay[s.day_of_week] = [];
+        recurringByDay[s.day_of_week].push(s);
+      } else if (s.date) {
+        const dk = s.date.split('T')[0];
+        if (!oneTimeByDate[dk]) oneTimeByDate[dk] = [];
+        oneTimeByDate[dk].push(s);
+      }
+    });
+    Object.values(recurringByDay).forEach(arr => arr.sort((a, b) => (a.start_time || '').localeCompare(b.start_time || '')));
+    Object.values(oneTimeByDate).forEach(arr => arr.sort((a, b) => (a.start_time || '').localeCompare(b.start_time || '')));
+    return { recurringByDay, oneTimeByDate };
+  };
+  const detectConflicts = (schedules) => {
+    const found = [];
+    const recurring = schedules.filter(s => s.day_of_week !== null && s.day_of_week !== undefined && s.is_active !== false);
+    recurring.forEach((a, i) => {
+      recurring.slice(i + 1).forEach(b => {
+        if (a.day_of_week !== b.day_of_week) return;
+        if (a.frequency === 'biweekly' && b.frequency === 'biweekly' && a.anchor_date && b.anchor_date) {
+          const diffWeeks = Math.floor(Math.abs(new Date(a.anchor_date) - new Date(b.anchor_date)) / (7*24*60*60*1000));
+          if (diffWeeks % 2 !== 0) return;
+        }
+        if (a.start_time < b.end_time && a.end_time > b.start_time) found.push({ a, b, day: a.day_of_week });
+      });
+    });
+    return found;
+  };
+
+  // ═══════════════════════════════════════════════
+  // OPEN CREATE PANEL (pre-fillable)
+  // Called from: + New button, empty week cell click, Coverage "Fix It"
+  // ═══════════════════════════════════════════════
+
+  const openCreatePanel = ({ caregiverId = '', clientId = '', date = '', dayOfWeek = '' } = {}) => {
+    setSelectedCaregiverId(caregiverId);
+    setFormData(prev => ({
+      ...prev,
+      caregiverId: caregiverId || '',
+      clientId: clientId || '',
+      date: date || new Date().toISOString().split('T')[0],
+      dayOfWeek: dayOfWeek !== '' ? dayOfWeek.toString() : '',
+      scheduleType: dayOfWeek !== '' ? 'recurring' : 'one-time',
+      startTime: '09:00', endTime: '13:00', notes: ''
+    }));
+    setSelectedDays([]);
+    if (caregiverId) loadCaregiverSchedules(caregiverId);
+    setShowForm(true);
+    setCreatePanelOpen(true);
+  };
+
+  const closeCreatePanel = () => {
+    setCreatePanelOpen(false);
+    setShowForm(false);
+    setSelectedCaregiverId('');
+    setCaregiverSchedules([]);
+    setConflicts([]);
+  };
+
+  // ═══════════════════════════════════════════════
+  // CREATE SCHEDULE LOGIC
+  // ═══════════════════════════════════════════════
+
+  const loadCaregiverSchedules = async (cgId) => {
+    if (!cgId) return;
+    try {
+      const data = await api(`/api/schedules/caregiver/${cgId}`);
+      const list = Array.isArray(data) ? data : [];
+      setCaregiverSchedules(list);
+      setConflicts(detectConflicts(list));
+    } catch (e) { setCaregiverSchedules([]); setConflicts([]); }
+  };
+
+  const handleCaregiverSelectCreate = (cgId) => {
+    setSelectedCaregiverId(cgId);
+    setFormData(prev => ({ ...prev, caregiverId: cgId }));
+    loadCaregiverSchedules(cgId);
+  };
+
+  const toggleDaySelection = (idx) => setSelectedDays(prev => prev.includes(idx) ? prev.filter(d => d !== idx) : [...prev, idx].sort((a, b) => a - b));
+  const selectWeekdays = () => setSelectedDays([1, 2, 3, 4, 5]);
+  const clearDays = () => setSelectedDays([]);
+  const applyPreset = (preset) => setFormData(prev => ({ ...prev, startTime: preset.start, endTime: preset.end }));
+
+  const handleCreateSubmit = async (e) => {
+    e.preventDefault();
+    if (!formData.caregiverId || !formData.clientId) { showMsg('Select both caregiver and client', 'error'); return; }
+    if (formData.scheduleType === 'recurring' && formData.dayOfWeek === '') { showMsg('Select a day of week', 'error'); return; }
+    if (formData.scheduleType === 'one-time' && !formData.date) { showMsg('Select a date', 'error'); return; }
+    if ((formData.scheduleType === 'multi-day' || formData.scheduleType === 'bi-weekly') && selectedDays.length === 0) { showMsg('Select at least one day', 'error'); return; }
+    if (formData.startTime >= formData.endTime) { showMsg('End time must be after start time', 'error'); return; }
+    const today = new Date().toISOString().split('T')[0];
+    const anchorBase = new Date(biWeeklyAnchorDate + 'T12:00:00');
+    anchorBase.setDate(anchorBase.getDate() - anchorBase.getDay());
+    const anchorStr = anchorBase.toISOString().split('T')[0];
+    setSaving(true);
+    try {
+      if (formData.scheduleType === 'multi-day' || formData.scheduleType === 'bi-weekly') {
+        const freq = formData.scheduleType === 'bi-weekly' ? 'biweekly' : 'weekly';
+        let created = 0, failed = 0;
+        for (const dayOfWeek of selectedDays) {
+          try {
+            await api('/api/schedules-enhanced', { method: 'POST', body: JSON.stringify({
+              caregiverId: formData.caregiverId, clientId: formData.clientId, scheduleType: 'recurring',
+              dayOfWeek, date: null, startTime: formData.startTime, endTime: formData.endTime, notes: formData.notes,
+              frequency: freq, effectiveDate: today, anchorDate: anchorStr
+            })});
+            created++;
+          } catch { failed++; }
+        }
+        showMsg(`Created ${created} ${freq === 'biweekly' ? 'bi-weekly' : 'recurring'} schedule${created !== 1 ? 's' : ''}${failed > 0 ? ` (${failed} failed)` : ''}!`);
+      } else if (formData.scheduleType === 'recurring') {
+        await api('/api/schedules-enhanced', { method: 'POST', body: JSON.stringify({
+          caregiverId: formData.caregiverId, clientId: formData.clientId, scheduleType: 'recurring',
+          dayOfWeek: parseInt(formData.dayOfWeek), date: null, startTime: formData.startTime, endTime: formData.endTime,
+          notes: formData.notes, frequency: 'weekly', effectiveDate: today, anchorDate: null
+        })});
+        showMsg('Schedule created!');
+      } else {
+        await api('/api/schedules', { method: 'POST', body: JSON.stringify({
+          caregiverId: formData.caregiverId, clientId: formData.clientId, scheduleType: 'one-time',
+          dayOfWeek: null, date: formData.date, startTime: formData.startTime, endTime: formData.endTime, notes: formData.notes
+        })});
+        showMsg('Schedule created!');
+      }
+      setFormData(prev => ({ ...prev, clientId: '', scheduleType: 'one-time', dayOfWeek: '', date: new Date().toISOString().split('T')[0], startTime: '09:00', endTime: '13:00', notes: '' }));
+      setSelectedDays([]);
+      loadCaregiverSchedules(selectedCaregiverId);
+      if (scheduleView === 'week') loadWeekView();
+      if (scheduleView === 'month') loadCalendarData();
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+    finally { setSaving(false); }
+  };
+
+  const handleDeleteSchedule = async (scheduleId) => {
+    const _cok = await confirm('Delete this schedule?', {danger: true}); if (!_cok) return;
+    try { await api(`/api/schedules/${scheduleId}`, { method: 'DELETE' }); showMsg('Schedule deleted'); loadCaregiverSchedules(selectedCaregiverId); }
+    catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  const openEditModal = (schedule) => {
+    const isRecurring = schedule.day_of_week !== null && schedule.day_of_week !== undefined;
+    setEditModal({
+      id: schedule.id, clientId: schedule.client_id,
+      dayOfWeek: isRecurring ? schedule.day_of_week.toString() : '',
+      date: schedule.date ? schedule.date.split('T')[0] : '',
+      startTime: schedule.start_time || '09:00', endTime: schedule.end_time || '13:00',
+      notes: schedule.notes || '', scheduleType: isRecurring ? 'recurring' : 'one-time',
+      frequency: schedule.frequency || 'weekly',
+      anchorDate: schedule.anchor_date ? schedule.anchor_date.split('T')[0] : ''
+    });
+  };
+
+  const handleSaveEdit = async () => {
+    if (!editModal) return;
+    if (editModal.startTime >= editModal.endTime) { showMsg('End time must be after start time', 'error'); return; }
+    setEditSaving(true);
+    try {
+      await api(`/api/schedules-all/${editModal.id}`, { method: 'PUT', body: JSON.stringify({
+        clientId: editModal.clientId,
+        dayOfWeek: editModal.scheduleType === 'recurring' ? parseInt(editModal.dayOfWeek) : null,
+        date: editModal.scheduleType === 'one-time' ? editModal.date : null,
+        startTime: editModal.startTime, endTime: editModal.endTime, notes: editModal.notes,
+        frequency: editModal.frequency || 'weekly', anchorDate: editModal.anchorDate || null
+      })});
+      showMsg('Schedule updated!'); setEditModal(null); loadCaregiverSchedules(selectedCaregiverId);
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+    finally { setEditSaving(false); }
+  };
+
+  const handleReassign = async (scheduleId, newCaregiverId) => {
+    try { await api(`/api/schedules/${scheduleId}/reassign`, { method: 'PUT', body: JSON.stringify({ newCaregiverId }) }); showMsg('Reassigned!'); loadWeekView(); }
+    catch (e) { showMsg('Failed to reassign', 'error'); }
+  };
+
+  // ═══════════════════════════════════════════════
+  // CALENDAR HELPERS
+  // ═══════════════════════════════════════════════
+
+  const calDaysInMonth = new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth() + 1, 0).getDate();
+  const calFirstDay    = new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth(), 1).getDay();
+
+  const getCalSchedulesForDay = (day) => {
+    const target  = new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth(), day);
+    const dow     = target.getDay();
+    const dateStr = `${target.getFullYear()}-${String(target.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
+    let filtered  = calSchedules.filter(s => {
+      if (s.date) return s.date.split('T')[0] === dateStr;
+      if (s.day_of_week !== null && s.day_of_week !== undefined) {
+        if (s.day_of_week !== dow) return false;
+        if (s.effective_date && target < new Date(s.effective_date + 'T00:00:00')) return false;
+        if (s.frequency === 'biweekly' && s.anchor_date) {
+          const diffWeeks = Math.floor((target - new Date(s.anchor_date + 'T00:00:00')) / (7*24*60*60*1000));
+          if (diffWeeks % 2 !== 0) return false;
+        }
+        return true;
+      }
+      return false;
+    });
+    if (calFilterCaregiver) filtered = filtered.filter(s => s.caregiver_id === calFilterCaregiver);
+    return filtered.sort((a, b) => (a.start_time || '').localeCompare(b.start_time || ''));
+  };
+
+  const getProspectApptsForDay = (day) => {
+    const dateStr = `${calCurrentDate.getFullYear()}-${String(calCurrentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
+    return prospectAppts.filter(a => a.appointment_date && a.appointment_date.split('T')[0] === dateStr);
+  };
+
+  // ═══════════════════════════════════════════════
+  // PROSPECTS
+  // ═══════════════════════════════════════════════
+
+  const createProspect = async () => {
+    if (!prospectForm.firstName || !prospectForm.lastName) { showMsg('Name required', 'error'); return; }
+    setProspectSaving(true);
+    try {
+      await api('/api/prospects', { method: 'POST', body: JSON.stringify(prospectForm) });
+      showMsg('Prospect added!'); setProspectForm({ firstName: '', lastName: '', phone: '', email: '', notes: '', source: '' });
+      setShowProspectForm(false); loadProspects();
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+    finally { setProspectSaving(false); }
+  };
+
+  const createProspectAppt = async () => {
+    if (!prospectApptForm.prospectId || !prospectApptForm.appointmentDate) { showMsg('Select prospect and date', 'error'); return; }
+    if (prospectApptForm.startTime >= prospectApptForm.endTime) { showMsg('End time must be after start', 'error'); return; }
+    setProspectSaving(true);
+    try {
+      await api('/api/prospect-appointments', { method: 'POST', body: JSON.stringify(prospectApptForm) });
+      showMsg('Appointment scheduled!'); setProspectApptForm({ prospectId: '', caregiverId: '', appointmentDate: '', startTime: '10:00', endTime: '11:00', appointmentType: 'assessment', location: '', notes: '' });
+      setShowProspectApptForm(false); loadProspectAppts();
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+    finally { setProspectSaving(false); }
+  };
+
+  const convertProspect = async (prospectId) => {
+    const _cok = await confirm('Convert this prospect to a full client?', {danger: true}); if (!_cok) return;
+    try {
+      const result = await api(`/api/prospects/${prospectId}/convert`, { method: 'POST' });
+      showMsg(`Converted: ${result.client.first_name} ${result.client.last_name}`);
+      loadProspects(); loadCoreData();
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  const deleteProspectAppt = async (id) => {
+    const _cok = await confirm('Cancel this appointment?', {danger: true}); if (!_cok) return;
+    try { await api(`/api/prospect-appointments/${id}`, { method: 'DELETE' }); showMsg('Cancelled'); loadProspectAppts(); }
+    catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  // ═══════════════════════════════════════════════
+  // OPEN SHIFTS
+  // ═══════════════════════════════════════════════
+
+  const createOpenShift = async (data) => {
+    try {
+      await api('/api/open-shifts', { method: 'POST', body: JSON.stringify(data) });
+      showMsg('Open shift posted!'); setShowCreateShift(false); setCreateShiftPreFill({}); loadOpenShifts();
+    } catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  const approveShiftClaim = async (shiftId, claimId) => {
+    try {
+      await api(`/api/open-shifts/${shiftId}/claims/${claimId}/approve`, { method: 'PUT' });
+      showMsg('Claim approved!'); setCurrentShift(null); loadOpenShifts();
+    } catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  const loadShiftClaims = async (shift) => {
+    try { const data = await api(`/api/open-shifts/${shift.id}/claims`); setShiftClaims(Array.isArray(data) ? data : []); setCurrentShift(shift); }
+    catch (e) { console.error(e); }
+  };
+
+  // ═══════════════════════════════════════════════
+  // STAFFING ACTIONS
+  // ═══════════════════════════════════════════════
+
+  const approveSwap = async (id) => {
+    const _cok = await confirm('Approve this shift swap?', {danger: true}); if (!_cok) return;
+    try { await api(`/api/shift-swaps/${id}/approve`, { method: 'PUT' }); loadSwaps(); }
+    catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  const rejectSwap = async (id) => {
+    const reason = prompt('Rejection reason (optional):');
+    try { await api(`/api/shift-swaps/${id}/reject`, { method: 'PUT', body: JSON.stringify({ reason }) }); loadSwaps(); }
+    catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  // WORKFLOW: After recording absence, find affected shifts and offer to post open shift
+  const recordAbsence = async (e) => {
+    e.preventDefault();
+    try {
+      await api('/api/absences', { method: 'POST', body: JSON.stringify(absenceForm) });
+      showMsg('Absence recorded!');
+      try {
+        const scheds = await api(`/api/schedules/caregiver/${absenceForm.caregiverId}`);
+        const absDate = new Date(absenceForm.date + 'T12:00:00');
+        const dow = absDate.getDay();
+        const affected = (Array.isArray(scheds) ? scheds : []).filter(s => {
+          if (s.date) return s.date.split('T')[0] === absenceForm.date;
+          if (s.day_of_week !== null && s.day_of_week !== undefined) return parseInt(s.day_of_week) === dow;
+          return false;
+        });
+        if (affected.length > 0) setPendingAbsenceShift({ date: absenceForm.date, schedules: affected });
+      } catch {}
+      setAbsenceForm({ caregiverId: '', date: '', type: 'call_out', reason: '' });
+      setShowAbsenceForm(false); loadAbsences();
+    } catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  const deleteAbsence = async (id) => {
+    const _cok = await confirm('Delete this absence?', {danger: true}); if (!_cok) return;
+    try { await api(`/api/absences/${id}`, { method: 'DELETE' }); loadAbsences(); }
+    catch (e) { showMsg('Failed: ' + e.message, 'error'); }
+  };
+
+  const postOpenShiftFromAbsence = (sched) => {
+    setCreateShiftPreFill({ clientId: sched.client_id, date: pendingAbsenceShift.date, start: sched.start_time?.slice(0,5) || '09:00', end: sched.end_time?.slice(0,5) || '13:00' });
+    setPendingAbsenceShift(null);
+    setShowCreateShift(true);
+  };
+
+  // ═══════════════════════════════════════════════
+  // AVAILABILITY ACTIONS
+  // ═══════════════════════════════════════════════
+
+  const loadAvailability = async (cgId) => {
+    setAvailCaregiver(cgId); if (!cgId) return;
+    try {
+      const [avail, boDates] = await Promise.all([
+        api(`/api/caregivers/${cgId}/availability`),
+        api(`/api/caregivers/${cgId}/blackout-dates`).catch(() => [])
+      ]);
+      if (avail) {
+        setAvailForm({
+          status: avail.status || 'available', maxHoursPerWeek: avail.max_hours_per_week || 40,
+          mondayAvailable: avail.monday_available !== false, mondayStartTime: avail.monday_start_time || '08:00', mondayEndTime: avail.monday_end_time || '17:00',
+          tuesdayAvailable: avail.tuesday_available !== false, tuesdayStartTime: avail.tuesday_start_time || '08:00', tuesdayEndTime: avail.tuesday_end_time || '17:00',
+          wednesdayAvailable: avail.wednesday_available !== false, wednesdayStartTime: avail.wednesday_start_time || '08:00', wednesdayEndTime: avail.wednesday_end_time || '17:00',
+          thursdayAvailable: avail.thursday_available !== false, thursdayStartTime: avail.thursday_start_time || '08:00', thursdayEndTime: avail.thursday_end_time || '17:00',
+          fridayAvailable: avail.friday_available !== false, fridayStartTime: avail.friday_start_time || '08:00', fridayEndTime: avail.friday_end_time || '17:00',
+          saturdayAvailable: avail.saturday_available || false, saturdayStartTime: avail.saturday_start_time || '08:00', saturdayEndTime: avail.saturday_end_time || '17:00',
+          sundayAvailable: avail.sunday_available || false, sundayStartTime: avail.sunday_start_time || '08:00', sundayEndTime: avail.sunday_end_time || '17:00',
+        });
+        setAvailData(avail);
+      }
+      setBlackoutDates(Array.isArray(boDates) ? boDates : []);
+    } catch (e) { console.error(e); }
+  };
+
+  const saveAvailability = async () => {
+    try { await api(`/api/caregivers/${availCaregiver}/availability`, { method: 'PUT', body: JSON.stringify(availForm) }); showMsg('Availability saved!'); }
+    catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  const addBlackout = async (e) => {
+    e.preventDefault();
+    try {
+      await api(`/api/caregivers/${availCaregiver}/blackout-dates`, { method: 'POST', body: JSON.stringify(newBlackout) });
+      showMsg('Blackout date added!'); setNewBlackout({ startDate: '', endDate: '', reason: '' }); setShowBlackoutForm(false); loadAvailability(availCaregiver);
+    } catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  const deleteBlackout = async (id) => {
+    const _cok = await confirm('Delete this blackout date?', {danger: true}); if (!_cok) return;
+    try { await api(`/api/blackout-dates/${id}`, { method: 'DELETE' }); loadAvailability(availCaregiver); }
+    catch (e) { showMsg('Error: ' + e.message, 'error'); }
+  };
+
+  // ═══════════════════════════════════════════════
+  // STYLE HELPERS
+  // ═══════════════════════════════════════════════
+
+  const pendingSwaps  = swaps.filter(sw => sw.status === 'accepted').length;
+  const bge           = (bg, color) => ({ display: 'inline-block', padding: '0.15rem 0.5rem', borderRadius: '999px', fontSize: '0.72rem', fontWeight: '700', background: bg, color });
+  const statCard      = { padding: '0.75rem', textAlign: 'center' };
+  const statVal       = (color) => ({ fontSize: '1.75rem', fontWeight: '800', color, lineHeight: 1 });
+  const statLabel     = { fontSize: '0.72rem', color: '#6B7280', marginTop: '0.25rem' };
+
+  const mainTabStyle = (active) => ({
+    padding: isMobile ? '0.6rem 0.75rem' : '0.65rem 1.25rem',
+    border: 'none', borderBottom: active ? '3px solid #0f766e' : '3px solid transparent',
+    background: 'none', cursor: 'pointer', fontSize: isMobile ? '0.82rem' : '0.9rem',
+    fontWeight: active ? '700' : '500', color: active ? '#0f766e' : '#6B7280',
+    transition: 'all 0.15s', whiteSpace: 'nowrap'
+  });
+
+  const subTabStyle = (active) => ({
+    padding: '0.4rem 0.85rem', borderRadius: '6px', border: 'none',
+    background: active ? '#0f766e' : '#F3F4F6', color: active ? '#fff' : '#374151',
+    cursor: 'pointer', fontSize: '0.82rem', fontWeight: active ? '600' : '400',
+    transition: 'all 0.15s', whiteSpace: 'nowrap'
+  });
+
+  const viewBtn = (active) => ({
+    padding: '0.35rem 0.75rem', border: '1px solid #E5E7EB', borderRadius: '6px',
+    background: active ? '#0f766e' : '#fff', color: active ? '#fff' : '#374151',
+    cursor: 'pointer', fontSize: '0.82rem', fontWeight: active ? '600' : '400'
+  });
+
+  // ═══════════════════════════════════════════════
+  // CREATE PANEL (slide-in from right)
+  // ═══════════════════════════════════════════════
+
+  // renderCreatePanel removed — full-page view handled inline in main render
+
+  // ═══════════════════════════════════════════════
+  // RENDER: SCHEDULE TAB
+  // ═══════════════════════════════════════════════
+
+  const renderScheduleTab = () => (
+    <div>
+      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
+        <div style={{ display: 'flex', gap: '0.35rem' }}>
+          <button style={viewBtn(scheduleView === 'grid')}  onClick={() => setScheduleView('grid')}>📋 Grid</button>
+          <button style={viewBtn(scheduleView === 'week')}  onClick={() => setScheduleView('week')}>📅 Week</button>
+          <button style={viewBtn(scheduleView === 'month')} onClick={() => setScheduleView('month')}>📆 Month</button>
+        </div>
+        {scheduleView === 'week' && (
+          <div style={{ display: 'flex', gap: '0.35rem', alignItems: 'center', marginLeft: 'auto' }}>
+            <button className='btn btn-secondary btn-sm' onClick={() => navigateWeek(-1)}>◀</button>
+            <strong style={{ fontSize: '0.88rem' }}>Week of {new Date(weekOf + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</strong>
+            <button className='btn btn-secondary btn-sm' onClick={() => navigateWeek(1)}>▶</button>
+            <button className='btn btn-sm btn-primary' onClick={() => setWeekOf(getWeekStart(new Date()).toISOString().split('T')[0])}>Today</button>
+            <AutoFillButton weekOf={weekOf} token={token} onComplete={loadWeekView} />
+          </div>
+        )}
+        {scheduleView === 'month' && (
+          <div style={{ display: 'flex', gap: '0.35rem', alignItems: 'center', marginLeft: 'auto' }}>
+            <button className='btn btn-secondary btn-sm' onClick={() => setCalCurrentDate(new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth() - 1))}>‹</button>
+            <strong style={{ fontSize: '0.88rem' }}>{calCurrentDate.toLocaleString('default', { month: 'long', year: 'numeric' })}</strong>
+            <button className='btn btn-secondary btn-sm' onClick={() => setCalCurrentDate(new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth() + 1))}>›</button>
+            <button className='btn btn-sm btn-primary' onClick={() => setCalCurrentDate(new Date())}>Today</button>
+            <select value={calFilterCaregiver} onChange={(e) => setCalFilterCaregiver(e.target.value)} style={{ padding: '0.3rem 0.5rem', borderRadius: '6px', border: '1px solid #ddd', fontSize: '0.82rem' }}>
+              <option value=''>All Caregivers</option>
+              {caregivers.map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}
+            </select>
+          </div>
+        )}
+        <button className='btn btn-primary' style={{ marginLeft: scheduleView === 'grid' ? 'auto' : '0', fontSize: '0.88rem' }} onClick={() => openCreatePanel()}>+ New Schedule</button>
+      </div>
+
+      {scheduleView === 'grid' && <DragDropScheduler token={token} onScheduleChange={() => {}} />}
+
+      {scheduleView === 'week' && (
+        <div>
+          <p style={{ fontSize: '0.82rem', color: '#6B7280', marginBottom: '0.75rem' }}>💡 Click a shift to reassign · Click an empty cell to add a schedule</p>
+          {weekData ? (
+            <div style={{ overflowX: 'auto' }}>
+              <table className='table' style={{ minWidth: '800px' }}>
+                <thead>
+                  <tr>
+                    <th style={{ width: '140px' }}>Caregiver</th>
+                    {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map((day, idx) => {
+                      const date = new Date(weekData.weekStart); date.setDate(date.getDate() + idx);
+                      const isToday = new Date().toDateString() === date.toDateString();
+                      return (<th key={day} style={{ textAlign: 'center', minWidth: '95px', background: isToday ? '#EFF6FF' : undefined }}><div>{day}</div><div style={{ fontSize: '0.72rem', color: isToday ? '#2563EB' : '#6B7280', fontWeight: isToday ? '700' : '400' }}>{date.getDate()}</div></th>);
+                    })}
+                  </tr>
+                </thead>
+                <tbody>
+                  {weekData.caregivers.map(({ caregiver, days: dayData }) => (
+                    <tr key={caregiver.id}>
+                      <td>
+                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>
+                          <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: cgColor(caregiver.id) }} />
+                          <strong style={{ fontSize: '0.85rem' }}>{caregiver.first_name} {caregiver.last_name?.[0]}.</strong>
+                        </div>
+                      </td>
+                      {[0,1,2,3,4,5,6].map(di => {
+                        const date = new Date(weekData.weekStart); date.setDate(date.getDate() + di);
+                        const isToday = new Date().toDateString() === date.toDateString();
+                        const dateStr = date.toISOString().split('T')[0];
+                        const hasShifts = dayData[di] && dayData[di].length > 0;
+                        return (
+                          <td key={di}
+                            onClick={() => !hasShifts && openCreatePanel({ caregiverId: caregiver.id, date: dateStr, dayOfWeek: di.toString() })}
+                            style={{ padding: '0.25rem', verticalAlign: 'top', background: isToday ? '#F0F9FF' : undefined, cursor: hasShifts ? 'default' : 'pointer' }}
+                            onMouseEnter={e => { if (!hasShifts) e.currentTarget.style.background = '#F0FDF4'; }}
+                            onMouseLeave={e => { e.currentTarget.style.background = isToday ? '#F0F9FF' : ''; }}>
+                            {hasShifts ? dayData[di].map(sched => (
+                              <div key={sched.id} onClick={(e) => { e.stopPropagation(); setReassignModal({ schedule: sched, currentCaregiver: caregiver }); }}
+                                style={{ fontSize: '0.7rem', padding: '0.25rem 0.4rem', marginBottom: '0.2rem', borderRadius: '4px', background: sched.isRecurring ? '#DBEAFE' : '#D1FAE5', borderLeft: `3px solid ${cgColor(caregiver.id)}`, cursor: 'pointer' }}
+                                title={`${getClientName(sched.client_id)} · ${formatTime(sched.start_time)}–${formatTime(sched.end_time)}`}>
+                                <div style={{ fontWeight: '600', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>{getClientName(sched.client_id).split(' ')[0]}</div>
+                                <div style={{ color: '#6B7280' }}>{formatTime(sched.start_time)}</div>
+                              </div>
+                            )) : (
+                              <div style={{ height: '40px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#D1D5DB', fontSize: '0.7rem' }}>+ add</div>
+                            )}
+                          </td>
+                        );
+                      })}
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            </div>
+          ) : <div className='card' style={{ textAlign: 'center', padding: '2rem' }}>Loading week view...</div>}
+        </div>
+      )}
+
+      {scheduleView === 'month' && (
+        <div>
+          <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem', flexWrap: 'wrap' }}>
+            <button className='btn btn-sm' onClick={() => setShowProspectApptForm(!showProspectApptForm)} style={{ background: '#F97316', color: '#fff', border: 'none' }}>{showProspectApptForm ? '✕ Cancel' : '+ Prospect Appt'}</button>
+            <button className='btn btn-sm' onClick={() => setShowProspectForm(!showProspectForm)} style={{ background: showProspectForm ? '#6B7280' : '#8B5CF6', color: '#fff', border: 'none' }}>{showProspectForm ? '✕ Cancel' : '+ New Prospect'}</button>
+          </div>
+          {showProspectForm && (
+            <div className='card' style={{ marginBottom: '1rem', border: '2px solid #8B5CF6', background: '#FAF5FF' }}>
+              <h4 style={{ margin: '0 0 0.75rem', color: '#6D28D9' }}>👤 Add Prospect</h4>
+              <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr', gap: '0.75rem' }}>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>First Name *</label><input value={prospectForm.firstName} onChange={(e) => setProspectForm(p => ({ ...p, firstName: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Last Name *</label><input value={prospectForm.lastName} onChange={(e) => setProspectForm(p => ({ ...p, lastName: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Phone</label><input value={prospectForm.phone} onChange={(e) => setProspectForm(p => ({ ...p, phone: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Source</label><input value={prospectForm.source} onChange={(e) => setProspectForm(p => ({ ...p, source: e.target.value }))} placeholder='Referral, website...' style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+              </div>
+              <div style={{ marginTop: '0.75rem' }}><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Notes</label><textarea value={prospectForm.notes} onChange={(e) => setProspectForm(p => ({ ...p, notes: e.target.value }))} rows={2} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd', resize: 'vertical' }} /></div>
+              <div style={{ marginTop: '0.75rem', display: 'flex', gap: '0.5rem' }}>
+                <button className='btn btn-primary btn-sm' onClick={createProspect} disabled={prospectSaving}>{prospectSaving ? 'Saving...' : '✓ Save Prospect'}</button>
+                <button className='btn btn-secondary btn-sm' onClick={() => setShowProspectForm(false)}>Cancel</button>
+              </div>
+            </div>
+          )}
+          {showProspectApptForm && (
+            <div className='card' style={{ marginBottom: '1rem', border: '2px solid #F97316', background: '#FFF7ED' }}>
+              <h4 style={{ margin: '0 0 0.75rem', color: '#C2410C' }}>📋 Schedule Prospect Appointment</h4>
+              <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr', gap: '0.75rem' }}>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Prospect *</label><select value={prospectApptForm.prospectId} onChange={(e) => setProspectApptForm(p => ({ ...p, prospectId: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }}><option value=''>Select prospect...</option>{prospects.filter(p => p.status === 'prospect').map(p => <option key={p.id} value={p.id}>{p.first_name} {p.last_name}</option>)}</select></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Date *</label><input type='date' value={prospectApptForm.appointmentDate} onChange={(e) => setProspectApptForm(p => ({ ...p, appointmentDate: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Start</label><input type='time' value={prospectApptForm.startTime} onChange={(e) => setProspectApptForm(p => ({ ...p, startTime: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>End</label><input type='time' value={prospectApptForm.endTime} onChange={(e) => setProspectApptForm(p => ({ ...p, endTime: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Type</label><select value={prospectApptForm.appointmentType} onChange={(e) => setProspectApptForm(p => ({ ...p, appointmentType: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }}><option value='assessment'>Assessment</option><option value='consultation'>Consultation</option><option value='intake'>Intake</option><option value='meet_greet'>Meet & Greet</option><option value='other'>Other</option></select></div>
+                <div><label style={{ display: 'block', marginBottom: '0.3rem', fontWeight: '600', fontSize: '0.85rem' }}>Caregiver (optional)</label><select value={prospectApptForm.caregiverId} onChange={(e) => setProspectApptForm(p => ({ ...p, caregiverId: e.target.value }))} style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }}><option value=''>None assigned</option>{caregivers.map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}</select></div>
+              </div>
+              <div style={{ marginTop: '0.75rem' }}><input value={prospectApptForm.location} onChange={(e) => setProspectApptForm(p => ({ ...p, location: e.target.value }))} placeholder='Location / notes' style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ddd' }} /></div>
+              <div style={{ marginTop: '0.75rem', display: 'flex', gap: '0.5rem' }}>
+                <button className='btn btn-primary btn-sm' onClick={createProspectAppt} disabled={prospectSaving} style={{ background: '#F97316', borderColor: '#F97316' }}>{prospectSaving ? 'Saving...' : '✓ Schedule'}</button>
+                <button className='btn btn-secondary btn-sm' onClick={() => setShowProspectApptForm(false)}>Cancel</button>
+              </div>
+            </div>
+          )}
+          {prospects.filter(p => p.status === 'prospect').length > 0 && (
+            <div className='card' style={{ marginBottom: '1rem', padding: '0.75rem' }}>
+              <h4 style={{ margin: '0 0 0.5rem', fontSize: '0.9rem', color: '#6D28D9' }}>👤 Active Prospects ({prospects.filter(p => p.status === 'prospect').length})</h4>
+              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
+                {prospects.filter(p => p.status === 'prospect').map(p => (
+                  <div key={p.id} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.3rem 0.75rem', background: '#FAF5FF', border: '1px solid #DDD6FE', borderRadius: '20px', fontSize: '0.82rem' }}>
+                    <span style={{ fontWeight: '600' }}>{p.first_name} {p.last_name}</span>
+                    {p.phone && <span style={{ color: '#6B7280' }}>{p.phone}</span>}
+                    <button onClick={() => convertProspect(p.id)} style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '0.78rem', color: '#059669' }} title='Convert to Client'>✅</button>
+                  </div>
+                ))}
+              </div>
+            </div>
+          )}
+          <div className='card'>
+            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: '1px', background: '#E5E7EB' }}>
+              {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d => <div key={d} style={{ padding: '0.5rem', textAlign: 'center', fontWeight: '600', fontSize: '0.8rem', background: '#F9FAFB', color: '#374151' }}>{d}</div>)}
+              {Array.from({ length: calFirstDay }, (_, i) => <div key={`e${i}`} style={{ background: '#FAFAFA', minHeight: isMobile ? '50px' : '80px' }} />)}
+              {Array.from({ length: calDaysInMonth }, (_, i) => {
+                const day = i + 1, today = new Date();
+                const isToday = day === today.getDate() && calCurrentDate.getMonth() === today.getMonth() && calCurrentDate.getFullYear() === today.getFullYear();
+                const dayScheds = getCalSchedulesForDay(day);
+                const dayProspectAppts = getProspectApptsForDay(day);
+                return (
+                  <div key={day} onClick={() => { setCalDaySchedules(dayScheds); setCalSelectedDay(day); }}
+                    style={{ background: isToday ? '#EFF6FF' : '#fff', minHeight: isMobile ? '50px' : '80px', padding: '0.25rem', cursor: 'pointer' }}>
+                    <div style={{ fontSize: '0.78rem', fontWeight: isToday ? '700' : '400', color: isToday ? '#2563EB' : '#374151', marginBottom: '0.2rem' }}>{day}</div>
+                    {dayScheds.slice(0, isMobile ? 1 : 2).map((sc, idx) => (
+                      <div key={idx} style={{ fontSize: '0.62rem', padding: '0.1rem 0.2rem', marginBottom: '1px', borderRadius: '2px', background: cgColor(sc.caregiver_id) + '20', borderLeft: `2px solid ${cgColor(sc.caregiver_id)}`, whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                        {isMobile ? formatTime(sc.start_time) : `${getCaregiverName(sc.caregiver_id).split(' ')[0]} ${formatTime(sc.start_time)}`}
+                      </div>
+                    ))}
+                    {dayProspectAppts.map((pa, idx) => <div key={`pa${idx}`} style={{ fontSize: '0.62rem', padding: '0.1rem 0.2rem', marginBottom: '1px', borderRadius: '2px', background: '#FFF7ED', borderLeft: '2px solid #F97316', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis', color: '#9A3412' }}>{isMobile ? '🟠' : `🟠 ${pa.prospect_first_name}`}</div>)}
+                    {(dayScheds.length + dayProspectAppts.length) > (isMobile ? 1 : 3) && <div style={{ fontSize: '0.6rem', color: '#6B7280', textAlign: 'center' }}>+{(dayScheds.length + dayProspectAppts.length) - (isMobile ? 1 : 3)} more</div>}
+                  </div>
+                );
+              })}
+            </div>
+          </div>
+          <div className='card' style={{ marginTop: '0.75rem' }}>
+            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.75rem', alignItems: 'center' }}>
+              {caregivers.map(cg => (
+                <div key={cg.id} onClick={() => setCalFilterCaregiver(calFilterCaregiver === cg.id ? '' : cg.id)}
+                  style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', cursor: 'pointer', padding: '0.2rem 0.5rem', borderRadius: '6px', background: calFilterCaregiver === cg.id ? '#E5E7EB' : 'transparent' }}>
+                  <div style={{ width: '10px', height: '10px', borderRadius: '3px', background: cgColor(cg.id) }} />
+                  <span style={{ fontSize: '0.82rem' }}>{cg.first_name} {cg.last_name}</span>
+                </div>
+              ))}
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}><div style={{ width: '10px', height: '10px', borderRadius: '3px', background: '#F97316' }} /><span style={{ fontSize: '0.82rem', color: '#9A3412' }}>Prospect</span></div>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+
+  // ═══════════════════════════════════════════════
+  // RENDER: TOOLS TAB
+  // ═══════════════════════════════════════════════
+
+  const renderToolsTab = () => (
+    <div>
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
+        <button style={subTabStyle(toolsTab === 'coverage')}  onClick={() => setToolsTab('coverage')}>📈 Coverage</button>
+        <button style={subTabStyle(toolsTab === 'optimizer')} onClick={() => setToolsTab('optimizer')}>🧠 Optimizer</button>
+        <button style={subTabStyle(toolsTab === 'roster')}    onClick={() => setToolsTab('roster')}>📊 Roster Optimizer</button>
+      </div>
+
+      {toolsTab === 'coverage' && (
+        <div>
+          <div className='card' style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', flexWrap: 'wrap', marginBottom: '1rem', padding: '1rem' }}>
+            <h3 style={{ margin: 0 }}>📈 Coverage Overview</h3>
+            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginLeft: 'auto' }}>
+              <button className='btn btn-sm btn-secondary' onClick={() => { const d = new Date(coverageWeekOf + 'T12:00:00'); d.setDate(d.getDate() - 7); setCoverageWeekOf(getWeekStart(d).toISOString().split('T')[0]); }}>◀ Prev</button>
+              <input type='date' value={coverageWeekOf} onChange={(e) => setCoverageWeekOf(getWeekStart(new Date(e.target.value + 'T12:00:00')).toISOString().split('T')[0])} style={{ padding: '0.3rem 0.5rem', border: '1px solid #ddd', borderRadius: '6px', fontSize: '0.85rem' }} />
+              <button className='btn btn-sm btn-secondary' onClick={() => { const d = new Date(coverageWeekOf + 'T12:00:00'); d.setDate(d.getDate() + 7); setCoverageWeekOf(getWeekStart(d).toISOString().split('T')[0]); }}>Next ▶</button>
+              <button className='btn btn-sm btn-primary' onClick={() => setCoverageWeekOf(getWeekStart(new Date()).toISOString().split('T')[0])}>Today</button>
+            </div>
+          </div>
+          {coverageLoading ? <div className='card' style={{ textAlign: 'center', padding: '2rem' }}>Loading...</div> : coverageData ? (
+            <>
+              <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr 1fr' : 'repeat(4, 1fr)', gap: '0.75rem', marginBottom: '1rem' }}>
+                <div className='card' style={statCard}><div style={statVal('#2563EB')}>{coverageData.summary.totalCaregivers}</div><div style={statLabel}>Active Caregivers</div></div>
+                <div className='card' style={statCard}><div style={statVal('#059669')}>{coverageData.summary.totalScheduledHours}h</div><div style={statLabel}>Scheduled</div></div>
+                <div className='card' style={statCard}><div style={statVal(coverageData.summary.underScheduledClientCount > 0 ? '#DC2626' : '#059669')}>{coverageData.summary.underScheduledClientCount}</div><div style={statLabel}>Under-Scheduled</div></div>
+                <div className='card' style={statCard}><div style={statVal(coverageData.summary.totalShortfallUnits > 0 ? '#DC2626' : '#059669')}>{coverageData.summary.totalShortfallUnits}u</div><div style={statLabel}>Shortfall ({coverageData.summary.totalShortfallHours}h)</div></div>
+              </div>
+              <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr', gap: '1rem' }}>
+                <div className='card'>
+                  <h3 style={{ margin: '0 0 0.75rem' }}>👥 Caregiver Hours</h3>
+                  <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
+                    {coverageData.caregivers.map(cg => (
+                      <div key={cg.id} style={{ padding: '0.6rem', borderBottom: '1px solid #eee', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
+                        <div style={{ flex: 1 }}><div style={{ fontWeight: '600', fontSize: '0.88rem' }}>{cg.name}</div><div style={{ fontSize: '0.78rem', color: '#666' }}>{parseFloat(cg.scheduledHours || 0).toFixed(2)}h / {cg.maxHours}h</div></div>
+                        <div style={{ width: '90px' }}><div style={{ height: '7px', background: '#E5E7EB', borderRadius: '4px', overflow: 'hidden' }}><div style={{ width: `${Math.min(cg.utilizationPercent, 100)}%`, height: '100%', background: cg.utilizationPercent > 100 ? '#DC2626' : cg.utilizationPercent > 80 ? '#F59E0B' : '#10B981' }} /></div></div>
+                        <div style={{ minWidth: '40px', textAlign: 'right', fontWeight: '600', fontSize: '0.82rem', color: cg.utilizationPercent > 100 ? '#DC2626' : cg.utilizationPercent > 80 ? '#F59E0B' : '#10B981' }}>{cg.utilizationPercent}%</div>
+                      </div>
+                    ))}
+                  </div>
+                </div>
+                <div className='card'>
+                  <h3 style={{ margin: '0 0 0.75rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                    ⚠️ Under-Scheduled {coverageData.underScheduledClients.length > 0 && <span style={bge('#FEE2E2', '#DC2626')}>{coverageData.underScheduledClients.length}</span>}
+                  </h3>
+                  {coverageData.underScheduledClients.length === 0 ? (
+                    <div style={{ textAlign: 'center', padding: '2rem', color: '#059669' }}>✅ All clients fully scheduled!</div>
+                  ) : (
+                    <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
+                      {coverageData.underScheduledClients.map(cl => (
+                        <div key={cl.id} style={{ padding: '0.6rem', borderBottom: '1px solid #eee', background: '#FEF2F2' }}>
+                          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                            <div><div style={{ fontWeight: '600', fontSize: '0.88rem' }}>{cl.name}</div><div style={{ fontSize: '0.78rem', color: '#666' }}>{cl.scheduledUnits}/{cl.authorizedUnits} units</div></div>
+                            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+                              <span style={bge('#DC2626', '#fff')}>-{cl.shortfallUnits}u</span>
+                              {/* WORKFLOW: Fix It navigates to Schedule + opens create panel pre-filled */}
+                              <button onClick={() => { setMainTab('schedule'); setScheduleView('week'); openCreatePanel({ clientId: cl.id }); }}
+                                style={{ padding: '0.25rem 0.6rem', borderRadius: '6px', border: 'none', background: '#059669', color: '#fff', cursor: 'pointer', fontSize: '0.75rem', fontWeight: '700', whiteSpace: 'nowrap' }}>
+                                Fix It →
+                              </button>
+                            </div>
+                          </div>
+                          <div style={{ height: '5px', background: '#FECACA', borderRadius: '3px', overflow: 'hidden', marginTop: '0.4rem' }}><div style={{ width: `${cl.coveragePercent}%`, height: '100%', background: '#DC2626' }} /></div>
+                          <div style={{ fontSize: '0.7rem', color: '#666', marginTop: '0.2rem' }}>{cl.coveragePercent}%</div>
+                        </div>
+                      ))}
+                    </div>
+                  )}
+                </div>
+              </div>
+            </>
+          ) : <div className='card' style={{ textAlign: 'center', padding: '2rem' }}>Failed to load. <button className='btn btn-sm btn-primary' onClick={loadCoverage}>Retry</button></div>}
+        </div>
+      )}
+
+      {toolsTab === 'optimizer' && <ScheduleOptimizer token={token} caregivers={caregivers} clients={clients} />}
+      {toolsTab === 'roster'    && <RosterOptimizer token={token} />}
+    </div>
+  );
+
+  // ═══════════════════════════════════════════════
+  // RENDER: STAFFING TAB
+  // ═══════════════════════════════════════════════
+
+  const renderStaffingTab = () => (
+    <div>
+      <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem', flexWrap: 'wrap' }}>
+        <button style={subTabStyle(staffingTab === 'open-shifts')} onClick={() => setStaffingTab('open-shifts')}>🚨 Open Shifts</button>
+        <button style={subTabStyle(staffingTab === 'swaps')} onClick={() => setStaffingTab('swaps')}>
+          🔄 Swaps & Absences {pendingSwaps > 0 && <span style={{ ...bge('#DC2626', '#fff'), marginLeft: '0.4rem' }}>{pendingSwaps}</span>}
+        </button>
+        <button style={subTabStyle(staffingTab === 'availability')} onClick={() => setStaffingTab('availability')}>⏰ Availability</button>
+      </div>
+
+      {staffingTab === 'open-shifts' && (
+        <div>
+          <div style={{ display: 'flex', gap: '0.75rem', alignItems: 'center', flexWrap: 'wrap', marginBottom: '1rem' }}>
+            <select value={openShiftFilter} onChange={(e) => setOpenShiftFilter(e.target.value)} style={{ padding: '0.4rem 0.75rem', borderRadius: '6px', border: '1px solid #ddd' }}>
+              <option value='open'>Open</option><option value='claimed'>Claimed</option><option value='filled'>Filled</option><option value=''>All</option>
+            </select>
+            <button className='btn btn-primary btn-sm' onClick={() => { setCreateShiftPreFill({}); setShowCreateShift(true); }}>+ Post Open Shift</button>
+          </div>
+          {openShiftsLoading ? <div className='card' style={{ textAlign: 'center', padding: '2rem' }}>Loading...</div> :
+            openShifts.length === 0 ? <div className='card' style={{ textAlign: 'center', padding: '2rem', color: '#6B7280' }}><div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>✅</div>No {openShiftFilter || ''} open shifts</div> : (
+            <div style={{ display: 'grid', gap: '0.75rem' }}>
+              {openShifts.map(shift => (
+                <div key={shift.id} className='card' style={{ padding: '1rem' }}>
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '0.5rem' }}>
+                    <div>
+                      <strong>{shift.client_first || ''} {shift.client_last || ''}</strong>
+                      <div style={{ fontSize: '0.85rem', color: '#666' }}>{shift.shift_date ? new Date(shift.shift_date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) : ''} · {formatTime(shift.start_time)} – {formatTime(shift.end_time)}</div>
+                      {shift.notes && <div style={{ fontSize: '0.82rem', color: '#888', marginTop: '0.3rem' }}>{shift.notes}</div>}
+                    </div>
+                    <div style={{ display: 'flex', gap: '0.4rem', alignItems: 'center' }}>
+                      <span style={bge(shift.status === 'open' ? '#FEF3C7' : shift.status === 'claimed' ? '#DBEAFE' : '#D1FAE5', shift.status === 'open' ? '#D97706' : shift.status === 'claimed' ? '#2563EB' : '#059669')}>{shift.status?.toUpperCase()}</span>
+                      {shift.urgency === 'urgent' && <span style={bge('#FEE2E2', '#DC2626')}>URGENT</span>}
+                      {(shift.claim_count > 0 || shift.claims_count > 0) && <button className='btn btn-sm btn-secondary' onClick={() => loadShiftClaims(shift)}>{shift.claim_count || shift.claims_count} claim(s)</button>}
+                    </div>
+                  </div>
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+
+      {staffingTab === 'swaps' && (
+        <div>
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem', flexWrap: 'wrap', gap: '0.5rem' }}>
+            <h3 style={{ margin: 0 }}>🔄 Shift Swaps</h3>
+            <div style={{ display: 'flex', gap: '0.4rem' }}>
+              {['', 'pending', 'accepted', 'approved', 'rejected'].map(f => (
+                <button key={f} className={`btn btn-sm ${swapFilter === f ? 'btn-primary' : 'btn-secondary'}`} onClick={() => setSwapFilter(f)}>{f ? f.charAt(0).toUpperCase() + f.slice(1) : 'All'}</button>
+              ))}
+            </div>
+          </div>
+          {swapsLoading ? <div className='card' style={{ textAlign: 'center', padding: '1.5rem' }}>Loading...</div> :
+            swaps.length === 0 ? <div className='card' style={{ textAlign: 'center', padding: '1.5rem', color: '#6B7280' }}>No swap requests found</div> : (
+            <div className='card' style={{ overflowX: 'auto', marginBottom: '1.5rem' }}>
+              <table className='table' style={{ fontSize: '0.88rem' }}>
+                <thead><tr><th>Date</th><th>Time</th><th>Client</th><th>From</th><th>→</th><th>To</th><th>Status</th><th>Actions</th></tr></thead>
+                <tbody>
+                  {swaps.map(sw => (
+                    <tr key={sw.id}>
+                      <td><strong>{sw.shift_date ? new Date(sw.shift_date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) : ''}</strong></td>
+                      <td>{sw.start_time?.slice(0,5)}–{sw.end_time?.slice(0,5)}</td>
+                      <td>{sw.client_first} {sw.client_last}</td>
+                      <td><strong>{sw.requester_first} {sw.requester_last}</strong></td>
+                      <td>→</td>
+                      <td>{sw.target_first ? <strong>{sw.target_first} {sw.target_last}</strong> : <em style={{ color: '#666' }}>Open</em>}</td>
+                      <td><span style={bge(sw.status==='pending'?'#FEF3C7':sw.status==='accepted'?'#DBEAFE':sw.status==='approved'?'#D1FAE5':'#FEE2E2', sw.status==='pending'?'#D97706':sw.status==='accepted'?'#2563EB':sw.status==='approved'?'#059669':'#DC2626')}>{sw.status?.toUpperCase()}</span></td>
+                      <td>{sw.status === 'accepted' && <div style={{ display: 'flex', gap: '0.25rem' }}><button className='btn btn-sm btn-success' onClick={() => approveSwap(sw.id)}>✓</button><button className='btn btn-sm btn-danger' onClick={() => rejectSwap(sw.id)}>✗</button></div>}</td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            </div>
+          )}
+
+          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
+            <h3 style={{ margin: 0 }}>📋 Absences</h3>
+            <button className='btn btn-primary btn-sm' onClick={() => setShowAbsenceForm(!showAbsenceForm)}>{showAbsenceForm ? '✕ Cancel' : '+ Record Absence'}</button>
+          </div>
+          {showAbsenceForm && (
+            <div className='card' style={{ marginBottom: '1rem' }}>
+              <form onSubmit={recordAbsence}>
+                <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr 1fr', gap: '0.75rem' }}>
+                  <div className='form-group'><label>Caregiver *</label><select value={absenceForm.caregiverId} onChange={(e) => setAbsenceForm({ ...absenceForm, caregiverId: e.target.value })} required><option value=''>Select...</option>{caregivers.map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}</select></div>
+                  <div className='form-group'><label>Date *</label><input type='date' value={absenceForm.date} onChange={(e) => setAbsenceForm({ ...absenceForm, date: e.target.value })} required /></div>
+                  <div className='form-group'><label>Type</label><select value={absenceForm.type} onChange={(e) => setAbsenceForm({ ...absenceForm, type: e.target.value })}><option value='call_out'>Call Out</option><option value='no_show'>No Show</option><option value='sick'>Sick</option><option value='personal'>Personal</option></select></div>
+                </div>
+                <div className='form-group'><label>Reason</label><textarea value={absenceForm.reason} onChange={(e) => setAbsenceForm({ ...absenceForm, reason: e.target.value })} rows={2} /></div>
+                <button type='submit' className='btn btn-primary btn-sm'>Record Absence</button>
+              </form>
+            </div>
+          )}
+
+          {/* WORKFLOW: After absence, offer to post open shift for each affected client */}
+          {pendingAbsenceShift && (
+            <div className='card' style={{ marginBottom: '1rem', border: '2px solid #F59E0B', background: '#FFFBEB' }}>
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                <div style={{ flex: 1 }}>
+                  <div style={{ fontWeight: '700', color: '#92400E', marginBottom: '0.5rem' }}>⚠️ Absence recorded — these clients need coverage:</div>
+                  {pendingAbsenceShift.schedules.map((sched, i) => (
+                    <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '0.5rem', background: '#FEF3C7', borderRadius: '6px', marginBottom: '0.35rem' }}>
+                      <div style={{ flex: 1, fontSize: '0.88rem' }}>
+                        <strong>{getClientName(sched.client_id)}</strong>
+                        <span style={{ color: '#6B7280', marginLeft: '0.5rem' }}>{formatTime(sched.start_time)} – {formatTime(sched.end_time)}</span>
+                        <span style={{ color: '#6B7280', marginLeft: '0.5rem' }}>{new Date(pendingAbsenceShift.date + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</span>
+                      </div>
+                      <button onClick={() => postOpenShiftFromAbsence(sched)} style={{ padding: '0.35rem 0.75rem', borderRadius: '6px', border: 'none', background: '#D97706', color: '#fff', cursor: 'pointer', fontSize: '0.8rem', fontWeight: '700', whiteSpace: 'nowrap' }}>Post Open Shift →</button>
+                    </div>
+                  ))}
+                </div>
+                <button onClick={() => setPendingAbsenceShift(null)} style={{ background: 'none', border: 'none', color: '#9CA3AF', cursor: 'pointer', fontSize: '1.2rem', marginLeft: '0.5rem' }}>×</button>
+              </div>
+            </div>
+          )}
+
+          {absencesLoading ? <div className='card' style={{ textAlign: 'center', padding: '1.5rem' }}>Loading...</div> :
+            absences.length === 0 ? <div className='card' style={{ textAlign: 'center', padding: '1.5rem', color: '#6B7280' }}>No absences recorded</div> : (
+            <div className='card' style={{ overflowX: 'auto' }}>
+              <table className='table' style={{ fontSize: '0.88rem' }}>
+                <thead><tr><th>Caregiver</th><th>Date</th><th>Type</th><th>Reason</th><th>Actions</th></tr></thead>
+                <tbody>
+                  {absences.map(ab => (
+                    <tr key={ab.id}>
+                      <td><strong>{getCaregiverName(ab.caregiver_id)}</strong></td>
+                      <td>{new Date(ab.date).toLocaleDateString()}</td>
+                      <td><span style={bge(ab.type==='no_show'?'#FEE2E2':ab.type==='sick'?'#DBEAFE':'#FEF3C7', ab.type==='no_show'?'#DC2626':ab.type==='sick'?'#2563EB':'#D97706')}>{ab.type?.replace('_', ' ').toUpperCase()}</span></td>
+                      <td>{ab.reason || '—'}</td>
+                      <td><button className='btn btn-sm btn-danger' onClick={() => deleteAbsence(ab.id)}>Delete</button></td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            </div>
+          )}
+        </div>
+      )}
+
+      {staffingTab === 'availability' && (
+        <div>
+          <div className='card' style={{ marginBottom: '1rem' }}>
+            <h3 style={{ margin: '0 0 0.75rem' }}>Caregiver Availability</h3>
+            <select value={availCaregiver} onChange={(e) => loadAvailability(e.target.value)} style={{ width: '100%', padding: '0.6rem', fontSize: '0.95rem', borderRadius: '6px', border: '1px solid #ddd' }}>
+              <option value=''>Select a caregiver...</option>
+              {caregivers.map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}
+            </select>
+          </div>
+          {availCaregiver && (
+            <>
+              <div className='card' style={{ marginBottom: '1rem' }}>
+                <h3 style={{ margin: '0 0 0.75rem' }}>Status & Capacity</h3>
+                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem' }}>
+                  <div className='form-group'><label>Status</label><select value={availForm.status} onChange={(e) => setAvailForm({ ...availForm, status: e.target.value })}><option value='available'>Available</option><option value='on_call'>On-Call</option><option value='medical_leave'>Medical Leave</option><option value='vacation'>Vacation</option><option value='unavailable'>Unavailable</option></select></div>
+                  <div className='form-group'><label>Max Hours/Week</label><input type='number' value={availForm.maxHoursPerWeek} onChange={(e) => setAvailForm({ ...availForm, maxHoursPerWeek: parseInt(e.target.value) })} min='0' step='5' /></div>
+                </div>
+              </div>
+              <div className='card' style={{ marginBottom: '1rem' }}>
+                <h3 style={{ margin: '0 0 0.75rem' }}>Weekly Schedule</h3>
+                <div style={{ display: 'grid', gap: '0.5rem' }}>
+                  {daysOfWeek.map(day => {
+                    const avKey = `${day.key}Available`, stKey = `${day.key}StartTime`, enKey = `${day.key}EndTime`;
+                    return (
+                      <div key={day.key} style={{ padding: '0.6rem 0.75rem', background: availForm[avKey] ? '#F0FDF4' : '#FAFAFA', borderRadius: '6px', border: `1px solid ${availForm[avKey] ? '#BBF7D0' : '#E5E7EB'}` }}>
+                        <label style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', cursor: 'pointer', marginBottom: availForm[avKey] ? '0.5rem' : 0 }}>
+                          <input type='checkbox' checked={availForm[avKey]} onChange={(e) => setAvailForm({ ...availForm, [avKey]: e.target.checked })} style={{ width: 'auto' }} />
+                          <strong style={{ minWidth: '40px' }}>{day.label}</strong>
+                          {!availForm[avKey] && <span style={{ fontSize: '0.82rem', color: '#999' }}>Off</span>}
+                        </label>
+                        {availForm[avKey] && (
+                          <div style={{ display: 'flex', gap: '0.5rem', marginLeft: '2rem' }}>
+                            <input type='time' value={availForm[stKey]} onChange={(e) => setAvailForm({ ...availForm, [stKey]: e.target.value })} style={{ padding: '0.3rem', borderRadius: '4px', border: '1px solid #ddd' }} />
+                            <span style={{ alignSelf: 'center' }}>to</span>
+                            <input type='time' value={availForm[enKey]} onChange={(e) => setAvailForm({ ...availForm, [enKey]: e.target.value })} style={{ padding: '0.3rem', borderRadius: '4px', border: '1px solid #ddd' }} />
+                          </div>
+                        )}
+                      </div>
+                    );
+                  })}
+                </div>
+                <button className='btn btn-primary' onClick={saveAvailability} style={{ marginTop: '1rem' }}>Save Availability</button>
+              </div>
+              <div className='card'>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>
+                  <h3 style={{ margin: 0 }}>🚫 Blackout Dates</h3>
+                  <button className='btn btn-sm btn-primary' onClick={() => setShowBlackoutForm(!showBlackoutForm)}>{showBlackoutForm ? 'Cancel' : '+ Add'}</button>
+                </div>
+                {showBlackoutForm && (
+                  <form onSubmit={addBlackout} style={{ marginBottom: '1rem', paddingBottom: '1rem', borderBottom: '1px solid #eee' }}>
+                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}>
+                      <div className='form-group'><label>Start *</label><input type='date' value={newBlackout.startDate} onChange={(e) => setNewBlackout({ ...newBlackout, startDate: e.target.value })} required /></div>
+                      <div className='form-group'><label>End *</label><input type='date' value={newBlackout.endDate} onChange={(e) => setNewBlackout({ ...newBlackout, endDate: e.target.value })} required /></div>
+                    </div>
+                    <div className='form-group'><label>Reason</label><input type='text' value={newBlackout.reason} onChange={(e) => setNewBlackout({ ...newBlackout, reason: e.target.value })} placeholder='e.g., Vacation' /></div>
+                    <button type='submit' className='btn btn-primary btn-sm'>Add Blackout</button>
+                  </form>
+                )}
+                {blackoutDates.length === 0 ? <p style={{ color: '#999', textAlign: 'center', padding: '0.75rem' }}>No blackout dates</p> : (
+                  <div style={{ display: 'grid', gap: '0.5rem' }}>
+                    {blackoutDates.sort((a, b) => new Date(a.start_date) - new Date(b.start_date)).map(bd => (
+                      <div key={bd.id} style={{ padding: '0.6rem 0.75rem', background: '#FEF2F2', borderLeft: '3px solid #DC2626', borderRadius: '4px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                        <div><strong style={{ fontSize: '0.88rem' }}>{new Date(bd.start_date).toLocaleDateString()} – {new Date(bd.end_date).toLocaleDateString()}</strong>{bd.reason && <div style={{ fontSize: '0.82rem', color: '#666' }}>{bd.reason}</div>}</div>
+                        <button className='btn btn-sm btn-danger' onClick={() => deleteBlackout(bd.id)}>Delete</button>
+                      </div>
+                    ))}
+                  </div>
+                )}
+              </div>
+            </>
+          )}
+        </div>
+      )}
+    </div>
+  );
+
+  // ═══════════════════════════════════════════════
+  // MAIN RENDER
+  // ═══════════════════════════════════════════════
+
+  if (loading) return <div className='loading'><div className='spinner'></div></div>;
+
+  // ── When createPanelOpen: replace entire page with the create form ──
+  if (createPanelOpen) {
+    const { recurringByDay, oneTimeByDate } = groupSchedules();
+    return (
+      <>
+        {message.text && (
+          <div style={{ position: 'fixed', top: '1rem', right: '1rem', padding: '0.75rem 1.25rem', borderRadius: '8px', zIndex: 2000, background: message.type === 'error' ? '#FEE2E2' : '#D1FAE5', color: message.type === 'error' ? '#DC2626' : '#059669', boxShadow: '0 4px 12px rgba(0,0,0,0.15)', fontWeight: '600' }}>{message.text}</div>
+        )}
+
+        {/* Back button + page title */}
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1.5rem', paddingBottom: '1rem', borderBottom: '2px solid #E5E7EB' }}>
+          <button onClick={closeCreatePanel} style={{ background: '#F3F4F6', border: 'none', borderRadius: '8px', padding: '0.5rem 0.85rem', cursor: 'pointer', fontSize: '0.9rem', fontWeight: '600', color: '#374151' }}>← Back</button>
+          <h2 style={{ margin: 0 }}>➕ New Schedule</h2>
+        </div>
+
+        {/* Two-column body */}
+        <div style={{ display: 'flex', gap: '2.5rem', alignItems: 'flex-start' }}>
+
+          {/* LEFT — form (fixed 480px) */}
+          <div style={{ flex: '0 0 480px', minWidth: 0 }}>
+
+            <div style={{ marginBottom: '1rem' }}>
+              <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Caregiver *</label>
+              <select value={selectedCaregiverId} onChange={(e) => handleCaregiverSelectCreate(e.target.value)}
+                style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }}>
+                <option value=''>Choose a caregiver...</option>
+                {caregivers.map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}
+              </select>
+            </div>
+
+            {conflicts.length > 0 && (
+              <div style={{ marginBottom: '1rem', padding: '0.75rem', background: '#FEF2F2', border: '1px solid #FCA5A5', borderRadius: '8px' }}>
+                <div style={{ fontWeight: '700', color: '#991B1B', marginBottom: '0.35rem' }}>⚠️ Existing Conflicts</div>
+                {conflicts.map((c, i) => <div key={i} style={{ fontSize: '0.82rem', color: '#B91C1C' }}>{getDayName(c.day)}: overlapping shifts</div>)}
+              </div>
+            )}
+
+            {selectedCaregiverId && (
+              <form onSubmit={handleCreateSubmit}>
+                <div style={{ marginBottom: '1rem' }}>
+                  <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Type</label>
+                  <div style={{ display: 'flex', borderRadius: '8px', overflow: 'hidden', border: '2px solid #E5E7EB' }}>
+                    {[{ type: 'one-time', icon: '📅', label: 'One-Time' }, { type: 'multi-day', icon: '📆', label: 'Multi-Day' }, { type: 'recurring', icon: '🔄', label: 'Recurring' }, { type: 'bi-weekly', icon: '📊', label: 'Bi-Weekly' }].map((opt, i) => (
+                      <button key={opt.type} type='button' onClick={() => { setFormData(prev => ({ ...prev, scheduleType: opt.type, dayOfWeek: '' })); setSelectedDays([]); }}
+                        style={{ flex: 1, padding: '0.6rem 0.2rem', border: 'none', borderLeft: i > 0 ? '2px solid #E5E7EB' : 'none',
+                          background: formData.scheduleType === opt.type ? '#3B82F6' : '#fff',
+                          color: formData.scheduleType === opt.type ? '#fff' : '#374151', cursor: 'pointer', fontSize: '0.78rem' }}>
+                        {opt.icon} {opt.label}
+                      </button>
+                    ))}
+                  </div>
+                </div>
+
+                {formData.scheduleType === 'one-time' && (
+                  <div style={{ marginBottom: '1rem' }}>
+                    <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Date *</label>
+                    <input type='date' value={formData.date} onChange={(e) => setFormData(prev => ({ ...prev, date: e.target.value }))} min={new Date().toISOString().split('T')[0]} required style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} />
+                  </div>
+                )}
+
+                {(formData.scheduleType === 'multi-day' || formData.scheduleType === 'bi-weekly') && (
+                  <div style={{ marginBottom: '1rem', background: formData.scheduleType === 'bi-weekly' ? '#FFF7ED' : '#EFF6FF', padding: '0.85rem', borderRadius: '8px', border: `1px solid ${formData.scheduleType === 'bi-weekly' ? '#FED7AA' : '#BFDBFE'}` }}>
+                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>
+                      <label style={{ fontWeight: '600', margin: 0, fontSize: '0.9rem' }}>{formData.scheduleType === 'bi-weekly' ? 'Days (Every Other Week) *' : 'Select Days *'}</label>
+                      <div style={{ display: 'flex', gap: '0.4rem' }}>
+                        <button type='button' onClick={selectWeekdays} style={{ padding: '0.25rem 0.6rem', borderRadius: '4px', border: 'none', background: formData.scheduleType === 'bi-weekly' ? '#F97316' : '#3B82F6', color: '#fff', cursor: 'pointer', fontSize: '0.72rem' }}>Mon–Fri</button>
+                        <button type='button' onClick={clearDays} style={{ padding: '0.25rem 0.6rem', borderRadius: '4px', border: '1px solid #D1D5DB', background: '#fff', color: '#6B7280', cursor: 'pointer', fontSize: '0.72rem' }}>Clear</button>
+                      </div>
+                    </div>
+                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: '0.35rem', marginBottom: '0.5rem' }}>
+                      {['Su','Mo','Tu','We','Th','Fr','Sa'].map((day, idx) => (
+                        <button key={day} type='button' onClick={() => toggleDaySelection(idx)}
+                          style={{ padding: '0.5rem 0.1rem', borderRadius: '6px', cursor: 'pointer', fontWeight: '600', fontSize: '0.8rem',
+                            border: selectedDays.includes(idx) ? `2px solid ${formData.scheduleType === 'bi-weekly' ? '#F97316' : '#3B82F6'}` : '2px solid #E5E7EB',
+                            background: selectedDays.includes(idx) ? (formData.scheduleType === 'bi-weekly' ? '#F97316' : '#3B82F6') : '#fff',
+                            color: selectedDays.includes(idx) ? '#fff' : '#374151' }}>{day}</button>
+                      ))}
+                    </div>
+                    {formData.scheduleType === 'bi-weekly' && (
+                      <div style={{ padding: '0.6rem', background: '#fff', borderRadius: '6px', border: '1px solid #FED7AA' }}>
+                        <label style={{ display: 'block', fontSize: '0.8rem', fontWeight: '700', color: '#9A3412', marginBottom: '0.3rem' }}>📅 "ON" Week Start *</label>
+                        <input type='date' value={biWeeklyAnchorDate} onChange={e => setBiWeeklyAnchorDate(e.target.value)} style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '6px', fontSize: '0.88rem' }} />
+                      </div>
+                    )}
+                  </div>
+                )}
+
+                {formData.scheduleType === 'recurring' && (
+                  <div style={{ marginBottom: '1rem' }}>
+                    <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Day of Week *</label>
+                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: '0.35rem' }}>
+                      {['Su','Mo','Tu','We','Th','Fr','Sa'].map((day, idx) => (
+                        <button key={day} type='button' onClick={() => setFormData(prev => ({ ...prev, dayOfWeek: idx.toString() }))}
+                          style={{ padding: '0.5rem 0.1rem', borderRadius: '6px', cursor: 'pointer', fontWeight: '600', fontSize: '0.8rem',
+                            border: formData.dayOfWeek === idx.toString() ? '2px solid #3B82F6' : '2px solid #E5E7EB',
+                            background: formData.dayOfWeek === idx.toString() ? '#EFF6FF' : '#fff',
+                            color: formData.dayOfWeek === idx.toString() ? '#1D4ED8' : '#374151' }}>{day}</button>
+                      ))}
+                    </div>
+                  </div>
+                )}
+
+                <div style={{ marginBottom: '1rem' }}>
+                  <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Client *</label>
+                  <select value={formData.clientId} onChange={(e) => setFormData(prev => ({ ...prev, clientId: e.target.value }))} required
+                    style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }}>
+                    <option value=''>Select client...</option>
+                    {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}{c.service_type ? ` (${c.service_type.replace(/_/g, ' ')})` : ''}</option>)}
+                  </select>
+                </div>
+
+                <div style={{ marginBottom: '1rem' }}>
+                  <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Quick Presets</label>
+                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.4rem' }}>
+                    {shiftPresets.map((p, i) => (
+                      <button key={i} type='button' onClick={() => applyPreset(p)}
+                        style={{ padding: '0.35rem 0.65rem', borderRadius: '16px', border: '1px solid #E5E7EB', cursor: 'pointer', fontSize: '0.78rem',
+                          background: formData.startTime === p.start && formData.endTime === p.end ? '#DBEAFE' : '#fff', color: '#374151' }}>{p.label}</button>
+                    ))}
+                  </div>
+                </div>
+
+                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', marginBottom: '0.75rem' }}>
+                  <div><label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Start *</label><input type='time' value={formData.startTime} onChange={(e) => setFormData(prev => ({ ...prev, startTime: e.target.value }))} required style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} /></div>
+                  <div><label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>End *</label><input type='time' value={formData.endTime} onChange={(e) => setFormData(prev => ({ ...prev, endTime: e.target.value }))} required style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} /></div>
+                </div>
+                <div style={{ marginBottom: '1rem', padding: '0.6rem', background: '#F3F4F6', borderRadius: '8px', textAlign: 'center', fontSize: '0.88rem' }}>
+                  <span style={{ fontWeight: '600' }}>{formatTime(formData.startTime)} – {formatTime(formData.endTime)}</span>
+                  <span style={{ color: '#6B7280', marginLeft: '0.75rem' }}>({calculateHours(formData.startTime, formData.endTime)}h)</span>
+                </div>
+
+                <div style={{ marginBottom: '1.25rem' }}>
+                  <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Notes</label>
+                  <textarea value={formData.notes} onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))} placeholder='Special instructions...' rows={2} style={{ width: '100%', padding: '0.65rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem', resize: 'vertical' }} />
+                </div>
+                <button type='submit' className='btn btn-primary' disabled={saving || ((formData.scheduleType === 'multi-day' || formData.scheduleType === 'bi-weekly') && selectedDays.length === 0)} style={{ width: '100%', padding: '0.85rem', fontSize: '1rem' }}>
+                  {saving ? 'Saving...' : formData.scheduleType === 'multi-day' ? `✓ Create ${selectedDays.length} Weekly Schedule${selectedDays.length !== 1 ? 's' : ''}` : formData.scheduleType === 'bi-weekly' ? `✓ Create ${selectedDays.length} Bi-Weekly Schedule${selectedDays.length !== 1 ? 's' : ''}` : '✓ Create Schedule'}
+                </button>
+              </form>
+            )}
+          </div>
+
+          {/* RIGHT — existing schedules (fills remaining space) */}
+          <div style={{ flex: 1, minWidth: 0 }}>
+            {selectedCaregiverId && caregiverSchedules.length > 0 && (
+              <div style={{ position: 'sticky', top: '1rem' }}>
+                <h4 style={{ margin: '0 0 0.75rem', fontSize: '1rem', color: '#374151', fontWeight: '700' }}>
+                  Current Schedule <span style={{ fontSize: '0.85rem', color: '#6B7280', fontWeight: '400' }}>— {calculateTotalHours(caregiverSchedules.filter(s => s.day_of_week !== null && s.day_of_week !== undefined))} hrs/wk</span>
+                </h4>
+                {Object.entries(recurringByDay).map(([dayNum, scheds]) => (
+                  <div key={dayNum} style={{ marginBottom: '1rem' }}>
+                    <div style={{ fontSize: '0.82rem', fontWeight: '700', color: '#1E40AF', marginBottom: '0.4rem', textTransform: 'uppercase', letterSpacing: '0.05em' }}>{getDayName(parseInt(dayNum))}</div>
+                    {scheds.map(s => (
+                      <div key={s.id} onClick={() => openEditModal(s)}
+                        style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '0.6rem 0.85rem', background: '#F8FAFC', border: '1px solid #E5E7EB', borderRadius: '8px', marginBottom: '0.4rem', fontSize: '0.88rem', cursor: 'pointer' }}>
+                        <div>
+                          <span style={{ fontWeight: '600' }}>{getClientName(s.client_id)}</span>
+                          <span style={{ color: '#6B7280', marginLeft: '0.75rem' }}>{formatTime(s.start_time)} – {formatTime(s.end_time)}</span>
+                          {s.frequency === 'biweekly' && <span style={{ marginLeft: '0.5rem', padding: '0.15rem 0.4rem', background: '#FFEDD5', color: '#C2410C', borderRadius: '4px', fontSize: '0.72rem' }}>Bi-Wk</span>}
+                        </div>
+                        <button onClick={(e) => { e.stopPropagation(); handleDeleteSchedule(s.id); }} style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontSize: '1rem' }}>🗑</button>
+                      </div>
+                    ))}
+                  </div>
+                ))}
+                {Object.entries(oneTimeByDate).sort().map(([dateKey, scheds]) => (
+                  <div key={dateKey} style={{ marginBottom: '1rem' }}>
+                    <div style={{ fontSize: '0.82rem', fontWeight: '700', color: '#1E40AF', marginBottom: '0.4rem', textTransform: 'uppercase', letterSpacing: '0.05em' }}>{new Date(dateKey + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</div>
+                    {scheds.map(s => (
+                      <div key={s.id} onClick={() => openEditModal(s)}
+                        style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '0.6rem 0.85rem', background: '#F8FAFC', border: '1px solid #E5E7EB', borderRadius: '8px', marginBottom: '0.4rem', fontSize: '0.88rem', cursor: 'pointer' }}>
+                        <div><span style={{ fontWeight: '600' }}>{getClientName(s.client_id)}</span><span style={{ color: '#6B7280', marginLeft: '0.75rem' }}>{formatTime(s.start_time)} – {formatTime(s.end_time)}</span></div>
+                        <button onClick={(e) => { e.stopPropagation(); handleDeleteSchedule(s.id); }} style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontSize: '1rem' }}>🗑</button>
+                      </div>
+                    ))}
+                  </div>
+                ))}
+              </div>
+            )}
+            {selectedCaregiverId && caregiverSchedules.length === 0 && (
+              <div style={{ padding: '3rem', textAlign: 'center', color: '#9CA3AF', background: '#F9FAFB', borderRadius: '12px', border: '2px dashed #E5E7EB' }}>
+                <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>📭</div>
+                No existing schedules for this caregiver
+              </div>
+            )}
+          </div>
+        </div>
+      </>
+    );
+  }
+
+  return (
+    <>
+      {message.text && (
+        <div style={{ position: 'fixed', top: '1rem', right: '1rem', padding: '0.75rem 1.25rem', borderRadius: '8px', zIndex: 2000, background: message.type === 'error' ? '#FEE2E2' : '#D1FAE5', color: message.type === 'error' ? '#DC2626' : '#059669', boxShadow: '0 4px 12px rgba(0,0,0,0.15)', fontWeight: '600' }}>{message.text}</div>
+      )}
+
+      <div style={{ marginBottom: '1rem' }}><h2 style={{ margin: 0 }}>📅 Scheduling</h2></div>
+
+      <div style={{ display: 'flex', borderBottom: '2px solid #E5E7EB', marginBottom: '1.25rem', overflowX: 'auto' }}>
+        <button style={mainTabStyle(mainTab === 'schedule')} onClick={() => setMainTab('schedule')}>📅 Schedule</button>
+        <button style={mainTabStyle(mainTab === 'tools')}    onClick={() => setMainTab('tools')}>🔧 Tools</button>
+        <button style={mainTabStyle(mainTab === 'staffing')} onClick={() => setMainTab('staffing')}>
+          👥 Staffing {pendingSwaps > 0 && <span style={{ ...bge('#DC2626', '#fff'), marginLeft: '0.4rem' }}>{pendingSwaps}</span>}
+        </button>
+      </div>
+
+      {mainTab === 'schedule' && renderScheduleTab()}
+      {mainTab === 'tools'    && renderToolsTab()}
+      {mainTab === 'staffing' && renderStaffingTab()}
+
+      {/* REASSIGN MODAL */}
+      {reassignModal && (
+        <div className='modal active' onClick={() => setReassignModal(null)}>
+          <div className='modal-content' onClick={(e) => e.stopPropagation()} style={{ maxWidth: '400px' }}>
+            <div className='modal-header'><h2>Reassign Shift</h2><button className='close-btn' onClick={() => setReassignModal(null)}>×</button></div>
+            <div style={{ margin: '1rem 0', padding: '1rem', background: '#F3F4F6', borderRadius: '8px' }}>
+              <div style={{ fontWeight: '600' }}>{getClientName(reassignModal.schedule.client_id)}</div>
+              <div style={{ fontSize: '0.88rem', color: '#6B7280' }}>{formatTime(reassignModal.schedule.start_time)} – {formatTime(reassignModal.schedule.end_time)}</div>
+              <div style={{ fontSize: '0.82rem', color: '#6B7280', marginTop: '0.4rem' }}>Currently: <strong>{reassignModal.currentCaregiver.first_name} {reassignModal.currentCaregiver.last_name}</strong></div>
+            </div>
+            <div className='form-group'>
+              <label>Reassign to:</label>
+              <select onChange={(e) => { if (e.target.value) { handleReassign(reassignModal.schedule.id, e.target.value); setReassignModal(null); } }} defaultValue=''>
+                <option value=''>Select caregiver...</option>
+                {caregivers.filter(cg => cg.id !== reassignModal.currentCaregiver.id).map(cg => <option key={cg.id} value={cg.id}>{cg.first_name} {cg.last_name}</option>)}
+              </select>
+            </div>
+            <div className='modal-actions'><button className='btn btn-secondary' onClick={() => setReassignModal(null)}>Cancel</button></div>
+          </div>
+        </div>
+      )}
+
+      {/* POST OPEN SHIFT MODAL */}
+      {showCreateShift && (
+        <div className='modal active' onClick={() => { setShowCreateShift(false); setCreateShiftPreFill({}); }}>
+          <div className='modal-content' onClick={(e) => e.stopPropagation()} style={{ maxWidth: '500px' }}>
+            <div className='modal-header'><h2>Post Open Shift</h2><button className='close-btn' onClick={() => { setShowCreateShift(false); setCreateShiftPreFill({}); }}>×</button></div>
+            <form onSubmit={(e) => { e.preventDefault(); const fd = new FormData(e.target); createOpenShift({ clientId: fd.get('clientId'), shiftDate: fd.get('date'), startTime: fd.get('start'), endTime: fd.get('end'), urgency: fd.get('urgency'), notes: fd.get('notes'), careTypeId: fd.get('careType') || null }); }}>
+              <div className='form-group'><label>Client *</label><select name='clientId' required defaultValue={createShiftPreFill.clientId || ''}><option value=''>Select...</option>{clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}</select></div>
+              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '0.5rem' }}>
+                <div className='form-group'><label>Date *</label><input type='date' name='date' required defaultValue={createShiftPreFill.date || ''} /></div>
+                <div className='form-group'><label>Start *</label><input type='time' name='start' defaultValue={createShiftPreFill.start || '09:00'} required /></div>
+                <div className='form-group'><label>End *</label><input type='time' name='end' defaultValue={createShiftPreFill.end || '13:00'} required /></div>
+              </div>
+              <div className='form-group'><label>Urgency</label><select name='urgency'><option value='normal'>Normal</option><option value='urgent'>Urgent</option></select></div>
+              <div className='form-group'><label>Notes</label><textarea name='notes' rows={2} /></div>
+              <div className='modal-actions'><button type='submit' className='btn btn-primary'>Post Shift</button><button type='button' className='btn btn-secondary' onClick={() => { setShowCreateShift(false); setCreateShiftPreFill({}); }}>Cancel</button></div>
+            </form>
+          </div>
+        </div>
+      )}
+
+      {/* SHIFT CLAIMS MODAL */}
+      {currentShift && (
+        <div className='modal active' onClick={() => setCurrentShift(null)}>
+          <div className='modal-content' onClick={(e) => e.stopPropagation()} style={{ maxWidth: '500px' }}>
+            <div className='modal-header'><h2>Claims for Shift</h2><button className='close-btn' onClick={() => setCurrentShift(null)}>×</button></div>
+            {shiftClaims.length === 0 ? <p style={{ padding: '1rem', color: '#666' }}>No claims yet.</p> : (
+              <div style={{ padding: '1rem' }}>
+                {shiftClaims.map(cl => (
+                  <div key={cl.id} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '0.75rem', borderBottom: '1px solid #eee' }}>
+                    <div><strong>{cl.caregiver_first} {cl.caregiver_last}</strong>{cl.notes && <div style={{ fontSize: '0.82rem', color: '#666' }}>{cl.notes}</div>}</div>
+                    {cl.status === 'pending' && <button className='btn btn-sm btn-success' onClick={() => approveShiftClaim(currentShift.id, cl.id)}>✓ Approve</button>}
+                    {cl.status === 'approved' && <span style={bge('#D1FAE5', '#059669')}>APPROVED</span>}
+                  </div>
+                ))}
+              </div>
+            )}
+            <div className='modal-actions' style={{ padding: '1rem' }}><button className='btn btn-secondary' onClick={() => setCurrentShift(null)}>Close</button></div>
+          </div>
+        </div>
+      )}
+
+      {/* EDIT SCHEDULE MODAL */}
+      {editModal && (
+        <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', zIndex: 2000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={() => setEditModal(null)}>
+          <div style={{ background: '#fff', borderRadius: '12px', padding: '1.5rem', maxWidth: '480px', width: '100%', maxHeight: '90vh', overflowY: 'auto', boxShadow: '0 20px 60px rgba(0,0,0,0.3)' }} onClick={(e) => e.stopPropagation()}>
+            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.25rem' }}>
+              <h3 style={{ margin: 0, color: '#1E40AF' }}>✏️ Edit Schedule</h3>
+              <button onClick={() => setEditModal(null)} style={{ background: 'none', border: 'none', fontSize: '1.25rem', cursor: 'pointer', color: '#6B7280' }}>✕</button>
+            </div>
+            <div style={{ marginBottom: '1.25rem', padding: '0.5rem 0.75rem', background: '#EFF6FF', borderRadius: '6px', fontSize: '0.85rem', color: '#1E40AF', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+              <span>{editModal.scheduleType === 'recurring' ? '🔄 Recurring' : '📅 One-Time'} Schedule</span>
+              {editModal.scheduleType === 'recurring' && (
+                <div>
+                  <div style={{ display: 'flex', gap: '0.3rem', marginBottom: editModal.frequency === 'biweekly' ? '0.4rem' : 0 }}>
+                    <button type='button' onClick={() => setEditModal(prev => ({ ...prev, frequency: 'weekly', anchorDate: null }))} style={{ padding: '0.2rem 0.5rem', borderRadius: '4px', border: 'none', fontSize: '0.78rem', fontWeight: '600', cursor: 'pointer', background: editModal.frequency === 'weekly' ? '#3B82F6' : '#E5E7EB', color: editModal.frequency === 'weekly' ? '#fff' : '#374151' }}>Weekly</button>
+                    <button type='button' onClick={() => { const now = new Date(); const s = new Date(now); s.setDate(now.getDate() - now.getDay()); setEditModal(prev => ({ ...prev, frequency: 'biweekly', anchorDate: prev.anchorDate || s.toISOString().split('T')[0] })); }} style={{ padding: '0.2rem 0.5rem', borderRadius: '4px', border: 'none', fontSize: '0.78rem', fontWeight: '600', cursor: 'pointer', background: editModal.frequency === 'biweekly' ? '#F97316' : '#E5E7EB', color: editModal.frequency === 'biweekly' ? '#fff' : '#374151' }}>Bi-Weekly</button>
+                  </div>
+                  {editModal.frequency === 'biweekly' && (
+                    <div style={{ padding: '0.5rem', background: '#FFF7ED', borderRadius: '6px', border: '1px solid #FED7AA' }}>
+                      <label style={{ display: 'block', fontSize: '0.72rem', fontWeight: '700', color: '#9A3412', marginBottom: '0.25rem' }}>📅 "ON" Week Anchor</label>
+                      <input type='date' value={editModal.anchorDate || ''} onChange={e => setEditModal(prev => ({ ...prev, anchorDate: e.target.value }))} style={{ width: '100%', padding: '0.3rem', border: '1px solid #D1D5DB', borderRadius: '4px', fontSize: '0.82rem' }} />
+                    </div>
+                  )}
+                </div>
+              )}
+            </div>
+            <div style={{ marginBottom: '1rem' }}>
+              <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Client</label>
+              <select value={editModal.clientId} onChange={(e) => setEditModal(prev => ({ ...prev, clientId: e.target.value }))} style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }}>
+                {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </div>
+            {editModal.scheduleType === 'recurring' ? (
+              <div style={{ marginBottom: '1rem' }}>
+                <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Day of Week</label>
+                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7, 1fr)', gap: '0.4rem' }}>
+                  {['Su','Mo','Tu','We','Th','Fr','Sa'].map((day, idx) => (
+                    <button key={day} type='button' onClick={() => setEditModal(prev => ({ ...prev, dayOfWeek: idx.toString() }))}
+                      style={{ padding: '0.5rem 0.2rem', borderRadius: '6px', border: editModal.dayOfWeek === idx.toString() ? '2px solid #3B82F6' : '2px solid #E5E7EB', background: editModal.dayOfWeek === idx.toString() ? '#3B82F6' : '#fff', color: editModal.dayOfWeek === idx.toString() ? '#fff' : '#374151', cursor: 'pointer', fontWeight: '600', fontSize: '0.8rem' }}>{day}</button>
+                  ))}
+                </div>
+              </div>
+            ) : (
+              <div style={{ marginBottom: '1rem' }}>
+                <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Date</label>
+                <input type='date' value={editModal.date} onChange={(e) => setEditModal(prev => ({ ...prev, date: e.target.value }))} style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} />
+              </div>
+            )}
+            <div style={{ marginBottom: '1rem' }}>
+              <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Quick Presets</label>
+              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.4rem' }}>
+                {shiftPresets.map((p, i) => <button key={i} type='button' onClick={() => setEditModal(prev => ({ ...prev, startTime: p.start, endTime: p.end }))} style={{ padding: '0.35rem 0.6rem', borderRadius: '16px', border: '1px solid #E5E7EB', background: editModal.startTime === p.start && editModal.endTime === p.end ? '#DBEAFE' : '#fff', color: '#374151', cursor: 'pointer', fontSize: '0.78rem' }}>{p.label}</button>)}
+              </div>
+            </div>
+            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.75rem', marginBottom: '1rem' }}>
+              <div><label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Start Time</label><input type='time' value={editModal.startTime} onChange={(e) => setEditModal(prev => ({ ...prev, startTime: e.target.value }))} style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} /></div>
+              <div><label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>End Time</label><input type='time' value={editModal.endTime} onChange={(e) => setEditModal(prev => ({ ...prev, endTime: e.target.value }))} style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem' }} /></div>
+            </div>
+            <div style={{ marginBottom: '1rem', padding: '0.5rem', background: '#F3F4F6', borderRadius: '6px', textAlign: 'center', fontSize: '0.9rem' }}>
+              <span style={{ fontWeight: '600' }}>{formatTime(editModal.startTime)} – {formatTime(editModal.endTime)}</span>
+              <span style={{ color: '#6B7280', marginLeft: '0.75rem' }}>({calculateHours(editModal.startTime, editModal.endTime)} hours)</span>
+            </div>
+            <div style={{ marginBottom: '1.25rem' }}>
+              <label style={{ display: 'block', marginBottom: '0.4rem', fontWeight: '600', fontSize: '0.9rem' }}>Notes</label>
+              <textarea value={editModal.notes} onChange={(e) => setEditModal(prev => ({ ...prev, notes: e.target.value }))} placeholder='Optional notes...' rows={2} style={{ width: '100%', padding: '0.6rem', borderRadius: '8px', border: '2px solid #E5E7EB', fontSize: '0.95rem', resize: 'vertical' }} />
+            </div>
+            <div style={{ display: 'flex', gap: '0.75rem' }}>
+              <button onClick={handleSaveEdit} disabled={editSaving} className='btn btn-primary' style={{ flex: 1 }}>{editSaving ? 'Saving...' : '✓ Save Changes'}</button>
+              <button onClick={() => setEditModal(null)} className='btn btn-secondary'>Cancel</button>
+            </div>
+          </div>
+        </div>
+      )}
+
+      {/* CALENDAR DAY DETAIL MODAL */}
+      {calSelectedDay && (
+        <div className='modal active' onClick={(e) => e.target === e.currentTarget && setCalSelectedDay(null)}
+          style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, padding: '1rem' }}>
+          <div style={{ background: '#fff', borderRadius: '12px', width: '100%', maxWidth: '500px', maxHeight: '80vh', overflow: 'hidden', display: 'flex', flexDirection: 'column' }}>
+            <div style={{ padding: '1rem 1.25rem', borderBottom: '1px solid #E5E7EB', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+              <div>
+                <h3 style={{ margin: 0, fontSize: '1.1rem' }}>{new Date(calCurrentDate.getFullYear(), calCurrentDate.getMonth(), calSelectedDay).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</h3>
+                <p style={{ margin: 0, fontSize: '0.82rem', color: '#6B7280' }}>{calDaySchedules.length} appointment{calDaySchedules.length !== 1 ? 's' : ''}{getProspectApptsForDay(calSelectedDay).length > 0 && ` + ${getProspectApptsForDay(calSelectedDay).length} prospect`}</p>
+              </div>
+              <button onClick={() => setCalSelectedDay(null)} style={{ background: 'none', border: 'none', fontSize: '1.5rem', cursor: 'pointer', color: '#9CA3AF' }}>×</button>
+            </div>
+            <div style={{ flex: 1, overflow: 'auto', padding: '1rem' }}>
+              {calDaySchedules.length === 0 && getProspectApptsForDay(calSelectedDay).length === 0 ? (
+                <div style={{ textAlign: 'center', padding: '2rem', color: '#6B7280' }}>📅 No appointments this day</div>
+              ) : (
+                <>
+                  {calDaySchedules.map((sc, idx) => (
+                    <div key={idx} style={{ display: 'flex', gap: '0.75rem', padding: '0.75rem', background: '#F9FAFB', borderRadius: '8px', borderLeft: `4px solid ${cgColor(sc.caregiver_id)}`, marginBottom: '0.5rem' }}>
+                      <div style={{ minWidth: '70px', textAlign: 'center' }}><div style={{ fontWeight: '600', fontSize: '0.9rem' }}>{formatTime(sc.start_time)}</div><div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{formatTime(sc.end_time)}</div></div>
+                      <div style={{ flex: 1 }}>
+                        <div style={{ fontWeight: '600' }}>{getClientName(sc.client_id)}</div>
+                        <div style={{ fontSize: '0.82rem', color: '#6B7280' }}><span style={{ display: 'inline-block', width: '8px', height: '8px', borderRadius: '50%', background: cgColor(sc.caregiver_id), marginRight: '0.4rem' }} />{getCaregiverName(sc.caregiver_id)}</div>
+                        {sc.day_of_week !== null && <span style={bge(sc.frequency === 'biweekly' ? '#FFEDD5' : '#DBEAFE', sc.frequency === 'biweekly' ? '#C2410C' : '#1D4ED8')}>{sc.frequency === 'biweekly' ? 'Bi-Weekly' : 'Recurring'}</span>}
+                      </div>
+                    </div>
+                  ))}
+                  {getProspectApptsForDay(calSelectedDay).map((pa, idx) => (
+                    <div key={`pa${idx}`} style={{ display: 'flex', gap: '0.75rem', padding: '0.75rem', background: '#FFF7ED', borderRadius: '8px', borderLeft: '4px solid #F97316', marginBottom: '0.5rem' }}>
+                      <div style={{ minWidth: '70px', textAlign: 'center' }}><div style={{ fontWeight: '600', fontSize: '0.9rem' }}>{formatTime(pa.start_time)}</div><div style={{ fontSize: '0.78rem', color: '#6B7280' }}>{formatTime(pa.end_time)}</div></div>
+                      <div style={{ flex: 1 }}>
+                        <div style={{ fontWeight: '600', color: '#9A3412' }}>🟠 {pa.prospect_first_name} {pa.prospect_last_name}</div>
+                        <div style={{ fontSize: '0.82rem', color: '#B45309' }}>{(pa.appointment_type || '').replace(/_/g, ' ')}</div>
+                        {pa.caregiver_first_name && <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>w/ {pa.caregiver_first_name} {pa.caregiver_last_name}</div>}
+                        {pa.location && <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>📍 {pa.location}</div>}
+                        <span style={bge('#FFEDD5', '#C2410C')}>Prospect</span>
+                      </div>
+                      <button onClick={() => deleteProspectAppt(pa.id)} style={{ background: 'none', border: 'none', color: '#DC2626', cursor: 'pointer', fontSize: '0.9rem', alignSelf: 'flex-start' }} title='Cancel'>🗑</button>
+                    </div>
+                  ))}
+                </>
+              )}
+            </div>
+            <div style={{ padding: '0.75rem 1.25rem', borderTop: '1px solid #E5E7EB', textAlign: 'right' }}><button className='btn btn-secondary btn-sm' onClick={() => setCalSelectedDay(null)}>Close</button></div>
+          </div>
+        </div>
+      )}
+    </>
+  );
+};
+
+export default SchedulingHub;
diff --git a/templates/crm-homecare/frontend/src/components/admin/ShiftSwaps.jsx b/templates/crm-homecare/frontend/src/components/admin/ShiftSwaps.jsx
new file mode 100644
index 0000000..e86a833
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/admin/ShiftSwaps.jsx
@@ -0,0 +1,254 @@
+// src/components/admin/ShiftSwaps.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const ShiftSwaps = ({ token }) => {
+  const [swaps, setSwaps] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [filter, setFilter] = useState({ status: '' });
+
+  useEffect(() => {
+    loadSwaps();
+  }, [filter]);
+
+  const loadSwaps = async () => {
+    try {
+      const params = new URLSearchParams();
+      if (filter.status) params.append('status', filter.status);
+      
+      const res = await fetch(`${API_BASE_URL}/api/shift-swaps?${params}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setSwaps(Array.isArray(data) ? data : []);
+    } catch (error) {
+      console.error('Failed to load swaps:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const approveSwap = async (swapId) => {
+    if (!confirm('Approve this shift swap? The schedule will be updated.')) return;
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/shift-swaps/${swapId}/approve`, {
+        method: 'PUT',
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        loadSwaps();
+      } else {
+        const err = await res.json();
+        alert('Failed: ' + err.error);
+      }
+    } catch (error) {
+      alert('Failed: ' + error.message);
+    }
+  };
+
+  const rejectSwap = async (swapId) => {
+    const reason = prompt('Rejection reason (optional):');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/shift-swaps/${swapId}/reject`, {
+        method: 'PUT',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({ reason })
+      });
+      if (res.ok) {
+        loadSwaps();
+      }
+    } catch (error) {
+      alert('Failed: ' + error.message);
+    }
+  };
+
+  const getStatusBadge = (status) => {
+    const colors = {
+      pending: '#ff9800',
+      accepted: '#2196f3',
+      approved: '#4caf50',
+      rejected: '#f44336',
+      cancelled: '#9e9e9e'
+    };
+    return (
+      <span style={{
+        padding: '3px 8px',
+        borderRadius: '4px',
+        fontSize: '0.75rem',
+        fontWeight: 'bold',
+        color: 'white',
+        backgroundColor: colors[status] || '#9e9e9e'
+      }}>
+        {status?.toUpperCase()}
+      </span>
+    );
+  };
+
+  const pendingCount = swaps.filter(s => s.status === 'pending').length;
+  const acceptedCount = swaps.filter(s => s.status === 'accepted').length;
+
+  return (
+    <div>
+      <div className="page-header">
+        <h2>🔄 Shift Swap Requests</h2>
+      </div>
+
+      {/* Summary Cards */}
+      <div className="grid" style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', marginBottom: '1rem' }}>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ status: 'pending' })} 
+          style={{ cursor: 'pointer', border: filter.status === 'pending' ? '2px solid #ff9800' : 'none' }}
+        >
+          <h4>Pending</h4>
+          <div className="value" style={{ color: '#ff9800' }}>{pendingCount}</div>
+          <small>Awaiting caregiver response</small>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ status: 'accepted' })} 
+          style={{ cursor: 'pointer', border: filter.status === 'accepted' ? '2px solid #2196f3' : 'none' }}
+        >
+          <h4>Needs Approval</h4>
+          <div className="value" style={{ color: '#2196f3' }}>{acceptedCount}</div>
+          <small>Ready for admin review</small>
+        </div>
+        <div 
+          className="stat-card" 
+          onClick={() => setFilter({ status: '' })} 
+          style={{ cursor: 'pointer', border: filter.status === '' ? '2px solid #333' : 'none' }}
+        >
+          <h4>All Requests</h4>
+          <div className="value">{swaps.length}</div>
+        </div>
+      </div>
+
+      {/* Filter */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div className="form-group" style={{ margin: 0, maxWidth: '200px' }}>
+          <label>Filter by Status</label>
+          <select value={filter.status} onChange={(e) => setFilter({ status: e.target.value })}>
+            <option value="">All</option>
+            <option value="pending">Pending</option>
+            <option value="accepted">Accepted (Needs Approval)</option>
+            <option value="approved">Approved</option>
+            <option value="rejected">Rejected</option>
+            <option value="cancelled">Cancelled</option>
+          </select>
+        </div>
+      </div>
+
+      {/* Swaps Table */}
+      <div className="card">
+        {loading ? (
+          <div className="loading"><div className="spinner"></div></div>
+        ) : swaps.length === 0 ? (
+          <p>No shift swap requests found.</p>
+        ) : (
+          <table className="table">
+            <thead>
+              <tr>
+                <th>Shift Date</th>
+                <th>Time</th>
+                <th>Client</th>
+                <th>Requesting</th>
+                <th>→</th>
+                <th>Target</th>
+                <th>Reason</th>
+                <th>Status</th>
+                <th>Requested</th>
+                <th>Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {swaps.map(swap => (
+                <tr key={swap.id}>
+                  <td>
+                    <strong>
+                      {new Date(swap.shift_date).toLocaleDateString('en-US', { 
+                        weekday: 'short', 
+                        month: 'short', 
+                        day: 'numeric' 
+                      })}
+                    </strong>
+                  </td>
+                  <td>{swap.start_time?.slice(0,5)} - {swap.end_time?.slice(0,5)}</td>
+                  <td>{swap.client_first} {swap.client_last}</td>
+                  <td>
+                    <strong>{swap.requester_first} {swap.requester_last}</strong>
+                  </td>
+                  <td style={{ fontSize: '1.2rem' }}>→</td>
+                  <td>
+                    {swap.target_first ? (
+                      <strong>{swap.target_first} {swap.target_last}</strong>
+                    ) : (
+                      <span style={{ color: '#666', fontStyle: 'italic' }}>Open Swap</span>
+                    )}
+                  </td>
+                  <td style={{ maxWidth: '200px', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                    {swap.reason || '-'}
+                  </td>
+                  <td>{getStatusBadge(swap.status)}</td>
+                  <td style={{ fontSize: '0.85rem' }}>
+                    {new Date(swap.requested_at).toLocaleDateString()}
+                  </td>
+                  <td>
+                    {swap.status === 'accepted' && (
+                      <div style={{ display: 'flex', gap: '0.25rem' }}>
+                        <button 
+                          className="btn btn-sm btn-success"
+                          onClick={() => approveSwap(swap.id)}
+                          title="Approve swap"
+                        >
+                          ✓ Approve
+                        </button>
+                        <button 
+                          className="btn btn-sm btn-danger"
+                          onClick={() => rejectSwap(swap.id)}
+                          title="Reject swap"
+                        >
+                          ✗
+                        </button>
+                      </div>
+                    )}
+                    {swap.status === 'pending' && (
+                      <span style={{ color: '#666', fontSize: '0.85rem' }}>
+                        Awaiting response
+                      </span>
+                    )}
+                    {swap.status === 'approved' && (
+                      <span style={{ color: '#4caf50', fontSize: '0.85rem' }}>
+                        ✓ Completed
+                      </span>
+                    )}
+                    {swap.status === 'rejected' && (
+                      <span style={{ color: '#f44336', fontSize: '0.85rem' }}>
+                        Rejected
+                      </span>
+                    )}
+                  </td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        )}
+      </div>
+
+      {/* Info Card */}
+      <div className="card" style={{ marginTop: '1rem', backgroundColor: '#f5f5f5' }}>
+        <h4>How Shift Swaps Work</h4>
+        <ol style={{ margin: '0.5rem 0', paddingLeft: '1.5rem' }}>
+          <li><strong>Request:</strong> Caregiver A requests to swap their shift with Caregiver B</li>
+          <li><strong>Pending:</strong> Caregiver B receives notification and can accept or decline</li>
+          <li><strong>Accepted:</strong> If Caregiver B accepts, the swap needs admin approval</li>
+          <li><strong>Approved:</strong> Admin approves, schedule is automatically updated</li>
+        </ol>
+      </div>
+    </div>
+  );
+};
+
+export default ShiftSwaps;
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
new file mode 100644
index 0000000..8d2c5e6
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
@@ -0,0 +1,1172 @@
+// src/components/CaregiverDashboard.jsx
+// Enhanced with self-service: availability, open shifts pickup, time off requests
+import React, { useState, useEffect, useRef, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+import CaregiverClientModal from '../CaregiverClientModal';
+import MileageTracker from './MileageTracker';
+import ShiftMissReport from './caregiver/ShiftMissReport';
+import CaregiverHelp from './caregiver/CaregiverHelp';
+import CaregiverMessages from './caregiver/CaregiverMessages';
+import { useGeolocation, useHaptics, useOfflineSync, useBackgroundGeolocation, isNative, platform } from '../../hooks/useNative';
+import OfflineBanner from '../OfflineBanner';
+
+const subscribeToPush = async (token) => {
+  try {
+    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;
+    const reg = await navigator.serviceWorker.ready;
+    const vapidRes = await fetch(`${API_BASE_URL}/api/push/vapid-key`, { headers: { Authorization: `Bearer ${token}` } });
+    const { publicKey } = await vapidRes.json();
+    if (!publicKey || publicKey === 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') return;
+    const subscription = await reg.pushManager.subscribe({
+      userVisibleOnly: true,
+      applicationServerKey: publicKey,
+    });
+    await fetch(`${API_BASE_URL}/api/push/subscribe`, {
+      method: 'POST', headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
+      body: JSON.stringify({ subscription }),
+    });
+  } catch (e) {
+    console.log('[Push] subscription skipped:', e.message);
+  }
+};
+
+const CaregiverDashboard = ({ user, token, onLogout }) => {
+  const [currentPage, setCurrentPage] = useState('home');
+  const [schedules, setSchedules] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [activeSession, setActiveSession] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [selectedClient, setSelectedClient] = useState('');
+  const [sidebarOpen, setSidebarOpen] = useState(false);
+  const [elapsedTime, setElapsedTime] = useState(0);
+  const [visitNote, setVisitNote] = useState('');
+  const [showNoteModal, setShowNoteModal] = useState(false);
+  const [recentVisits, setRecentVisits] = useState([]);
+  const [viewingClientId, setViewingClientId] = useState(null);
+  const timerRef = useRef(null);
+
+  // Native GPS — works on web AND iOS/Android
+  const { position: location, error: locationError, getPosition } = useGeolocation({ watch: true });
+  const { impact, notification: hapticNotify } = useHaptics();
+  const { online, queueCount } = useOfflineSync();
+  const { start: startBgGeo } = useBackgroundGeolocation();
+
+  // Self-service state
+  const [openShifts, setOpenShifts] = useState([]);
+  const [myHoursThisWeek, setMyHoursThisWeek] = useState(0);
+  const [availability, setAvailability] = useState({
+    status: 'available',
+    maxHoursPerWeek: 40,
+    weeklyAvailability: {
+      0: { available: false, start: '09:00', end: '17:00' },
+      1: { available: true, start: '09:00', end: '17:00' },
+      2: { available: true, start: '09:00', end: '17:00' },
+      3: { available: true, start: '09:00', end: '17:00' },
+      4: { available: true, start: '09:00', end: '17:00' },
+      5: { available: true, start: '09:00', end: '17:00' },
+      6: { available: false, start: '09:00', end: '17:00' }
+    },
+    notes: ''
+  });
+  const [timeOffRequests, setTimeOffRequests] = useState([]);
+  const [newTimeOff, setNewTimeOff] = useState({ startDate: '', endDate: '', reason: '' });
+  const [message, setMessage] = useState({ text: '', type: '' });
+  const [showMissReport, setShowMissReport] = useState(false);
+  const [showHelp, setShowHelp] = useState(false);
+  const [showMessages, setShowMessages] = useState(false);
+  const [unreadMessages, setUnreadMessages] = useState(0);
+  const [showMoreDrawer, setShowMoreDrawer] = useState(false);
+
+  useEffect(() => {
+    loadData();
+    // GPS tracking handled by useGeolocation hook (watch: true)
+    subscribeToPush(token);
+    // Start background geolocation on Android so geofence works when screen is off
+    startBgGeo({
+      notificationTitle: 'CVHC HomeCare',
+      notificationText: 'Monitoring location for auto clock-in',
+      onLocation: (loc) => {
+        // Background location updates feed into the geofence check
+        // The geofence polling useEffect will pick up the latest position
+      }
+    });
+    return () => {
+      if (timerRef.current) clearInterval(timerRef.current);
+    };
+  }, []);
+
+  // Poll for unread messages
+  useEffect(() => {
+    const checkUnread = async () => {
+      try {
+        const res = await fetch(`${API_BASE_URL}/api/messages/unread-count`, {
+          headers: { Authorization: `Bearer ${token}` }
+        });
+        if (res.status === 429) return; // rate limited - skip
+        if (res.ok) { const data = await res.json(); setUnreadMessages(data.count); }
+      } catch (e) { }
+    };
+    checkUnread();
+    const interval = setInterval(checkUnread, 90000);
+    return () => clearInterval(interval);
+  }, [token]);
+
+  useEffect(() => {
+    if (activeSession) {
+      timerRef.current = setInterval(() => {
+        const start = new Date(activeSession.start_time);
+        const now = new Date();
+        setElapsedTime(Math.floor((now - start) / 1000));
+      }, 1000);
+    } else {
+      if (timerRef.current) clearInterval(timerRef.current);
+      setElapsedTime(0);
+    }
+    return () => {
+      if (timerRef.current) clearInterval(timerRef.current);
+    };
+  }, [activeSession]);
+
+  useEffect(() => {
+    if (window.innerWidth <= 768) {
+      setSidebarOpen(false);
+    }
+  }, [currentPage]);
+
+  useEffect(() => {
+    if (currentPage === 'open-shifts') loadOpenShifts();
+    if (currentPage === 'availability') loadAvailability();
+    if (currentPage === 'time-off') loadTimeOffRequests();
+  }, [currentPage]);
+
+  const loadData = async () => {
+    try {
+      const [schedulesRes, clientsRes, activeRes, visitsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/schedules/${user.id}`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/time-entries/active`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }).catch(() => ({ ok: false })),
+        fetch(`${API_BASE_URL}/api/time-entries/recent?limit=10`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }).catch(() => ({ ok: false }))
+      ]);
+
+      if (schedulesRes.ok) setSchedules(await schedulesRes.json());
+      if (clientsRes.ok) setClients(await clientsRes.json());
+      if (activeRes.ok) {
+        const data = await activeRes.json();
+        if (data?.id) {
+          setActiveSession(data);
+          setSelectedClient(data.client_id);
+        }
+      }
+      if (visitsRes.ok) setRecentVisits(await visitsRes.json());
+      loadMyHours();
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadOpenShifts = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/available`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) setOpenShifts(await res.json());
+    } catch (error) {
+      console.error('Failed to load open shifts:', error);
+    }
+  };
+
+  const loadAvailability = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregivers/${user.id}/availability`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        const data = await res.json();
+        if (data) {
+          setAvailability(prev => ({
+            status: data.status || prev.status,
+            maxHoursPerWeek: data.max_hours_per_week || prev.maxHoursPerWeek,
+            weeklyAvailability: data.weekly_availability ? 
+              (typeof data.weekly_availability === 'string' ? JSON.parse(data.weekly_availability) : data.weekly_availability) 
+              : prev.weeklyAvailability,
+            notes: data.notes || ''
+          }));
+        }
+      }
+    } catch (error) {
+      console.error('Failed to load availability:', error);
+    }
+  };
+
+  const loadTimeOffRequests = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/absences/my`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) setTimeOffRequests(await res.json());
+    } catch (error) {
+      console.error('Failed to load time off:', error);
+    }
+  };
+
+  const loadMyHours = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/scheduling/caregiver-hours/${user.id}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        const data = await res.json();
+        setMyHoursThisWeek(parseFloat(data.totalHours) || 0);
+      }
+    } catch (error) {
+      console.error('Failed to load hours:', error);
+    }
+  };
+
+  const showMsg = (text, type = 'success') => {
+    setMessage({ text, type });
+    setTimeout(() => setMessage({ text: '', type: '' }), 4000);
+  };
+
+  const startGPSTracking = () => {
+    if ('geolocation' in navigator) {
+      navigator.geolocation.watchPosition(
+        (pos) => {
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+          setLocationError(null);
+        },
+        (err) => setLocationError(err.message),
+        { enableHighAccuracy: true, maximumAge: 5000, timeout: 10000 }
+      );
+    }
+  };
+
+  // Push GPS breadcrumbs every 60 seconds during active shift
+  const startGPSBreadcrumbs = (sessionId) => {
+    if (!("geolocation" in navigator)) return;
+    const interval = setInterval(() => {
+      // GPS breadcrumb
+      navigator.geolocation.getCurrentPosition(
+        (pos) => {
+          fetch(`${API_BASE_URL}/api/time-entries/${sessionId}/gps`, {
+            method: "POST",
+            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
+            body: JSON.stringify({ latitude: pos.coords.latitude, longitude: pos.coords.longitude, accuracy: pos.coords.accuracy, speed: pos.coords.speed, heading: pos.coords.heading })
+          }).catch(() => {});
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+        },
+        () => {},
+        { enableHighAccuracy: true, timeout: 10000 }
+      );
+
+      // 15-minute shift warning check (runs every 60s alongside GPS)
+      fetch(`${API_BASE_URL}/api/time-entries/check-warnings`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ timeEntryId: sessionId })
+      })
+      .then(r => r.json())
+      .then(d => {
+        if (d.warning && !d.overTime) {
+          // 15-min warning - show in-app alert
+          toast(`⏰ ${d.minutesRemaining} min remaining — start wrapping up your shift!`, 'warning');
+        } else if (d.warning && d.overTime) {
+          toast(`⚠️ You are ${d.minutesOver} min over your scheduled time — please clock out`, 'error');
+        }
+      })
+      .catch(() => {});
+
+    }, 60000); // every 60s
+    return interval;
+  };
+  const gpsIntervalRef = React.useRef(null);
+  const geofenceIntervalRef = React.useRef(null);
+  const geofenceTriggeredRef = React.useRef(new Set()); // track which clients we've already auto-clocked for
+
+  const _startGPSTracking_REMOVED = () => {
+    if ("geolocation" in navigator) {
+      navigator.geolocation.watchPosition(
+        (pos) => {
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+          setLocationError(null);
+        },
+        (err) => setLocationError(err.message),
+        { enableHighAccuracy: true, maximumAge: 5000, timeout: 10000 }
+      );
+    } else {
+      setLocationError('Geolocation not supported');
+    }
+  };
+
+  // ── GEOFENCE AUTO CLOCK-IN/OUT ────────────────────────────────────────────
+  const runGeofenceCheck = async (currentLocation, currentSession, currentClients, currentSchedules) => {
+    if (!currentLocation?.lat && !currentLocation?.latitude) return;
+    const lat = currentLocation.lat || currentLocation.latitude;
+    const lng = currentLocation.lng || currentLocation.longitude;
+
+    // Get today's day of week
+    const todayDay = new Date().getDay();
+    const now = new Date();
+    const nowMins = now.getHours() * 60 + now.getMinutes();
+
+    // Find clients scheduled for today (from recurring schedules)
+    const todayClients = (currentSchedules || [])
+      .filter(s => s.day_of_week === todayDay || 
+        (s.date && new Date(s.date).toDateString() === now.toDateString()))
+      .map(s => s.client_id)
+      .filter(Boolean);
+
+    if (!todayClients.length) return;
+
+    for (const clientId of todayClients) {
+      const alreadyTriggered = geofenceTriggeredRef.current.has(clientId);
+
+      try {
+        const res = await fetch(`${API_BASE_URL}/api/route-optimizer/geofence/check`, {
+          method: 'POST',
+          headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+          body: JSON.stringify({ clientId, latitude: lat, longitude: lng })
+        });
+        if (!res.ok) continue;
+        const data = await res.json();
+
+        // AUTO CLOCK-IN: within geofence, not clocked in, not already triggered
+        if (data.withinGeofence && data.autoClockIn && !currentSession && !alreadyTriggered) {
+          geofenceTriggeredRef.current.add(clientId);
+          toast(`📍 You've arrived at ${data.clientName} — clocking you in automatically`, 'success');
+          // Auto clock in
+          const clockRes = await fetch(`${API_BASE_URL}/api/time-entries/clock-in`, {
+            method: 'POST',
+            headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+            body: JSON.stringify({ clientId, latitude: lat, longitude: lng, autoClockIn: true })
+          });
+          if (clockRes.ok) {
+            const clockData = await clockRes.json();
+            setActiveSession(clockData);
+            setSelectedClient(clientId);
+            gpsIntervalRef.current = startGPSBreadcrumbs(clockData.id);
+          }
+          break; // only clock into one client at a time
+        }
+
+        // AUTO CLOCK-OUT: was within geofence but now left, currently clocked into this client
+        if (!data.withinGeofence && data.autoClockOut && currentSession?.client_id === clientId && alreadyTriggered) {
+          // Only auto clock-out if they've been there at least 10 minutes
+          const sessionStart = new Date(currentSession.start_time);
+          const minsElapsed = (now - sessionStart) / 60000;
+          if (minsElapsed >= 10) {
+            toast(`📍 You've left ${data.clientName}'s location — clocking you out automatically`, 'success');
+            geofenceTriggeredRef.current.delete(clientId);
+            setShowNoteModal(true); // prompt for visit note before clocking out
+          }
+        }
+      } catch(e) {
+        // Silently fail — don't interrupt the caregiver
+      }
+    }
+  };
+
+  // Start geofence polling when location is available
+  useEffect(() => {
+    if (!location) return;
+    // Run immediately on location change
+    runGeofenceCheck(location, activeSession, clients, schedules);
+    // Also run on interval every 30 seconds
+    if (!geofenceIntervalRef.current) {
+      geofenceIntervalRef.current = setInterval(() => {
+        runGeofenceCheck(location, activeSession, clients, schedules);
+      }, 30000);
+    }
+    return () => {
+      if (geofenceIntervalRef.current) {
+        clearInterval(geofenceIntervalRef.current);
+        geofenceIntervalRef.current = null;
+      }
+    };
+  }, [location, activeSession, clients, schedules]);
+
+  const handleClockIn = async () => {
+    if (!selectedClient) return toast('Please select a client.');
+
+    try {
+      // Get fresh position if we don't have one
+      let lat = location?.latitude || null;
+      let lng = location?.longitude || null;
+      if (!lat) {
+        await getPosition();
+        lat = location?.latitude || null;
+        lng = location?.longitude || null;
+      }
+
+      await impact('medium'); // native haptic on button press
+
+      const res = await fetch(`${API_BASE_URL}/api/time-entries/clock-in`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ clientId: selectedClient, latitude: lat, longitude: lng })
+      });
+
+      if (!res.ok) {
+        // If offline, service worker queued it — res will have queued:true
+        const data = await res.json();
+        if (data.queued) {
+          await hapticNotify('warning');
+          toast('Clocked in offline — will sync when reconnected', 'warning');
+          setActiveSession({ id: 'offline-' + Date.now(), offline: true });
+          return;
+        }
+        throw new Error(data.error || 'Failed');
+      }
+
+      const clockInData = await res.json();
+      await hapticNotify('success'); // success haptic
+      setActiveSession(clockInData);
+      gpsIntervalRef.current = startGPSBreadcrumbs(clockInData.id);
+      if (!lat) toast('Clocked in (location unavailable)', 'warning');
+    } catch (error) {
+      await hapticNotify('error');
+      toast('Failed to clock in: ' + error.message, 'error');
+    }
+  };
+
+  const handleClockOut = () => {
+    if (!activeSession) return toast('No active session.');
+    setShowNoteModal(true);
+  };
+
+  const completeClockOut = async () => {
+    try {
+      await impact('heavy'); // strong haptic for clock out
+
+      const lat = location?.latitude || null;
+      const lng = location?.longitude || null;
+
+      const res = await fetch(`${API_BASE_URL}/api/time-entries/${activeSession.id}/clock-out`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ latitude: lat, longitude: lng, notes: visitNote })
+      });
+
+      if (!res.ok) {
+        const data = await res.json();
+        if (data.queued) {
+          await hapticNotify('warning');
+          toast('Clocked out offline — will sync when reconnected', 'warning');
+          setActiveSession(null);
+          setSelectedClient('');
+          setVisitNote('');
+          setShowNoteModal(false);
+          return;
+        }
+        throw new Error(data.error || 'Failed');
+      }
+
+      await hapticNotify('success');
+      setActiveSession(null);
+      setSelectedClient('');
+      setVisitNote('');
+      setShowNoteModal(false);
+      loadData();
+    } catch (error) {
+      await hapticNotify('error');
+      toast('Failed to clock out: ' + error.message, 'error');
+    }
+  };
+
+  const handlePickupShift = async (shiftId) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/claim`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }
+      });
+      if (!res.ok) throw new Error((await res.json()).error || 'Failed');
+      showMsg('Shift claimed!');
+      loadOpenShifts();
+      loadData();
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handleSaveAvailability = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregiver-availability/${user.id}`, {
+        method: 'PUT',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          status: availability.status,
+          maxHoursPerWeek: availability.maxHoursPerWeek,
+          weeklyAvailability: availability.weeklyAvailability,
+          notes: availability.notes
+        })
+      });
+      if (!res.ok) throw new Error('Failed');
+      showMsg('Availability saved!');
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handleRequestTimeOff = async (e) => {
+    e.preventDefault();
+    if (!newTimeOff.startDate || !newTimeOff.endDate) return showMsg('Select dates', 'error');
+
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/absences`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          caregiverId: user.id,
+          absenceType: 'time_off_request',
+          startDate: newTimeOff.startDate,
+          endDate: newTimeOff.endDate,
+          reason: newTimeOff.reason,
+          status: 'pending'
+        })
+      });
+      if (!res.ok) throw new Error('Failed');
+      showMsg('Request submitted!');
+      setNewTimeOff({ startDate: '', endDate: '', reason: '' });
+      loadTimeOffRequests();
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handlePageClick = (page) => {
+    setCurrentPage(page);
+    if (window.innerWidth <= 768) setSidebarOpen(false);
+  };
+
+  const getClientName = (id) => {
+    const c = clients.find(c => c.id === id);
+    return c ? `${c.first_name} ${c.last_name}` : 'Unknown';
+  };
+
+  const formatTime = (t) => {
+    if (!t) return '';
+    const [h, m] = t.split(':');
+    const hr = parseInt(h);
+    return `${hr % 12 || 12}:${m} ${hr >= 12 ? 'PM' : 'AM'}`;
+  };
+
+  const formatElapsed = (s) => {
+    const h = Math.floor(s / 3600);
+    const m = Math.floor((s % 3600) / 60);
+    const sec = s % 60;
+    return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
+  };
+
+  const formatDate = (d) => d ? new Date(d).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) : '';
+  const getDayName = (n) => ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][n] || '';
+
+  // Get today's appointments from schedules
+  const getTodaysAppointments = () => {
+    const today = new Date();
+    const dayOfWeek = today.getDay();
+    const todayStr = today.toISOString().split('T')[0];
+    
+    // Get recurring schedules for today's day of week
+    const recurring = schedules.filter(s => s.day_of_week === dayOfWeek);
+    // Get one-time schedules for today's date
+    const oneTime = schedules.filter(s => s.date && s.date.split('T')[0] === todayStr);
+    
+    return [...recurring, ...oneTime].sort((a, b) => {
+      const timeA = a.start_time || '00:00';
+      const timeB = b.start_time || '00:00';
+      return timeA.localeCompare(timeB);
+    });
+  };
+
+  const getClientById = (id) => clients.find(c => c.id === id);
+
+  // RENDER PAGES
+  const renderHomePage = () => {
+    const todaysAppointments = getTodaysAppointments();
+    
+    return (
+    <>
+      <div className="card" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: '#fff', marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+          <div>
+            <div style={{ fontSize: '0.9rem', opacity: 0.9 }}>Hours This Week</div>
+            <div style={{ fontSize: '2rem', fontWeight: 'bold' }}>{myHoursThisWeek.toFixed(2)}h</div>
+          </div>
+          <div style={{ fontSize: '3rem', opacity: 0.5 }}>⏱️</div>
+        </div>
+        {myHoursThisWeek > 35 && (
+          <div style={{ marginTop: '0.5rem', padding: '0.5rem', background: 'rgba(255,255,255,0.2)', borderRadius: '6px', fontSize: '0.85rem' }}>
+            ⚠️ Approaching 40 hour limit
+          </div>
+        )}
+      </div>
+
+      {/* Today's Appointments Section */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div className="card-title">📅 Today's Appointments</div>
+        {todaysAppointments.length === 0 ? (
+          <p className="text-muted text-center" style={{ padding: '1rem 0' }}>No appointments scheduled for today</p>
+        ) : (
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+            {todaysAppointments.map((appt, idx) => {
+              const client = getClientById(appt.client_id);
+              const isCurrentClient = activeSession?.client_id === appt.client_id;
+              return (
+                <div 
+                  key={appt.id || idx} 
+                  style={{ 
+                    padding: '1rem', 
+                    borderRadius: '8px', 
+                    background: isCurrentClient ? '#DBEAFE' : '#F9FAFB',
+                    border: isCurrentClient ? '2px solid #2563eb' : '1px solid #E5E7EB'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                    <div style={{ flex: 1 }}>
+                      <div style={{ fontWeight: '600', fontSize: '1.1rem', color: '#1F2937' }}>
+                        {client ? `${client.first_name} ${client.last_name}` : 'Unknown Client'}
+                        {isCurrentClient && <span style={{ marginLeft: '0.5rem', color: '#059669', fontSize: '0.85rem' }}>● Active</span>}
+                      </div>
+                      <div style={{ fontSize: '0.9rem', color: '#6B7280', marginTop: '0.25rem' }}>
+                        🕐 {formatTime(appt.start_time)} - {formatTime(appt.end_time)}
+                      </div>
+                      {client && (
+                        <div style={{ fontSize: '0.85rem', color: '#6B7280', marginTop: '0.5rem' }}>
+                          {client.phone && <span>📞 {client.phone}</span>}
+                          {client.address && <span style={{ marginLeft: client.phone ? '1rem' : 0 }}>📍 {client.address}{client.city ? `, ${client.city}` : ''}</span>}
+                        </div>
+                      )}
+                      {appt.notes && (
+                        <div style={{ fontSize: '0.85rem', color: '#4B5563', marginTop: '0.5rem', padding: '0.5rem', background: '#FEF3C7', borderRadius: '4px' }}>
+                          📝 {appt.notes}
+                        </div>
+                      )}
+                    </div>
+                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', marginLeft: '1rem' }}>
+                      <button 
+                        className="btn btn-sm" 
+                        style={{ background: '#E5E7EB', color: '#374151', padding: '0.4rem 0.75rem' }}
+                        onClick={() => setViewingClientId(appt.client_id)}
+                      >
+                        View
+                      </button>
+                      {!activeSession && (
+                        <button 
+                          className="btn btn-sm btn-primary" 
+                          style={{ padding: '0.4rem 0.75rem' }}
+                          onClick={() => setSelectedClient(appt.client_id)}
+                        >
+                          Select
+                        </button>
+                      )}
+                    </div>
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        )}
+      </div>
+
+      {/* MOBILE-FIRST CLOCK-IN — Full prominent card */}
+      <div className="card" style={{ padding: 0, overflow: 'hidden' }}>
+        {activeSession ? (
+          // ACTIVE SESSION — big timer, center-stage
+          <div style={{ textAlign: 'center', padding: '2rem 1.5rem', background: 'linear-gradient(135deg, #F0FDF4, #DCFCE7)' }}>
+            <div style={{ fontSize: '0.9rem', color: '#166534', fontWeight: '600', marginBottom: '0.25rem' }}>
+              🟢 Clocked In with {getClientName(activeSession.client_id)}
+            </div>
+            <div style={{ fontSize: '4rem', fontWeight: '900', fontFamily: 'monospace', color: '#16A34A', lineHeight: 1.1, margin: '0.5rem 0' }}>
+              {formatElapsed(elapsedTime)}
+            </div>
+            <div style={{ fontSize: '0.82rem', color: '#4B5563', marginBottom: '1.5rem' }}>
+              {location ? `📍 GPS Active (±${location.accuracy?.toFixed(0)}m)` : '📍 Location unavailable'}
+            </div>
+            <button
+              onClick={handleClockOut}
+              style={{
+                width: '100%', padding: '1.125rem', background: '#DC2626', color: '#fff',
+                border: 'none', borderRadius: '12px', cursor: 'pointer',
+                fontWeight: '800', fontSize: '1.15rem', letterSpacing: '0.02em',
+                boxShadow: '0 4px 12px rgba(220,38,38,0.3)'
+              }}
+            >
+              🛑 Clock Out
+            </button>
+          </div>
+        ) : (
+          // CLOCK IN — prominent select + button
+          <div style={{ padding: '1.5rem' }}>
+            <div style={{ fontSize: '1.1rem', fontWeight: '800', color: '#111827', marginBottom: '1rem', textAlign: 'center' }}>
+              ⏰ Ready to Start a Shift?
+            </div>
+            <div className="form-group" style={{ marginBottom: '0.875rem' }}>
+              <label style={{ fontWeight: '700', fontSize: '0.9rem', color: '#374151' }}>Select Client *</label>
+              <select
+                value={selectedClient}
+                onChange={(e) => setSelectedClient(e.target.value)}
+                style={{ width: '100%', padding: '0.875rem', fontSize: '1rem', border: '2px solid #D1D5DB', borderRadius: '10px', background: '#fff', boxSizing: 'border-box' }}
+              >
+                <option value="">Choose client...</option>
+                {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </div>
+            <div style={{ padding: '0.6rem 0.875rem', background: location ? '#F0FDF4' : '#F9FAFB', borderRadius: '8px', marginBottom: '1rem', fontSize: '0.85rem', color: location ? '#166534' : '#6B7280', border: `1px solid ${location ? '#BBF7D0' : '#E5E7EB'}` }}>
+              {location ? `✅ GPS Active (±${location.accuracy?.toFixed(0)}m)` : locationError ? '⚠️ Location unavailable — you can still clock in' : '📍 Getting your location...'}
+            </div>
+            <button
+              onClick={handleClockIn}
+              disabled={!selectedClient}
+              style={{
+                width: '100%', padding: '1.125rem', background: selectedClient ? '#2ABBA7' : '#D1D5DB',
+                color: selectedClient ? '#fff' : '#9CA3AF', border: 'none', borderRadius: '12px',
+                cursor: selectedClient ? 'pointer' : 'not-allowed', fontWeight: '800', fontSize: '1.15rem',
+                transition: 'all 0.15s', boxShadow: selectedClient ? '0 4px 12px rgba(42,187,167,0.3)' : 'none'
+              }}
+            >
+              ▶️ Clock In
+            </button>
+          </div>
+        )}
+      </div>
+
+      {/* Quick Actions row */}
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '0.75rem', marginTop: '0.75rem' }}>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem' }} onClick={() => handlePageClick('open-shifts')}>
+          <div style={{ fontSize: '1.6rem' }}>📋</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem' }}>Open Shifts</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem' }} onClick={() => handlePageClick('availability')}>
+          <div style={{ fontSize: '1.6rem' }}>⏰</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem' }}>Availability</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#FEF2F2', border: '1px solid #FCA5A5' }}
+          onClick={() => setShowMissReport(true)}>
+          <div style={{ fontSize: '1.6rem' }}>🚨</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#DC2626' }}>Miss Report</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#EEF2FF', border: '1px solid #C7D2FE', position: 'relative' }}
+          onClick={() => setShowMessages(true)}>
+          <div style={{ fontSize: '1.6rem' }}>💬</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#4338CA' }}>Messages</div>
+          {unreadMessages > 0 && (
+            <span style={{ position: 'absolute', top: '6px', right: '6px', background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.62rem', fontWeight: '700', padding: '1px 6px', minWidth: '16px', textAlign: 'center' }}>{unreadMessages}</span>
+          )}
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#F0FDFB', border: '1px solid #A7F3D0' }}
+          onClick={() => setShowHelp(true)}>
+          <div style={{ fontSize: '1.6rem' }}>❓</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#065F46' }}>Help</div>
+        </div>
+      </div>
+    </>
+    );
+  };
+
+  const renderOpenShiftsPage = () => (
+    <>
+      <div className="schedule-header"><h3>📋 Available Shifts</h3></div>
+      {openShifts.length === 0 ? (
+        <div className="card text-center"><p style={{ fontSize: '3rem', margin: '1rem 0' }}>✅</p><p className="text-muted">No open shifts</p></div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+          {openShifts.map(shift => (
+            <div key={shift.id} className="card" style={{ padding: '1rem' }}>
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                <div>
+                  <div style={{ fontWeight: '600' }}>{shift.client_first_name} {shift.client_last_name}</div>
+                  <div style={{ fontSize: '0.9rem', color: '#666' }}>📅 {formatDate(shift.date)}</div>
+                  <div style={{ fontSize: '0.9rem', color: '#666' }}>🕐 {formatTime(shift.start_time)} - {formatTime(shift.end_time)}</div>
+                </div>
+                <button className="btn btn-sm btn-primary" onClick={() => handlePickupShift(shift.id)}>Claim</button>
+              </div>
+            </div>
+          ))}
+        </div>
+      )}
+    </>
+  );
+
+  const renderAvailabilityPage = () => (
+    <>
+      <div className="schedule-header"><h3>⏰ My Availability</h3></div>
+      <div className="card">
+        <div className="form-group">
+          <label>Status</label>
+          <select value={availability.status} onChange={(e) => setAvailability({ ...availability, status: e.target.value })}>
+            <option value="available">✅ Available</option>
+            <option value="limited">⚠️ Limited</option>
+            <option value="unavailable">❌ Unavailable</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Max Hours/Week: {availability.maxHoursPerWeek}</label>
+          <input type="range" min="0" max="60" value={availability.maxHoursPerWeek} onChange={(e) => setAvailability({ ...availability, maxHoursPerWeek: parseInt(e.target.value) })} style={{ width: '100%' }} />
+        </div>
+        <div className="form-group">
+          <label>Weekly Schedule</label>
+          {[0,1,2,3,4,5,6].map(day => {
+            const d = availability.weeklyAvailability[day] || { available: false, start: '09:00', end: '17:00' };
+            return (
+              <div key={day} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.5rem', background: d.available ? '#D1FAE5' : '#F3F4F6', borderRadius: '6px', marginBottom: '0.25rem' }}>
+                <input type="checkbox" checked={d.available} onChange={(e) => {
+                  const u = { ...availability.weeklyAvailability };
+                  u[day] = { ...d, available: e.target.checked };
+                  setAvailability({ ...availability, weeklyAvailability: u });
+                }} style={{ width: 'auto' }} />
+                <span style={{ width: '60px', fontWeight: '500' }}>{getDayName(day).slice(0,3)}</span>
+                {d.available && (
+                  <>
+                    <input type="time" value={d.start} onChange={(e) => {
+                      const u = { ...availability.weeklyAvailability };
+                      u[day] = { ...d, start: e.target.value };
+                      setAvailability({ ...availability, weeklyAvailability: u });
+                    }} style={{ padding: '0.25rem' }} />
+                    <span>-</span>
+                    <input type="time" value={d.end} onChange={(e) => {
+                      const u = { ...availability.weeklyAvailability };
+                      u[day] = { ...d, end: e.target.value };
+                      setAvailability({ ...availability, weeklyAvailability: u });
+                    }} style={{ padding: '0.25rem' }} />
+                  </>
+                )}
+              </div>
+            );
+          })}
+        </div>
+        <div className="form-group">
+          <label>Notes</label>
+          <textarea value={availability.notes} onChange={(e) => setAvailability({ ...availability, notes: e.target.value })} rows={2} placeholder="Any notes..." />
+        </div>
+        <button className="btn btn-primary btn-block" onClick={handleSaveAvailability}>💾 Save</button>
+      </div>
+    </>
+  );
+
+  const renderTimeOffPage = () => (
+    <>
+      <div className="schedule-header"><h3>🏖️ Time Off</h3></div>
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <h4 style={{ margin: '0 0 1rem 0' }}>Request Time Off</h4>
+        <form onSubmit={handleRequestTimeOff}>
+          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+            <div className="form-group" style={{ margin: 0 }}>
+              <label>Start</label>
+              <input type="date" value={newTimeOff.startDate} onChange={(e) => setNewTimeOff({ ...newTimeOff, startDate: e.target.value })} min={new Date().toISOString().split('T')[0]} required />
+            </div>
+            <div className="form-group" style={{ margin: 0 }}>
+              <label>End</label>
+              <input type="date" value={newTimeOff.endDate} onChange={(e) => setNewTimeOff({ ...newTimeOff, endDate: e.target.value })} min={newTimeOff.startDate || new Date().toISOString().split('T')[0]} required />
+            </div>
+          </div>
+          <div className="form-group">
+            <label>Reason</label>
+            <input type="text" value={newTimeOff.reason} onChange={(e) => setNewTimeOff({ ...newTimeOff, reason: e.target.value })} placeholder="Vacation, etc." />
+          </div>
+          <button type="submit" className="btn btn-primary">Submit</button>
+        </form>
+      </div>
+      <div className="card">
+        <h4 style={{ margin: '0 0 1rem 0' }}>My Requests</h4>
+        {timeOffRequests.length === 0 ? <p className="text-muted text-center">None</p> : (
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+            {timeOffRequests.map(r => (
+              <div key={r.id} style={{ padding: '0.75rem', borderRadius: '6px', background: r.status === 'approved' ? '#D1FAE5' : r.status === 'denied' ? '#FEE2E2' : '#FEF3C7', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                <div>
+                  <div style={{ fontWeight: '500' }}>{formatDate(r.start_date)} - {formatDate(r.end_date)}</div>
+                  {r.reason && <div style={{ fontSize: '0.85rem', color: '#666' }}>{r.reason}</div>}
+                </div>
+                <span style={{ padding: '0.25rem 0.75rem', borderRadius: '12px', fontSize: '0.75rem', fontWeight: '600', background: r.status === 'approved' ? '#059669' : r.status === 'denied' ? '#DC2626' : '#D97706', color: '#fff' }}>
+                  {(r.status || 'pending').toUpperCase()}
+                </span>
+              </div>
+            ))}
+          </div>
+        )}
+      </div>
+    </>
+  );
+
+  const renderSchedulePage = () => {
+    const recurring = schedules.filter(s => s.day_of_week != null);
+    const oneTime = schedules.filter(s => s.date);
+    const grouped = {};
+    recurring.forEach(s => { if (!grouped[s.day_of_week]) grouped[s.day_of_week] = []; grouped[s.day_of_week].push(s); });
+
+    return (
+      <>
+        <div className="schedule-header"><h3>📅 My Schedule</h3></div>
+        {schedules.length === 0 ? <div className="card text-center"><p className="text-muted">No schedules</p></div> : (
+          <div>
+            {Object.keys(grouped).sort().map(day => (
+              <div key={day} className="card" style={{ marginBottom: '0.75rem' }}>
+                <div style={{ fontWeight: '600', color: '#2563eb' }}>{getDayName(parseInt(day))}s</div>
+                {grouped[day].map(s => (
+                  <div key={s.id} style={{ padding: '0.5rem 0', borderTop: '1px solid #eee' }}>
+                    <div style={{ fontWeight: '500' }}>{getClientName(s.client_id)}</div>
+                    <div style={{ fontSize: '0.9rem', color: '#666' }}>{formatTime(s.start_time)} - {formatTime(s.end_time)}</div>
+                  </div>
+                ))}
+              </div>
+            ))}
+            {oneTime.length > 0 && (
+              <div className="card">
+                <div style={{ fontWeight: '600', color: '#059669' }}>Upcoming</div>
+                {oneTime.sort((a,b) => new Date(a.date) - new Date(b.date)).map(s => (
+                  <div key={s.id} style={{ padding: '0.5rem 0', borderTop: '1px solid #eee' }}>
+                    <div style={{ fontWeight: '500' }}>{formatDate(s.date)}</div>
+                    <div>{getClientName(s.client_id)}</div>
+                    <div style={{ fontSize: '0.9rem', color: '#666' }}>{formatTime(s.start_time)} - {formatTime(s.end_time)}</div>
+                  </div>
+                ))}
+              </div>
+            )}
+          </div>
+        )}
+      </>
+    );
+  };
+
+  const renderHistoryPage = () => (
+    <div className="card">
+      <div className="card-title">Recent Visits</div>
+      {recentVisits.length === 0 ? <p className="text-muted text-center">None</p> : (
+        <div style={{ overflowX: 'auto' }}>
+          <table className="table">
+            <thead><tr><th>Date</th><th>Client</th><th>Hours</th></tr></thead>
+            <tbody>
+              {recentVisits.map((v, i) => (
+                <tr key={v.id || i}>
+                  <td>{formatDate(v.start_time)}</td>
+                  <td><span onClick={() => setViewingClientId(v.client_id)} style={{ cursor: 'pointer', color: '#007bff' }}>{v.client_name || getClientName(v.client_id)}</span></td>
+                  <td>{v.hours_worked ? `${parseFloat(v.hours_worked).toFixed(2)}h` : '-'}</td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        </div>
+      )}
+    </div>
+  );
+
+  const renderClientsPage = () => {
+    const myClients = clients.filter(c => schedules.some(s => s.client_id === c.id));
+    return (
+      <>
+        <div className="schedule-header"><h3>👥 My Clients</h3></div>
+        {myClients.length === 0 ? <div className="card text-center"><p className="text-muted">No clients</p></div> : (
+          <div style={{ display: 'grid', gap: '0.75rem' }}>
+            {myClients.map(c => (
+              <div key={c.id} className="card" onClick={() => setViewingClientId(c.id)} style={{ cursor: 'pointer' }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                  <div>
+                    <h4 style={{ margin: 0 }}>{c.first_name} {c.last_name}</h4>
+                    <p style={{ margin: '0.25rem 0 0 0', color: '#666', fontSize: '0.9rem' }}>📞 {c.phone || 'N/A'} • 📍 {c.city || 'N/A'}</p>
+                  </div>
+                  <span style={{ color: '#007bff', fontSize: '1.2rem' }}>→</span>
+                </div>
+              </div>
+            ))}
+          </div>
+        )}
+      </>
+    );
+  };
+
+  const renderSettingsPage = () => (
+    <>
+      <div className="card">
+        <div className="card-title">Profile</div>
+        <div className="form-group"><label>Name</label><input type="text" value={user.name || `${user.first_name} ${user.last_name}`} disabled /></div>
+        <div className="form-group"><label>Email</label><input type="text" value={user.email} disabled /></div>
+      </div>
+      <div className="card">
+        <div className="card-title">GPS Status</div>
+        <div className={`alert ${location ? 'alert-success' : 'alert-info'}`}>
+          {location ? <>GPS Active (±{location.accuracy?.toFixed(0)}m)</> : <>{locationError || 'Location unavailable'} - Clock in still works</>}
+        </div>
+      </div>
+      <button className="btn btn-danger btn-block" onClick={onLogout}>Log Out</button>
+    </>
+  );
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  return (
+    <div style={{ display: 'flex', width: '100%', height: '100%' }}>
+      {message.text && (
+        <div style={{ position: 'fixed', top: '1rem', right: '1rem', padding: '1rem 1.5rem', borderRadius: '8px', zIndex: 1001, background: message.type === 'error' ? '#FEE2E2' : '#D1FAE5', color: message.type === 'error' ? '#DC2626' : '#059669', boxShadow: '0 4px 12px rgba(0,0,0,0.15)' }}>
+          {message.text}
+        </div>
+      )}
+
+      {sidebarOpen && window.innerWidth <= 768 && <div className="sidebar-overlay active" onClick={() => setSidebarOpen(false)} />}
+
+      <div className={`sidebar ${sidebarOpen ? 'open' : ''}`}>
+        <div className="sidebar-logo">CVHC</div>
+        <ul className="sidebar-nav">
+          <li><a href="#" className={currentPage === 'home' ? 'active' : ''} onClick={() => handlePageClick('home')}>🏠 Home</a></li>
+          <li><a href="#" className={currentPage === 'schedule' ? 'active' : ''} onClick={() => handlePageClick('schedule')}>📅 Schedule</a></li>
+          <li><a href="#" className={currentPage === 'clients' ? 'active' : ''} onClick={() => handlePageClick('clients')}>👥 Clients</a></li>
+          <li><a href="#" className={currentPage === 'history' ? 'active' : ''} onClick={() => handlePageClick('history')}>📜 History</a></li>
+          <li style={{ paddingTop: '1rem', borderTop: '1px solid rgba(255,255,255,0.1)', marginTop: '0.5rem' }}>
+            <span style={{ fontSize: '0.65rem', textTransform: 'uppercase', color: 'rgba(255,255,255,0.4)', display: 'block', padding: '0.5rem 1rem' }}>Self Service</span>
+          </li>
+          <li><a href="#" className={currentPage === 'open-shifts' ? 'active' : ''} onClick={() => handlePageClick('open-shifts')}>📋 Open Shifts</a></li>
+          <li><a href="#" className={currentPage === 'availability' ? 'active' : ''} onClick={() => handlePageClick('availability')}>⏰ Availability</a></li>
+          <li><a href="#" className={currentPage === 'miss-report' ? 'active' : ''} onClick={() => handlePageClick('miss-report')}>🚨 Report Miss</a></li>
+          <li><a href="#" className={currentPage === 'time-off' ? 'active' : ''} onClick={() => handlePageClick('time-off')}>🏖️ Time Off</a></li>
+          <li style={{ paddingTop: '1rem', borderTop: '1px solid rgba(255,255,255,0.1)', marginTop: '0.5rem' }}>
+            <a href="#" className={currentPage === 'settings' ? 'active' : ''} onClick={() => handlePageClick('settings')}>⚙️ Settings</a>
+          </li>
+        </ul>
+        <div className="sidebar-user">
+          <div className="sidebar-user-name">{user.name || `${user.first_name || ''} ${user.last_name || ''}`}</div>
+          <div className="sidebar-user-role">Caregiver</div>
+          <button className="btn-logout" onClick={onLogout}>Logout</button>
+        </div>
+      </div>
+
+      <div className="main-content">
+        <div className="header">
+          <div><h1>Chippewa Valley Home Care</h1><p>Caregiver Portal</p></div>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+            <button className="hamburger-btn" onClick={() => setSidebarOpen(!sidebarOpen)}>Menu</button>
+            <button
+              onClick={onLogout}
+              style={{
+                padding: '0.4rem 0.85rem', borderRadius: '8px', border: 'none',
+                background: '#FEE2E2', color: '#DC2626', fontWeight: '700',
+                fontSize: '0.82rem', cursor: 'pointer', whiteSpace: 'nowrap'
+              }}>
+              ⏻ Logout
+            </button>
+          </div>
+        </div>
+        <div className="container">
+          {currentPage === 'home' && renderHomePage()}
+          {currentPage === 'schedule' && renderSchedulePage()}
+          {currentPage === 'clients' && renderClientsPage()}
+          {currentPage === 'history' && renderHistoryPage()}
+          {currentPage === 'open-shifts' && renderOpenShiftsPage()}
+          {currentPage === 'availability' && renderAvailabilityPage()}
+          {currentPage === 'time-off' && renderTimeOffPage()}
+          {currentPage === 'miss-report' && renderMissReportPage()}
+          {currentPage === 'settings' && renderSettingsPage()}
+        </div>
+      </div>
+
+      {showNoteModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header"><h2>Visit Notes</h2><button className="close-btn" onClick={() => setShowNoteModal(false)}>×</button></div>
+            <p className="text-muted">Add notes (optional)</p>
+            <div className="form-group"><textarea value={visitNote} onChange={(e) => setVisitNote(e.target.value)} placeholder="How did the visit go?" rows={4} /></div>
+            <div className="form-actions">
+              <button className="btn btn-secondary" onClick={() => setShowNoteModal(false)}>Cancel</button>
+              <button className="btn btn-primary" onClick={completeClockOut}>Clock Out</button>
+            </div>
+          </div>
+        </div>
+      )}
+
+      <CaregiverClientModal clientId={viewingClientId} isOpen={!!viewingClientId} onClose={() => setViewingClientId(null)} token={token} />
+
+      {/* Messages Modal */}
+      {showMessages && <CaregiverMessages token={token} onClose={() => { setShowMessages(false); setUnreadMessages(0); }} />}
+
+      {/* Help Modal */}
+      {showHelp && <CaregiverHelp onClose={() => setShowHelp(false)} />}
+
+      {/* Shift Miss Report Modal */}
+      {showMissReport && (
+        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', zIndex: 9999, display: 'flex', alignItems: 'flex-end', justifyContent: 'center' }}>
+          <div style={{ background: '#fff', borderRadius: '16px 16px 0 0', padding: '1.5rem', width: '100%', maxWidth: '500px', maxHeight: '90vh', overflowY: 'auto' }}>
+            <ShiftMissReport token={token} userId={user.id} onClose={() => setShowMissReport(false)} />
+          </div>
+        </div>
+      )}
+
+      {/* ── Mobile Bottom Navigation ── */}
+      {showMoreDrawer && <div className="mobile-more-drawer-overlay" onClick={() => setShowMoreDrawer(false)} />}
+
+      <div className={`mobile-more-drawer ${showMoreDrawer ? 'open' : ''}`}>
+        <div className="mobile-more-drawer-handle" />
+        <div className="mobile-more-drawer-section">
+          <div className="mobile-more-drawer-section-title">Self Service</div>
+          {[
+            { page: 'open-shifts',   icon: '📋', label: 'Open Shifts' },
+            { page: 'availability',  icon: '⏰', label: 'Availability' },
+            { page: 'miss-report',   icon: '🚨', label: 'Report Miss' },
+            { page: 'time-off',      icon: '🏖️', label: 'Time Off' },
+          ].map(({ page, icon, label }) => (
+            <button
+              key={page}
+              className={`mobile-more-drawer-item ${currentPage === page ? 'active' : ''}`}
+              onClick={() => { setCurrentPage(page); setShowMoreDrawer(false); }}
+            >
+              <span className="mobile-more-drawer-item-icon">{icon}</span>
+              {label}
+            </button>
+          ))}
+        </div>
+        <div className="mobile-more-drawer-section">
+          <div className="mobile-more-drawer-section-title">Account</div>
+          <button
+            className={`mobile-more-drawer-item ${currentPage === 'settings' ? 'active' : ''}`}
+            onClick={() => { setCurrentPage('settings'); setShowMoreDrawer(false); }}
+          >
+            <span className="mobile-more-drawer-item-icon">⚙️</span>
+            Settings
+          </button>
+          <button
+            className="mobile-more-drawer-item"
+            onClick={onLogout}
+            style={{ color: '#DC2626' }}
+          >
+            <span className="mobile-more-drawer-item-icon" style={{ background: '#FEE2E2' }}>⏻</span>
+            Log Out
+          </button>
+        </div>
+      </div>
+
+      <nav className="mobile-bottom-nav">
+        {[
+          { page: 'home',     icon: '🏠', label: 'Home' },
+          { page: 'schedule', icon: '📅', label: 'Schedule' },
+          { page: 'clients',  icon: '👥', label: 'Clients' },
+          { page: 'history',  icon: '📜', label: 'History' },
+        ].map(({ page, icon, label }) => (
+          <button
+            key={page}
+            className={`mobile-bottom-nav-item ${currentPage === page ? 'active' : ''}`}
+            onClick={() => { setCurrentPage(page); setShowMoreDrawer(false); }}
+          >
+            <span className="mobile-bottom-nav-icon">{icon}</span>
+            {label}
+          </button>
+        ))}
+        <button
+          className={`mobile-bottom-nav-item ${showMoreDrawer ? 'active' : ''}`}
+          onClick={() => setShowMoreDrawer(v => !v)}
+        >
+          <span className="mobile-bottom-nav-icon">⋯</span>
+          More
+        </button>
+      </nav>
+    </div>
+  );
+};
+
+export default CaregiverDashboard;
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverHelp.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverHelp.jsx
new file mode 100644
index 0000000..2d84724
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverHelp.jsx
@@ -0,0 +1,284 @@
+// src/components/caregiver/CaregiverHelp.jsx
+// Mobile-first help guide for caregivers
+import React, { useState } from 'react';
+
+const TOPICS = [
+  {
+    id: 'clockin',
+    icon: '⏰',
+    title: 'How to Clock In',
+    color: '#2ABBA7',
+    bg: '#F0FDFB',
+    steps: [
+      { step: '1', text: 'Arrive at the client\'s home first — clock in from inside or just outside, not from your car.' },
+      { step: '2', text: 'Open the app and look for "Ready to Start a Shift?" on the home screen.' },
+      { step: '3', text: 'Tap the "Select Client" dropdown and choose your client\'s name.' },
+      { step: '4', text: 'Wait until you see "GPS Active" — this confirms your location is recorded.' },
+      { step: '5', text: 'Tap the green "▶️ Clock In" button.' },
+      { step: '6', text: 'You\'ll get a push notification confirming you\'re clocked in. You\'re good to go!' },
+    ],
+    tips: ['Always clock in from the client\'s home — GPS records where you are.', 'If GPS shows "unavailable," you can still clock in — just let your supervisor know.'],
+    warning: 'Do not clock in before you arrive at the client\'s home.'
+  },
+  {
+    id: 'clockout',
+    icon: '🛑',
+    title: 'How to Clock Out',
+    color: '#EF4444',
+    bg: '#FEF2F2',
+    steps: [
+      { step: '1', text: 'When your shift is complete, go back to the home screen.' },
+      { step: '2', text: 'You\'ll see a red "🛑 Clock Out" button and a timer showing how long you\'ve been working.' },
+      { step: '3', text: 'Tap "Clock Out."' },
+      { step: '4', text: 'You\'ll get a push notification confirming your clock-out with your total hours for the shift.' },
+    ],
+    tips: ['Always clock out as soon as your shift ends — don\'t wait until you get home.', 'If you forgot to clock out, call your supervisor right away.'],
+    warning: 'Leaving a shift open affects your payroll and triggers an alert for supervisors.'
+  },
+  {
+    id: 'missreport',
+    icon: '🚨',
+    title: 'I Can\'t Make My Shift',
+    color: '#EF4444',
+    bg: '#FEF2F2',
+    steps: [
+      { step: '1', text: 'Tap the red "🚨 Miss Report" card on your home screen as soon as you know you can\'t make it.' },
+      { step: '2', text: 'If your upcoming shifts are shown, tap the one you can\'t make to auto-fill the date.' },
+      { step: '3', text: 'Select your reason from the dropdown.' },
+      { step: '4', text: 'Add any notes if helpful (optional).' },
+      { step: '5', text: 'Tap "🚨 Submit Miss Report." Your supervisor is notified immediately.' },
+    ],
+    tips: ['Submit as early as possible — give your supervisor at least 2 hours if you can.', 'Follow up by phone if you don\'t hear back within 30 minutes.'],
+    warning: 'Submitting a miss report does not guarantee approval. Always follow up if you\'re unsure.'
+  },
+  {
+    id: 'schedule',
+    icon: '📅',
+    title: 'Viewing My Schedule',
+    color: '#6366F1',
+    bg: '#EEF2FF',
+    steps: [
+      { step: '1', text: 'Tap the 📅 Schedule tab at the bottom of the app.' },
+      { step: '2', text: 'Your upcoming shifts are listed in order, showing client, date, and time.' },
+      { step: '3', text: 'Tap any shift to see the full details including the client\'s address.' },
+      { step: '4', text: 'Tap "Select for Clock-In" to pre-load that client on the home screen so it\'s ready when you arrive.' },
+    ],
+    tips: ['Check your schedule the night before to plan your day.', 'If you see a shift you don\'t recognize, contact your supervisor before that date.'],
+    warning: null
+  },
+  {
+    id: 'openshifts',
+    icon: '📋',
+    title: 'Picking Up Open Shifts',
+    color: '#F59E0B',
+    bg: '#FFFBEB',
+    steps: [
+      { step: '1', text: 'Tap "📋 Open Shifts" on the home screen.' },
+      { step: '2', text: 'Browse available shifts — each one shows the client, date, time, and duration.' },
+      { step: '3', text: 'Tap a shift to see full details.' },
+      { step: '4', text: 'Tap "Claim Shift" if you want it.' },
+      { step: '5', text: 'Your supervisor will receive a notification and confirm the assignment. You\'ll be notified once it\'s confirmed.' },
+    ],
+    tips: ['You don\'t have the shift until your supervisor confirms it — don\'t assume it\'s yours just from claiming.'],
+    warning: null
+  },
+  {
+    id: 'availability',
+    icon: '🗓️',
+    title: 'Setting My Availability',
+    color: '#8B5CF6',
+    bg: '#F5F3FF',
+    steps: [
+      { step: '1', text: 'Tap "⏰ Availability" on the home screen.' },
+      { step: '2', text: 'For each day of the week, toggle it on or off depending on whether you\'re available.' },
+      { step: '3', text: 'For days you\'re available, set your earliest start time and latest end time.' },
+      { step: '4', text: 'Set your maximum hours per week if you want to limit how much you\'re scheduled.' },
+      { step: '5', text: 'Tap Save.' },
+    ],
+    tips: ['Your availability is used when supervisors search for emergency coverage.', 'To request time off, scroll down in the Availability screen to the Time Off section.'],
+    warning: 'Approved time off blocks new assignments but does NOT automatically remove existing shifts. Talk to your supervisor about shifts during your time off.'
+  },
+  {
+    id: 'gps',
+    icon: '📍',
+    title: 'GPS & Location',
+    color: '#10B981',
+    bg: '#F0FDF4',
+    steps: null,
+    faq: [
+      { q: 'Why does the app need my location?', a: 'GPS verifies you\'re at the client\'s home when you clock in and records your route during the shift. This protects you and the client.' },
+      { q: 'What does "GPS Active (±Xm)" mean?', a: 'Your location is working. The number is accuracy in meters — lower is better. Under 20m is great.' },
+      { q: 'What if GPS shows unavailable?', a: 'Check that Location permissions are set to "Always Allow" for this app in your phone Settings. Try stepping outside. You can still clock in even without GPS.' },
+      { q: 'Does GPS run all shift?', a: 'Yes — it records a trail of your movements during the shift, which your supervisor can view as a map. It stops when you clock out.' },
+      { q: 'Can I turn off GPS?', a: 'You can, but it may prevent you from clocking in. Your employer requires GPS for compliance.' },
+    ],
+    tips: [],
+    warning: null
+  },
+  {
+    id: 'mileage',
+    icon: '🚗',
+    title: 'Mileage Tracking',
+    color: '#64748B',
+    bg: '#F8FAFC',
+    steps: [
+      { step: '1', text: 'Tap the 🚗 Mileage icon or find Mileage in the menu.' },
+      { step: '2', text: 'Tap "Start Trip" when you leave home or your previous location.' },
+      { step: '3', text: 'Drive to your destination.' },
+      { step: '4', text: 'Tap "End Trip" when you arrive. The trip is logged with distance and a map.' },
+    ],
+    tips: ['Your GPS route during each shift is saved automatically — your supervisor can see it. The mileage tracker is for trips between locations (home to client, client to client, etc.).', 'Talk to your supervisor about what trips qualify for reimbursement.'],
+    warning: null
+  },
+  {
+    id: 'forgot',
+    icon: '🔑',
+    title: 'Forgot Password / Login Issues',
+    color: '#6B7280',
+    bg: '#F9FAFB',
+    steps: [
+      { step: '1', text: 'On the login screen, tap "Forgot Password."' },
+      { step: '2', text: 'Enter your email address and tap Send Reset Link.' },
+      { step: '3', text: 'Check your email (including spam/junk folder).' },
+      { step: '4', text: 'Click the link in the email and enter a new password.' },
+      { step: '5', text: 'If you still can\'t log in, contact your supervisor to reset your account.' },
+    ],
+    tips: ['Make sure you\'re using the email your employer has on file for you.'],
+    warning: null
+  },
+];
+
+const CaregiverHelp = ({ onClose }) => {
+  const [activeTopic, setActiveTopic] = useState(null);
+  const [search, setSearch] = useState('');
+
+  const topic = TOPICS.find(t => t.id === activeTopic);
+
+  const filtered = TOPICS.filter(t =>
+    !search ||
+    t.title.toLowerCase().includes(search.toLowerCase()) ||
+    (t.steps || []).some(s => s.text.toLowerCase().includes(search.toLowerCase())) ||
+    (t.faq || []).some(f => f.q.toLowerCase().includes(search.toLowerCase()))
+  );
+
+  return (
+    <div style={{ position: 'fixed', inset: 0, background: '#fff', zIndex: 9999, display: 'flex', flexDirection: 'column', overflowY: 'hidden' }}>
+      {/* Header */}
+      <div style={{ padding: '1rem 1rem 0.75rem', borderBottom: '1px solid #E5E7EB', background: '#fff', flexShrink: 0 }}>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.75rem' }}>
+          {topic ? (
+            <button onClick={() => setActiveTopic(null)} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '1rem', padding: 0 }}>←</button>
+          ) : (
+            <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#6B7280', fontSize: '1.2rem', padding: 0 }}>✕</button>
+          )}
+          <div style={{ flex: 1 }}>
+            <h2 style={{ margin: 0, fontSize: '1.1rem', fontWeight: '800', color: '#111827' }}>
+              {topic ? topic.title : '❓ Help & How-To'}
+            </h2>
+            {!topic && <p style={{ margin: 0, fontSize: '0.8rem', color: '#6B7280' }}>Tap any topic for step-by-step help</p>}
+          </div>
+        </div>
+        {!topic && (
+          <input
+            placeholder="🔍 Search help topics..."
+            value={search}
+            onChange={e => setSearch(e.target.value)}
+            style={{ width: '100%', padding: '0.6rem 0.875rem', border: '1px solid #D1D5DB', borderRadius: '10px', fontSize: '0.9rem', boxSizing: 'border-box', outline: 'none', background: '#F9FAFB' }}
+          />
+        )}
+      </div>
+
+      {/* Body */}
+      <div style={{ flex: 1, overflowY: 'auto', padding: '1rem' }}>
+        {topic ? (
+          /* Single topic view */
+          <div>
+            {/* Topic header card */}
+            <div style={{ background: topic.bg, borderRadius: '14px', padding: '1.25rem', marginBottom: '1.25rem', display: 'flex', alignItems: 'center', gap: '1rem' }}>
+              <span style={{ fontSize: '2.5rem' }}>{topic.icon}</span>
+              <div>
+                <h3 style={{ margin: 0, fontSize: '1.1rem', fontWeight: '800', color: topic.color }}>{topic.title}</h3>
+                {topic.steps && <p style={{ margin: 0, fontSize: '0.82rem', color: '#6B7280', marginTop: '0.2rem' }}>{topic.steps.length} steps</p>}
+              </div>
+            </div>
+
+            {/* Warning */}
+            {topic.warning && (
+              <div style={{ background: '#FEF2F2', border: '1px solid #FCA5A5', borderRadius: '10px', padding: '0.875rem 1rem', marginBottom: '1rem', display: 'flex', gap: '0.5rem', alignItems: 'flex-start' }}>
+                <span style={{ flexShrink: 0 }}>⚠️</span>
+                <p style={{ margin: 0, fontSize: '0.875rem', color: '#991B1B', fontWeight: '600' }}>{topic.warning}</p>
+              </div>
+            )}
+
+            {/* Steps */}
+            {topic.steps && (
+              <div style={{ marginBottom: '1.25rem' }}>
+                {topic.steps.map((s, i) => (
+                  <div key={i} style={{ display: 'flex', gap: '0.875rem', marginBottom: '0.875rem', alignItems: 'flex-start' }}>
+                    <div style={{ width: '2rem', height: '2rem', borderRadius: '50%', background: topic.color, color: '#fff', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: '800', fontSize: '0.9rem', flexShrink: 0 }}>{s.step}</div>
+                    <p style={{ margin: 0, fontSize: '0.9rem', color: '#374151', lineHeight: 1.6, paddingTop: '0.3rem' }}>{s.text}</p>
+                  </div>
+                ))}
+              </div>
+            )}
+
+            {/* FAQ */}
+            {topic.faq && (
+              <div style={{ marginBottom: '1.25rem' }}>
+                {topic.faq.map((f, i) => (
+                  <div key={i} style={{ marginBottom: '0.875rem', padding: '0.875rem 1rem', background: '#F9FAFB', borderRadius: '10px', border: '1px solid #E5E7EB' }}>
+                    <p style={{ margin: '0 0 0.4rem', fontWeight: '700', color: '#111827', fontSize: '0.875rem' }}>Q: {f.q}</p>
+                    <p style={{ margin: 0, color: '#4B5563', fontSize: '0.875rem', lineHeight: 1.6 }}>{f.a}</p>
+                  </div>
+                ))}
+              </div>
+            )}
+
+            {/* Tips */}
+            {topic.tips?.length > 0 && (
+              <div style={{ background: '#F0FDFB', border: '1px solid #A7F3D0', borderRadius: '10px', padding: '0.875rem 1rem' }}>
+                <p style={{ margin: '0 0 0.5rem', fontWeight: '700', color: '#065F46', fontSize: '0.85rem' }}>💡 Tips</p>
+                {topic.tips.map((tip, i) => (
+                  <p key={i} style={{ margin: i < topic.tips.length - 1 ? '0 0 0.4rem' : 0, fontSize: '0.85rem', color: '#065F46', lineHeight: 1.6 }}>• {tip}</p>
+                ))}
+              </div>
+            )}
+
+            {/* Still need help */}
+            <div style={{ marginTop: '1.5rem', padding: '1rem', background: '#F3F4F6', borderRadius: '10px', textAlign: 'center' }}>
+              <p style={{ margin: '0 0 0.25rem', fontWeight: '700', color: '#374151', fontSize: '0.875rem' }}>Still stuck?</p>
+              <p style={{ margin: 0, fontSize: '0.82rem', color: '#6B7280' }}>Call or text your supervisor directly.</p>
+            </div>
+          </div>
+        ) : (
+          /* Topic list */
+          <div>
+            {filtered.length === 0 ? (
+              <div style={{ textAlign: 'center', padding: '3rem 1rem', color: '#6B7280' }}>
+                <div style={{ fontSize: '2.5rem', marginBottom: '0.75rem' }}>🔍</div>
+                <p style={{ fontWeight: '700', margin: '0 0 0.5rem' }}>No results for "{search}"</p>
+                <p style={{ fontSize: '0.85rem', margin: 0 }}>Try different words or scroll through all topics below.</p>
+              </div>
+            ) : (
+              filtered.map((t) => (
+                <button key={t.id} onClick={() => setActiveTopic(t.id)}
+                  style={{ display: 'flex', alignItems: 'center', gap: '1rem', width: '100%', padding: '1rem', background: t.bg, border: `1px solid ${t.color}22`, borderRadius: '12px', marginBottom: '0.625rem', cursor: 'pointer', textAlign: 'left', WebkitTapHighlightColor: 'transparent' }}>
+                  <span style={{ fontSize: '2rem', flexShrink: 0 }}>{t.icon}</span>
+                  <div style={{ flex: 1 }}>
+                    <div style={{ fontWeight: '700', color: '#111827', fontSize: '0.95rem', marginBottom: '0.15rem' }}>{t.title}</div>
+                    <div style={{ fontSize: '0.78rem', color: '#6B7280' }}>
+                      {t.steps ? `${t.steps.length} steps` : t.faq ? `${t.faq.length} questions` : 'Tap to view'}
+                    </div>
+                  </div>
+                  <span style={{ color: t.color, fontSize: '1.2rem', fontWeight: '700' }}>›</span>
+                </button>
+              ))
+            )}
+          </div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+export default CaregiverHelp;
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverMessages.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverMessages.jsx
new file mode 100644
index 0000000..ca8c9c7
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverMessages.jsx
@@ -0,0 +1,192 @@
+// src/components/caregiver/CaregiverMessages.jsx
+// Mobile-first message inbox for caregivers
+import React, { useState, useEffect, useRef, useCallback } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+const CaregiverMessages = ({ token, onClose }) => {
+  const [view, setView] = useState('inbox');
+  const [threads, setThreads] = useState([]);
+  const [activeThread, setActiveThread] = useState(null);
+  const [messages, setMessages] = useState([]);
+  const [replyBody, setReplyBody] = useState('');
+  const [loading, setLoading] = useState(true);
+  const [sending, setSending] = useState(false);
+  const messagesEndRef = useRef(null);
+  const pollRef = useRef(null);
+
+  const headers = { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` };
+
+  // Decode user id from JWT
+  const myId = (() => { try { return JSON.parse(atob(token.split('.')[1])).id; } catch { return null; } })();
+
+  const loadInbox = useCallback(async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/inbox`, { headers });
+      if (res.ok) setThreads(await res.json());
+    } catch (e) { /* silent */ }
+    finally { setLoading(false); }
+  }, [token]);
+
+  useEffect(() => {
+    loadInbox();
+    pollRef.current = setInterval(loadInbox, 20000);
+    return () => clearInterval(pollRef.current);
+  }, [loadInbox]);
+
+  useEffect(() => {
+    if (view === 'thread') messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
+  }, [messages, view]);
+
+  const openThread = async (thread) => {
+    setActiveThread(thread);
+    setView('thread');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/thread/${thread.id}`, { headers });
+      if (res.ok) {
+        const data = await res.json();
+        setMessages(data.messages);
+        setThreads(prev => prev.map(t => t.id === thread.id ? { ...t, unread_count: 0 } : t));
+      }
+    } catch (e) { toast('Could not load messages', 'error'); }
+  };
+
+  const sendReply = async () => {
+    if (!replyBody.trim() || sending) return;
+    setSending(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/messages/thread/${activeThread.id}/reply`, {
+        method: 'POST', headers, body: JSON.stringify({ body: replyBody })
+      });
+      if (res.ok) {
+        const msg = await res.json();
+        setMessages(prev => [...prev, msg]);
+        setReplyBody('');
+      } else toast('Failed to send', 'error');
+    } catch (e) { toast('Failed to send', 'error'); }
+    finally { setSending(false); }
+  };
+
+  const formatTime = (ts) => {
+    if (!ts) return '';
+    const d = new Date(ts);
+    const now = new Date();
+    const diff = now - d;
+    if (diff < 60000) return 'just now';
+    if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
+    if (diff < 86400000) return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
+    if (diff < 604800000) return d.toLocaleDateString([], { weekday: 'short' });
+    return d.toLocaleDateString([], { month: 'short', day: 'numeric' });
+  };
+
+  const totalUnread = threads.reduce((sum, t) => sum + (parseInt(t.unread_count) || 0), 0);
+
+  // ─── INBOX ───────────────────────────────────────────────────────────────
+  if (view === 'inbox') return (
+    <div style={{ position: 'fixed', inset: 0, background: '#fff', zIndex: 9999, display: 'flex', flexDirection: 'column' }}>
+      {/* Header */}
+      <div style={{ padding: '1rem', borderBottom: '1px solid #E5E7EB', display: 'flex', alignItems: 'center', gap: '0.875rem', flexShrink: 0 }}>
+        <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#6B7280', fontSize: '1.25rem', padding: 0 }}>✕</button>
+        <div style={{ flex: 1 }}>
+          <h2 style={{ margin: 0, fontSize: '1.1rem', fontWeight: '800', color: '#111827' }}>
+            💬 Messages
+            {totalUnread > 0 && <span style={{ background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.65rem', padding: '2px 7px', marginLeft: '0.4rem', verticalAlign: 'middle' }}>{totalUnread}</span>}
+          </h2>
+          <p style={{ margin: 0, fontSize: '0.78rem', color: '#6B7280' }}>From your team</p>
+        </div>
+      </div>
+
+      {/* List */}
+      <div style={{ flex: 1, overflowY: 'auto', padding: '0.75rem' }}>
+        {loading ? (
+          <div style={{ textAlign: 'center', padding: '3rem', color: '#9CA3AF' }}>Loading...</div>
+        ) : threads.length === 0 ? (
+          <div style={{ textAlign: 'center', padding: '4rem 1rem', color: '#9CA3AF' }}>
+            <div style={{ fontSize: '3rem', marginBottom: '0.75rem' }}>📭</div>
+            <p style={{ fontWeight: '700', margin: '0 0 0.5rem', color: '#374151' }}>No messages yet</p>
+            <p style={{ margin: 0, fontSize: '0.85rem' }}>Your supervisor will send messages here.</p>
+          </div>
+        ) : threads.map(thread => {
+          const unread = parseInt(thread.unread_count) || 0;
+          const others = thread.other_participants || [];
+          const sender = thread.is_broadcast ? 'Admin Broadcast'
+            : others.length === 1 ? `${others[0].first_name} ${others[0].last_name}`
+            : others.length === 0 ? thread.sender_first + ' ' + thread.sender_last
+            : `${others[0].first_name} +${others.length - 1}`;
+
+          return (
+            <div key={thread.id} onClick={() => openThread(thread)}
+              style={{ display: 'flex', gap: '0.875rem', padding: '0.875rem', background: unread > 0 ? '#F0FDFB' : '#fff', border: `1px solid ${unread > 0 ? '#A7F3D0' : '#F3F4F6'}`, borderRadius: '12px', marginBottom: '0.5rem', cursor: 'pointer', alignItems: 'center' }}>
+              <div style={{ width: '44px', height: '44px', borderRadius: '50%', background: unread > 0 ? '#2ABBA7' : '#E5E7EB', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.2rem', flexShrink: 0 }}>
+                {thread.is_broadcast ? '📢' : '💬'}
+              </div>
+              <div style={{ flex: 1, minWidth: 0 }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.2rem' }}>
+                  <span style={{ fontWeight: unread > 0 ? '800' : '600', fontSize: '0.9rem', color: '#111827' }}>{sender}</span>
+                  <span style={{ fontSize: '0.72rem', color: '#9CA3AF' }}>{formatTime(thread.last_message_at)}</span>
+                </div>
+                <div style={{ fontSize: '0.82rem', color: '#374151', fontWeight: unread > 0 ? '700' : '500', marginBottom: '0.1rem' }}>{thread.subject}</div>
+                <div style={{ fontSize: '0.78rem', color: '#6B7280', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>
+                  {thread.last_message || 'No messages yet'}
+                </div>
+              </div>
+              {unread > 0 && <div style={{ background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.65rem', fontWeight: '700', padding: '2px 7px', flexShrink: 0 }}>{unread}</div>}
+            </div>
+          );
+        })}
+      </div>
+    </div>
+  );
+
+  // ─── THREAD / CHAT VIEW ──────────────────────────────────────────────────
+  return (
+    <div style={{ position: 'fixed', inset: 0, background: '#fff', zIndex: 9999, display: 'flex', flexDirection: 'column' }}>
+      {/* Header */}
+      <div style={{ padding: '0.875rem 1rem', borderBottom: '1px solid #E5E7EB', display: 'flex', alignItems: 'center', gap: '0.75rem', flexShrink: 0 }}>
+        <button onClick={() => { setView('inbox'); loadInbox(); }} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#2ABBA7', fontWeight: '700', fontSize: '1rem', padding: 0 }}>←</button>
+        <div style={{ flex: 1 }}>
+          <h3 style={{ margin: 0, fontSize: '0.95rem', fontWeight: '800', color: '#111827' }}>{activeThread?.subject}</h3>
+          <p style={{ margin: 0, fontSize: '0.75rem', color: '#6B7280' }}>
+            {activeThread?.is_broadcast ? '📢 Sent to all staff' : (activeThread?.other_participants || []).map(p => `${p.first_name} ${p.last_name}`).join(', ')}
+          </p>
+        </div>
+      </div>
+
+      {/* Messages */}
+      <div style={{ flex: 1, overflowY: 'auto', padding: '1rem', display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+        {messages.map(msg => {
+          const isMe = msg.sender_id === myId;
+          return (
+            <div key={msg.id} style={{ display: 'flex', flexDirection: 'column', alignItems: isMe ? 'flex-end' : 'flex-start' }}>
+              <div style={{ fontSize: '0.72rem', color: '#9CA3AF', marginBottom: '0.2rem', paddingLeft: isMe ? 0 : '0.25rem', paddingRight: isMe ? '0.25rem' : 0 }}>
+                {isMe ? 'You' : `${msg.first_name} ${msg.last_name}`} · {formatTime(msg.created_at)}
+              </div>
+              <div style={{ maxWidth: '80%', padding: '0.75rem 1rem', borderRadius: isMe ? '18px 18px 4px 18px' : '18px 18px 18px 4px', background: isMe ? '#2ABBA7' : '#F3F4F6', color: isMe ? '#fff' : '#111827', fontSize: '0.9rem', lineHeight: 1.6 }}>
+                {msg.body}
+              </div>
+            </div>
+          );
+        })}
+        <div ref={messagesEndRef} />
+      </div>
+
+      {/* Reply bar */}
+      <div style={{ padding: '0.75rem 1rem', borderTop: '1px solid #E5E7EB', display: 'flex', gap: '0.5rem', background: '#fff', flexShrink: 0 }}>
+        <textarea
+          value={replyBody}
+          onChange={e => setReplyBody(e.target.value)}
+          placeholder="Reply..."
+          rows={1}
+          style={{ flex: 1, padding: '0.75rem 1rem', border: '1px solid #D1D5DB', borderRadius: '24px', resize: 'none', fontSize: '0.9rem', outline: 'none', fontFamily: 'inherit', lineHeight: 1.5 }}
+          onKeyDown={e => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendReply(); } }}
+        />
+        <button onClick={sendReply} disabled={sending || !replyBody.trim()}
+          style={{ width: '44px', height: '44px', borderRadius: '50%', background: replyBody.trim() ? '#2ABBA7' : '#E5E7EB', border: 'none', cursor: replyBody.trim() ? 'pointer' : 'default', fontSize: '1.1rem', display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0 }}>
+          {sending ? '⋯' : '↑'}
+        </button>
+      </div>
+    </div>
+  );
+};
+
+export default CaregiverMessages;
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/ShiftMissReport.jsx b/templates/crm-homecare/frontend/src/components/caregiver/ShiftMissReport.jsx
new file mode 100644
index 0000000..d1c6445
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/caregiver/ShiftMissReport.jsx
@@ -0,0 +1,185 @@
+// src/components/caregiver/ShiftMissReport.jsx - 24/7 self-service shift miss reporting
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../../config';
+import { toast } from '../Toast';
+
+const ShiftMissReport = ({ token, userId, onClose }) => {
+  const [upcomingShifts, setUpcomingShifts] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [submitting, setSubmitting] = useState(false);
+  const [submitted, setSubmitted] = useState(false);
+  const [form, setForm] = useState({
+    scheduleId: '',
+    date: '',
+    reason: '',
+    alternativeContact: '',
+  });
+
+  useEffect(() => {
+    loadMyShifts();
+  }, []);
+
+  const loadMyShifts = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/emergency/my-shifts`, {
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      const data = await res.json();
+      setUpcomingShifts(Array.isArray(data) ? data : []);
+    } catch {}
+    finally { setLoading(false); }
+  };
+
+  const handleShiftSelect = (shift) => {
+    const dateStr = shift.date ? shift.date.split('T')[0] : '';
+    setForm(prev => ({
+      ...prev,
+      scheduleId: shift.id,
+      date: dateStr,
+    }));
+  };
+
+  const handleSubmit = async () => {
+    if (!form.date) { toast('Please select a date', 'warning'); return; }
+    if (!form.reason.trim()) { toast('Please provide a reason', 'warning'); return; }
+
+    setSubmitting(true);
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/emergency/miss-report`, {
+        method: 'POST',
+        headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
+        body: JSON.stringify(form),
+      });
+      if (!res.ok) throw new Error();
+      setSubmitted(true);
+    } catch {
+      toast('Failed to submit. Please call the office directly.', 'error');
+    } finally {
+      setSubmitting(false);
+    }
+  };
+
+  if (submitted) return (
+    <div style={{ textAlign: 'center', padding: '2rem' }}>
+      <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>✅</div>
+      <h3 style={{ margin: '0 0 0.5rem', color: '#111827' }}>Report Submitted</h3>
+      <p style={{ color: '#6B7280', marginBottom: '1.5rem' }}>
+        Your supervisor has been notified and will contact you shortly about coverage arrangements.
+      </p>
+      <p style={{ fontSize: '0.85rem', color: '#9CA3AF' }}>
+        If you don't hear back within 30 minutes, call the office directly.
+      </p>
+      <button onClick={onClose} style={{
+        marginTop: '1rem', padding: '0.75rem 1.5rem', background: '#2ABBA7', color: '#fff',
+        border: 'none', borderRadius: '10px', cursor: 'pointer', fontWeight: '700', fontSize: '1rem'
+      }}>Done</button>
+    </div>
+  );
+
+  return (
+    <div>
+      <div style={{ textAlign: 'center', marginBottom: '1.5rem' }}>
+        <div style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>🚨</div>
+        <h3 style={{ margin: 0, fontSize: '1.2rem', color: '#111827' }}>Report a Missed Shift</h3>
+        <p style={{ margin: '0.5rem 0 0', color: '#6B7280', fontSize: '0.9rem' }}>
+          Submit this form to notify your supervisor immediately
+        </p>
+      </div>
+
+      {/* Select from upcoming shifts */}
+      {!loading && upcomingShifts.length > 0 && (
+        <div style={{ marginBottom: '1.25rem' }}>
+          <label style={{ display: 'block', fontWeight: '700', marginBottom: '0.5rem', fontSize: '0.9rem', color: '#374151' }}>
+            Select your shift (optional)
+          </label>
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+            {upcomingShifts.slice(0, 5).map(shift => {
+              const shiftDate = shift.date ? new Date(shift.date + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) : 'Recurring';
+              const isSelected = form.scheduleId === shift.id;
+              return (
+                <button key={shift.id} onClick={() => handleShiftSelect(shift)}
+                  style={{
+                    padding: '0.75rem', textAlign: 'left', borderRadius: '8px', cursor: 'pointer',
+                    border: `2px solid ${isSelected ? '#2ABBA7' : '#E5E7EB'}`,
+                    background: isSelected ? '#F0FDFB' : '#fff',
+                  }}>
+                  <div style={{ fontWeight: '600', color: '#111827', fontSize: '0.9rem' }}>
+                    {shift.client_first_name} {shift.client_last_name}
+                  </div>
+                  <div style={{ fontSize: '0.82rem', color: '#6B7280' }}>
+                    {shiftDate} • {shift.start_time} – {shift.end_time}
+                  </div>
+                </button>
+              );
+            })}
+          </div>
+        </div>
+      )}
+
+      {/* Date */}
+      <div style={{ marginBottom: '1rem' }}>
+        <label style={{ display: 'block', fontWeight: '700', marginBottom: '0.5rem', fontSize: '0.9rem', color: '#374151' }}>
+          Date you cannot work *
+        </label>
+        <input type="date" value={form.date}
+          onChange={e => setForm(p => ({ ...p, date: e.target.value }))}
+          min={new Date().toISOString().split('T')[0]}
+          style={{ width: '100%', padding: '0.75rem', border: '2px solid #E5E7EB', borderRadius: '8px', fontSize: '1rem', boxSizing: 'border-box' }} />
+      </div>
+
+      {/* Reason */}
+      <div style={{ marginBottom: '1rem' }}>
+        <label style={{ display: 'block', fontWeight: '700', marginBottom: '0.5rem', fontSize: '0.9rem', color: '#374151' }}>
+          Reason *
+        </label>
+        <select value={form.reason} onChange={e => setForm(p => ({ ...p, reason: e.target.value }))}
+          style={{ width: '100%', padding: '0.75rem', border: '2px solid #E5E7EB', borderRadius: '8px', fontSize: '1rem', boxSizing: 'border-box' }}>
+          <option value="">Select reason...</option>
+          <option value="Illness - not feeling well">Illness — not feeling well</option>
+          <option value="Family emergency">Family emergency</option>
+          <option value="Car trouble / transportation issue">Car trouble / transportation issue</option>
+          <option value="Personal emergency">Personal emergency</option>
+          <option value="Prior commitment conflict">Prior commitment conflict</option>
+          <option value="Other">Other (add note below)</option>
+        </select>
+      </div>
+
+      {/* Additional note */}
+      <div style={{ marginBottom: '1.25rem' }}>
+        <label style={{ display: 'block', fontWeight: '700', marginBottom: '0.5rem', fontSize: '0.9rem', color: '#374151' }}>
+          Additional notes (optional)
+        </label>
+        <textarea
+          placeholder="Any additional details..."
+          value={form.alternativeContact}
+          onChange={e => setForm(p => ({ ...p, alternativeContact: e.target.value }))}
+          rows={3}
+          style={{ width: '100%', padding: '0.75rem', border: '2px solid #E5E7EB', borderRadius: '8px', fontSize: '0.9rem', resize: 'vertical', boxSizing: 'border-box' }}
+        />
+      </div>
+
+      <div style={{ padding: '0.875rem', background: '#FEF2F2', borderRadius: '8px', border: '1px solid #FCA5A5', marginBottom: '1.25rem' }}>
+        <p style={{ margin: 0, fontSize: '0.85rem', color: '#B91C1C', fontWeight: '600' }}>
+          ⚠️ Submitting this report notifies your supervisor immediately. If this is an emergency, please also call the office directly.
+        </p>
+      </div>
+
+      <div style={{ display: 'flex', gap: '0.75rem' }}>
+        <button onClick={onClose} style={{
+          flex: 1, padding: '0.875rem', background: '#fff', color: '#374151',
+          border: '2px solid #D1D5DB', borderRadius: '10px', cursor: 'pointer', fontWeight: '600', fontSize: '1rem'
+        }}>Cancel</button>
+        <button onClick={handleSubmit} disabled={submitting || !form.date || !form.reason}
+          style={{
+            flex: 2, padding: '0.875rem', background: '#DC2626', color: '#fff',
+            border: 'none', borderRadius: '10px', cursor: 'pointer', fontWeight: '700', fontSize: '1rem',
+            opacity: (submitting || !form.date || !form.reason) ? 0.6 : 1
+          }}>
+          {submitting ? 'Submitting...' : '🚨 Submit Miss Report'}
+        </button>
+      </div>
+    </div>
+  );
+};
+
+export default ShiftMissReport;
diff --git a/templates/crm-homecare/frontend/src/components/common/AddressLink.jsx b/templates/crm-homecare/frontend/src/components/common/AddressLink.jsx
new file mode 100644
index 0000000..f14796c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/AddressLink.jsx
@@ -0,0 +1,120 @@
+// src/components/common/AddressLink.jsx
+import React from 'react';
+
+/**
+ * Clickable address that opens in Google Maps
+ * 
+ * Usage:
+ * <AddressLink 
+ *   address="123 Main St"
+ *   city="Eau Claire"
+ *   state="WI"
+ *   zip="54701"
+ * />
+ * 
+ * Or with full address string:
+ * <AddressLink fullAddress="123 Main St, Eau Claire, WI 54701" />
+ */
+const AddressLink = ({ 
+  address, 
+  city, 
+  state, 
+  zip, 
+  fullAddress,
+  showIcon = true,
+  style = {}
+}) => {
+  // Build full address from parts or use fullAddress prop
+  const getFullAddress = () => {
+    if (fullAddress) return fullAddress;
+    
+    const parts = [];
+    if (address) parts.push(address);
+    if (city) parts.push(city);
+    if (state && zip) {
+      parts.push(`${state} ${zip}`);
+    } else if (state) {
+      parts.push(state);
+    } else if (zip) {
+      parts.push(zip);
+    }
+    return parts.join(', ');
+  };
+
+  const addressString = getFullAddress();
+  
+  if (!addressString) return <span style={{ color: '#999' }}>No address</span>;
+
+  // Encode address for URL
+  const encodedAddress = encodeURIComponent(addressString);
+  
+  // Google Maps URL - works on both desktop and mobile
+  // On mobile, it will open the Maps app if installed
+  const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
+
+  const handleClick = (e) => {
+    e.stopPropagation(); // Prevent triggering parent onClick handlers
+    window.open(mapsUrl, '_blank', 'noopener,noreferrer');
+  };
+
+  return (
+    <span
+      onClick={handleClick}
+      style={{
+        color: '#1976d2',
+        cursor: 'pointer',
+        textDecoration: 'underline',
+        textDecorationStyle: 'dotted',
+        display: 'inline-flex',
+        alignItems: 'center',
+        gap: '0.25rem',
+        ...style
+      }}
+      title="Open in Google Maps"
+    >
+      {showIcon && <span style={{ fontSize: '0.9em' }}>📍</span>}
+      {addressString}
+    </span>
+  );
+};
+
+export default AddressLink;
+
+
+// =====================================================
+// ALTERNATIVE: Simple function you can use anywhere
+// =====================================================
+
+/**
+ * Simple function to open address in Google Maps
+ * 
+ * Usage:
+ * <span onClick={() => openInMaps('123 Main St, Eau Claire, WI')}>
+ *   123 Main St
+ * </span>
+ */
+export const openInMaps = (address) => {
+  if (!address) return;
+  const encodedAddress = encodeURIComponent(address);
+  window.open(`https://www.google.com/maps/search/?api=1&query=${encodedAddress}`, '_blank');
+};
+
+
+// =====================================================
+// ALTERNATIVE: Get directions from current location
+// =====================================================
+
+/**
+ * Open directions in Google Maps from current location
+ * 
+ * Usage:
+ * <button onClick={() => getDirections('123 Main St, Eau Claire, WI')}>
+ *   Get Directions
+ * </button>
+ */
+export const getDirections = (destinationAddress) => {
+  if (!destinationAddress) return;
+  const encodedAddress = encodeURIComponent(destinationAddress);
+  // This will prompt for starting location or use current location on mobile
+  window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodedAddress}`, '_blank');
+};
diff --git a/templates/crm-homecare/frontend/src/components/common/ConfirmModal.jsx b/templates/crm-homecare/frontend/src/components/common/ConfirmModal.jsx
new file mode 100644
index 0000000..fd043bd
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/ConfirmModal.jsx
@@ -0,0 +1,79 @@
+// src/components/ConfirmModal.jsx - Replaces all window.confirm() calls
+import React, { useState, useEffect } from 'react';
+
+let confirmFn = null;
+
+export const confirm = (message, options = {}) => {
+  return new Promise((resolve) => {
+    if (confirmFn) {
+      confirmFn(message, options, resolve);
+    } else {
+      resolve(window.confirm(message));
+    }
+  });
+};
+
+export const ConfirmModal = () => {
+  const [modal, setModal] = useState(null);
+
+  useEffect(() => {
+    confirmFn = (message, options, resolve) => {
+      setModal({ message, options, resolve });
+    };
+    return () => { confirmFn = null; };
+  }, []);
+
+  if (!modal) return null;
+
+  const { message, options = {}, resolve } = modal;
+  const {
+    title = 'Confirm Action',
+    confirmLabel = 'Confirm',
+    cancelLabel = 'Cancel',
+    danger = false,
+  } = options;
+
+  const handleConfirm = () => { setModal(null); resolve(true); };
+  const handleCancel  = () => { setModal(null); resolve(false); };
+
+  return (
+    <div style={{
+      position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)',
+      zIndex: 99998, display: 'flex', alignItems: 'center', justifyContent: 'center',
+      padding: '1rem'
+    }} onClick={handleCancel}>
+      <div style={{
+        background: '#fff', borderRadius: '12px', padding: '1.5rem',
+        maxWidth: '420px', width: '100%',
+        boxShadow: '0 20px 60px rgba(0,0,0,0.2)',
+        animation: 'confirmSlideIn 0.2s ease'
+      }} onClick={e => e.stopPropagation()}>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '0.75rem' }}>
+          <span style={{ fontSize: '1.4rem' }}>{danger ? '🗑️' : '❓'}</span>
+          <h3 style={{ margin: 0, fontSize: '1.05rem', color: '#111827' }}>{title}</h3>
+        </div>
+        <p style={{ margin: '0 0 1.5rem 0', color: '#6B7280', lineHeight: '1.5', fontSize: '0.95rem' }}>
+          {message}
+        </p>
+        <div style={{ display: 'flex', gap: '0.75rem', justifyContent: 'flex-end' }}>
+          <button onClick={handleCancel} style={{
+            padding: '0.6rem 1.25rem', borderRadius: '8px',
+            border: '1px solid #D1D5DB', background: '#fff',
+            color: '#374151', cursor: 'pointer', fontWeight: '500', fontSize: '0.9rem'
+          }}>{cancelLabel}</button>
+          <button onClick={handleConfirm} style={{
+            padding: '0.6rem 1.25rem', borderRadius: '8px', border: 'none',
+            background: danger ? '#DC2626' : '#2ABBA7',
+            color: '#fff', cursor: 'pointer', fontWeight: '600', fontSize: '0.9rem'
+          }}>{confirmLabel}</button>
+        </div>
+      </div>
+      <style>{`
+        @keyframes confirmSlideIn {
+          from { opacity: 0; transform: scale(0.95); }
+          to   { opacity: 1; transform: scale(1); }
+        }
+      `}</style>
+    </div>
+  );
+};
diff --git a/templates/crm-homecare/frontend/src/components/common/ErrorBoundary.jsx b/templates/crm-homecare/frontend/src/components/common/ErrorBoundary.jsx
new file mode 100644
index 0000000..6718761
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/ErrorBoundary.jsx
@@ -0,0 +1,69 @@
+// ErrorBoundary.jsx - Catches component crashes so the whole app doesn't go down
+import React from 'react';
+
+export class ErrorBoundary extends React.Component {
+  constructor(props) {
+    super(props);
+    this.state = { hasError: false, error: null, errorInfo: null };
+  }
+
+  static getDerivedStateFromError(error) {
+    return { hasError: true, error };
+  }
+
+  componentDidCatch(error, errorInfo) {
+    this.setState({ errorInfo });
+    // Log to console — in production you'd send to Sentry or similar
+    console.error('[ErrorBoundary] Component crash:', error, errorInfo);
+  }
+
+  render() {
+    if (this.state.hasError) {
+      return (
+        <div style={{
+          padding: '40px 24px',
+          textAlign: 'center',
+          fontFamily: 'system-ui, sans-serif',
+        }}>
+          <div style={{ fontSize: 48, marginBottom: 16 }}>⚠️</div>
+          <h2 style={{ color: '#DC2626', marginBottom: 8 }}>Something went wrong</h2>
+          <p style={{ color: '#6B7280', marginBottom: 24, maxWidth: 400, margin: '0 auto 24px' }}>
+            This section crashed unexpectedly. The rest of the app is still working.
+          </p>
+          <button
+            onClick={() => this.setState({ hasError: false, error: null, errorInfo: null })}
+            style={{
+              background: '#3B82F6', color: '#fff', border: 'none',
+              borderRadius: 8, padding: '10px 24px', fontWeight: 600,
+              fontSize: 14, cursor: 'pointer',
+            }}
+          >
+            Try Again
+          </button>
+          {process.env.NODE_ENV === 'development' && this.state.error && (
+            <details style={{ marginTop: 24, textAlign: 'left', maxWidth: 600, margin: '24px auto 0' }}>
+              <summary style={{ cursor: 'pointer', color: '#6B7280', fontSize: 13 }}>Error details (dev only)</summary>
+              <pre style={{ fontSize: 11, overflow: 'auto', background: '#F3F4F6', padding: 12, borderRadius: 6, marginTop: 8 }}>
+                {this.state.error.toString()}
+                {this.state.errorInfo?.componentStack}
+              </pre>
+            </details>
+          )}
+        </div>
+      );
+    }
+
+    return this.props.children;
+  }
+}
+
+// Wrap any component with this for targeted protection
+export function withErrorBoundary(Component, fallback = null) {
+  return function WrappedWithBoundary(props) {
+    return (
+      <ErrorBoundary fallback={fallback}>
+        <Component {...props} />
+      </ErrorBoundary>
+    );
+  };
+}
diff --git a/templates/crm-homecare/frontend/src/components/common/Login.jsx b/templates/crm-homecare/frontend/src/components/common/Login.jsx
new file mode 100644
index 0000000..879db93
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/Login.jsx
@@ -0,0 +1,122 @@
+// src/components/Login.jsx
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+const Login = ({ onLogin }) => {
+  const [email, setEmail] = useState('');
+  const [password, setPassword] = useState('');
+  const [showPassword, setShowPassword] = useState(false);
+  const [error, setError] = useState('');
+  const [loading, setLoading] = useState(false);
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+    setLoading(true);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/auth/login`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({ email: email.trim().toLowerCase(), password })
+      });
+
+      const data = await response.json();
+
+      if (!response.ok) {
+        throw new Error(data.error || `Error ${response.status}`);
+      }
+
+      onLogin(data.token, data.user);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="login-container">
+      <div className="login-card">
+        <h1>Chippewa Valley</h1>
+        <p>Home Care CRM</p>
+        
+        {error && <div className="alert alert-error">{error}</div>}
+
+        <form onSubmit={handleSubmit}>
+          <div className="form-group">
+            <label htmlFor="email">Email Address</label>
+            <input
+              id="email"
+              type="email"
+              value={email}
+              onChange={(e) => setEmail(e.target.value)}
+              placeholder="admin@example.com"
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label htmlFor="password">Password</label>
+            <div style={{ position: 'relative' }}>
+              <input
+                id="password"
+                type={showPassword ? 'text' : 'password'}
+                value={password}
+                onChange={(e) => setPassword(e.target.value)}
+                placeholder="••••••••"
+                required
+                style={{ paddingRight: '2.75rem' }}
+              />
+              <button
+                type="button"
+                onClick={() => setShowPassword(v => !v)}
+                aria-label={showPassword ? 'Hide password' : 'Show password'}
+                style={{
+                  position: 'absolute',
+                  right: '0.75rem',
+                  top: '50%',
+                  transform: 'translateY(-50%)',
+                  background: 'none',
+                  border: 'none',
+                  cursor: 'pointer',
+                  padding: 0,
+                  fontSize: '1.1rem',
+                  lineHeight: 1,
+                  color: '#9CA3AF',
+                  display: 'flex',
+                  alignItems: 'center',
+                }}
+              >
+                {showPassword ? (
+                  /* Eye-off SVG */
+                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
+                    <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
+                    <line x1="1" y1="1" x2="23" y2="23"/>
+                  </svg>
+                ) : (
+                  /* Eye SVG */
+                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
+                    <circle cx="12" cy="12" r="3"/>
+                  </svg>
+                )}
+              </button>
+            </div>
+          </div>
+
+          <button type="submit" className="btn btn-primary btn-block" disabled={loading}>
+            {loading ? 'Signing in...' : 'Sign In'}
+          </button>
+        </form>
+
+        <p className="login-footer">
+          HIPAA-compliant system. Authorized personnel only.
+        </p>
+      </div>
+    </div>
+  );
+};
+
+export default Login;
diff --git a/templates/crm-homecare/frontend/src/components/common/MileageTracker.jsx b/templates/crm-homecare/frontend/src/components/common/MileageTracker.jsx
new file mode 100644
index 0000000..f71524c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/MileageTracker.jsx
@@ -0,0 +1,375 @@
+// src/components/MileageTracker.jsx
+// Simple start/stop mileage tracking for caregivers
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+// Calculate distance between two GPS points (Haversine formula)
+const calculateDistance = (lat1, lon1, lat2, lon2) => {
+  const R = 3959; // Earth's radius in miles
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = 
+    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
+    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
+    Math.sin(dLon / 2) * Math.sin(dLon / 2);
+  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
+  const straightLine = R * c;
+  // Multiply by 1.3 to approximate road distance (roads aren't straight)
+  return straightLine * 1.3;
+};
+
+const MileageTracker = ({ token, caregiverId }) => {
+  const [tripState, setTripState] = useState('idle'); // idle, started, ended
+  const [startPoint, setStartPoint] = useState(null);
+  const [endPoint, setEndPoint] = useState(null);
+  const [startLocation, setStartLocation] = useState('');
+  const [endLocation, setEndLocation] = useState('');
+  const [calculatedMiles, setCalculatedMiles] = useState(0);
+  const [error, setError] = useState(null);
+  const [saving, setSaving] = useState(false);
+  const [gettingLocation, setGettingLocation] = useState(false);
+  const [showHistory, setShowHistory] = useState(false);
+  const [history, setHistory] = useState([]);
+  const [loadingHistory, setLoadingHistory] = useState(false);
+
+  const getCurrentPosition = () => {
+    return new Promise((resolve, reject) => {
+      if (!navigator.geolocation) {
+        reject(new Error('Geolocation not supported'));
+        return;
+      }
+      navigator.geolocation.getCurrentPosition(
+        (position) => resolve({
+          lat: position.coords.latitude,
+          lon: position.coords.longitude,
+          accuracy: position.coords.accuracy
+        }),
+        (err) => reject(err),
+        { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
+      );
+    });
+  };
+
+  const reverseGeocode = async (lat, lon) => {
+    try {
+      const response = await fetch(
+        `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`,
+        { headers: { 'User-Agent': 'CVHC-CRM' } }
+      );
+      if (response.ok) {
+        const data = await response.json();
+        const parts = [];
+        if (data.address?.house_number && data.address?.road) {
+          parts.push(`${data.address.house_number} ${data.address.road}`);
+        } else if (data.address?.road) {
+          parts.push(data.address.road);
+        }
+        if (data.address?.city || data.address?.town || data.address?.village) {
+          parts.push(data.address.city || data.address.town || data.address.village);
+        }
+        return parts.join(', ') || 'Unknown location';
+      }
+    } catch (e) {
+      console.error('Reverse geocode failed:', e);
+    }
+    return 'Unknown location';
+  };
+
+  const handleStartTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setStartPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setStartLocation(address);
+      
+      setTripState('started');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else if (err.code === 2) {
+        setError('Unable to get location. Please try again.');
+      } else {
+        setError('Location timeout. Make sure GPS is enabled.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleEndTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setEndPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setEndLocation(address);
+      
+      // Calculate distance
+      const miles = calculateDistance(
+        startPoint.lat, startPoint.lon,
+        position.lat, position.lon
+      );
+      setCalculatedMiles(Math.round(miles * 10) / 10);
+      
+      setTripState('ended');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else {
+        setError('Unable to get location. Please try again.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleSaveTrip = async () => {
+    if (calculatedMiles < 0.1) {
+      alert('Trip too short to save');
+      return;
+    }
+
+    setSaving(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/mileage`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          caregiverId,
+          date: new Date().toISOString().split('T')[0],
+          miles: calculatedMiles,
+          fromLocation: startLocation,
+          toLocation: endLocation,
+          notes: `GPS tracked: ${startLocation} → ${endLocation}`
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to save mileage');
+
+      alert(`Saved ${calculatedMiles} miles!`);
+      handleReset();
+      
+    } catch (error) {
+      alert('Failed to save: ' + error.message);
+    } finally {
+      setSaving(false);
+    }
+  };
+
+  const handleReset = () => {
+    setTripState('idle');
+    setStartPoint(null);
+    setEndPoint(null);
+    setStartLocation('');
+    setEndLocation('');
+    setCalculatedMiles(0);
+    setError(null);
+  };
+
+  const loadHistory = async () => {
+    setLoadingHistory(true);
+    try {
+      const response = await fetch(
+        `${API_BASE_URL}/api/payroll/mileage?caregiverId=${caregiverId}`,
+        { headers: { 'Authorization': `Bearer ${token}` } }
+      );
+      if (response.ok) {
+        setHistory(await response.json());
+      }
+    } catch (error) {
+      console.error('Failed to load history:', error);
+    } finally {
+      setLoadingHistory(false);
+    }
+  };
+
+  const handleToggleHistory = () => {
+    if (!showHistory) loadHistory();
+    setShowHistory(!showHistory);
+  };
+
+  return (
+    <div className="card" style={{ marginBottom: '1rem' }}>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+        <h3 style={{ margin: 0 }}>🚗 Mileage Tracker</h3>
+        <button 
+          className="btn btn-sm btn-secondary"
+          onClick={handleToggleHistory}
+        >
+          {showHistory ? 'Hide' : 'History'}
+        </button>
+      </div>
+
+      {error && (
+        <div style={{ 
+          background: '#f8d7da', 
+          color: '#721c24', 
+          padding: '0.75rem', 
+          borderRadius: '6px',
+          marginBottom: '1rem'
+        }}>
+          ⚠️ {error}
+        </div>
+      )}
+
+      {/* IDLE STATE */}
+      {tripState === 'idle' && (
+        <div style={{ textAlign: 'center', padding: '1rem' }}>
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Tap when leaving to start tracking
+          </p>
+          <button 
+            className="btn btn-primary"
+            onClick={handleStartTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🚗 Start Trip'}
+          </button>
+        </div>
+      )}
+
+      {/* STARTED STATE */}
+      {tripState === 'started' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#d4edda', 
+            padding: '1rem', 
+            borderRadius: '8px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ color: '#155724', fontWeight: 'bold' }}>📍 Trip Started</div>
+            <div style={{ color: '#666', fontSize: '0.9rem', marginTop: '0.5rem' }}>
+              From: {startLocation}
+            </div>
+          </div>
+          
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Drive to your destination, then tap End Trip
+          </p>
+          
+          <button 
+            className="btn btn-danger"
+            onClick={handleEndTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🏁 End Trip'}
+          </button>
+          
+          <button 
+            className="btn btn-secondary"
+            onClick={handleReset}
+            style={{ marginTop: '0.5rem', width: '100%' }}
+          >
+            Cancel
+          </button>
+        </div>
+      )}
+
+      {/* ENDED STATE - Show results */}
+      {tripState === 'ended' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#f8f9fa', 
+            padding: '1.5rem', 
+            borderRadius: '12px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ fontSize: '2.5rem', fontWeight: 'bold', color: '#007bff' }}>
+              {calculatedMiles} miles
+            </div>
+            
+            <div style={{ 
+              marginTop: '1rem', 
+              fontSize: '0.9rem', 
+              color: '#666',
+              textAlign: 'left',
+              padding: '0 1rem'
+            }}>
+              <div style={{ marginBottom: '0.5rem' }}>
+                <strong>From:</strong> {startLocation}
+              </div>
+              <div>
+                <strong>To:</strong> {endLocation}
+              </div>
+            </div>
+          </div>
+
+          <p style={{ fontSize: '0.8rem', color: '#999', marginBottom: '1rem' }}>
+            *Estimated road distance
+          </p>
+
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button 
+              className="btn btn-primary"
+              onClick={handleSaveTrip}
+              disabled={saving}
+              style={{ flex: 1 }}
+            >
+              {saving ? 'Saving...' : '💾 Save'}
+            </button>
+            <button 
+              className="btn btn-secondary"
+              onClick={handleReset}
+              style={{ flex: 1 }}
+            >
+              🗑️ Discard
+            </button>
+          </div>
+        </div>
+      )}
+
+      {/* History Section */}
+      {showHistory && (
+        <div style={{ marginTop: '1.5rem', borderTop: '1px solid #ddd', paddingTop: '1rem' }}>
+          <h4 style={{ marginTop: 0 }}>Recent Trips</h4>
+          {loadingHistory ? (
+            <p>Loading...</p>
+          ) : history.length === 0 ? (
+            <p style={{ color: '#666' }}>No trips recorded yet</p>
+          ) : (
+            <div style={{ maxHeight: '200px', overflowY: 'auto' }}>
+              {history.slice(0, 10).map((trip, idx) => (
+                <div 
+                  key={trip.id || idx}
+                  style={{ 
+                    padding: '0.5rem',
+                    background: idx % 2 === 0 ? '#f8f9fa' : '#fff',
+                    borderRadius: '4px',
+                    marginBottom: '0.25rem',
+                    fontSize: '0.9rem'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                    <strong>{trip.miles} mi</strong>
+                    <span style={{ color: '#666' }}>
+                      {new Date(trip.date).toLocaleDateString()}
+                    </span>
+                  </div>
+                  {(trip.from_location || trip.to_location) && (
+                    <div style={{ fontSize: '0.8rem', color: '#666', marginTop: '2px' }}>
+                      {trip.from_location} → {trip.to_location}
+                    </div>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default MileageTracker;
diff --git a/templates/crm-homecare/frontend/src/components/common/Toast.jsx b/templates/crm-homecare/frontend/src/components/common/Toast.jsx
new file mode 100644
index 0000000..308459f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/common/Toast.jsx
@@ -0,0 +1,68 @@
+// src/components/Toast.jsx - Global toast notification system
+import React, { useState, useEffect, useCallback } from 'react';
+
+let toastFn = null;
+
+export const toast = (message, type = 'success', duration = 4000) => {
+  if (toastFn) toastFn(message, type, duration);
+};
+
+export const ToastContainer = () => {
+  const [toasts, setToasts] = useState([]);
+
+  useEffect(() => {
+    toastFn = (message, type, duration) => {
+      const id = Date.now() + Math.random();
+      setToasts(prev => [...prev, { id, message, type }]);
+      setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), duration);
+    };
+    return () => { toastFn = null; };
+  }, []);
+
+  const remove = (id) => setToasts(prev => prev.filter(t => t.id !== id));
+
+  const icons = { success: '✅', error: '❌', warning: '⚠️', info: 'ℹ️' };
+  const colors = {
+    success: { bg: '#F0FDF4', border: '#16A34A', text: '#15803D' },
+    error:   { bg: '#FEF2F2', border: '#DC2626', text: '#B91C1C' },
+    warning: { bg: '#FFFBEB', border: '#D97706', text: '#B45309' },
+    info:    { bg: '#EFF6FF', border: '#2563EB', text: '#1D4ED8' },
+  };
+
+  return (
+    <div style={{
+      position: 'fixed', bottom: '1.5rem', right: '1.5rem',
+      zIndex: 99999, display: 'flex', flexDirection: 'column', gap: '0.5rem',
+      maxWidth: '380px', width: 'calc(100vw - 3rem)'
+    }}>
+      {toasts.map(t => {
+        const c = colors[t.type] || colors.info;
+        return (
+          <div key={t.id} style={{
+            display: 'flex', alignItems: 'flex-start', gap: '0.75rem',
+            padding: '0.875rem 1rem', borderRadius: '10px',
+            background: c.bg, border: `1px solid ${c.border}`,
+            boxShadow: '0 4px 16px rgba(0,0,0,0.12)',
+            animation: 'toastSlideIn 0.25s ease',
+          }}>
+            <span style={{ fontSize: '1rem', flexShrink: 0, marginTop: '1px' }}>{icons[t.type]}</span>
+            <span style={{ flex: 1, fontSize: '0.9rem', color: c.text, fontWeight: '500', lineHeight: '1.4' }}>
+              {t.message}
+            </span>
+            <button onClick={() => remove(t.id)} style={{
+              background: 'none', border: 'none', cursor: 'pointer',
+              color: c.text, opacity: 0.6, fontSize: '1.1rem', flexShrink: 0,
+              padding: '0', lineHeight: 1
+            }}>×</button>
+          </div>
+        );
+      })}
+      <style>{`
+        @keyframes toastSlideIn {
+          from { opacity: 0; transform: translateX(20px); }
+          to   { opacity: 1; transform: translateX(0); }
+        }
+      `}</style>
+    </div>
+  );
+};
diff --git a/templates/crm-homecare/frontend/src/components/layout/AppLayout.jsx b/templates/crm-homecare/frontend/src/components/layout/AppLayout.jsx
new file mode 100644
index 0000000..ae507f3
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/layout/AppLayout.jsx
@@ -0,0 +1,96 @@
+import { Outlet, NavLink, useNavigate } from 'react-router-dom';
+import { useAuth } from '../../contexts/AuthContext.jsx';
+import {
+  LayoutDashboard, Users, UserCheck, Calendar, Clock, Receipt,
+  DollarSign, BarChart2, Shield, MessageSquare, FileText, Activity,
+  Bell, Settings, LogOut, ClipboardList, ChevronLeft, ChevronRight,
+  AlertTriangle, FileCheck, Truck
+} from 'lucide-react';
+import { useState } from 'react';
+
+const navItems = [
+  { to: '/', label: 'Dashboard', icon: LayoutDashboard, exact: true },
+  { to: '/clients', label: 'Clients', icon: Users },
+  { to: '/caregivers', label: 'Caregivers', icon: UserCheck },
+  { to: '/scheduling', label: 'Scheduling', icon: Calendar },
+  { to: '/time-tracking', label: 'Time & GPS', icon: Clock },
+  { to: '/billing', label: 'Billing', icon: Receipt },
+  { to: '/claims', label: 'Claims & EDI', icon: FileCheck },
+  { to: '/evv', label: 'EVV', icon: Activity },
+  { to: '/payroll', label: 'Payroll', icon: DollarSign },
+  { to: '/compliance', label: 'Compliance', icon: Shield },
+  { to: '/communication', label: 'Communication', icon: MessageSquare },
+  { to: '/forms', label: 'Forms', icon: ClipboardList },
+  { to: '/documents', label: 'Documents', icon: FileText },
+  { to: '/reports', label: 'Reports', icon: BarChart2 },
+  { to: '/notifications', label: 'Notifications', icon: Bell },
+  { to: '/audit', label: 'Audit Log', icon: AlertTriangle },
+  { to: '/settings', label: 'Settings', icon: Settings },
+];
+
+export default function AppLayout() {
+  const { user, logout } = useAuth();
+  const navigate = useNavigate();
+  const [collapsed, setCollapsed] = useState(false);
+
+  const handleLogout = async () => {
+    await logout();
+    navigate('/login');
+  };
+
+  return (
+    <div className="flex h-screen overflow-hidden bg-gray-50">
+      {/* Sidebar */}
+      <aside className={`flex flex-col bg-gray-900 text-white transition-all duration-300 ${collapsed ? 'w-16' : 'w-60'} flex-shrink-0`}>
+        {/* Logo */}
+        <div className="flex items-center gap-3 px-4 py-4 border-b border-gray-800 min-h-[64px]">
+          {!collapsed && (
+            <div>
+              <div className="font-bold text-sm leading-tight text-white">{{COMPANY_NAME}}</div>
+              <div className="text-xs text-gray-400">Care Platform</div>
+            </div>
+          )}
+          <button onClick={() => setCollapsed(!collapsed)} className="ml-auto p-1 rounded hover:bg-gray-800 text-gray-400">
+            {collapsed ? <ChevronRight size={16} /> : <ChevronLeft size={16} />}
+          </button>
+        </div>
+
+        {/* Nav */}
+        <nav className="flex-1 overflow-y-auto py-2 scrollbar-thin">
+          {navItems.map(({ to, label, icon: Icon, exact }) => (
+            <NavLink
+              key={to}
+              to={to}
+              end={exact}
+              className={({ isActive }) =>
+                `flex items-center gap-3 px-4 py-2.5 text-sm transition-colors ${
+                  isActive ? 'bg-gray-800 text-white' : 'text-gray-400 hover:bg-gray-800 hover:text-white'
+                }`
+              }
+              title={collapsed ? label : undefined}
+            >
+              <Icon size={18} className="flex-shrink-0" />
+              {!collapsed && <span>{label}</span>}
+            </NavLink>
+          ))}
+        </nav>
+
+        {/* User */}
+        <div className="border-t border-gray-800 p-4">
+          {!collapsed && (
+            <div className="text-xs text-gray-400 mb-2 truncate">{user?.firstName} {user?.lastName}</div>
+          )}
+          <button onClick={handleLogout} className="flex items-center gap-2 text-gray-400 hover:text-white text-sm w-full">
+            <LogOut size={16} />
+            {!collapsed && 'Sign out'}
+          </button>
+        </div>
+      </aside>
+
+      {/* Main content */}
+      <main className="flex-1 overflow-auto">
+        <Outlet />
+      </main>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/components/portal/ClientPortal.jsx b/templates/crm-homecare/frontend/src/components/portal/ClientPortal.jsx
new file mode 100644
index 0000000..65f5958
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/ClientPortal.jsx
@@ -0,0 +1,160 @@
+// components/portal/ClientPortal.jsx
+// Main portal container — handles nav and renders the active view
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+import PortalVisits      from './PortalVisits';
+import PortalHistory     from './PortalHistory';
+import PortalCaregivers  from './PortalCaregivers';
+import PortalInvoices    from './PortalInvoices';
+import PortalNotifications from './PortalNotifications';
+
+const NAV = [
+  { key: 'visits',        label: 'My Schedule',    icon: '📅' },
+  { key: 'history',       label: 'Visit History',  icon: '🕐' },
+  { key: 'caregivers',    label: 'My Caregivers',  icon: '👤' },
+  { key: 'invoices',      label: 'Billing',        icon: '📄' },
+  { key: 'notifications', label: 'Notifications',  icon: '🔔' },
+];
+
+const ClientPortal = ({ user, token, onLogout }) => {
+  const [activeTab, setActiveTab]           = useState('visits');
+  const [profile, setProfile]               = useState(null);
+  const [unreadCount, setUnreadCount]       = useState(0);
+  const [menuOpen, setMenuOpen]             = useState(false);
+
+  useEffect(() => {
+    // Load profile
+    apiCall('/api/client-portal/portal/me', { method: 'GET' }, token)
+      .then(data => { if (data) setProfile(data); })
+      .catch(() => {});
+
+    // Poll unread notifications count every 60s
+    const fetchUnread = () => {
+      apiCall('/api/client-portal/portal/notifications', { method: 'GET' }, token)
+        .then(data => {
+          if (data) setUnreadCount(data.filter(n => !n.is_read).length);
+        })
+        .catch(() => {});
+    };
+    fetchUnread();
+    const interval = setInterval(fetchUnread, 60000);
+    return () => clearInterval(interval);
+  }, [token]);
+
+  const renderView = () => {
+    switch (activeTab) {
+      case 'visits':        return <PortalVisits token={token} />;
+      case 'history':       return <PortalHistory token={token} />;
+      case 'caregivers':    return <PortalCaregivers token={token} />;
+      case 'invoices':      return <PortalInvoices token={token} />;
+      case 'notifications': return <PortalNotifications token={token} onRead={() => setUnreadCount(0)} />;
+      default:              return <PortalVisits token={token} />;
+    }
+  };
+
+  const clientName = profile
+    ? `${profile.first_name} ${profile.last_name}`
+    : user?.firstName ? `${user.firstName} ${user.lastName}` : 'Welcome';
+
+  return (
+    <div style={{ minHeight: '100vh', background: '#f5f7fa' }}>
+
+      {/* ── Header ── */}
+      <div style={{
+        background: 'linear-gradient(135deg, #1a5276 0%, #2980b9 100%)',
+        color: '#fff',
+        padding: '0 20px',
+        display: 'flex',
+        alignItems: 'center',
+        justifyContent: 'space-between',
+        height: '60px',
+        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
+        position: 'sticky',
+        top: 0,
+        zIndex: 100,
+      }}>
+        <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
+          <span style={{ fontSize: '1.4rem' }}>🏠</span>
+          <div>
+            <div style={{ fontWeight: 700, fontSize: '0.95rem', lineHeight: 1.2 }}>
+              Chippewa Valley Home Care
+            </div>
+            <div style={{ fontSize: '0.75rem', opacity: 0.85 }}>Client Portal</div>
+          </div>
+        </div>
+
+        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
+          <span style={{ fontSize: '0.85rem', opacity: 0.9 }}>{clientName}</span>
+          <button
+            onClick={onLogout}
+            style={{
+              background: 'rgba(255,255,255,0.15)',
+              border: '1px solid rgba(255,255,255,0.3)',
+              color: '#fff',
+              padding: '5px 12px',
+              borderRadius: '6px',
+              cursor: 'pointer',
+              fontSize: '0.8rem',
+            }}
+          >
+            Sign Out
+          </button>
+        </div>
+      </div>
+
+      {/* ── Desktop Nav ── */}
+      <div style={{
+        background: '#fff',
+        borderBottom: '1px solid #e8ecf0',
+        display: 'flex',
+        padding: '0 20px',
+        gap: '4px',
+        overflowX: 'auto',
+      }}>
+        {NAV.map(tab => (
+          <button
+            key={tab.key}
+            onClick={() => setActiveTab(tab.key)}
+            style={{
+              background: 'none',
+              border: 'none',
+              padding: '14px 18px',
+              cursor: 'pointer',
+              fontSize: '0.88rem',
+              fontWeight: activeTab === tab.key ? 600 : 400,
+              color: activeTab === tab.key ? '#1a5276' : '#555',
+              borderBottom: activeTab === tab.key ? '3px solid #1a5276' : '3px solid transparent',
+              whiteSpace: 'nowrap',
+              display: 'flex',
+              alignItems: 'center',
+              gap: '6px',
+              position: 'relative',
+            }}
+          >
+            <span>{tab.icon}</span>
+            {tab.label}
+            {tab.key === 'notifications' && unreadCount > 0 && (
+              <span style={{
+                background: '#e74c3c',
+                color: '#fff',
+                borderRadius: '10px',
+                padding: '1px 6px',
+                fontSize: '0.7rem',
+                fontWeight: 700,
+              }}>
+                {unreadCount}
+              </span>
+            )}
+          </button>
+        ))}
+      </div>
+
+      {/* ── Content ── */}
+      <div style={{ maxWidth: '900px', margin: '0 auto', padding: '24px 16px' }}>
+        {renderView()}
+      </div>
+    </div>
+  );
+};
+
+export default ClientPortal;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalCaregivers.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalCaregivers.jsx
new file mode 100644
index 0000000..e76d460
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalCaregivers.jsx
@@ -0,0 +1,104 @@
+// components/portal/PortalCaregivers.jsx
+// Show the client's active assigned caregivers
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+
+const PortalCaregivers = ({ token }) => {
+  const [caregivers, setCaregivers] = useState([]);
+  const [loading, setLoading]       = useState(true);
+  const [error, setError]           = useState('');
+
+  useEffect(() => {
+    apiCall('/api/client-portal/portal/caregivers', { method: 'GET' }, token)
+      .then(data => { if (data) setCaregivers(data); })
+      .catch(err => setError(err.message))
+      .finally(() => setLoading(false));
+  }, [token]);
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '40px', color: '#888' }}>Loading...</div>;
+  if (error)   return <div className="alert alert-error">{error}</div>;
+
+  return (
+    <div>
+      <h2 style={{ margin: '0 0 20px', fontSize: '1.3rem', color: '#1a5276' }}>
+        👤 My Caregivers
+      </h2>
+
+      {caregivers.length === 0 ? (
+        <div style={{
+          background: '#fff', borderRadius: '12px', padding: '48px',
+          textAlign: 'center', color: '#888', boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+        }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>👤</div>
+          <div>No caregivers currently assigned.</div>
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
+          {caregivers.map(cg => (
+            <div
+              key={cg.assignment_id}
+              style={{
+                background: '#fff', borderRadius: '12px', padding: '20px',
+                boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+                display: 'flex', alignItems: 'center', gap: '16px',
+              }}
+            >
+              {/* Avatar */}
+              <div style={{
+                width: '54px', height: '54px', borderRadius: '50%',
+                background: 'linear-gradient(135deg, #1a5276, #2980b9)',
+                display: 'flex', alignItems: 'center', justifyContent: 'center',
+                color: '#fff', fontSize: '1.3rem', fontWeight: 700, flexShrink: 0,
+              }}>
+                {cg.first_name?.[0]}{cg.last_name?.[0]}
+              </div>
+
+              <div style={{ flex: 1 }}>
+                <div style={{ fontWeight: 700, fontSize: '1.05rem', color: '#1a5276' }}>
+                  {cg.first_name} {cg.last_name}
+                </div>
+
+                {cg.hours_per_week && (
+                  <div style={{ fontSize: '0.85rem', color: '#666', marginTop: '2px' }}>
+                    {cg.hours_per_week} hrs/week
+                  </div>
+                )}
+
+                {cg.certifications?.length > 0 && (
+                  <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap', marginTop: '8px' }}>
+                    {cg.certifications.map((cert, i) => (
+                      <span key={i} style={{
+                        background: '#eaf4fd', color: '#1a5276',
+                        padding: '2px 8px', borderRadius: '10px',
+                        fontSize: '0.72rem', fontWeight: 600,
+                      }}>
+                        {cert}
+                      </span>
+                    ))}
+                  </div>
+                )}
+              </div>
+
+              {cg.phone && (
+                <a
+                  href={`tel:${cg.phone}`}
+                  style={{
+                    display: 'flex', alignItems: 'center', gap: '6px',
+                    background: '#eaf4fd', color: '#1a5276',
+                    padding: '8px 14px', borderRadius: '8px',
+                    textDecoration: 'none', fontWeight: 600, fontSize: '0.85rem',
+                    flexShrink: 0,
+                  }}
+                >
+                  📞 Call
+                </a>
+              )}
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default PortalCaregivers;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalHistory.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalHistory.jsx
new file mode 100644
index 0000000..1309a0e
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalHistory.jsx
@@ -0,0 +1,121 @@
+// components/portal/PortalHistory.jsx
+// Past completed visits from time_entries
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+
+const formatDuration = (minutes) => {
+  if (!minutes) return '—';
+  const h = Math.floor(minutes / 60);
+  const m = minutes % 60;
+  if (h === 0) return `${m}m`;
+  return m === 0 ? `${h}h` : `${h}h ${m}m`;
+};
+
+const formatDateTime = (isoStr) => {
+  if (!isoStr) return '—';
+  const d = new Date(isoStr);
+  return d.toLocaleString('en-US', {
+    month: 'short', day: 'numeric', year: 'numeric',
+    hour: 'numeric', minute: '2-digit',
+  });
+};
+
+const PortalHistory = ({ token }) => {
+  const [visits, setVisits]   = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [error, setError]     = useState('');
+  const [offset, setOffset]   = useState(0);
+  const [hasMore, setHasMore] = useState(true);
+  const LIMIT = 10;
+
+  const loadVisits = (reset = false) => {
+    const newOffset = reset ? 0 : offset;
+    setLoading(true);
+    apiCall(`/api/client-portal/portal/history?limit=${LIMIT}&offset=${newOffset}`, { method: 'GET' }, token)
+      .then(data => {
+        if (!data) return;
+        setVisits(prev => reset ? data : [...prev, ...data]);
+        setOffset(newOffset + LIMIT);
+        setHasMore(data.length === LIMIT);
+      })
+      .catch(err => setError(err.message))
+      .finally(() => setLoading(false));
+  };
+
+  useEffect(() => { loadVisits(true); }, [token]);
+
+  if (loading && visits.length === 0) return <div style={{ textAlign: 'center', padding: '40px', color: '#888' }}>Loading visit history...</div>;
+  if (error) return <div className="alert alert-error">{error}</div>;
+
+  return (
+    <div>
+      <h2 style={{ margin: '0 0 20px', fontSize: '1.3rem', color: '#1a5276' }}>
+        🕐 Visit History
+      </h2>
+
+      {visits.length === 0 ? (
+        <div style={{
+          background: '#fff', borderRadius: '12px', padding: '48px',
+          textAlign: 'center', color: '#888', boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+        }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>📋</div>
+          <div>No visit history yet.</div>
+        </div>
+      ) : (
+        <>
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
+            {visits.map(visit => (
+              <div
+                key={visit.id}
+                style={{
+                  background: '#fff', borderRadius: '12px', padding: '18px 20px',
+                  boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+                  display: 'flex', justifyContent: 'space-between',
+                  alignItems: 'center', flexWrap: 'wrap', gap: '12px',
+                }}
+              >
+                <div>
+                  <div style={{ fontWeight: 600, color: '#333', marginBottom: '3px' }}>
+                    {formatDateTime(visit.start_time)}
+                  </div>
+                  <div style={{ fontSize: '0.85rem', color: '#666' }}>
+                    with {visit.caregiver_first_name} {visit.caregiver_last_name}
+                  </div>
+                  {visit.notes && (
+                    <div style={{ fontSize: '0.8rem', color: '#888', marginTop: '4px' }}>
+                      📝 {visit.notes}
+                    </div>
+                  )}
+                </div>
+                <div style={{ textAlign: 'right' }}>
+                  <div style={{
+                    background: '#eafaf1', color: '#1e8449',
+                    padding: '4px 12px', borderRadius: '12px',
+                    fontSize: '0.8rem', fontWeight: 600,
+                  }}>
+                    ✓ {formatDuration(visit.duration_minutes)}
+                  </div>
+                </div>
+              </div>
+            ))}
+          </div>
+
+          {hasMore && (
+            <div style={{ textAlign: 'center', marginTop: '20px' }}>
+              <button
+                onClick={() => loadVisits(false)}
+                disabled={loading}
+                className="btn btn-primary"
+                style={{ background: 'transparent', color: '#2980b9', border: '1px solid #2980b9' }}
+              >
+                {loading ? 'Loading...' : 'Load More'}
+              </button>
+            </div>
+          )}
+        </>
+      )}
+    </div>
+  );
+};
+
+export default PortalHistory;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalInvoices.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalInvoices.jsx
new file mode 100644
index 0000000..284ba59
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalInvoices.jsx
@@ -0,0 +1,133 @@
+// components/portal/PortalInvoices.jsx
+// Client billing and invoice history
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+
+const statusBadge = (status) => {
+  const map = {
+    pending:  { bg: '#fef9e7', color: '#d68910', label: 'Pending'  },
+    paid:     { bg: '#eafaf1', color: '#1e8449', label: 'Paid'     },
+    overdue:  { bg: '#fdf2f2', color: '#c0392b', label: 'Overdue'  },
+    partial:  { bg: '#eaf4fd', color: '#1a5276', label: 'Partial'  },
+  };
+  const s = map[status] || map.pending;
+  return (
+    <span style={{
+      background: s.bg, color: s.color,
+      padding: '3px 10px', borderRadius: '12px',
+      fontSize: '0.75rem', fontWeight: 600,
+    }}>
+      {s.label}
+    </span>
+  );
+};
+
+const formatDate = (dateStr) => {
+  if (!dateStr) return '—';
+  return new Date(dateStr + 'T00:00:00').toLocaleDateString('en-US', {
+    month: 'short', day: 'numeric', year: 'numeric',
+  });
+};
+
+const formatMoney = (amount) => {
+  if (amount == null) return '—';
+  return `$${parseFloat(amount).toFixed(2)}`;
+};
+
+const PortalInvoices = ({ token }) => {
+  const [invoices, setInvoices] = useState([]);
+  const [loading, setLoading]   = useState(true);
+  const [error, setError]       = useState('');
+
+  useEffect(() => {
+    apiCall('/api/client-portal/portal/invoices', { method: 'GET' }, token)
+      .then(data => { if (data) setInvoices(data); })
+      .catch(err => setError(err.message))
+      .finally(() => setLoading(false));
+  }, [token]);
+
+  const totalOwed = invoices
+    .filter(i => i.payment_status === 'pending' || i.payment_status === 'overdue')
+    .reduce((sum, i) => sum + parseFloat(i.total || 0), 0);
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '40px', color: '#888' }}>Loading billing...</div>;
+  if (error)   return <div className="alert alert-error">{error}</div>;
+
+  return (
+    <div>
+      <h2 style={{ margin: '0 0 20px', fontSize: '1.3rem', color: '#1a5276' }}>
+        📄 Billing & Invoices
+      </h2>
+
+      {/* Summary card */}
+      {totalOwed > 0 && (
+        <div style={{
+          background: 'linear-gradient(135deg, #1a5276 0%, #2980b9 100%)',
+          borderRadius: '12px', padding: '20px 24px', marginBottom: '20px',
+          color: '#fff', display: 'flex', justifyContent: 'space-between', alignItems: 'center',
+        }}>
+          <div>
+            <div style={{ fontSize: '0.8rem', opacity: 0.85, marginBottom: '4px' }}>TOTAL BALANCE DUE</div>
+            <div style={{ fontSize: '2rem', fontWeight: 700 }}>{formatMoney(totalOwed)}</div>
+          </div>
+          <span style={{ fontSize: '2.5rem' }}>💳</span>
+        </div>
+      )}
+
+      {invoices.length === 0 ? (
+        <div style={{
+          background: '#fff', borderRadius: '12px', padding: '48px',
+          textAlign: 'center', color: '#888', boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+        }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>📄</div>
+          <div>No invoices yet.</div>
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
+          {invoices.map(inv => (
+            <div
+              key={inv.id}
+              style={{
+                background: '#fff', borderRadius: '12px', padding: '18px 20px',
+                boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+              }}
+            >
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '8px' }}>
+                <div>
+                  <div style={{ fontWeight: 700, color: '#333', marginBottom: '3px' }}>
+                    Invoice #{inv.invoice_number}
+                  </div>
+                  <div style={{ fontSize: '0.83rem', color: '#777' }}>
+                    {formatDate(inv.billing_period_start)} – {formatDate(inv.billing_period_end)}
+                  </div>
+                </div>
+                <div style={{ textAlign: 'right' }}>
+                  <div style={{ fontWeight: 700, fontSize: '1.1rem', color: '#1a5276', marginBottom: '4px' }}>
+                    {formatMoney(inv.total)}
+                  </div>
+                  {statusBadge(inv.payment_status)}
+                </div>
+              </div>
+
+              {(inv.payment_due_date || inv.payment_date) && (
+                <div style={{
+                  marginTop: '12px', paddingTop: '12px', borderTop: '1px solid #f0f0f0',
+                  display: 'flex', gap: '24px', fontSize: '0.82rem', color: '#777',
+                }}>
+                  {inv.payment_due_date && (
+                    <span>Due: <strong style={{ color: '#333' }}>{formatDate(inv.payment_due_date)}</strong></span>
+                  )}
+                  {inv.payment_date && (
+                    <span>Paid: <strong style={{ color: '#1e8449' }}>{formatDate(inv.payment_date)}</strong></span>
+                  )}
+                </div>
+              )}
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default PortalInvoices;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalLogin.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalLogin.jsx
new file mode 100644
index 0000000..6ecf291
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalLogin.jsx
@@ -0,0 +1,93 @@
+// components/portal/PortalLogin.jsx
+// Client patient portal login — separate from staff login
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../../config';
+
+const PortalLogin = ({ onLogin }) => {
+  const [email, setEmail]       = useState('');
+  const [password, setPassword] = useState('');
+  const [error, setError]       = useState('');
+  const [loading, setLoading]   = useState(false);
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+    setLoading(true);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/client-portal/login`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({ email: email.trim().toLowerCase(), password }),
+      });
+
+      const data = await response.json();
+
+      if (!response.ok) {
+        if (response.status === 423) throw new Error('Account temporarily locked. Please try again in 15 minutes.');
+        throw new Error(data.error || `Error ${response.status}`);
+      }
+
+      onLogin(data.token, data.client);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="login-container">
+      <div className="login-card">
+        <div style={{ textAlign: 'center', marginBottom: '8px' }}>
+          <span style={{ fontSize: '2.5rem' }}>🏠</span>
+        </div>
+        <h1>Chippewa Valley</h1>
+        <p>Home Care — Client Portal</p>
+
+        {error && <div className="alert alert-error">{error}</div>}
+
+        <form onSubmit={handleSubmit}>
+          <div className="form-group">
+            <label htmlFor="email">Email Address</label>
+            <input
+              id="email"
+              type="email"
+              value={email}
+              onChange={(e) => setEmail(e.target.value)}
+              placeholder="your@email.com"
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label htmlFor="password">Password</label>
+            <input
+              id="password"
+              type="password"
+              value={password}
+              onChange={(e) => setPassword(e.target.value)}
+              placeholder="••••••••"
+              required
+            />
+          </div>
+
+          <button type="submit" className="btn btn-primary btn-block" disabled={loading}>
+            {loading ? 'Signing in...' : 'Sign In to Portal'}
+          </button>
+        </form>
+
+        <p className="login-footer" style={{ marginTop: '16px', fontSize: '0.8rem', color: '#666' }}>
+          Are you a staff member?{' '}
+          <a href="/" style={{ color: '#0066cc' }}>Staff login →</a>
+        </p>
+
+        <p className="login-footer">
+          HIPAA-compliant. Authorized clients only.
+        </p>
+      </div>
+    </div>
+  );
+};
+
+export default PortalLogin;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalNotifications.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalNotifications.jsx
new file mode 100644
index 0000000..110d084
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalNotifications.jsx
@@ -0,0 +1,151 @@
+// components/portal/PortalNotifications.jsx
+// Client notifications — alerts about visits, caregivers, billing
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+
+const typeIcon = (type) => {
+  const map = {
+    caregiver_late:      '⏰',
+    caregiver_no_show:   '⚠️',
+    visit_cancelled:     '❌',
+    visit_rescheduled:   '📅',
+    visit_scheduled:     '📅',
+    invoice_ready:       '📄',
+    payment_due:         '💳',
+    payment_received:    '✅',
+    caregiver_assigned:  '👤',
+    caregiver_removed:   '👋',
+  };
+  return map[type] || '🔔';
+};
+
+const formatRelativeTime = (isoStr) => {
+  const diff = Date.now() - new Date(isoStr).getTime();
+  const mins  = Math.floor(diff / 60000);
+  const hours = Math.floor(diff / 3600000);
+  const days  = Math.floor(diff / 86400000);
+  if (mins < 1)   return 'Just now';
+  if (mins < 60)  return `${mins}m ago`;
+  if (hours < 24) return `${hours}h ago`;
+  if (days < 7)   return `${days}d ago`;
+  return new Date(isoStr).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
+};
+
+const PortalNotifications = ({ token, onRead }) => {
+  const [notifications, setNotifications] = useState([]);
+  const [loading, setLoading]             = useState(true);
+  const [error, setError]                 = useState('');
+
+  useEffect(() => {
+    apiCall('/api/client-portal/portal/notifications', { method: 'GET' }, token)
+      .then(data => { if (data) setNotifications(data); })
+      .catch(err => setError(err.message))
+      .finally(() => setLoading(false));
+  }, [token]);
+
+  const markAllRead = async () => {
+    try {
+      await apiCall('/api/client-portal/portal/notifications/read-all', { method: 'PUT' }, token);
+      setNotifications(prev => prev.map(n => ({ ...n, is_read: true })));
+      if (onRead) onRead();
+    } catch {}
+  };
+
+  const markRead = async (id) => {
+    try {
+      await apiCall(`/api/client-portal/portal/notifications/${id}/read`, { method: 'PUT' }, token);
+      setNotifications(prev => prev.map(n => n.id === id ? { ...n, is_read: true } : n));
+    } catch {}
+  };
+
+  const unreadCount = notifications.filter(n => !n.is_read).length;
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '40px', color: '#888' }}>Loading notifications...</div>;
+  if (error)   return <div className="alert alert-error">{error}</div>;
+
+  return (
+    <div>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
+        <h2 style={{ margin: 0, fontSize: '1.3rem', color: '#1a5276' }}>
+          🔔 Notifications
+          {unreadCount > 0 && (
+            <span style={{
+              background: '#e74c3c', color: '#fff',
+              borderRadius: '10px', padding: '2px 8px',
+              fontSize: '0.75rem', marginLeft: '10px', verticalAlign: 'middle',
+            }}>
+              {unreadCount} new
+            </span>
+          )}
+        </h2>
+
+        {unreadCount > 0 && (
+          <button
+            onClick={markAllRead}
+            style={{
+              background: 'none', border: '1px solid #2980b9', color: '#2980b9',
+              padding: '6px 14px', borderRadius: '8px', cursor: 'pointer', fontSize: '0.82rem',
+            }}
+          >
+            Mark all read
+          </button>
+        )}
+      </div>
+
+      {notifications.length === 0 ? (
+        <div style={{
+          background: '#fff', borderRadius: '12px', padding: '48px',
+          textAlign: 'center', color: '#888', boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+        }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>🔔</div>
+          <div>No notifications yet.</div>
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
+          {notifications.map(n => (
+            <div
+              key={n.id}
+              onClick={() => !n.is_read && markRead(n.id)}
+              style={{
+                background: n.is_read ? '#fff' : '#f0f7ff',
+                borderRadius: '12px', padding: '16px 18px',
+                boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+                cursor: n.is_read ? 'default' : 'pointer',
+                borderLeft: n.is_read ? '4px solid #e0e0e0' : '4px solid #2980b9',
+                display: 'flex', gap: '14px', alignItems: 'flex-start',
+                transition: 'background 0.2s',
+              }}
+            >
+              <span style={{ fontSize: '1.4rem', flexShrink: 0, marginTop: '2px' }}>
+                {typeIcon(n.type)}
+              </span>
+              <div style={{ flex: 1 }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', gap: '8px' }}>
+                  <div style={{ fontWeight: n.is_read ? 500 : 700, color: '#1a5276', fontSize: '0.92rem' }}>
+                    {n.title}
+                  </div>
+                  <div style={{ fontSize: '0.75rem', color: '#999', flexShrink: 0 }}>
+                    {formatRelativeTime(n.created_at)}
+                  </div>
+                </div>
+                {n.message && (
+                  <div style={{ fontSize: '0.85rem', color: '#555', marginTop: '3px', lineHeight: 1.5 }}>
+                    {n.message}
+                  </div>
+                )}
+              </div>
+              {!n.is_read && (
+                <div style={{
+                  width: '8px', height: '8px', borderRadius: '50%',
+                  background: '#2980b9', flexShrink: 0, marginTop: '6px',
+                }} />
+              )}
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default PortalNotifications;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalSetup.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalSetup.jsx
new file mode 100644
index 0000000..3104a0c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalSetup.jsx
@@ -0,0 +1,115 @@
+// components/portal/PortalSetup.jsx
+// Accepts invite token from URL, lets client set their password
+import React, { useState, useEffect } from 'react';
+import { useSearchParams } from 'react-router-dom';
+import { API_BASE_URL } from '../../config';
+
+const PortalSetup = () => {
+  const [searchParams]          = useSearchParams();
+  const [password, setPassword] = useState('');
+  const [confirm, setConfirm]   = useState('');
+  const [error, setError]       = useState('');
+  const [success, setSuccess]   = useState(false);
+  const [loading, setLoading]   = useState(false);
+
+  const token = searchParams.get('token');
+
+  useEffect(() => {
+    if (!token) setError('Invalid invite link. Please contact your care coordinator.');
+  }, [token]);
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+
+    if (password.length < 8) {
+      return setError('Password must be at least 8 characters.');
+    }
+    if (password !== confirm) {
+      return setError('Passwords do not match.');
+    }
+
+    setLoading(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/client-portal/set-password`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({ token, password }),
+      });
+
+      const data = await response.json();
+      if (!response.ok) throw new Error(data.error || 'Setup failed');
+
+      setSuccess(true);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  if (success) {
+    return (
+      <div className="login-container">
+        <div className="login-card" style={{ textAlign: 'center' }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>✅</div>
+          <h2>You're all set!</h2>
+          <p style={{ color: '#555', marginBottom: '24px' }}>
+            Your portal account is ready. You can now sign in to view your care schedule and more.
+          </p>
+          <a href="/portal" className="btn btn-primary btn-block">
+            Go to Portal Login
+          </a>
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div className="login-container">
+      <div className="login-card">
+        <div style={{ textAlign: 'center', marginBottom: '8px' }}>
+          <span style={{ fontSize: '2.5rem' }}>🔐</span>
+        </div>
+        <h1>Set Your Password</h1>
+        <p>Create a password for your Chippewa Valley Home Care portal.</p>
+
+        {error && <div className="alert alert-error">{error}</div>}
+
+        {token && (
+          <form onSubmit={handleSubmit}>
+            <div className="form-group">
+              <label htmlFor="password">New Password</label>
+              <input
+                id="password"
+                type="password"
+                value={password}
+                onChange={(e) => setPassword(e.target.value)}
+                placeholder="Minimum 8 characters"
+                required
+              />
+            </div>
+
+            <div className="form-group">
+              <label htmlFor="confirm">Confirm Password</label>
+              <input
+                id="confirm"
+                type="password"
+                value={confirm}
+                onChange={(e) => setConfirm(e.target.value)}
+                placeholder="••••••••"
+                required
+              />
+            </div>
+
+            <button type="submit" className="btn btn-primary btn-block" disabled={loading}>
+              {loading ? 'Setting password...' : 'Set Password & Activate Account'}
+            </button>
+          </form>
+        )}
+      </div>
+    </div>
+  );
+};
+
+export default PortalSetup;
diff --git a/templates/crm-homecare/frontend/src/components/portal/PortalVisits.jsx b/templates/crm-homecare/frontend/src/components/portal/PortalVisits.jsx
new file mode 100644
index 0000000..6659ae9
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/portal/PortalVisits.jsx
@@ -0,0 +1,151 @@
+// components/portal/PortalVisits.jsx
+// Upcoming scheduled visits for the client
+import React, { useState, useEffect } from 'react';
+import { apiCall } from '../../config';
+
+const statusBadge = (status) => {
+  const map = {
+    scheduled:   { bg: '#e8f4fd', color: '#1a5276', label: 'Scheduled' },
+    in_progress: { bg: '#eafaf1', color: '#1e8449', label: 'In Progress' },
+    completed:   { bg: '#f0f0f0', color: '#555',    label: 'Completed'  },
+    cancelled:   { bg: '#fdf2f2', color: '#c0392b', label: 'Cancelled'  },
+    no_show:     { bg: '#fef9e7', color: '#d68910', label: 'No Show'    },
+  };
+  const s = map[status] || map.scheduled;
+  return (
+    <span style={{
+      background: s.bg, color: s.color,
+      padding: '2px 10px', borderRadius: '12px',
+      fontSize: '0.75rem', fontWeight: 600,
+    }}>
+      {s.label}
+    </span>
+  );
+};
+
+const formatDate = (dateStr) => {
+  const d = new Date(dateStr + 'T00:00:00');
+  return d.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
+};
+
+const formatTime = (timeStr) => {
+  if (!timeStr) return '';
+  const [h, m] = timeStr.split(':');
+  const hour = parseInt(h);
+  const ampm = hour >= 12 ? 'PM' : 'AM';
+  const h12  = hour % 12 || 12;
+  return `${h12}:${m} ${ampm}`;
+};
+
+const isToday = (dateStr) => {
+  const today = new Date().toISOString().split('T')[0];
+  return dateStr === today;
+};
+
+const isTomorrow = (dateStr) => {
+  const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];
+  return dateStr === tomorrow;
+};
+
+const dayLabel = (dateStr) => {
+  if (isToday(dateStr))    return '📍 Today';
+  if (isTomorrow(dateStr)) return '➡️ Tomorrow';
+  return formatDate(dateStr);
+};
+
+const PortalVisits = ({ token }) => {
+  const [visits, setVisits]   = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [error, setError]     = useState('');
+
+  useEffect(() => {
+    apiCall('/api/client-portal/portal/visits', { method: 'GET' }, token)
+      .then(data => { if (data) setVisits(data); })
+      .catch(err => setError(err.message))
+      .finally(() => setLoading(false));
+  }, [token]);
+
+  if (loading) return <div style={{ textAlign: 'center', padding: '40px', color: '#888' }}>Loading your schedule...</div>;
+  if (error)   return <div className="alert alert-error">{error}</div>;
+
+  return (
+    <div>
+      <h2 style={{ margin: '0 0 20px', fontSize: '1.3rem', color: '#1a5276' }}>
+        📅 Upcoming Visits
+      </h2>
+
+      {visits.length === 0 ? (
+        <div style={{
+          background: '#fff', borderRadius: '12px', padding: '48px',
+          textAlign: 'center', color: '#888', boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+        }}>
+          <div style={{ fontSize: '3rem', marginBottom: '12px' }}>📭</div>
+          <div style={{ fontSize: '1rem', fontWeight: 500 }}>No upcoming visits scheduled</div>
+          <div style={{ fontSize: '0.85rem', marginTop: '8px' }}>
+            Contact your care coordinator if you have questions.
+          </div>
+        </div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
+          {visits.map(visit => (
+            <div
+              key={visit.id}
+              style={{
+                background: isToday(visit.scheduled_date) ? '#fffbf0' : '#fff',
+                borderRadius: '12px',
+                padding: '20px',
+                boxShadow: '0 1px 4px rgba(0,0,0,0.08)',
+                borderLeft: isToday(visit.scheduled_date) ? '4px solid #f39c12' : '4px solid #2980b9',
+              }}
+            >
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', flexWrap: 'wrap', gap: '8px' }}>
+                <div>
+                  <div style={{ fontWeight: 700, fontSize: '1rem', color: '#1a5276', marginBottom: '4px' }}>
+                    {dayLabel(visit.scheduled_date)}
+                  </div>
+                  <div style={{ color: '#555', fontSize: '0.9rem' }}>
+                    🕐 {formatTime(visit.start_time)} – {formatTime(visit.end_time)}
+                  </div>
+                </div>
+                {statusBadge(visit.status)}
+              </div>
+
+              <div style={{
+                marginTop: '14px', paddingTop: '14px',
+                borderTop: '1px solid #f0f0f0',
+                display: 'flex', gap: '24px', flexWrap: 'wrap',
+              }}>
+                <div>
+                  <div style={{ fontSize: '0.75rem', color: '#888', marginBottom: '2px' }}>CAREGIVER</div>
+                  <div style={{ fontWeight: 600, color: '#333' }}>
+                    {visit.caregiver_first_name} {visit.caregiver_last_name}
+                  </div>
+                </div>
+                {visit.caregiver_phone && (
+                  <div>
+                    <div style={{ fontSize: '0.75rem', color: '#888', marginBottom: '2px' }}>PHONE</div>
+                    <a href={`tel:${visit.caregiver_phone}`} style={{ fontWeight: 600, color: '#2980b9', textDecoration: 'none' }}>
+                      {visit.caregiver_phone}
+                    </a>
+                  </div>
+                )}
+              </div>
+
+              {visit.notes && (
+                <div style={{
+                  marginTop: '12px', background: '#f8f9fa',
+                  borderRadius: '8px', padding: '10px 14px',
+                  fontSize: '0.85rem', color: '#555',
+                }}>
+                  📝 {visit.notes}
+                </div>
+              )}
+            </div>
+          ))}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default PortalVisits;
diff --git a/templates/crm-homecare/frontend/src/config.js b/templates/crm-homecare/frontend/src/config.js
new file mode 100644
index 0000000..3cc1606
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/config.js
@@ -0,0 +1,152 @@
+// config.js — API shim for Twomiah Care template
+// Maps CVHC's config.js function signatures to the new api service
+// This lets all CVHC components work without modification.
+
+export const API_BASE_URL = import.meta.env.VITE_API_URL || '{{BACKEND_URL}}';
+
+import { api } from './services/api.js';
+
+// No-op callbacks (session handling done by api service)
+export const setSessionExpiredCallback = () => {};
+export const isTokenExpired = () => false;
+
+// Core apiCall - token param ignored (handled by api service interceptor)
+export const apiCall = (endpoint, options = {}, _token) => {
+  const method = (options.method || 'GET').toUpperCase();
+  const body = options.body ? JSON.parse(options.body) : undefined;
+  return api.request(method, endpoint.replace('/api', ''), body);
+};
+
+// ── Clients ───────────────────────────────────────────────────────
+export const getClients = (_t) => api.get('/clients?limit=200');
+export const createClient = (data, _t) => api.post('/clients', data);
+export const getClientDetails = (id, _t) => api.get(`/clients/${id}`);
+export const updateClient = (id, data, _t) => api.put(`/clients/${id}`, data);
+
+// ── Referral Sources / Payers ─────────────────────────────────────
+export const getReferralSources = (_t) => api.get('/payers');
+export const createReferralSource = (data, _t) => api.post('/payers', data);
+export const updateReferralSource = (id, data, _t) => api.put(`/payers/${id}`, data);
+
+// ── Caregivers ────────────────────────────────────────────────────
+export const getCaregivers = (_t) => api.get('/caregivers?limit=200').then(r => r.caregivers || r);
+export const getCaregiverDetails = (id, _t) => api.get(`/caregivers/${id}`);
+export const createCaregiver = (data, _t) => api.post('/caregivers', data);
+export const updateCaregiver = (id, data, _t) => api.put(`/caregivers/${id}`, data);
+export const convertToAdmin = (userId, _t) => api.patch(`/company/users/${userId}/role`, { role: 'admin' });
+
+// ── Schedules ─────────────────────────────────────────────────────
+export const getSchedules = (caregiverId, _t) => api.get(`/scheduling/schedules?caregiverId=${caregiverId}`);
+export const createSchedule = (data, _t) => api.post('/scheduling/schedules', data);
+export const updateSchedule = (id, data, _t) => api.put(`/scheduling/schedules/${id}`, data);
+export const deleteSchedule = (id, _t) => api.delete(`/scheduling/schedules/${id}`);
+
+// ── Time Tracking ─────────────────────────────────────────────────
+export const getTimeEntries = (_t, params = '') => api.get(`/time-tracking?${params}`);
+export const clockIn = (data, _t) => api.post('/time-tracking/clock-in', data);
+export const clockOut = (id, data, _t) => api.post('/time-tracking/clock-out', { timeEntryId: id, ...data });
+export const trackGPS = (id, data, _t) => api.post('/time-tracking/gps', { timeEntryId: id, ...data });
+
+// ── Billing ───────────────────────────────────────────────────────
+export const getInvoices = (_t) => api.get('/billing/invoices?limit=100').then(r => r.invoices || r);
+export const getInvoiceDetails = (id, _t) => api.get(`/billing/invoices/${id}`);
+export const generateInvoice = (data, _t) => api.post('/billing/invoices/generate', data);
+export const createInvoice = (data, _t) => api.post('/billing/invoices', data);
+export const updateInvoiceStatus = (id, data, _t) => api.patch(`/billing/invoices/${id}/status`, data);
+
+// ── Authorizations ────────────────────────────────────────────────
+export const getAuthorizations = (_t, clientId) => api.get(`/authorizations${clientId ? `?clientId=${clientId}` : ''}`);
+export const createAuthorization = (data, _t) => api.post('/authorizations', data);
+export const updateAuthorization = (id, data, _t) => api.put(`/authorizations/${id}`, data);
+
+// ── EVV / Claims ──────────────────────────────────────────────────
+export const getEVVVisits = (_t) => api.get('/evv?limit=100').then(r => r.visits || r);
+export const getClaims = (_t) => api.get('/claims?limit=100').then(r => r.claims || r);
+export const getEdiBatches = (_t) => api.get('/edi/batches');
+export const createEdiBatch = (data, _t) => api.post('/edi/batches', data);
+export const submitEdiBatch = (id, _t) => api.patch(`/edi/batches/${id}/submit`, {});
+
+// ── Payroll ───────────────────────────────────────────────────────
+export const getPayrollSummary = (start, end, _t) => api.get(`/payroll/summary?startDate=${start}&endDate=${end}`);
+export const getExpenses = (_t) => api.get('/payroll/expenses');
+export const createExpense = (data, _t) => api.post('/payroll/expenses', data);
+export const updateExpenseStatus = (id, status, _t) => api.patch(`/payroll/expenses/${id}/status`, { status });
+
+// ── Scheduling ────────────────────────────────────────────────────
+export const getTimeOff = (_t) => api.get('/scheduling/time-off');
+export const createTimeOff = (data, _t) => api.post('/scheduling/time-off', data);
+export const approveTimeOff = (id, _t) => api.patch(`/scheduling/time-off/${id}/approve`, {});
+export const rejectTimeOff = (id, _t) => api.patch(`/scheduling/time-off/${id}/reject`, {});
+export const getOpenShifts = (_t) => api.get('/scheduling/open-shifts');
+export const createOpenShift = (data, _t) => api.post('/scheduling/open-shifts', data);
+export const updateOpenShift = (id, data, _t) => api.patch(`/scheduling/open-shifts/${id}`, data);
+export const getAbsences = (_t) => api.get('/scheduling/absences');
+export const createAbsence = (data, _t) => api.post('/scheduling/absences', data);
+export const getNoshowAlerts = (_t) => api.get('/scheduling/noshow-alerts');
+export const resolveNoshowAlert = (id, data, _t) => api.patch(`/scheduling/noshow-alerts/${id}/resolve`, data);
+
+// ── Communication ─────────────────────────────────────────────────
+export const getCommunicationLog = (entityType, entityId, _t) => api.get(`/communication/log?entityType=${entityType}&entityId=${entityId}`);
+export const createCommunicationLog = (data, _t) => api.post('/communication/log', data);
+export const getMessageThreads = (_t) => api.get('/communication/threads');
+export const createMessageThread = (data, _t) => api.post('/communication/threads', data);
+export const getMessages = (threadId, _t) => api.get(`/communication/threads/${threadId}/messages`);
+export const sendMessage = (threadId, body, _t) => api.post(`/communication/threads/${threadId}/messages`, { body });
+
+// ── Forms ─────────────────────────────────────────────────────────
+export const getFormTemplates = (_t) => api.get('/forms/templates');
+export const createFormTemplate = (data, _t) => api.post('/forms/templates', data);
+export const updateFormTemplate = (id, data, _t) => api.put(`/forms/templates/${id}`, data);
+export const getFormSubmissions = (params, _t) => api.get(`/forms/submissions?${params}`);
+export const submitForm = (data, _t) => api.post('/forms/submissions', data);
+
+// ── Compliance ────────────────────────────────────────────────────
+export const getComplianceDashboard = (_t) => api.get('/compliance/dashboard');
+export const getPerformanceRatings = (caregiverId, _t) => api.get(`/compliance/ratings${caregiverId ? `?caregiverId=${caregiverId}` : ''}`);
+export const createPerformanceRating = (data, _t) => api.post('/compliance/ratings', data);
+export const getLoginActivity = (_t) => api.get('/compliance/login-activity');
+export const getBackgroundChecks = (caregiverId, _t) => api.get(`/caregivers/${caregiverId}/background-checks`);
+export const createBackgroundCheck = (caregiverId, data, _t) => api.post(`/caregivers/${caregiverId}/background-checks`, data);
+
+// ── Notifications ─────────────────────────────────────────────────
+export const getNotifications = (_t) => api.get('/notifications');
+export const markNotificationsRead = (ids, _t) => api.patch('/notifications/mark-read', { ids });
+export const getNotificationPrefs = (_t) => api.get('/notifications/preferences');
+export const updateNotificationPrefs = (data, _t) => api.put('/notifications/preferences', data);
+
+// ── Reports ───────────────────────────────────────────────────────
+export const getHoursByCaregiver = (start, end, _t) => api.get(`/reports/hours-by-caregiver?startDate=${start}&endDate=${end}`);
+export const getRevenue = (start, end, _t) => api.get(`/reports/revenue?startDate=${start}&endDate=${end}`);
+export const getClientCensus = (_t) => api.get('/reports/census');
+export const getPayerMix = (_t) => api.get('/reports/payer-mix');
+export const getRevenueForecast = (_t) => api.get('/reports/forecast');
+export const getNoshowRate = (start, end, _t) => api.get(`/reports/noshow-rate?startDate=${start}&endDate=${end}`);
+
+// ── Dashboard ─────────────────────────────────────────────────────
+export const getDashboardSummary = (_t) => api.get('/dashboard/stats');
+export const getDashboardReferrals = (_t) => api.get('/reports/payer-mix');
+export const getDashboardHours = (_t) => api.get('/reports/hours-by-caregiver');
+
+// ── Optimizer ─────────────────────────────────────────────────────
+export const getCompanyOptimizer = (_t) => api.get('/optimizer/company');
+export const getRouteOptimizer = (caregiverId, date, _t) => api.get(`/optimizer/routes?caregiverId=${caregiverId}&date=${date}`);
+
+// ── Audit ─────────────────────────────────────────────────────────
+export const getAuditLogs = (_t) => api.get('/audit?limit=100').then(r => r.logs || r);
+
+// ── Company / Portal ─────────────────────────────────────────────
+export const getCompanyInfo = (_t) => api.get('/company');
+export const updateCompanyInfo = (data, _t) => api.put('/company', data);
+export const generatePortalLink = (clientId, _t) => api.post('/portal/generate-link', { clientId });
+
+// Export for CSV (browser download)
+export const exportInvoicesCSV = async (_t) => {
+  const invoices = await getInvoices(_t);
+  const rows = [['Invoice #', 'Client', 'Period Start', 'Period End', 'Total', 'Status']];
+  (invoices || []).forEach(i => rows.push([i.invoiceNumber, `${i.client?.firstName} ${i.client?.lastName}`, i.billingPeriodStart, i.billingPeriodEnd, i.total, i.paymentStatus]));
+  const csv = rows.map(r => r.join(',')).join('\n');
+  const blob = new Blob([csv], { type: 'text/csv' });
+  const url = URL.createObjectURL(blob);
+  const a = document.createElement('a'); a.href = url; a.download = 'invoices.csv'; a.click();
+  URL.revokeObjectURL(url);
+};
diff --git a/templates/crm-homecare/frontend/src/contexts/AuthContext.jsx b/templates/crm-homecare/frontend/src/contexts/AuthContext.jsx
new file mode 100644
index 0000000..09a437b
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/contexts/AuthContext.jsx
@@ -0,0 +1,50 @@
+import { createContext, useContext, useState, useEffect, useCallback } from 'react';
+import api from '../services/api.js';
+
+const AuthContext = createContext(null);
+
+export function AuthProvider({ children }) {
+  const [user, setUser] = useState(null);
+  const [loading, setLoading] = useState(true);
+
+  const fetchMe = useCallback(async () => {
+    if (!api.accessToken) { setLoading(false); return; }
+    try {
+      const data = await api.get('/auth/me');
+      setUser(data);
+    } catch {
+      api.clearTokens();
+    } finally {
+      setLoading(false);
+    }
+  }, []);
+
+  useEffect(() => { fetchMe(); }, [fetchMe]);
+
+  const login = async (email, password) => {
+    const data = await api.post('/auth/login', { email, password });
+    api.setTokens(data.accessToken, data.refreshToken);
+    setUser(data.user);
+    return data.user;
+  };
+
+  const logout = async () => {
+    try { await api.post('/auth/logout', {}); } catch (_) {}
+    api.clearTokens();
+    setUser(null);
+  };
+
+  const isAdmin = user?.role === 'admin' || user?.role === 'billing';
+
+  return (
+    <AuthContext.Provider value={{ user, loading, login, logout, isAdmin }}>
+      {children}
+    </AuthContext.Provider>
+  );
+}
+
+export const useAuth = () => {
+  const ctx = useContext(AuthContext);
+  if (!ctx) throw new Error('useAuth must be used within AuthProvider');
+  return ctx;
+};
diff --git a/templates/crm-homecare/frontend/src/contexts/ToastContext.jsx b/templates/crm-homecare/frontend/src/contexts/ToastContext.jsx
new file mode 100644
index 0000000..cf7b314
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/contexts/ToastContext.jsx
@@ -0,0 +1,36 @@
+import { createContext, useContext, useState, useCallback } from 'react';
+
+const ToastContext = createContext(null);
+
+export function ToastProvider({ children }) {
+  const [toasts, setToasts] = useState([]);
+
+  const toast = useCallback((message, type = 'info', duration = 4000) => {
+    const id = Date.now();
+    setToasts(prev => [...prev, { id, message, type }]);
+    setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), duration);
+  }, []);
+
+  const dismiss = useCallback((id) => setToasts(prev => prev.filter(t => t.id !== id)), []);
+
+  return (
+    <ToastContext.Provider value={{ toast }}>
+      {children}
+      <div className="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none">
+        {toasts.map(t => (
+          <div key={t.id} onClick={() => dismiss(t.id)}
+            className={`px-4 py-3 rounded-lg shadow-lg text-white text-sm font-medium cursor-pointer pointer-events-auto max-w-sm
+              ${t.type === 'success' ? 'bg-green-600' : t.type === 'error' ? 'bg-red-600' : t.type === 'warning' ? 'bg-yellow-600' : 'bg-gray-800'}`}>
+            {t.message}
+          </div>
+        ))}
+      </div>
+    </ToastContext.Provider>
+  );
+}
+
+export const useToast = () => {
+  const ctx = useContext(ToastContext);
+  if (!ctx) throw new Error('useToast must be used within ToastProvider');
+  return ctx.toast;
+};
diff --git a/templates/crm-homecare/frontend/src/hooks/useNative.js b/templates/crm-homecare/frontend/src/hooks/useNative.js
new file mode 100644
index 0000000..1086b34
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/hooks/useNative.js
@@ -0,0 +1,351 @@
+// hooks/useNative.js
+// Unified native capabilities hook — works on web AND native (iOS/Android via Capacitor)
+// All Capacitor APIs fall back gracefully to browser APIs when running in a browser.
+
+import { useState, useEffect, useCallback, useRef } from 'react';
+import { Capacitor } from '@capacitor/core';
+
+// ── Lazy plugin loaders (don't crash on web if plugin unavailable) ─────────────
+const getGeolocation = () => import('@capacitor/geolocation').then(m => m.Geolocation).catch(() => null);
+const getNetwork     = () => import('@capacitor/network').then(m => m.Network).catch(() => null);
+const getHaptics     = () => import('@capacitor/haptics').then(m => m.Haptics).catch(() => null);
+const getLocalNotif  = () => import('@capacitor/local-notifications').then(m => m.LocalNotifications).catch(() => null);
+const getBgGeo       = () => import('@capacitor-community/background-geolocation').then(m => m.BackgroundGeolocation).catch(() => null);
+
+export const isNative = Capacitor.isNativePlatform();
+export const platform = Capacitor.getPlatform(); // 'ios' | 'android' | 'web'
+
+// ── useNetwork ────────────────────────────────────────────────────────────────
+// Returns { online, connectionType } and listens for changes
+export function useNetwork() {
+  // Default to true — assume online until proven otherwise
+  // navigator.onLine is unreliable in Capacitor Android WebView
+  const [status, setStatus] = useState({ online: true, connectionType: 'unknown' });
+
+  useEffect(() => {
+    let cleanup = () => {};
+
+    async function init() {
+      const Network = await getNetwork();
+
+      if (Network && isNative) {
+        // Native: use Capacitor Network plugin
+        const current = await Network.getStatus();
+        setStatus({ online: current.connected, connectionType: current.connectionType });
+
+        const handle = await Network.addListener('networkStatusChange', s => {
+          setStatus({ online: s.connected, connectionType: s.connectionType });
+        });
+        cleanup = () => handle.remove();
+      } else {
+        // Web: use browser events
+        const onOnline  = () => setStatus(s => ({ ...s, online: true }));
+        const onOffline = () => setStatus(s => ({ ...s, online: false }));
+        window.addEventListener('online', onOnline);
+        window.addEventListener('offline', onOffline);
+        cleanup = () => {
+          window.removeEventListener('online', onOnline);
+          window.removeEventListener('offline', onOffline);
+        };
+      }
+    }
+
+    init();
+    return () => cleanup();
+  }, []);
+
+  return status;
+}
+
+// ── useGeolocation ────────────────────────────────────────────────────────────
+// One-shot position grab + optional watch mode
+export function useGeolocation({ watch = false, highAccuracy = true } = {}) {
+  const [position, setPosition] = useState(null);
+  const [error, setError]       = useState(null);
+  const [loading, setLoading]   = useState(false);
+  const watchIdRef = useRef(null);
+
+  const getPosition = useCallback(async () => {
+    setLoading(true);
+    setError(null);
+    try {
+      const Geolocation = await getGeolocation();
+
+      if (Geolocation && isNative) {
+        // Native: request permissions first
+        const perm = await Geolocation.requestPermissions();
+        if (perm.location !== 'granted') {
+          throw new Error('Location permission denied');
+        }
+        const pos = await Geolocation.getCurrentPosition({
+          enableHighAccuracy: highAccuracy,
+          timeout: 15000,
+        });
+        setPosition({
+          latitude:  pos.coords.latitude,
+          longitude: pos.coords.longitude,
+          accuracy:  pos.coords.accuracy,
+          timestamp: pos.timestamp,
+        });
+      } else {
+        // Web: browser geolocation
+        await new Promise((resolve, reject) => {
+          navigator.geolocation.getCurrentPosition(
+            pos => {
+              setPosition({
+                latitude:  pos.coords.latitude,
+                longitude: pos.coords.longitude,
+                accuracy:  pos.coords.accuracy,
+                timestamp: pos.timestamp,
+              });
+              resolve();
+            },
+            err => reject(new Error(err.message)),
+            { enableHighAccuracy: highAccuracy, timeout: 15000 }
+          );
+        });
+      }
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  }, [highAccuracy]);
+
+  // Watch mode
+  useEffect(() => {
+    if (!watch) return;
+    let cancelled = false;
+
+    async function startWatch() {
+      const Geolocation = await getGeolocation();
+      if (Geolocation && isNative) {
+        watchIdRef.current = await Geolocation.watchPosition(
+          { enableHighAccuracy: true },
+          (pos, err) => {
+            if (cancelled) return;
+            if (err) { setError(err.message); return; }
+            setPosition({
+              latitude:  pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy:  pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          }
+        );
+      } else {
+        watchIdRef.current = navigator.geolocation.watchPosition(
+          pos => {
+            if (cancelled) return;
+            setPosition({
+              latitude:  pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy:  pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          },
+          err => setError(err.message),
+          { enableHighAccuracy: true }
+        );
+      }
+    }
+
+    startWatch();
+    return () => {
+      cancelled = true;
+      if (watchIdRef.current !== null) {
+        getGeolocation().then(G => {
+          if (G && isNative) G.clearWatch({ id: watchIdRef.current });
+          else navigator.geolocation.clearWatch(watchIdRef.current);
+        });
+      }
+    };
+  }, [watch]);
+
+  return { position, error, loading, getPosition };
+}
+
+// ── useHaptics ────────────────────────────────────────────────────────────────
+// Returns haptic feedback functions — no-ops on web
+export function useHaptics() {
+  const impact = useCallback(async (style = 'medium') => {
+    if (!isNative) return;
+    const Haptics = await getHaptics();
+    if (!Haptics) return;
+    const styleMap = { light: 'LIGHT', medium: 'MEDIUM', heavy: 'HEAVY' };
+    await Haptics.impact({ style: styleMap[style] || 'MEDIUM' }).catch(() => {});
+  }, []);
+
+  const notification = useCallback(async (type = 'success') => {
+    if (!isNative) return;
+    const Haptics = await getHaptics();
+    if (!Haptics) return;
+    const typeMap = { success: 'SUCCESS', warning: 'WARNING', error: 'ERROR' };
+    await Haptics.notification({ type: typeMap[type] || 'SUCCESS' }).catch(() => {});
+  }, []);
+
+  return { impact, notification };
+}
+
+// ── useOfflineSync ────────────────────────────────────────────────────────────
+// Reads the offline queue from IndexedDB and exposes sync status
+export function useOfflineSync() {
+  const [queueCount, setQueueCount] = useState(0);
+  const [syncing, setSyncing]       = useState(false);
+  const { online } = useNetwork();
+
+  const openDB = () => new Promise((resolve, reject) => {
+    const req = indexedDB.open('homecare-offline', 1);
+    req.onupgradeneeded = e => e.target.result.createObjectStore('queue', { keyPath: 'id' });
+    req.onsuccess = e => resolve(e.target.result);
+    req.onerror   = e => reject(e.target.error);
+  });
+
+  const getQueueCount = useCallback(async () => {
+    try {
+      const db  = await openDB();
+      const tx  = db.transaction('queue', 'readonly');
+      const req = tx.objectStore('queue').count();
+      req.onsuccess = () => setQueueCount(req.result);
+    } catch { /* ignore */ }
+  }, []);
+
+  // Poll queue count every 5s
+  useEffect(() => {
+    getQueueCount();
+    const interval = setInterval(getQueueCount, 5000);
+    return () => clearInterval(interval);
+  }, [getQueueCount]);
+
+  // Listen for SW messages
+  useEffect(() => {
+    const handler = (event) => {
+      if (event.data?.type === 'SYNCED' || event.data?.type === 'QUEUED') {
+        getQueueCount();
+      }
+    };
+    navigator.serviceWorker?.addEventListener('message', handler);
+    return () => navigator.serviceWorker?.removeEventListener('message', handler);
+  }, [getQueueCount]);
+
+  // Auto-trigger background sync when back online
+  useEffect(() => {
+    if (online && queueCount > 0) {
+      setSyncing(true);
+      navigator.serviceWorker?.ready
+        .then(sw => sw.sync?.register('sync-queue'))
+        .catch(() => {})
+        .finally(() => setTimeout(() => setSyncing(false), 2000));
+    }
+  }, [online, queueCount]);
+
+  return { queueCount, syncing, online };
+}
+
+
+// ── useBackgroundGeolocation ──────────────────────────────────────────────────
+// Runs a foreground service on Android that keeps GPS active even when the
+// screen is off or the app is backgrounded. Shows a persistent notification
+// so Android doesn't kill it. Falls back to regular watchPosition on web/iOS.
+export function useBackgroundGeolocation() {
+  const [isRunning, setIsRunning] = useState(false);
+
+  const start = useCallback(async ({ onLocation, notificationTitle = 'CVHC HomeCare', notificationText = 'Monitoring your location for auto clock-in' } = {}) => {
+    const BgGeo = await getBgGeo();
+
+    if (BgGeo && isNative && platform === 'android') {
+      try {
+        // Request permissions first
+        const Geo = await getGeolocation();
+        if (Geo) {
+          const perm = await Geo.requestPermissions({ permissions: ['location', 'coarseLocation'] });
+          if (perm.location !== 'granted') throw new Error('Location permission denied');
+        }
+
+        await BgGeo.addWatcher(
+          {
+            backgroundMessage: notificationText,
+            backgroundTitle: notificationTitle,
+            requestPermissions: true,
+            stale: false,
+            distanceFilter: 20, // meters — only fire if moved 20m
+          },
+          (location, error) => {
+            if (error) {
+              console.warn('[BgGeo]', error.code, error.message);
+              return;
+            }
+            if (onLocation) onLocation({
+              latitude: location.latitude,
+              longitude: location.longitude,
+              accuracy: location.accuracy,
+              timestamp: location.time,
+            });
+          }
+        );
+        setIsRunning(true);
+        console.log('[BgGeo] Background geolocation started');
+      } catch (err) {
+        console.warn('[BgGeo] Failed to start background geolocation:', err.message);
+        // Fall back to regular watch
+        setIsRunning(false);
+      }
+    } else {
+      // Web or iOS — use regular watchPosition as fallback
+      if ('geolocation' in navigator) {
+        navigator.geolocation.watchPosition(
+          pos => {
+            if (onLocation) onLocation({
+              latitude: pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy: pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          },
+          err => console.warn('[BgGeo fallback]', err.message),
+          { enableHighAccuracy: true, maximumAge: 10000 }
+        );
+        setIsRunning(true);
+      }
+    }
+  }, []);
+
+  const stop = useCallback(async () => {
+    const BgGeo = await getBgGeo();
+    if (BgGeo && isNative && platform === 'android') {
+      await BgGeo.removeAllWatchers().catch(() => {});
+    }
+    setIsRunning(false);
+  }, []);
+
+  return { start, stop, isRunning };
+}
+
+// ── useLocalNotifications ─────────────────────────────────────────────────────
+// Schedule local notifications (shift reminders etc)
+export function useLocalNotifications() {
+  const schedule = useCallback(async ({ title, body, id, at }) => {
+    const LN = await getLocalNotif();
+    if (!LN || !isNative) return;
+    const perm = await LN.requestPermissions();
+    if (perm.display !== 'granted') return;
+    await LN.schedule({
+      notifications: [{
+        id: id || Date.now(),
+        title,
+        body,
+        schedule: at ? { at: new Date(at) } : undefined,
+        sound: 'default',
+        smallIcon: 'ic_stat_icon_config_sample',
+      }]
+    });
+  }, []);
+
+  const cancel = useCallback(async (id) => {
+    const LN = await getLocalNotif();
+    if (!LN || !isNative) return;
+    await LN.cancel({ notifications: [{ id }] });
+  }, []);
+
+  return { schedule, cancel };
+}
diff --git a/templates/crm-homecare/frontend/src/hooks/useOfflineSync.jsx b/templates/crm-homecare/frontend/src/hooks/useOfflineSync.jsx
new file mode 100644
index 0000000..4efcdb4
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/hooks/useOfflineSync.jsx
@@ -0,0 +1,93 @@
+// useOfflineSync.js - Hook to register SW and show offline/sync status
+import React, { useState, useEffect } from 'react';
+
+export function useOfflineSync() {
+  const [online, setOnline]         = useState(navigator.onLine);
+  const [queueCount, setQueueCount] = useState(0);
+  const [syncing, setSyncing]       = useState(false);
+  const [lastSynced, setLastSynced] = useState(null);
+
+  useEffect(() => {
+    // Register service worker
+    if ('serviceWorker' in navigator) {
+      navigator.serviceWorker.register('/sw.js').catch(console.warn);
+
+      // Listen for SW messages
+      navigator.serviceWorker.addEventListener('message', event => {
+        if (event.data.type === 'QUEUED') {
+          setQueueCount(c => c + 1);
+        }
+        if (event.data.type === 'SYNCED') {
+          setQueueCount(c => Math.max(0, c - 1));
+          setLastSynced(new Date());
+          setSyncing(false);
+        }
+      });
+    }
+
+    const onOnline = () => {
+      setOnline(true);
+      setSyncing(true);
+      // Trigger background sync
+      if ('serviceWorker' in navigator && 'SyncManager' in window) {
+        navigator.serviceWorker.ready.then(reg => reg.sync.register('sync-queue'));
+      }
+    };
+    const onOffline = () => setOnline(false);
+
+    window.addEventListener('online', onOnline);
+    window.addEventListener('offline', onOffline);
+    return () => {
+      window.removeEventListener('online', onOnline);
+      window.removeEventListener('offline', onOffline);
+    };
+  }, []);
+
+  return { online, queueCount, syncing, lastSynced };
+}
+
+// ── Offline Banner Component ───────────────────────────────────────────────────
+export function OfflineBanner() {
+  const { online, queueCount, syncing, lastSynced } = useOfflineSync();
+
+  if (online && !queueCount && !syncing) return null;
+
+  const bg      = !online ? '#F97316' : syncing ? '#3B82F6' : '#10B981';
+  const icon    = !online ? '📵' : syncing ? '🔄' : '✅';
+  const message = !online
+    ? `You're offline. Clock-in/out will sync when connection returns.${queueCount ? ` (${queueCount} action${queueCount > 1 ? 's' : ''} queued)` : ''}`
+    : syncing
+    ? 'Syncing queued actions...'
+    : `Synced ${queueCount === 0 ? 'all actions' : `${queueCount} remaining`}`;
+
+  return (
+    <div style={{
+      position: 'fixed',
+      bottom: 0,
+      left: 0,
+      right: 0,
+      background: bg,
+      color: '#fff',
+      padding: '10px 20px',
+      textAlign: 'center',
+      fontSize: 14,
+      fontWeight: 600,
+      zIndex: 9999,
+      display: 'flex',
+      alignItems: 'center',
+      justifyContent: 'center',
+      gap: 8,
+      boxShadow: '0 -2px 12px rgba(0,0,0,0.15)',
+      animation: 'slideUp 0.3s ease',
+    }}>
+      <span>{icon}</span>
+      <span>{message}</span>
+      {lastSynced && (
+        <span style={{ opacity: 0.8, fontSize: 12 }}>
+          · Last synced {lastSynced.toLocaleTimeString()}
+        </span>
+      )}
+      <style>{`@keyframes slideUp { from { transform: translateY(100%) } to { transform: translateY(0) } }`}</style>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/index.css b/templates/crm-homecare/frontend/src/index.css
new file mode 100644
index 0000000..4b11f40
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/index.css
@@ -0,0 +1,32 @@
+@tailwind base;
+@tailwind components;
+@tailwind utilities;
+
+:root {
+  --color-primary: {{PRIMARY_COLOR}};
+  --color-secondary: {{SECONDARY_COLOR}};
+  --color-primary-light: color-mix(in srgb, var(--color-primary) 15%, white);
+  --color-primary-dark: color-mix(in srgb, var(--color-primary) 80%, black);
+}
+
+* { box-sizing: border-box; }
+
+body {
+  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
+  color: #111827;
+  background: #f9fafb;
+  margin: 0;
+}
+
+/* Primary color utilities using CSS vars */
+.bg-brand { background-color: var(--color-primary); }
+.text-brand { color: var(--color-primary); }
+.border-brand { border-color: var(--color-primary); }
+.hover\:bg-brand:hover { background-color: var(--color-primary); }
+.ring-brand { --tw-ring-color: var(--color-primary); }
+.bg-brand-light { background-color: var(--color-primary-light); }
+
+/* Scrollbar */
+::-webkit-scrollbar { width: 6px; height: 6px; }
+::-webkit-scrollbar-track { background: #f1f5f9; }
+::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
diff --git a/templates/crm-homecare/frontend/src/main.jsx b/templates/crm-homecare/frontend/src/main.jsx
new file mode 100644
index 0000000..7497ae8
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/main.jsx
@@ -0,0 +1,10 @@
+import React from 'react';
+import ReactDOM from 'react-dom/client';
+import App from './App.jsx';
+import './index.css';
+
+ReactDOM.createRoot(document.getElementById('root')).render(
+  <React.StrictMode>
+    <App />
+  </React.StrictMode>
+);
diff --git a/templates/crm-homecare/frontend/src/pages/AuditPage.jsx b/templates/crm-homecare/frontend/src/pages/AuditPage.jsx
new file mode 100644
index 0000000..98576d2
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/AuditPage.jsx
@@ -0,0 +1,8 @@
+import AuditLogs from '../components/admin/AuditLogs.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function AuditPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <AuditLogs token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/BillingPage.jsx b/templates/crm-homecare/frontend/src/pages/BillingPage.jsx
new file mode 100644
index 0000000..b83be95
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/BillingPage.jsx
@@ -0,0 +1,8 @@
+import BillingDashboard from '../components/admin/BillingDashboard.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function BillingPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <BillingDashboard token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/CaregiverDetailPage.jsx b/templates/crm-homecare/frontend/src/pages/CaregiverDetailPage.jsx
new file mode 100644
index 0000000..5b1df3f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/CaregiverDetailPage.jsx
@@ -0,0 +1,8 @@
+import CaregiverProfile from '../components/admin/CaregiverProfile.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function CaregiverDetailPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <CaregiverProfile token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/CaregiverPortalPage.jsx b/templates/crm-homecare/frontend/src/pages/CaregiverPortalPage.jsx
new file mode 100644
index 0000000..b574b1d
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/CaregiverPortalPage.jsx
@@ -0,0 +1,10 @@
+import { lazy, Suspense } from 'react';
+const CaregiverDashboard = lazy(() => import('../components/caregiver/CaregiverDashboard.jsx'));
+
+export default function CaregiverPortalPage() {
+  return (
+    <Suspense fallback={<div className="p-6 text-gray-400">Loading…</div>}>
+      <CaregiverDashboard />
+    </Suspense>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/pages/CaregiversPage.jsx b/templates/crm-homecare/frontend/src/pages/CaregiversPage.jsx
new file mode 100644
index 0000000..9de2370
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/CaregiversPage.jsx
@@ -0,0 +1,8 @@
+import CaregiverManagement from '../components/admin/CaregiverManagement.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function CaregiversPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <CaregiverManagement token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/ClaimsPage.jsx b/templates/crm-homecare/frontend/src/pages/ClaimsPage.jsx
new file mode 100644
index 0000000..829f75a
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/ClaimsPage.jsx
@@ -0,0 +1,8 @@
+import ClaimsManagement from '../components/admin/ClaimsManagement.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function ClaimsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <ClaimsManagement token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/ClientDetailPage.jsx b/templates/crm-homecare/frontend/src/pages/ClientDetailPage.jsx
new file mode 100644
index 0000000..e892604
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/ClientDetailPage.jsx
@@ -0,0 +1,8 @@
+import ClientsManagement from '../components/admin/ClientsManagement.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function ClientDetailPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <ClientsManagement token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/ClientsPage.jsx b/templates/crm-homecare/frontend/src/pages/ClientsPage.jsx
new file mode 100644
index 0000000..6817b74
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/ClientsPage.jsx
@@ -0,0 +1,92 @@
+import { useState, useEffect } from 'react';
+import { Link } from 'react-router-dom';
+import api from '../services/api.js';
+import { Plus, Search, User } from 'lucide-react';
+import { useToast } from '../contexts/ToastContext.jsx';
+import ClientModal from '../components/admin/ClientModal.jsx';
+
+export default function ClientsPage() {
+  const [clients, setClients] = useState([]);
+  const [total, setTotal] = useState(0);
+  const [search, setSearch] = useState('');
+  const [loading, setLoading] = useState(true);
+  const [showModal, setShowModal] = useState(false);
+  const toast = useToast();
+
+  const load = async () => {
+    setLoading(true);
+    try {
+      const data = await api.get(`/clients?isActive=true&limit=100${search ? `&search=${encodeURIComponent(search)}` : ''}`);
+      setClients(data.clients || []);
+      setTotal(data.total || 0);
+    } catch (err) { toast(err.message, 'error'); }
+    finally { setLoading(false); }
+  };
+
+  useEffect(() => { load(); }, [search]);
+
+  const serviceLabel = (type) => ({
+    personal_care: 'Personal Care', companionship: 'Companion', respite_care: 'Respite',
+    skilled_nursing: 'Skilled Nursing', homemaker: 'Homemaker',
+  }[type] || type || 'General');
+
+  return (
+    <div className="p-6">
+      <div className="flex items-center justify-between mb-6">
+        <div>
+          <h1 className="text-xl font-bold text-gray-900">Clients</h1>
+          <p className="text-sm text-gray-500">{total} active clients</p>
+        </div>
+        <button onClick={() => setShowModal(true)} className="flex items-center gap-2 px-4 py-2 rounded-lg text-white text-sm font-medium" style={{ backgroundColor: 'var(--color-primary)' }}>
+          <Plus size={16} /> Add Client
+        </button>
+      </div>
+
+      <div className="relative mb-4">
+        <Search size={16} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
+        <input type="text" placeholder="Search clients…" value={search} onChange={e => setSearch(e.target.value)}
+          className="w-full pl-9 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-blue-300" />
+      </div>
+
+      {loading ? <div className="text-gray-400 py-8 text-center">Loading…</div> : (
+        <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
+          <table className="w-full text-sm">
+            <thead className="bg-gray-50 border-b border-gray-100">
+              <tr>
+                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Name</th>
+                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Service</th>
+                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Caregiver</th>
+                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Onboarding</th>
+                <th className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">Phone</th>
+              </tr>
+            </thead>
+            <tbody className="divide-y divide-gray-50">
+              {clients.map(c => (
+                <tr key={c.id} className="hover:bg-gray-50">
+                  <td className="px-4 py-3">
+                    <Link to={`/clients/${c.id}`} className="font-medium text-gray-900 hover:underline">
+                      {c.lastName}, {c.firstName}
+                    </Link>
+                  </td>
+                  <td className="px-4 py-3 text-gray-600">{serviceLabel(c.serviceType)}</td>
+                  <td className="px-4 py-3 text-gray-600">
+                    {c.assignments?.[0]?.caregiver ? `${c.assignments[0].caregiver.firstName} ${c.assignments[0].caregiver.lastName}` : <span className="text-yellow-600">Unassigned</span>}
+                  </td>
+                  <td className="px-4 py-3">
+                    <span className={`px-2 py-0.5 rounded-full text-xs ${c.onboarding?.allCompleted ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}`}>
+                      {c.onboarding?.allCompleted ? 'Complete' : 'Pending'}
+                    </span>
+                  </td>
+                  <td className="px-4 py-3 text-gray-600">{c.phone || '—'}</td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+          {!clients.length && <p className="text-center text-gray-400 py-8">No clients found</p>}
+        </div>
+      )}
+
+      {showModal && <ClientModal onClose={() => setShowModal(false)} onSaved={() => { setShowModal(false); load(); }} />}
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/pages/CommunicationPage.jsx b/templates/crm-homecare/frontend/src/pages/CommunicationPage.jsx
new file mode 100644
index 0000000..347ab9e
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/CommunicationPage.jsx
@@ -0,0 +1,8 @@
+import CommunicationLog from '../components/admin/CommunicationLog.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function CommunicationPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <CommunicationLog token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/CompliancePage.jsx b/templates/crm-homecare/frontend/src/pages/CompliancePage.jsx
new file mode 100644
index 0000000..cc181c1
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/CompliancePage.jsx
@@ -0,0 +1,8 @@
+import ComplianceTracking from '../components/admin/ComplianceTracking.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function CompliancePage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <ComplianceTracking token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/DashboardPage.jsx b/templates/crm-homecare/frontend/src/pages/DashboardPage.jsx
new file mode 100644
index 0000000..78a6bb2
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/DashboardPage.jsx
@@ -0,0 +1,95 @@
+import { useState, useEffect } from 'react';
+import api from '../services/api.js';
+import { Users, UserCheck, Calendar, AlertTriangle, DollarSign, Clock, Activity, TrendingUp } from 'lucide-react';
+
+function StatCard({ label, value, icon: Icon, color = 'blue', sub }) {
+  return (
+    <div className="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
+      <div className="flex items-start justify-between">
+        <div>
+          <p className="text-sm text-gray-500">{label}</p>
+          <p className="text-2xl font-bold text-gray-900 mt-1">{value ?? '—'}</p>
+          {sub && <p className="text-xs text-gray-400 mt-1">{sub}</p>}
+        </div>
+        <div className={`p-2 rounded-lg bg-${color}-50`}>
+          <Icon size={20} className={`text-${color}-600`} style={{ color: 'var(--color-primary)' }} />
+        </div>
+      </div>
+    </div>
+  );
+}
+
+export default function DashboardPage() {
+  const [stats, setStats] = useState(null);
+  const [activity, setActivity] = useState(null);
+  const [loading, setLoading] = useState(true);
+
+  useEffect(() => {
+    Promise.all([api.get('/dashboard/stats'), api.get('/dashboard/recent-activity')])
+      .then(([s, a]) => { setStats(s); setActivity(a); })
+      .catch(console.error)
+      .finally(() => setLoading(false));
+  }, []);
+
+  if (loading) return <div className="p-6 text-gray-500">Loading dashboard…</div>;
+
+  const fmt = (n) => n?.toLocaleString() ?? '0';
+  const fmtMoney = (n) => n ? `$${Number(n).toLocaleString('en-US', { minimumFractionDigits: 0 })}` : '$0';
+
+  return (
+    <div className="p-6 space-y-6">
+      <h1 className="text-xl font-bold text-gray-900">{{COMPANY_NAME}} Dashboard</h1>
+
+      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
+        <StatCard label="Active Clients" value={fmt(stats?.activeClients)} icon={Users} />
+        <StatCard label="Active Caregivers" value={fmt(stats?.activeCaregiversCount)} icon={UserCheck} />
+        <StatCard label="Clocked In Now" value={fmt(stats?.caregiversClockedIn)} icon={Clock} sub="currently on shift" />
+        <StatCard label="Open Shifts" value={fmt(stats?.openShifts)} icon={Calendar} />
+        <StatCard label="Open No-Shows" value={fmt(stats?.openNoshows)} icon={AlertTriangle} />
+        <StatCard label="Outstanding Revenue" value={fmtMoney(stats?.outstandingRevenue)} icon={DollarSign} />
+        <StatCard label="Auths Expiring (30d)" value={fmt(stats?.authsExpiringSoon)} icon={Activity} />
+        <StatCard label="Incomplete Onboarding" value={fmt(stats?.incompleteOnboarding)} icon={TrendingUp} />
+      </div>
+
+      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
+        {/* Recent Activity */}
+        <div className="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
+          <h2 className="font-semibold text-gray-900 mb-4">Recent Time Entries</h2>
+          <div className="space-y-3">
+            {activity?.recentTimeEntries?.slice(0, 6).map(e => (
+              <div key={e.id} className="flex items-center justify-between text-sm">
+                <div>
+                  <span className="font-medium">{e.caregiver?.firstName} {e.caregiver?.lastName}</span>
+                  <span className="text-gray-400 mx-1">→</span>
+                  <span className="text-gray-600">{e.client?.firstName} {e.client?.lastName}</span>
+                </div>
+                <span className={`px-2 py-0.5 rounded-full text-xs ${e.isComplete ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}`}>
+                  {e.isComplete ? 'Done' : 'Active'}
+                </span>
+              </div>
+            ))}
+            {!activity?.recentTimeEntries?.length && <p className="text-sm text-gray-400">No recent entries</p>}
+          </div>
+        </div>
+
+        {/* Pending Absences */}
+        <div className="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
+          <h2 className="font-semibold text-gray-900 mb-4">Coverage Needed</h2>
+          <div className="space-y-3">
+            {activity?.pendingAbsences?.map(a => (
+              <div key={a.id} className="flex items-center justify-between text-sm">
+                <div>
+                  <span className="font-medium">{a.caregiver?.firstName} {a.caregiver?.lastName}</span>
+                  <span className="text-gray-400 mx-1">—</span>
+                  <span className="text-gray-600 capitalize">{a.type}</span>
+                </div>
+                <span className="text-xs text-gray-400">{new Date(a.date).toLocaleDateString()}</span>
+              </div>
+            ))}
+            {!activity?.pendingAbsences?.length && <p className="text-sm text-gray-400">No coverage needed</p>}
+          </div>
+        </div>
+      </div>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/pages/DocumentsPage.jsx b/templates/crm-homecare/frontend/src/pages/DocumentsPage.jsx
new file mode 100644
index 0000000..655f3c0
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/DocumentsPage.jsx
@@ -0,0 +1,8 @@
+import DocumentsManagement from '../components/admin/DocumentsManagement.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function DocumentsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <DocumentsManagement token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/EVVPage.jsx b/templates/crm-homecare/frontend/src/pages/EVVPage.jsx
new file mode 100644
index 0000000..31ff7c4
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/EVVPage.jsx
@@ -0,0 +1,8 @@
+import ClaimsManagement from '../components/admin/ClaimsManagement.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function EVVPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <ClaimsManagement token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/FamilyPortalPage.jsx b/templates/crm-homecare/frontend/src/pages/FamilyPortalPage.jsx
new file mode 100644
index 0000000..d848c04
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/FamilyPortalPage.jsx
@@ -0,0 +1,10 @@
+import { lazy, Suspense } from 'react';
+const Portal = lazy(() => import('../components/portal/ClientPortal.jsx'));
+
+export default function FamilyPortalPage() {
+  return (
+    <Suspense fallback={<div className="p-6 text-gray-400">Loading portal…</div>}>
+      <Portal />
+    </Suspense>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/pages/FormsPage.jsx b/templates/crm-homecare/frontend/src/pages/FormsPage.jsx
new file mode 100644
index 0000000..26b013d
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/FormsPage.jsx
@@ -0,0 +1,8 @@
+import FormBuilder from '../components/admin/FormBuilder.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function FormsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <FormBuilder token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/LoginPage.jsx b/templates/crm-homecare/frontend/src/pages/LoginPage.jsx
new file mode 100644
index 0000000..02b793f
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/LoginPage.jsx
@@ -0,0 +1,75 @@
+import { useState } from 'react';
+import { useNavigate } from 'react-router-dom';
+import { useAuth } from '../contexts/AuthContext.jsx';
+import { useToast } from '../contexts/ToastContext.jsx';
+
+export default function LoginPage() {
+  const [email, setEmail] = useState('');
+  const [password, setPassword] = useState('');
+  const [loading, setLoading] = useState(false);
+  const { login } = useAuth();
+  const toast = useToast();
+  const navigate = useNavigate();
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setLoading(true);
+    try {
+      const user = await login(email.trim(), password);
+      navigate(user.role === 'caregiver' ? '/caregiver' : '/');
+    } catch (err) {
+      toast(err.message || 'Login failed', 'error');
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="min-h-screen flex items-center justify-center bg-gray-100">
+      <div className="bg-white rounded-2xl shadow-xl p-8 w-full max-w-sm">
+        {/* Logo area */}
+        <div className="text-center mb-8">
+          <div className="w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-3" style={{ backgroundColor: 'var(--color-primary)' }}>
+            <span className="text-white font-bold text-2xl">❤</span>
+          </div>
+          <h1 className="text-xl font-bold text-gray-900">{{COMPANY_NAME}}</h1>
+          <p className="text-sm text-gray-500 mt-1">Home Care Management</p>
+        </div>
+
+        <form onSubmit={handleSubmit} className="space-y-4">
+          <div>
+            <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
+            <input
+              type="email"
+              value={email}
+              onChange={e => setEmail(e.target.value)}
+              className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2"
+              style={{ '--tw-ring-color': 'var(--color-primary)' }}
+              placeholder="you@agency.com"
+              required
+            />
+          </div>
+          <div>
+            <label className="block text-sm font-medium text-gray-700 mb-1">Password</label>
+            <input
+              type="password"
+              value={password}
+              onChange={e => setPassword(e.target.value)}
+              className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2"
+              placeholder="••••••••"
+              required
+            />
+          </div>
+          <button
+            type="submit"
+            disabled={loading}
+            className="w-full py-2.5 rounded-lg text-white font-semibold text-sm transition-opacity disabled:opacity-70"
+            style={{ backgroundColor: 'var(--color-primary)' }}
+          >
+            {loading ? 'Signing in…' : 'Sign in'}
+          </button>
+        </form>
+      </div>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/pages/NotificationsPage.jsx b/templates/crm-homecare/frontend/src/pages/NotificationsPage.jsx
new file mode 100644
index 0000000..5929acb
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/NotificationsPage.jsx
@@ -0,0 +1,8 @@
+import NotificationCenter from '../components/admin/NotificationCenter.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function NotificationsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <NotificationCenter token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/PayrollPage.jsx b/templates/crm-homecare/frontend/src/pages/PayrollPage.jsx
new file mode 100644
index 0000000..fc1f35c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/PayrollPage.jsx
@@ -0,0 +1,8 @@
+import PayrollProcessing from '../components/admin/PayrollProcessing.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function PayrollPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <PayrollProcessing token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/ReportsPage.jsx b/templates/crm-homecare/frontend/src/pages/ReportsPage.jsx
new file mode 100644
index 0000000..2d40343
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/ReportsPage.jsx
@@ -0,0 +1,8 @@
+import ReportsAnalytics from '../components/admin/ReportsAnalytics.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function ReportsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <ReportsAnalytics token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/SchedulingPage.jsx b/templates/crm-homecare/frontend/src/pages/SchedulingPage.jsx
new file mode 100644
index 0000000..eff7777
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/SchedulingPage.jsx
@@ -0,0 +1,8 @@
+import SchedulingHub from '../components/admin/SchedulingHub.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function SchedulingPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <SchedulingHub token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/SettingsPage.jsx b/templates/crm-homecare/frontend/src/pages/SettingsPage.jsx
new file mode 100644
index 0000000..af749ac
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/SettingsPage.jsx
@@ -0,0 +1,8 @@
+import IntegrationsHub from '../components/admin/IntegrationsHub.jsx';
+import { useAuth } from '../contexts/AuthContext.jsx';
+
+export default function SettingsPage() {
+  const { user } = useAuth();
+  const token = typeof localStorage !== 'undefined' ? localStorage.getItem('accessToken') : '';
+  return <IntegrationsHub token={token} user={user} />;
+}
diff --git a/templates/crm-homecare/frontend/src/pages/TimeTrackingPage.jsx b/templates/crm-homecare/frontend/src/pages/TimeTrackingPage.jsx
new file mode 100644
index 0000000..c43a9fc
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/pages/TimeTrackingPage.jsx
@@ -0,0 +1,80 @@
+import { useState, useEffect } from 'react';
+import api from '../services/api.js';
+import { MapPin, CheckCircle, XCircle } from 'lucide-react';
+
+export default function TimeTrackingPage() {
+  const [entries, setEntries] = useState([]);
+  const [active, setActive] = useState([]);
+  const [loading, setLoading] = useState(true);
+
+  useEffect(() => {
+    const today = new Date().toISOString().split('T')[0];
+    Promise.all([
+      api.get(`/time-tracking?startDate=${today}&limit=100`),
+      api.get('/time-tracking/active'),
+    ])
+      .then(([e, a]) => { setEntries(e?.entries || []); setActive(a || []); })
+      .catch(console.error)
+      .finally(() => setLoading(false));
+  }, []);
+
+  const fmt = (dt) => dt ? new Date(dt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : '—';
+  const dur = (start, end) => {
+    if (!end) return 'Active';
+    const m = Math.round((new Date(end) - new Date(start)) / 60000);
+    return `${Math.floor(m / 60)}h ${m % 60}m`;
+  };
+
+  if (loading) return <div className="p-6 text-gray-400">Loading…</div>;
+
+  return (
+    <div className="p-6 space-y-6">
+      <h1 className="text-xl font-bold text-gray-900">Time Tracking & GPS</h1>
+      {active.length > 0 && (
+        <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-5">
+          <h2 className="font-semibold mb-3 flex items-center gap-2">
+            <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse" /> Currently Clocked In ({active.length})
+          </h2>
+          <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
+            {active.map(e => (
+              <div key={e.id} className="border border-green-100 bg-green-50 rounded-lg p-3 text-sm">
+                <p className="font-medium">{e.caregiver?.firstName} {e.caregiver?.lastName}</p>
+                <p className="text-gray-600">{e.client?.firstName} {e.client?.lastName}</p>
+                <p className="text-xs text-gray-400 mt-1">Since {fmt(e.startTime)}</p>
+              </div>
+            ))}
+          </div>
+        </div>
+      )}
+      <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
+        <div className="px-5 py-4 border-b"><h2 className="font-semibold">Today's Entries</h2></div>
+        <table className="w-full text-sm">
+          <thead className="bg-gray-50"><tr>
+            {['Caregiver','Client','In','Out','Duration','EVV'].map(h => (
+              <th key={h} className="text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase">{h}</th>
+            ))}
+          </tr></thead>
+          <tbody className="divide-y divide-gray-50">
+            {entries.map(e => (
+              <tr key={e.id} className="hover:bg-gray-50">
+                <td className="px-4 py-3 font-medium">{e.caregiver?.firstName} {e.caregiver?.lastName}</td>
+                <td className="px-4 py-3 text-gray-600">{e.client?.firstName} {e.client?.lastName}</td>
+                <td className="px-4 py-3 text-gray-600">{fmt(e.startTime)}</td>
+                <td className="px-4 py-3 text-gray-600">{fmt(e.endTime)}</td>
+                <td className="px-4 py-3 text-gray-600">{dur(e.startTime, e.endTime)}</td>
+                <td className="px-4 py-3">
+                  {e.evvVisit ? (
+                    <span className={`flex items-center gap-1 text-xs ${e.evvVisit.isVerified ? 'text-green-600' : 'text-yellow-600'}`}>
+                      {e.evvVisit.isVerified ? <CheckCircle size={12} /> : <XCircle size={12} />} {e.evvVisit.sandataStatus}
+                    </span>
+                  ) : <span className="text-xs text-gray-400">Pending</span>}
+                </td>
+              </tr>
+            ))}
+          </tbody>
+        </table>
+        {!entries.length && <p className="text-center text-gray-400 py-8">No entries today</p>}
+      </div>
+    </div>
+  );
+}
diff --git a/templates/crm-homecare/frontend/src/services/api.js b/templates/crm-homecare/frontend/src/services/api.js
new file mode 100644
index 0000000..2b2a3f5
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/services/api.js
@@ -0,0 +1,74 @@
+const API_URL = import.meta.env.VITE_API_URL || '{{BACKEND_URL}}';
+
+class ApiService {
+  constructor() {
+    this.baseUrl = API_URL;
+    this.accessToken = localStorage.getItem('accessToken');
+    this.refreshToken = localStorage.getItem('refreshToken');
+  }
+
+  setTokens(accessToken, refreshToken) {
+    this.accessToken = accessToken;
+    this.refreshToken = refreshToken;
+    localStorage.setItem('accessToken', accessToken);
+    localStorage.setItem('refreshToken', refreshToken);
+  }
+
+  clearTokens() {
+    this.accessToken = null;
+    this.refreshToken = null;
+    localStorage.removeItem('accessToken');
+    localStorage.removeItem('refreshToken');
+  }
+
+  async request(method, path, body, options = {}) {
+    const headers = { 'Content-Type': 'application/json', ...options.headers };
+    if (this.accessToken) headers['Authorization'] = `Bearer ${this.accessToken}`;
+
+    const res = await fetch(`${this.baseUrl}/api${path}`, {
+      method,
+      headers,
+      body: body ? JSON.stringify(body) : undefined,
+    });
+
+    // Auto-refresh on 401
+    if (res.status === 401 && this.refreshToken && !options._retry) {
+      const refreshed = await this.refresh();
+      if (refreshed) return this.request(method, path, body, { ...options, _retry: true });
+      this.clearTokens();
+      window.location.href = '/login';
+      return;
+    }
+
+    if (!res.ok) {
+      const err = await res.json().catch(() => ({ error: 'Request failed' }));
+      throw new Error(err.error || `HTTP ${res.status}`);
+    }
+
+    if (res.status === 204) return null;
+    return res.json();
+  }
+
+  async refresh() {
+    try {
+      const res = await fetch(`${this.baseUrl}/api/auth/refresh`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({ refreshToken: this.refreshToken }),
+      });
+      if (!res.ok) return false;
+      const { accessToken, refreshToken } = await res.json();
+      this.setTokens(accessToken, refreshToken);
+      return true;
+    } catch { return false; }
+  }
+
+  get(path, opts) { return this.request('GET', path, null, opts); }
+  post(path, body, opts) { return this.request('POST', path, body, opts); }
+  put(path, body, opts) { return this.request('PUT', path, body, opts); }
+  patch(path, body, opts) { return this.request('PATCH', path, body, opts); }
+  delete(path, opts) { return this.request('DELETE', path, null, opts); }
+}
+
+export const api = new ApiService();
+export default api;
diff --git a/templates/crm-homecare/frontend/tailwind.config.js b/templates/crm-homecare/frontend/tailwind.config.js
new file mode 100644
index 0000000..577d441
--- /dev/null
+++ b/templates/crm-homecare/frontend/tailwind.config.js
@@ -0,0 +1,13 @@
+/** @type {import('tailwindcss').Config} */
+export default {
+  content: ['./index.html', './src/**/*.{js,jsx}'],
+  theme: {
+    extend: {
+      colors: {
+        primary: 'var(--color-primary)',
+        secondary: 'var(--color-secondary)',
+      },
+    },
+  },
+  plugins: [],
+};
diff --git a/templates/crm-homecare/frontend/vite.config.js b/templates/crm-homecare/frontend/vite.config.js
new file mode 100644
index 0000000..3054c75
--- /dev/null
+++ b/templates/crm-homecare/frontend/vite.config.js
@@ -0,0 +1,7 @@
+import { defineConfig } from 'vite';
+import react from '@vitejs/plugin-react';
+
+export default defineConfig({
+  plugins: [react()],
+  server: { port: 5173, host: true },
+});
diff --git a/templates/crm-homecare/render.yaml.template b/templates/crm-homecare/render.yaml.template
new file mode 100644
index 0000000..03fa93b
--- /dev/null
+++ b/templates/crm-homecare/render.yaml.template
@@ -0,0 +1,51 @@
+# {{COMPANY_NAME}} HomeCare CRM — Render Blueprint
+# Generated by Twomiah Build Factory
+
+services:
+  - type: web
+    name: {{COMPANY_SLUG}}-care-api
+    runtime: node
+    plan: starter
+    buildCommand: cd backend && npm install && npx prisma generate && npx prisma migrate deploy && node prisma/seed.js
+    startCommand: cd backend && node src/index.js
+    envVars:
+      - key: DATABASE_URL
+        fromDatabase:
+          name: {{COMPANY_SLUG}}-care-db
+          property: connectionString
+      - key: JWT_SECRET
+        generateValue: true
+      - key: JWT_REFRESH_SECRET
+        generateValue: true
+      - key: ENCRYPTION_KEY
+        generateValue: true
+      - key: NODE_ENV
+        value: production
+      - key: FRONTEND_URL
+        value: https://{{COMPANY_SLUG}}-care.onrender.com
+    disk:
+      name: uploads
+      mountPath: /opt/render/project/src/backend/uploads
+      sizeGB: 2
+
+  - type: web
+    name: {{COMPANY_SLUG}}-care
+    runtime: static
+    buildCommand: cd frontend && npm install && npm run build
+    staticPublishPath: frontend/dist
+    headers:
+      - path: /*
+        name: X-Frame-Options
+        value: DENY
+      - path: /*
+        name: X-Content-Type-Options
+        value: nosniff
+    routes:
+      - type: rewrite
+        source: /*
+        destination: /index.html
+
+databases:
+  - name: {{COMPANY_SLUG}}-care-db
+    plan: starter
+    databaseName: {{COMPANY_SLUG}}_care
-- 
2.43.0


From 4eeaefdfbb578d4d13f96ae4941d0520d76cc0d4 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 13:25:26 +0000
Subject: [PATCH 02/27] feat: home care features step shows all-included
 modules, not construction picker

---
 .../src/components/builder/FactoryWizard.jsx  | 83 ++++++++++++++++++-
 1 file changed, 82 insertions(+), 1 deletion(-)

diff --git a/frontend/src/components/builder/FactoryWizard.jsx b/frontend/src/components/builder/FactoryWizard.jsx
index 1927f2a..cd0c1a6 100644
--- a/frontend/src/components/builder/FactoryWizard.jsx
+++ b/frontend/src/components/builder/FactoryWizard.jsx
@@ -690,9 +690,59 @@ function BrandingForm({ branding, onChange }) {
 
 // ─── STEP 4: FEATURES ──────────────────────────────────────────────
 
+const HOMECARE_MODULES = [
+  { icon: '👤', label: 'Client Management', desc: 'Profiles, onboarding checklist, emergency contacts, caregiver assignments' },
+  { icon: '🧑‍⚕️', label: 'Caregiver Management', desc: 'Certifications, NPI, EVV IDs, background checks, pay rates, availability' },
+  { icon: '📅', label: 'Scheduling', desc: 'Drag-and-drop calendar, recurring shifts, open shifts, shift swaps, time-off approvals' },
+  { icon: '🕐', label: 'Time Tracking & GPS', desc: 'Clock in/out, continuous GPS logging, geofencing, auto clock-in/out' },
+  { icon: '✅', label: 'EVV (Electronic Visit Verification)', desc: 'Sandata-ready fields, GPS coordinates, verification status tracking' },
+  { icon: '📋', label: 'Authorizations', desc: 'MIDAS auth tracking, units used vs authorized, expiry alerts' },
+  { icon: '💰', label: 'Billing & Invoicing', desc: 'Auto-generate invoices from time entries, payment workflow, payer management' },
+  { icon: '🏥', label: 'Claims & EDI 837', desc: 'Electronic claim submission, denial tracking, remittance matching' },
+  { icon: '💵', label: 'Payroll & Expenses', desc: 'Pay period summaries, Gusto sync, caregiver expense submissions' },
+  { icon: '🔒', label: 'Compliance & HIPAA', desc: 'Background checks, cert tracking, HIPAA login activity, full audit log' },
+  { icon: '💬', label: 'Communication', desc: 'Communication log, message board, SMS via Twilio, push notifications' },
+  { icon: '📝', label: 'Forms & Documents', desc: 'Drag-and-drop form builder, signature capture, file uploads' },
+  { icon: '📊', label: 'Reports & Analytics', desc: 'Hours by caregiver, revenue, payer mix, census, no-show rates, forecast' },
+  { icon: '🗺️', label: 'Optimizer Tools', desc: 'Understaffed client detection, route optimizer, roster optimizer' },
+  { icon: '👨‍👩‍👧', label: 'Family Portal', desc: 'Family-facing schedule view, visit history, invoices, caregiver profiles' },
+  { icon: '📱', label: 'Caregiver Portal', desc: 'Mobile-ready: clock in/out, open shift pickup, messages, mileage tracking' },
+];
+
+function HomeCareIncluded() {
+  return (
+    <div>
+      <div style={{ background: 'linear-gradient(135deg, #ecfdf5, #d1fae5)', border: '1px solid #6ee7b7', borderRadius: 12, padding: '20px 24px', marginBottom: 24, display: 'flex', alignItems: 'flex-start', gap: 16 }}>
+        <div style={{ fontSize: 32, lineHeight: 1 }}>🏥</div>
+        <div>
+          <h2 style={{ fontSize: '1.2rem', fontWeight: 700, color: '#065f46', margin: '0 0 4px' }}>Twomiah Care — Everything Included</h2>
+          <p style={{ color: '#047857', margin: 0, fontSize: '0.95rem' }}>
+            The Home Care CRM is a complete, fixed platform. Every module below is included — nothing to pick, nothing to configure. Just fill in your agency details and deploy.
+          </p>
+        </div>
+      </div>
+      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: 10 }}>
+        {HOMECARE_MODULES.map(m => (
+          <div key={m.label} style={{ display: 'flex', alignItems: 'flex-start', gap: 12, background: '#f9fafb', border: '1px solid #e5e7eb', borderRadius: 10, padding: '12px 14px' }}>
+            <span style={{ fontSize: 22, lineHeight: 1, flexShrink: 0 }}>{m.icon}</span>
+            <div>
+              <div style={{ fontWeight: 600, fontSize: '0.875rem', color: '#111827', display: 'flex', alignItems: 'center', gap: 6 }}>
+                <Check size={13} color="#10b981" strokeWidth={3} />
+                {m.label}
+              </div>
+              <div style={{ fontSize: '0.78rem', color: '#6b7280', marginTop: 2 }}>{m.desc}</div>
+            </div>
+          </div>
+        ))}
+      </div>
+    </div>
+  );
+}
+
 function FeatureStep({ config, setConfig, registry }) {
   const hasWebsite = config.products.includes('website');
   const hasCRM = config.products.includes('crm');
+  const isHomeCare = config.company?.industry === 'home_care';
   const [tab, setTab] = useState(hasCRM ? 'crm' : 'website');
 
   if (!hasWebsite && !hasCRM) {
@@ -705,12 +755,43 @@ function FeatureStep({ config, setConfig, registry }) {
     );
   }
 
+  // Home care CRM only — just show what's included, nothing to configure
+  if (isHomeCare && hasCRM && !hasWebsite) {
+    return <HomeCareIncluded />;
+  }
+
+  // Home care + website — CRM tab shows all-included, website tab has picker
+  if (isHomeCare && hasCRM && hasWebsite) {
+    return (
+      <div>
+        <div style={{ display: 'flex', gap: 4, marginBottom: 20 }}>
+          <button onClick={() => setTab('crm')} style={{
+            padding: '8px 20px', borderRadius: 8, border: 'none', cursor: 'pointer', fontWeight: 600,
+            background: tab === 'crm' ? '#10b981' : '#f3f4f6', color: tab === 'crm' ? 'white' : '#6b7280',
+          }}>Care CRM ✓ All Included</button>
+          <button onClick={() => setTab('website')} style={{
+            padding: '8px 20px', borderRadius: 8, border: 'none', cursor: 'pointer', fontWeight: 600,
+            background: tab === 'website' ? '#3b82f6' : '#f3f4f6', color: tab === 'website' ? 'white' : '#6b7280',
+          }}>Website Features ({config.features.website.length})</button>
+        </div>
+        {tab === 'crm' && <HomeCareIncluded />}
+        {tab === 'website' && (
+          <WebsiteFeatures
+            selected={config.features.website}
+            onChange={features => setConfig(prev => ({ ...prev, features: { ...prev.features, website: features } }))}
+            registry={registry?.website || []}
+          />
+        )}
+      </div>
+    );
+  }
+
+  // Standard construction CRM flow
   return (
     <div>
       <h2 style={{ fontSize: '1.25rem', fontWeight: 600, marginBottom: 4 }}>Configure Features</h2>
       <p style={{ color: '#6b7280', marginBottom: 16 }}>Select which features to enable for each product.</p>
 
-      {/* Tabs if both products */}
       {hasWebsite && hasCRM && (
         <div style={{ display: 'flex', gap: 4, marginBottom: 20 }}>
           <button onClick={() => setTab('crm')} style={{
-- 
2.43.0


From b60033b5862914f6e838f70312c447f9e5a44871 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 13:40:59 +0000
Subject: [PATCH 03/27] fix: rootDir site->website in deploy.js, home_care
 aware service names and URLs

---
 backend/src/services/factory/deploy.js | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 2c9fb6d..7bfa964 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -337,6 +337,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
   } = options;
 
   const slug = factoryCustomer.slug;
+  const isHomeCare = factoryCustomer.industry === 'home_care' || factoryCustomer.config?.company?.industry === 'home_care';
   const results = { steps: [], services: {}, errors: [] };
 
   const generateJwtSecret = () => {
@@ -387,7 +388,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
         const backendEnvVars = [
           { key: 'NODE_ENV', value: 'production' },
           { key: 'JWT_SECRET', value: jwtSecret },
-          { key: 'FRONTEND_URL', value: `https://${slug}-crm.onrender.com` },
+          { key: 'FRONTEND_URL', value: isHomeCare ? `https://${slug}-care.onrender.com` : `https://${slug}-crm.onrender.com` },
           { key: 'JWT_REFRESH_SECRET', value: jwtRefreshSecret },
           { key: 'PORT', value: '10000' },
         ];
@@ -405,7 +406,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
         }
 
         const backend = await createRenderWebService({
-          name: `${slug}-api`,
+          name: isHomeCare ? `${slug}-care-api` : `${slug}-api`,
           repoFullName: repo.full_name,
           rootDir: 'crm/backend',
           buildCommand: 'npm install && npx prisma generate && npx prisma migrate deploy',
@@ -423,7 +424,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
 
         // ── Step 6: Create Frontend Service ───────────
         const frontend = await createRenderStaticSite({
-          name: `${slug}-crm`,
+          name: isHomeCare ? `${slug}-care` : `${slug}-crm`,
           repoFullName: repo.full_name,
           rootDir: 'crm/frontend',
           buildCommand: 'npm install && npm run build',
@@ -435,7 +436,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
 
         results.steps.push({ step: 'render_frontend', status: 'ok', serviceId: frontend.service?.id });
         results.services.frontend = frontend.service;
-        results.deployedUrl = `https://${slug}-crm.onrender.com`;
+        results.deployedUrl = isHomeCare ? `https://${slug}-care.onrender.com` : `https://${slug}-crm.onrender.com`;
 
         // Update backend with frontend URL for CORS
         // (would need to update env vars after creation)
@@ -452,7 +453,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
         const site = await createRenderWebService({
           name: `${slug}-site`,
           repoFullName: repo.full_name,
-          rootDir: 'site',
+          rootDir: 'website',
           buildCommand: 'npm install',
           startCommand: 'node server-static.js',
           envVars: [
-- 
2.43.0


From 70dc9b2f5576e6fa5addf5e3614e333f6d912702 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 13:43:10 +0000
Subject: [PATCH 04/27] fix: render.yaml to repo root, remove DATABASE_URL from
 .env.example, correct rootDir in blueprint

---
 backend/src/services/factory/generator.js   |  6 +++++-
 templates/crm-homecare/backend/.env.example | 22 ++++++++++-----------
 templates/crm-homecare/render.yaml.template | 18 ++++++++++++-----
 3 files changed, 29 insertions(+), 17 deletions(-)

diff --git a/backend/src/services/factory/generator.js b/backend/src/services/factory/generator.js
index e39b872..ca41a2c 100644
--- a/backend/src/services/factory/generator.js
+++ b/backend/src/services/factory/generator.js
@@ -302,11 +302,15 @@ function processCRM(crmDir, config, tokens) {
   // 4. Generate frontend .env from template
   processEnvTemplate(path.join(crmDir, 'frontend'), tokens);
 
-  // 5. Generate render.yaml from template
+  // 5. Generate render.yaml from template and write to REPO ROOT for Render Blueprint
   const renderTemplatePath = path.join(crmDir, 'render.yaml.template');
   if (fs.existsSync(renderTemplatePath)) {
     let renderContent = fs.readFileSync(renderTemplatePath, 'utf8');
     renderContent = injectTokens(renderContent, tokens);
+    // Write to repo root so Render Blueprint discovers it automatically
+    const repoRootRenderYaml = path.join(path.dirname(crmDir), 'render.yaml');
+    fs.writeFileSync(repoRootRenderYaml, renderContent, 'utf8');
+    // Also keep one inside crm/ for reference
     fs.writeFileSync(path.join(crmDir, 'render.yaml'), renderContent, 'utf8');
     fs.unlinkSync(renderTemplatePath);
   }
diff --git a/templates/crm-homecare/backend/.env.example b/templates/crm-homecare/backend/.env.example
index 14e2146..11c3e3a 100644
--- a/templates/crm-homecare/backend/.env.example
+++ b/templates/crm-homecare/backend/.env.example
@@ -1,8 +1,8 @@
-# {{COMPANY_NAME}} — HomeCare CRM Backend
+# {{COMPANY_NAME}} — HomeCare CRM Backend Environment Variables
 # Generated by Twomiah Build Factory
-
-# ── Database ─────────────────────────────────────────────
-DATABASE_URL="postgresql://user:password@localhost:5432/{{COMPANY_SLUG}}_care"
+#
+# On Render: set these in your service's Environment tab or via render.yaml
+# DATABASE_URL is injected automatically by Render from the linked database — do NOT set it here
 
 # ── Auth ─────────────────────────────────────────────────
 JWT_SECRET="{{JWT_SECRET}}"
@@ -10,26 +10,26 @@ JWT_REFRESH_SECRET="{{JWT_REFRESH_SECRET}}"
 
 # ── App ──────────────────────────────────────────────────
 NODE_ENV="production"
-PORT=3001
+PORT=10000
 FRONTEND_URL="{{FRONTEND_URL}}"
 
-# ── Encryption (for SSN, license, sensitive fields) ──────
+# ── Encryption (for SSN, license number, sensitive fields) ──
 ENCRYPTION_KEY="{{ENCRYPTION_KEY}}"
 
-# ── Twilio (SMS) ─────────────────────────────────────────
+# ── Twilio (SMS — optional) ──────────────────────────────
 TWILIO_ACCOUNT_SID=""
 TWILIO_AUTH_TOKEN=""
 TWILIO_PHONE_NUMBER=""
 
-# ── Email (SendGrid or SMTP) ─────────────────────────────
+# ── Email (SendGrid — optional) ──────────────────────────
 SENDGRID_API_KEY=""
 EMAIL_FROM="{{COMPANY_EMAIL}}"
 
-# ── Stripe ───────────────────────────────────────────────
+# ── Stripe (optional) ────────────────────────────────────
 STRIPE_SECRET_KEY=""
 STRIPE_WEBHOOK_SECRET=""
 
-# ── Push Notifications (VAPID) ───────────────────────────
+# ── Push Notifications / VAPID (optional) ────────────────
 VAPID_PUBLIC_KEY=""
 VAPID_PRIVATE_KEY=""
 VAPID_EMAIL="{{COMPANY_EMAIL}}"
@@ -38,7 +38,7 @@ VAPID_EMAIL="{{COMPANY_EMAIL}}"
 UPLOAD_DIR="./uploads"
 MAX_FILE_SIZE_MB=10
 
-# ── Feature Flags ────────────────────────────────────────
+# ── Feature Flags ─────────────────────────────────────────
 ENABLE_SANDATA_EVV=false
 ENABLE_GUSTO=false
 ENABLE_WORCS=false
diff --git a/templates/crm-homecare/render.yaml.template b/templates/crm-homecare/render.yaml.template
index 03fa93b..471b2e1 100644
--- a/templates/crm-homecare/render.yaml.template
+++ b/templates/crm-homecare/render.yaml.template
@@ -1,13 +1,15 @@
 # {{COMPANY_NAME}} HomeCare CRM — Render Blueprint
 # Generated by Twomiah Build Factory
+# Place this file at the ROOT of your repository for Render to discover it automatically
 
 services:
   - type: web
     name: {{COMPANY_SLUG}}-care-api
     runtime: node
     plan: starter
-    buildCommand: cd backend && npm install && npx prisma generate && npx prisma migrate deploy && node prisma/seed.js
-    startCommand: cd backend && node src/index.js
+    rootDir: crm/backend
+    buildCommand: npm install && npx prisma generate && npx prisma migrate deploy
+    startCommand: node prisma/seed.js && node src/index.js
     envVars:
       - key: DATABASE_URL
         fromDatabase:
@@ -21,18 +23,24 @@ services:
         generateValue: true
       - key: NODE_ENV
         value: production
+      - key: PORT
+        value: 10000
       - key: FRONTEND_URL
         value: https://{{COMPANY_SLUG}}-care.onrender.com
     disk:
       name: uploads
-      mountPath: /opt/render/project/src/backend/uploads
+      mountPath: /opt/render/project/src/uploads
       sizeGB: 2
 
   - type: web
     name: {{COMPANY_SLUG}}-care
     runtime: static
-    buildCommand: cd frontend && npm install && npm run build
-    staticPublishPath: frontend/dist
+    rootDir: crm/frontend
+    buildCommand: npm install && npm run build
+    staticPublishPath: dist
+    envVars:
+      - key: VITE_API_URL
+        value: https://{{COMPANY_SLUG}}-care-api.onrender.com
     headers:
       - path: /*
         name: X-Frame-Options
-- 
2.43.0


From c2c4a2603cda6ad224b5d4e255deaf3bc0a9d43d Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 13:49:55 +0000
Subject: [PATCH 05/27] fix: save wizardConfig on generate, include industry in
 push-update fallback

---
 backend/src/routes/factory.js | 18 +++++++++++++++++-
 1 file changed, 17 insertions(+), 1 deletion(-)

diff --git a/backend/src/routes/factory.js b/backend/src/routes/factory.js
index 2d6761c..084b02a 100644
--- a/backend/src/routes/factory.js
+++ b/backend/src/routes/factory.js
@@ -123,6 +123,7 @@ router.post('/generate', async (req, res) => {
             monthlyAmount: config.billing?.monthlyAmount || null,
             oneTimeAmount: config.billing?.oneTimeAmount || null,
             planId: config.billing?.planId || null,
+            wizardConfig: config,
           }
         });
       }
@@ -970,7 +971,22 @@ router.post('/customers/:id/push-update', async (req, res) => {
         const { generate: generatePackage } = await import('../services/factory/generator.js');
         const regen = await generatePackage(customer.wizardConfig || {
           products: customer.products,
-          company: { name: customer.name, slug: customer.slug },
+          company: {
+            name: customer.name,
+            slug: customer.slug,
+            email: customer.email,
+            phone: customer.phone,
+            domain: customer.domain,
+            industry: customer.industry,
+            city: customer.city,
+            state: customer.state,
+            zip: customer.zip,
+          },
+          branding: {
+            primaryColor: customer.primaryColor || '#f97316',
+            secondaryColor: customer.secondaryColor || '#1e293b',
+          },
+          features: { crm: customer.features || [] },
         });
         const zipPath = await factoryStorage.downloadZip(regen.zipPath, regen.storageType || 's3');
         const extractDir = `/tmp/update-${customer.slug}-${Date.now()}`;
-- 
2.43.0


From 69718bb114619c1f79c9e2506b61e25ca8f1ae86 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 13:58:08 +0000
Subject: [PATCH 06/27] fix: prisma NoshowAlert relation, capacitor dynamic
 imports, vite externalize capacitor

---
 .../crm-homecare/backend/prisma/schema.prisma |   3 +-
 .../frontend/src/hooks/useNative.js           | 437 +++++-------------
 .../crm-homecare/frontend/vite.config.js      |   6 +
 3 files changed, 128 insertions(+), 318 deletions(-)

diff --git a/templates/crm-homecare/backend/prisma/schema.prisma b/templates/crm-homecare/backend/prisma/schema.prisma
index df10d3e..7ec235a 100644
--- a/templates/crm-homecare/backend/prisma/schema.prisma
+++ b/templates/crm-homecare/backend/prisma/schema.prisma
@@ -102,6 +102,7 @@ model User {
   openShiftsCreated    OpenShift[]
   loginActivities      LoginActivity[]
   noshowsResolved      NoshowAlert[]        @relation("NoshowResolvedBy")
+  noshowAlertsCaused   NoshowAlert[]        @relation("NoshowCaregiver")
   validationResolved   ValidationLog[]
   remittanceBatches    RemittanceBatch[]
   ediBatchesCreated    EdiBatch[]
@@ -1005,7 +1006,7 @@ model NoshowAlert {
   scheduleId     String?
   schedule       Schedule? @relation(fields: [scheduleId], references: [id])
   caregiverId    String?
-  caregiver      User?     @relation(fields: [caregiverId], references: [id])
+  caregiver      User?     @relation("NoshowCaregiver", fields: [caregiverId], references: [id])
   clientId       String?
   client         Client?   @relation(fields: [clientId], references: [id])
   shiftDate      DateTime  @db.Date
diff --git a/templates/crm-homecare/frontend/src/hooks/useNative.js b/templates/crm-homecare/frontend/src/hooks/useNative.js
index 1086b34..74fe404 100644
--- a/templates/crm-homecare/frontend/src/hooks/useNative.js
+++ b/templates/crm-homecare/frontend/src/hooks/useNative.js
@@ -1,351 +1,154 @@
 // hooks/useNative.js
 // Unified native capabilities hook — works on web AND native (iOS/Android via Capacitor)
-// All Capacitor APIs fall back gracefully to browser APIs when running in a browser.
+// Capacitor is a mobile runtime — on web, all APIs fall back to browser equivalents.
 
 import { useState, useEffect, useCallback, useRef } from 'react';
-import { Capacitor } from '@capacitor/core';
 
-// ── Lazy plugin loaders (don't crash on web if plugin unavailable) ─────────────
+// ── Safe Capacitor loader — never crashes on web ───────────────────
+const isNative = () => {
+  try {
+    return typeof window !== 'undefined' && window.Capacitor?.isNativePlatform?.() === true;
+  } catch {
+    return false;
+  }
+};
+
+const getCapacitor   = () => import('@capacitor/core').then(m => m.Capacitor).catch(() => null);
 const getGeolocation = () => import('@capacitor/geolocation').then(m => m.Geolocation).catch(() => null);
 const getNetwork     = () => import('@capacitor/network').then(m => m.Network).catch(() => null);
-const getHaptics     = () => import('@capacitor/haptics').then(m => m.Haptics).catch(() => null);
+const getCamera      = () => import('@capacitor/camera').then(m => m).catch(() => null);
 const getLocalNotif  = () => import('@capacitor/local-notifications').then(m => m.LocalNotifications).catch(() => null);
-const getBgGeo       = () => import('@capacitor-community/background-geolocation').then(m => m.BackgroundGeolocation).catch(() => null);
-
-export const isNative = Capacitor.isNativePlatform();
-export const platform = Capacitor.getPlatform(); // 'ios' | 'android' | 'web'
 
-// ── useNetwork ────────────────────────────────────────────────────────────────
-// Returns { online, connectionType } and listens for changes
-export function useNetwork() {
-  // Default to true — assume online until proven otherwise
-  // navigator.onLine is unreliable in Capacitor Android WebView
-  const [status, setStatus] = useState({ online: true, connectionType: 'unknown' });
+export function useNative() {
+  const [platform, setPlatform] = useState('web');
+  const [networkStatus, setNetworkStatus] = useState({ connected: true, connectionType: 'unknown' });
+  const watchIdRef = useRef(null);
 
   useEffect(() => {
-    let cleanup = () => {};
-
-    async function init() {
-      const Network = await getNetwork();
-
-      if (Network && isNative) {
-        // Native: use Capacitor Network plugin
-        const current = await Network.getStatus();
-        setStatus({ online: current.connected, connectionType: current.connectionType });
+    (async () => {
+      try {
+        const Cap = await getCapacitor();
+        if (Cap) setPlatform(Cap.getPlatform?.() || 'web');
+      } catch { /* web — ignore */ }
+    })();
+  }, []);
 
-        const handle = await Network.addListener('networkStatusChange', s => {
-          setStatus({ online: s.connected, connectionType: s.connectionType });
-        });
-        cleanup = () => handle.remove();
-      } else {
-        // Web: use browser events
-        const onOnline  = () => setStatus(s => ({ ...s, online: true }));
-        const onOffline = () => setStatus(s => ({ ...s, online: false }));
-        window.addEventListener('online', onOnline);
-        window.addEventListener('offline', onOffline);
-        cleanup = () => {
-          window.removeEventListener('online', onOnline);
-          window.removeEventListener('offline', onOffline);
-        };
+  // ── Geolocation ───────────────────────────────────────────────────
+  const getCurrentPosition = useCallback(async () => {
+    try {
+      if (isNative()) {
+        const Geo = await getGeolocation();
+        if (Geo) return await Geo.getCurrentPosition({ enableHighAccuracy: true, timeout: 10000 });
       }
+      // Web fallback
+      return await new Promise((resolve, reject) =>
+        navigator.geolocation.getCurrentPosition(
+          p => resolve({ coords: { latitude: p.coords.latitude, longitude: p.coords.longitude, accuracy: p.coords.accuracy } }),
+          reject,
+          { enableHighAccuracy: true, timeout: 10000 }
+        )
+      );
+    } catch {
+      return null;
     }
-
-    init();
-    return () => cleanup();
   }, []);
 
-  return status;
-}
-
-// ── useGeolocation ────────────────────────────────────────────────────────────
-// One-shot position grab + optional watch mode
-export function useGeolocation({ watch = false, highAccuracy = true } = {}) {
-  const [position, setPosition] = useState(null);
-  const [error, setError]       = useState(null);
-  const [loading, setLoading]   = useState(false);
-  const watchIdRef = useRef(null);
-
-  const getPosition = useCallback(async () => {
-    setLoading(true);
-    setError(null);
+  const watchPosition = useCallback(async (callback) => {
     try {
-      const Geolocation = await getGeolocation();
-
-      if (Geolocation && isNative) {
-        // Native: request permissions first
-        const perm = await Geolocation.requestPermissions();
-        if (perm.location !== 'granted') {
-          throw new Error('Location permission denied');
+      if (isNative()) {
+        const Geo = await getGeolocation();
+        if (Geo) {
+          watchIdRef.current = await Geo.watchPosition({ enableHighAccuracy: true }, callback);
+          return;
         }
-        const pos = await Geolocation.getCurrentPosition({
-          enableHighAccuracy: highAccuracy,
-          timeout: 15000,
-        });
-        setPosition({
-          latitude:  pos.coords.latitude,
-          longitude: pos.coords.longitude,
-          accuracy:  pos.coords.accuracy,
-          timestamp: pos.timestamp,
-        });
-      } else {
-        // Web: browser geolocation
-        await new Promise((resolve, reject) => {
-          navigator.geolocation.getCurrentPosition(
-            pos => {
-              setPosition({
-                latitude:  pos.coords.latitude,
-                longitude: pos.coords.longitude,
-                accuracy:  pos.coords.accuracy,
-                timestamp: pos.timestamp,
-              });
-              resolve();
-            },
-            err => reject(new Error(err.message)),
-            { enableHighAccuracy: highAccuracy, timeout: 15000 }
-          );
-        });
-      }
-    } catch (err) {
-      setError(err.message);
-    } finally {
-      setLoading(false);
-    }
-  }, [highAccuracy]);
-
-  // Watch mode
-  useEffect(() => {
-    if (!watch) return;
-    let cancelled = false;
-
-    async function startWatch() {
-      const Geolocation = await getGeolocation();
-      if (Geolocation && isNative) {
-        watchIdRef.current = await Geolocation.watchPosition(
-          { enableHighAccuracy: true },
-          (pos, err) => {
-            if (cancelled) return;
-            if (err) { setError(err.message); return; }
-            setPosition({
-              latitude:  pos.coords.latitude,
-              longitude: pos.coords.longitude,
-              accuracy:  pos.coords.accuracy,
-              timestamp: pos.timestamp,
-            });
-          }
-        );
-      } else {
-        watchIdRef.current = navigator.geolocation.watchPosition(
-          pos => {
-            if (cancelled) return;
-            setPosition({
-              latitude:  pos.coords.latitude,
-              longitude: pos.coords.longitude,
-              accuracy:  pos.coords.accuracy,
-              timestamp: pos.timestamp,
-            });
-          },
-          err => setError(err.message),
-          { enableHighAccuracy: true }
-        );
-      }
-    }
-
-    startWatch();
-    return () => {
-      cancelled = true;
-      if (watchIdRef.current !== null) {
-        getGeolocation().then(G => {
-          if (G && isNative) G.clearWatch({ id: watchIdRef.current });
-          else navigator.geolocation.clearWatch(watchIdRef.current);
-        });
       }
-    };
-  }, [watch]);
-
-  return { position, error, loading, getPosition };
-}
-
-// ── useHaptics ────────────────────────────────────────────────────────────────
-// Returns haptic feedback functions — no-ops on web
-export function useHaptics() {
-  const impact = useCallback(async (style = 'medium') => {
-    if (!isNative) return;
-    const Haptics = await getHaptics();
-    if (!Haptics) return;
-    const styleMap = { light: 'LIGHT', medium: 'MEDIUM', heavy: 'HEAVY' };
-    await Haptics.impact({ style: styleMap[style] || 'MEDIUM' }).catch(() => {});
-  }, []);
-
-  const notification = useCallback(async (type = 'success') => {
-    if (!isNative) return;
-    const Haptics = await getHaptics();
-    if (!Haptics) return;
-    const typeMap = { success: 'SUCCESS', warning: 'WARNING', error: 'ERROR' };
-    await Haptics.notification({ type: typeMap[type] || 'SUCCESS' }).catch(() => {});
+      watchIdRef.current = navigator.geolocation.watchPosition(
+        p => callback({ coords: { latitude: p.coords.latitude, longitude: p.coords.longitude, accuracy: p.coords.accuracy } }),
+        null,
+        { enableHighAccuracy: true }
+      );
+    } catch { /* ignore */ }
   }, []);
 
-  return { impact, notification };
-}
-
-// ── useOfflineSync ────────────────────────────────────────────────────────────
-// Reads the offline queue from IndexedDB and exposes sync status
-export function useOfflineSync() {
-  const [queueCount, setQueueCount] = useState(0);
-  const [syncing, setSyncing]       = useState(false);
-  const { online } = useNetwork();
-
-  const openDB = () => new Promise((resolve, reject) => {
-    const req = indexedDB.open('homecare-offline', 1);
-    req.onupgradeneeded = e => e.target.result.createObjectStore('queue', { keyPath: 'id' });
-    req.onsuccess = e => resolve(e.target.result);
-    req.onerror   = e => reject(e.target.error);
-  });
-
-  const getQueueCount = useCallback(async () => {
+  const clearWatch = useCallback(async () => {
+    if (watchIdRef.current == null) return;
     try {
-      const db  = await openDB();
-      const tx  = db.transaction('queue', 'readonly');
-      const req = tx.objectStore('queue').count();
-      req.onsuccess = () => setQueueCount(req.result);
+      if (isNative()) {
+        const Geo = await getGeolocation();
+        if (Geo) await Geo.clearWatch({ id: watchIdRef.current });
+      } else {
+        navigator.geolocation.clearWatch(watchIdRef.current);
+      }
     } catch { /* ignore */ }
+    watchIdRef.current = null;
   }, []);
 
-  // Poll queue count every 5s
-  useEffect(() => {
-    getQueueCount();
-    const interval = setInterval(getQueueCount, 5000);
-    return () => clearInterval(interval);
-  }, [getQueueCount]);
-
-  // Listen for SW messages
-  useEffect(() => {
-    const handler = (event) => {
-      if (event.data?.type === 'SYNCED' || event.data?.type === 'QUEUED') {
-        getQueueCount();
-      }
-    };
-    navigator.serviceWorker?.addEventListener('message', handler);
-    return () => navigator.serviceWorker?.removeEventListener('message', handler);
-  }, [getQueueCount]);
-
-  // Auto-trigger background sync when back online
-  useEffect(() => {
-    if (online && queueCount > 0) {
-      setSyncing(true);
-      navigator.serviceWorker?.ready
-        .then(sw => sw.sync?.register('sync-queue'))
-        .catch(() => {})
-        .finally(() => setTimeout(() => setSyncing(false), 2000));
-    }
-  }, [online, queueCount]);
-
-  return { queueCount, syncing, online };
-}
-
-
-// ── useBackgroundGeolocation ──────────────────────────────────────────────────
-// Runs a foreground service on Android that keeps GPS active even when the
-// screen is off or the app is backgrounded. Shows a persistent notification
-// so Android doesn't kill it. Falls back to regular watchPosition on web/iOS.
-export function useBackgroundGeolocation() {
-  const [isRunning, setIsRunning] = useState(false);
-
-  const start = useCallback(async ({ onLocation, notificationTitle = 'CVHC HomeCare', notificationText = 'Monitoring your location for auto clock-in' } = {}) => {
-    const BgGeo = await getBgGeo();
-
-    if (BgGeo && isNative && platform === 'android') {
-      try {
-        // Request permissions first
-        const Geo = await getGeolocation();
-        if (Geo) {
-          const perm = await Geo.requestPermissions({ permissions: ['location', 'coarseLocation'] });
-          if (perm.location !== 'granted') throw new Error('Location permission denied');
+  // ── Camera ────────────────────────────────────────────────────────
+  const takePhoto = useCallback(async () => {
+    try {
+      if (isNative()) {
+        const cam = await getCamera();
+        if (cam) {
+          return await cam.Camera.getPhoto({
+            quality: 85,
+            allowEditing: false,
+            resultType: cam.CameraResultType.DataUrl,
+            source: cam.CameraSource.Camera,
+          });
         }
-
-        await BgGeo.addWatcher(
-          {
-            backgroundMessage: notificationText,
-            backgroundTitle: notificationTitle,
-            requestPermissions: true,
-            stale: false,
-            distanceFilter: 20, // meters — only fire if moved 20m
-          },
-          (location, error) => {
-            if (error) {
-              console.warn('[BgGeo]', error.code, error.message);
-              return;
-            }
-            if (onLocation) onLocation({
-              latitude: location.latitude,
-              longitude: location.longitude,
-              accuracy: location.accuracy,
-              timestamp: location.time,
-            });
-          }
-        );
-        setIsRunning(true);
-        console.log('[BgGeo] Background geolocation started');
-      } catch (err) {
-        console.warn('[BgGeo] Failed to start background geolocation:', err.message);
-        // Fall back to regular watch
-        setIsRunning(false);
-      }
-    } else {
-      // Web or iOS — use regular watchPosition as fallback
-      if ('geolocation' in navigator) {
-        navigator.geolocation.watchPosition(
-          pos => {
-            if (onLocation) onLocation({
-              latitude: pos.coords.latitude,
-              longitude: pos.coords.longitude,
-              accuracy: pos.coords.accuracy,
-              timestamp: pos.timestamp,
-            });
-          },
-          err => console.warn('[BgGeo fallback]', err.message),
-          { enableHighAccuracy: true, maximumAge: 10000 }
-        );
-        setIsRunning(true);
       }
+      // Web fallback — trigger file input
+      return await new Promise((resolve) => {
+        const input = document.createElement('input');
+        input.type = 'file';
+        input.accept = 'image/*';
+        input.capture = 'environment';
+        input.onchange = e => {
+          const file = e.target.files[0];
+          if (!file) return resolve(null);
+          const reader = new FileReader();
+          reader.onload = ev => resolve({ dataUrl: ev.target.result, format: 'jpeg' });
+          reader.readAsDataURL(file);
+        };
+        input.click();
+      });
+    } catch {
+      return null;
     }
   }, []);
 
-  const stop = useCallback(async () => {
-    const BgGeo = await getBgGeo();
-    if (BgGeo && isNative && platform === 'android') {
-      await BgGeo.removeAllWatchers().catch(() => {});
-    }
-    setIsRunning(false);
+  // ── Network ───────────────────────────────────────────────────────
+  useEffect(() => {
+    let handler = null;
+    (async () => {
+      try {
+        if (isNative()) {
+          const Net = await getNetwork();
+          if (Net) {
+            const status = await Net.getStatus();
+            setNetworkStatus(status);
+            handler = await Net.addListener('networkStatusChange', setNetworkStatus);
+          }
+        } else {
+          const update = () => setNetworkStatus({ connected: navigator.onLine, connectionType: 'unknown' });
+          window.addEventListener('online', update);
+          window.addEventListener('offline', update);
+          return () => { window.removeEventListener('online', update); window.removeEventListener('offline', update); };
+        }
+      } catch { /* ignore */ }
+    })();
+    return () => { handler?.remove?.(); };
   }, []);
 
-  return { start, stop, isRunning };
+  return {
+    platform,
+    isNative: isNative(),
+    networkStatus,
+    getCurrentPosition,
+    watchPosition,
+    clearWatch,
+    takePhoto,
+  };
 }
 
-// ── useLocalNotifications ─────────────────────────────────────────────────────
-// Schedule local notifications (shift reminders etc)
-export function useLocalNotifications() {
-  const schedule = useCallback(async ({ title, body, id, at }) => {
-    const LN = await getLocalNotif();
-    if (!LN || !isNative) return;
-    const perm = await LN.requestPermissions();
-    if (perm.display !== 'granted') return;
-    await LN.schedule({
-      notifications: [{
-        id: id || Date.now(),
-        title,
-        body,
-        schedule: at ? { at: new Date(at) } : undefined,
-        sound: 'default',
-        smallIcon: 'ic_stat_icon_config_sample',
-      }]
-    });
-  }, []);
-
-  const cancel = useCallback(async (id) => {
-    const LN = await getLocalNotif();
-    if (!LN || !isNative) return;
-    await LN.cancel({ notifications: [{ id }] });
-  }, []);
-
-  return { schedule, cancel };
-}
+export default useNative;
diff --git a/templates/crm-homecare/frontend/vite.config.js b/templates/crm-homecare/frontend/vite.config.js
index 3054c75..081fdd5 100644
--- a/templates/crm-homecare/frontend/vite.config.js
+++ b/templates/crm-homecare/frontend/vite.config.js
@@ -4,4 +4,10 @@ import react from '@vitejs/plugin-react';
 export default defineConfig({
   plugins: [react()],
   server: { port: 5173, host: true },
+  build: {
+    rollupOptions: {
+      // Capacitor packages are mobile-only — externalize so web build doesn't fail
+      external: (id) => id.startsWith('@capacitor/'),
+    },
+  },
 });
-- 
2.43.0


From 22e21405e120891a157341d927d883b8af91b42d Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 14:04:01 +0000
Subject: [PATCH 07/27] fix: conditional require for routes/services so
 stripped optional routes don't crash server

---
 templates/website-contractor/server-static.js | 4 ++--
 templates/website-general/server-static.js    | 4 ++--
 templates/website-homecare/server-static.js   | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/templates/website-contractor/server-static.js b/templates/website-contractor/server-static.js
index 6c4a6da..37b7787 100644
--- a/templates/website-contractor/server-static.js
+++ b/templates/website-contractor/server-static.js
@@ -6,9 +6,9 @@ const rateLimit = require('express-rate-limit');
 const path = require('path');
 const fs = require('fs');
 
-// Routes
-const servicesRoutes = require('./routes/services');
+// Routes — loaded conditionally so missing optional route files don't crash the server
 const adminRoutes = require('./routes/admin');
+const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
 const { rebuildMiddleware } = require('./rebuild-middleware');
 
diff --git a/templates/website-general/server-static.js b/templates/website-general/server-static.js
index 6c4a6da..37b7787 100644
--- a/templates/website-general/server-static.js
+++ b/templates/website-general/server-static.js
@@ -6,9 +6,9 @@ const rateLimit = require('express-rate-limit');
 const path = require('path');
 const fs = require('fs');
 
-// Routes
-const servicesRoutes = require('./routes/services');
+// Routes — loaded conditionally so missing optional route files don't crash the server
 const adminRoutes = require('./routes/admin');
+const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
 const { rebuildMiddleware } = require('./rebuild-middleware');
 
diff --git a/templates/website-homecare/server-static.js b/templates/website-homecare/server-static.js
index 6c4a6da..37b7787 100644
--- a/templates/website-homecare/server-static.js
+++ b/templates/website-homecare/server-static.js
@@ -6,9 +6,9 @@ const rateLimit = require('express-rate-limit');
 const path = require('path');
 const fs = require('fs');
 
-// Routes
-const servicesRoutes = require('./routes/services');
+// Routes — loaded conditionally so missing optional route files don't crash the server
 const adminRoutes = require('./routes/admin');
+const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
 const { rebuildMiddleware } = require('./rebuild-middleware');
 
-- 
2.43.0


From 9d1f7effee9edbe6695cb361a5e65b3a1e7c1bda Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 14:14:57 +0000
Subject: [PATCH 08/27] fix: add JWT_SECRET to website service env vars in
 factory deploy

---
 backend/src/services/factory/deploy.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 7bfa964..29df9a7 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -459,6 +459,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
           envVars: [
             { key: 'NODE_ENV', value: 'production' },
             { key: 'PORT', value: '10000' },
+            { key: 'JWT_SECRET', value: jwtSecret },
           ],
           plan,
           region,
-- 
2.43.0


From adfc799f239c81ef4e0bb8247539026691b68f80 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 14:18:37 +0000
Subject: [PATCH 09/27] fix: make rebuild-middleware and all optional requires
 safe, fix path to services/

---
 templates/website-contractor/server-static.js | 2 +-
 templates/website-general/server-static.js    | 2 +-
 templates/website-homecare/server-static.js   | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/templates/website-contractor/server-static.js b/templates/website-contractor/server-static.js
index 37b7787..d2b807b 100644
--- a/templates/website-contractor/server-static.js
+++ b/templates/website-contractor/server-static.js
@@ -10,7 +10,7 @@ const fs = require('fs');
 const adminRoutes = require('./routes/admin');
 const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
-const { rebuildMiddleware } = require('./rebuild-middleware');
+const { rebuildMiddleware } = (() => { try { return require('./rebuild-middleware'); } catch(e) { return { rebuildMiddleware: (req, res, next) => next() }; } })();
 
 const app = express();
 app.set('trust proxy', 1);
diff --git a/templates/website-general/server-static.js b/templates/website-general/server-static.js
index 37b7787..d2b807b 100644
--- a/templates/website-general/server-static.js
+++ b/templates/website-general/server-static.js
@@ -10,7 +10,7 @@ const fs = require('fs');
 const adminRoutes = require('./routes/admin');
 const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
-const { rebuildMiddleware } = require('./rebuild-middleware');
+const { rebuildMiddleware } = (() => { try { return require('./rebuild-middleware'); } catch(e) { return { rebuildMiddleware: (req, res, next) => next() }; } })();
 
 const app = express();
 app.set('trust proxy', 1);
diff --git a/templates/website-homecare/server-static.js b/templates/website-homecare/server-static.js
index 37b7787..845e729 100644
--- a/templates/website-homecare/server-static.js
+++ b/templates/website-homecare/server-static.js
@@ -10,7 +10,7 @@ const fs = require('fs');
 const adminRoutes = require('./routes/admin');
 const servicesRoutes = (() => { try { return require('./routes/services'); } catch(e) { const r = require('express').Router(); r.get('/', (_, res) => res.json([])); return r; } })();
 const { startSchedule: startBackups } = require('./services/autoBackup');
-const { rebuildMiddleware } = require('./rebuild-middleware');
+const { rebuildMiddleware } = (() => { try { return require('./services/rebuild-middleware'); } catch(e) { try { return require('./rebuild-middleware'); } catch(e2) { return { rebuildMiddleware: (req, res, next) => next() }; } } })();
 
 const app = express();
 app.set('trust proxy', 1);
-- 
2.43.0


From ec0ca376b7119af429c2a043f1b004da33c2d02c Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 14:45:05 +0000
Subject: [PATCH 10/27] fix: add prop-types to frontend dependencies

---
 templates/crm-homecare/frontend/package.json | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/templates/crm-homecare/frontend/package.json b/templates/crm-homecare/frontend/package.json
index 8766065..9d71ff5 100644
--- a/templates/crm-homecare/frontend/package.json
+++ b/templates/crm-homecare/frontend/package.json
@@ -15,7 +15,8 @@
     "react-dom": "^18.2.0",
     "react-router-dom": "^6.22.1",
     "socket.io-client": "^4.7.4",
-    "zustand": "^4.5.0"
+    "zustand": "^4.5.0",
+    "prop-types": "^15.8.1"
   },
   "devDependencies": {
     "@types/react": "^18.2.56",
@@ -26,4 +27,4 @@
     "tailwindcss": "^3.4.1",
     "vite": "^5.1.4"
   }
-}
+}
\ No newline at end of file
-- 
2.43.0


From 0a2d0bff8eda079168b4b7f452619456b883c4da Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 19:34:04 +0000
Subject: [PATCH 11/27] fix: add wizardConfig Json field to FactoryCustomer
 schema

---
 backend/prisma/schema.prisma | 1 +
 1 file changed, 1 insertion(+)

diff --git a/backend/prisma/schema.prisma b/backend/prisma/schema.prisma
index db60f94..0e44c40 100644
--- a/backend/prisma/schema.prisma
+++ b/backend/prisma/schema.prisma
@@ -2422,6 +2422,7 @@ model FactoryCustomer {
   repoUrl          String?  // GitHub repo URL after deploy
   adminEmail       String?
   adminPassword    String? // Stored temporarily, cleared after first login
+  wizardConfig     Json?    // Full wizard config used to generate this customer
 
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
-- 
2.43.0


From 65293f2121bdf00eac749ecbe70fb306e9e19cc1 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 21:10:34 +0000
Subject: [PATCH 12/27] fix: remove missing MileageTracker import from
 CaregiverDashboard

---
 .../frontend/src/components/caregiver/CaregiverDashboard.jsx     | 1 -
 1 file changed, 1 deletion(-)

diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
index 8d2c5e6..e9e39b0 100644
--- a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
@@ -4,7 +4,6 @@ import React, { useState, useEffect, useRef, useCallback } from 'react';
 import { API_BASE_URL } from '../../config';
 import { toast } from '../Toast';
 import CaregiverClientModal from '../CaregiverClientModal';
-import MileageTracker from './MileageTracker';
 import ShiftMissReport from './caregiver/ShiftMissReport';
 import CaregiverHelp from './caregiver/CaregiverHelp';
 import CaregiverMessages from './caregiver/CaregiverMessages';
-- 
2.43.0


From b2f6f690b73a57c990bd9882091ca0986a44c2d7 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 21:14:59 +0000
Subject: [PATCH 13/27] fix: add MileageTracker to caregiver folder, sync
 CaregiverDashboard from source

---
 .../caregiver/CaregiverDashboard.jsx          |   1 +
 .../components/caregiver/MileageTracker.jsx   | 375 ++++++++++++++++++
 2 files changed, 376 insertions(+)
 create mode 100644 templates/crm-homecare/frontend/src/components/caregiver/MileageTracker.jsx

diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
index e9e39b0..8d2c5e6 100644
--- a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
@@ -4,6 +4,7 @@ import React, { useState, useEffect, useRef, useCallback } from 'react';
 import { API_BASE_URL } from '../../config';
 import { toast } from '../Toast';
 import CaregiverClientModal from '../CaregiverClientModal';
+import MileageTracker from './MileageTracker';
 import ShiftMissReport from './caregiver/ShiftMissReport';
 import CaregiverHelp from './caregiver/CaregiverHelp';
 import CaregiverMessages from './caregiver/CaregiverMessages';
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/MileageTracker.jsx b/templates/crm-homecare/frontend/src/components/caregiver/MileageTracker.jsx
new file mode 100644
index 0000000..f71524c
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/caregiver/MileageTracker.jsx
@@ -0,0 +1,375 @@
+// src/components/MileageTracker.jsx
+// Simple start/stop mileage tracking for caregivers
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+// Calculate distance between two GPS points (Haversine formula)
+const calculateDistance = (lat1, lon1, lat2, lon2) => {
+  const R = 3959; // Earth's radius in miles
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = 
+    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
+    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
+    Math.sin(dLon / 2) * Math.sin(dLon / 2);
+  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
+  const straightLine = R * c;
+  // Multiply by 1.3 to approximate road distance (roads aren't straight)
+  return straightLine * 1.3;
+};
+
+const MileageTracker = ({ token, caregiverId }) => {
+  const [tripState, setTripState] = useState('idle'); // idle, started, ended
+  const [startPoint, setStartPoint] = useState(null);
+  const [endPoint, setEndPoint] = useState(null);
+  const [startLocation, setStartLocation] = useState('');
+  const [endLocation, setEndLocation] = useState('');
+  const [calculatedMiles, setCalculatedMiles] = useState(0);
+  const [error, setError] = useState(null);
+  const [saving, setSaving] = useState(false);
+  const [gettingLocation, setGettingLocation] = useState(false);
+  const [showHistory, setShowHistory] = useState(false);
+  const [history, setHistory] = useState([]);
+  const [loadingHistory, setLoadingHistory] = useState(false);
+
+  const getCurrentPosition = () => {
+    return new Promise((resolve, reject) => {
+      if (!navigator.geolocation) {
+        reject(new Error('Geolocation not supported'));
+        return;
+      }
+      navigator.geolocation.getCurrentPosition(
+        (position) => resolve({
+          lat: position.coords.latitude,
+          lon: position.coords.longitude,
+          accuracy: position.coords.accuracy
+        }),
+        (err) => reject(err),
+        { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
+      );
+    });
+  };
+
+  const reverseGeocode = async (lat, lon) => {
+    try {
+      const response = await fetch(
+        `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`,
+        { headers: { 'User-Agent': 'CVHC-CRM' } }
+      );
+      if (response.ok) {
+        const data = await response.json();
+        const parts = [];
+        if (data.address?.house_number && data.address?.road) {
+          parts.push(`${data.address.house_number} ${data.address.road}`);
+        } else if (data.address?.road) {
+          parts.push(data.address.road);
+        }
+        if (data.address?.city || data.address?.town || data.address?.village) {
+          parts.push(data.address.city || data.address.town || data.address.village);
+        }
+        return parts.join(', ') || 'Unknown location';
+      }
+    } catch (e) {
+      console.error('Reverse geocode failed:', e);
+    }
+    return 'Unknown location';
+  };
+
+  const handleStartTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setStartPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setStartLocation(address);
+      
+      setTripState('started');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else if (err.code === 2) {
+        setError('Unable to get location. Please try again.');
+      } else {
+        setError('Location timeout. Make sure GPS is enabled.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleEndTrip = async () => {
+    setError(null);
+    setGettingLocation(true);
+    
+    try {
+      const position = await getCurrentPosition();
+      setEndPoint(position);
+      
+      const address = await reverseGeocode(position.lat, position.lon);
+      setEndLocation(address);
+      
+      // Calculate distance
+      const miles = calculateDistance(
+        startPoint.lat, startPoint.lon,
+        position.lat, position.lon
+      );
+      setCalculatedMiles(Math.round(miles * 10) / 10);
+      
+      setTripState('ended');
+    } catch (err) {
+      if (err.code === 1) {
+        setError('Location access denied. Please enable location permissions.');
+      } else {
+        setError('Unable to get location. Please try again.');
+      }
+    } finally {
+      setGettingLocation(false);
+    }
+  };
+
+  const handleSaveTrip = async () => {
+    if (calculatedMiles < 0.1) {
+      alert('Trip too short to save');
+      return;
+    }
+
+    setSaving(true);
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/payroll/mileage`, {
+        method: 'POST',
+        headers: {
+          'Content-Type': 'application/json',
+          'Authorization': `Bearer ${token}`
+        },
+        body: JSON.stringify({
+          caregiverId,
+          date: new Date().toISOString().split('T')[0],
+          miles: calculatedMiles,
+          fromLocation: startLocation,
+          toLocation: endLocation,
+          notes: `GPS tracked: ${startLocation} → ${endLocation}`
+        })
+      });
+
+      if (!response.ok) throw new Error('Failed to save mileage');
+
+      alert(`Saved ${calculatedMiles} miles!`);
+      handleReset();
+      
+    } catch (error) {
+      alert('Failed to save: ' + error.message);
+    } finally {
+      setSaving(false);
+    }
+  };
+
+  const handleReset = () => {
+    setTripState('idle');
+    setStartPoint(null);
+    setEndPoint(null);
+    setStartLocation('');
+    setEndLocation('');
+    setCalculatedMiles(0);
+    setError(null);
+  };
+
+  const loadHistory = async () => {
+    setLoadingHistory(true);
+    try {
+      const response = await fetch(
+        `${API_BASE_URL}/api/payroll/mileage?caregiverId=${caregiverId}`,
+        { headers: { 'Authorization': `Bearer ${token}` } }
+      );
+      if (response.ok) {
+        setHistory(await response.json());
+      }
+    } catch (error) {
+      console.error('Failed to load history:', error);
+    } finally {
+      setLoadingHistory(false);
+    }
+  };
+
+  const handleToggleHistory = () => {
+    if (!showHistory) loadHistory();
+    setShowHistory(!showHistory);
+  };
+
+  return (
+    <div className="card" style={{ marginBottom: '1rem' }}>
+      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
+        <h3 style={{ margin: 0 }}>🚗 Mileage Tracker</h3>
+        <button 
+          className="btn btn-sm btn-secondary"
+          onClick={handleToggleHistory}
+        >
+          {showHistory ? 'Hide' : 'History'}
+        </button>
+      </div>
+
+      {error && (
+        <div style={{ 
+          background: '#f8d7da', 
+          color: '#721c24', 
+          padding: '0.75rem', 
+          borderRadius: '6px',
+          marginBottom: '1rem'
+        }}>
+          ⚠️ {error}
+        </div>
+      )}
+
+      {/* IDLE STATE */}
+      {tripState === 'idle' && (
+        <div style={{ textAlign: 'center', padding: '1rem' }}>
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Tap when leaving to start tracking
+          </p>
+          <button 
+            className="btn btn-primary"
+            onClick={handleStartTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🚗 Start Trip'}
+          </button>
+        </div>
+      )}
+
+      {/* STARTED STATE */}
+      {tripState === 'started' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#d4edda', 
+            padding: '1rem', 
+            borderRadius: '8px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ color: '#155724', fontWeight: 'bold' }}>📍 Trip Started</div>
+            <div style={{ color: '#666', fontSize: '0.9rem', marginTop: '0.5rem' }}>
+              From: {startLocation}
+            </div>
+          </div>
+          
+          <p style={{ color: '#666', marginBottom: '1rem' }}>
+            Drive to your destination, then tap End Trip
+          </p>
+          
+          <button 
+            className="btn btn-danger"
+            onClick={handleEndTrip}
+            disabled={gettingLocation}
+            style={{ padding: '1rem 2rem', fontSize: '1.1rem', width: '100%' }}
+          >
+            {gettingLocation ? '📍 Getting location...' : '🏁 End Trip'}
+          </button>
+          
+          <button 
+            className="btn btn-secondary"
+            onClick={handleReset}
+            style={{ marginTop: '0.5rem', width: '100%' }}
+          >
+            Cancel
+          </button>
+        </div>
+      )}
+
+      {/* ENDED STATE - Show results */}
+      {tripState === 'ended' && (
+        <div style={{ textAlign: 'center' }}>
+          <div style={{ 
+            background: '#f8f9fa', 
+            padding: '1.5rem', 
+            borderRadius: '12px',
+            marginBottom: '1rem'
+          }}>
+            <div style={{ fontSize: '2.5rem', fontWeight: 'bold', color: '#007bff' }}>
+              {calculatedMiles} miles
+            </div>
+            
+            <div style={{ 
+              marginTop: '1rem', 
+              fontSize: '0.9rem', 
+              color: '#666',
+              textAlign: 'left',
+              padding: '0 1rem'
+            }}>
+              <div style={{ marginBottom: '0.5rem' }}>
+                <strong>From:</strong> {startLocation}
+              </div>
+              <div>
+                <strong>To:</strong> {endLocation}
+              </div>
+            </div>
+          </div>
+
+          <p style={{ fontSize: '0.8rem', color: '#999', marginBottom: '1rem' }}>
+            *Estimated road distance
+          </p>
+
+          <div style={{ display: 'flex', gap: '0.5rem' }}>
+            <button 
+              className="btn btn-primary"
+              onClick={handleSaveTrip}
+              disabled={saving}
+              style={{ flex: 1 }}
+            >
+              {saving ? 'Saving...' : '💾 Save'}
+            </button>
+            <button 
+              className="btn btn-secondary"
+              onClick={handleReset}
+              style={{ flex: 1 }}
+            >
+              🗑️ Discard
+            </button>
+          </div>
+        </div>
+      )}
+
+      {/* History Section */}
+      {showHistory && (
+        <div style={{ marginTop: '1.5rem', borderTop: '1px solid #ddd', paddingTop: '1rem' }}>
+          <h4 style={{ marginTop: 0 }}>Recent Trips</h4>
+          {loadingHistory ? (
+            <p>Loading...</p>
+          ) : history.length === 0 ? (
+            <p style={{ color: '#666' }}>No trips recorded yet</p>
+          ) : (
+            <div style={{ maxHeight: '200px', overflowY: 'auto' }}>
+              {history.slice(0, 10).map((trip, idx) => (
+                <div 
+                  key={trip.id || idx}
+                  style={{ 
+                    padding: '0.5rem',
+                    background: idx % 2 === 0 ? '#f8f9fa' : '#fff',
+                    borderRadius: '4px',
+                    marginBottom: '0.25rem',
+                    fontSize: '0.9rem'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                    <strong>{trip.miles} mi</strong>
+                    <span style={{ color: '#666' }}>
+                      {new Date(trip.date).toLocaleDateString()}
+                    </span>
+                  </div>
+                  {(trip.from_location || trip.to_location) && (
+                    <div style={{ fontSize: '0.8rem', color: '#666', marginTop: '2px' }}>
+                      {trip.from_location} → {trip.to_location}
+                    </div>
+                  )}
+                </div>
+              ))}
+            </div>
+          )}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default MileageTracker;
-- 
2.43.0


From 722a0f8a083c655ef01e0fc265f141d01d6ee507 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 21:23:43 +0000
Subject: [PATCH 14/27] fix: sync homecare frontend from CVHC source, fix vite
 config, use original useNative

---
 .../crm-homecare/frontend/package-lock.json   | 3480 +++++++++++++++++
 templates/crm-homecare/frontend/package.json  |   46 +-
 .../crm-homecare/frontend/postcss.config.js   |    3 -
 templates/crm-homecare/frontend/src/App.jsx   |  288 +-
 .../src/components/AdminDashboard.jsx         |  558 +++
 .../src/components/ApplicationForm.jsx        |  539 +++
 .../src/components/CaregiverDashboard.jsx     | 1172 ++++++
 .../src/components/ImpersonationModal.jsx     |  175 +
 .../frontend/src/components/Login.jsx         |  122 +
 .../frontend/src/components/PaymentPage.jsx   |  346 ++
 .../caregiver/CaregiverDashboard.jsx          |    6 +-
 templates/crm-homecare/frontend/src/config.js |  225 +-
 .../frontend/src/hooks/useNative.js           |  437 ++-
 templates/crm-homecare/frontend/src/index.jsx |   28 +
 .../crm-homecare/frontend/src/styles.css      | 1340 +++++++
 .../crm-homecare/frontend/vite.config.js      |   39 +-
 16 files changed, 8427 insertions(+), 377 deletions(-)
 create mode 100644 templates/crm-homecare/frontend/package-lock.json
 delete mode 100644 templates/crm-homecare/frontend/postcss.config.js
 create mode 100644 templates/crm-homecare/frontend/src/components/AdminDashboard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/ApplicationForm.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/CaregiverDashboard.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/ImpersonationModal.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/Login.jsx
 create mode 100644 templates/crm-homecare/frontend/src/components/PaymentPage.jsx
 create mode 100644 templates/crm-homecare/frontend/src/index.jsx
 create mode 100644 templates/crm-homecare/frontend/src/styles.css

diff --git a/templates/crm-homecare/frontend/package-lock.json b/templates/crm-homecare/frontend/package-lock.json
new file mode 100644
index 0000000..e7b5ca9
--- /dev/null
+++ b/templates/crm-homecare/frontend/package-lock.json
@@ -0,0 +1,3480 @@
+{
+  "name": "chippewa-home-care-frontend",
+  "version": "1.0.0",
+  "lockfileVersion": 3,
+  "requires": true,
+  "packages": {
+    "": {
+      "name": "chippewa-home-care-frontend",
+      "version": "1.0.0",
+      "dependencies": {
+        "@capacitor-community/background-geolocation": "^1.2.26",
+        "@capacitor/android": "^8.1.0",
+        "@capacitor/cli": "^8.1.0",
+        "@capacitor/core": "^8.1.0",
+        "@capacitor/geolocation": "^8.1.0",
+        "@capacitor/haptics": "^8.0.0",
+        "@capacitor/ios": "^8.1.0",
+        "@capacitor/keyboard": "^8.0.0",
+        "@capacitor/local-notifications": "^8.0.1",
+        "@capacitor/network": "^8.0.1",
+        "@capacitor/push-notifications": "^8.0.1",
+        "@capacitor/splash-screen": "^8.0.1",
+        "@capacitor/status-bar": "^8.0.1",
+        "autoprefixer": "^10.4.24",
+        "axios": "^1.6.2",
+        "postcss": "^8.5.6",
+        "prop-types": "^15.8.1",
+        "react": "^18.2.0",
+        "react-dom": "^18.2.0",
+        "react-router-dom": "^6.28.0",
+        "tailwindcss": "^4.2.1"
+      },
+      "devDependencies": {
+        "@vitejs/plugin-react": "^4.2.1",
+        "terser": "^5.44.1",
+        "typescript": "^5.9.3",
+        "vite": "^7.3.1"
+      },
+      "engines": {
+        "node": ">=18.0.0"
+      }
+    },
+    "node_modules/@babel/code-frame": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.29.0.tgz",
+      "integrity": "sha512-9NhCeYjq9+3uxgdtp20LSiJXJvN0FeCtNGpJxuMFZ1Kv3cWUNb6DOhJwUvcVCzKGR66cw4njwM6hrJLqgOwbcw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-validator-identifier": "^7.28.5",
+        "js-tokens": "^4.0.0",
+        "picocolors": "^1.1.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/compat-data": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.29.0.tgz",
+      "integrity": "sha512-T1NCJqT/j9+cn8fvkt7jtwbLBfLC/1y1c7NtCeXFRgzGTsafi68MRv8yzkYSapBnFA6L3U2VSc02ciDzoAJhJg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/core": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.29.0.tgz",
+      "integrity": "sha512-CGOfOJqWjg2qW/Mb6zNsDm+u5vFQ8DxXfbM09z69p5Z6+mE1ikP2jUXw+j42Pf1XTYED2Rni5f95npYeuwMDQA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/code-frame": "^7.29.0",
+        "@babel/generator": "^7.29.0",
+        "@babel/helper-compilation-targets": "^7.28.6",
+        "@babel/helper-module-transforms": "^7.28.6",
+        "@babel/helpers": "^7.28.6",
+        "@babel/parser": "^7.29.0",
+        "@babel/template": "^7.28.6",
+        "@babel/traverse": "^7.29.0",
+        "@babel/types": "^7.29.0",
+        "@jridgewell/remapping": "^2.3.5",
+        "convert-source-map": "^2.0.0",
+        "debug": "^4.1.0",
+        "gensync": "^1.0.0-beta.2",
+        "json5": "^2.2.3",
+        "semver": "^6.3.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/babel"
+      }
+    },
+    "node_modules/@babel/generator": {
+      "version": "7.29.1",
+      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.29.1.tgz",
+      "integrity": "sha512-qsaF+9Qcm2Qv8SRIMMscAvG4O3lJ0F1GuMo5HR/Bp02LopNgnZBC/EkbevHFeGs4ls/oPz9v+Bsmzbkbe+0dUw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.29.0",
+        "@babel/types": "^7.29.0",
+        "@jridgewell/gen-mapping": "^0.3.12",
+        "@jridgewell/trace-mapping": "^0.3.28",
+        "jsesc": "^3.0.2"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-compilation-targets": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
+      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/compat-data": "^7.28.6",
+        "@babel/helper-validator-option": "^7.27.1",
+        "browserslist": "^4.24.0",
+        "lru-cache": "^5.1.1",
+        "semver": "^6.3.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-globals": {
+      "version": "7.28.0",
+      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
+      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-module-imports": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
+      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/traverse": "^7.28.6",
+        "@babel/types": "^7.28.6"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-module-transforms": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
+      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-module-imports": "^7.28.6",
+        "@babel/helper-validator-identifier": "^7.28.5",
+        "@babel/traverse": "^7.28.6"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0"
+      }
+    },
+    "node_modules/@babel/helper-plugin-utils": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
+      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-string-parser": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
+      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-validator-identifier": {
+      "version": "7.28.5",
+      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
+      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-validator-option": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
+      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helpers": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
+      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/template": "^7.28.6",
+        "@babel/types": "^7.28.6"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/parser": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.29.0.tgz",
+      "integrity": "sha512-IyDgFV5GeDUVX4YdF/3CPULtVGSXXMLh1xVIgdCgxApktqnQV0r7/8Nqthg+8YLGaAtdyIlo2qIdZrbCv4+7ww==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.29.0"
+      },
+      "bin": {
+        "parser": "bin/babel-parser.js"
+      },
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/@babel/plugin-transform-react-jsx-self": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
+      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.27.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
+    },
+    "node_modules/@babel/plugin-transform-react-jsx-source": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
+      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.27.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
+    },
+    "node_modules/@babel/template": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
+      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/code-frame": "^7.28.6",
+        "@babel/parser": "^7.28.6",
+        "@babel/types": "^7.28.6"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/traverse": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.29.0.tgz",
+      "integrity": "sha512-4HPiQr0X7+waHfyXPZpWPfWL/J7dcN1mx9gL6WdQVMbPnF3+ZhSMs8tCxN7oHddJE9fhNE7+lxdnlyemKfJRuA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/code-frame": "^7.29.0",
+        "@babel/generator": "^7.29.0",
+        "@babel/helper-globals": "^7.28.0",
+        "@babel/parser": "^7.29.0",
+        "@babel/template": "^7.28.6",
+        "@babel/types": "^7.29.0",
+        "debug": "^4.3.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/types": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.29.0.tgz",
+      "integrity": "sha512-LwdZHpScM4Qz8Xw2iKSzS+cfglZzJGvofQICy7W7v4caru4EaAmyUuO6BGrbyQ2mYV11W0U8j5mBhd14dd3B0A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-string-parser": "^7.27.1",
+        "@babel/helper-validator-identifier": "^7.28.5"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@capacitor-community/background-geolocation": {
+      "version": "1.2.26",
+      "resolved": "https://registry.npmjs.org/@capacitor-community/background-geolocation/-/background-geolocation-1.2.26.tgz",
+      "integrity": "sha512-kuva8VQ6zM+uIKgHUJTP87IYbmGKhX7DZw62JYfGZ888h4Xr5zeN+UTR6KBRHQVrGBpzSfbv+6/HQVuHYa7W5A==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=3.0.0"
+      }
+    },
+    "node_modules/@capacitor/android": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/@capacitor/android/-/android-8.1.0.tgz",
+      "integrity": "sha512-z0acTPxj5DCy/U2FU7w+GA93oC+wdyKnsOcRg5rutDmSYa8Do1tzYqApKgf+hnuTNPbtrCTHp0Zy1cLiK/4MEw==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": "^8.1.0"
+      }
+    },
+    "node_modules/@capacitor/cli": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/@capacitor/cli/-/cli-8.1.0.tgz",
+      "integrity": "sha512-JAzA/ckPgTCjZz6YumBLV2dNCFEVXAuR1oOKLD7AJ4LAI5pF5RtRZrf5FoaxvJVb0S4CouZT5cD+7NwsNJX/nw==",
+      "license": "MIT",
+      "dependencies": {
+        "@ionic/cli-framework-output": "^2.2.8",
+        "@ionic/utils-subprocess": "^3.0.1",
+        "@ionic/utils-terminal": "^2.3.5",
+        "commander": "^12.1.0",
+        "debug": "^4.4.0",
+        "env-paths": "^2.2.0",
+        "fs-extra": "^11.2.0",
+        "kleur": "^4.1.5",
+        "native-run": "^2.0.3",
+        "open": "^8.4.0",
+        "plist": "^3.1.0",
+        "prompts": "^2.4.2",
+        "rimraf": "^6.0.1",
+        "semver": "^7.6.3",
+        "tar": "^7.5.3",
+        "tslib": "^2.8.1",
+        "xml2js": "^0.6.2"
+      },
+      "bin": {
+        "cap": "bin/capacitor",
+        "capacitor": "bin/capacitor"
+      },
+      "engines": {
+        "node": ">=22.0.0"
+      }
+    },
+    "node_modules/@capacitor/cli/node_modules/commander": {
+      "version": "12.1.0",
+      "resolved": "https://registry.npmjs.org/commander/-/commander-12.1.0.tgz",
+      "integrity": "sha512-Vw8qHK3bZM9y/P10u3Vib8o/DdkvA2OtPtZvD871QKjy74Wj1WSKFILMPRPSdUSx5RFK1arlJzEtA4PkFgnbuA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@capacitor/cli/node_modules/semver": {
+      "version": "7.7.4",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.4.tgz",
+      "integrity": "sha512-vFKC2IEtQnVhpT78h1Yp8wzwrf8CM+MzKMHGJZfBtzhZNycRFnXsHk6E5TxIkkMsgNS7mdX3AGB7x2QM2di4lA==",
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/@capacitor/core": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/@capacitor/core/-/core-8.1.0.tgz",
+      "integrity": "sha512-UfMBMWc1v7J+14AhH03QmeNwV3HZx3qnOWhpwnHfzALEwAwlV/itQOQqcasMQYhOHWL0tiymc5ByaLTn7KKQxw==",
+      "license": "MIT",
+      "dependencies": {
+        "tslib": "^2.1.0"
+      }
+    },
+    "node_modules/@capacitor/geolocation": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/@capacitor/geolocation/-/geolocation-8.1.0.tgz",
+      "integrity": "sha512-dHeGuVlT3ELxxn8WaoRsGjfx8tmziaC0ZuaKhUBCoKFjOue4fAnmLczCMQsYW7OykgiyBh0pirNPwWZ0/LXB7Q==",
+      "license": "MIT",
+      "dependencies": {
+        "@capacitor/synapse": "^1.0.4"
+      },
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/haptics": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/haptics/-/haptics-8.0.1.tgz",
+      "integrity": "sha512-8v8rowLBMeb3CryqoQvXndwyUsoi4pPXf0qFw7IGA4D32Uk7+K6juN2SjRowqunoovkvvbFmU9TD7JIAz2zmFw==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/ios": {
+      "version": "8.1.0",
+      "resolved": "https://registry.npmjs.org/@capacitor/ios/-/ios-8.1.0.tgz",
+      "integrity": "sha512-wPaQ8ayL0UY+SxydZbrmfzPs8TryZVEB6hrL/XBnXxQtb6rpEmIy/3GIltPwM+/T4m/IuaSDZOToWK65ruC00g==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": "^8.1.0"
+      }
+    },
+    "node_modules/@capacitor/keyboard": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/keyboard/-/keyboard-8.0.1.tgz",
+      "integrity": "sha512-HDf4qrvvhLRMsgBoqeqIld6hP8JMK/WPbCYMvz8ajhY6TaibYt6B+NQyky4oIPCOfHTz5OcVsuHkbb8fQvGDAg==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/local-notifications": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/local-notifications/-/local-notifications-8.0.1.tgz",
+      "integrity": "sha512-BWYg3wTCFQ9lsbE6tyHmJaE2IbxUuKYq4SeMIHQ9ZqVclrlTO6326sPT0sxM61YfR6K3G3fJGvyJqn89LzDk8A==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/network": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/network/-/network-8.0.1.tgz",
+      "integrity": "sha512-9xK/FHFmzKGanB6BdoSZOzXk8vF0OFVQSQ4PAsIrzAzLuXHryO317qy8dcHVpgxYeuZq2noI0My9z1DvVDi/9w==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/push-notifications": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/push-notifications/-/push-notifications-8.0.1.tgz",
+      "integrity": "sha512-CDY6syMxdG81Epn+V4fCYRR4L9tVS72F1kVrTY2ka6umWy4BmwXOXPsxGxlE5PmHLOhmBwKpy3uOiIJtSpMhOw==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/splash-screen": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/splash-screen/-/splash-screen-8.0.1.tgz",
+      "integrity": "sha512-c/ew/Z3eA7z8l06WoRAtzVF16VwYYrExmHmfGq1Cg675pVzaC/yuucB8/1xG1vhEfnW4fZ1KhSf/kzR1RiVYgg==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/status-bar": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/@capacitor/status-bar/-/status-bar-8.0.1.tgz",
+      "integrity": "sha512-OR59dlbwvmrV5dKsC9lvwv48QaGbqcbSTBpk+9/WXWxXYSdXXdzJZU9p8oyNPAkuJhCdnSa3XmU43fZRPBJJ5w==",
+      "license": "MIT",
+      "peerDependencies": {
+        "@capacitor/core": ">=8.0.0"
+      }
+    },
+    "node_modules/@capacitor/synapse": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/@capacitor/synapse/-/synapse-1.0.4.tgz",
+      "integrity": "sha512-/C1FUo8/OkKuAT4nCIu/34ny9siNHr9qtFezu4kxm6GY1wNFxrCFWjfYx5C1tUhVGz3fxBABegupkpjXvjCHrw==",
+      "license": "ISC"
+    },
+    "node_modules/@esbuild/aix-ppc64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.27.3.tgz",
+      "integrity": "sha512-9fJMTNFTWZMh5qwrBItuziu834eOCUcEqymSH7pY+zoMVEZg3gcPuBNxH1EvfVYe9h0x/Ptw8KBzv7qxb7l8dg==",
+      "cpu": [
+        "ppc64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "aix"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/android-arm": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.27.3.tgz",
+      "integrity": "sha512-i5D1hPY7GIQmXlXhs2w8AWHhenb00+GxjxRncS2ZM7YNVGNfaMxgzSGuO8o8SJzRc/oZwU2bcScvVERk03QhzA==",
+      "cpu": [
+        "arm"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "android"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/android-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.27.3.tgz",
+      "integrity": "sha512-YdghPYUmj/FX2SYKJ0OZxf+iaKgMsKHVPF1MAq/P8WirnSpCStzKJFjOjzsW0QQ7oIAiccHdcqjbHmJxRb/dmg==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "android"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/android-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.27.3.tgz",
+      "integrity": "sha512-IN/0BNTkHtk8lkOM8JWAYFg4ORxBkZQf9zXiEOfERX/CzxW3Vg1ewAhU7QSWQpVIzTW+b8Xy+lGzdYXV6UZObQ==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "android"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/darwin-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.27.3.tgz",
+      "integrity": "sha512-Re491k7ByTVRy0t3EKWajdLIr0gz2kKKfzafkth4Q8A5n1xTHrkqZgLLjFEHVD+AXdUGgQMq+Godfq45mGpCKg==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/darwin-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.27.3.tgz",
+      "integrity": "sha512-vHk/hA7/1AckjGzRqi6wbo+jaShzRowYip6rt6q7VYEDX4LEy1pZfDpdxCBnGtl+A5zq8iXDcyuxwtv3hNtHFg==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/freebsd-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.27.3.tgz",
+      "integrity": "sha512-ipTYM2fjt3kQAYOvo6vcxJx3nBYAzPjgTCk7QEgZG8AUO3ydUhvelmhrbOheMnGOlaSFUoHXB6un+A7q4ygY9w==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "freebsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/freebsd-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.27.3.tgz",
+      "integrity": "sha512-dDk0X87T7mI6U3K9VjWtHOXqwAMJBNN2r7bejDsc+j03SEjtD9HrOl8gVFByeM0aJksoUuUVU9TBaZa2rgj0oA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "freebsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-arm": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.27.3.tgz",
+      "integrity": "sha512-s6nPv2QkSupJwLYyfS+gwdirm0ukyTFNl3KTgZEAiJDd+iHZcbTPPcWCcRYH+WlNbwChgH2QkE9NSlNrMT8Gfw==",
+      "cpu": [
+        "arm"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.27.3.tgz",
+      "integrity": "sha512-sZOuFz/xWnZ4KH3YfFrKCf1WyPZHakVzTiqji3WDc0BCl2kBwiJLCXpzLzUBLgmp4veFZdvN5ChW4Eq/8Fc2Fg==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-ia32": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.27.3.tgz",
+      "integrity": "sha512-yGlQYjdxtLdh0a3jHjuwOrxQjOZYD/C9PfdbgJJF3TIZWnm/tMd/RcNiLngiu4iwcBAOezdnSLAwQDPqTmtTYg==",
+      "cpu": [
+        "ia32"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-loong64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.27.3.tgz",
+      "integrity": "sha512-WO60Sn8ly3gtzhyjATDgieJNet/KqsDlX5nRC5Y3oTFcS1l0KWba+SEa9Ja1GfDqSF1z6hif/SkpQJbL63cgOA==",
+      "cpu": [
+        "loong64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-mips64el": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.27.3.tgz",
+      "integrity": "sha512-APsymYA6sGcZ4pD6k+UxbDjOFSvPWyZhjaiPyl/f79xKxwTnrn5QUnXR5prvetuaSMsb4jgeHewIDCIWljrSxw==",
+      "cpu": [
+        "mips64el"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-ppc64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.27.3.tgz",
+      "integrity": "sha512-eizBnTeBefojtDb9nSh4vvVQ3V9Qf9Df01PfawPcRzJH4gFSgrObw+LveUyDoKU3kxi5+9RJTCWlj4FjYXVPEA==",
+      "cpu": [
+        "ppc64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-riscv64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.27.3.tgz",
+      "integrity": "sha512-3Emwh0r5wmfm3ssTWRQSyVhbOHvqegUDRd0WhmXKX2mkHJe1SFCMJhagUleMq+Uci34wLSipf8Lagt4LlpRFWQ==",
+      "cpu": [
+        "riscv64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-s390x": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.27.3.tgz",
+      "integrity": "sha512-pBHUx9LzXWBc7MFIEEL0yD/ZVtNgLytvx60gES28GcWMqil8ElCYR4kvbV2BDqsHOvVDRrOxGySBM9Fcv744hw==",
+      "cpu": [
+        "s390x"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/linux-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.27.3.tgz",
+      "integrity": "sha512-Czi8yzXUWIQYAtL/2y6vogER8pvcsOsk5cpwL4Gk5nJqH5UZiVByIY8Eorm5R13gq+DQKYg0+JyQoytLQas4dA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/netbsd-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-arm64/-/netbsd-arm64-0.27.3.tgz",
+      "integrity": "sha512-sDpk0RgmTCR/5HguIZa9n9u+HVKf40fbEUt+iTzSnCaGvY9kFP0YKBWZtJaraonFnqef5SlJ8/TiPAxzyS+UoA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "netbsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/netbsd-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.27.3.tgz",
+      "integrity": "sha512-P14lFKJl/DdaE00LItAukUdZO5iqNH7+PjoBm+fLQjtxfcfFE20Xf5CrLsmZdq5LFFZzb5JMZ9grUwvtVYzjiA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "netbsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/openbsd-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.27.3.tgz",
+      "integrity": "sha512-AIcMP77AvirGbRl/UZFTq5hjXK+2wC7qFRGoHSDrZ5v5b8DK/GYpXW3CPRL53NkvDqb9D+alBiC/dV0Fb7eJcw==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "openbsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/openbsd-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.27.3.tgz",
+      "integrity": "sha512-DnW2sRrBzA+YnE70LKqnM3P+z8vehfJWHXECbwBmH/CU51z6FiqTQTHFenPlHmo3a8UgpLyH3PT+87OViOh1AQ==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "openbsd"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/openharmony-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/openharmony-arm64/-/openharmony-arm64-0.27.3.tgz",
+      "integrity": "sha512-NinAEgr/etERPTsZJ7aEZQvvg/A6IsZG/LgZy+81wON2huV7SrK3e63dU0XhyZP4RKGyTm7aOgmQk0bGp0fy2g==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "openharmony"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/sunos-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.27.3.tgz",
+      "integrity": "sha512-PanZ+nEz+eWoBJ8/f8HKxTTD172SKwdXebZ0ndd953gt1HRBbhMsaNqjTyYLGLPdoWHy4zLU7bDVJztF5f3BHA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "sunos"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/win32-arm64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.27.3.tgz",
+      "integrity": "sha512-B2t59lWWYrbRDw/tjiWOuzSsFh1Y/E95ofKz7rIVYSQkUYBjfSgf6oeYPNWHToFRr2zx52JKApIcAS/D5TUBnA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/win32-ia32": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.27.3.tgz",
+      "integrity": "sha512-QLKSFeXNS8+tHW7tZpMtjlNb7HKau0QDpwm49u0vUp9y1WOF+PEzkU84y9GqYaAVW8aH8f3GcBck26jh54cX4Q==",
+      "cpu": [
+        "ia32"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@esbuild/win32-x64": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.27.3.tgz",
+      "integrity": "sha512-4uJGhsxuptu3OcpVAzli+/gWusVGwZZHTlS63hh++ehExkVT8SgiEf7/uC/PclrPPkLhZqGgCTjd0VWLo6xMqA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ],
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/@ionic/cli-framework-output": {
+      "version": "2.2.8",
+      "resolved": "https://registry.npmjs.org/@ionic/cli-framework-output/-/cli-framework-output-2.2.8.tgz",
+      "integrity": "sha512-TshtaFQsovB4NWRBydbNFawql6yul7d5bMiW1WYYf17hd99V6xdDdk3vtF51bw6sLkxON3bDQpWsnUc9/hVo3g==",
+      "license": "MIT",
+      "dependencies": {
+        "@ionic/utils-terminal": "2.3.5",
+        "debug": "^4.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-array": {
+      "version": "2.1.6",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-array/-/utils-array-2.1.6.tgz",
+      "integrity": "sha512-0JZ1Zkp3wURnv8oq6Qt7fMPo5MpjbLoUoa9Bu2Q4PJuSDWM8H8gwF3dQO7VTeUj3/0o1IB1wGkFWZZYgUXZMUg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "^4.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-fs": {
+      "version": "3.1.7",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-fs/-/utils-fs-3.1.7.tgz",
+      "integrity": "sha512-2EknRvMVfhnyhL1VhFkSLa5gOcycK91VnjfrTB0kbqkTFCOXyXgVLI5whzq7SLrgD9t1aqos3lMMQyVzaQ5gVA==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/fs-extra": "^8.0.0",
+        "debug": "^4.0.0",
+        "fs-extra": "^9.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-fs/node_modules/fs-extra": {
+      "version": "9.1.0",
+      "resolved": "https://registry.npmjs.org/fs-extra/-/fs-extra-9.1.0.tgz",
+      "integrity": "sha512-hcg3ZmepS30/7BSFqRvoo3DOMQu7IjqxO5nCDt+zM9XWjb33Wg7ziNT+Qvqbuc3+gWpzO02JubVyk2G4Zvo1OQ==",
+      "license": "MIT",
+      "dependencies": {
+        "at-least-node": "^1.0.0",
+        "graceful-fs": "^4.2.0",
+        "jsonfile": "^6.0.1",
+        "universalify": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/@ionic/utils-object": {
+      "version": "2.1.6",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-object/-/utils-object-2.1.6.tgz",
+      "integrity": "sha512-vCl7sl6JjBHFw99CuAqHljYJpcE88YaH2ZW4ELiC/Zwxl5tiwn4kbdP/gxi2OT3MQb1vOtgAmSNRtusvgxI8ww==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "^4.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-process": {
+      "version": "2.1.12",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-process/-/utils-process-2.1.12.tgz",
+      "integrity": "sha512-Jqkgyq7zBs/v/J3YvKtQQiIcxfJyplPgECMWgdO0E1fKrrH8EF0QGHNJ9mJCn6PYe2UtHNS8JJf5G21e09DfYg==",
+      "license": "MIT",
+      "dependencies": {
+        "@ionic/utils-object": "2.1.6",
+        "@ionic/utils-terminal": "2.3.5",
+        "debug": "^4.0.0",
+        "signal-exit": "^3.0.3",
+        "tree-kill": "^1.2.2",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-stream": {
+      "version": "3.1.7",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-stream/-/utils-stream-3.1.7.tgz",
+      "integrity": "sha512-eSELBE7NWNFIHTbTC2jiMvh1ABKGIpGdUIvARsNPMNQhxJB3wpwdiVnoBoTYp+5a6UUIww4Kpg7v6S7iTctH1w==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "^4.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-subprocess": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-subprocess/-/utils-subprocess-3.0.1.tgz",
+      "integrity": "sha512-cT4te3AQQPeIM9WCwIg8ohroJ8TjsYaMb2G4ZEgv9YzeDqHZ4JpeIKqG2SoaA3GmVQ3sOfhPM6Ox9sxphV/d1A==",
+      "license": "MIT",
+      "dependencies": {
+        "@ionic/utils-array": "2.1.6",
+        "@ionic/utils-fs": "3.1.7",
+        "@ionic/utils-process": "2.1.12",
+        "@ionic/utils-stream": "3.1.7",
+        "@ionic/utils-terminal": "2.3.5",
+        "cross-spawn": "^7.0.3",
+        "debug": "^4.0.0",
+        "tslib": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@ionic/utils-terminal": {
+      "version": "2.3.5",
+      "resolved": "https://registry.npmjs.org/@ionic/utils-terminal/-/utils-terminal-2.3.5.tgz",
+      "integrity": "sha512-3cKScz9Jx2/Pr9ijj1OzGlBDfcmx7OMVBt4+P1uRR0SSW4cm1/y3Mo4OY3lfkuaYifMNBW8Wz6lQHbs1bihr7A==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/slice-ansi": "^4.0.0",
+        "debug": "^4.0.0",
+        "signal-exit": "^3.0.3",
+        "slice-ansi": "^4.0.0",
+        "string-width": "^4.1.0",
+        "strip-ansi": "^6.0.0",
+        "tslib": "^2.0.1",
+        "untildify": "^4.0.0",
+        "wrap-ansi": "^7.0.0"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/@isaacs/fs-minipass": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/@isaacs/fs-minipass/-/fs-minipass-4.0.1.tgz",
+      "integrity": "sha512-wgm9Ehl2jpeqP3zw/7mo3kRHFp5MEDhqAdwy1fTGkHAwnkGOVsgpvQhL8B5n1qlb01jV3n/bI0ZfZp5lWA1k4w==",
+      "license": "ISC",
+      "dependencies": {
+        "minipass": "^7.0.4"
+      },
+      "engines": {
+        "node": ">=18.0.0"
+      }
+    },
+    "node_modules/@jridgewell/gen-mapping": {
+      "version": "0.3.13",
+      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
+      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/sourcemap-codec": "^1.5.0",
+        "@jridgewell/trace-mapping": "^0.3.24"
+      }
+    },
+    "node_modules/@jridgewell/remapping": {
+      "version": "2.3.5",
+      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
+      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/gen-mapping": "^0.3.5",
+        "@jridgewell/trace-mapping": "^0.3.24"
+      }
+    },
+    "node_modules/@jridgewell/resolve-uri": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
+      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/@jridgewell/source-map": {
+      "version": "0.3.11",
+      "resolved": "https://registry.npmjs.org/@jridgewell/source-map/-/source-map-0.3.11.tgz",
+      "integrity": "sha512-ZMp1V8ZFcPG5dIWnQLr3NSI1MiCU7UETdS/A0G8V/XWHvJv3ZsFqutJn1Y5RPmAPX6F3BiE397OqveU/9NCuIA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/gen-mapping": "^0.3.5",
+        "@jridgewell/trace-mapping": "^0.3.25"
+      }
+    },
+    "node_modules/@jridgewell/sourcemap-codec": {
+      "version": "1.5.5",
+      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
+      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@jridgewell/trace-mapping": {
+      "version": "0.3.31",
+      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
+      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/resolve-uri": "^3.1.0",
+        "@jridgewell/sourcemap-codec": "^1.4.14"
+      }
+    },
+    "node_modules/@remix-run/router": {
+      "version": "1.23.2",
+      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.23.2.tgz",
+      "integrity": "sha512-Ic6m2U/rMjTkhERIa/0ZtXJP17QUi2CbWE7cqx4J58M8aA3QTfW+2UlQ4psvTX9IO1RfNVhK3pcpdjej7L+t2w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=14.0.0"
+      }
+    },
+    "node_modules/@rolldown/pluginutils": {
+      "version": "1.0.0-beta.27",
+      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
+      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@rollup/rollup-android-arm-eabi": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.59.0.tgz",
+      "integrity": "sha512-upnNBkA6ZH2VKGcBj9Fyl9IGNPULcjXRlg0LLeaioQWueH30p6IXtJEbKAgvyv+mJaMxSm1l6xwDXYjpEMiLMg==",
+      "cpu": [
+        "arm"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "android"
+      ]
+    },
+    "node_modules/@rollup/rollup-android-arm64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.59.0.tgz",
+      "integrity": "sha512-hZ+Zxj3SySm4A/DylsDKZAeVg0mvi++0PYVceVyX7hemkw7OreKdCvW2oQ3T1FMZvCaQXqOTHb8qmBShoqk69Q==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "android"
+      ]
+    },
+    "node_modules/@rollup/rollup-darwin-arm64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.59.0.tgz",
+      "integrity": "sha512-W2Psnbh1J8ZJw0xKAd8zdNgF9HRLkdWwwdWqubSVk0pUuQkoHnv7rx4GiF9rT4t5DIZGAsConRE3AxCdJ4m8rg==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ]
+    },
+    "node_modules/@rollup/rollup-darwin-x64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.59.0.tgz",
+      "integrity": "sha512-ZW2KkwlS4lwTv7ZVsYDiARfFCnSGhzYPdiOU4IM2fDbL+QGlyAbjgSFuqNRbSthybLbIJ915UtZBtmuLrQAT/w==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ]
+    },
+    "node_modules/@rollup/rollup-freebsd-arm64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.59.0.tgz",
+      "integrity": "sha512-EsKaJ5ytAu9jI3lonzn3BgG8iRBjV4LxZexygcQbpiU0wU0ATxhNVEpXKfUa0pS05gTcSDMKpn3Sx+QB9RlTTA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "freebsd"
+      ]
+    },
+    "node_modules/@rollup/rollup-freebsd-x64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.59.0.tgz",
+      "integrity": "sha512-d3DuZi2KzTMjImrxoHIAODUZYoUUMsuUiY4SRRcJy6NJoZ6iIqWnJu9IScV9jXysyGMVuW+KNzZvBLOcpdl3Vg==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "freebsd"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.59.0.tgz",
+      "integrity": "sha512-t4ONHboXi/3E0rT6OZl1pKbl2Vgxf9vJfWgmUoCEVQVxhW6Cw/c8I6hbbu7DAvgp82RKiH7TpLwxnJeKv2pbsw==",
+      "cpu": [
+        "arm"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.59.0.tgz",
+      "integrity": "sha512-CikFT7aYPA2ufMD086cVORBYGHffBo4K8MQ4uPS/ZnY54GKj36i196u8U+aDVT2LX4eSMbyHtyOh7D7Zvk2VvA==",
+      "cpu": [
+        "arm"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-arm64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.59.0.tgz",
+      "integrity": "sha512-jYgUGk5aLd1nUb1CtQ8E+t5JhLc9x5WdBKew9ZgAXg7DBk0ZHErLHdXM24rfX+bKrFe+Xp5YuJo54I5HFjGDAA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-arm64-musl": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.59.0.tgz",
+      "integrity": "sha512-peZRVEdnFWZ5Bh2KeumKG9ty7aCXzzEsHShOZEFiCQlDEepP1dpUl/SrUNXNg13UmZl+gzVDPsiCwnV1uI0RUA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-loong64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.59.0.tgz",
+      "integrity": "sha512-gbUSW/97f7+r4gHy3Jlup8zDG190AuodsWnNiXErp9mT90iCy9NKKU0Xwx5k8VlRAIV2uU9CsMnEFg/xXaOfXg==",
+      "cpu": [
+        "loong64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-loong64-musl": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.59.0.tgz",
+      "integrity": "sha512-yTRONe79E+o0FWFijasoTjtzG9EBedFXJMl888NBEDCDV9I2wGbFFfJQQe63OijbFCUZqxpHz1GzpbtSFikJ4Q==",
+      "cpu": [
+        "loong64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.59.0.tgz",
+      "integrity": "sha512-sw1o3tfyk12k3OEpRddF68a1unZ5VCN7zoTNtSn2KndUE+ea3m3ROOKRCZxEpmT9nsGnogpFP9x6mnLTCaoLkA==",
+      "cpu": [
+        "ppc64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-ppc64-musl": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.59.0.tgz",
+      "integrity": "sha512-+2kLtQ4xT3AiIxkzFVFXfsmlZiG5FXYW7ZyIIvGA7Bdeuh9Z0aN4hVyXS/G1E9bTP/vqszNIN/pUKCk/BTHsKA==",
+      "cpu": [
+        "ppc64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.59.0.tgz",
+      "integrity": "sha512-NDYMpsXYJJaj+I7UdwIuHHNxXZ/b/N2hR15NyH3m2qAtb/hHPA4g4SuuvrdxetTdndfj9b1WOmy73kcPRoERUg==",
+      "cpu": [
+        "riscv64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-riscv64-musl": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.59.0.tgz",
+      "integrity": "sha512-nLckB8WOqHIf1bhymk+oHxvM9D3tyPndZH8i8+35p/1YiVoVswPid2yLzgX7ZJP0KQvnkhM4H6QZ5m0LzbyIAg==",
+      "cpu": [
+        "riscv64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-s390x-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.59.0.tgz",
+      "integrity": "sha512-oF87Ie3uAIvORFBpwnCvUzdeYUqi2wY6jRFWJAy1qus/udHFYIkplYRW+wo+GRUP4sKzYdmE1Y3+rY5Gc4ZO+w==",
+      "cpu": [
+        "s390x"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-x64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.59.0.tgz",
+      "integrity": "sha512-3AHmtQq/ppNuUspKAlvA8HtLybkDflkMuLK4DPo77DfthRb71V84/c4MlWJXixZz4uruIH4uaa07IqoAkG64fg==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-linux-x64-musl": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.59.0.tgz",
+      "integrity": "sha512-2UdiwS/9cTAx7qIUZB/fWtToJwvt0Vbo0zmnYt7ED35KPg13Q0ym1g442THLC7VyI6JfYTP4PiSOWyoMdV2/xg==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "linux"
+      ]
+    },
+    "node_modules/@rollup/rollup-openbsd-x64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.59.0.tgz",
+      "integrity": "sha512-M3bLRAVk6GOwFlPTIxVBSYKUaqfLrn8l0psKinkCFxl4lQvOSz8ZrKDz2gxcBwHFpci0B6rttydI4IpS4IS/jQ==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "openbsd"
+      ]
+    },
+    "node_modules/@rollup/rollup-openharmony-arm64": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.59.0.tgz",
+      "integrity": "sha512-tt9KBJqaqp5i5HUZzoafHZX8b5Q2Fe7UjYERADll83O4fGqJ49O1FsL6LpdzVFQcpwvnyd0i+K/VSwu/o/nWlA==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "openharmony"
+      ]
+    },
+    "node_modules/@rollup/rollup-win32-arm64-msvc": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.59.0.tgz",
+      "integrity": "sha512-V5B6mG7OrGTwnxaNUzZTDTjDS7F75PO1ae6MJYdiMu60sq0CqN5CVeVsbhPxalupvTX8gXVSU9gq+Rx1/hvu6A==",
+      "cpu": [
+        "arm64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ]
+    },
+    "node_modules/@rollup/rollup-win32-ia32-msvc": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.59.0.tgz",
+      "integrity": "sha512-UKFMHPuM9R0iBegwzKF4y0C4J9u8C6MEJgFuXTBerMk7EJ92GFVFYBfOZaSGLu6COf7FxpQNqhNS4c4icUPqxA==",
+      "cpu": [
+        "ia32"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ]
+    },
+    "node_modules/@rollup/rollup-win32-x64-gnu": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.59.0.tgz",
+      "integrity": "sha512-laBkYlSS1n2L8fSo1thDNGrCTQMmxjYY5G0WFWjFFYZkKPjsMBsgJfGf4TLxXrF6RyhI60L8TMOjBMvXiTcxeA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ]
+    },
+    "node_modules/@rollup/rollup-win32-x64-msvc": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.59.0.tgz",
+      "integrity": "sha512-2HRCml6OztYXyJXAvdDXPKcawukWY2GpR5/nxKp4iBgiO3wcoEGkAaqctIbZcNB6KlUQBIqt8VYkNSj2397EfA==",
+      "cpu": [
+        "x64"
+      ],
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "win32"
+      ]
+    },
+    "node_modules/@types/babel__core": {
+      "version": "7.20.5",
+      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
+      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.20.7",
+        "@babel/types": "^7.20.7",
+        "@types/babel__generator": "*",
+        "@types/babel__template": "*",
+        "@types/babel__traverse": "*"
+      }
+    },
+    "node_modules/@types/babel__generator": {
+      "version": "7.27.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
+      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.0.0"
+      }
+    },
+    "node_modules/@types/babel__template": {
+      "version": "7.4.4",
+      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
+      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.1.0",
+        "@babel/types": "^7.0.0"
+      }
+    },
+    "node_modules/@types/babel__traverse": {
+      "version": "7.28.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
+      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.28.2"
+      }
+    },
+    "node_modules/@types/estree": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
+      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@types/fs-extra": {
+      "version": "8.1.5",
+      "resolved": "https://registry.npmjs.org/@types/fs-extra/-/fs-extra-8.1.5.tgz",
+      "integrity": "sha512-0dzKcwO+S8s2kuF5Z9oUWatQJj5Uq/iqphEtE3GQJVRRYm/tD1LglU2UnXi2A8jLq5umkGouOXOR9y0n613ZwQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": "*"
+      }
+    },
+    "node_modules/@types/node": {
+      "version": "25.3.0",
+      "resolved": "https://registry.npmjs.org/@types/node/-/node-25.3.0.tgz",
+      "integrity": "sha512-4K3bqJpXpqfg2XKGK9bpDTc6xO/xoUP/RBWS7AtRMug6zZFaRekiLzjVtAoZMquxoAbzBvy5nxQ7veS5eYzf8A==",
+      "license": "MIT",
+      "dependencies": {
+        "undici-types": "~7.18.0"
+      }
+    },
+    "node_modules/@types/slice-ansi": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/@types/slice-ansi/-/slice-ansi-4.0.0.tgz",
+      "integrity": "sha512-+OpjSaq85gvlZAYINyzKpLeiFkSC4EsC6IIiT6v6TLSU5k5U83fHGj9Lel8oKEXM0HqgrMVCjXPDPVICtxF7EQ==",
+      "license": "MIT"
+    },
+    "node_modules/@vitejs/plugin-react": {
+      "version": "4.7.0",
+      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
+      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/core": "^7.28.0",
+        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
+        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
+        "@rolldown/pluginutils": "1.0.0-beta.27",
+        "@types/babel__core": "^7.20.5",
+        "react-refresh": "^0.17.0"
+      },
+      "engines": {
+        "node": "^14.18.0 || >=16.0.0"
+      },
+      "peerDependencies": {
+        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
+      }
+    },
+    "node_modules/@xmldom/xmldom": {
+      "version": "0.8.11",
+      "resolved": "https://registry.npmjs.org/@xmldom/xmldom/-/xmldom-0.8.11.tgz",
+      "integrity": "sha512-cQzWCtO6C8TQiYl1ruKNn2U6Ao4o4WBBcbL61yJl84x+j5sOWWFU9X7DpND8XZG3daDppSsigMdfAIl2upQBRw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/acorn": {
+      "version": "8.16.0",
+      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.16.0.tgz",
+      "integrity": "sha512-UVJyE9MttOsBQIDKw1skb9nAwQuR5wuGD3+82K6JgJlm/Y+KI92oNsMNGZCYdDsVtRHSak0pcV5Dno5+4jh9sw==",
+      "dev": true,
+      "license": "MIT",
+      "bin": {
+        "acorn": "bin/acorn"
+      },
+      "engines": {
+        "node": ">=0.4.0"
+      }
+    },
+    "node_modules/ansi-regex": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
+      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/ansi-styles": {
+      "version": "4.3.0",
+      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
+      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-convert": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
+      }
+    },
+    "node_modules/astral-regex": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/astral-regex/-/astral-regex-2.0.0.tgz",
+      "integrity": "sha512-Z7tMw1ytTXt5jqMcOP+OQteU1VuNK9Y02uuJtKQ1Sv69jXQKKg5cibLwGJow8yzZP+eAc18EmLGPal0bp36rvQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/asynckit": {
+      "version": "0.4.0",
+      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
+      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
+      "license": "MIT"
+    },
+    "node_modules/at-least-node": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/at-least-node/-/at-least-node-1.0.0.tgz",
+      "integrity": "sha512-+q/t7Ekv1EDY2l6Gda6LLiX14rU9TV20Wa3ofeQmwPFZbOMo9DXrLbOjFaaclkXKWidIaopwAObQDqwWtGUjqg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">= 4.0.0"
+      }
+    },
+    "node_modules/autoprefixer": {
+      "version": "10.4.24",
+      "resolved": "https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.24.tgz",
+      "integrity": "sha512-uHZg7N9ULTVbutaIsDRoUkoS8/h3bdsmVJYZ5l3wv8Cp/6UIIoRDm90hZ+BwxUj/hGBEzLxdHNSKuFpn8WOyZw==",
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/postcss/"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/autoprefixer"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "browserslist": "^4.28.1",
+        "caniuse-lite": "^1.0.30001766",
+        "fraction.js": "^5.3.4",
+        "picocolors": "^1.1.1",
+        "postcss-value-parser": "^4.2.0"
+      },
+      "bin": {
+        "autoprefixer": "bin/autoprefixer"
+      },
+      "engines": {
+        "node": "^10 || ^12 || >=14"
+      },
+      "peerDependencies": {
+        "postcss": "^8.1.0"
+      }
+    },
+    "node_modules/axios": {
+      "version": "1.13.5",
+      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.5.tgz",
+      "integrity": "sha512-cz4ur7Vb0xS4/KUN0tPWe44eqxrIu31me+fbang3ijiNscE129POzipJJA6zniq2C/Z6sJCjMimjS8Lc/GAs8Q==",
+      "license": "MIT",
+      "dependencies": {
+        "follow-redirects": "^1.15.11",
+        "form-data": "^4.0.5",
+        "proxy-from-env": "^1.1.0"
+      }
+    },
+    "node_modules/balanced-match": {
+      "version": "4.0.4",
+      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-4.0.4.tgz",
+      "integrity": "sha512-BLrgEcRTwX2o6gGxGOCNyMvGSp35YofuYzw9h1IMTRmKqttAZZVU67bdb9Pr2vUHA8+j3i2tJfjO6C6+4myGTA==",
+      "license": "MIT",
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/base64-js": {
+      "version": "1.5.1",
+      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
+      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/feross"
+        },
+        {
+          "type": "patreon",
+          "url": "https://www.patreon.com/feross"
+        },
+        {
+          "type": "consulting",
+          "url": "https://feross.org/support"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/baseline-browser-mapping": {
+      "version": "2.10.0",
+      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.10.0.tgz",
+      "integrity": "sha512-lIyg0szRfYbiy67j9KN8IyeD7q7hcmqnJ1ddWmNt19ItGpNN64mnllmxUNFIOdOm6by97jlL6wfpTTJrmnjWAA==",
+      "license": "Apache-2.0",
+      "bin": {
+        "baseline-browser-mapping": "dist/cli.cjs"
+      },
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/big-integer": {
+      "version": "1.6.52",
+      "resolved": "https://registry.npmjs.org/big-integer/-/big-integer-1.6.52.tgz",
+      "integrity": "sha512-QxD8cf2eVqJOOz63z6JIN9BzvVs/dlySa5HGSBH5xtR8dPteIRQnBxxKqkNTiT6jbDTF6jAfrd4oMcND9RGbQg==",
+      "license": "Unlicense",
+      "engines": {
+        "node": ">=0.6"
+      }
+    },
+    "node_modules/bplist-parser": {
+      "version": "0.3.2",
+      "resolved": "https://registry.npmjs.org/bplist-parser/-/bplist-parser-0.3.2.tgz",
+      "integrity": "sha512-apC2+fspHGI3mMKj+dGevkGo/tCqVB8jMb6i+OX+E29p0Iposz07fABkRIfVUPNd5A5VbuOz1bZbnmkKLYF+wQ==",
+      "license": "MIT",
+      "dependencies": {
+        "big-integer": "1.6.x"
+      },
+      "engines": {
+        "node": ">= 5.10.0"
+      }
+    },
+    "node_modules/brace-expansion": {
+      "version": "5.0.3",
+      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-5.0.3.tgz",
+      "integrity": "sha512-fy6KJm2RawA5RcHkLa1z/ScpBeA762UF9KmZQxwIbDtRJrgLzM10depAiEQ+CXYcoiqW1/m96OAAoke2nE9EeA==",
+      "license": "MIT",
+      "dependencies": {
+        "balanced-match": "^4.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/browserslist": {
+      "version": "4.28.1",
+      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
+      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/browserslist"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "baseline-browser-mapping": "^2.9.0",
+        "caniuse-lite": "^1.0.30001759",
+        "electron-to-chromium": "^1.5.263",
+        "node-releases": "^2.0.27",
+        "update-browserslist-db": "^1.2.0"
+      },
+      "bin": {
+        "browserslist": "cli.js"
+      },
+      "engines": {
+        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
+      }
+    },
+    "node_modules/buffer-crc32": {
+      "version": "0.2.13",
+      "resolved": "https://registry.npmjs.org/buffer-crc32/-/buffer-crc32-0.2.13.tgz",
+      "integrity": "sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==",
+      "license": "MIT",
+      "engines": {
+        "node": "*"
+      }
+    },
+    "node_modules/buffer-from": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
+      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/call-bind-apply-helpers": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
+      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/caniuse-lite": {
+      "version": "1.0.30001774",
+      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001774.tgz",
+      "integrity": "sha512-DDdwPGz99nmIEv216hKSgLD+D4ikHQHjBC/seF98N9CPqRX4M5mSxT9eTV6oyisnJcuzxtZy4n17yKKQYmYQOA==",
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "CC-BY-4.0"
+    },
+    "node_modules/chownr": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/chownr/-/chownr-3.0.0.tgz",
+      "integrity": "sha512-+IxzY9BZOQd/XuYPRmrvEVjF/nqj5kgT4kEq7VofrDoM1MxoRjEWkrCC3EtLi59TVawxTAn+orJwFQcrqEN1+g==",
+      "license": "BlueOak-1.0.0",
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/color-convert": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
+      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "~1.1.4"
+      },
+      "engines": {
+        "node": ">=7.0.0"
+      }
+    },
+    "node_modules/color-name": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
+      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
+      "license": "MIT"
+    },
+    "node_modules/combined-stream": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
+      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
+      "license": "MIT",
+      "dependencies": {
+        "delayed-stream": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/convert-source-map": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
+      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/cross-spawn": {
+      "version": "7.0.6",
+      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
+      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
+      "license": "MIT",
+      "dependencies": {
+        "path-key": "^3.1.0",
+        "shebang-command": "^2.0.0",
+        "which": "^2.0.1"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/define-lazy-prop": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz",
+      "integrity": "sha512-Ds09qNh8yw3khSjiJjiUInaGX9xlqZDY7JVryGxdxV7NPeuqQfplOpQ66yJFZut3jLa5zOwkXw1g9EI2uKh4Og==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/delayed-stream": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
+      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.4.0"
+      }
+    },
+    "node_modules/dunder-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
+      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "gopd": "^1.2.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/electron-to-chromium": {
+      "version": "1.5.302",
+      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.302.tgz",
+      "integrity": "sha512-sM6HAN2LyK82IyPBpznDRqlTQAtuSaO+ShzFiWTvoMJLHyZ+Y39r8VMfHzwbU8MVBzQ4Wdn85+wlZl2TLGIlwg==",
+      "license": "ISC"
+    },
+    "node_modules/elementtree": {
+      "version": "0.1.7",
+      "resolved": "https://registry.npmjs.org/elementtree/-/elementtree-0.1.7.tgz",
+      "integrity": "sha512-wkgGT6kugeQk/P6VZ/f4T+4HB41BVgNBq5CDIZVbQ02nvTVqAiVTbskxxu3eA/X96lMlfYOwnLQpN2v5E1zDEg==",
+      "license": "Apache-2.0",
+      "dependencies": {
+        "sax": "1.1.4"
+      },
+      "engines": {
+        "node": ">= 0.4.0"
+      }
+    },
+    "node_modules/emoji-regex": {
+      "version": "8.0.0",
+      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
+      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
+      "license": "MIT"
+    },
+    "node_modules/env-paths": {
+      "version": "2.2.1",
+      "resolved": "https://registry.npmjs.org/env-paths/-/env-paths-2.2.1.tgz",
+      "integrity": "sha512-+h1lkLKhZMTYjog1VEpJNG7NZJWcuc2DDk/qsqSTRRCOXiLjeQ1d1/udrUGhqMxUgAlwKNZ0cf2uqan5GLuS2A==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/es-define-property": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
+      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-errors": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
+      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-object-atoms": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
+      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-set-tostringtag": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
+      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.6",
+        "has-tostringtag": "^1.0.2",
+        "hasown": "^2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/esbuild": {
+      "version": "0.27.3",
+      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.27.3.tgz",
+      "integrity": "sha512-8VwMnyGCONIs6cWue2IdpHxHnAjzxnw2Zr7MkVxB2vjmQ2ivqGFb4LEG3SMnv0Gb2F/G/2yA8zUaiL1gywDCCg==",
+      "dev": true,
+      "hasInstallScript": true,
+      "license": "MIT",
+      "bin": {
+        "esbuild": "bin/esbuild"
+      },
+      "engines": {
+        "node": ">=18"
+      },
+      "optionalDependencies": {
+        "@esbuild/aix-ppc64": "0.27.3",
+        "@esbuild/android-arm": "0.27.3",
+        "@esbuild/android-arm64": "0.27.3",
+        "@esbuild/android-x64": "0.27.3",
+        "@esbuild/darwin-arm64": "0.27.3",
+        "@esbuild/darwin-x64": "0.27.3",
+        "@esbuild/freebsd-arm64": "0.27.3",
+        "@esbuild/freebsd-x64": "0.27.3",
+        "@esbuild/linux-arm": "0.27.3",
+        "@esbuild/linux-arm64": "0.27.3",
+        "@esbuild/linux-ia32": "0.27.3",
+        "@esbuild/linux-loong64": "0.27.3",
+        "@esbuild/linux-mips64el": "0.27.3",
+        "@esbuild/linux-ppc64": "0.27.3",
+        "@esbuild/linux-riscv64": "0.27.3",
+        "@esbuild/linux-s390x": "0.27.3",
+        "@esbuild/linux-x64": "0.27.3",
+        "@esbuild/netbsd-arm64": "0.27.3",
+        "@esbuild/netbsd-x64": "0.27.3",
+        "@esbuild/openbsd-arm64": "0.27.3",
+        "@esbuild/openbsd-x64": "0.27.3",
+        "@esbuild/openharmony-arm64": "0.27.3",
+        "@esbuild/sunos-x64": "0.27.3",
+        "@esbuild/win32-arm64": "0.27.3",
+        "@esbuild/win32-ia32": "0.27.3",
+        "@esbuild/win32-x64": "0.27.3"
+      }
+    },
+    "node_modules/escalade": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
+      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/fd-slicer": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/fd-slicer/-/fd-slicer-1.1.0.tgz",
+      "integrity": "sha512-cE1qsB/VwyQozZ+q1dGxR8LBYNZeofhEdUNGSMbQD3Gw2lAzX9Zb3uIU6Ebc/Fmyjo9AWWfnn0AUCHqtevs/8g==",
+      "license": "MIT",
+      "dependencies": {
+        "pend": "~1.2.0"
+      }
+    },
+    "node_modules/follow-redirects": {
+      "version": "1.15.11",
+      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
+      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
+      "funding": [
+        {
+          "type": "individual",
+          "url": "https://github.com/sponsors/RubenVerborgh"
+        }
+      ],
+      "license": "MIT",
+      "engines": {
+        "node": ">=4.0"
+      },
+      "peerDependenciesMeta": {
+        "debug": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/form-data": {
+      "version": "4.0.5",
+      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
+      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
+      "license": "MIT",
+      "dependencies": {
+        "asynckit": "^0.4.0",
+        "combined-stream": "^1.0.8",
+        "es-set-tostringtag": "^2.1.0",
+        "hasown": "^2.0.2",
+        "mime-types": "^2.1.12"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/fraction.js": {
+      "version": "5.3.4",
+      "resolved": "https://registry.npmjs.org/fraction.js/-/fraction.js-5.3.4.tgz",
+      "integrity": "sha512-1X1NTtiJphryn/uLQz3whtY6jK3fTqoE3ohKs0tT+Ujr1W59oopxmoEh7Lu5p6vBaPbgoM0bzveAW4Qi5RyWDQ==",
+      "license": "MIT",
+      "engines": {
+        "node": "*"
+      },
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/rawify"
+      }
+    },
+    "node_modules/fs-extra": {
+      "version": "11.3.3",
+      "resolved": "https://registry.npmjs.org/fs-extra/-/fs-extra-11.3.3.tgz",
+      "integrity": "sha512-VWSRii4t0AFm6ixFFmLLx1t7wS1gh+ckoa84aOeapGum0h+EZd1EhEumSB+ZdDLnEPuucsVB9oB7cxJHap6Afg==",
+      "license": "MIT",
+      "dependencies": {
+        "graceful-fs": "^4.2.0",
+        "jsonfile": "^6.0.1",
+        "universalify": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=14.14"
+      }
+    },
+    "node_modules/fsevents": {
+      "version": "2.3.3",
+      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
+      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
+      "dev": true,
+      "hasInstallScript": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
+      }
+    },
+    "node_modules/function-bind": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
+      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/gensync": {
+      "version": "1.0.0-beta.2",
+      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
+      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/get-intrinsic": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
+      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "es-define-property": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "es-object-atoms": "^1.1.1",
+        "function-bind": "^1.1.2",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "has-symbols": "^1.1.0",
+        "hasown": "^2.0.2",
+        "math-intrinsics": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
+      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
+      "license": "MIT",
+      "dependencies": {
+        "dunder-proto": "^1.0.1",
+        "es-object-atoms": "^1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/glob": {
+      "version": "13.0.6",
+      "resolved": "https://registry.npmjs.org/glob/-/glob-13.0.6.tgz",
+      "integrity": "sha512-Wjlyrolmm8uDpm/ogGyXZXb1Z+Ca2B8NbJwqBVg0axK9GbBeoS7yGV6vjXnYdGm6X53iehEuxxbyiKp8QmN4Vw==",
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "minimatch": "^10.2.2",
+        "minipass": "^7.1.3",
+        "path-scurry": "^2.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/gopd": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
+      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/graceful-fs": {
+      "version": "4.2.11",
+      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
+      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
+      "license": "ISC"
+    },
+    "node_modules/has-symbols": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
+      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-tostringtag": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
+      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
+      "license": "MIT",
+      "dependencies": {
+        "has-symbols": "^1.0.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/hasown": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
+      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/inherits": {
+      "version": "2.0.4",
+      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
+      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
+      "license": "ISC"
+    },
+    "node_modules/ini": {
+      "version": "4.1.3",
+      "resolved": "https://registry.npmjs.org/ini/-/ini-4.1.3.tgz",
+      "integrity": "sha512-X7rqawQBvfdjS10YU1y1YVreA3SsLrW9dX2CewP2EbBJM4ypVNLDkO5y04gejPwKIY9lR+7r9gn3rFPt/kmWFg==",
+      "license": "ISC",
+      "engines": {
+        "node": "^14.17.0 || ^16.13.0 || >=18.0.0"
+      }
+    },
+    "node_modules/is-docker": {
+      "version": "2.2.1",
+      "resolved": "https://registry.npmjs.org/is-docker/-/is-docker-2.2.1.tgz",
+      "integrity": "sha512-F+i2BKsFrH66iaUFc0woD8sLy8getkwTwtOBjvs56Cx4CgJDeKQeqfz8wAYiSb8JOprWhHH5p77PbmYCvvUuXQ==",
+      "license": "MIT",
+      "bin": {
+        "is-docker": "cli.js"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/is-fullwidth-code-point": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
+      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/is-wsl": {
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/is-wsl/-/is-wsl-2.2.0.tgz",
+      "integrity": "sha512-fKzAra0rGJUUBwGBgNkHZuToZcn+TtXHpeCgmkMJMMYx1sQDYaCSyjJBSCa2nH1DGm7s3n1oBnohoVTBaN7Lww==",
+      "license": "MIT",
+      "dependencies": {
+        "is-docker": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/isexe": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
+      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
+      "license": "ISC"
+    },
+    "node_modules/jiti": {
+      "version": "1.21.7",
+      "resolved": "https://registry.npmjs.org/jiti/-/jiti-1.21.7.tgz",
+      "integrity": "sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==",
+      "dev": true,
+      "license": "MIT",
+      "optional": true,
+      "peer": true,
+      "bin": {
+        "jiti": "bin/jiti.js"
+      }
+    },
+    "node_modules/js-tokens": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
+      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
+      "license": "MIT"
+    },
+    "node_modules/jsesc": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
+      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
+      "dev": true,
+      "license": "MIT",
+      "bin": {
+        "jsesc": "bin/jsesc"
+      },
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/json5": {
+      "version": "2.2.3",
+      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
+      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
+      "dev": true,
+      "license": "MIT",
+      "bin": {
+        "json5": "lib/cli.js"
+      },
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/jsonfile": {
+      "version": "6.2.0",
+      "resolved": "https://registry.npmjs.org/jsonfile/-/jsonfile-6.2.0.tgz",
+      "integrity": "sha512-FGuPw30AdOIUTRMC2OMRtQV+jkVj2cfPqSeWXv1NEAJ1qZ5zb1X6z1mFhbfOB/iy3ssJCD+3KuZ8r8C3uVFlAg==",
+      "license": "MIT",
+      "dependencies": {
+        "universalify": "^2.0.0"
+      },
+      "optionalDependencies": {
+        "graceful-fs": "^4.1.6"
+      }
+    },
+    "node_modules/kleur": {
+      "version": "4.1.5",
+      "resolved": "https://registry.npmjs.org/kleur/-/kleur-4.1.5.tgz",
+      "integrity": "sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/loose-envify": {
+      "version": "1.4.0",
+      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
+      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
+      "license": "MIT",
+      "dependencies": {
+        "js-tokens": "^3.0.0 || ^4.0.0"
+      },
+      "bin": {
+        "loose-envify": "cli.js"
+      }
+    },
+    "node_modules/lru-cache": {
+      "version": "5.1.1",
+      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
+      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "yallist": "^3.0.2"
+      }
+    },
+    "node_modules/math-intrinsics": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
+      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/mime-db": {
+      "version": "1.52.0",
+      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
+      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/mime-types": {
+      "version": "2.1.35",
+      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
+      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-db": "1.52.0"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/minimatch": {
+      "version": "10.2.2",
+      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-10.2.2.tgz",
+      "integrity": "sha512-+G4CpNBxa5MprY+04MbgOw1v7So6n5JY166pFi9KfYwT78fxScCeSNQSNzp6dpPSW2rONOps6Ocam1wFhCgoVw==",
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "brace-expansion": "^5.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/minipass": {
+      "version": "7.1.3",
+      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.3.tgz",
+      "integrity": "sha512-tEBHqDnIoM/1rXME1zgka9g6Q2lcoCkxHLuc7ODJ5BxbP5d4c2Z5cGgtXAku59200Cx7diuHTOYfSBD8n6mm8A==",
+      "license": "BlueOak-1.0.0",
+      "engines": {
+        "node": ">=16 || 14 >=14.17"
+      }
+    },
+    "node_modules/minizlib": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/minizlib/-/minizlib-3.1.0.tgz",
+      "integrity": "sha512-KZxYo1BUkWD2TVFLr0MQoM8vUUigWD3LlD83a/75BqC+4qE0Hb1Vo5v1FgcfaNXvfXzr+5EhQ6ing/CaBijTlw==",
+      "license": "MIT",
+      "dependencies": {
+        "minipass": "^7.1.2"
+      },
+      "engines": {
+        "node": ">= 18"
+      }
+    },
+    "node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/nanoid": {
+      "version": "3.3.11",
+      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
+      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "bin": {
+        "nanoid": "bin/nanoid.cjs"
+      },
+      "engines": {
+        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
+      }
+    },
+    "node_modules/native-run": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/native-run/-/native-run-2.0.3.tgz",
+      "integrity": "sha512-U1PllBuzW5d1gfan+88L+Hky2eZx+9gv3Pf6rNBxKbORxi7boHzqiA6QFGSnqMem4j0A9tZ08NMIs5+0m/VS1Q==",
+      "license": "MIT",
+      "dependencies": {
+        "@ionic/utils-fs": "^3.1.7",
+        "@ionic/utils-terminal": "^2.3.4",
+        "bplist-parser": "^0.3.2",
+        "debug": "^4.3.4",
+        "elementtree": "^0.1.7",
+        "ini": "^4.1.1",
+        "plist": "^3.1.0",
+        "split2": "^4.2.0",
+        "through2": "^4.0.2",
+        "tslib": "^2.6.2",
+        "yauzl": "^2.10.0"
+      },
+      "bin": {
+        "native-run": "bin/native-run"
+      },
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/node-releases": {
+      "version": "2.0.27",
+      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
+      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
+      "license": "MIT"
+    },
+    "node_modules/object-assign": {
+      "version": "4.1.1",
+      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
+      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/open": {
+      "version": "8.4.2",
+      "resolved": "https://registry.npmjs.org/open/-/open-8.4.2.tgz",
+      "integrity": "sha512-7x81NCL719oNbsq/3mh+hVrAWmFuEYUqrq/Iw3kUzH8ReypT9QQ0BLoJS7/G9k6N81XjW4qHWtjWwe/9eLy1EQ==",
+      "license": "MIT",
+      "dependencies": {
+        "define-lazy-prop": "^2.0.0",
+        "is-docker": "^2.1.1",
+        "is-wsl": "^2.2.0"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/package-json-from-dist": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
+      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
+      "license": "BlueOak-1.0.0"
+    },
+    "node_modules/path-key": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
+      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/path-scurry": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-2.0.2.tgz",
+      "integrity": "sha512-3O/iVVsJAPsOnpwWIeD+d6z/7PmqApyQePUtCndjatj/9I5LylHvt5qluFaBT3I5h3r1ejfR056c+FCv+NnNXg==",
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "lru-cache": "^11.0.0",
+        "minipass": "^7.1.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/path-scurry/node_modules/lru-cache": {
+      "version": "11.2.6",
+      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-11.2.6.tgz",
+      "integrity": "sha512-ESL2CrkS/2wTPfuend7Zhkzo2u0daGJ/A2VucJOgQ/C48S/zB8MMeMHSGKYpXhIjbPxfuezITkaBH1wqv00DDQ==",
+      "license": "BlueOak-1.0.0",
+      "engines": {
+        "node": "20 || >=22"
+      }
+    },
+    "node_modules/pend": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/pend/-/pend-1.2.0.tgz",
+      "integrity": "sha512-F3asv42UuXchdzt+xXqfW1OGlVBe+mxa2mqI0pg5yAHZPvFmY3Y6drSf/GQ1A86WgWEN9Kzh/WrgKa6iGcHXLg==",
+      "license": "MIT"
+    },
+    "node_modules/picocolors": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
+      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
+      "license": "ISC"
+    },
+    "node_modules/plist": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/plist/-/plist-3.1.0.tgz",
+      "integrity": "sha512-uysumyrvkUX0rX/dEVqt8gC3sTBzd4zoWfLeS29nb53imdaXVvLINYXTI2GNqzaMuvacNx4uJQ8+b3zXR0pkgQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@xmldom/xmldom": "^0.8.8",
+        "base64-js": "^1.5.1",
+        "xmlbuilder": "^15.1.1"
+      },
+      "engines": {
+        "node": ">=10.4.0"
+      }
+    },
+    "node_modules/postcss": {
+      "version": "8.5.6",
+      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
+      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/postcss/"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/postcss"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "nanoid": "^3.3.11",
+        "picocolors": "^1.1.1",
+        "source-map-js": "^1.2.1"
+      },
+      "engines": {
+        "node": "^10 || ^12 || >=14"
+      }
+    },
+    "node_modules/postcss-value-parser": {
+      "version": "4.2.0",
+      "resolved": "https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz",
+      "integrity": "sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==",
+      "license": "MIT"
+    },
+    "node_modules/prompts": {
+      "version": "2.4.2",
+      "resolved": "https://registry.npmjs.org/prompts/-/prompts-2.4.2.tgz",
+      "integrity": "sha512-NxNv/kLguCA7p3jE8oL2aEBsrJWgAakBpgmgK6lpPWV+WuOmY6r2/zbAVnP+T8bQlA0nzHXSJSJW0Hq7ylaD2Q==",
+      "license": "MIT",
+      "dependencies": {
+        "kleur": "^3.0.3",
+        "sisteransi": "^1.0.5"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/prompts/node_modules/kleur": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/kleur/-/kleur-3.0.3.tgz",
+      "integrity": "sha512-eTIzlVOSUR+JxdDFepEYcBMtZ9Qqdef+rnzWdRZuMbOywu5tO2w2N7rqjoANZ5k9vywhL6Br1VRjUIgTQx4E8w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/prop-types": {
+      "version": "15.8.1",
+      "resolved": "https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz",
+      "integrity": "sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==",
+      "license": "MIT",
+      "dependencies": {
+        "loose-envify": "^1.4.0",
+        "object-assign": "^4.1.1",
+        "react-is": "^16.13.1"
+      }
+    },
+    "node_modules/proxy-from-env": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
+      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
+      "license": "MIT"
+    },
+    "node_modules/react": {
+      "version": "18.3.1",
+      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
+      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
+      "license": "MIT",
+      "dependencies": {
+        "loose-envify": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/react-dom": {
+      "version": "18.3.1",
+      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
+      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
+      "license": "MIT",
+      "dependencies": {
+        "loose-envify": "^1.1.0",
+        "scheduler": "^0.23.2"
+      },
+      "peerDependencies": {
+        "react": "^18.3.1"
+      }
+    },
+    "node_modules/react-is": {
+      "version": "16.13.1",
+      "resolved": "https://registry.npmjs.org/react-is/-/react-is-16.13.1.tgz",
+      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==",
+      "license": "MIT"
+    },
+    "node_modules/react-refresh": {
+      "version": "0.17.0",
+      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
+      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/react-router": {
+      "version": "6.30.3",
+      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.30.3.tgz",
+      "integrity": "sha512-XRnlbKMTmktBkjCLE8/XcZFlnHvr2Ltdr1eJX4idL55/9BbORzyZEaIkBFDhFGCEWBBItsVrDxwx3gnisMitdw==",
+      "license": "MIT",
+      "dependencies": {
+        "@remix-run/router": "1.23.2"
+      },
+      "engines": {
+        "node": ">=14.0.0"
+      },
+      "peerDependencies": {
+        "react": ">=16.8"
+      }
+    },
+    "node_modules/react-router-dom": {
+      "version": "6.30.3",
+      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.30.3.tgz",
+      "integrity": "sha512-pxPcv1AczD4vso7G4Z3TKcvlxK7g7TNt3/FNGMhfqyntocvYKj+GCatfigGDjbLozC4baguJ0ReCigoDJXb0ag==",
+      "license": "MIT",
+      "dependencies": {
+        "@remix-run/router": "1.23.2",
+        "react-router": "6.30.3"
+      },
+      "engines": {
+        "node": ">=14.0.0"
+      },
+      "peerDependencies": {
+        "react": ">=16.8",
+        "react-dom": ">=16.8"
+      }
+    },
+    "node_modules/readable-stream": {
+      "version": "3.6.2",
+      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
+      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
+      "license": "MIT",
+      "dependencies": {
+        "inherits": "^2.0.3",
+        "string_decoder": "^1.1.1",
+        "util-deprecate": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/rimraf": {
+      "version": "6.1.3",
+      "resolved": "https://registry.npmjs.org/rimraf/-/rimraf-6.1.3.tgz",
+      "integrity": "sha512-LKg+Cr2ZF61fkcaK1UdkH2yEBBKnYjTyWzTJT6KNPcSPaiT7HSdhtMXQuN5wkTX0Xu72KQ1l8S42rlmexS2hSA==",
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "glob": "^13.0.3",
+        "package-json-from-dist": "^1.0.1"
+      },
+      "bin": {
+        "rimraf": "dist/esm/bin.mjs"
+      },
+      "engines": {
+        "node": "20 || >=22"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/rollup": {
+      "version": "4.59.0",
+      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.59.0.tgz",
+      "integrity": "sha512-2oMpl67a3zCH9H79LeMcbDhXW/UmWG/y2zuqnF2jQq5uq9TbM9TVyXvA4+t+ne2IIkBdrLpAaRQAvo7YI/Yyeg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@types/estree": "1.0.8"
+      },
+      "bin": {
+        "rollup": "dist/bin/rollup"
+      },
+      "engines": {
+        "node": ">=18.0.0",
+        "npm": ">=8.0.0"
+      },
+      "optionalDependencies": {
+        "@rollup/rollup-android-arm-eabi": "4.59.0",
+        "@rollup/rollup-android-arm64": "4.59.0",
+        "@rollup/rollup-darwin-arm64": "4.59.0",
+        "@rollup/rollup-darwin-x64": "4.59.0",
+        "@rollup/rollup-freebsd-arm64": "4.59.0",
+        "@rollup/rollup-freebsd-x64": "4.59.0",
+        "@rollup/rollup-linux-arm-gnueabihf": "4.59.0",
+        "@rollup/rollup-linux-arm-musleabihf": "4.59.0",
+        "@rollup/rollup-linux-arm64-gnu": "4.59.0",
+        "@rollup/rollup-linux-arm64-musl": "4.59.0",
+        "@rollup/rollup-linux-loong64-gnu": "4.59.0",
+        "@rollup/rollup-linux-loong64-musl": "4.59.0",
+        "@rollup/rollup-linux-ppc64-gnu": "4.59.0",
+        "@rollup/rollup-linux-ppc64-musl": "4.59.0",
+        "@rollup/rollup-linux-riscv64-gnu": "4.59.0",
+        "@rollup/rollup-linux-riscv64-musl": "4.59.0",
+        "@rollup/rollup-linux-s390x-gnu": "4.59.0",
+        "@rollup/rollup-linux-x64-gnu": "4.59.0",
+        "@rollup/rollup-linux-x64-musl": "4.59.0",
+        "@rollup/rollup-openbsd-x64": "4.59.0",
+        "@rollup/rollup-openharmony-arm64": "4.59.0",
+        "@rollup/rollup-win32-arm64-msvc": "4.59.0",
+        "@rollup/rollup-win32-ia32-msvc": "4.59.0",
+        "@rollup/rollup-win32-x64-gnu": "4.59.0",
+        "@rollup/rollup-win32-x64-msvc": "4.59.0",
+        "fsevents": "~2.3.2"
+      }
+    },
+    "node_modules/safe-buffer": {
+      "version": "5.2.1",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
+      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/feross"
+        },
+        {
+          "type": "patreon",
+          "url": "https://www.patreon.com/feross"
+        },
+        {
+          "type": "consulting",
+          "url": "https://feross.org/support"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/sax": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/sax/-/sax-1.1.4.tgz",
+      "integrity": "sha512-5f3k2PbGGp+YtKJjOItpg3P99IMD84E4HOvcfleTb5joCHNXYLsR9yWFPOYGgaeMPDubQILTCMdsFb2OMeOjtg==",
+      "license": "ISC"
+    },
+    "node_modules/scheduler": {
+      "version": "0.23.2",
+      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
+      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
+      "license": "MIT",
+      "dependencies": {
+        "loose-envify": "^1.1.0"
+      }
+    },
+    "node_modules/semver": {
+      "version": "6.3.1",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
+      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
+      "dev": true,
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
+      }
+    },
+    "node_modules/shebang-command": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
+      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
+      "license": "MIT",
+      "dependencies": {
+        "shebang-regex": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/shebang-regex": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
+      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/signal-exit": {
+      "version": "3.0.7",
+      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz",
+      "integrity": "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==",
+      "license": "ISC"
+    },
+    "node_modules/sisteransi": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/sisteransi/-/sisteransi-1.0.5.tgz",
+      "integrity": "sha512-bLGGlR1QxBcynn2d5YmDX4MGjlZvy2MRBDRNHLJ8VI6l6+9FUiyTFNJ0IveOSP0bcXgVDPRcfGqA0pjaqUpfVg==",
+      "license": "MIT"
+    },
+    "node_modules/slice-ansi": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/slice-ansi/-/slice-ansi-4.0.0.tgz",
+      "integrity": "sha512-qMCMfhY040cVHT43K9BFygqYbUPFZKHOg7K73mtTWJRb8pyP3fzf4Ixd5SzdEJQ6MRUg/WBnOLxghZtKKurENQ==",
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^4.0.0",
+        "astral-regex": "^2.0.0",
+        "is-fullwidth-code-point": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/slice-ansi?sponsor=1"
+      }
+    },
+    "node_modules/source-map": {
+      "version": "0.6.1",
+      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
+      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/source-map-js": {
+      "version": "1.2.1",
+      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
+      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/source-map-support": {
+      "version": "0.5.21",
+      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.21.tgz",
+      "integrity": "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "buffer-from": "^1.0.0",
+        "source-map": "^0.6.0"
+      }
+    },
+    "node_modules/split2": {
+      "version": "4.2.0",
+      "resolved": "https://registry.npmjs.org/split2/-/split2-4.2.0.tgz",
+      "integrity": "sha512-UcjcJOWknrNkF6PLX83qcHM6KHgVKNkV62Y8a5uYDVv9ydGQVwAHMKqHdJje1VTWpljG0WYpCDhrCdAOYH4TWg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">= 10.x"
+      }
+    },
+    "node_modules/string_decoder": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz",
+      "integrity": "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "~5.2.0"
+      }
+    },
+    "node_modules/string-width": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
+      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
+      "license": "MIT",
+      "dependencies": {
+        "emoji-regex": "^8.0.0",
+        "is-fullwidth-code-point": "^3.0.0",
+        "strip-ansi": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/strip-ansi": {
+      "version": "6.0.1",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
+      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^5.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/tailwindcss": {
+      "version": "4.2.1",
+      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-4.2.1.tgz",
+      "integrity": "sha512-/tBrSQ36vCleJkAOsy9kbNTgaxvGbyOamC30PRePTQe/o1MFwEKHQk4Cn7BNGaPtjp+PuUrByJehM1hgxfq4sw==",
+      "license": "MIT"
+    },
+    "node_modules/tar": {
+      "version": "7.5.9",
+      "resolved": "https://registry.npmjs.org/tar/-/tar-7.5.9.tgz",
+      "integrity": "sha512-BTLcK0xsDh2+PUe9F6c2TlRp4zOOBMTkoQHQIWSIzI0R7KG46uEwq4OPk2W7bZcprBMsuaeFsqwYr7pjh6CuHg==",
+      "license": "BlueOak-1.0.0",
+      "dependencies": {
+        "@isaacs/fs-minipass": "^4.0.0",
+        "chownr": "^3.0.0",
+        "minipass": "^7.1.2",
+        "minizlib": "^3.1.0",
+        "yallist": "^5.0.0"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/tar/node_modules/yallist": {
+      "version": "5.0.0",
+      "resolved": "https://registry.npmjs.org/yallist/-/yallist-5.0.0.tgz",
+      "integrity": "sha512-YgvUTfwqyc7UXVMrB+SImsVYSmTS8X/tSrtdNZMImM+n7+QTriRXyXim0mBrTXNeqzVF0KWGgHPeiyViFFrNDw==",
+      "license": "BlueOak-1.0.0",
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/terser": {
+      "version": "5.46.0",
+      "resolved": "https://registry.npmjs.org/terser/-/terser-5.46.0.tgz",
+      "integrity": "sha512-jTwoImyr/QbOWFFso3YoU3ik0jBBDJ6JTOQiy/J2YxVJdZCc+5u7skhNwiOR3FQIygFqVUPHl7qbbxtjW2K3Qg==",
+      "dev": true,
+      "license": "BSD-2-Clause",
+      "dependencies": {
+        "@jridgewell/source-map": "^0.3.3",
+        "acorn": "^8.15.0",
+        "commander": "^2.20.0",
+        "source-map-support": "~0.5.20"
+      },
+      "bin": {
+        "terser": "bin/terser"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/terser/node_modules/commander": {
+      "version": "2.20.3",
+      "resolved": "https://registry.npmjs.org/commander/-/commander-2.20.3.tgz",
+      "integrity": "sha512-GpVkmM8vF2vQUkj2LvZmD35JxeJOLCwJ9cUkugyk2nuhbv3+mJvpLYYt+0+USMxE+oj+ey/lJEnhZw75x/OMcQ==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/through2": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/through2/-/through2-4.0.2.tgz",
+      "integrity": "sha512-iOqSav00cVxEEICeD7TjLB1sueEL+81Wpzp2bY17uZjZN0pWZPuo4suZ/61VujxmqSGFfgOcNuTZ85QJwNZQpw==",
+      "license": "MIT",
+      "dependencies": {
+        "readable-stream": "3"
+      }
+    },
+    "node_modules/tinyglobby": {
+      "version": "0.2.15",
+      "resolved": "https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz",
+      "integrity": "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "fdir": "^6.5.0",
+        "picomatch": "^4.0.3"
+      },
+      "engines": {
+        "node": ">=12.0.0"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/SuperchupuDev"
+      }
+    },
+    "node_modules/tinyglobby/node_modules/fdir": {
+      "version": "6.5.0",
+      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
+      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12.0.0"
+      },
+      "peerDependencies": {
+        "picomatch": "^3 || ^4"
+      },
+      "peerDependenciesMeta": {
+        "picomatch": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/tinyglobby/node_modules/picomatch": {
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
+      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/jonschlinkert"
+      }
+    },
+    "node_modules/tree-kill": {
+      "version": "1.2.2",
+      "resolved": "https://registry.npmjs.org/tree-kill/-/tree-kill-1.2.2.tgz",
+      "integrity": "sha512-L0Orpi8qGpRG//Nd+H90vFB+3iHnue1zSSGmNOOCh1GLJ7rUKVwV2HvijphGQS2UmhUZewS9VgvxYIdgr+fG1A==",
+      "license": "MIT",
+      "bin": {
+        "tree-kill": "cli.js"
+      }
+    },
+    "node_modules/tslib": {
+      "version": "2.8.1",
+      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
+      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
+      "license": "0BSD"
+    },
+    "node_modules/typescript": {
+      "version": "5.9.3",
+      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
+      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "bin": {
+        "tsc": "bin/tsc",
+        "tsserver": "bin/tsserver"
+      },
+      "engines": {
+        "node": ">=14.17"
+      }
+    },
+    "node_modules/undici-types": {
+      "version": "7.18.2",
+      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-7.18.2.tgz",
+      "integrity": "sha512-AsuCzffGHJybSaRrmr5eHr81mwJU3kjw6M+uprWvCXiNeN9SOGwQ3Jn8jb8m3Z6izVgknn1R0FTCEAP2QrLY/w==",
+      "license": "MIT"
+    },
+    "node_modules/universalify": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/universalify/-/universalify-2.0.1.tgz",
+      "integrity": "sha512-gptHNQghINnc/vTGIk0SOFGFNXw7JVrlRUtConJRlvaw6DuX0wO5Jeko9sWrMBhh+PsYAZ7oXAiOnf/UKogyiw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 10.0.0"
+      }
+    },
+    "node_modules/untildify": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/untildify/-/untildify-4.0.0.tgz",
+      "integrity": "sha512-KK8xQ1mkzZeg9inewmFVDNkg3l5LUhoq9kN6iWYB/CC9YMG8HA+c1Q8HwDe6dEX7kErrEVNVBO3fWsVq5iDgtw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/update-browserslist-db": {
+      "version": "1.2.3",
+      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
+      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/browserslist"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "escalade": "^3.2.0",
+        "picocolors": "^1.1.1"
+      },
+      "bin": {
+        "update-browserslist-db": "cli.js"
+      },
+      "peerDependencies": {
+        "browserslist": ">= 4.21.0"
+      }
+    },
+    "node_modules/util-deprecate": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
+      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
+      "license": "MIT"
+    },
+    "node_modules/vite": {
+      "version": "7.3.1",
+      "resolved": "https://registry.npmjs.org/vite/-/vite-7.3.1.tgz",
+      "integrity": "sha512-w+N7Hifpc3gRjZ63vYBXA56dvvRlNWRczTdmCBBa+CotUzAPf5b7YMdMR/8CQoeYE5LX3W4wj6RYTgonm1b9DA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "esbuild": "^0.27.0",
+        "fdir": "^6.5.0",
+        "picomatch": "^4.0.3",
+        "postcss": "^8.5.6",
+        "rollup": "^4.43.0",
+        "tinyglobby": "^0.2.15"
+      },
+      "bin": {
+        "vite": "bin/vite.js"
+      },
+      "engines": {
+        "node": "^20.19.0 || >=22.12.0"
+      },
+      "funding": {
+        "url": "https://github.com/vitejs/vite?sponsor=1"
+      },
+      "optionalDependencies": {
+        "fsevents": "~2.3.3"
+      },
+      "peerDependencies": {
+        "@types/node": "^20.19.0 || >=22.12.0",
+        "jiti": ">=1.21.0",
+        "less": "^4.0.0",
+        "lightningcss": "^1.21.0",
+        "sass": "^1.70.0",
+        "sass-embedded": "^1.70.0",
+        "stylus": ">=0.54.8",
+        "sugarss": "^5.0.0",
+        "terser": "^5.16.0",
+        "tsx": "^4.8.1",
+        "yaml": "^2.4.2"
+      },
+      "peerDependenciesMeta": {
+        "@types/node": {
+          "optional": true
+        },
+        "jiti": {
+          "optional": true
+        },
+        "less": {
+          "optional": true
+        },
+        "lightningcss": {
+          "optional": true
+        },
+        "sass": {
+          "optional": true
+        },
+        "sass-embedded": {
+          "optional": true
+        },
+        "stylus": {
+          "optional": true
+        },
+        "sugarss": {
+          "optional": true
+        },
+        "terser": {
+          "optional": true
+        },
+        "tsx": {
+          "optional": true
+        },
+        "yaml": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/vite/node_modules/fdir": {
+      "version": "6.5.0",
+      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
+      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12.0.0"
+      },
+      "peerDependencies": {
+        "picomatch": "^3 || ^4"
+      },
+      "peerDependenciesMeta": {
+        "picomatch": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/vite/node_modules/picomatch": {
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
+      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/jonschlinkert"
+      }
+    },
+    "node_modules/which": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
+      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
+      "license": "ISC",
+      "dependencies": {
+        "isexe": "^2.0.0"
+      },
+      "bin": {
+        "node-which": "bin/node-which"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/wrap-ansi": {
+      "version": "7.0.0",
+      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
+      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^4.0.0",
+        "string-width": "^4.1.0",
+        "strip-ansi": "^6.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
+      }
+    },
+    "node_modules/xml2js": {
+      "version": "0.6.2",
+      "resolved": "https://registry.npmjs.org/xml2js/-/xml2js-0.6.2.tgz",
+      "integrity": "sha512-T4rieHaC1EXcES0Kxxj4JWgaUQHDk+qwHcYOCFHfiwKz7tOVPLq7Hjq9dM1WCMhylqMEfP7hMcOIChvotiZegA==",
+      "license": "MIT",
+      "dependencies": {
+        "sax": ">=0.6.0",
+        "xmlbuilder": "~11.0.0"
+      },
+      "engines": {
+        "node": ">=4.0.0"
+      }
+    },
+    "node_modules/xml2js/node_modules/xmlbuilder": {
+      "version": "11.0.1",
+      "resolved": "https://registry.npmjs.org/xmlbuilder/-/xmlbuilder-11.0.1.tgz",
+      "integrity": "sha512-fDlsI/kFEx7gLvbecc0/ohLG50fugQp8ryHzMTuW9vSa1GJ0XYWKnhsUx7oie3G98+r56aTQIUB4kht42R3JvA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=4.0"
+      }
+    },
+    "node_modules/xmlbuilder": {
+      "version": "15.1.1",
+      "resolved": "https://registry.npmjs.org/xmlbuilder/-/xmlbuilder-15.1.1.tgz",
+      "integrity": "sha512-yMqGBqtXyeN1e3TGYvgNgDVZ3j84W4cwkOXQswghol6APgZWaff9lnbvN7MHYJOiXsvGPXtjTYJEiC9J2wv9Eg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8.0"
+      }
+    },
+    "node_modules/yallist": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
+      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/yauzl": {
+      "version": "2.10.0",
+      "resolved": "https://registry.npmjs.org/yauzl/-/yauzl-2.10.0.tgz",
+      "integrity": "sha512-p4a9I6X6nu6IhoGmBqAcbJy1mlC4j27vEPZX9F4L4/vZT3Lyq1VkFHw/V/PUcB9Buo+DG3iHkT0x3Qya58zc3g==",
+      "license": "MIT",
+      "dependencies": {
+        "buffer-crc32": "~0.2.3",
+        "fd-slicer": "~1.1.0"
+      }
+    }
+  }
+}
diff --git a/templates/crm-homecare/frontend/package.json b/templates/crm-homecare/frontend/package.json
index 9d71ff5..b789f90 100644
--- a/templates/crm-homecare/frontend/package.json
+++ b/templates/crm-homecare/frontend/package.json
@@ -1,30 +1,44 @@
 {
-  "name": "twomiah-care-frontend",
-  "private": true,
+  "name": "chippewa-home-care-frontend",
   "version": "1.0.0",
+  "description": "HIPAA-compliant home care CRM frontend",
   "type": "module",
   "scripts": {
     "dev": "vite",
     "build": "vite build",
-    "preview": "vite preview"
+    "preview": "vite preview",
+    "lint": "eslint src"
   },
   "dependencies": {
-    "clsx": "^2.1.1",
-    "lucide-react": "^0.344.0",
+    "@capacitor-community/background-geolocation": "^1.2.26",
+    "@capacitor/android": "^8.1.0",
+    "@capacitor/cli": "^8.1.0",
+    "@capacitor/core": "^8.1.0",
+    "@capacitor/geolocation": "^8.1.0",
+    "@capacitor/haptics": "^8.0.0",
+    "@capacitor/ios": "^8.1.0",
+    "@capacitor/keyboard": "^8.0.0",
+    "@capacitor/local-notifications": "^8.0.1",
+    "@capacitor/network": "^8.0.1",
+    "@capacitor/push-notifications": "^8.0.1",
+    "@capacitor/splash-screen": "^8.0.1",
+    "@capacitor/status-bar": "^8.0.1",
+    "autoprefixer": "^10.4.24",
+    "axios": "^1.6.2",
+    "postcss": "^8.5.6",
+    "prop-types": "^15.8.1",
     "react": "^18.2.0",
     "react-dom": "^18.2.0",
-    "react-router-dom": "^6.22.1",
-    "socket.io-client": "^4.7.4",
-    "zustand": "^4.5.0",
-    "prop-types": "^15.8.1"
+    "react-router-dom": "^6.28.0",
+    "tailwindcss": "^4.2.1"
   },
   "devDependencies": {
-    "@types/react": "^18.2.56",
-    "@types/react-dom": "^18.2.19",
     "@vitejs/plugin-react": "^4.2.1",
-    "autoprefixer": "^10.4.17",
-    "postcss": "^8.4.35",
-    "tailwindcss": "^3.4.1",
-    "vite": "^5.1.4"
+    "terser": "^5.44.1",
+    "typescript": "^5.9.3",
+    "vite": "^7.3.1"
+  },
+  "engines": {
+    "node": ">=18.0.0"
   }
-}
\ No newline at end of file
+}
diff --git a/templates/crm-homecare/frontend/postcss.config.js b/templates/crm-homecare/frontend/postcss.config.js
deleted file mode 100644
index e008c9c..0000000
--- a/templates/crm-homecare/frontend/postcss.config.js
+++ /dev/null
@@ -1,3 +0,0 @@
-export default {
-  plugins: { tailwindcss: {}, autoprefixer: {} },
-};
diff --git a/templates/crm-homecare/frontend/src/App.jsx b/templates/crm-homecare/frontend/src/App.jsx
index da6a852..0957180 100644
--- a/templates/crm-homecare/frontend/src/App.jsx
+++ b/templates/crm-homecare/frontend/src/App.jsx
@@ -1,93 +1,209 @@
+// src/App.jsx - Main application component
+import React, { useState, useEffect, useCallback } from 'react';
 import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
-import { AuthProvider, useAuth } from './contexts/AuthContext.jsx';
-import { ToastProvider } from './contexts/ToastContext.jsx';
-
-// Layout & Auth
-import AppLayout from './components/layout/AppLayout.jsx';
-import LoginPage from './pages/LoginPage.jsx';
-
-// Admin Pages
-import DashboardPage from './pages/DashboardPage.jsx';
-import ClientsPage from './pages/ClientsPage.jsx';
-import ClientDetailPage from './pages/ClientDetailPage.jsx';
-import CaregiversPage from './pages/CaregiversPage.jsx';
-import CaregiverDetailPage from './pages/CaregiverDetailPage.jsx';
-import SchedulingPage from './pages/SchedulingPage.jsx';
-import TimeTrackingPage from './pages/TimeTrackingPage.jsx';
-import BillingPage from './pages/BillingPage.jsx';
-import PayrollPage from './pages/PayrollPage.jsx';
-import ReportsPage from './pages/ReportsPage.jsx';
-import CompliancePage from './pages/CompliancePage.jsx';
-import CommunicationPage from './pages/CommunicationPage.jsx';
-import FormsPage from './pages/FormsPage.jsx';
-import EVVPage from './pages/EVVPage.jsx';
-import ClaimsPage from './pages/ClaimsPage.jsx';
-import DocumentsPage from './pages/DocumentsPage.jsx';
-import NotificationsPage from './pages/NotificationsPage.jsx';
-import SettingsPage from './pages/SettingsPage.jsx';
-import AuditPage from './pages/AuditPage.jsx';
-
-// Caregiver portal
-import CaregiverPortalPage from './pages/CaregiverPortalPage.jsx';
-
-// Family portal
-import FamilyPortalPage from './pages/FamilyPortalPage.jsx';
-
-function ProtectedRoute({ children, adminOnly = false }) {
-  const { user, loading } = useAuth();
-  if (loading) return <div className="min-h-screen flex items-center justify-center"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary" style={{ borderColor: 'var(--color-primary)' }} /></div>;
-  if (!user) return <Navigate to="/login" replace />;
-  if (adminOnly && user.role === 'caregiver') return <Navigate to="/caregiver" replace />;
-  return children;
-}
-
-function AppRoutes() {
-  const { user } = useAuth();
+import Login from './components/Login';
+import AdminDashboard from './components/AdminDashboard';
+import CaregiverDashboard from './components/CaregiverDashboard';
+import PaymentPage, { PaymentSuccess } from './components/PaymentPage';
+import PortalLogin from './components/portal/PortalLogin';
+import PortalSetup from './components/portal/PortalSetup';
+import ClientPortal from './components/portal/ClientPortal';
+import { ToastContainer, toast } from './components/Toast';
+import { ConfirmModal } from './components/ConfirmModal';
+import { setSessionExpiredCallback } from './config';
+import { ErrorBoundary } from './components/ErrorBoundary';
 
+const App = () => {
   return (
-    <Routes>
-      <Route path="/login" element={user ? <Navigate to={user.role === 'caregiver' ? '/caregiver' : '/'} replace /> : <LoginPage />} />
-      <Route path="/portal" element={<FamilyPortalPage />} />
-
-      {/* Admin routes */}
-      <Route path="/" element={<ProtectedRoute adminOnly><AppLayout /></ProtectedRoute>}>
-        <Route index element={<DashboardPage />} />
-        <Route path="clients" element={<ClientsPage />} />
-        <Route path="clients/:id" element={<ClientDetailPage />} />
-        <Route path="caregivers" element={<CaregiversPage />} />
-        <Route path="caregivers/:id" element={<CaregiverDetailPage />} />
-        <Route path="scheduling" element={<SchedulingPage />} />
-        <Route path="time-tracking" element={<TimeTrackingPage />} />
-        <Route path="billing" element={<BillingPage />} />
-        <Route path="payroll" element={<PayrollPage />} />
-        <Route path="compliance" element={<CompliancePage />} />
-        <Route path="communication" element={<CommunicationPage />} />
-        <Route path="forms" element={<FormsPage />} />
-        <Route path="evv" element={<EVVPage />} />
-        <Route path="claims" element={<ClaimsPage />} />
-        <Route path="documents" element={<DocumentsPage />} />
-        <Route path="notifications" element={<NotificationsPage />} />
-        <Route path="reports" element={<ReportsPage />} />
-        <Route path="audit" element={<AuditPage />} />
-        <Route path="settings" element={<SettingsPage />} />
-      </Route>
-
-      {/* Caregiver dashboard */}
-      <Route path="/caregiver/*" element={<ProtectedRoute><CaregiverPortalPage /></ProtectedRoute>} />
-
-      <Route path="*" element={<Navigate to="/" replace />} />
-    </Routes>
+    <BrowserRouter>
+      <ToastContainer />
+      <ConfirmModal />
+
+      <Routes>
+        {/* Public payment routes */}
+        <Route path="/pay/:invoiceId"    element={<PaymentPage />} />
+        <Route path="/payment-success"   element={<PaymentSuccess />} />
+
+        {/* Client portal setup (invite link) */}
+        <Route path="/portal/setup"      element={<PortalSetup />} />
+
+        {/* Client portal */}
+        <Route path="/portal/*"          element={<PortalApp />} />
+
+        {/* Staff app */}
+        <Route path="/*"                 element={<MainApp />} />
+      </Routes>
+    </BrowserRouter>
   );
-}
+};
+
+// ── Client Portal App ─────────────────────────────────────────────────────────
+const PortalApp = () => {
+  const [client, setClient]   = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [token, setToken]     = useState(localStorage.getItem('portal_token'));
+
+  const handleLogout = useCallback(() => {
+    localStorage.removeItem('portal_token');
+    setToken(null);
+    setClient(null);
+  }, []);
+
+  useEffect(() => {
+    if (token) {
+      try {
+        const payload = JSON.parse(atob(token.split('.')[1]));
+        if (payload.exp && payload.exp * 1000 < Date.now()) {
+          handleLogout();
+          return;
+        }
+        // role must be 'client'
+        if (payload.role !== 'client') {
+          handleLogout();
+          return;
+        }
+        setClient(payload);
+      } catch {
+        handleLogout();
+      }
+    }
+    setLoading(false);
+  }, [token, handleLogout]);
+
+  const handleLogin = (token, clientData) => {
+    localStorage.setItem('portal_token', token);
+    setToken(token);
+    // Merge JWT payload with name from response
+    const payload = JSON.parse(atob(token.split('.')[1]));
+    setClient({ ...payload, firstName: clientData.firstName, lastName: clientData.lastName });
+  };
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  if (!client) return <PortalLogin onLogin={handleLogin} />;
 
-export default function App() {
   return (
-    <BrowserRouter>
-      <AuthProvider>
-        <ToastProvider>
-          <AppRoutes />
-        </ToastProvider>
-      </AuthProvider>
-    </BrowserRouter>
+    <ErrorBoundary>
+      <ClientPortal user={client} token={token} onLogout={handleLogout} />
+    </ErrorBoundary>
   );
-}
+};
+
+// ── Staff App ─────────────────────────────────────────────────────────────────
+const MainApp = () => {
+  const [user, setUser]         = useState(null);
+  const [loading, setLoading]   = useState(true);
+  const [token, setToken]       = useState(localStorage.getItem('token'));
+
+  // Impersonation state — keeps original admin session intact
+  const [impersonationToken, setImpersonationToken] = useState(null);
+  const [impersonationUser, setImpersonationUser]   = useState(null);
+
+  const handleLogout = useCallback((expired = false) => {
+    localStorage.removeItem('token');
+    setToken(null);
+    setUser(null);
+    setImpersonationToken(null);
+    setImpersonationUser(null);
+    if (expired) toast('Your session has expired. Please log in again.', 'warning');
+  }, []);
+
+  useEffect(() => {
+    setSessionExpiredCallback(() => handleLogout(true));
+  }, [handleLogout]);
+
+  useEffect(() => {
+    if (token) {
+      try {
+        const payload = JSON.parse(atob(token.split('.')[1]));
+        if (payload.exp && payload.exp * 1000 < Date.now()) {
+          handleLogout(true);
+          return;
+        }
+        setUser(payload);
+      } catch {
+        localStorage.removeItem('token');
+        setToken(null);
+      }
+    }
+    setLoading(false);
+  }, [token]);
+
+  const handleLogin = (token, userData) => {
+    localStorage.setItem('token', token);
+    setToken(token);
+    setUser(userData);
+  };
+
+  const handleImpersonate = (impToken, impUser) => {
+    setImpersonationToken(impToken);
+    setImpersonationUser(impUser);
+  };
+
+  const exitImpersonation = () => {
+    setImpersonationToken(null);
+    setImpersonationUser(null);
+    toast('Returned to your admin account', 'success');
+  };
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  if (!user) return <Login onLogin={handleLogin} />;
+
+  // Active impersonation — show target user's view with a banner
+  if (impersonationToken && impersonationUser) {
+    return (
+      <ErrorBoundary>
+        {/* Impersonation banner */}
+        <div style={{
+          position: 'fixed', top: 0, left: 0, right: 0, zIndex: 99999,
+          background: '#f97316', color: '#fff',
+          display: 'flex', alignItems: 'center', justifyContent: 'space-between',
+          padding: '0.5rem 1.25rem', fontSize: '0.875rem', fontWeight: 600,
+          boxShadow: '0 2px 8px rgba(0,0,0,0.2)'
+        }}>
+          <span>
+            👁️ Viewing as <strong>{impersonationUser.name}</strong>
+            <span style={{ fontWeight: 400, opacity: 0.85, marginLeft: '0.5rem' }}>
+              ({impersonationUser.role}) — read-only debug view
+            </span>
+          </span>
+          <button
+            onClick={exitImpersonation}
+            style={{
+              background: 'rgba(255,255,255,0.25)', border: '1px solid rgba(255,255,255,0.5)',
+              color: '#fff', padding: '0.25rem 0.9rem', borderRadius: '6px',
+              cursor: 'pointer', fontWeight: 700, fontSize: '0.82rem'
+            }}
+          >
+            ✕ Exit
+          </button>
+        </div>
+        {/* Offset content below banner */}
+        <div style={{ paddingTop: '2.5rem' }}>
+          {impersonationUser.role === 'admin'
+            ? <AdminDashboard user={impersonationUser} token={impersonationToken} onLogout={exitImpersonation} />
+            : <CaregiverDashboard user={impersonationUser} token={impersonationToken} onLogout={exitImpersonation} />
+          }
+        </div>
+      </ErrorBoundary>
+    );
+  }
+
+  if (user.role === 'admin') {
+    return (
+      <ErrorBoundary>
+        <AdminDashboard
+          user={user}
+          token={token}
+          onLogout={handleLogout}
+          onImpersonate={handleImpersonate}
+        />
+      </ErrorBoundary>
+    );
+  } else {
+    return <ErrorBoundary><CaregiverDashboard user={user} token={token} onLogout={handleLogout} /></ErrorBoundary>;
+  }
+};
+
+export default App;
diff --git a/templates/crm-homecare/frontend/src/components/AdminDashboard.jsx b/templates/crm-homecare/frontend/src/components/AdminDashboard.jsx
new file mode 100644
index 0000000..51f89c5
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/AdminDashboard.jsx
@@ -0,0 +1,558 @@
+// src/components/AdminDashboard.jsx - Rebuilt with collapsible nav, search, notifications
+import React, { useState, useEffect, useRef, useCallback } from 'react';
+import { API_BASE_URL } from '../config';
+import { getDashboardSummary } from '../config';
+import { toast } from './Toast';
+import HelpPanel from './HelpPanel';
+import ImpersonationModal from './ImpersonationModal';
+import MessageBoard from './admin/MessageBoard';
+import IntegrationsHub from './admin/IntegrationsHub';
+
+// Admin pages
+import DashboardOverview from './admin/DashboardOverview';
+import ReferralSources from './admin/ReferralSources';
+import ClientsManagement from './admin/ClientsManagement';
+import CaregiverManagement from './admin/CaregiverManagement';
+import BillingDashboard from './admin/BillingDashboard';
+import ClientOnboarding from './admin/ClientOnboarding';
+import PerformanceRatings from './admin/PerformanceRatings';
+import ExpenseManagement from './admin/ExpenseManagement';
+import CaregiverProfile from './admin/CaregiverProfile';
+import CaregiverHistory from './admin/CaregiverHistory';
+import ApplicationsDashboard from './admin/ApplicationsDashboard';
+import CarePlans from './admin/CarePlans';
+import IncidentReporting from './admin/IncidentReporting';
+import NotificationCenter from './admin/NotificationCenter';
+import ComplianceTracking from './admin/ComplianceTracking';
+import ReportsAnalytics from './admin/ReportsAnalytics';
+import PayrollProcessing from './admin/PayrollProcessing';
+import AuditLogs from './admin/AuditLogs';
+import LoginActivity from './admin/LoginActivity';
+import ClaimsManagement from './admin/ClaimsManagement';
+import MedicationsManagement from './admin/MedicationsManagement';
+import DocumentsManagement from './admin/DocumentsManagement';
+import ADLTracking from './admin/ADLTracking';
+import BackgroundChecks from './admin/BackgroundChecks';
+import SMSManagement from './admin/SMSManagement';
+import FamilyPortalAdmin from './admin/FamilyPortalAdmin';
+import AlertsManagement from './admin/AlertsManagement';
+import SchedulingHub from './admin/SchedulingHub';
+import RouteOptimizer from './admin/RouteOptimizer';
+import CompanyOptimizer from './admin/CompanyOptimizer';
+import EmergencyCoverage from './admin/EmergencyCoverage';
+import CommunicationLog from './admin/CommunicationLog';
+import NoShowAlerts from './admin/NoShowAlerts';
+import FormBuilder from './admin/FormBuilder';
+import RevenueForecast from './admin/RevenueForecast';
+
+const NAV_SECTIONS = [
+  {
+    id: 'ops', label: 'Operations', icon: '🏢',
+    items: [
+      { id: 'dashboard', label: 'Dashboard', icon: '📊' },
+      { id: 'clients', label: 'Clients', icon: '👤' },
+      { id: 'onboarding', label: 'Onboarding', icon: '📋' },
+      { id: 'referrals', label: 'Referral Sources', icon: '🏥' },
+      { id: 'care-plans', label: 'Care Plans', icon: '❤️' },
+    ]
+  },
+  {
+    id: 'scheduling', label: 'Scheduling', icon: '📅',
+    items: [
+      { id: 'scheduling', label: 'Schedule Hub', icon: '📅' },
+      { id: 'emergency-coverage', label: 'Emergency Coverage', icon: '🚨' },
+      { id: 'no-show-alerts', label: 'No-Show Alerts', icon: '⏰' },
+      { id: 'route-optimizer', label: 'Route Optimizer', icon: '🗺️' },
+      { id: 'company-optimizer', label: 'Company Optimizer', icon: '⚙️' },
+    ]
+  },
+  {
+    id: 'clinical', label: 'Clinical', icon: '🩺',
+    items: [
+      { id: 'adl', label: 'ADL Tracking', icon: '🩺' },
+      { id: 'medications', label: 'Medications', icon: '💊' },
+      { id: 'incidents', label: 'Incidents', icon: '⚠️' },
+      { id: 'form-builder', label: 'Form Builder', icon: '📝' },
+    ]
+  },
+  {
+    id: 'caregiving', label: 'Caregivers', icon: '👥',
+    items: [
+      { id: 'caregivers', label: 'Caregivers', icon: '👥' },
+      { id: 'performance', label: 'Performance', icon: '⭐' },
+      { id: 'applications', label: 'Job Applications', icon: '📝' },
+    ]
+  },
+  {
+    id: 'financial', label: 'Financial', icon: '💰',
+    items: [
+      { id: 'billing', label: 'Billing', icon: '🧾' },
+      { id: 'claims', label: 'Claims', icon: '📑' },
+      { id: 'payroll', label: 'Payroll', icon: '💵' },
+      { id: 'expenses', label: 'Expenses', icon: '💳' },
+      { id: 'reports', label: 'Reports & Analytics', icon: '📊' },
+      { id: 'revenue-forecast', label: 'Revenue Forecast', icon: '📈' },
+    ]
+  },
+  {
+    id: 'compliance', label: 'Compliance', icon: '🛡️',
+    items: [
+      { id: 'compliance', label: 'Compliance', icon: '🛡️' },
+      { id: 'background-checks', label: 'Background Checks', icon: '🔍' },
+      { id: 'documents', label: 'Documents', icon: '📁' },
+      { id: 'audit-logs', label: 'Audit Logs', icon: '📜' },
+      { id: 'login-activity', label: 'Login Activity', icon: '🔑' },
+    ]
+  },
+  {
+    id: 'comms', label: 'Communication', icon: '💬',
+    items: [
+      { id: 'communication-log', label: 'Communication Log', icon: '📋' },
+      { id: 'sms', label: 'SMS', icon: '📱' },
+      { id: 'family-portal', label: 'Family Portal', icon: '🏠' },
+      { id: 'alerts', label: 'Alerts', icon: '🔔' },
+      { id: 'messages', label: 'Messages', icon: '💬' },
+      { id: 'integrations', label: 'Integrations Hub', icon: '🔌' },
+      { id: 'notifications', label: 'Notifications', icon: '📬' },
+    ]
+  },
+];
+
+// All searchable items flattened
+const ALL_ITEMS = NAV_SECTIONS.flatMap(s => s.items);
+
+const AdminDashboard = ({ user, token, onLogout, onImpersonate }) => {
+  const [currentPage, setCurrentPage] = useState('dashboard');
+  const [showHelp, setShowHelp] = useState(false);
+  const [showImpersonation, setShowImpersonation] = useState(false);
+  const [selectedCaregiverId, setSelectedCaregiverId] = useState(null);
+  const [selectedCaregiverName, setSelectedCaregiverName] = useState('');
+  const [summary, setSummary] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [sidebarOpen, setSidebarOpen] = useState(window.innerWidth > 768);
+  const [moreDrawerOpen, setMoreDrawerOpen] = useState(false);
+  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);
+  const [collapsedSections, setCollapsedSections] = useState({});
+  const [searchQuery, setSearchQuery] = useState('');
+  const [searchResults, setSearchResults] = useState([]);
+  const [showSearch, setShowSearch] = useState(false);
+  const [unreadCount, setUnreadCount] = useState(0);
+  const [liveStats, setLiveStats] = useState({ activeCaregivers: 0, todayShifts: 0 });
+  const searchRef = useRef(null);
+
+  useEffect(() => { loadDashboard(); loadUnreadCount(); }, []);
+
+  useEffect(() => {
+    const handleResize = () => setSidebarOpen(window.innerWidth > 768);
+    window.addEventListener('resize', handleResize);
+    return () => window.removeEventListener('resize', handleResize);
+  }, []);
+
+  useEffect(() => {
+    if (window.innerWidth <= 768) setSidebarOpen(false);
+  }, [currentPage]);
+
+  useEffect(() => {
+    // Global search
+    if (!searchQuery.trim()) { setSearchResults([]); return; }
+    const q = searchQuery.toLowerCase();
+    const results = ALL_ITEMS.filter(item =>
+      item.label.toLowerCase().includes(q)
+    );
+    setSearchResults(results);
+  }, [searchQuery]);
+
+  useEffect(() => {
+    // Close search on outside click
+    const handleClick = (e) => {
+      if (searchRef.current && !searchRef.current.contains(e.target)) {
+        setShowSearch(false);
+        setSearchQuery('');
+      }
+    };
+    document.addEventListener('mousedown', handleClick);
+    return () => document.removeEventListener('mousedown', handleClick);
+  }, []);
+
+  // Poll unread count every 30s
+  useEffect(() => {
+    const interval = setInterval(loadUnreadCount, 90000);
+    return () => clearInterval(interval);
+  }, []);
+
+  const loadDashboard = async () => {
+    try {
+      const data = await getDashboardSummary(token);
+      setSummary(data);
+      setLiveStats({
+        activeCaregivers: data?.activeCaregivers || 0,
+        todayShifts: data?.todayShifts || 0,
+      });
+    } catch (error) {
+      if (error.message !== 'SESSION_EXPIRED') {
+        console.error('Failed to load dashboard:', error);
+      }
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadUnreadCount = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/push/unread-count`, {
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      if (res.status === 429) return; // rate limited - skip silently
+      if (res.ok) {
+        const data = await res.json();
+        setUnreadCount(data.count || 0);
+      }
+    } catch {}
+  };
+
+  const handlePageClick = (page) => {
+    setCurrentPage(page);
+    setShowSearch(false);
+    setSearchQuery('');
+  };
+
+  const toggleSection = (sectionId) => {
+    setCollapsedSections(prev => ({ ...prev, [sectionId]: !prev[sectionId] }));
+  };
+
+  const handleViewCaregiverProfile = (caregiverId) => {
+    setSelectedCaregiverId(caregiverId);
+    setCurrentPage('caregiver-profile');
+  };
+
+  const handleViewCaregiverHistory = (caregiverId, name) => {
+    setSelectedCaregiverId(caregiverId);
+    setSelectedCaregiverName(name);
+    setCurrentPage('caregiver-history');
+  };
+
+  const renderPage = () => {
+    switch (currentPage) {
+      case 'dashboard': return <DashboardOverview summary={summary} token={token} onNavigate={handlePageClick} />;
+      case 'referrals': return <ReferralSources token={token} />;
+      case 'clients': return <ClientsManagement token={token} />;
+      case 'caregivers': return <CaregiverManagement token={token} onViewProfile={handleViewCaregiverProfile} onViewHistory={handleViewCaregiverHistory} />;
+      case 'billing': return <BillingDashboard token={token} />;
+      case 'scheduling': return <SchedulingHub token={token} />;
+      case 'emergency-coverage': return <EmergencyCoverage token={token} />;
+      case 'route-optimizer': return <RouteOptimizer token={token} />;
+      case 'company-optimizer': return <CompanyOptimizer token={token} />;
+      case 'onboarding': return <ClientOnboarding token={token} />;
+      case 'performance': return <PerformanceRatings token={token} />;
+      case 'applications': return <ApplicationsDashboard token={token} />;
+      case 'care-plans': return <CarePlans token={token} />;
+      case 'incidents': return <IncidentReporting token={token} />;
+      case 'notifications': return <NotificationCenter token={token} />;
+      case 'messages': return <MessageBoard token={token} />;
+      case 'integrations': return <IntegrationsHub token={token} />;
+      case 'compliance': return <ComplianceTracking token={token} />;
+      case 'reports': return <ReportsAnalytics token={token} />;
+      case 'payroll': return <PayrollProcessing token={token} />;
+      case 'expenses': return <ExpenseManagement token={token} />;
+      case 'audit-logs': return <AuditLogs token={token} />;
+      case 'login-activity': return <LoginActivity token={token} />;
+      case 'caregiver-profile': return selectedCaregiverId ? (
+        <CaregiverProfile caregiverId={selectedCaregiverId} token={token}
+          onBack={() => { setSelectedCaregiverId(null); setCurrentPage('caregivers'); }} />
+      ) : null;
+      case 'caregiver-history': return selectedCaregiverId ? (
+        <CaregiverHistory caregiverId={selectedCaregiverId} caregiverName={selectedCaregiverName}
+          token={token} onBack={() => { setSelectedCaregiverId(null); setCurrentPage('caregivers'); }} />
+      ) : null;
+      case 'claims': return <ClaimsManagement token={token} />;
+      case 'medications': return <MedicationsManagement token={token} />;
+      case 'documents': return <DocumentsManagement token={token} />;
+      case 'adl': return <ADLTracking token={token} />;
+      case 'background-checks': return <BackgroundChecks token={token} />;
+      case 'sms': return <SMSManagement token={token} />;
+      case 'family-portal': return <FamilyPortalAdmin token={token} />;
+      case 'alerts': return <AlertsManagement token={token} />;
+      case 'communication-log': return <CommunicationLog token={token} entityType='client' entityId={null} entityName='All Entries' />;
+      case 'no-show-alerts': return <NoShowAlerts token={token} />;
+      case 'form-builder': return <FormBuilder token={token} />;
+      case 'revenue-forecast': return <RevenueForecast token={token} />;
+      default: return <DashboardOverview summary={summary} token={token} onNavigate={handlePageClick} />;
+    }
+  };
+
+  const pageTitle = ALL_ITEMS.find(i => i.id === currentPage)?.label || 'Dashboard';
+
+  return (
+    <div style={{ display: 'flex', width: '100%', height: '100%' }}>
+      {/* Sidebar overlay on mobile */}
+      {sidebarOpen && window.innerWidth <= 768 && (
+        <div className="sidebar-overlay active" onClick={() => setSidebarOpen(false)} />
+      )}
+
+      {/* SIDEBAR */}
+      <div className={`sidebar ${sidebarOpen ? 'open' : ''}`} style={{ width: '260px', minWidth: '260px' }}>
+        <div className="sidebar-logo" style={{ fontSize: '1.4rem', padding: '0 0.5rem 1.5rem 0.5rem' }}>
+          <span>🏥</span> CVHC CRM
+        </div>
+
+        <ul className="sidebar-nav" style={{ paddingBottom: '1rem' }}>
+          {NAV_SECTIONS.map(section => {
+            const isCollapsed = collapsedSections[section.id];
+            const hasActive = section.items.some(i => i.id === currentPage);
+            return (
+              <li key={section.id} style={{ marginBottom: '0.25rem' }}>
+                {/* Section header */}
+                <button
+                  onClick={() => toggleSection(section.id)}
+                  style={{
+                    width: '100%', display: 'flex', alignItems: 'center', justifyContent: 'space-between',
+                    padding: '0.5rem 0.75rem', background: hasActive ? 'rgba(255,255,255,0.1)' : 'none',
+                    border: 'none', cursor: 'pointer', borderRadius: '6px',
+                    color: 'rgba(255,255,255,0.7)', fontSize: '0.72rem', fontWeight: '700',
+                    textTransform: 'uppercase', letterSpacing: '0.07em'
+                  }}
+                >
+                  <span>{section.icon} {section.label}</span>
+                  <span style={{ fontSize: '0.8rem', opacity: 0.7 }}>{isCollapsed ? '▶' : '▼'}</span>
+                </button>
+
+                {/* Section items */}
+                {!isCollapsed && (
+                  <ul style={{ listStyle: 'none', margin: '0.2rem 0 0.5rem 0', padding: 0 }}>
+                    {section.items.map(item => (
+                      <li key={item.id}>
+                        <a
+                          href={`#${item.id}`}
+                          className={currentPage === item.id ? 'active' : ''}
+                          onClick={(e) => { e.preventDefault(); handlePageClick(item.id); }}
+                          style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.45rem 0.75rem 0.45rem 1.25rem', fontSize: '0.875rem' }}
+                        >
+                          <span style={{ fontSize: '0.95rem', width: '18px', textAlign: 'center' }}>{item.icon}</span>
+                          {item.label}
+                        </a>
+                      </li>
+                    ))}
+                  </ul>
+                )}
+              </li>
+            );
+          })}
+        </ul>
+
+        <div className="sidebar-user">
+          <div className="sidebar-user-name">{user.name}</div>
+          <div className="sidebar-user-role">Administrator</div>
+          <button className="btn-logout" onClick={() => { setSidebarOpen(false); onLogout(); }}>
+            Logout
+          </button>
+        </div>
+      </div>
+
+      {/* MAIN CONTENT */}
+      <div className="main-content">
+        {/* HEADER */}
+        <div className="header" style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '0.75rem' }}>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
+            <button
+              className="hamburger-btn"
+              onClick={() => setSidebarOpen(!sidebarOpen)}
+              title="Menu"
+              style={{ padding: '0.4rem 0.75rem', borderRadius: '6px', border: '1px solid #D1D5DB', background: '#fff', cursor: 'pointer', fontSize: '0.85rem', fontWeight: '600' }}
+            >
+              ☰ Menu
+            </button>
+            <div>
+              <h1 style={{ fontSize: '1.15rem', margin: 0 }}>{pageTitle}</h1>
+              <p style={{ margin: 0, fontSize: '0.78rem', color: '#9CA3AF' }}>Chippewa Valley Home Care</p>
+            </div>
+          </div>
+
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
+            {/* Live stats */}
+            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
+              <span style={{ padding: '0.3rem 0.6rem', background: '#F0FDF4', color: '#16A34A', borderRadius: '6px', fontSize: '0.78rem', fontWeight: '600', border: '1px solid #BBF7D0' }}>
+                👥 {liveStats.activeCaregivers} Active
+              </span>
+              {summary?.pendingInvoices?.count > 0 && (
+                <span style={{ padding: '0.3rem 0.6rem', background: '#FEF2F2', color: '#DC2626', borderRadius: '6px', fontSize: '0.78rem', fontWeight: '600', border: '1px solid #FCA5A5' }}>
+                  🧾 {summary.pendingInvoices.count} Invoices
+                </span>
+              )}
+            </div>
+
+            {/* Global search */}
+            <div ref={searchRef} style={{ position: 'relative' }}>
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem', padding: '0.4rem 0.75rem', border: '1px solid #D1D5DB', borderRadius: '8px', background: '#fff', cursor: 'text' }}
+                onClick={() => setShowSearch(true)}>
+                <span style={{ color: '#9CA3AF' }}>🔍</span>
+                <input
+                  placeholder="Search..."
+                  value={searchQuery}
+                  onChange={e => { setSearchQuery(e.target.value); setShowSearch(true); }}
+                  onFocus={() => setShowSearch(true)}
+                  style={{ border: 'none', outline: 'none', fontSize: '0.85rem', width: '140px', background: 'transparent' }}
+                />
+              </div>
+              {showSearch && searchResults.length > 0 && (
+                <div style={{
+                  position: 'absolute', top: 'calc(100% + 4px)', right: 0,
+                  background: '#fff', borderRadius: '8px', border: '1px solid #E5E7EB',
+                  boxShadow: '0 8px 24px rgba(0,0,0,0.12)', zIndex: 999, minWidth: '200px', overflow: 'hidden'
+                }}>
+                  {searchResults.map(item => (
+                    <button key={item.id} onClick={() => handlePageClick(item.id)}
+                      style={{
+                        display: 'flex', alignItems: 'center', gap: '0.6rem', width: '100%',
+                        padding: '0.6rem 0.875rem', border: 'none', background: 'none',
+                        cursor: 'pointer', textAlign: 'left', fontSize: '0.875rem', color: '#374151'
+                      }}
+                      onMouseEnter={e => e.currentTarget.style.background = '#F9FAFB'}
+                      onMouseLeave={e => e.currentTarget.style.background = 'none'}
+                    >
+                      <span>{item.icon}</span> {item.label}
+                    </button>
+                  ))}
+                </div>
+              )}
+            </div>
+
+            {/* Notification bell */}
+            <button
+              onClick={() => handlePageClick('notifications')}
+              style={{
+                position: 'relative', background: 'none', border: '1px solid #D1D5DB',
+                borderRadius: '8px', padding: '0.4rem 0.6rem', cursor: 'pointer', fontSize: '1.1rem'
+              }}
+              title="Notifications"
+            >
+              🔔
+              {unreadCount > 0 && (
+                <span style={{
+                  position: 'absolute', top: '-6px', right: '-6px',
+                  background: '#DC2626', color: '#fff', borderRadius: '99px',
+                  fontSize: '0.65rem', fontWeight: '700', padding: '1px 5px',
+                  minWidth: '18px', textAlign: 'center', lineHeight: '16px'
+                }}>
+                  {unreadCount > 99 ? '99+' : unreadCount}
+                </span>
+              )}
+            </button>
+
+            {/* View As (impersonation) button — only when onImpersonate is available */}
+            {onImpersonate && (
+              <button
+                onClick={() => setShowImpersonation(true)}
+                style={{ background: '#7c3aed', border: 'none', borderRadius: '8px', padding: '0.4rem 0.75rem', cursor: 'pointer', fontSize: '0.85rem', fontWeight: '700', color: '#fff', whiteSpace: 'nowrap' }}
+                title="View app as another user"
+              >
+                👁️ View As
+              </button>
+            )}
+
+            {/* Help button */}
+            <button
+              onClick={() => setShowHelp(true)}
+              style={{ background: '#2ABBA7', border: 'none', borderRadius: '8px', padding: '0.4rem 0.75rem', cursor: 'pointer', fontSize: '0.85rem', fontWeight: '700', color: '#fff' }}
+              title="Help Center"
+            >
+              ❓ Help
+            </button>
+
+            {/* Logout button */}
+            <button
+              onClick={onLogout}
+              style={{ padding: '0.4rem 0.85rem', borderRadius: '8px', border: 'none', background: '#FEE2E2', color: '#DC2626', fontWeight: '700', fontSize: '0.82rem', cursor: 'pointer', whiteSpace: 'nowrap' }}
+              title="Logout"
+            >
+              ⏻ Logout
+            </button>
+          </div>
+        </div>
+
+        <HelpPanel isOpen={showHelp} onClose={() => setShowHelp(false)} currentPage={currentPage} />
+
+        {/* Impersonation modal */}
+        {showImpersonation && (
+          <ImpersonationModal
+            token={token}
+            onImpersonate={(impToken, impUser) => {
+              setShowImpersonation(false);
+              onImpersonate(impToken, impUser);
+            }}
+            onClose={() => setShowImpersonation(false)}
+          />
+        )}
+
+        <div className="container">
+          {loading ? (
+            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
+              {[1,2,3,4].map(i => (
+                <div key={i} className="stat-card" style={{ minHeight: '80px', background: 'linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%)', backgroundSize: '200% 100%', animation: 'shimmer 1.5s infinite' }} />
+              ))}
+              <style>{`@keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }`}</style>
+            </div>
+          ) : renderPage()}
+        </div>
+      </div>
+
+      {/* ── MOBILE BOTTOM NAVIGATION ── */}
+      {window.innerWidth <= 768 && (
+        <>
+          {/* Overlay for more drawer */}
+          {moreDrawerOpen && (
+            <div className="mobile-more-drawer-overlay" onClick={() => setMoreDrawerOpen(false)} />
+          )}
+
+          {/* More Drawer */}
+          <div className={`mobile-more-drawer ${moreDrawerOpen ? 'open' : ''}`}>
+            <div className="mobile-more-drawer-handle" />
+            {NAV_SECTIONS.map(section => (
+              <div key={section.id} className="mobile-more-drawer-section">
+                <div className="mobile-more-drawer-section-title">{section.icon} {section.label}</div>
+                {section.items.map(item => (
+                  <button
+                    key={item.id}
+                    className={`mobile-more-drawer-item ${currentPage === item.id ? 'active' : ''}`}
+                    onClick={() => { handlePageClick(item.id); setMoreDrawerOpen(false); }}
+                  >
+                    <span className="mobile-more-drawer-item-icon">{item.icon}</span>
+                    {item.label}
+                  </button>
+                ))}
+              </div>
+            ))}
+            <div style={{ height: '1rem' }} />
+          </div>
+
+          {/* Bottom Nav Bar */}
+          <nav className="mobile-bottom-nav">
+            {[
+              { id: 'dashboard', icon: '📊', label: 'Home' },
+              { id: 'clients', icon: '👤', label: 'Clients' },
+              { id: 'scheduling', icon: '📅', label: 'Schedule' },
+              { id: 'caregivers', icon: '👥', label: 'Staff' },
+            ].map(item => (
+              <button
+                key={item.id}
+                className={`mobile-bottom-nav-item ${currentPage === item.id ? 'active' : ''}`}
+                onClick={() => { handlePageClick(item.id); setMoreDrawerOpen(false); }}
+              >
+                <span className="mobile-bottom-nav-icon">{item.icon}</span>
+                {item.label}
+              </button>
+            ))}
+            <button
+              className={`mobile-bottom-nav-item ${moreDrawerOpen ? 'active' : ''}`}
+              onClick={() => setMoreDrawerOpen(!moreDrawerOpen)}
+            >
+              <span className="mobile-bottom-nav-icon">☰</span>
+              More
+            </button>
+          </nav>
+        </>
+      )}
+    </div>
+  );
+};
+
+export default AdminDashboard;
diff --git a/templates/crm-homecare/frontend/src/components/ApplicationForm.jsx b/templates/crm-homecare/frontend/src/components/ApplicationForm.jsx
new file mode 100644
index 0000000..0028df5
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/ApplicationForm.jsx
@@ -0,0 +1,539 @@
+// src/components/ApplicationForm.jsx - PUBLIC (no auth required)
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+const ApplicationForm = () => {
+  const [submitted, setSubmitted] = useState(false);
+  const [error, setError] = useState('');
+  const [loading, setLoading] = useState(false);
+  const [formData, setFormData] = useState({
+    // Personal Info
+    firstName: '',
+    lastName: '',
+    email: '',
+    phone: '',
+    dateOfBirth: '',
+    address: '',
+    city: '',
+    state: 'WI',
+    zip: '',
+    ssn: '',
+
+    // Experience
+    yearsOfExperience: '',
+    previousEmployer1: '',
+    jobTitle1: '',
+    employmentDates1: '',
+    previousEmployer2: '',
+    jobTitle2: '',
+    employmentDates2: '',
+    previousEmployer3: '',
+    jobTitle3: '',
+    employmentDates3: '',
+
+    // Certifications
+    hasCNA: false,
+    hasLPN: false,
+    hasRN: false,
+    hasCPR: false,
+    hasFirstAid: false,
+    otherCertifications: '',
+
+    // References
+    reference1Name: '',
+    reference1Phone: '',
+    reference1Relationship: '',
+    reference2Name: '',
+    reference2Phone: '',
+    reference2Relationship: '',
+    reference3Name: '',
+    reference3Phone: '',
+    reference3Relationship: '',
+
+    // Availability
+    availableDaysOfWeek: [],
+    preferredHours: '',
+    canWorkWeekends: false,
+    canWorkNights: false,
+
+    // Expectations & Motivation
+    expectedHourlyRate: '',
+    motivation: '',
+    whyChippewa: '',
+
+    // Agreement
+    agreeToBackgroundCheck: false,
+    agreeToTerms: false
+  });
+
+  const dayLabels = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
+
+  const handleInputChange = (e) => {
+    const { name, value, type, checked } = e.target;
+    setFormData(prev => ({
+      ...prev,
+      [name]: type === 'checkbox' ? checked : value
+    }));
+  };
+
+  const handleDayToggle = (dayIndex) => {
+    setFormData(prev => {
+      const days = [...prev.availableDaysOfWeek];
+      if (days.includes(dayIndex)) {
+        return { ...prev, availableDaysOfWeek: days.filter(d => d !== dayIndex) };
+      } else {
+        return { ...prev, availableDaysOfWeek: [...days, dayIndex].sort() };
+      }
+    });
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+    setLoading(true);
+
+    // Validation
+    if (!formData.firstName || !formData.lastName || !formData.email || !formData.phone) {
+      setError('Please fill in all required fields');
+      setLoading(false);
+      return;
+    }
+
+    if (!formData.agreeToBackgroundCheck || !formData.agreeToTerms) {
+      setError('Please agree to background check and terms');
+      setLoading(false);
+      return;
+    }
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/applications`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify(formData)
+      });
+
+      if (!response.ok) {
+        const data = await response.json();
+        throw new Error(data.error || 'Failed to submit application');
+      }
+
+      setSubmitted(true);
+      setFormData({
+        firstName: '', lastName: '', email: '', phone: '', dateOfBirth: '',
+        address: '', city: '', state: 'WI', zip: '', ssn: '',
+        yearsOfExperience: '', previousEmployer1: '', jobTitle1: '', employmentDates1: '',
+        previousEmployer2: '', jobTitle2: '', employmentDates2: '',
+        previousEmployer3: '', jobTitle3: '', employmentDates3: '',
+        hasCNA: false, hasLPN: false, hasRN: false, hasCPR: false, hasFirstAid: false,
+        otherCertifications: '',
+        reference1Name: '', reference1Phone: '', reference1Relationship: '',
+        reference2Name: '', reference2Phone: '', reference2Relationship: '',
+        reference3Name: '', reference3Phone: '', reference3Relationship: '',
+        availableDaysOfWeek: [], preferredHours: '', canWorkWeekends: false, canWorkNights: false,
+        expectedHourlyRate: '', motivation: '', whyChippewa: '',
+        agreeToBackgroundCheck: false, agreeToTerms: false
+      });
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  if (submitted) {
+    return (
+      <div className="application-container">
+        <div className="success-box">
+          <h2>✅ Application Submitted Successfully!</h2>
+          <p>Thank you for applying to Chippewa Valley Home Care.</p>
+          <p>We will review your application and contact you within 5-7 business days.</p>
+          <p>If you have questions, call us at <strong>(715) 491-1254</strong></p>
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div className="application-container">
+      <div className="application-form-card">
+        <h1>Apply for Employment</h1>
+        <p className="subtitle">Chippewa Valley Home Care is hiring compassionate caregivers</p>
+
+        {error && <div className="alert alert-error">{error}</div>}
+
+        <form onSubmit={handleSubmit}>
+          {/* PERSONAL INFORMATION */}
+          <section className="form-section">
+            <h2>Personal Information *</h2>
+
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>First Name *</label>
+                <input
+                  type="text"
+                  name="firstName"
+                  value={formData.firstName}
+                  onChange={handleInputChange}
+                  required
+                />
+              </div>
+              <div className="form-group">
+                <label>Last Name *</label>
+                <input
+                  type="text"
+                  name="lastName"
+                  value={formData.lastName}
+                  onChange={handleInputChange}
+                  required
+                />
+              </div>
+            </div>
+
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Email *</label>
+                <input
+                  type="email"
+                  name="email"
+                  value={formData.email}
+                  onChange={handleInputChange}
+                  required
+                />
+              </div>
+              <div className="form-group">
+                <label>Phone *</label>
+                <input
+                  type="tel"
+                  name="phone"
+                  value={formData.phone}
+                  onChange={handleInputChange}
+                  required
+                />
+              </div>
+            </div>
+
+            <div className="form-grid-2">
+              <div className="form-group">
+                <label>Date of Birth</label>
+                <input
+                  type="date"
+                  name="dateOfBirth"
+                  value={formData.dateOfBirth}
+                  onChange={handleInputChange}
+                />
+              </div>
+              <div className="form-group">
+                <label>Social Security Number</label>
+                <input
+                  type="text"
+                  name="ssn"
+                  placeholder="XXX-XX-XXXX"
+                  value={formData.ssn}
+                  onChange={handleInputChange}
+                />
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Address</label>
+              <input
+                type="text"
+                name="address"
+                value={formData.address}
+                onChange={handleInputChange}
+              />
+            </div>
+
+            <div className="form-grid-3">
+              <div className="form-group">
+                <label>City</label>
+                <input
+                  type="text"
+                  name="city"
+                  value={formData.city}
+                  onChange={handleInputChange}
+                />
+              </div>
+              <div className="form-group">
+                <label>State</label>
+                <input
+                  type="text"
+                  name="state"
+                  maxLength="2"
+                  value={formData.state}
+                  onChange={handleInputChange}
+                />
+              </div>
+              <div className="form-group">
+                <label>Zip Code</label>
+                <input
+                  type="text"
+                  name="zip"
+                  value={formData.zip}
+                  onChange={handleInputChange}
+                />
+              </div>
+            </div>
+          </section>
+
+          {/* EXPERIENCE */}
+          <section className="form-section">
+            <h2>Work Experience</h2>
+
+            <div className="form-group">
+              <label>Years of Experience in Home Care</label>
+              <input
+                type="number"
+                name="yearsOfExperience"
+                min="0"
+                value={formData.yearsOfExperience}
+                onChange={handleInputChange}
+              />
+            </div>
+
+            <h3>Previous Employers</h3>
+            {[1, 2, 3].map(num => (
+              <div key={num} className="employer-section">
+                <div className="form-grid-2">
+                  <div className="form-group">
+                    <label>Employer {num}</label>
+                    <input
+                      type="text"
+                      name={`previousEmployer${num}`}
+                      value={formData[`previousEmployer${num}`]}
+                      onChange={handleInputChange}
+                    />
+                  </div>
+                  <div className="form-group">
+                    <label>Job Title</label>
+                    <input
+                      type="text"
+                      name={`jobTitle${num}`}
+                      value={formData[`jobTitle${num}`]}
+                      onChange={handleInputChange}
+                    />
+                  </div>
+                </div>
+                <div className="form-group">
+                  <label>Employment Dates</label>
+                  <input
+                    type="text"
+                    placeholder="e.g., Jan 2020 - Dec 2022"
+                    name={`employmentDates${num}`}
+                    value={formData[`employmentDates${num}`]}
+                    onChange={handleInputChange}
+                  />
+                </div>
+              </div>
+            ))}
+          </section>
+
+          {/* CERTIFICATIONS */}
+          <section className="form-section">
+            <h2>Certifications & Licenses</h2>
+
+            <div className="checkbox-grid">
+              {[
+                { key: 'hasCNA', label: 'Certified Nursing Assistant (CNA)' },
+                { key: 'hasLPN', label: 'Licensed Practical Nurse (LPN)' },
+                { key: 'hasRN', label: 'Registered Nurse (RN)' },
+                { key: 'hasCPR', label: 'CPR Certification' },
+                { key: 'hasFirstAid', label: 'First Aid Certification' }
+              ].map(cert => (
+                <label key={cert.key} className="checkbox-label">
+                  <input
+                    type="checkbox"
+                    name={cert.key}
+                    checked={formData[cert.key]}
+                    onChange={handleInputChange}
+                  />
+                  <span>{cert.label}</span>
+                </label>
+              ))}
+            </div>
+
+            <div className="form-group">
+              <label>Other Certifications</label>
+              <input
+                type="text"
+                name="otherCertifications"
+                placeholder="e.g., Dementia Care, Medication Management..."
+                value={formData.otherCertifications}
+                onChange={handleInputChange}
+              />
+            </div>
+          </section>
+
+          {/* REFERENCES */}
+          <section className="form-section">
+            <h2>Professional References</h2>
+            <p className="subtitle">Please provide 3 professional references</p>
+
+            {[1, 2, 3].map(num => (
+              <div key={num} className="reference-section">
+                <h3>Reference {num}</h3>
+                <div className="form-grid-2">
+                  <div className="form-group">
+                    <label>Name</label>
+                    <input
+                      type="text"
+                      name={`reference${num}Name`}
+                      value={formData[`reference${num}Name`]}
+                      onChange={handleInputChange}
+                    />
+                  </div>
+                  <div className="form-group">
+                    <label>Phone</label>
+                    <input
+                      type="tel"
+                      name={`reference${num}Phone`}
+                      value={formData[`reference${num}Phone`]}
+                      onChange={handleInputChange}
+                    />
+                  </div>
+                </div>
+                <div className="form-group">
+                  <label>Relationship</label>
+                  <input
+                    type="text"
+                    placeholder="e.g., Former Supervisor, Manager..."
+                    name={`reference${num}Relationship`}
+                    value={formData[`reference${num}Relationship`]}
+                    onChange={handleInputChange}
+                  />
+                </div>
+              </div>
+            ))}
+          </section>
+
+          {/* AVAILABILITY */}
+          <section className="form-section">
+            <h2>Availability</h2>
+
+            <div className="form-group">
+              <label>Days You Can Work *</label>
+              <div className="checkbox-grid">
+                {dayLabels.map((day, idx) => (
+                  <label key={idx} className="checkbox-label">
+                    <input
+                      type="checkbox"
+                      checked={formData.availableDaysOfWeek.includes(idx)}
+                      onChange={() => handleDayToggle(idx)}
+                    />
+                    <span>{day}</span>
+                  </label>
+                ))}
+              </div>
+            </div>
+
+            <div className="form-group">
+              <label>Preferred Hours</label>
+              <input
+                type="text"
+                name="preferredHours"
+                placeholder="e.g., 8am-5pm, flexible, part-time..."
+                value={formData.preferredHours}
+                onChange={handleInputChange}
+              />
+            </div>
+
+            <div className="checkbox-grid">
+              <label className="checkbox-label">
+                <input
+                  type="checkbox"
+                  name="canWorkWeekends"
+                  checked={formData.canWorkWeekends}
+                  onChange={handleInputChange}
+                />
+                <span>Available for weekend work</span>
+              </label>
+              <label className="checkbox-label">
+                <input
+                  type="checkbox"
+                  name="canWorkNights"
+                  checked={formData.canWorkNights}
+                  onChange={handleInputChange}
+                />
+                <span>Available for night shifts</span>
+              </label>
+            </div>
+          </section>
+
+          {/* EXPECTATIONS & MOTIVATION */}
+          <section className="form-section">
+            <h2>Expectations & Motivation</h2>
+
+            <div className="form-group">
+              <label>Expected Hourly Rate</label>
+              <input
+                type="text"
+                name="expectedHourlyRate"
+                placeholder="e.g., $15/hour, negotiable..."
+                value={formData.expectedHourlyRate}
+                onChange={handleInputChange}
+              />
+            </div>
+
+            <div className="form-group">
+              <label>Why are you interested in this position?</label>
+              <textarea
+                name="motivation"
+                placeholder="Tell us about your passion for care work..."
+                rows="4"
+                value={formData.motivation}
+                onChange={handleInputChange}
+              ></textarea>
+            </div>
+
+            <div className="form-group">
+              <label>Why Chippewa Valley Home Care?</label>
+              <textarea
+                name="whyChippewa"
+                placeholder="What appeals to you about working with our company?"
+                rows="4"
+                value={formData.whyChippewa}
+                onChange={handleInputChange}
+              ></textarea>
+            </div>
+          </section>
+
+          {/* AGREEMENTS */}
+          <section className="form-section">
+            <h2>Agreements *</h2>
+
+            <label className="checkbox-label full-width">
+              <input
+                type="checkbox"
+                name="agreeToBackgroundCheck"
+                checked={formData.agreeToBackgroundCheck}
+                onChange={handleInputChange}
+                required
+              />
+              <span>I agree to a background check and reference verification *</span>
+            </label>
+
+            <label className="checkbox-label full-width">
+              <input
+                type="checkbox"
+                name="agreeToTerms"
+                checked={formData.agreeToTerms}
+                onChange={handleInputChange}
+                required
+              />
+              <span>I certify that the information provided is true and accurate *</span>
+            </label>
+          </section>
+
+          {/* SUBMIT */}
+          <div className="form-actions">
+            <button type="submit" className="btn btn-primary btn-large" disabled={loading}>
+              {loading ? 'Submitting...' : 'Submit Application'}
+            </button>
+          </div>
+        </form>
+      </div>
+    </div>
+  );
+};
+
+export default ApplicationForm;
diff --git a/templates/crm-homecare/frontend/src/components/CaregiverDashboard.jsx b/templates/crm-homecare/frontend/src/components/CaregiverDashboard.jsx
new file mode 100644
index 0000000..dee2ee2
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/CaregiverDashboard.jsx
@@ -0,0 +1,1172 @@
+// src/components/CaregiverDashboard.jsx
+// Enhanced with self-service: availability, open shifts pickup, time off requests
+import React, { useState, useEffect, useRef, useCallback } from 'react';
+import { API_BASE_URL } from '../config';
+import { toast } from './Toast';
+import CaregiverClientModal from './CaregiverClientModal';
+import MileageTracker from './MileageTracker';
+import ShiftMissReport from './caregiver/ShiftMissReport';
+import CaregiverHelp from './caregiver/CaregiverHelp';
+import CaregiverMessages from './caregiver/CaregiverMessages';
+import { useGeolocation, useHaptics, useOfflineSync, useBackgroundGeolocation, isNative, platform } from '../hooks/useNative';
+import OfflineBanner from './OfflineBanner';
+
+const subscribeToPush = async (token) => {
+  try {
+    if (!('serviceWorker' in navigator) || !('PushManager' in window)) return;
+    const reg = await navigator.serviceWorker.ready;
+    const vapidRes = await fetch(`${API_BASE_URL}/api/push/vapid-key`, { headers: { Authorization: `Bearer ${token}` } });
+    const { publicKey } = await vapidRes.json();
+    if (!publicKey || publicKey === 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') return;
+    const subscription = await reg.pushManager.subscribe({
+      userVisibleOnly: true,
+      applicationServerKey: publicKey,
+    });
+    await fetch(`${API_BASE_URL}/api/push/subscribe`, {
+      method: 'POST', headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
+      body: JSON.stringify({ subscription }),
+    });
+  } catch (e) {
+    console.log('[Push] subscription skipped:', e.message);
+  }
+};
+
+const CaregiverDashboard = ({ user, token, onLogout }) => {
+  const [currentPage, setCurrentPage] = useState('home');
+  const [schedules, setSchedules] = useState([]);
+  const [clients, setClients] = useState([]);
+  const [activeSession, setActiveSession] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [selectedClient, setSelectedClient] = useState('');
+  const [sidebarOpen, setSidebarOpen] = useState(false);
+  const [elapsedTime, setElapsedTime] = useState(0);
+  const [visitNote, setVisitNote] = useState('');
+  const [showNoteModal, setShowNoteModal] = useState(false);
+  const [recentVisits, setRecentVisits] = useState([]);
+  const [viewingClientId, setViewingClientId] = useState(null);
+  const timerRef = useRef(null);
+
+  // Native GPS — works on web AND iOS/Android
+  const { position: location, error: locationError, getPosition } = useGeolocation({ watch: true });
+  const { impact, notification: hapticNotify } = useHaptics();
+  const { online, queueCount } = useOfflineSync();
+  const { start: startBgGeo } = useBackgroundGeolocation();
+
+  // Self-service state
+  const [openShifts, setOpenShifts] = useState([]);
+  const [myHoursThisWeek, setMyHoursThisWeek] = useState(0);
+  const [availability, setAvailability] = useState({
+    status: 'available',
+    maxHoursPerWeek: 40,
+    weeklyAvailability: {
+      0: { available: false, start: '09:00', end: '17:00' },
+      1: { available: true, start: '09:00', end: '17:00' },
+      2: { available: true, start: '09:00', end: '17:00' },
+      3: { available: true, start: '09:00', end: '17:00' },
+      4: { available: true, start: '09:00', end: '17:00' },
+      5: { available: true, start: '09:00', end: '17:00' },
+      6: { available: false, start: '09:00', end: '17:00' }
+    },
+    notes: ''
+  });
+  const [timeOffRequests, setTimeOffRequests] = useState([]);
+  const [newTimeOff, setNewTimeOff] = useState({ startDate: '', endDate: '', reason: '' });
+  const [message, setMessage] = useState({ text: '', type: '' });
+  const [showMissReport, setShowMissReport] = useState(false);
+  const [showHelp, setShowHelp] = useState(false);
+  const [showMessages, setShowMessages] = useState(false);
+  const [unreadMessages, setUnreadMessages] = useState(0);
+  const [showMoreDrawer, setShowMoreDrawer] = useState(false);
+
+  useEffect(() => {
+    loadData();
+    // GPS tracking handled by useGeolocation hook (watch: true)
+    subscribeToPush(token);
+    // Start background geolocation on Android so geofence works when screen is off
+    startBgGeo({
+      notificationTitle: 'CVHC HomeCare',
+      notificationText: 'Monitoring location for auto clock-in',
+      onLocation: (loc) => {
+        // Background location updates feed into the geofence check
+        // The geofence polling useEffect will pick up the latest position
+      }
+    });
+    return () => {
+      if (timerRef.current) clearInterval(timerRef.current);
+    };
+  }, []);
+
+  // Poll for unread messages
+  useEffect(() => {
+    const checkUnread = async () => {
+      try {
+        const res = await fetch(`${API_BASE_URL}/api/messages/unread-count`, {
+          headers: { Authorization: `Bearer ${token}` }
+        });
+        if (res.status === 429) return; // rate limited - skip
+        if (res.ok) { const data = await res.json(); setUnreadMessages(data.count); }
+      } catch (e) { }
+    };
+    checkUnread();
+    const interval = setInterval(checkUnread, 90000);
+    return () => clearInterval(interval);
+  }, [token]);
+
+  useEffect(() => {
+    if (activeSession) {
+      timerRef.current = setInterval(() => {
+        const start = new Date(activeSession.start_time);
+        const now = new Date();
+        setElapsedTime(Math.floor((now - start) / 1000));
+      }, 1000);
+    } else {
+      if (timerRef.current) clearInterval(timerRef.current);
+      setElapsedTime(0);
+    }
+    return () => {
+      if (timerRef.current) clearInterval(timerRef.current);
+    };
+  }, [activeSession]);
+
+  useEffect(() => {
+    if (window.innerWidth <= 768) {
+      setSidebarOpen(false);
+    }
+  }, [currentPage]);
+
+  useEffect(() => {
+    if (currentPage === 'open-shifts') loadOpenShifts();
+    if (currentPage === 'availability') loadAvailability();
+    if (currentPage === 'time-off') loadTimeOffRequests();
+  }, [currentPage]);
+
+  const loadData = async () => {
+    try {
+      const [schedulesRes, clientsRes, activeRes, visitsRes] = await Promise.all([
+        fetch(`${API_BASE_URL}/api/schedules/${user.id}`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/clients`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }),
+        fetch(`${API_BASE_URL}/api/time-entries/active`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }).catch(() => ({ ok: false })),
+        fetch(`${API_BASE_URL}/api/time-entries/recent?limit=10`, {
+          headers: { 'Authorization': `Bearer ${token}` }
+        }).catch(() => ({ ok: false }))
+      ]);
+
+      if (schedulesRes.ok) setSchedules(await schedulesRes.json());
+      if (clientsRes.ok) setClients(await clientsRes.json());
+      if (activeRes.ok) {
+        const data = await activeRes.json();
+        if (data?.id) {
+          setActiveSession(data);
+          setSelectedClient(data.client_id);
+        }
+      }
+      if (visitsRes.ok) setRecentVisits(await visitsRes.json());
+      loadMyHours();
+    } catch (error) {
+      console.error('Failed to load data:', error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const loadOpenShifts = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/available`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) setOpenShifts(await res.json());
+    } catch (error) {
+      console.error('Failed to load open shifts:', error);
+    }
+  };
+
+  const loadAvailability = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregivers/${user.id}/availability`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        const data = await res.json();
+        if (data) {
+          setAvailability(prev => ({
+            status: data.status || prev.status,
+            maxHoursPerWeek: data.max_hours_per_week || prev.maxHoursPerWeek,
+            weeklyAvailability: data.weekly_availability ? 
+              (typeof data.weekly_availability === 'string' ? JSON.parse(data.weekly_availability) : data.weekly_availability) 
+              : prev.weeklyAvailability,
+            notes: data.notes || ''
+          }));
+        }
+      }
+    } catch (error) {
+      console.error('Failed to load availability:', error);
+    }
+  };
+
+  const loadTimeOffRequests = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/absences/my`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) setTimeOffRequests(await res.json());
+    } catch (error) {
+      console.error('Failed to load time off:', error);
+    }
+  };
+
+  const loadMyHours = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/scheduling/caregiver-hours/${user.id}`, {
+        headers: { 'Authorization': `Bearer ${token}` }
+      });
+      if (res.ok) {
+        const data = await res.json();
+        setMyHoursThisWeek(parseFloat(data.totalHours) || 0);
+      }
+    } catch (error) {
+      console.error('Failed to load hours:', error);
+    }
+  };
+
+  const showMsg = (text, type = 'success') => {
+    setMessage({ text, type });
+    setTimeout(() => setMessage({ text: '', type: '' }), 4000);
+  };
+
+  const startGPSTracking = () => {
+    if ('geolocation' in navigator) {
+      navigator.geolocation.watchPosition(
+        (pos) => {
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+          setLocationError(null);
+        },
+        (err) => setLocationError(err.message),
+        { enableHighAccuracy: true, maximumAge: 5000, timeout: 10000 }
+      );
+    }
+  };
+
+  // Push GPS breadcrumbs every 60 seconds during active shift
+  const startGPSBreadcrumbs = (sessionId) => {
+    if (!("geolocation" in navigator)) return;
+    const interval = setInterval(() => {
+      // GPS breadcrumb
+      navigator.geolocation.getCurrentPosition(
+        (pos) => {
+          fetch(`${API_BASE_URL}/api/time-entries/${sessionId}/gps`, {
+            method: "POST",
+            headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` },
+            body: JSON.stringify({ latitude: pos.coords.latitude, longitude: pos.coords.longitude, accuracy: pos.coords.accuracy, speed: pos.coords.speed, heading: pos.coords.heading })
+          }).catch(() => {});
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+        },
+        () => {},
+        { enableHighAccuracy: true, timeout: 10000 }
+      );
+
+      // 15-minute shift warning check (runs every 60s alongside GPS)
+      fetch(`${API_BASE_URL}/api/time-entries/check-warnings`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ timeEntryId: sessionId })
+      })
+      .then(r => r.json())
+      .then(d => {
+        if (d.warning && !d.overTime) {
+          // 15-min warning - show in-app alert
+          toast(`⏰ ${d.minutesRemaining} min remaining — start wrapping up your shift!`, 'warning');
+        } else if (d.warning && d.overTime) {
+          toast(`⚠️ You are ${d.minutesOver} min over your scheduled time — please clock out`, 'error');
+        }
+      })
+      .catch(() => {});
+
+    }, 60000); // every 60s
+    return interval;
+  };
+  const gpsIntervalRef = React.useRef(null);
+  const geofenceIntervalRef = React.useRef(null);
+  const geofenceTriggeredRef = React.useRef(new Set()); // track which clients we've already auto-clocked for
+
+  const _startGPSTracking_REMOVED = () => {
+    if ("geolocation" in navigator) {
+      navigator.geolocation.watchPosition(
+        (pos) => {
+          setLocation({ lat: pos.coords.latitude, lng: pos.coords.longitude, accuracy: pos.coords.accuracy });
+          setLocationError(null);
+        },
+        (err) => setLocationError(err.message),
+        { enableHighAccuracy: true, maximumAge: 5000, timeout: 10000 }
+      );
+    } else {
+      setLocationError('Geolocation not supported');
+    }
+  };
+
+  // ── GEOFENCE AUTO CLOCK-IN/OUT ────────────────────────────────────────────
+  const runGeofenceCheck = async (currentLocation, currentSession, currentClients, currentSchedules) => {
+    if (!currentLocation?.lat && !currentLocation?.latitude) return;
+    const lat = currentLocation.lat || currentLocation.latitude;
+    const lng = currentLocation.lng || currentLocation.longitude;
+
+    // Get today's day of week
+    const todayDay = new Date().getDay();
+    const now = new Date();
+    const nowMins = now.getHours() * 60 + now.getMinutes();
+
+    // Find clients scheduled for today (from recurring schedules)
+    const todayClients = (currentSchedules || [])
+      .filter(s => s.day_of_week === todayDay || 
+        (s.date && new Date(s.date).toDateString() === now.toDateString()))
+      .map(s => s.client_id)
+      .filter(Boolean);
+
+    if (!todayClients.length) return;
+
+    for (const clientId of todayClients) {
+      const alreadyTriggered = geofenceTriggeredRef.current.has(clientId);
+
+      try {
+        const res = await fetch(`${API_BASE_URL}/api/route-optimizer/geofence/check`, {
+          method: 'POST',
+          headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+          body: JSON.stringify({ clientId, latitude: lat, longitude: lng })
+        });
+        if (!res.ok) continue;
+        const data = await res.json();
+
+        // AUTO CLOCK-IN: within geofence, not clocked in, not already triggered
+        if (data.withinGeofence && data.autoClockIn && !currentSession && !alreadyTriggered) {
+          geofenceTriggeredRef.current.add(clientId);
+          toast(`📍 You've arrived at ${data.clientName} — clocking you in automatically`, 'success');
+          // Auto clock in
+          const clockRes = await fetch(`${API_BASE_URL}/api/time-entries/clock-in`, {
+            method: 'POST',
+            headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+            body: JSON.stringify({ clientId, latitude: lat, longitude: lng, autoClockIn: true })
+          });
+          if (clockRes.ok) {
+            const clockData = await clockRes.json();
+            setActiveSession(clockData);
+            setSelectedClient(clientId);
+            gpsIntervalRef.current = startGPSBreadcrumbs(clockData.id);
+          }
+          break; // only clock into one client at a time
+        }
+
+        // AUTO CLOCK-OUT: was within geofence but now left, currently clocked into this client
+        if (!data.withinGeofence && data.autoClockOut && currentSession?.client_id === clientId && alreadyTriggered) {
+          // Only auto clock-out if they've been there at least 10 minutes
+          const sessionStart = new Date(currentSession.start_time);
+          const minsElapsed = (now - sessionStart) / 60000;
+          if (minsElapsed >= 10) {
+            toast(`📍 You've left ${data.clientName}'s location — clocking you out automatically`, 'success');
+            geofenceTriggeredRef.current.delete(clientId);
+            setShowNoteModal(true); // prompt for visit note before clocking out
+          }
+        }
+      } catch(e) {
+        // Silently fail — don't interrupt the caregiver
+      }
+    }
+  };
+
+  // Start geofence polling when location is available
+  useEffect(() => {
+    if (!location) return;
+    // Run immediately on location change
+    runGeofenceCheck(location, activeSession, clients, schedules);
+    // Also run on interval every 30 seconds
+    if (!geofenceIntervalRef.current) {
+      geofenceIntervalRef.current = setInterval(() => {
+        runGeofenceCheck(location, activeSession, clients, schedules);
+      }, 30000);
+    }
+    return () => {
+      if (geofenceIntervalRef.current) {
+        clearInterval(geofenceIntervalRef.current);
+        geofenceIntervalRef.current = null;
+      }
+    };
+  }, [location, activeSession, clients, schedules]);
+
+  const handleClockIn = async () => {
+    if (!selectedClient) return toast('Please select a client.');
+
+    try {
+      // Get fresh position if we don't have one
+      let lat = location?.latitude || null;
+      let lng = location?.longitude || null;
+      if (!lat) {
+        await getPosition();
+        lat = location?.latitude || null;
+        lng = location?.longitude || null;
+      }
+
+      await impact('medium'); // native haptic on button press
+
+      const res = await fetch(`${API_BASE_URL}/api/time-entries/clock-in`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ clientId: selectedClient, latitude: lat, longitude: lng })
+      });
+
+      if (!res.ok) {
+        // If offline, service worker queued it — res will have queued:true
+        const data = await res.json();
+        if (data.queued) {
+          await hapticNotify('warning');
+          toast('Clocked in offline — will sync when reconnected', 'warning');
+          setActiveSession({ id: 'offline-' + Date.now(), offline: true });
+          return;
+        }
+        throw new Error(data.error || 'Failed');
+      }
+
+      const clockInData = await res.json();
+      await hapticNotify('success'); // success haptic
+      setActiveSession(clockInData);
+      gpsIntervalRef.current = startGPSBreadcrumbs(clockInData.id);
+      if (!lat) toast('Clocked in (location unavailable)', 'warning');
+    } catch (error) {
+      await hapticNotify('error');
+      toast('Failed to clock in: ' + error.message, 'error');
+    }
+  };
+
+  const handleClockOut = () => {
+    if (!activeSession) return toast('No active session.');
+    setShowNoteModal(true);
+  };
+
+  const completeClockOut = async () => {
+    try {
+      await impact('heavy'); // strong haptic for clock out
+
+      const lat = location?.latitude || null;
+      const lng = location?.longitude || null;
+
+      const res = await fetch(`${API_BASE_URL}/api/time-entries/${activeSession.id}/clock-out`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({ latitude: lat, longitude: lng, notes: visitNote })
+      });
+
+      if (!res.ok) {
+        const data = await res.json();
+        if (data.queued) {
+          await hapticNotify('warning');
+          toast('Clocked out offline — will sync when reconnected', 'warning');
+          setActiveSession(null);
+          setSelectedClient('');
+          setVisitNote('');
+          setShowNoteModal(false);
+          return;
+        }
+        throw new Error(data.error || 'Failed');
+      }
+
+      await hapticNotify('success');
+      setActiveSession(null);
+      setSelectedClient('');
+      setVisitNote('');
+      setShowNoteModal(false);
+      loadData();
+    } catch (error) {
+      await hapticNotify('error');
+      toast('Failed to clock out: ' + error.message, 'error');
+    }
+  };
+
+  const handlePickupShift = async (shiftId) => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/open-shifts/${shiftId}/claim`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }
+      });
+      if (!res.ok) throw new Error((await res.json()).error || 'Failed');
+      showMsg('Shift claimed!');
+      loadOpenShifts();
+      loadData();
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handleSaveAvailability = async () => {
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/caregiver-availability/${user.id}`, {
+        method: 'PUT',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          status: availability.status,
+          maxHoursPerWeek: availability.maxHoursPerWeek,
+          weeklyAvailability: availability.weeklyAvailability,
+          notes: availability.notes
+        })
+      });
+      if (!res.ok) throw new Error('Failed');
+      showMsg('Availability saved!');
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handleRequestTimeOff = async (e) => {
+    e.preventDefault();
+    if (!newTimeOff.startDate || !newTimeOff.endDate) return showMsg('Select dates', 'error');
+
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/absences`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
+        body: JSON.stringify({
+          caregiverId: user.id,
+          absenceType: 'time_off_request',
+          startDate: newTimeOff.startDate,
+          endDate: newTimeOff.endDate,
+          reason: newTimeOff.reason,
+          status: 'pending'
+        })
+      });
+      if (!res.ok) throw new Error('Failed');
+      showMsg('Request submitted!');
+      setNewTimeOff({ startDate: '', endDate: '', reason: '' });
+      loadTimeOffRequests();
+    } catch (error) {
+      showMsg(error.message, 'error');
+    }
+  };
+
+  const handlePageClick = (page) => {
+    setCurrentPage(page);
+    if (window.innerWidth <= 768) setSidebarOpen(false);
+  };
+
+  const getClientName = (id) => {
+    const c = clients.find(c => c.id === id);
+    return c ? `${c.first_name} ${c.last_name}` : 'Unknown';
+  };
+
+  const formatTime = (t) => {
+    if (!t) return '';
+    const [h, m] = t.split(':');
+    const hr = parseInt(h);
+    return `${hr % 12 || 12}:${m} ${hr >= 12 ? 'PM' : 'AM'}`;
+  };
+
+  const formatElapsed = (s) => {
+    const h = Math.floor(s / 3600);
+    const m = Math.floor((s % 3600) / 60);
+    const sec = s % 60;
+    return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
+  };
+
+  const formatDate = (d) => d ? new Date(d).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }) : '';
+  const getDayName = (n) => ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][n] || '';
+
+  // Get today's appointments from schedules
+  const getTodaysAppointments = () => {
+    const today = new Date();
+    const dayOfWeek = today.getDay();
+    const todayStr = today.toISOString().split('T')[0];
+    
+    // Get recurring schedules for today's day of week
+    const recurring = schedules.filter(s => s.day_of_week === dayOfWeek);
+    // Get one-time schedules for today's date
+    const oneTime = schedules.filter(s => s.date && s.date.split('T')[0] === todayStr);
+    
+    return [...recurring, ...oneTime].sort((a, b) => {
+      const timeA = a.start_time || '00:00';
+      const timeB = b.start_time || '00:00';
+      return timeA.localeCompare(timeB);
+    });
+  };
+
+  const getClientById = (id) => clients.find(c => c.id === id);
+
+  // RENDER PAGES
+  const renderHomePage = () => {
+    const todaysAppointments = getTodaysAppointments();
+    
+    return (
+    <>
+      <div className="card" style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', color: '#fff', marginBottom: '1rem' }}>
+        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+          <div>
+            <div style={{ fontSize: '0.9rem', opacity: 0.9 }}>Hours This Week</div>
+            <div style={{ fontSize: '2rem', fontWeight: 'bold' }}>{myHoursThisWeek.toFixed(2)}h</div>
+          </div>
+          <div style={{ fontSize: '3rem', opacity: 0.5 }}>⏱️</div>
+        </div>
+        {myHoursThisWeek > 35 && (
+          <div style={{ marginTop: '0.5rem', padding: '0.5rem', background: 'rgba(255,255,255,0.2)', borderRadius: '6px', fontSize: '0.85rem' }}>
+            ⚠️ Approaching 40 hour limit
+          </div>
+        )}
+      </div>
+
+      {/* Today's Appointments Section */}
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <div className="card-title">📅 Today's Appointments</div>
+        {todaysAppointments.length === 0 ? (
+          <p className="text-muted text-center" style={{ padding: '1rem 0' }}>No appointments scheduled for today</p>
+        ) : (
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+            {todaysAppointments.map((appt, idx) => {
+              const client = getClientById(appt.client_id);
+              const isCurrentClient = activeSession?.client_id === appt.client_id;
+              return (
+                <div 
+                  key={appt.id || idx} 
+                  style={{ 
+                    padding: '1rem', 
+                    borderRadius: '8px', 
+                    background: isCurrentClient ? '#DBEAFE' : '#F9FAFB',
+                    border: isCurrentClient ? '2px solid #2563eb' : '1px solid #E5E7EB'
+                  }}
+                >
+                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                    <div style={{ flex: 1 }}>
+                      <div style={{ fontWeight: '600', fontSize: '1.1rem', color: '#1F2937' }}>
+                        {client ? `${client.first_name} ${client.last_name}` : 'Unknown Client'}
+                        {isCurrentClient && <span style={{ marginLeft: '0.5rem', color: '#059669', fontSize: '0.85rem' }}>● Active</span>}
+                      </div>
+                      <div style={{ fontSize: '0.9rem', color: '#6B7280', marginTop: '0.25rem' }}>
+                        🕐 {formatTime(appt.start_time)} - {formatTime(appt.end_time)}
+                      </div>
+                      {client && (
+                        <div style={{ fontSize: '0.85rem', color: '#6B7280', marginTop: '0.5rem' }}>
+                          {client.phone && <span>📞 {client.phone}</span>}
+                          {client.address && <span style={{ marginLeft: client.phone ? '1rem' : 0 }}>📍 {client.address}{client.city ? `, ${client.city}` : ''}</span>}
+                        </div>
+                      )}
+                      {appt.notes && (
+                        <div style={{ fontSize: '0.85rem', color: '#4B5563', marginTop: '0.5rem', padding: '0.5rem', background: '#FEF3C7', borderRadius: '4px' }}>
+                          📝 {appt.notes}
+                        </div>
+                      )}
+                    </div>
+                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem', marginLeft: '1rem' }}>
+                      <button 
+                        className="btn btn-sm" 
+                        style={{ background: '#E5E7EB', color: '#374151', padding: '0.4rem 0.75rem' }}
+                        onClick={() => setViewingClientId(appt.client_id)}
+                      >
+                        View
+                      </button>
+                      {!activeSession && (
+                        <button 
+                          className="btn btn-sm btn-primary" 
+                          style={{ padding: '0.4rem 0.75rem' }}
+                          onClick={() => setSelectedClient(appt.client_id)}
+                        >
+                          Select
+                        </button>
+                      )}
+                    </div>
+                  </div>
+                </div>
+              );
+            })}
+          </div>
+        )}
+      </div>
+
+      {/* MOBILE-FIRST CLOCK-IN — Full prominent card */}
+      <div className="card" style={{ padding: 0, overflow: 'hidden' }}>
+        {activeSession ? (
+          // ACTIVE SESSION — big timer, center-stage
+          <div style={{ textAlign: 'center', padding: '2rem 1.5rem', background: 'linear-gradient(135deg, #F0FDF4, #DCFCE7)' }}>
+            <div style={{ fontSize: '0.9rem', color: '#166534', fontWeight: '600', marginBottom: '0.25rem' }}>
+              🟢 Clocked In with {getClientName(activeSession.client_id)}
+            </div>
+            <div style={{ fontSize: '4rem', fontWeight: '900', fontFamily: 'monospace', color: '#16A34A', lineHeight: 1.1, margin: '0.5rem 0' }}>
+              {formatElapsed(elapsedTime)}
+            </div>
+            <div style={{ fontSize: '0.82rem', color: '#4B5563', marginBottom: '1.5rem' }}>
+              {location ? `📍 GPS Active (±${location.accuracy?.toFixed(0)}m)` : '📍 Location unavailable'}
+            </div>
+            <button
+              onClick={handleClockOut}
+              style={{
+                width: '100%', padding: '1.125rem', background: '#DC2626', color: '#fff',
+                border: 'none', borderRadius: '12px', cursor: 'pointer',
+                fontWeight: '800', fontSize: '1.15rem', letterSpacing: '0.02em',
+                boxShadow: '0 4px 12px rgba(220,38,38,0.3)'
+              }}
+            >
+              🛑 Clock Out
+            </button>
+          </div>
+        ) : (
+          // CLOCK IN — prominent select + button
+          <div style={{ padding: '1.5rem' }}>
+            <div style={{ fontSize: '1.1rem', fontWeight: '800', color: '#111827', marginBottom: '1rem', textAlign: 'center' }}>
+              ⏰ Ready to Start a Shift?
+            </div>
+            <div className="form-group" style={{ marginBottom: '0.875rem' }}>
+              <label style={{ fontWeight: '700', fontSize: '0.9rem', color: '#374151' }}>Select Client *</label>
+              <select
+                value={selectedClient}
+                onChange={(e) => setSelectedClient(e.target.value)}
+                style={{ width: '100%', padding: '0.875rem', fontSize: '1rem', border: '2px solid #D1D5DB', borderRadius: '10px', background: '#fff', boxSizing: 'border-box' }}
+              >
+                <option value="">Choose client...</option>
+                {clients.map(c => <option key={c.id} value={c.id}>{c.first_name} {c.last_name}</option>)}
+              </select>
+            </div>
+            <div style={{ padding: '0.6rem 0.875rem', background: location ? '#F0FDF4' : '#F9FAFB', borderRadius: '8px', marginBottom: '1rem', fontSize: '0.85rem', color: location ? '#166534' : '#6B7280', border: `1px solid ${location ? '#BBF7D0' : '#E5E7EB'}` }}>
+              {location ? `✅ GPS Active (±${location.accuracy?.toFixed(0)}m)` : locationError ? '⚠️ Location unavailable — you can still clock in' : '📍 Getting your location...'}
+            </div>
+            <button
+              onClick={handleClockIn}
+              disabled={!selectedClient}
+              style={{
+                width: '100%', padding: '1.125rem', background: selectedClient ? '#2ABBA7' : '#D1D5DB',
+                color: selectedClient ? '#fff' : '#9CA3AF', border: 'none', borderRadius: '12px',
+                cursor: selectedClient ? 'pointer' : 'not-allowed', fontWeight: '800', fontSize: '1.15rem',
+                transition: 'all 0.15s', boxShadow: selectedClient ? '0 4px 12px rgba(42,187,167,0.3)' : 'none'
+              }}
+            >
+              ▶️ Clock In
+            </button>
+          </div>
+        )}
+      </div>
+
+      {/* Quick Actions row */}
+      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '0.75rem', marginTop: '0.75rem' }}>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem' }} onClick={() => handlePageClick('open-shifts')}>
+          <div style={{ fontSize: '1.6rem' }}>📋</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem' }}>Open Shifts</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem' }} onClick={() => handlePageClick('availability')}>
+          <div style={{ fontSize: '1.6rem' }}>⏰</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem' }}>Availability</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#FEF2F2', border: '1px solid #FCA5A5' }}
+          onClick={() => setShowMissReport(true)}>
+          <div style={{ fontSize: '1.6rem' }}>🚨</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#DC2626' }}>Miss Report</div>
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#EEF2FF', border: '1px solid #C7D2FE', position: 'relative' }}
+          onClick={() => setShowMessages(true)}>
+          <div style={{ fontSize: '1.6rem' }}>💬</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#4338CA' }}>Messages</div>
+          {unreadMessages > 0 && (
+            <span style={{ position: 'absolute', top: '6px', right: '6px', background: '#EF4444', color: '#fff', borderRadius: '99px', fontSize: '0.62rem', fontWeight: '700', padding: '1px 6px', minWidth: '16px', textAlign: 'center' }}>{unreadMessages}</span>
+          )}
+        </div>
+        <div className="card" style={{ textAlign: 'center', cursor: 'pointer', padding: '1rem', background: '#F0FDFB', border: '1px solid #A7F3D0' }}
+          onClick={() => setShowHelp(true)}>
+          <div style={{ fontSize: '1.6rem' }}>❓</div>
+          <div style={{ fontWeight: '600', fontSize: '0.82rem', color: '#065F46' }}>Help</div>
+        </div>
+      </div>
+    </>
+    );
+  };
+
+  const renderOpenShiftsPage = () => (
+    <>
+      <div className="schedule-header"><h3>📋 Available Shifts</h3></div>
+      {openShifts.length === 0 ? (
+        <div className="card text-center"><p style={{ fontSize: '3rem', margin: '1rem 0' }}>✅</p><p className="text-muted">No open shifts</p></div>
+      ) : (
+        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
+          {openShifts.map(shift => (
+            <div key={shift.id} className="card" style={{ padding: '1rem' }}>
+              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
+                <div>
+                  <div style={{ fontWeight: '600' }}>{shift.client_first_name} {shift.client_last_name}</div>
+                  <div style={{ fontSize: '0.9rem', color: '#666' }}>📅 {formatDate(shift.date)}</div>
+                  <div style={{ fontSize: '0.9rem', color: '#666' }}>🕐 {formatTime(shift.start_time)} - {formatTime(shift.end_time)}</div>
+                </div>
+                <button className="btn btn-sm btn-primary" onClick={() => handlePickupShift(shift.id)}>Claim</button>
+              </div>
+            </div>
+          ))}
+        </div>
+      )}
+    </>
+  );
+
+  const renderAvailabilityPage = () => (
+    <>
+      <div className="schedule-header"><h3>⏰ My Availability</h3></div>
+      <div className="card">
+        <div className="form-group">
+          <label>Status</label>
+          <select value={availability.status} onChange={(e) => setAvailability({ ...availability, status: e.target.value })}>
+            <option value="available">✅ Available</option>
+            <option value="limited">⚠️ Limited</option>
+            <option value="unavailable">❌ Unavailable</option>
+          </select>
+        </div>
+        <div className="form-group">
+          <label>Max Hours/Week: {availability.maxHoursPerWeek}</label>
+          <input type="range" min="0" max="60" value={availability.maxHoursPerWeek} onChange={(e) => setAvailability({ ...availability, maxHoursPerWeek: parseInt(e.target.value) })} style={{ width: '100%' }} />
+        </div>
+        <div className="form-group">
+          <label>Weekly Schedule</label>
+          {[0,1,2,3,4,5,6].map(day => {
+            const d = availability.weeklyAvailability[day] || { available: false, start: '09:00', end: '17:00' };
+            return (
+              <div key={day} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', padding: '0.5rem', background: d.available ? '#D1FAE5' : '#F3F4F6', borderRadius: '6px', marginBottom: '0.25rem' }}>
+                <input type="checkbox" checked={d.available} onChange={(e) => {
+                  const u = { ...availability.weeklyAvailability };
+                  u[day] = { ...d, available: e.target.checked };
+                  setAvailability({ ...availability, weeklyAvailability: u });
+                }} style={{ width: 'auto' }} />
+                <span style={{ width: '60px', fontWeight: '500' }}>{getDayName(day).slice(0,3)}</span>
+                {d.available && (
+                  <>
+                    <input type="time" value={d.start} onChange={(e) => {
+                      const u = { ...availability.weeklyAvailability };
+                      u[day] = { ...d, start: e.target.value };
+                      setAvailability({ ...availability, weeklyAvailability: u });
+                    }} style={{ padding: '0.25rem' }} />
+                    <span>-</span>
+                    <input type="time" value={d.end} onChange={(e) => {
+                      const u = { ...availability.weeklyAvailability };
+                      u[day] = { ...d, end: e.target.value };
+                      setAvailability({ ...availability, weeklyAvailability: u });
+                    }} style={{ padding: '0.25rem' }} />
+                  </>
+                )}
+              </div>
+            );
+          })}
+        </div>
+        <div className="form-group">
+          <label>Notes</label>
+          <textarea value={availability.notes} onChange={(e) => setAvailability({ ...availability, notes: e.target.value })} rows={2} placeholder="Any notes..." />
+        </div>
+        <button className="btn btn-primary btn-block" onClick={handleSaveAvailability}>💾 Save</button>
+      </div>
+    </>
+  );
+
+  const renderTimeOffPage = () => (
+    <>
+      <div className="schedule-header"><h3>🏖️ Time Off</h3></div>
+      <div className="card" style={{ marginBottom: '1rem' }}>
+        <h4 style={{ margin: '0 0 1rem 0' }}>Request Time Off</h4>
+        <form onSubmit={handleRequestTimeOff}>
+          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
+            <div className="form-group" style={{ margin: 0 }}>
+              <label>Start</label>
+              <input type="date" value={newTimeOff.startDate} onChange={(e) => setNewTimeOff({ ...newTimeOff, startDate: e.target.value })} min={new Date().toISOString().split('T')[0]} required />
+            </div>
+            <div className="form-group" style={{ margin: 0 }}>
+              <label>End</label>
+              <input type="date" value={newTimeOff.endDate} onChange={(e) => setNewTimeOff({ ...newTimeOff, endDate: e.target.value })} min={newTimeOff.startDate || new Date().toISOString().split('T')[0]} required />
+            </div>
+          </div>
+          <div className="form-group">
+            <label>Reason</label>
+            <input type="text" value={newTimeOff.reason} onChange={(e) => setNewTimeOff({ ...newTimeOff, reason: e.target.value })} placeholder="Vacation, etc." />
+          </div>
+          <button type="submit" className="btn btn-primary">Submit</button>
+        </form>
+      </div>
+      <div className="card">
+        <h4 style={{ margin: '0 0 1rem 0' }}>My Requests</h4>
+        {timeOffRequests.length === 0 ? <p className="text-muted text-center">None</p> : (
+          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
+            {timeOffRequests.map(r => (
+              <div key={r.id} style={{ padding: '0.75rem', borderRadius: '6px', background: r.status === 'approved' ? '#D1FAE5' : r.status === 'denied' ? '#FEE2E2' : '#FEF3C7', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                <div>
+                  <div style={{ fontWeight: '500' }}>{formatDate(r.start_date)} - {formatDate(r.end_date)}</div>
+                  {r.reason && <div style={{ fontSize: '0.85rem', color: '#666' }}>{r.reason}</div>}
+                </div>
+                <span style={{ padding: '0.25rem 0.75rem', borderRadius: '12px', fontSize: '0.75rem', fontWeight: '600', background: r.status === 'approved' ? '#059669' : r.status === 'denied' ? '#DC2626' : '#D97706', color: '#fff' }}>
+                  {(r.status || 'pending').toUpperCase()}
+                </span>
+              </div>
+            ))}
+          </div>
+        )}
+      </div>
+    </>
+  );
+
+  const renderSchedulePage = () => {
+    const recurring = schedules.filter(s => s.day_of_week != null);
+    const oneTime = schedules.filter(s => s.date);
+    const grouped = {};
+    recurring.forEach(s => { if (!grouped[s.day_of_week]) grouped[s.day_of_week] = []; grouped[s.day_of_week].push(s); });
+
+    return (
+      <>
+        <div className="schedule-header"><h3>📅 My Schedule</h3></div>
+        {schedules.length === 0 ? <div className="card text-center"><p className="text-muted">No schedules</p></div> : (
+          <div>
+            {Object.keys(grouped).sort().map(day => (
+              <div key={day} className="card" style={{ marginBottom: '0.75rem' }}>
+                <div style={{ fontWeight: '600', color: '#2563eb' }}>{getDayName(parseInt(day))}s</div>
+                {grouped[day].map(s => (
+                  <div key={s.id} style={{ padding: '0.5rem 0', borderTop: '1px solid #eee' }}>
+                    <div style={{ fontWeight: '500' }}>{getClientName(s.client_id)}</div>
+                    <div style={{ fontSize: '0.9rem', color: '#666' }}>{formatTime(s.start_time)} - {formatTime(s.end_time)}</div>
+                  </div>
+                ))}
+              </div>
+            ))}
+            {oneTime.length > 0 && (
+              <div className="card">
+                <div style={{ fontWeight: '600', color: '#059669' }}>Upcoming</div>
+                {oneTime.sort((a,b) => new Date(a.date) - new Date(b.date)).map(s => (
+                  <div key={s.id} style={{ padding: '0.5rem 0', borderTop: '1px solid #eee' }}>
+                    <div style={{ fontWeight: '500' }}>{formatDate(s.date)}</div>
+                    <div>{getClientName(s.client_id)}</div>
+                    <div style={{ fontSize: '0.9rem', color: '#666' }}>{formatTime(s.start_time)} - {formatTime(s.end_time)}</div>
+                  </div>
+                ))}
+              </div>
+            )}
+          </div>
+        )}
+      </>
+    );
+  };
+
+  const renderHistoryPage = () => (
+    <div className="card">
+      <div className="card-title">Recent Visits</div>
+      {recentVisits.length === 0 ? <p className="text-muted text-center">None</p> : (
+        <div style={{ overflowX: 'auto' }}>
+          <table className="table">
+            <thead><tr><th>Date</th><th>Client</th><th>Hours</th></tr></thead>
+            <tbody>
+              {recentVisits.map((v, i) => (
+                <tr key={v.id || i}>
+                  <td>{formatDate(v.start_time)}</td>
+                  <td><span onClick={() => setViewingClientId(v.client_id)} style={{ cursor: 'pointer', color: '#007bff' }}>{v.client_name || getClientName(v.client_id)}</span></td>
+                  <td>{v.hours_worked ? `${parseFloat(v.hours_worked).toFixed(2)}h` : '-'}</td>
+                </tr>
+              ))}
+            </tbody>
+          </table>
+        </div>
+      )}
+    </div>
+  );
+
+  const renderClientsPage = () => {
+    const myClients = clients.filter(c => schedules.some(s => s.client_id === c.id));
+    return (
+      <>
+        <div className="schedule-header"><h3>👥 My Clients</h3></div>
+        {myClients.length === 0 ? <div className="card text-center"><p className="text-muted">No clients</p></div> : (
+          <div style={{ display: 'grid', gap: '0.75rem' }}>
+            {myClients.map(c => (
+              <div key={c.id} className="card" onClick={() => setViewingClientId(c.id)} style={{ cursor: 'pointer' }}>
+                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
+                  <div>
+                    <h4 style={{ margin: 0 }}>{c.first_name} {c.last_name}</h4>
+                    <p style={{ margin: '0.25rem 0 0 0', color: '#666', fontSize: '0.9rem' }}>📞 {c.phone || 'N/A'} • 📍 {c.city || 'N/A'}</p>
+                  </div>
+                  <span style={{ color: '#007bff', fontSize: '1.2rem' }}>→</span>
+                </div>
+              </div>
+            ))}
+          </div>
+        )}
+      </>
+    );
+  };
+
+  const renderSettingsPage = () => (
+    <>
+      <div className="card">
+        <div className="card-title">Profile</div>
+        <div className="form-group"><label>Name</label><input type="text" value={user.name || `${user.first_name} ${user.last_name}`} disabled /></div>
+        <div className="form-group"><label>Email</label><input type="text" value={user.email} disabled /></div>
+      </div>
+      <div className="card">
+        <div className="card-title">GPS Status</div>
+        <div className={`alert ${location ? 'alert-success' : 'alert-info'}`}>
+          {location ? <>GPS Active (±{location.accuracy?.toFixed(0)}m)</> : <>{locationError || 'Location unavailable'} - Clock in still works</>}
+        </div>
+      </div>
+      <button className="btn btn-danger btn-block" onClick={onLogout}>Log Out</button>
+    </>
+  );
+
+  if (loading) return <div className="loading"><div className="spinner"></div></div>;
+
+  return (
+    <div style={{ display: 'flex', width: '100%', height: '100%' }}>
+      {message.text && (
+        <div style={{ position: 'fixed', top: '1rem', right: '1rem', padding: '1rem 1.5rem', borderRadius: '8px', zIndex: 1001, background: message.type === 'error' ? '#FEE2E2' : '#D1FAE5', color: message.type === 'error' ? '#DC2626' : '#059669', boxShadow: '0 4px 12px rgba(0,0,0,0.15)' }}>
+          {message.text}
+        </div>
+      )}
+
+      {sidebarOpen && window.innerWidth <= 768 && <div className="sidebar-overlay active" onClick={() => setSidebarOpen(false)} />}
+
+      <div className={`sidebar ${sidebarOpen ? 'open' : ''}`}>
+        <div className="sidebar-logo">CVHC</div>
+        <ul className="sidebar-nav">
+          <li><a href="#" className={currentPage === 'home' ? 'active' : ''} onClick={() => handlePageClick('home')}>🏠 Home</a></li>
+          <li><a href="#" className={currentPage === 'schedule' ? 'active' : ''} onClick={() => handlePageClick('schedule')}>📅 Schedule</a></li>
+          <li><a href="#" className={currentPage === 'clients' ? 'active' : ''} onClick={() => handlePageClick('clients')}>👥 Clients</a></li>
+          <li><a href="#" className={currentPage === 'history' ? 'active' : ''} onClick={() => handlePageClick('history')}>📜 History</a></li>
+          <li style={{ paddingTop: '1rem', borderTop: '1px solid rgba(255,255,255,0.1)', marginTop: '0.5rem' }}>
+            <span style={{ fontSize: '0.65rem', textTransform: 'uppercase', color: 'rgba(255,255,255,0.4)', display: 'block', padding: '0.5rem 1rem' }}>Self Service</span>
+          </li>
+          <li><a href="#" className={currentPage === 'open-shifts' ? 'active' : ''} onClick={() => handlePageClick('open-shifts')}>📋 Open Shifts</a></li>
+          <li><a href="#" className={currentPage === 'availability' ? 'active' : ''} onClick={() => handlePageClick('availability')}>⏰ Availability</a></li>
+          <li><a href="#" className={currentPage === 'miss-report' ? 'active' : ''} onClick={() => handlePageClick('miss-report')}>🚨 Report Miss</a></li>
+          <li><a href="#" className={currentPage === 'time-off' ? 'active' : ''} onClick={() => handlePageClick('time-off')}>🏖️ Time Off</a></li>
+          <li style={{ paddingTop: '1rem', borderTop: '1px solid rgba(255,255,255,0.1)', marginTop: '0.5rem' }}>
+            <a href="#" className={currentPage === 'settings' ? 'active' : ''} onClick={() => handlePageClick('settings')}>⚙️ Settings</a>
+          </li>
+        </ul>
+        <div className="sidebar-user">
+          <div className="sidebar-user-name">{user.name || `${user.first_name || ''} ${user.last_name || ''}`}</div>
+          <div className="sidebar-user-role">Caregiver</div>
+          <button className="btn-logout" onClick={onLogout}>Logout</button>
+        </div>
+      </div>
+
+      <div className="main-content">
+        <div className="header">
+          <div><h1>Chippewa Valley Home Care</h1><p>Caregiver Portal</p></div>
+          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
+            <button className="hamburger-btn" onClick={() => setSidebarOpen(!sidebarOpen)}>Menu</button>
+            <button
+              onClick={onLogout}
+              style={{
+                padding: '0.4rem 0.85rem', borderRadius: '8px', border: 'none',
+                background: '#FEE2E2', color: '#DC2626', fontWeight: '700',
+                fontSize: '0.82rem', cursor: 'pointer', whiteSpace: 'nowrap'
+              }}>
+              ⏻ Logout
+            </button>
+          </div>
+        </div>
+        <div className="container">
+          {currentPage === 'home' && renderHomePage()}
+          {currentPage === 'schedule' && renderSchedulePage()}
+          {currentPage === 'clients' && renderClientsPage()}
+          {currentPage === 'history' && renderHistoryPage()}
+          {currentPage === 'open-shifts' && renderOpenShiftsPage()}
+          {currentPage === 'availability' && renderAvailabilityPage()}
+          {currentPage === 'time-off' && renderTimeOffPage()}
+          {currentPage === 'miss-report' && renderMissReportPage()}
+          {currentPage === 'settings' && renderSettingsPage()}
+        </div>
+      </div>
+
+      {showNoteModal && (
+        <div className="modal active">
+          <div className="modal-content">
+            <div className="modal-header"><h2>Visit Notes</h2><button className="close-btn" onClick={() => setShowNoteModal(false)}>×</button></div>
+            <p className="text-muted">Add notes (optional)</p>
+            <div className="form-group"><textarea value={visitNote} onChange={(e) => setVisitNote(e.target.value)} placeholder="How did the visit go?" rows={4} /></div>
+            <div className="form-actions">
+              <button className="btn btn-secondary" onClick={() => setShowNoteModal(false)}>Cancel</button>
+              <button className="btn btn-primary" onClick={completeClockOut}>Clock Out</button>
+            </div>
+          </div>
+        </div>
+      )}
+
+      <CaregiverClientModal clientId={viewingClientId} isOpen={!!viewingClientId} onClose={() => setViewingClientId(null)} token={token} />
+
+      {/* Messages Modal */}
+      {showMessages && <CaregiverMessages token={token} onClose={() => { setShowMessages(false); setUnreadMessages(0); }} />}
+
+      {/* Help Modal */}
+      {showHelp && <CaregiverHelp onClose={() => setShowHelp(false)} />}
+
+      {/* Shift Miss Report Modal */}
+      {showMissReport && (
+        <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', zIndex: 9999, display: 'flex', alignItems: 'flex-end', justifyContent: 'center' }}>
+          <div style={{ background: '#fff', borderRadius: '16px 16px 0 0', padding: '1.5rem', width: '100%', maxWidth: '500px', maxHeight: '90vh', overflowY: 'auto' }}>
+            <ShiftMissReport token={token} userId={user.id} onClose={() => setShowMissReport(false)} />
+          </div>
+        </div>
+      )}
+
+      {/* ── Mobile Bottom Navigation ── */}
+      {showMoreDrawer && <div className="mobile-more-drawer-overlay" onClick={() => setShowMoreDrawer(false)} />}
+
+      <div className={`mobile-more-drawer ${showMoreDrawer ? 'open' : ''}`}>
+        <div className="mobile-more-drawer-handle" />
+        <div className="mobile-more-drawer-section">
+          <div className="mobile-more-drawer-section-title">Self Service</div>
+          {[
+            { page: 'open-shifts',   icon: '📋', label: 'Open Shifts' },
+            { page: 'availability',  icon: '⏰', label: 'Availability' },
+            { page: 'miss-report',   icon: '🚨', label: 'Report Miss' },
+            { page: 'time-off',      icon: '🏖️', label: 'Time Off' },
+          ].map(({ page, icon, label }) => (
+            <button
+              key={page}
+              className={`mobile-more-drawer-item ${currentPage === page ? 'active' : ''}`}
+              onClick={() => { setCurrentPage(page); setShowMoreDrawer(false); }}
+            >
+              <span className="mobile-more-drawer-item-icon">{icon}</span>
+              {label}
+            </button>
+          ))}
+        </div>
+        <div className="mobile-more-drawer-section">
+          <div className="mobile-more-drawer-section-title">Account</div>
+          <button
+            className={`mobile-more-drawer-item ${currentPage === 'settings' ? 'active' : ''}`}
+            onClick={() => { setCurrentPage('settings'); setShowMoreDrawer(false); }}
+          >
+            <span className="mobile-more-drawer-item-icon">⚙️</span>
+            Settings
+          </button>
+          <button
+            className="mobile-more-drawer-item"
+            onClick={onLogout}
+            style={{ color: '#DC2626' }}
+          >
+            <span className="mobile-more-drawer-item-icon" style={{ background: '#FEE2E2' }}>⏻</span>
+            Log Out
+          </button>
+        </div>
+      </div>
+
+      <nav className="mobile-bottom-nav">
+        {[
+          { page: 'home',     icon: '🏠', label: 'Home' },
+          { page: 'schedule', icon: '📅', label: 'Schedule' },
+          { page: 'clients',  icon: '👥', label: 'Clients' },
+          { page: 'history',  icon: '📜', label: 'History' },
+        ].map(({ page, icon, label }) => (
+          <button
+            key={page}
+            className={`mobile-bottom-nav-item ${currentPage === page ? 'active' : ''}`}
+            onClick={() => { setCurrentPage(page); setShowMoreDrawer(false); }}
+          >
+            <span className="mobile-bottom-nav-icon">{icon}</span>
+            {label}
+          </button>
+        ))}
+        <button
+          className={`mobile-bottom-nav-item ${showMoreDrawer ? 'active' : ''}`}
+          onClick={() => setShowMoreDrawer(v => !v)}
+        >
+          <span className="mobile-bottom-nav-icon">⋯</span>
+          More
+        </button>
+      </nav>
+    </div>
+  );
+};
+
+export default CaregiverDashboard;
diff --git a/templates/crm-homecare/frontend/src/components/ImpersonationModal.jsx b/templates/crm-homecare/frontend/src/components/ImpersonationModal.jsx
new file mode 100644
index 0000000..dee0021
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/ImpersonationModal.jsx
@@ -0,0 +1,175 @@
+// src/components/ImpersonationModal.jsx
+import React, { useState, useEffect } from 'react';
+import { API_BASE_URL } from '../config';
+
+const ImpersonationModal = ({ token, onImpersonate, onClose }) => {
+  const [users, setUsers] = useState([]);
+  const [search, setSearch] = useState('');
+  const [loading, setLoading] = useState(true);
+  const [impersonating, setImpersonating] = useState(null);
+  const [error, setError] = useState('');
+
+  useEffect(() => {
+    fetch(`${API_BASE_URL}/api/auth/users`, {
+      headers: { Authorization: `Bearer ${token}` }
+    })
+      .then(r => r.json())
+      .then(data => { setUsers(Array.isArray(data) ? data : []); setLoading(false); })
+      .catch(() => { setError('Failed to load users'); setLoading(false); });
+  }, [token]);
+
+  const filtered = users.filter(u => {
+    const q = search.toLowerCase();
+    return (
+      u.first_name?.toLowerCase().includes(q) ||
+      u.last_name?.toLowerCase().includes(q) ||
+      u.email?.toLowerCase().includes(q) ||
+      u.role?.toLowerCase().includes(q)
+    );
+  });
+
+  const handleImpersonate = async (userId) => {
+    setImpersonating(userId);
+    setError('');
+    try {
+      const res = await fetch(`${API_BASE_URL}/api/auth/impersonate/${userId}`, {
+        method: 'POST',
+        headers: { Authorization: `Bearer ${token}` }
+      });
+      const data = await res.json();
+      if (!res.ok) throw new Error(data.error || 'Failed');
+      onImpersonate(data.token, data.user);
+    } catch (e) {
+      setError(e.message);
+    } finally {
+      setImpersonating(null);
+    }
+  };
+
+  const roleIcon = (role) => role === 'admin' ? '🔑' : '👤';
+  const roleColor = (role) => role === 'admin' ? '#7c3aed' : '#2563eb';
+
+  return (
+    <div style={{
+      position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.55)',
+      display: 'flex', alignItems: 'center', justifyContent: 'center',
+      zIndex: 9999, padding: '1rem'
+    }}>
+      <div style={{
+        background: '#fff', borderRadius: '12px', width: '100%', maxWidth: '520px',
+        maxHeight: '80vh', display: 'flex', flexDirection: 'column',
+        boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
+      }}>
+        {/* Header */}
+        <div style={{
+          padding: '1.25rem 1.5rem', borderBottom: '1px solid #e5e7eb',
+          display: 'flex', alignItems: 'center', justifyContent: 'space-between'
+        }}>
+          <div>
+            <h2 style={{ margin: 0, fontSize: '1.1rem', fontWeight: 700 }}>👁️ View As User</h2>
+            <p style={{ margin: '0.2rem 0 0', fontSize: '0.82rem', color: '#6b7280' }}>
+              Select a user to see the app from their perspective
+            </p>
+          </div>
+          <button onClick={onClose} style={{
+            background: 'none', border: 'none', fontSize: '1.4rem',
+            cursor: 'pointer', color: '#9ca3af', lineHeight: 1
+          }}>×</button>
+        </div>
+
+        {/* Search */}
+        <div style={{ padding: '1rem 1.5rem', borderBottom: '1px solid #f3f4f6' }}>
+          <input
+            autoFocus
+            type="text"
+            placeholder="Search by name, email, or role..."
+            value={search}
+            onChange={e => setSearch(e.target.value)}
+            style={{
+              width: '100%', padding: '0.6rem 0.9rem', borderRadius: '8px',
+              border: '1px solid #d1d5db', fontSize: '0.9rem', outline: 'none',
+              boxSizing: 'border-box'
+            }}
+          />
+        </div>
+
+        {/* List */}
+        <div style={{ overflowY: 'auto', flex: 1 }}>
+          {loading && (
+            <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af' }}>
+              Loading users...
+            </div>
+          )}
+          {error && (
+            <div style={{ padding: '1rem 1.5rem', color: '#dc2626', fontSize: '0.85rem' }}>
+              ⚠️ {error}
+            </div>
+          )}
+          {!loading && filtered.length === 0 && (
+            <div style={{ padding: '2rem', textAlign: 'center', color: '#9ca3af' }}>
+              No users found
+            </div>
+          )}
+          {filtered.map(u => (
+            <div key={u.id} style={{
+              display: 'flex', alignItems: 'center', justifyContent: 'space-between',
+              padding: '0.75rem 1.5rem', borderBottom: '1px solid #f9fafb',
+              transition: 'background 0.1s'
+            }}
+              onMouseEnter={e => e.currentTarget.style.background = '#f9fafb'}
+              onMouseLeave={e => e.currentTarget.style.background = 'transparent'}
+            >
+              <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
+                <div style={{
+                  width: '38px', height: '38px', borderRadius: '50%',
+                  background: roleColor(u.role) + '18',
+                  display: 'flex', alignItems: 'center', justifyContent: 'center',
+                  fontSize: '1.1rem'
+                }}>
+                  {roleIcon(u.role)}
+                </div>
+                <div>
+                  <div style={{ fontWeight: 600, fontSize: '0.9rem' }}>
+                    {u.first_name} {u.last_name}
+                  </div>
+                  <div style={{ fontSize: '0.78rem', color: '#6b7280' }}>{u.email}</div>
+                </div>
+                <span style={{
+                  fontSize: '0.7rem', padding: '0.15rem 0.5rem', borderRadius: '999px',
+                  background: roleColor(u.role) + '18', color: roleColor(u.role),
+                  fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.04em'
+                }}>
+                  {u.role}
+                </span>
+              </div>
+              <button
+                onClick={() => handleImpersonate(u.id)}
+                disabled={impersonating === u.id}
+                style={{
+                  padding: '0.4rem 1rem', borderRadius: '6px', border: 'none',
+                  background: impersonating === u.id ? '#e5e7eb' : '#2563eb',
+                  color: impersonating === u.id ? '#9ca3af' : '#fff',
+                  fontSize: '0.82rem', fontWeight: 600, cursor: impersonating === u.id ? 'not-allowed' : 'pointer',
+                  whiteSpace: 'nowrap'
+                }}
+              >
+                {impersonating === u.id ? 'Loading...' : 'View As'}
+              </button>
+            </div>
+          ))}
+        </div>
+
+        {/* Footer */}
+        <div style={{
+          padding: '0.85rem 1.5rem', borderTop: '1px solid #e5e7eb',
+          background: '#fafafa', borderRadius: '0 0 12px 12px',
+          fontSize: '0.75rem', color: '#9ca3af'
+        }}>
+          🔒 All impersonation sessions are logged in the audit trail
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default ImpersonationModal;
diff --git a/templates/crm-homecare/frontend/src/components/Login.jsx b/templates/crm-homecare/frontend/src/components/Login.jsx
new file mode 100644
index 0000000..879db93
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/Login.jsx
@@ -0,0 +1,122 @@
+// src/components/Login.jsx
+import React, { useState } from 'react';
+import { API_BASE_URL } from '../config';
+
+const Login = ({ onLogin }) => {
+  const [email, setEmail] = useState('');
+  const [password, setPassword] = useState('');
+  const [showPassword, setShowPassword] = useState(false);
+  const [error, setError] = useState('');
+  const [loading, setLoading] = useState(false);
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError('');
+    setLoading(true);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/auth/login`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({ email: email.trim().toLowerCase(), password })
+      });
+
+      const data = await response.json();
+
+      if (!response.ok) {
+        throw new Error(data.error || `Error ${response.status}`);
+      }
+
+      onLogin(data.token, data.user);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="login-container">
+      <div className="login-card">
+        <h1>Chippewa Valley</h1>
+        <p>Home Care CRM</p>
+        
+        {error && <div className="alert alert-error">{error}</div>}
+
+        <form onSubmit={handleSubmit}>
+          <div className="form-group">
+            <label htmlFor="email">Email Address</label>
+            <input
+              id="email"
+              type="email"
+              value={email}
+              onChange={(e) => setEmail(e.target.value)}
+              placeholder="admin@example.com"
+              required
+            />
+          </div>
+
+          <div className="form-group">
+            <label htmlFor="password">Password</label>
+            <div style={{ position: 'relative' }}>
+              <input
+                id="password"
+                type={showPassword ? 'text' : 'password'}
+                value={password}
+                onChange={(e) => setPassword(e.target.value)}
+                placeholder="••••••••"
+                required
+                style={{ paddingRight: '2.75rem' }}
+              />
+              <button
+                type="button"
+                onClick={() => setShowPassword(v => !v)}
+                aria-label={showPassword ? 'Hide password' : 'Show password'}
+                style={{
+                  position: 'absolute',
+                  right: '0.75rem',
+                  top: '50%',
+                  transform: 'translateY(-50%)',
+                  background: 'none',
+                  border: 'none',
+                  cursor: 'pointer',
+                  padding: 0,
+                  fontSize: '1.1rem',
+                  lineHeight: 1,
+                  color: '#9CA3AF',
+                  display: 'flex',
+                  alignItems: 'center',
+                }}
+              >
+                {showPassword ? (
+                  /* Eye-off SVG */
+                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
+                    <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
+                    <line x1="1" y1="1" x2="23" y2="23"/>
+                  </svg>
+                ) : (
+                  /* Eye SVG */
+                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
+                    <circle cx="12" cy="12" r="3"/>
+                  </svg>
+                )}
+              </button>
+            </div>
+          </div>
+
+          <button type="submit" className="btn btn-primary btn-block" disabled={loading}>
+            {loading ? 'Signing in...' : 'Sign In'}
+          </button>
+        </form>
+
+        <p className="login-footer">
+          HIPAA-compliant system. Authorized personnel only.
+        </p>
+      </div>
+    </div>
+  );
+};
+
+export default Login;
diff --git a/templates/crm-homecare/frontend/src/components/PaymentPage.jsx b/templates/crm-homecare/frontend/src/components/PaymentPage.jsx
new file mode 100644
index 0000000..3181b66
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/components/PaymentPage.jsx
@@ -0,0 +1,346 @@
+// src/components/PaymentPage.jsx
+// Public page for clients to pay invoices via Stripe
+import React, { useState, useEffect } from 'react';
+import { useParams, useSearchParams } from 'react-router-dom';
+
+const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';
+
+const PaymentPage = () => {
+  const { invoiceId } = useParams();
+  const [searchParams] = useSearchParams();
+  const [invoice, setInvoice] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [processing, setProcessing] = useState(false);
+  const [error, setError] = useState(null);
+  
+  const cancelled = searchParams.get('cancelled') === 'true';
+
+  useEffect(() => {
+    loadInvoice();
+  }, [invoiceId]);
+
+  const loadInvoice = async () => {
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/stripe/invoice/${invoiceId}/pay`);
+      if (!response.ok) {
+        throw new Error('Invoice not found');
+      }
+      const data = await response.json();
+      setInvoice(data);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handlePayment = async () => {
+    setProcessing(true);
+    setError(null);
+
+    try {
+      const response = await fetch(`${API_BASE_URL}/api/stripe/invoice/${invoiceId}/pay`, {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' }
+      });
+
+      const data = await response.json();
+
+      if (data.url) {
+        // Redirect to Stripe checkout
+        window.location.href = data.url;
+      } else {
+        throw new Error(data.error || 'Failed to create payment session');
+      }
+    } catch (err) {
+      setError(err.message);
+      setProcessing(false);
+    }
+  };
+
+  if (loading) {
+    return (
+      <div style={styles.container}>
+        <div style={styles.card}>
+          <div style={styles.spinner}></div>
+          <p>Loading invoice...</p>
+        </div>
+      </div>
+    );
+  }
+
+  if (error && !invoice) {
+    return (
+      <div style={styles.container}>
+        <div style={styles.card}>
+          <h2 style={{ color: '#e74c3c' }}>Error</h2>
+          <p>{error}</p>
+        </div>
+      </div>
+    );
+  }
+
+  if (invoice?.status === 'paid') {
+    return (
+      <div style={styles.container}>
+        <div style={styles.card}>
+          <div style={styles.successIcon}>✓</div>
+          <h2 style={{ color: '#27ae60' }}>Invoice Paid</h2>
+          <p>This invoice has already been paid. Thank you!</p>
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div style={styles.container}>
+      <div style={styles.card}>
+        <div style={styles.logo}>
+          <h1 style={{ margin: 0, color: '#2c3e50' }}>Chippewa Valley Home Care</h1>
+        </div>
+
+        {cancelled && (
+          <div style={styles.cancelledBanner}>
+            Payment was cancelled. You can try again below.
+          </div>
+        )}
+
+        <div style={styles.invoiceHeader}>
+          <h2>Invoice #{invoice?.invoiceNumber}</h2>
+          <p style={styles.clientName}>{invoice?.clientName}</p>
+        </div>
+
+        <div style={styles.details}>
+          <div style={styles.detailRow}>
+            <span>Billing Period:</span>
+            <span>
+              {invoice?.billingPeriod?.start && new Date(invoice.billingPeriod.start).toLocaleDateString()} - {' '}
+              {invoice?.billingPeriod?.end && new Date(invoice.billingPeriod.end).toLocaleDateString()}
+            </span>
+          </div>
+          <div style={styles.detailRow}>
+            <span>Invoice Total:</span>
+            <span>${parseFloat(invoice?.total || 0).toFixed(2)}</span>
+          </div>
+          {parseFloat(invoice?.amountPaid || 0) > 0 && (
+            <div style={styles.detailRow}>
+              <span>Already Paid:</span>
+              <span style={{ color: '#27ae60' }}>-${parseFloat(invoice.amountPaid).toFixed(2)}</span>
+            </div>
+          )}
+          <div style={{ ...styles.detailRow, ...styles.totalRow }}>
+            <span><strong>Amount Due:</strong></span>
+            <span style={styles.amountDue}>${parseFloat(invoice?.amountDue || 0).toFixed(2)}</span>
+          </div>
+        </div>
+
+        {error && (
+          <div style={styles.errorBanner}>
+            {error}
+          </div>
+        )}
+
+        <button
+          onClick={handlePayment}
+          disabled={processing}
+          style={{
+            ...styles.payButton,
+            ...(processing ? styles.payButtonDisabled : {})
+          }}
+        >
+          {processing ? 'Processing...' : `Pay $${parseFloat(invoice?.amountDue || 0).toFixed(2)}`}
+        </button>
+
+        <div style={styles.secureNotice}>
+          <span>🔒</span> Secure payment powered by Stripe
+        </div>
+
+        <div style={styles.footer}>
+          <p>Questions about this invoice? Contact us at:</p>
+          <p><strong>support@chippewavalleyhomecare.com</strong></p>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+// Payment Success Page
+export const PaymentSuccess = () => {
+  const [searchParams] = useSearchParams();
+  const sessionId = searchParams.get('session_id');
+  const invoiceId = searchParams.get('invoice_id');
+  const [payment, setPayment] = useState(null);
+  const [loading, setLoading] = useState(true);
+
+  useEffect(() => {
+    if (sessionId) {
+      verifyPayment();
+    } else {
+      setLoading(false);
+    }
+  }, [sessionId]);
+
+  const verifyPayment = async () => {
+    try {
+      const response = await fetch(`${process.env.REACT_APP_API_URL || 'http://localhost:5000'}/api/stripe/verify-payment/${sessionId}`);
+      const data = await response.json();
+      setPayment(data);
+    } catch (err) {
+      console.error('Error verifying payment:', err);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  if (loading) {
+    return (
+      <div style={styles.container}>
+        <div style={styles.card}>
+          <p>Verifying payment...</p>
+        </div>
+      </div>
+    );
+  }
+
+  return (
+    <div style={styles.container}>
+      <div style={styles.card}>
+        <div style={styles.successIcon}>✓</div>
+        <h2 style={{ color: '#27ae60' }}>Payment Successful!</h2>
+        
+        {payment?.success && (
+          <div style={styles.details}>
+            <p>Amount Paid: <strong>${payment.amount?.toFixed(2)}</strong></p>
+            <p>A confirmation email has been sent to {payment.customerEmail}</p>
+          </div>
+        )}
+
+        <p style={{ marginTop: '2rem', color: '#666' }}>
+          Thank you for your payment. You can close this window.
+        </p>
+      </div>
+    </div>
+  );
+};
+
+const styles = {
+  container: {
+    minHeight: '100vh',
+    display: 'flex',
+    alignItems: 'center',
+    justifyContent: 'center',
+    backgroundColor: '#f5f6fa',
+    padding: '1rem',
+    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
+  },
+  card: {
+    backgroundColor: 'white',
+    borderRadius: '12px',
+    boxShadow: '0 4px 20px rgba(0,0,0,0.1)',
+    padding: '2rem',
+    maxWidth: '480px',
+    width: '100%',
+    textAlign: 'center'
+  },
+  logo: {
+    marginBottom: '1.5rem',
+    paddingBottom: '1.5rem',
+    borderBottom: '1px solid #eee'
+  },
+  invoiceHeader: {
+    marginBottom: '1.5rem'
+  },
+  clientName: {
+    color: '#666',
+    fontSize: '1.1rem'
+  },
+  details: {
+    backgroundColor: '#f8f9fa',
+    borderRadius: '8px',
+    padding: '1rem',
+    marginBottom: '1.5rem',
+    textAlign: 'left'
+  },
+  detailRow: {
+    display: 'flex',
+    justifyContent: 'space-between',
+    padding: '0.5rem 0',
+    borderBottom: '1px solid #eee'
+  },
+  totalRow: {
+    borderBottom: 'none',
+    paddingTop: '1rem',
+    marginTop: '0.5rem',
+    borderTop: '2px solid #ddd'
+  },
+  amountDue: {
+    fontSize: '1.5rem',
+    fontWeight: 'bold',
+    color: '#2c3e50'
+  },
+  payButton: {
+    width: '100%',
+    padding: '1rem 2rem',
+    fontSize: '1.1rem',
+    fontWeight: 'bold',
+    color: 'white',
+    backgroundColor: '#3498db',
+    border: 'none',
+    borderRadius: '8px',
+    cursor: 'pointer',
+    transition: 'background-color 0.2s'
+  },
+  payButtonDisabled: {
+    backgroundColor: '#95a5a6',
+    cursor: 'not-allowed'
+  },
+  secureNotice: {
+    marginTop: '1rem',
+    color: '#666',
+    fontSize: '0.875rem'
+  },
+  footer: {
+    marginTop: '2rem',
+    paddingTop: '1rem',
+    borderTop: '1px solid #eee',
+    color: '#666',
+    fontSize: '0.875rem'
+  },
+  successIcon: {
+    width: '60px',
+    height: '60px',
+    borderRadius: '50%',
+    backgroundColor: '#27ae60',
+    color: 'white',
+    fontSize: '2rem',
+    display: 'flex',
+    alignItems: 'center',
+    justifyContent: 'center',
+    margin: '0 auto 1rem'
+  },
+  spinner: {
+    width: '40px',
+    height: '40px',
+    border: '4px solid #f3f3f3',
+    borderTop: '4px solid #3498db',
+    borderRadius: '50%',
+    animation: 'spin 1s linear infinite',
+    margin: '0 auto 1rem'
+  },
+  cancelledBanner: {
+    backgroundColor: '#fff3cd',
+    color: '#856404',
+    padding: '0.75rem',
+    borderRadius: '8px',
+    marginBottom: '1rem'
+  },
+  errorBanner: {
+    backgroundColor: '#f8d7da',
+    color: '#721c24',
+    padding: '0.75rem',
+    borderRadius: '8px',
+    marginBottom: '1rem'
+  }
+};
+
+export default PaymentPage;
diff --git a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
index 8d2c5e6..19ac2fc 100644
--- a/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
+++ b/templates/crm-homecare/frontend/src/components/caregiver/CaregiverDashboard.jsx
@@ -5,9 +5,9 @@ import { API_BASE_URL } from '../../config';
 import { toast } from '../Toast';
 import CaregiverClientModal from '../CaregiverClientModal';
 import MileageTracker from './MileageTracker';
-import ShiftMissReport from './caregiver/ShiftMissReport';
-import CaregiverHelp from './caregiver/CaregiverHelp';
-import CaregiverMessages from './caregiver/CaregiverMessages';
+import ShiftMissReport from './ShiftMissReport';
+import CaregiverHelp from './CaregiverHelp';
+import CaregiverMessages from './CaregiverMessages';
 import { useGeolocation, useHaptics, useOfflineSync, useBackgroundGeolocation, isNative, platform } from '../../hooks/useNative';
 import OfflineBanner from '../OfflineBanner';
 
diff --git a/templates/crm-homecare/frontend/src/config.js b/templates/crm-homecare/frontend/src/config.js
index 3cc1606..d4d5d2a 100644
--- a/templates/crm-homecare/frontend/src/config.js
+++ b/templates/crm-homecare/frontend/src/config.js
@@ -1,152 +1,85 @@
-// config.js — API shim for Twomiah Care template
-// Maps CVHC's config.js function signatures to the new api service
-// This lets all CVHC components work without modification.
+// src/config.js - API utilities with token expiry handling
+export const API_BASE_URL = 'https://chippewa-home-care-api.onrender.com';
+
+// Global logout callback — set by App on mount
+let _onSessionExpired = null;
+export const setSessionExpiredCallback = (fn) => { _onSessionExpired = fn; };
+
+// Check if JWT is expired (without verifying signature)
+export const isTokenExpired = (token) => {
+  try {
+    const payload = JSON.parse(atob(token.split('.')[1]));
+    if (!payload.exp) return false;
+    return payload.exp * 1000 < Date.now();
+  } catch {
+    return true;
+  }
+};
+
+export const apiCall = async (endpoint, options = {}, token) => {
+  const headers = { 'Content-Type': 'application/json', ...options.headers };
+
+  if (token) {
+    if (isTokenExpired(token)) {
+      if (_onSessionExpired) _onSessionExpired();
+      throw new Error('SESSION_EXPIRED');
+    }
+    headers.Authorization = `Bearer ${token}`;
+  }
+
+  const response = await fetch(`${API_BASE_URL}${endpoint}`, { ...options, headers });
+
+  if (response.status === 401) {
+    if (_onSessionExpired) _onSessionExpired();
+    throw new Error('SESSION_EXPIRED');
+  }
+
+  if (response.status === 429) {
+    // Rate limited - return null silently instead of crashing
+    console.warn(`[Rate limited] ${endpoint} - will retry on next poll`);
+    return null;
+  }
+
+  if (!response.ok) {
+    const text = await response.text();
+    let msg = text;
+    try { msg = JSON.parse(text).error || text; } catch {}
+    throw new Error(msg);
+  }
+
+  return response.json();
+};
 
-export const API_BASE_URL = import.meta.env.VITE_API_URL || '{{BACKEND_URL}}';
+export const getClients = (token) => apiCall('/api/clients', { method: 'GET' }, token);
+export const createClient = (data, token) => apiCall('/api/clients', { method: 'POST', body: JSON.stringify(data) }, token);
+export const getClientDetails = (id, token) => apiCall(`/api/clients/${id}`, { method: 'GET' }, token);
+export const updateClient = (id, data, token) => apiCall(`/api/clients/${id}`, { method: 'PUT', body: JSON.stringify(data) }, token);
 
-import { api } from './services/api.js';
+export const getReferralSources = (token) => apiCall('/api/referral-sources', { method: 'GET' }, token);
+export const createReferralSource = (data, token) => apiCall('/api/referral-sources', { method: 'POST', body: JSON.stringify(data) }, token);
 
-// No-op callbacks (session handling done by api service)
-export const setSessionExpiredCallback = () => {};
-export const isTokenExpired = () => false;
+export const getCaregivers = (token) => apiCall('/api/users/caregivers', { method: 'GET' }, token);
+export const convertToAdmin = (userId, token) => apiCall('/api/users/convert-to-admin', { method: 'POST', body: JSON.stringify({ userId }) }, token);
 
-// Core apiCall - token param ignored (handled by api service interceptor)
-export const apiCall = (endpoint, options = {}, _token) => {
-  const method = (options.method || 'GET').toUpperCase();
-  const body = options.body ? JSON.parse(options.body) : undefined;
-  return api.request(method, endpoint.replace('/api', ''), body);
-};
+export const getSchedules = (caregiverId, token) => apiCall(`/api/schedules/${caregiverId}`, { method: 'GET' }, token);
+export const createSchedule = (data, token) => apiCall('/api/schedules', { method: 'POST', body: JSON.stringify(data) }, token);
 
-// ── Clients ───────────────────────────────────────────────────────
-export const getClients = (_t) => api.get('/clients?limit=200');
-export const createClient = (data, _t) => api.post('/clients', data);
-export const getClientDetails = (id, _t) => api.get(`/clients/${id}`);
-export const updateClient = (id, data, _t) => api.put(`/clients/${id}`, data);
-
-// ── Referral Sources / Payers ─────────────────────────────────────
-export const getReferralSources = (_t) => api.get('/payers');
-export const createReferralSource = (data, _t) => api.post('/payers', data);
-export const updateReferralSource = (id, data, _t) => api.put(`/payers/${id}`, data);
-
-// ── Caregivers ────────────────────────────────────────────────────
-export const getCaregivers = (_t) => api.get('/caregivers?limit=200').then(r => r.caregivers || r);
-export const getCaregiverDetails = (id, _t) => api.get(`/caregivers/${id}`);
-export const createCaregiver = (data, _t) => api.post('/caregivers', data);
-export const updateCaregiver = (id, data, _t) => api.put(`/caregivers/${id}`, data);
-export const convertToAdmin = (userId, _t) => api.patch(`/company/users/${userId}/role`, { role: 'admin' });
-
-// ── Schedules ─────────────────────────────────────────────────────
-export const getSchedules = (caregiverId, _t) => api.get(`/scheduling/schedules?caregiverId=${caregiverId}`);
-export const createSchedule = (data, _t) => api.post('/scheduling/schedules', data);
-export const updateSchedule = (id, data, _t) => api.put(`/scheduling/schedules/${id}`, data);
-export const deleteSchedule = (id, _t) => api.delete(`/scheduling/schedules/${id}`);
-
-// ── Time Tracking ─────────────────────────────────────────────────
-export const getTimeEntries = (_t, params = '') => api.get(`/time-tracking?${params}`);
-export const clockIn = (data, _t) => api.post('/time-tracking/clock-in', data);
-export const clockOut = (id, data, _t) => api.post('/time-tracking/clock-out', { timeEntryId: id, ...data });
-export const trackGPS = (id, data, _t) => api.post('/time-tracking/gps', { timeEntryId: id, ...data });
-
-// ── Billing ───────────────────────────────────────────────────────
-export const getInvoices = (_t) => api.get('/billing/invoices?limit=100').then(r => r.invoices || r);
-export const getInvoiceDetails = (id, _t) => api.get(`/billing/invoices/${id}`);
-export const generateInvoice = (data, _t) => api.post('/billing/invoices/generate', data);
-export const createInvoice = (data, _t) => api.post('/billing/invoices', data);
-export const updateInvoiceStatus = (id, data, _t) => api.patch(`/billing/invoices/${id}/status`, data);
-
-// ── Authorizations ────────────────────────────────────────────────
-export const getAuthorizations = (_t, clientId) => api.get(`/authorizations${clientId ? `?clientId=${clientId}` : ''}`);
-export const createAuthorization = (data, _t) => api.post('/authorizations', data);
-export const updateAuthorization = (id, data, _t) => api.put(`/authorizations/${id}`, data);
-
-// ── EVV / Claims ──────────────────────────────────────────────────
-export const getEVVVisits = (_t) => api.get('/evv?limit=100').then(r => r.visits || r);
-export const getClaims = (_t) => api.get('/claims?limit=100').then(r => r.claims || r);
-export const getEdiBatches = (_t) => api.get('/edi/batches');
-export const createEdiBatch = (data, _t) => api.post('/edi/batches', data);
-export const submitEdiBatch = (id, _t) => api.patch(`/edi/batches/${id}/submit`, {});
-
-// ── Payroll ───────────────────────────────────────────────────────
-export const getPayrollSummary = (start, end, _t) => api.get(`/payroll/summary?startDate=${start}&endDate=${end}`);
-export const getExpenses = (_t) => api.get('/payroll/expenses');
-export const createExpense = (data, _t) => api.post('/payroll/expenses', data);
-export const updateExpenseStatus = (id, status, _t) => api.patch(`/payroll/expenses/${id}/status`, { status });
-
-// ── Scheduling ────────────────────────────────────────────────────
-export const getTimeOff = (_t) => api.get('/scheduling/time-off');
-export const createTimeOff = (data, _t) => api.post('/scheduling/time-off', data);
-export const approveTimeOff = (id, _t) => api.patch(`/scheduling/time-off/${id}/approve`, {});
-export const rejectTimeOff = (id, _t) => api.patch(`/scheduling/time-off/${id}/reject`, {});
-export const getOpenShifts = (_t) => api.get('/scheduling/open-shifts');
-export const createOpenShift = (data, _t) => api.post('/scheduling/open-shifts', data);
-export const updateOpenShift = (id, data, _t) => api.patch(`/scheduling/open-shifts/${id}`, data);
-export const getAbsences = (_t) => api.get('/scheduling/absences');
-export const createAbsence = (data, _t) => api.post('/scheduling/absences', data);
-export const getNoshowAlerts = (_t) => api.get('/scheduling/noshow-alerts');
-export const resolveNoshowAlert = (id, data, _t) => api.patch(`/scheduling/noshow-alerts/${id}/resolve`, data);
-
-// ── Communication ─────────────────────────────────────────────────
-export const getCommunicationLog = (entityType, entityId, _t) => api.get(`/communication/log?entityType=${entityType}&entityId=${entityId}`);
-export const createCommunicationLog = (data, _t) => api.post('/communication/log', data);
-export const getMessageThreads = (_t) => api.get('/communication/threads');
-export const createMessageThread = (data, _t) => api.post('/communication/threads', data);
-export const getMessages = (threadId, _t) => api.get(`/communication/threads/${threadId}/messages`);
-export const sendMessage = (threadId, body, _t) => api.post(`/communication/threads/${threadId}/messages`, { body });
-
-// ── Forms ─────────────────────────────────────────────────────────
-export const getFormTemplates = (_t) => api.get('/forms/templates');
-export const createFormTemplate = (data, _t) => api.post('/forms/templates', data);
-export const updateFormTemplate = (id, data, _t) => api.put(`/forms/templates/${id}`, data);
-export const getFormSubmissions = (params, _t) => api.get(`/forms/submissions?${params}`);
-export const submitForm = (data, _t) => api.post('/forms/submissions', data);
-
-// ── Compliance ────────────────────────────────────────────────────
-export const getComplianceDashboard = (_t) => api.get('/compliance/dashboard');
-export const getPerformanceRatings = (caregiverId, _t) => api.get(`/compliance/ratings${caregiverId ? `?caregiverId=${caregiverId}` : ''}`);
-export const createPerformanceRating = (data, _t) => api.post('/compliance/ratings', data);
-export const getLoginActivity = (_t) => api.get('/compliance/login-activity');
-export const getBackgroundChecks = (caregiverId, _t) => api.get(`/caregivers/${caregiverId}/background-checks`);
-export const createBackgroundCheck = (caregiverId, data, _t) => api.post(`/caregivers/${caregiverId}/background-checks`, data);
-
-// ── Notifications ─────────────────────────────────────────────────
-export const getNotifications = (_t) => api.get('/notifications');
-export const markNotificationsRead = (ids, _t) => api.patch('/notifications/mark-read', { ids });
-export const getNotificationPrefs = (_t) => api.get('/notifications/preferences');
-export const updateNotificationPrefs = (data, _t) => api.put('/notifications/preferences', data);
-
-// ── Reports ───────────────────────────────────────────────────────
-export const getHoursByCaregiver = (start, end, _t) => api.get(`/reports/hours-by-caregiver?startDate=${start}&endDate=${end}`);
-export const getRevenue = (start, end, _t) => api.get(`/reports/revenue?startDate=${start}&endDate=${end}`);
-export const getClientCensus = (_t) => api.get('/reports/census');
-export const getPayerMix = (_t) => api.get('/reports/payer-mix');
-export const getRevenueForecast = (_t) => api.get('/reports/forecast');
-export const getNoshowRate = (start, end, _t) => api.get(`/reports/noshow-rate?startDate=${start}&endDate=${end}`);
-
-// ── Dashboard ─────────────────────────────────────────────────────
-export const getDashboardSummary = (_t) => api.get('/dashboard/stats');
-export const getDashboardReferrals = (_t) => api.get('/reports/payer-mix');
-export const getDashboardHours = (_t) => api.get('/reports/hours-by-caregiver');
-
-// ── Optimizer ─────────────────────────────────────────────────────
-export const getCompanyOptimizer = (_t) => api.get('/optimizer/company');
-export const getRouteOptimizer = (caregiverId, date, _t) => api.get(`/optimizer/routes?caregiverId=${caregiverId}&date=${date}`);
-
-// ── Audit ─────────────────────────────────────────────────────────
-export const getAuditLogs = (_t) => api.get('/audit?limit=100').then(r => r.logs || r);
-
-// ── Company / Portal ─────────────────────────────────────────────
-export const getCompanyInfo = (_t) => api.get('/company');
-export const updateCompanyInfo = (data, _t) => api.put('/company', data);
-export const generatePortalLink = (clientId, _t) => api.post('/portal/generate-link', { clientId });
-
-// Export for CSV (browser download)
-export const exportInvoicesCSV = async (_t) => {
-  const invoices = await getInvoices(_t);
-  const rows = [['Invoice #', 'Client', 'Period Start', 'Period End', 'Total', 'Status']];
-  (invoices || []).forEach(i => rows.push([i.invoiceNumber, `${i.client?.firstName} ${i.client?.lastName}`, i.billingPeriodStart, i.billingPeriodEnd, i.total, i.paymentStatus]));
-  const csv = rows.map(r => r.join(',')).join('\n');
-  const blob = new Blob([csv], { type: 'text/csv' });
-  const url = URL.createObjectURL(blob);
-  const a = document.createElement('a'); a.href = url; a.download = 'invoices.csv'; a.click();
-  URL.revokeObjectURL(url);
+export const clockIn = (data, token) => apiCall('/api/time-entries/clock-in', { method: 'POST', body: JSON.stringify(data) }, token);
+export const clockOut = (id, data, token) => apiCall(`/api/time-entries/${id}/clock-out`, { method: 'POST', body: JSON.stringify(data) }, token);
+export const trackGPS = (id, data, token) => apiCall(`/api/time-entries/${id}/gps`, { method: 'POST', body: JSON.stringify(data) }, token);
+
+export const getInvoices = (token) => apiCall('/api/billing/invoices', { method: 'GET' }, token);
+export const generateInvoice = (data, token) => apiCall('/api/billing/invoices/generate', { method: 'POST', body: JSON.stringify(data) }, token);
+export const updateInvoiceStatus = (id, data, token) => apiCall(`/api/billing/invoices/${id}/payment-status`, { method: 'PUT', body: JSON.stringify(data) }, token);
+
+export const getDashboardSummary = (token) => apiCall('/api/dashboard/summary', { method: 'GET' }, token);
+export const getDashboardReferrals = (token) => apiCall('/api/dashboard/referrals', { method: 'GET' }, token);
+export const getDashboardHours = (token) => apiCall('/api/dashboard/caregiver-hours', { method: 'GET' }, token);
+
+export const exportInvoicesCSV = async (token) => {
+  const headers = { 'Authorization': `Bearer ${token}` };
+  const response = await fetch(`${API_BASE_URL}/api/billing/export/invoices-csv`, { headers });
+  return response.blob();
 };
+
+export const updateNotificationPreferences = (data, token) => apiCall('/api/notifications/preferences', { method: 'PUT', body: JSON.stringify(data) }, token);
diff --git a/templates/crm-homecare/frontend/src/hooks/useNative.js b/templates/crm-homecare/frontend/src/hooks/useNative.js
index 74fe404..1086b34 100644
--- a/templates/crm-homecare/frontend/src/hooks/useNative.js
+++ b/templates/crm-homecare/frontend/src/hooks/useNative.js
@@ -1,154 +1,351 @@
 // hooks/useNative.js
 // Unified native capabilities hook — works on web AND native (iOS/Android via Capacitor)
-// Capacitor is a mobile runtime — on web, all APIs fall back to browser equivalents.
+// All Capacitor APIs fall back gracefully to browser APIs when running in a browser.
 
 import { useState, useEffect, useCallback, useRef } from 'react';
+import { Capacitor } from '@capacitor/core';
 
-// ── Safe Capacitor loader — never crashes on web ───────────────────
-const isNative = () => {
-  try {
-    return typeof window !== 'undefined' && window.Capacitor?.isNativePlatform?.() === true;
-  } catch {
-    return false;
-  }
-};
-
-const getCapacitor   = () => import('@capacitor/core').then(m => m.Capacitor).catch(() => null);
+// ── Lazy plugin loaders (don't crash on web if plugin unavailable) ─────────────
 const getGeolocation = () => import('@capacitor/geolocation').then(m => m.Geolocation).catch(() => null);
 const getNetwork     = () => import('@capacitor/network').then(m => m.Network).catch(() => null);
-const getCamera      = () => import('@capacitor/camera').then(m => m).catch(() => null);
+const getHaptics     = () => import('@capacitor/haptics').then(m => m.Haptics).catch(() => null);
 const getLocalNotif  = () => import('@capacitor/local-notifications').then(m => m.LocalNotifications).catch(() => null);
+const getBgGeo       = () => import('@capacitor-community/background-geolocation').then(m => m.BackgroundGeolocation).catch(() => null);
 
-export function useNative() {
-  const [platform, setPlatform] = useState('web');
-  const [networkStatus, setNetworkStatus] = useState({ connected: true, connectionType: 'unknown' });
-  const watchIdRef = useRef(null);
+export const isNative = Capacitor.isNativePlatform();
+export const platform = Capacitor.getPlatform(); // 'ios' | 'android' | 'web'
+
+// ── useNetwork ────────────────────────────────────────────────────────────────
+// Returns { online, connectionType } and listens for changes
+export function useNetwork() {
+  // Default to true — assume online until proven otherwise
+  // navigator.onLine is unreliable in Capacitor Android WebView
+  const [status, setStatus] = useState({ online: true, connectionType: 'unknown' });
 
   useEffect(() => {
-    (async () => {
-      try {
-        const Cap = await getCapacitor();
-        if (Cap) setPlatform(Cap.getPlatform?.() || 'web');
-      } catch { /* web — ignore */ }
-    })();
-  }, []);
+    let cleanup = () => {};
 
-  // ── Geolocation ───────────────────────────────────────────────────
-  const getCurrentPosition = useCallback(async () => {
-    try {
-      if (isNative()) {
-        const Geo = await getGeolocation();
-        if (Geo) return await Geo.getCurrentPosition({ enableHighAccuracy: true, timeout: 10000 });
+    async function init() {
+      const Network = await getNetwork();
+
+      if (Network && isNative) {
+        // Native: use Capacitor Network plugin
+        const current = await Network.getStatus();
+        setStatus({ online: current.connected, connectionType: current.connectionType });
+
+        const handle = await Network.addListener('networkStatusChange', s => {
+          setStatus({ online: s.connected, connectionType: s.connectionType });
+        });
+        cleanup = () => handle.remove();
+      } else {
+        // Web: use browser events
+        const onOnline  = () => setStatus(s => ({ ...s, online: true }));
+        const onOffline = () => setStatus(s => ({ ...s, online: false }));
+        window.addEventListener('online', onOnline);
+        window.addEventListener('offline', onOffline);
+        cleanup = () => {
+          window.removeEventListener('online', onOnline);
+          window.removeEventListener('offline', onOffline);
+        };
       }
-      // Web fallback
-      return await new Promise((resolve, reject) =>
-        navigator.geolocation.getCurrentPosition(
-          p => resolve({ coords: { latitude: p.coords.latitude, longitude: p.coords.longitude, accuracy: p.coords.accuracy } }),
-          reject,
-          { enableHighAccuracy: true, timeout: 10000 }
-        )
-      );
-    } catch {
-      return null;
     }
+
+    init();
+    return () => cleanup();
   }, []);
 
-  const watchPosition = useCallback(async (callback) => {
+  return status;
+}
+
+// ── useGeolocation ────────────────────────────────────────────────────────────
+// One-shot position grab + optional watch mode
+export function useGeolocation({ watch = false, highAccuracy = true } = {}) {
+  const [position, setPosition] = useState(null);
+  const [error, setError]       = useState(null);
+  const [loading, setLoading]   = useState(false);
+  const watchIdRef = useRef(null);
+
+  const getPosition = useCallback(async () => {
+    setLoading(true);
+    setError(null);
     try {
-      if (isNative()) {
-        const Geo = await getGeolocation();
-        if (Geo) {
-          watchIdRef.current = await Geo.watchPosition({ enableHighAccuracy: true }, callback);
-          return;
+      const Geolocation = await getGeolocation();
+
+      if (Geolocation && isNative) {
+        // Native: request permissions first
+        const perm = await Geolocation.requestPermissions();
+        if (perm.location !== 'granted') {
+          throw new Error('Location permission denied');
         }
+        const pos = await Geolocation.getCurrentPosition({
+          enableHighAccuracy: highAccuracy,
+          timeout: 15000,
+        });
+        setPosition({
+          latitude:  pos.coords.latitude,
+          longitude: pos.coords.longitude,
+          accuracy:  pos.coords.accuracy,
+          timestamp: pos.timestamp,
+        });
+      } else {
+        // Web: browser geolocation
+        await new Promise((resolve, reject) => {
+          navigator.geolocation.getCurrentPosition(
+            pos => {
+              setPosition({
+                latitude:  pos.coords.latitude,
+                longitude: pos.coords.longitude,
+                accuracy:  pos.coords.accuracy,
+                timestamp: pos.timestamp,
+              });
+              resolve();
+            },
+            err => reject(new Error(err.message)),
+            { enableHighAccuracy: highAccuracy, timeout: 15000 }
+          );
+        });
       }
-      watchIdRef.current = navigator.geolocation.watchPosition(
-        p => callback({ coords: { latitude: p.coords.latitude, longitude: p.coords.longitude, accuracy: p.coords.accuracy } }),
-        null,
-        { enableHighAccuracy: true }
-      );
-    } catch { /* ignore */ }
-  }, []);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  }, [highAccuracy]);
 
-  const clearWatch = useCallback(async () => {
-    if (watchIdRef.current == null) return;
-    try {
-      if (isNative()) {
-        const Geo = await getGeolocation();
-        if (Geo) await Geo.clearWatch({ id: watchIdRef.current });
+  // Watch mode
+  useEffect(() => {
+    if (!watch) return;
+    let cancelled = false;
+
+    async function startWatch() {
+      const Geolocation = await getGeolocation();
+      if (Geolocation && isNative) {
+        watchIdRef.current = await Geolocation.watchPosition(
+          { enableHighAccuracy: true },
+          (pos, err) => {
+            if (cancelled) return;
+            if (err) { setError(err.message); return; }
+            setPosition({
+              latitude:  pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy:  pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          }
+        );
       } else {
-        navigator.geolocation.clearWatch(watchIdRef.current);
+        watchIdRef.current = navigator.geolocation.watchPosition(
+          pos => {
+            if (cancelled) return;
+            setPosition({
+              latitude:  pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy:  pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          },
+          err => setError(err.message),
+          { enableHighAccuracy: true }
+        );
       }
-    } catch { /* ignore */ }
-    watchIdRef.current = null;
+    }
+
+    startWatch();
+    return () => {
+      cancelled = true;
+      if (watchIdRef.current !== null) {
+        getGeolocation().then(G => {
+          if (G && isNative) G.clearWatch({ id: watchIdRef.current });
+          else navigator.geolocation.clearWatch(watchIdRef.current);
+        });
+      }
+    };
+  }, [watch]);
+
+  return { position, error, loading, getPosition };
+}
+
+// ── useHaptics ────────────────────────────────────────────────────────────────
+// Returns haptic feedback functions — no-ops on web
+export function useHaptics() {
+  const impact = useCallback(async (style = 'medium') => {
+    if (!isNative) return;
+    const Haptics = await getHaptics();
+    if (!Haptics) return;
+    const styleMap = { light: 'LIGHT', medium: 'MEDIUM', heavy: 'HEAVY' };
+    await Haptics.impact({ style: styleMap[style] || 'MEDIUM' }).catch(() => {});
+  }, []);
+
+  const notification = useCallback(async (type = 'success') => {
+    if (!isNative) return;
+    const Haptics = await getHaptics();
+    if (!Haptics) return;
+    const typeMap = { success: 'SUCCESS', warning: 'WARNING', error: 'ERROR' };
+    await Haptics.notification({ type: typeMap[type] || 'SUCCESS' }).catch(() => {});
   }, []);
 
-  // ── Camera ────────────────────────────────────────────────────────
-  const takePhoto = useCallback(async () => {
+  return { impact, notification };
+}
+
+// ── useOfflineSync ────────────────────────────────────────────────────────────
+// Reads the offline queue from IndexedDB and exposes sync status
+export function useOfflineSync() {
+  const [queueCount, setQueueCount] = useState(0);
+  const [syncing, setSyncing]       = useState(false);
+  const { online } = useNetwork();
+
+  const openDB = () => new Promise((resolve, reject) => {
+    const req = indexedDB.open('homecare-offline', 1);
+    req.onupgradeneeded = e => e.target.result.createObjectStore('queue', { keyPath: 'id' });
+    req.onsuccess = e => resolve(e.target.result);
+    req.onerror   = e => reject(e.target.error);
+  });
+
+  const getQueueCount = useCallback(async () => {
     try {
-      if (isNative()) {
-        const cam = await getCamera();
-        if (cam) {
-          return await cam.Camera.getPhoto({
-            quality: 85,
-            allowEditing: false,
-            resultType: cam.CameraResultType.DataUrl,
-            source: cam.CameraSource.Camera,
-          });
-        }
-      }
-      // Web fallback — trigger file input
-      return await new Promise((resolve) => {
-        const input = document.createElement('input');
-        input.type = 'file';
-        input.accept = 'image/*';
-        input.capture = 'environment';
-        input.onchange = e => {
-          const file = e.target.files[0];
-          if (!file) return resolve(null);
-          const reader = new FileReader();
-          reader.onload = ev => resolve({ dataUrl: ev.target.result, format: 'jpeg' });
-          reader.readAsDataURL(file);
-        };
-        input.click();
-      });
-    } catch {
-      return null;
-    }
+      const db  = await openDB();
+      const tx  = db.transaction('queue', 'readonly');
+      const req = tx.objectStore('queue').count();
+      req.onsuccess = () => setQueueCount(req.result);
+    } catch { /* ignore */ }
   }, []);
 
-  // ── Network ───────────────────────────────────────────────────────
+  // Poll queue count every 5s
   useEffect(() => {
-    let handler = null;
-    (async () => {
+    getQueueCount();
+    const interval = setInterval(getQueueCount, 5000);
+    return () => clearInterval(interval);
+  }, [getQueueCount]);
+
+  // Listen for SW messages
+  useEffect(() => {
+    const handler = (event) => {
+      if (event.data?.type === 'SYNCED' || event.data?.type === 'QUEUED') {
+        getQueueCount();
+      }
+    };
+    navigator.serviceWorker?.addEventListener('message', handler);
+    return () => navigator.serviceWorker?.removeEventListener('message', handler);
+  }, [getQueueCount]);
+
+  // Auto-trigger background sync when back online
+  useEffect(() => {
+    if (online && queueCount > 0) {
+      setSyncing(true);
+      navigator.serviceWorker?.ready
+        .then(sw => sw.sync?.register('sync-queue'))
+        .catch(() => {})
+        .finally(() => setTimeout(() => setSyncing(false), 2000));
+    }
+  }, [online, queueCount]);
+
+  return { queueCount, syncing, online };
+}
+
+
+// ── useBackgroundGeolocation ──────────────────────────────────────────────────
+// Runs a foreground service on Android that keeps GPS active even when the
+// screen is off or the app is backgrounded. Shows a persistent notification
+// so Android doesn't kill it. Falls back to regular watchPosition on web/iOS.
+export function useBackgroundGeolocation() {
+  const [isRunning, setIsRunning] = useState(false);
+
+  const start = useCallback(async ({ onLocation, notificationTitle = 'CVHC HomeCare', notificationText = 'Monitoring your location for auto clock-in' } = {}) => {
+    const BgGeo = await getBgGeo();
+
+    if (BgGeo && isNative && platform === 'android') {
       try {
-        if (isNative()) {
-          const Net = await getNetwork();
-          if (Net) {
-            const status = await Net.getStatus();
-            setNetworkStatus(status);
-            handler = await Net.addListener('networkStatusChange', setNetworkStatus);
-          }
-        } else {
-          const update = () => setNetworkStatus({ connected: navigator.onLine, connectionType: 'unknown' });
-          window.addEventListener('online', update);
-          window.addEventListener('offline', update);
-          return () => { window.removeEventListener('online', update); window.removeEventListener('offline', update); };
+        // Request permissions first
+        const Geo = await getGeolocation();
+        if (Geo) {
+          const perm = await Geo.requestPermissions({ permissions: ['location', 'coarseLocation'] });
+          if (perm.location !== 'granted') throw new Error('Location permission denied');
         }
-      } catch { /* ignore */ }
-    })();
-    return () => { handler?.remove?.(); };
+
+        await BgGeo.addWatcher(
+          {
+            backgroundMessage: notificationText,
+            backgroundTitle: notificationTitle,
+            requestPermissions: true,
+            stale: false,
+            distanceFilter: 20, // meters — only fire if moved 20m
+          },
+          (location, error) => {
+            if (error) {
+              console.warn('[BgGeo]', error.code, error.message);
+              return;
+            }
+            if (onLocation) onLocation({
+              latitude: location.latitude,
+              longitude: location.longitude,
+              accuracy: location.accuracy,
+              timestamp: location.time,
+            });
+          }
+        );
+        setIsRunning(true);
+        console.log('[BgGeo] Background geolocation started');
+      } catch (err) {
+        console.warn('[BgGeo] Failed to start background geolocation:', err.message);
+        // Fall back to regular watch
+        setIsRunning(false);
+      }
+    } else {
+      // Web or iOS — use regular watchPosition as fallback
+      if ('geolocation' in navigator) {
+        navigator.geolocation.watchPosition(
+          pos => {
+            if (onLocation) onLocation({
+              latitude: pos.coords.latitude,
+              longitude: pos.coords.longitude,
+              accuracy: pos.coords.accuracy,
+              timestamp: pos.timestamp,
+            });
+          },
+          err => console.warn('[BgGeo fallback]', err.message),
+          { enableHighAccuracy: true, maximumAge: 10000 }
+        );
+        setIsRunning(true);
+      }
+    }
   }, []);
 
-  return {
-    platform,
-    isNative: isNative(),
-    networkStatus,
-    getCurrentPosition,
-    watchPosition,
-    clearWatch,
-    takePhoto,
-  };
+  const stop = useCallback(async () => {
+    const BgGeo = await getBgGeo();
+    if (BgGeo && isNative && platform === 'android') {
+      await BgGeo.removeAllWatchers().catch(() => {});
+    }
+    setIsRunning(false);
+  }, []);
+
+  return { start, stop, isRunning };
 }
 
-export default useNative;
+// ── useLocalNotifications ─────────────────────────────────────────────────────
+// Schedule local notifications (shift reminders etc)
+export function useLocalNotifications() {
+  const schedule = useCallback(async ({ title, body, id, at }) => {
+    const LN = await getLocalNotif();
+    if (!LN || !isNative) return;
+    const perm = await LN.requestPermissions();
+    if (perm.display !== 'granted') return;
+    await LN.schedule({
+      notifications: [{
+        id: id || Date.now(),
+        title,
+        body,
+        schedule: at ? { at: new Date(at) } : undefined,
+        sound: 'default',
+        smallIcon: 'ic_stat_icon_config_sample',
+      }]
+    });
+  }, []);
+
+  const cancel = useCallback(async (id) => {
+    const LN = await getLocalNotif();
+    if (!LN || !isNative) return;
+    await LN.cancel({ notifications: [{ id }] });
+  }, []);
+
+  return { schedule, cancel };
+}
diff --git a/templates/crm-homecare/frontend/src/index.jsx b/templates/crm-homecare/frontend/src/index.jsx
new file mode 100644
index 0000000..bdb7128
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/index.jsx
@@ -0,0 +1,28 @@
+// src/index.jsx - React app entry point
+import React from "react";
+import ReactDOM from "react-dom/client";
+import App from "./App";
+
+// Only register service worker on web — not in Capacitor native APK
+// The SW intercepts fetch requests inside the WebView and causes login failures
+const isNativeApp = !!(window.Capacitor?.isNativePlatform?.()) || 
+  document.URL.indexOf('capacitor://') === 0 ||
+  document.URL.indexOf('https://localhost') === 0;
+
+if ("serviceWorker" in navigator && !isNativeApp) {
+  window.addEventListener("load", () => {
+    navigator.serviceWorker.register("/sw.js")
+      .then(reg => {
+        console.log("[SW] Registered:", reg.scope);
+        reg.sync?.register("sync-queue").catch(() => {});
+      })
+      .catch(err => console.warn("[SW] Registration failed:", err));
+  });
+}
+
+const root = ReactDOM.createRoot(document.getElementById("root"));
+root.render(
+  <React.StrictMode>
+    <App />
+  </React.StrictMode>
+);
diff --git a/templates/crm-homecare/frontend/src/styles.css b/templates/crm-homecare/frontend/src/styles.css
new file mode 100644
index 0000000..262a210
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/styles.css
@@ -0,0 +1,1340 @@
+:root {
+    --color-teal: #2ABBA7;
+    --color-teal-dark: #1E9A89;
+    --color-teal-light: #E8F8F6;
+    --color-gold: #C9A227;
+    --color-gold-light: #D4AF37;
+    --color-gold-pale: #FDF8E8;
+    --color-cream: #FDFCFA;
+    --color-white: #FFFFFF;
+    --color-text: #2D3A3A;
+    --color-text-light: #5A6B6B;
+    --color-gray: #F5F5F5;
+    --color-red: #DC3545;
+    --color-green: #28A745;
+    --color-blue: #0066CC;
+    --primary: #17a2b8;
+    --font-display: 'Cormorant Garamond', Georgia, serif;
+    --font-body: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
+    --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
+    --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
+    --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
+}
+
+* {
+    margin: 0;
+    padding: 0;
+    box-sizing: border-box;
+}
+
+html {
+    scroll-behavior: smooth;
+}
+
+body {
+    font-family: var(--font-body);
+    color: var(--color-text);
+    background-color: var(--color-gray);
+    line-height: 1.6;
+    font-size: 16px;
+    overflow-x: hidden;
+}
+
+/* Layout */
+#root {
+    display: flex;
+    min-height: 100vh;
+    width: 100%;
+    overflow-x: hidden;
+}
+
+/* Sidebar Navigation */
+.sidebar {
+    width: 280px;
+    min-width: 280px;
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+    padding: 2rem 1rem;
+    overflow-y: auto;
+    position: fixed;
+    height: 100vh;
+    z-index: 1000;
+    display: flex;
+    flex-direction: column;
+}
+
+.sidebar-nav {
+    list-style: none;
+    flex: 1;
+    overflow-y: auto;
+    padding-bottom: 2rem;
+}
+
+.sidebar-logo {
+    font-family: var(--font-display);
+    font-size: 1.8rem;
+    font-weight: 600;
+    margin-bottom: 2rem;
+    display: flex;
+    align-items: center;
+    gap: 0.5rem;
+}
+
+.sidebar-nav li {
+    margin-bottom: 0.5rem;
+}
+
+.sidebar-nav a {
+    display: block;
+    padding: 0.75rem 1rem;
+    color: rgba(255,255,255,0.85);
+    text-decoration: none;
+    border-radius: 6px;
+    transition: all 0.3s ease;
+    font-weight: 500;
+    font-size: 0.95rem;
+}
+
+.sidebar-nav a:hover,
+.sidebar-nav a.active {
+    background: rgba(255,255,255,0.15);
+    color: white;
+    padding-left: 1.5rem;
+}
+
+.sidebar-nav a.active {
+    background: rgba(255,255,255,0.25);
+    border-left: 3px solid var(--color-gold);
+}
+
+.sidebar-user {
+    position: relative;
+    padding: 1rem;
+    background: rgba(0,0,0,0.15);
+    border-radius: 8px;
+    margin-top: auto;
+}
+
+.sidebar-user-name {
+    font-weight: 600;
+    font-size: 0.9rem;
+    margin-bottom: 0.5rem;
+}
+
+.sidebar-user-role {
+    font-size: 0.8rem;
+    opacity: 0.8;
+    margin-bottom: 1rem;
+}
+
+.btn-logout {
+    width: 100%;
+    padding: 0.5rem;
+    background: rgba(255,255,255,0.2);
+    color: white;
+    border: none;
+    border-radius: 4px;
+    cursor: pointer;
+    font-size: 0.85rem;
+    transition: all 0.3s ease;
+}
+
+.btn-logout:hover {
+    background: rgba(255,255,255,0.3);
+}
+
+/* Main Content */
+.main-content {
+    flex: 1;
+    margin-left: 280px;
+    overflow-x: hidden;
+    background: var(--color-gray);
+    min-width: 0;
+    width: calc(100% - 280px);
+}
+
+.header {
+    background: white;
+    padding: 1.5rem 2rem;
+    border-bottom: 1px solid #e0e0e0;
+    box-shadow: var(--shadow-sm);
+    margin-bottom: 1.5rem;
+}
+
+.header h1 {
+    font-family: var(--font-display);
+    font-size: 1.8rem;
+    font-weight: 600;
+    color: var(--color-teal-dark);
+    margin-bottom: 0.25rem;
+}
+
+.header p {
+    color: var(--color-text-light);
+    font-size: 0.9rem;
+}
+
+/* Container */
+.container {
+    padding: 1.5rem;
+    width: 100%;
+    max-width: 100%;
+    overflow-x: hidden;
+}
+
+/* Page Header */
+.page-header {
+    display: flex;
+    flex-wrap: wrap;
+    justify-content: space-between;
+    align-items: center;
+    gap: 1rem;
+    margin-bottom: 1.5rem;
+}
+
+.page-header h2 {
+    font-family: var(--font-display);
+    font-size: 1.6rem;
+    color: var(--color-teal-dark);
+}
+
+/* Cards */
+.card {
+    background: white;
+    border-radius: 8px;
+    padding: 1.25rem;
+    margin-bottom: 1.25rem;
+    box-shadow: var(--shadow-sm);
+    overflow: hidden;
+}
+
+.card:hover {
+    box-shadow: var(--shadow-md);
+}
+
+.card-centered {
+    text-align: center;
+}
+
+.card-title {
+    font-family: var(--font-display);
+    font-size: 1.3rem;
+    font-weight: 600;
+    color: var(--color-teal-dark);
+    margin-bottom: 1rem;
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+}
+
+.card-form {
+    max-width: 800px;
+}
+
+/* Grid Layout */
+.grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
+    gap: 1.25rem;
+    margin-bottom: 1.25rem;
+}
+
+.stat-card {
+    background: linear-gradient(135deg, var(--color-teal-light) 0%, #f0f9f7 100%);
+    border-left: 4px solid var(--color-teal);
+    padding: 1.25rem;
+    border-radius: 8px;
+}
+
+.stat-card h3 {
+    color: var(--color-text-light);
+    font-size: 0.8rem;
+    font-weight: 600;
+    text-transform: uppercase;
+    margin-bottom: 0.5rem;
+}
+
+.stat-card .value {
+    font-size: 1.8rem;
+    font-weight: 700;
+    color: var(--color-teal-dark);
+}
+
+.stat-card .value-danger { color: var(--color-red); }
+.stat-card .value-success { color: var(--color-green); }
+.stat-subtext {
+    font-size: 0.8rem;
+    color: var(--color-text-light);
+    margin-top: 0.25rem;
+}
+
+/* Forms */
+.form-group {
+    margin-bottom: 1.25rem;
+}
+
+.form-group label {
+    display: block;
+    margin-bottom: 0.4rem;
+    font-weight: 600;
+    color: var(--color-text);
+    font-size: 0.9rem;
+}
+
+.form-group input,
+.form-group select,
+.form-group textarea {
+    width: 100%;
+    padding: 0.6rem;
+    border: 1px solid #ddd;
+    border-radius: 6px;
+    font-family: var(--font-body);
+    font-size: 0.9rem;
+    transition: all 0.3s ease;
+}
+
+.form-group input:focus,
+.form-group select:focus,
+.form-group textarea:focus {
+    outline: none;
+    border-color: var(--color-teal);
+    box-shadow: 0 0 0 3px rgba(42, 187, 167, 0.1);
+}
+
+.form-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
+    gap: 1rem;
+}
+
+.form-grid-2 {
+    display: grid;
+    grid-template-columns: repeat(2, 1fr);
+    gap: 1rem;
+}
+
+.form-grid-3 {
+    display: grid;
+    grid-template-columns: repeat(3, 1fr);
+    gap: 1rem;
+}
+
+/* Buttons */
+.btn {
+    padding: 0.6rem 1.2rem;
+    border: none;
+    border-radius: 6px;
+    font-weight: 600;
+    font-size: 0.9rem;
+    cursor: pointer;
+    transition: all 0.3s ease;
+    display: inline-flex;
+    align-items: center;
+    gap: 0.4rem;
+    text-decoration: none;
+    white-space: nowrap;
+}
+
+.btn-primary {
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+}
+
+.btn-primary:hover {
+    transform: translateY(-2px);
+    box-shadow: var(--shadow-md);
+}
+
+.btn-secondary {
+    background: #f0f0f0;
+    color: var(--color-text);
+}
+
+.btn-secondary:hover { background: #e0e0e0; }
+.btn-danger { background: var(--color-red); color: white; }
+.btn-danger:hover { background: #c82333; }
+.btn-success { background: #4caf50; color: white; border: none; }
+.btn-success:hover:not(:disabled) { background: #388e3c; }
+.btn-warning { background: #ffc107; color: #212529; }
+.btn-sm { padding: 0.35rem 0.7rem; font-size: 0.8rem; }
+.btn-block { width: 100%; justify-content: center; }
+
+/* Tables - CRITICAL: Always scrollable */
+.card > .table,
+.table {
+    width: 100%;
+    min-width: 500px;
+    border-collapse: collapse;
+    margin-top: 0.5rem;
+    display: table;
+}
+
+/* Make cards with tables scrollable */
+.card:has(.table) {
+    overflow-x: auto;
+    -webkit-overflow-scrolling: touch;
+}
+
+.table th {
+    background: var(--color-gray);
+    padding: 0.6rem 0.5rem;
+    text-align: left;
+    font-weight: 600;
+    color: var(--color-text);
+    border-bottom: 2px solid #ddd;
+    font-size: 0.8rem;
+    text-transform: uppercase;
+    white-space: nowrap;
+}
+
+.table td {
+    padding: 0.6rem 0.5rem;
+    border-bottom: 1px solid #f0f0f0;
+    vertical-align: middle;
+}
+
+.table tr:hover { background: var(--color-teal-light); }
+.table td:last-child { white-space: nowrap; }
+.table .btn + .btn { margin-left: 0.25rem; }
+
+/* Status Badges */
+.badge {
+    display: inline-block;
+    padding: 0.25rem 0.5rem;
+    border-radius: 20px;
+    font-size: 0.7rem;
+    font-weight: 600;
+    text-transform: uppercase;
+    white-space: nowrap;
+}
+
+.badge-success { background: #d4edda; color: #155724; }
+.badge-warning { background: #fff3cd; color: #856404; }
+.badge-danger { background: #f8d7da; color: #721c24; }
+.badge-info { background: #d1ecf1; color: #0c5460; }
+.badge-primary { background: var(--primary); color: white; }
+.badge-secondary { background: #999; color: white; }
+
+/* Filter Controls */
+.filter-controls {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.75rem;
+    margin-bottom: 1rem;
+}
+
+.filter-controls input,
+.filter-controls select {
+    padding: 0.5rem 0.75rem;
+    border: 1px solid #ddd;
+    border-radius: 6px;
+    font-size: 0.85rem;
+}
+
+.search-input {
+    flex: 1;
+    min-width: 150px;
+    max-width: 300px;
+}
+
+.filter-tabs {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.4rem;
+    margin-top: 0.75rem;
+}
+
+.filter-tab {
+    padding: 0.4rem 0.8rem;
+    background: #f0f0f0;
+    border: none;
+    border-radius: 20px;
+    cursor: pointer;
+    font-size: 0.8rem;
+    transition: all 0.2s;
+}
+
+.filter-tab.active { background: var(--color-teal); color: white; }
+.filter-count { opacity: 0.7; font-size: 0.75rem; margin-left: 0.25rem; }
+
+/* Modals */
+.modal {
+    display: none;
+    position: fixed;
+    z-index: 2000;
+    left: 0;
+    top: 0;
+    width: 100%;
+    height: 100%;
+    background: rgba(0,0,0,0.5);
+    align-items: center;
+    justify-content: center;
+    padding: 1rem;
+}
+
+.modal.active { display: flex; }
+
+.modal-content {
+    background: white;
+    padding: 1.25rem;
+    border-radius: 12px;
+    max-width: 600px;
+    width: 100%;
+    max-height: 90vh;
+    overflow-y: auto;
+    box-shadow: var(--shadow-lg);
+}
+
+.modal-large { max-width: 900px; }
+
+.modal-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    margin-bottom: 1.25rem;
+    padding-bottom: 0.75rem;
+    border-bottom: 1px solid #f0f0f0;
+}
+
+.modal-header h2 {
+    font-family: var(--font-display);
+    color: var(--color-teal-dark);
+    font-size: 1.4rem;
+}
+
+.modal-actions {
+    display: flex;
+    gap: 0.75rem;
+    justify-content: flex-end;
+    margin-top: 1.25rem;
+    padding-top: 0.75rem;
+    border-top: 1px solid #f0f0f0;
+}
+
+.close-btn {
+    background: none;
+    border: none;
+    font-size: 1.8rem;
+    cursor: pointer;
+    color: #999;
+    transition: color 0.3s ease;
+    line-height: 1;
+}
+
+.close-btn:hover { color: var(--color-text); }
+
+/* Alerts */
+.alert {
+    padding: 0.75rem 1rem;
+    border-radius: 6px;
+    margin-bottom: 1rem;
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+    font-size: 0.9rem;
+}
+
+.alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
+.alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
+.alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
+.alert-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
+
+/* Loading */
+.loading {
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    padding: 2rem;
+}
+
+.spinner {
+    border: 4px solid var(--color-gray);
+    border-top: 4px solid var(--color-teal);
+    border-radius: 50%;
+    width: 40px;
+    height: 40px;
+    animation: spin 1s linear infinite;
+}
+
+@keyframes spin {
+    0% { transform: rotate(0deg); }
+    100% { transform: rotate(360deg); }
+}
+
+/* Text Utilities */
+.text-muted { color: var(--color-text-light); }
+.text-center { text-align: center; }
+.text-right { text-align: right; }
+
+/* Hamburger Button */
+.hamburger-btn {
+    display: none;
+    padding: 0.5rem 1rem;
+    background: var(--color-teal);
+    color: white;
+    border: none;
+    border-radius: 6px;
+    font-weight: 600;
+    cursor: pointer;
+}
+
+/* Sidebar Overlay */
+.sidebar-overlay {
+    display: none;
+    position: fixed;
+    top: 0;
+    left: 0;
+    right: 0;
+    bottom: 0;
+    background: rgba(0, 0, 0, 0.5);
+    z-index: 999;
+}
+
+.sidebar-overlay.active { display: block; }
+
+/* Login Page */
+.login-container {
+    display: flex;
+    height: 100vh;
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    align-items: center;
+    justify-content: center;
+}
+
+.login-card {
+    background: white;
+    padding: 2.5rem;
+    border-radius: 12px;
+    box-shadow: var(--shadow-lg);
+    width: 100%;
+    max-width: 380px;
+}
+
+.login-card h1 {
+    font-family: var(--font-display);
+    color: var(--color-teal-dark);
+    margin-bottom: 0.5rem;
+    font-size: 1.8rem;
+}
+
+.login-card p {
+    color: var(--color-text-light);
+    margin-bottom: 1.5rem;
+}
+
+.login-footer {
+    margin-top: 1.5rem;
+    font-size: 0.75rem;
+    color: #999;
+    text-align: center;
+}
+
+/* Applications Grid */
+.applications-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
+    gap: 1.25rem;
+}
+
+.application-card {
+    background: white;
+    border-radius: 8px;
+    padding: 1.25rem;
+    box-shadow: var(--shadow-sm);
+    cursor: pointer;
+    transition: all 0.2s;
+}
+
+.application-card:hover {
+    box-shadow: var(--shadow-md);
+    transform: translateY(-2px);
+}
+
+.app-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: flex-start;
+    margin-bottom: 0.75rem;
+}
+
+.app-header h4 { margin: 0; color: var(--color-teal-dark); }
+.app-date { font-size: 0.8rem; color: var(--color-text-light); }
+.app-body p { margin: 0.2rem 0; font-size: 0.85rem; }
+.app-certs { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.4rem; }
+
+.app-footer {
+    margin-top: 0.75rem;
+    padding-top: 0.6rem;
+    border-top: 1px solid #eee;
+    text-align: center;
+}
+
+.app-footer small { color: var(--color-text-light); }
+
+/* Quick Actions Grid */
+.quick-actions-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
+    gap: 0.75rem;
+}
+
+/* Card Empty State */
+.card-empty-state {
+    text-align: center;
+    padding: 1.5rem;
+    color: var(--color-text-light);
+}
+
+/* Star Rating */
+.star-icon { color: #ffc107; }
+
+/* Form Sections */
+.form-section {
+    margin-bottom: 2rem;
+    padding-bottom: 1.5rem;
+    border-bottom: 1px solid #eee;
+}
+
+.form-section:last-of-type { border-bottom: none; }
+
+.form-section h2 {
+    color: var(--primary);
+    font-size: 1.2rem;
+    margin-bottom: 1rem;
+    border-left: 4px solid var(--primary);
+    padding-left: 0.75rem;
+}
+
+.checkbox-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
+    gap: 0.75rem;
+    margin: 0.75rem 0;
+}
+
+.checkbox-label {
+    display: flex;
+    align-items: center;
+    gap: 0.5rem;
+    padding: 0.4rem;
+    cursor: pointer;
+    font-weight: 500;
+    transition: all 0.2s;
+    font-size: 0.9rem;
+}
+
+.checkbox-label:hover { color: var(--primary); }
+.checkbox-label input { cursor: pointer; width: 16px; height: 16px; }
+
+.form-actions {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.75rem;
+    justify-content: center;
+    margin-top: 1.25rem;
+    padding-top: 1.25rem;
+    border-top: 2px solid #eee;
+}
+
+/* Calendar */
+.calendar-container {
+    background: white;
+    border: 1px solid #ddd;
+    border-radius: 8px;
+    overflow: hidden;
+}
+
+.calendar-header {
+    display: grid;
+    grid-template-columns: repeat(7, 1fr);
+    background: #f5f5f5;
+    border-bottom: 2px solid #ddd;
+}
+
+.calendar-day-name {
+    padding: 0.75rem;
+    font-weight: bold;
+    text-align: center;
+    color: var(--primary);
+    border-right: 1px solid #eee;
+    font-size: 0.85rem;
+}
+
+.calendar-day-name:last-child { border-right: none; }
+
+.calendar-grid {
+    display: grid;
+    grid-template-columns: repeat(7, 1fr);
+    min-height: 400px;
+}
+
+.calendar-cell {
+    border: 1px solid #eee;
+    padding: 0.5rem;
+    min-height: 80px;
+    cursor: pointer;
+    transition: background 0.2s;
+}
+
+.calendar-cell:hover { background: #f9f9f9; }
+.calendar-cell.has-schedules { background: #f0f7ff; }
+
+.calendar-day-number {
+    font-weight: bold;
+    font-size: 1rem;
+    margin-bottom: 0.25rem;
+    color: var(--primary);
+}
+
+/* Caregiver Dashboard Styles */
+.clock-card {
+    background: white;
+    border-radius: 12px;
+    padding: 1.5rem;
+    margin-bottom: 1.25rem;
+    box-shadow: var(--shadow-md);
+    text-align: center;
+}
+
+.clock-card.active {
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+}
+
+.clock-card.ready { border: 2px dashed var(--color-teal); }
+
+.clock-btn {
+    padding: 0.75rem 2rem;
+    font-size: 1.1rem;
+    font-weight: bold;
+    border: none;
+    border-radius: 50px;
+    cursor: pointer;
+    margin-top: 0.75rem;
+    transition: all 0.3s;
+}
+
+.clock-btn.clock-in { background: var(--color-green); color: white; }
+.clock-btn.clock-out { background: white; color: var(--color-red); }
+.clock-btn:disabled { opacity: 0.5; cursor: not-allowed; }
+
+.timer-display {
+    font-size: 2.5rem;
+    font-weight: bold;
+    font-family: 'Courier New', monospace;
+    margin: 0.75rem 0;
+}
+
+.gps-status {
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    gap: 0.4rem;
+    margin: 0.75rem 0;
+    font-size: 0.85rem;
+    color: var(--color-text-light);
+}
+
+.gps-dot {
+    width: 8px;
+    height: 8px;
+    border-radius: 50%;
+    background: var(--color-green);
+}
+
+.gps-dot.inactive { background: var(--color-red); }
+
+.schedule-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    margin-bottom: 0.75rem;
+}
+
+.schedule-header h3 { margin: 0; color: var(--color-teal-dark); font-size: 1.1rem; }
+
+.schedule-count {
+    background: var(--color-teal-light);
+    color: var(--color-teal-dark);
+    padding: 0.2rem 0.6rem;
+    border-radius: 20px;
+    font-size: 0.8rem;
+    font-weight: 600;
+}
+
+.schedule-list { display: flex; flex-direction: column; gap: 0.6rem; }
+
+.schedule-item {
+    display: flex;
+    gap: 0.75rem;
+    padding: 0.75rem;
+    background: var(--color-gray);
+    border-radius: 8px;
+    align-items: center;
+}
+
+.schedule-time { text-align: center; min-width: 60px; }
+.schedule-time-start { font-weight: bold; color: var(--color-teal-dark); font-size: 0.9rem; }
+.schedule-time-end { font-size: 0.8rem; color: var(--color-text-light); }
+.schedule-details { flex: 1; }
+.schedule-client { font-weight: 600; color: var(--color-text); }
+
+.schedule-meta {
+    font-size: 0.8rem;
+    color: var(--color-text-light);
+    display: flex;
+    align-items: center;
+    gap: 0.4rem;
+}
+
+.badge-weekly {
+    background: var(--color-gold-pale);
+    color: var(--color-gold);
+    padding: 0.1rem 0.4rem;
+    border-radius: 10px;
+    font-size: 0.7rem;
+    font-weight: 600;
+}
+
+.stats-grid-2 {
+    display: grid;
+    grid-template-columns: repeat(2, 1fr);
+    gap: 0.75rem;
+    margin-bottom: 1.25rem;
+}
+
+.stat-value-large { font-size: 2rem; font-weight: bold; }
+.stat-value-green { color: var(--color-green); }
+.stat-value-blue { color: var(--color-blue); }
+.stat-label { font-size: 0.85rem; color: var(--color-text-light); margin-top: 0.2rem; }
+
+.schedule-day-card { padding: 0; overflow: hidden; }
+
+.schedule-day-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    padding: 0.75rem;
+    background: var(--color-gray);
+}
+
+.schedule-day-header.today { background: var(--color-teal); color: white; }
+.schedule-day-name { font-weight: bold; display: block; }
+.schedule-day-date { font-size: 0.8rem; opacity: 0.8; }
+.schedule-day-hours { font-weight: bold; }
+.schedule-day-list { padding: 0.4rem; }
+
+.schedule-day-item {
+    display: flex;
+    gap: 0.75rem;
+    padding: 0.6rem;
+    border-bottom: 1px solid #eee;
+    align-items: center;
+}
+
+.schedule-day-item:last-child { border-bottom: none; }
+
+/* Availability Grid */
+.availability-grid { display: flex; flex-wrap: wrap; gap: 0.4rem; }
+.availability-badges { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.4rem; }
+
+/* Status Buttons */
+.status-buttons { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-bottom: 0.75rem; }
+
+/* Tabs */
+.tabs {
+    display: flex;
+    gap: 0.4rem;
+    margin-bottom: 1.25rem;
+    border-bottom: 2px solid #eee;
+    padding-bottom: 0.4rem;
+    flex-wrap: wrap;
+}
+
+/* ==========================================
+   RESPONSIVE STYLES
+   ========================================== */
+@media (max-width: 1024px) {
+    .grid { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
+    .form-grid-3 { grid-template-columns: repeat(2, 1fr); }
+}
+
+@media (max-width: 768px) {
+    .sidebar {
+        position: fixed;
+        left: 0;
+        top: 0;
+        width: 260px;
+        height: 100vh;
+        transform: translateX(-100%);
+        transition: transform 0.3s ease;
+        z-index: 1000;
+    }
+
+    .sidebar.open { transform: translateX(0); }
+
+    .main-content {
+        margin-left: 0;
+        width: 100%;
+    }
+
+    .hamburger-btn { display: block; }
+
+    .header {
+        padding: 0.75rem 1rem;
+        display: flex;
+        justify-content: space-between;
+        align-items: center;
+    }
+
+    .header h1 { font-size: 1.1rem; }
+    .header p { font-size: 0.75rem; display: none; }
+
+    .container { padding: 0.75rem; }
+
+    .page-header {
+        flex-direction: column;
+        align-items: flex-start;
+        gap: 0.75rem;
+    }
+
+    .page-header h2 { font-size: 1.3rem; }
+
+    .card {
+        padding: 0.75rem;
+        margin-bottom: 0.75rem;
+    }
+
+    .grid { grid-template-columns: 1fr; gap: 0.75rem; }
+
+    .form-grid,
+    .form-grid-2,
+    .form-grid-3 {
+        grid-template-columns: 1fr;
+    }
+
+    /* Tables scroll horizontally */
+    .table { font-size: 0.8rem; min-width: 450px; }
+    .table th, .table td { padding: 0.4rem 0.3rem; }
+    .table .btn-sm { padding: 0.25rem 0.4rem; font-size: 0.7rem; }
+
+    /* Calendar */
+    .calendar-grid { min-height: 250px; }
+    .calendar-cell { min-height: 50px; padding: 0.25rem; }
+    .calendar-day-number { font-size: 0.85rem; }
+    .calendar-day-name { padding: 0.4rem; font-size: 0.75rem; }
+
+    /* Modals slide up from bottom on mobile */
+    .modal-content {
+        width: 100%;
+        max-width: 100%;
+        max-height: 85vh;
+        margin: 0;
+        border-radius: 12px 12px 0 0;
+        position: fixed;
+        bottom: 0;
+        left: 0;
+        right: 0;
+    }
+
+    .modal-large { max-width: 100%; }
+
+    .form-actions, .modal-actions {
+        flex-direction: column;
+    }
+
+    .form-actions .btn,
+    .modal-actions .btn {
+        width: 100%;
+    }
+
+    .stat-card .value { font-size: 1.5rem; }
+    .badge { font-size: 0.65rem; padding: 0.15rem 0.35rem; }
+    .login-card { margin: 0.75rem; padding: 1.5rem; }
+    
+    .filter-controls { flex-direction: column; }
+    .search-input { max-width: 100%; }
+    .applications-grid { grid-template-columns: 1fr; }
+    .stats-grid-2 { grid-template-columns: 1fr; }
+    .timer-display { font-size: 2rem; }
+    .clock-btn { padding: 0.6rem 1.5rem; font-size: 1rem; }
+}
+
+@media (max-width: 480px) {
+    .header h1 { font-size: 1rem; }
+    .sidebar { width: 240px; }
+    .card { padding: 0.6rem; }
+    .btn { padding: 0.5rem 0.8rem; font-size: 0.8rem; }
+    .btn-sm { padding: 0.2rem 0.4rem; font-size: 0.65rem; }
+    .calendar-cell { min-height: 40px; }
+    .stat-value-large { font-size: 1.6rem; }
+    .modal-header h2 { font-size: 1.1rem; }
+}
+
+/* ═══════════════════════════════════════════════════════
+   MOBILE REDESIGN — Bottom Nav + Polish
+   ═══════════════════════════════════════════════════════ */
+
+@media (max-width: 768px) {
+
+  /* ── Bottom Navigation Bar ── */
+  .mobile-bottom-nav {
+    display: flex;
+    position: fixed;
+    bottom: 0;
+    left: 0;
+    right: 0;
+    height: calc(64px + env(safe-area-inset-bottom, 0px));
+    padding-bottom: env(safe-area-inset-bottom, 0px);
+    background: #fff;
+    border-top: 1px solid #E5E7EB;
+    z-index: 1100;
+    box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
+  }
+
+  .mobile-bottom-nav-item {
+    flex: 1;
+    display: flex;
+    flex-direction: column;
+    align-items: center;
+    justify-content: center;
+    gap: 3px;
+    border: none;
+    background: none;
+    cursor: pointer;
+    padding: 0.5rem 0;
+    color: #9CA3AF;
+    font-size: 0.62rem;
+    font-weight: 600;
+    letter-spacing: 0.02em;
+    text-transform: uppercase;
+    transition: color 0.15s;
+    -webkit-tap-highlight-color: transparent;
+    position: relative;
+  }
+
+  .mobile-bottom-nav-item.active {
+    color: #2ABBA7;
+  }
+
+  .mobile-bottom-nav-item.active::before {
+    content: '';
+    position: absolute;
+    top: 0;
+    left: 50%;
+    transform: translateX(-50%);
+    width: 32px;
+    height: 3px;
+    background: #2ABBA7;
+    border-radius: 0 0 3px 3px;
+  }
+
+  .mobile-bottom-nav-icon {
+    font-size: 1.3rem;
+    line-height: 1;
+  }
+
+  /* ── More Menu Drawer ── */
+  .mobile-more-drawer {
+    position: fixed;
+    bottom: 64px;
+    left: 0;
+    right: 0;
+    background: #fff;
+    border-top: 1px solid #E5E7EB;
+    z-index: 1099;
+    max-height: 60vh;
+    overflow-y: auto;
+    transform: translateY(100%);
+    transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
+    box-shadow: 0 -8px 32px rgba(0,0,0,0.12);
+    border-radius: 16px 16px 0 0;
+    padding-bottom: env(safe-area-inset-bottom, 0);
+  }
+
+  .mobile-more-drawer.open {
+    transform: translateY(0);
+  }
+
+  .mobile-more-drawer-handle {
+    width: 36px;
+    height: 4px;
+    background: #E5E7EB;
+    border-radius: 2px;
+    margin: 12px auto 8px;
+  }
+
+  .mobile-more-drawer-section {
+    padding: 0.5rem 1rem;
+  }
+
+  .mobile-more-drawer-section-title {
+    font-size: 0.7rem;
+    font-weight: 700;
+    color: #9CA3AF;
+    text-transform: uppercase;
+    letter-spacing: 0.08em;
+    padding: 0.5rem 0.25rem 0.35rem;
+  }
+
+  .mobile-more-drawer-item {
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+    padding: 0.75rem 0.5rem;
+    border-radius: 8px;
+    border: none;
+    background: none;
+    width: 100%;
+    text-align: left;
+    cursor: pointer;
+    font-size: 0.95rem;
+    color: #374151;
+    font-weight: 500;
+    -webkit-tap-highlight-color: transparent;
+    transition: background 0.1s;
+  }
+
+  .mobile-more-drawer-item:active,
+  .mobile-more-drawer-item.active {
+    background: #F0FDFB;
+    color: #2ABBA7;
+  }
+
+  .mobile-more-drawer-item-icon {
+    width: 36px;
+    height: 36px;
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    background: #F3F4F6;
+    border-radius: 8px;
+    font-size: 1.1rem;
+    flex-shrink: 0;
+  }
+
+  .mobile-more-drawer-item.active .mobile-more-drawer-item-icon {
+    background: #CCFBF1;
+  }
+
+  .mobile-more-drawer-overlay {
+    position: fixed;
+    inset: 0;
+    background: rgba(0,0,0,0.3);
+    z-index: 1098;
+  }
+
+  /* ── Padding for bottom nav ── */
+  .main-content {
+    padding-bottom: calc(72px + env(safe-area-inset-bottom, 0px)) !important;
+  }
+
+  /* ── Header improvements ── */
+  .header {
+    background: #fff !important;
+    border-bottom: 1px solid #E5E7EB;
+    box-shadow: 0 1px 4px rgba(0,0,0,0.06);
+    padding: 0.6rem 1rem !important;
+    min-height: 56px;
+  }
+
+  .header h1 {
+    font-size: 1rem !important;
+    font-weight: 700;
+    color: #111827;
+  }
+
+  /* Hide hamburger — replaced by bottom nav */
+  .hamburger-btn {
+    display: none !important;
+  }
+
+  /* ── Card improvements ── */
+  .card {
+    border-radius: 12px !important;
+    box-shadow: 0 1px 4px rgba(0,0,0,0.07) !important;
+    border: 1px solid #F3F4F6;
+  }
+
+  /* ── Stat cards ── */
+  .stat-card {
+    border-radius: 12px !important;
+    padding: 1rem !important;
+  }
+
+  .stat-card .value,
+  .stat-value-large {
+    font-size: 1.75rem !important;
+    font-weight: 800 !important;
+  }
+
+  /* ── Buttons — larger touch targets ── */
+  .btn {
+    min-height: 44px;
+    border-radius: 10px !important;
+    font-weight: 600 !important;
+  }
+
+  .btn-primary {
+    background: linear-gradient(135deg, #2ABBA7, #1E9A89) !important;
+    box-shadow: 0 2px 8px rgba(42, 187, 167, 0.3) !important;
+  }
+
+  /* ── Form inputs ── */
+  input[type="text"],
+  input[type="email"],
+  input[type="password"],
+  input[type="tel"],
+  input[type="date"],
+  input[type="time"],
+  input[type="number"],
+  select,
+  textarea {
+    min-height: 44px;
+    font-size: 16px !important; /* prevents iOS zoom */
+    border-radius: 10px !important;
+  }
+
+  /* ── Table improvements ── */
+  .table-wrapper {
+    overflow-x: auto;
+    -webkit-overflow-scrolling: touch;
+    border-radius: 12px;
+    border: 1px solid #E5E7EB;
+  }
+
+  /* ── Login page ── */
+  .login-container {
+    padding: 1.5rem;
+    align-items: flex-start;
+    padding-top: 4rem;
+  }
+
+  .login-card {
+    border-radius: 16px !important;
+    padding: 2rem 1.5rem !important;
+    box-shadow: 0 8px 32px rgba(0,0,0,0.12) !important;
+  }
+
+  /* ── Page header ── */
+  .page-header h2 {
+    font-size: 1.25rem !important;
+    font-weight: 800;
+  }
+
+  /* ── Container ── */
+  .container {
+    padding: 0.875rem !important;
+  }
+
+  /* ── Modal full-screen on mobile ── */
+  .modal-content {
+    border-radius: 20px 20px 0 0 !important;
+    max-height: 90vh !important;
+  }
+
+  .modal-header {
+    padding: 1rem 1.25rem 0.875rem !important;
+    border-radius: 20px 20px 0 0;
+  }
+}
diff --git a/templates/crm-homecare/frontend/vite.config.js b/templates/crm-homecare/frontend/vite.config.js
index 081fdd5..4be347e 100644
--- a/templates/crm-homecare/frontend/vite.config.js
+++ b/templates/crm-homecare/frontend/vite.config.js
@@ -3,11 +3,44 @@ import react from '@vitejs/plugin-react';
 
 export default defineConfig({
   plugins: [react()],
-  server: { port: 5173, host: true },
+  optimizeDeps: {
+    exclude: ['@capacitor-community/background-geolocation'],
+  },
+  server: {
+    port: 3000,
+    proxy: {
+      '/api': {
+        target: process.env.VITE_API_URL || 'http://localhost:5000',
+        changeOrigin: true,
+      },
+    },
+  },
   build: {
+    outDir: 'dist',
+    sourcemap: false,
+    minify: 'terser',
+    chunkSizeWarningLimit: 600,
     rollupOptions: {
-      // Capacitor packages are mobile-only — externalize so web build doesn't fail
-      external: (id) => id.startsWith('@capacitor/'),
+      external: (id) => id.startsWith('@capacitor/') || id === '@capacitor-community/background-geolocation',
+      output: {
+        manualChunks: {
+          'vendor-react': ['react', 'react-dom', 'react-router-dom'],
+          'admin-scheduling': [
+            './src/components/admin/SchedulingHub',
+            './src/components/admin/DragDropScheduler',
+            './src/components/admin/ScheduleCalendar',
+          ],
+          'admin-billing': [
+            './src/components/admin/BillingDashboard',
+            './src/components/admin/PayrollProcessing',
+            './src/components/admin/ClaimsManagement',
+          ],
+          'admin-reports': [
+            './src/components/admin/ReportsAnalytics',
+            './src/components/admin/AuditLogs',
+          ],
+        },
+      },
     },
   },
 });
-- 
2.43.0


From f58fae0427afce221394ad0ca66a944df661576f Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 21:28:09 +0000
Subject: [PATCH 15/27] fix: homecare backend - fix auth middleware ESM, stub
 reports.js, fix package.json deps

---
 .../crm-homecare/backend/package-lock.json    | 6443 ++++++++++++++---
 templates/crm-homecare/backend/package.json   |   67 +-
 templates/crm-homecare/backend/src/db.js      |   45 +
 .../backend/src/middleware/auditLogger.js     |  264 +
 .../backend/src/middleware/auth.js            |   54 +-
 .../backend/src/middleware/authorizeAdmin.js  |    9 +
 .../backend/src/middleware/shared.js          |   40 +
 .../backend/src/routes/absenceRoutes.js       |   72 +
 .../backend/src/routes/adlRoutes.js           |  185 +
 .../backend/src/routes/alertsRoutes.js        |  232 +
 .../backend/src/routes/applicationsRoutes.js  |  273 +
 .../backend/src/routes/auditLogs.js           |  110 +
 .../backend/src/routes/authRoutes.js          |  228 +
 .../backend/src/routes/authorizationRoutes.js |  215 +
 .../src/routes/backgroundChecksRoutes.js      |  146 +
 .../backend/src/routes/billingRoutes.js       |  978 +++
 .../backend/src/routes/caregiverRoutes.js     |  327 +
 .../backend/src/routes/claimsRoutes.js        |  286 +
 .../backend/src/routes/clientPortalRoutes.js  |  678 ++
 .../backend/src/routes/clientsRoutes.js       |  258 +
 .../backend/src/routes/clinicalRoutes.js      |  239 +
 .../backend/src/routes/communicationRoutes.js |   91 +
 .../backend/src/routes/dashboardRoutes.js     |   74 +
 .../backend/src/routes/documentsRoutes.js     |  216 +
 .../backend/src/routes/ediRoutes.js           |  259 +
 .../backend/src/routes/emergencyRoutes.js     |  384 +
 .../backend/src/routes/expenseRoutes.js       |  121 +
 .../backend/src/routes/failsafeRoutes.js      |  244 +
 .../backend/src/routes/familyPortalRoutes.js  |  402 +
 .../backend/src/routes/forecastRoutes.js      |  135 +
 .../backend/src/routes/formBuilderRoutes.js   |  150 +
 .../backend/src/routes/gustoRoutes.js         |  218 +
 .../backend/src/routes/matchingRoutes.js      |  835 +++
 .../backend/src/routes/medicationsRoutes.js   |  182 +
 .../backend/src/routes/messageRoutes.js       |  307 +
 .../backend/src/routes/miscRoutes.js          |  984 +++
 .../backend/src/routes/noShowRoutes.js        |  189 +
 .../backend/src/routes/notificationRoutes.js  |  118 +
 .../backend/src/routes/openShiftsRoutes.js    |  304 +
 .../backend/src/routes/optimizerRoutes.js     |  446 ++
 .../backend/src/routes/payrollRoutes.js       |  434 ++
 .../backend/src/routes/pricingRoutes.js       |  236 +
 .../backend/src/routes/prospectRoutes.js      |  111 +
 .../src/routes/pushNotificationRoutes.js      |  205 +
 .../backend/src/routes/referralRoutes.js      |   71 +
 .../backend/src/routes/remittanceRoutes.js    |  151 +
 .../backend/src/routes/reports.js             |  112 +-
 .../src/routes/rosterOptimizerRoutes.js       |  420 ++
 .../src/routes/routeOptimizerRoutes.js        | 1216 ++++
 .../backend/src/routes/routesIndex.js         |  186 +
 .../backend/src/routes/sandataRoutes.js       |  445 ++
 .../backend/src/routes/schedulesRoutes.js     |  202 +
 .../backend/src/routes/schedulingRoutes.js    |  381 +
 .../backend/src/routes/shiftSwapsRoutes.js    |  145 +
 .../backend/src/routes/smsRoutes.js           |  332 +
 .../backend/src/routes/stripeRoutes.js        |  387 +
 .../backend/src/routes/timeTrackingRoutes.js  |  286 +
 .../crm-homecare/backend/src/routes/users.js  |   81 +
 templates/crm-homecare/backend/src/server.js  |  342 +
 .../backend/src/services/encryptionService.js |   68 +
 .../backend/src/services/worcsService.js      |  195 +
 templates/crm-homecare/backend/src/testApp.js |  143 +
 .../backend/src/tests/auth.test.js            |  108 +
 .../backend/src/tests/payroll.test.js         |  144 +
 64 files changed, 22111 insertions(+), 1098 deletions(-)
 create mode 100644 templates/crm-homecare/backend/src/db.js
 create mode 100644 templates/crm-homecare/backend/src/middleware/auditLogger.js
 create mode 100644 templates/crm-homecare/backend/src/middleware/authorizeAdmin.js
 create mode 100644 templates/crm-homecare/backend/src/middleware/shared.js
 create mode 100644 templates/crm-homecare/backend/src/routes/absenceRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/adlRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/alertsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/applicationsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/auditLogs.js
 create mode 100644 templates/crm-homecare/backend/src/routes/authRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/authorizationRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/backgroundChecksRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/billingRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/caregiverRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/claimsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/clientPortalRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/clientsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/clinicalRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/communicationRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/dashboardRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/documentsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/ediRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/emergencyRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/expenseRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/failsafeRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/familyPortalRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/forecastRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/formBuilderRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/gustoRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/matchingRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/medicationsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/messageRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/miscRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/noShowRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/notificationRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/openShiftsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/optimizerRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/payrollRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/pricingRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/prospectRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/pushNotificationRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/referralRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/remittanceRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/rosterOptimizerRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/routeOptimizerRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/routesIndex.js
 create mode 100644 templates/crm-homecare/backend/src/routes/sandataRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/schedulesRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/schedulingRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/shiftSwapsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/smsRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/stripeRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/timeTrackingRoutes.js
 create mode 100644 templates/crm-homecare/backend/src/routes/users.js
 create mode 100644 templates/crm-homecare/backend/src/server.js
 create mode 100644 templates/crm-homecare/backend/src/services/encryptionService.js
 create mode 100644 templates/crm-homecare/backend/src/services/worcsService.js
 create mode 100644 templates/crm-homecare/backend/src/testApp.js
 create mode 100644 templates/crm-homecare/backend/src/tests/auth.test.js
 create mode 100644 templates/crm-homecare/backend/src/tests/payroll.test.js

diff --git a/templates/crm-homecare/backend/package-lock.json b/templates/crm-homecare/backend/package-lock.json
index 2a154b4..8fdc40a 100644
--- a/templates/crm-homecare/backend/package-lock.json
+++ b/templates/crm-homecare/backend/package-lock.json
@@ -1,1321 +1,4664 @@
 {
-  "name": "twomiah-care-api",
+  "name": "chippewa-home-care-backend",
   "version": "1.0.0",
   "lockfileVersion": 3,
   "requires": true,
   "packages": {
     "": {
-      "name": "twomiah-care-api",
-      "version": "1.0.0",
+      "name": "chippewa-home-care-backend",
       "dependencies": {
-        "@prisma/client": "^5.10.0",
-        "@sendgrid/mail": "^8.1.0",
+        "@prisma/client": "^5.22.0",
         "bcryptjs": "^2.4.3",
+        "compression": "^1.7.4",
         "cookie-parser": "^1.4.6",
-        "cors": "^2.8.5",
-        "dotenv": "^16.4.5",
-        "express": "^4.18.3",
-        "express-rate-limit": "^7.2.0",
-        "helmet": "^7.1.0",
-        "jsonwebtoken": "^9.0.2",
+        "cors": "2.8.5",
+        "date-fns": "2.30.0",
+        "dotenv": "16.0.3",
+        "express": "^4.22.1",
+        "express-rate-limit": "^6.7.0",
+        "helmet": "^7.0.0",
+        "json2csv": "5.0.7",
+        "jsonwebtoken": "^9.0.3",
         "multer": "^1.4.5-lts.1",
-        "nodemailer": "^6.9.12",
-        "socket.io": "^4.7.4",
-        "stripe": "^14.25.0",
-        "twilio": "^5.0.0",
-        "uuid": "^9.0.1",
-        "web-push": "^3.6.7",
+        "papaparse": "5.4.1",
+        "pdfkit": "^0.12.3",
+        "socket.io": "^4.7.2",
+        "stripe": "^12.0.0",
+        "twilio": "^4.0.0",
+        "uuid": "^9.0.0",
+        "web-push": "^3.6.6",
         "winston": "^3.11.0",
         "zod": "^3.22.4"
       },
       "devDependencies": {
-        "nodemon": "^3.1.0",
-        "prisma": "^5.10.0"
+        "jest": "^29.7.0",
+        "nodemon": "^3.1.11",
+        "prisma": "^5.22.0",
+        "supertest": "^6.3.4"
       }
     },
-    "node_modules/@colors/colors": {
-      "version": "1.6.0",
-      "resolved": "https://registry.npmjs.org/@colors/colors/-/colors-1.6.0.tgz",
-      "integrity": "sha512-Ir+AOibqzrIsL6ajt3Rz3LskB7OiMVHqltZmspbW/TJuTVuyOMirVqAkjfY6JISiLHgyNqicAC8AyHHGzNd/dA==",
+    "node_modules/@babel/code-frame": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.29.0.tgz",
+      "integrity": "sha512-9NhCeYjq9+3uxgdtp20LSiJXJvN0FeCtNGpJxuMFZ1Kv3cWUNb6DOhJwUvcVCzKGR66cw4njwM6hrJLqgOwbcw==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@babel/helper-validator-identifier": "^7.28.5",
+        "js-tokens": "^4.0.0",
+        "picocolors": "^1.1.1"
+      },
       "engines": {
-        "node": ">=0.1.90"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@dabh/diagnostics": {
-      "version": "2.0.8",
-      "resolved": "https://registry.npmjs.org/@dabh/diagnostics/-/diagnostics-2.0.8.tgz",
-      "integrity": "sha512-R4MSXTVnuMzGD7bzHdW2ZhhdPC/igELENcq5IjEverBvq5hn1SXCWcsi6eSsdWP0/Ur+SItRRjAktmdoX/8R/Q==",
+    "node_modules/@babel/compat-data": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.29.0.tgz",
+      "integrity": "sha512-T1NCJqT/j9+cn8fvkt7jtwbLBfLC/1y1c7NtCeXFRgzGTsafi68MRv8yzkYSapBnFA6L3U2VSc02ciDzoAJhJg==",
+      "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "@so-ric/colorspace": "^1.1.6",
-        "enabled": "2.0.x",
-        "kuler": "^2.0.0"
+      "engines": {
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@prisma/client": {
-      "version": "5.22.0",
-      "resolved": "https://registry.npmjs.org/@prisma/client/-/client-5.22.0.tgz",
-      "integrity": "sha512-M0SVXfyHnQREBKxCgyo7sffrKttwE6R8PMq330MIUF0pTwjUhLbW84pFDlf06B27XyCR++VtjugEnIHdr07SVA==",
-      "hasInstallScript": true,
-      "license": "Apache-2.0",
+    "node_modules/@babel/core": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.29.0.tgz",
+      "integrity": "sha512-CGOfOJqWjg2qW/Mb6zNsDm+u5vFQ8DxXfbM09z69p5Z6+mE1ikP2jUXw+j42Pf1XTYED2Rni5f95npYeuwMDQA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/code-frame": "^7.29.0",
+        "@babel/generator": "^7.29.0",
+        "@babel/helper-compilation-targets": "^7.28.6",
+        "@babel/helper-module-transforms": "^7.28.6",
+        "@babel/helpers": "^7.28.6",
+        "@babel/parser": "^7.29.0",
+        "@babel/template": "^7.28.6",
+        "@babel/traverse": "^7.29.0",
+        "@babel/types": "^7.29.0",
+        "@jridgewell/remapping": "^2.3.5",
+        "convert-source-map": "^2.0.0",
+        "debug": "^4.1.0",
+        "gensync": "^1.0.0-beta.2",
+        "json5": "^2.2.3",
+        "semver": "^6.3.1"
+      },
       "engines": {
-        "node": ">=16.13"
+        "node": ">=6.9.0"
       },
-      "peerDependencies": {
-        "prisma": "*"
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/babel"
+      }
+    },
+    "node_modules/@babel/core/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
       },
       "peerDependenciesMeta": {
-        "prisma": {
+        "supports-color": {
           "optional": true
         }
       }
     },
-    "node_modules/@prisma/debug": {
-      "version": "5.22.0",
-      "resolved": "https://registry.npmjs.org/@prisma/debug/-/debug-5.22.0.tgz",
-      "integrity": "sha512-AUt44v3YJeggO2ZU5BkXI7M4hu9BF2zzH2iF2V5pyXT/lRTyWiElZ7It+bRH1EshoMRxHgpYg4VB6rCM+mG5jQ==",
-      "devOptional": true,
-      "license": "Apache-2.0"
+    "node_modules/@babel/core/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "dev": true,
+      "license": "MIT"
     },
-    "node_modules/@prisma/engines": {
-      "version": "5.22.0",
-      "resolved": "https://registry.npmjs.org/@prisma/engines/-/engines-5.22.0.tgz",
-      "integrity": "sha512-UNjfslWhAt06kVL3CjkuYpHAWSO6L4kDCVPegV6itt7nD1kSJavd3vhgAEhjglLJJKEdJ7oIqDJ+yHk6qO8gPA==",
-      "devOptional": true,
-      "hasInstallScript": true,
-      "license": "Apache-2.0",
-      "dependencies": {
-        "@prisma/debug": "5.22.0",
-        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
-        "@prisma/fetch-engine": "5.22.0",
-        "@prisma/get-platform": "5.22.0"
+    "node_modules/@babel/core/node_modules/semver": {
+      "version": "6.3.1",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
+      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
+      "dev": true,
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
       }
     },
-    "node_modules/@prisma/engines-version": {
-      "version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
-      "resolved": "https://registry.npmjs.org/@prisma/engines-version/-/engines-version-5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2.tgz",
-      "integrity": "sha512-2PTmxFR2yHW/eB3uqWtcgRcgAbG1rwG9ZriSvQw+nnb7c4uCr3RAcGMb6/zfE88SKlC1Nj2ziUvc96Z379mHgQ==",
-      "devOptional": true,
-      "license": "Apache-2.0"
-    },
-    "node_modules/@prisma/fetch-engine": {
-      "version": "5.22.0",
-      "resolved": "https://registry.npmjs.org/@prisma/fetch-engine/-/fetch-engine-5.22.0.tgz",
-      "integrity": "sha512-bkrD/Mc2fSvkQBV5EpoFcZ87AvOgDxbG99488a5cexp5Ccny+UM6MAe/UFkUC0wLYD9+9befNOqGiIJhhq+HbA==",
-      "devOptional": true,
-      "license": "Apache-2.0",
+    "node_modules/@babel/generator": {
+      "version": "7.29.1",
+      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.29.1.tgz",
+      "integrity": "sha512-qsaF+9Qcm2Qv8SRIMMscAvG4O3lJ0F1GuMo5HR/Bp02LopNgnZBC/EkbevHFeGs4ls/oPz9v+Bsmzbkbe+0dUw==",
+      "dev": true,
+      "license": "MIT",
       "dependencies": {
-        "@prisma/debug": "5.22.0",
-        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
-        "@prisma/get-platform": "5.22.0"
+        "@babel/parser": "^7.29.0",
+        "@babel/types": "^7.29.0",
+        "@jridgewell/gen-mapping": "^0.3.12",
+        "@jridgewell/trace-mapping": "^0.3.28",
+        "jsesc": "^3.0.2"
+      },
+      "engines": {
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@prisma/get-platform": {
-      "version": "5.22.0",
-      "resolved": "https://registry.npmjs.org/@prisma/get-platform/-/get-platform-5.22.0.tgz",
-      "integrity": "sha512-pHhpQdr1UPFpt+zFfnPazhulaZYCUqeIcPpJViYoq9R+D/yw4fjE+CtnsnKzPYm0ddUbeXUzjGVGIRVgPDCk4Q==",
-      "devOptional": true,
-      "license": "Apache-2.0",
+    "node_modules/@babel/helper-compilation-targets": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
+      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
+      "dev": true,
+      "license": "MIT",
       "dependencies": {
-        "@prisma/debug": "5.22.0"
+        "@babel/compat-data": "^7.28.6",
+        "@babel/helper-validator-option": "^7.27.1",
+        "browserslist": "^4.24.0",
+        "lru-cache": "^5.1.1",
+        "semver": "^6.3.1"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/@babel/helper-compilation-targets/node_modules/semver": {
+      "version": "6.3.1",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
+      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
+      "dev": true,
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
       }
     },
-    "node_modules/@sendgrid/client": {
-      "version": "8.1.6",
-      "resolved": "https://registry.npmjs.org/@sendgrid/client/-/client-8.1.6.tgz",
-      "integrity": "sha512-/BHu0hqwXNHr2aLhcXU7RmmlVqrdfrbY9KpaNj00KZHlVOVoRxRVrpOCabIB+91ISXJ6+mLM9vpaVUhK6TwBWA==",
+    "node_modules/@babel/helper-globals": {
+      "version": "7.28.0",
+      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
+      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
+      "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "@sendgrid/helpers": "^8.0.0",
-        "axios": "^1.12.0"
-      },
       "engines": {
-        "node": ">=12.*"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@sendgrid/helpers": {
-      "version": "8.0.0",
-      "resolved": "https://registry.npmjs.org/@sendgrid/helpers/-/helpers-8.0.0.tgz",
-      "integrity": "sha512-Ze7WuW2Xzy5GT5WRx+yEv89fsg/pgy3T1E3FS0QEx0/VvRmigMZ5qyVGhJz4SxomegDkzXv/i0aFPpHKN8qdAA==",
+    "node_modules/@babel/helper-module-imports": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
+      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "deepmerge": "^4.2.2"
+        "@babel/traverse": "^7.28.6",
+        "@babel/types": "^7.28.6"
       },
       "engines": {
-        "node": ">= 12.0.0"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@sendgrid/mail": {
-      "version": "8.1.6",
-      "resolved": "https://registry.npmjs.org/@sendgrid/mail/-/mail-8.1.6.tgz",
-      "integrity": "sha512-/ZqxUvKeEztU9drOoPC/8opEPOk+jLlB2q4+xpx6HVLq6aFu3pMpalkTpAQz8XfRfpLp8O25bh6pGPcHDCYpqg==",
+    "node_modules/@babel/helper-module-transforms": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
+      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "@sendgrid/client": "^8.1.5",
-        "@sendgrid/helpers": "^8.0.0"
+        "@babel/helper-module-imports": "^7.28.6",
+        "@babel/helper-validator-identifier": "^7.28.5",
+        "@babel/traverse": "^7.28.6"
       },
       "engines": {
-        "node": ">=12.*"
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0"
       }
     },
-    "node_modules/@so-ric/colorspace": {
-      "version": "1.1.6",
-      "resolved": "https://registry.npmjs.org/@so-ric/colorspace/-/colorspace-1.1.6.tgz",
-      "integrity": "sha512-/KiKkpHNOBgkFJwu9sh48LkHSMYGyuTcSFK/qMBdnOAlrRJzRSXAOFB5qwzaVQuDl8wAvHVMkaASQDReTahxuw==",
+    "node_modules/@babel/helper-plugin-utils": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
+      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
+      "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "color": "^5.0.2",
-        "text-hex": "1.0.x"
+      "engines": {
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@socket.io/component-emitter": {
-      "version": "3.1.2",
-      "resolved": "https://registry.npmjs.org/@socket.io/component-emitter/-/component-emitter-3.1.2.tgz",
-      "integrity": "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA==",
-      "license": "MIT"
-    },
-    "node_modules/@types/cors": {
-      "version": "2.8.19",
-      "resolved": "https://registry.npmjs.org/@types/cors/-/cors-2.8.19.tgz",
-      "integrity": "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg==",
+    "node_modules/@babel/helper-string-parser": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
+      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
+      "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "@types/node": "*"
+      "engines": {
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@types/node": {
-      "version": "25.3.0",
-      "resolved": "https://registry.npmjs.org/@types/node/-/node-25.3.0.tgz",
-      "integrity": "sha512-4K3bqJpXpqfg2XKGK9bpDTc6xO/xoUP/RBWS7AtRMug6zZFaRekiLzjVtAoZMquxoAbzBvy5nxQ7veS5eYzf8A==",
+    "node_modules/@babel/helper-validator-identifier": {
+      "version": "7.28.5",
+      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
+      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
+      "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "undici-types": "~7.18.0"
+      "engines": {
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/@types/triple-beam": {
-      "version": "1.3.5",
-      "resolved": "https://registry.npmjs.org/@types/triple-beam/-/triple-beam-1.3.5.tgz",
-      "integrity": "sha512-6WaYesThRMCl19iryMYP7/x2OVgCtbIVflDGFpWnb9irXI3UjYE4AzmYuiUKY1AJstGijoY+MgUszMgRxIYTYw==",
-      "license": "MIT"
+    "node_modules/@babel/helper-validator-option": {
+      "version": "7.27.1",
+      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
+      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
     },
-    "node_modules/accepts": {
-      "version": "1.3.8",
-      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
-      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
+    "node_modules/@babel/helpers": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
+      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "mime-types": "~2.1.34",
-        "negotiator": "0.6.3"
+        "@babel/template": "^7.28.6",
+        "@babel/types": "^7.28.6"
       },
       "engines": {
-        "node": ">= 0.6"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/agent-base": {
-      "version": "6.0.2",
-      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
-      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
+    "node_modules/@babel/parser": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.29.0.tgz",
+      "integrity": "sha512-IyDgFV5GeDUVX4YdF/3CPULtVGSXXMLh1xVIgdCgxApktqnQV0r7/8Nqthg+8YLGaAtdyIlo2qIdZrbCv4+7ww==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "debug": "4"
+        "@babel/types": "^7.29.0"
+      },
+      "bin": {
+        "parser": "bin/babel-parser.js"
       },
       "engines": {
-        "node": ">= 6.0.0"
+        "node": ">=6.0.0"
       }
     },
-    "node_modules/agent-base/node_modules/debug": {
-      "version": "4.4.3",
-      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
-      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+    "node_modules/@babel/plugin-syntax-async-generators": {
+      "version": "7.8.4",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz",
+      "integrity": "sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "ms": "^2.1.3"
+        "@babel/helper-plugin-utils": "^7.8.0"
       },
-      "engines": {
-        "node": ">=6.0"
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
+    },
+    "node_modules/@babel/plugin-syntax-bigint": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz",
+      "integrity": "sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.8.0"
       },
-      "peerDependenciesMeta": {
-        "supports-color": {
-          "optional": true
-        }
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/agent-base/node_modules/ms": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
-      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
-      "license": "MIT"
+    "node_modules/@babel/plugin-syntax-class-properties": {
+      "version": "7.12.13",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz",
+      "integrity": "sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.12.13"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
     },
-    "node_modules/anymatch": {
-      "version": "3.1.3",
-      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
-      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
+    "node_modules/@babel/plugin-syntax-class-static-block": {
+      "version": "7.14.5",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz",
+      "integrity": "sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==",
       "dev": true,
-      "license": "ISC",
+      "license": "MIT",
       "dependencies": {
-        "normalize-path": "^3.0.0",
-        "picomatch": "^2.0.4"
+        "@babel/helper-plugin-utils": "^7.14.5"
       },
       "engines": {
-        "node": ">= 8"
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/append-field": {
-      "version": "1.0.0",
-      "resolved": "https://registry.npmjs.org/append-field/-/append-field-1.0.0.tgz",
-      "integrity": "sha512-klpgFSWLW1ZEs8svjfb7g4qWY0YS5imI82dTg+QahUvJ8YqAY0P10Uk8tTyh9ZGuYEZEMaeJYCF5BFuX552hsw==",
-      "license": "MIT"
-    },
-    "node_modules/array-flatten": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
-      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
-      "license": "MIT"
+    "node_modules/@babel/plugin-syntax-import-attributes": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.28.6.tgz",
+      "integrity": "sha512-jiLC0ma9XkQT3TKJ9uYvlakm66Pamywo+qwL+oL8HJOvc6TWdZXVfhqJr8CCzbSGUAbDOzlGHJC1U+vRfLQDvw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.28.6"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
     },
-    "node_modules/asn1.js": {
-      "version": "5.4.1",
-      "resolved": "https://registry.npmjs.org/asn1.js/-/asn1.js-5.4.1.tgz",
-      "integrity": "sha512-+I//4cYPccV8LdmBLiX8CYvf9Sp3vQsrqu2QNXRcrbiWvcx/UdlFiqUJJzxRQxgsZmvhXhn4cSKeSmoFjVdupA==",
+    "node_modules/@babel/plugin-syntax-import-meta": {
+      "version": "7.10.4",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz",
+      "integrity": "sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "bn.js": "^4.0.0",
-        "inherits": "^2.0.1",
-        "minimalistic-assert": "^1.0.0",
-        "safer-buffer": "^2.1.0"
+        "@babel/helper-plugin-utils": "^7.10.4"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/async": {
-      "version": "3.2.6",
-      "resolved": "https://registry.npmjs.org/async/-/async-3.2.6.tgz",
-      "integrity": "sha512-htCUDlxyyCLMgaM3xXg0C0LW2xqfuQ6p05pCEIsXuyQ+a1koYKTuBMzRNwmybfLgvJDMd0r1LTn4+E0Ti6C2AA==",
-      "license": "MIT"
-    },
-    "node_modules/asynckit": {
-      "version": "0.4.0",
-      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
-      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
-      "license": "MIT"
-    },
-    "node_modules/axios": {
-      "version": "1.13.5",
-      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.5.tgz",
-      "integrity": "sha512-cz4ur7Vb0xS4/KUN0tPWe44eqxrIu31me+fbang3ijiNscE129POzipJJA6zniq2C/Z6sJCjMimjS8Lc/GAs8Q==",
+    "node_modules/@babel/plugin-syntax-json-strings": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz",
+      "integrity": "sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "follow-redirects": "^1.15.11",
-        "form-data": "^4.0.5",
-        "proxy-from-env": "^1.1.0"
+        "@babel/helper-plugin-utils": "^7.8.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/balanced-match": {
-      "version": "4.0.4",
-      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-4.0.4.tgz",
-      "integrity": "sha512-BLrgEcRTwX2o6gGxGOCNyMvGSp35YofuYzw9h1IMTRmKqttAZZVU67bdb9Pr2vUHA8+j3i2tJfjO6C6+4myGTA==",
+    "node_modules/@babel/plugin-syntax-jsx": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.28.6.tgz",
+      "integrity": "sha512-wgEmr06G6sIpqr8YDwA2dSRTE3bJ+V0IfpzfSY3Lfgd7YWOaAdlykvJi13ZKBt8cZHfgH1IXN+CL656W3uUa4w==",
       "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.28.6"
+      },
       "engines": {
-        "node": "18 || 20 || >=22"
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/base64id": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/base64id/-/base64id-2.0.0.tgz",
-      "integrity": "sha512-lGe34o6EHj9y3Kts9R4ZYs/Gr+6N7MCaMlIFA3F1R2O5/m7K06AxfSeO5530PEERE6/WyEg3lsuyw4GHlPZHog==",
+    "node_modules/@babel/plugin-syntax-logical-assignment-operators": {
+      "version": "7.10.4",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz",
+      "integrity": "sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==",
+      "dev": true,
       "license": "MIT",
-      "engines": {
-        "node": "^4.5.0 || >= 5.9"
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.10.4"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/bcryptjs": {
-      "version": "2.4.3",
-      "resolved": "https://registry.npmjs.org/bcryptjs/-/bcryptjs-2.4.3.tgz",
-      "integrity": "sha512-V/Hy/X9Vt7f3BbPJEi8BdVFMByHi+jNXrYkW3huaybV/kQ0KJg0Y6PkEMbn+zeT+i+SiKZ/HMqJGIIt4LZDqNQ==",
-      "license": "MIT"
+    "node_modules/@babel/plugin-syntax-nullish-coalescing-operator": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz",
+      "integrity": "sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.8.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
     },
-    "node_modules/binary-extensions": {
-      "version": "2.3.0",
-      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
-      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
+    "node_modules/@babel/plugin-syntax-numeric-separator": {
+      "version": "7.10.4",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz",
+      "integrity": "sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==",
       "dev": true,
       "license": "MIT",
-      "engines": {
-        "node": ">=8"
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.10.4"
       },
-      "funding": {
-        "url": "https://github.com/sponsors/sindresorhus"
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/bn.js": {
-      "version": "4.12.3",
-      "resolved": "https://registry.npmjs.org/bn.js/-/bn.js-4.12.3.tgz",
-      "integrity": "sha512-fGTi3gxV/23FTYdAoUtLYp6qySe2KE3teyZitipKNRuVYcBkoP/bB3guXN/XVKUe9mxCHXnc9C4ocyz8OmgN0g==",
-      "license": "MIT"
+    "node_modules/@babel/plugin-syntax-object-rest-spread": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz",
+      "integrity": "sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.8.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
     },
-    "node_modules/body-parser": {
-      "version": "1.20.4",
-      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.4.tgz",
-      "integrity": "sha512-ZTgYYLMOXY9qKU/57FAo8F+HA2dGX7bqGc71txDRC1rS4frdFI5R7NhluHxH6M0YItAP0sHB4uqAOcYKxO6uGA==",
+    "node_modules/@babel/plugin-syntax-optional-catch-binding": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-catch-binding/-/plugin-syntax-optional-catch-binding-7.8.3.tgz",
+      "integrity": "sha512-6VPD0Pc1lpTqw0aKoeRTMiB+kWhAoT24PA+ksWSBrFtl5SIRVpZlwN3NNPQjehA2E/91FV3RjLWoVTglWcSV3Q==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "bytes": "~3.1.2",
-        "content-type": "~1.0.5",
-        "debug": "2.6.9",
-        "depd": "2.0.0",
-        "destroy": "~1.2.0",
-        "http-errors": "~2.0.1",
-        "iconv-lite": "~0.4.24",
-        "on-finished": "~2.4.1",
-        "qs": "~6.14.0",
-        "raw-body": "~2.5.3",
-        "type-is": "~1.6.18",
-        "unpipe": "~1.0.0"
+        "@babel/helper-plugin-utils": "^7.8.0"
       },
-      "engines": {
-        "node": ">= 0.8",
-        "npm": "1.2.8000 || >= 1.4.16"
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/brace-expansion": {
-      "version": "5.0.3",
-      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-5.0.3.tgz",
-      "integrity": "sha512-fy6KJm2RawA5RcHkLa1z/ScpBeA762UF9KmZQxwIbDtRJrgLzM10depAiEQ+CXYcoiqW1/m96OAAoke2nE9EeA==",
+    "node_modules/@babel/plugin-syntax-optional-chaining": {
+      "version": "7.8.3",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-optional-chaining/-/plugin-syntax-optional-chaining-7.8.3.tgz",
+      "integrity": "sha512-KoK9ErH1MBlCPxV0VANkXW2/dw4vlbGDrFgz8bmUsBGYkFRcbRwMh6cIJubdPrkxRwuGdtCk0v/wPTKbQgBjkg==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "balanced-match": "^4.0.2"
+        "@babel/helper-plugin-utils": "^7.8.0"
       },
-      "engines": {
-        "node": "18 || 20 || >=22"
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/braces": {
-      "version": "3.0.3",
-      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
-      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
+    "node_modules/@babel/plugin-syntax-private-property-in-object": {
+      "version": "7.14.5",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-private-property-in-object/-/plugin-syntax-private-property-in-object-7.14.5.tgz",
+      "integrity": "sha512-0wVnp9dxJ72ZUJDV27ZfbSj6iHLoytYZmh3rFcxNnvsJF3ktkzLDZPy/mA17HGsaQT3/DQsWYX1f1QGWkCoVUg==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "fill-range": "^7.1.1"
+        "@babel/helper-plugin-utils": "^7.14.5"
       },
       "engines": {
-        "node": ">=8"
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/buffer-equal-constant-time": {
-      "version": "1.0.1",
-      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
-      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
-      "license": "BSD-3-Clause"
-    },
-    "node_modules/buffer-from": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
-      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
-      "license": "MIT"
+    "node_modules/@babel/plugin-syntax-top-level-await": {
+      "version": "7.14.5",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-top-level-await/-/plugin-syntax-top-level-await-7.14.5.tgz",
+      "integrity": "sha512-hx++upLv5U1rgYfwe1xBQUhRmU41NEvpUvrp8jkrSCdvGSnM5/qdRMtylJ6PG5OFkBaHkbTAKTnd3/YyESRHFw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.14.5"
+      },
+      "engines": {
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
+      }
     },
-    "node_modules/busboy": {
-      "version": "1.6.0",
-      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
-      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
+    "node_modules/@babel/plugin-syntax-typescript": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-typescript/-/plugin-syntax-typescript-7.28.6.tgz",
+      "integrity": "sha512-+nDNmQye7nlnuuHDboPbGm00Vqg3oO8niRRL27/4LYHUsHYh0zJ1xWOz0uRwNFmM1Avzk8wZbc6rdiYhomzv/A==",
+      "dev": true,
+      "license": "MIT",
       "dependencies": {
-        "streamsearch": "^1.1.0"
+        "@babel/helper-plugin-utils": "^7.28.6"
       },
       "engines": {
-        "node": ">=10.16.0"
+        "node": ">=6.9.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0-0"
       }
     },
-    "node_modules/bytes": {
-      "version": "3.1.2",
-      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
-      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
+    "node_modules/@babel/runtime": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.6.tgz",
+      "integrity": "sha512-05WQkdpL9COIMz4LjTxGpPNCdlpyimKppYNoJ5Di5EUObifl8t4tuLuUBBZEpoLYOmfvIWrsp9fCl0HoPRVTdA==",
       "license": "MIT",
       "engines": {
-        "node": ">= 0.8"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/call-bind-apply-helpers": {
-      "version": "1.0.2",
-      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
-      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
+    "node_modules/@babel/template": {
+      "version": "7.28.6",
+      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
+      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "es-errors": "^1.3.0",
-        "function-bind": "^1.1.2"
+        "@babel/code-frame": "^7.28.6",
+        "@babel/parser": "^7.28.6",
+        "@babel/types": "^7.28.6"
       },
       "engines": {
-        "node": ">= 0.4"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/call-bound": {
-      "version": "1.0.4",
-      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
-      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
+    "node_modules/@babel/traverse": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.29.0.tgz",
+      "integrity": "sha512-4HPiQr0X7+waHfyXPZpWPfWL/J7dcN1mx9gL6WdQVMbPnF3+ZhSMs8tCxN7oHddJE9fhNE7+lxdnlyemKfJRuA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "call-bind-apply-helpers": "^1.0.2",
-        "get-intrinsic": "^1.3.0"
+        "@babel/code-frame": "^7.29.0",
+        "@babel/generator": "^7.29.0",
+        "@babel/helper-globals": "^7.28.0",
+        "@babel/parser": "^7.29.0",
+        "@babel/template": "^7.28.6",
+        "@babel/types": "^7.29.0",
+        "debug": "^4.3.1"
       },
       "engines": {
-        "node": ">= 0.4"
-      },
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/chokidar": {
-      "version": "3.6.0",
-      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
-      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
+    "node_modules/@babel/traverse/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "anymatch": "~3.1.2",
-        "braces": "~3.0.2",
-        "glob-parent": "~5.1.2",
-        "is-binary-path": "~2.1.0",
-        "is-glob": "~4.0.1",
-        "normalize-path": "~3.0.0",
-        "readdirp": "~3.6.0"
+        "ms": "^2.1.3"
       },
       "engines": {
-        "node": ">= 8.10.0"
-      },
-      "funding": {
-        "url": "https://paulmillr.com/funding/"
+        "node": ">=6.0"
       },
-      "optionalDependencies": {
-        "fsevents": "~2.3.2"
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
       }
     },
-    "node_modules/color": {
-      "version": "5.0.3",
-      "resolved": "https://registry.npmjs.org/color/-/color-5.0.3.tgz",
-      "integrity": "sha512-ezmVcLR3xAVp8kYOm4GS45ZLLgIE6SPAFoduLr6hTDajwb3KZ2F46gulK3XpcwRFb5KKGCSezCBAY4Dw4HsyXA==",
+    "node_modules/@babel/traverse/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@babel/types": {
+      "version": "7.29.0",
+      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.29.0.tgz",
+      "integrity": "sha512-LwdZHpScM4Qz8Xw2iKSzS+cfglZzJGvofQICy7W7v4caru4EaAmyUuO6BGrbyQ2mYV11W0U8j5mBhd14dd3B0A==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "color-convert": "^3.1.3",
-        "color-string": "^2.1.3"
+        "@babel/helper-string-parser": "^7.27.1",
+        "@babel/helper-validator-identifier": "^7.28.5"
       },
       "engines": {
-        "node": ">=18"
+        "node": ">=6.9.0"
       }
     },
-    "node_modules/color-convert": {
-      "version": "3.1.3",
-      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-3.1.3.tgz",
-      "integrity": "sha512-fasDH2ont2GqF5HpyO4w0+BcewlhHEZOFn9c1ckZdHpJ56Qb7MHhH/IcJZbBGgvdtwdwNbLvxiBEdg336iA9Sg==",
+    "node_modules/@bcoe/v8-coverage": {
+      "version": "0.2.3",
+      "resolved": "https://registry.npmjs.org/@bcoe/v8-coverage/-/v8-coverage-0.2.3.tgz",
+      "integrity": "sha512-0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@colors/colors": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/@colors/colors/-/colors-1.6.0.tgz",
+      "integrity": "sha512-Ir+AOibqzrIsL6ajt3Rz3LskB7OiMVHqltZmspbW/TJuTVuyOMirVqAkjfY6JISiLHgyNqicAC8AyHHGzNd/dA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.1.90"
+      }
+    },
+    "node_modules/@dabh/diagnostics": {
+      "version": "2.0.8",
+      "resolved": "https://registry.npmjs.org/@dabh/diagnostics/-/diagnostics-2.0.8.tgz",
+      "integrity": "sha512-R4MSXTVnuMzGD7bzHdW2ZhhdPC/igELENcq5IjEverBvq5hn1SXCWcsi6eSsdWP0/Ur+SItRRjAktmdoX/8R/Q==",
       "license": "MIT",
       "dependencies": {
-        "color-name": "^2.0.0"
+        "@so-ric/colorspace": "^1.1.6",
+        "enabled": "2.0.x",
+        "kuler": "^2.0.0"
+      }
+    },
+    "node_modules/@istanbuljs/load-nyc-config": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/@istanbuljs/load-nyc-config/-/load-nyc-config-1.1.0.tgz",
+      "integrity": "sha512-VjeHSlIzpv/NyD3N0YuHfXOPDIixcA1q2ZV98wsMqcYlPmv2n3Yb2lYP9XMElnaFVXg5A7YLTeLu6V84uQDjmQ==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "camelcase": "^5.3.1",
+        "find-up": "^4.1.0",
+        "get-package-type": "^0.1.0",
+        "js-yaml": "^3.13.1",
+        "resolve-from": "^5.0.0"
       },
       "engines": {
-        "node": ">=14.6"
+        "node": ">=8"
       }
     },
-    "node_modules/color-name": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/color-name/-/color-name-2.1.0.tgz",
-      "integrity": "sha512-1bPaDNFm0axzE4MEAzKPuqKWeRaT43U/hyxKPBdqTfmPF+d6n7FSoTFxLVULUJOmiLp01KjhIPPH+HrXZJN4Rg==",
+    "node_modules/@istanbuljs/schema": {
+      "version": "0.1.3",
+      "resolved": "https://registry.npmjs.org/@istanbuljs/schema/-/schema-0.1.3.tgz",
+      "integrity": "sha512-ZXRY4jNvVgSVQ8DL3LTcakaAtXwTVUxE81hslsyD2AtoXW/wVob10HkOJ1X/pAlcI7D+2YoZKg5do8G/w6RYgA==",
+      "dev": true,
       "license": "MIT",
       "engines": {
-        "node": ">=12.20"
+        "node": ">=8"
       }
     },
-    "node_modules/color-string": {
-      "version": "2.1.4",
-      "resolved": "https://registry.npmjs.org/color-string/-/color-string-2.1.4.tgz",
-      "integrity": "sha512-Bb6Cq8oq0IjDOe8wJmi4JeNn763Xs9cfrBcaylK1tPypWzyoy2G3l90v9k64kjphl/ZJjPIShFztenRomi8WTg==",
+    "node_modules/@jest/console": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/console/-/console-29.7.0.tgz",
+      "integrity": "sha512-5Ni4CU7XHQi32IJ398EEP4RrB8eV09sXP2ROqD4bksHrnTree52PsxvX8tpL8LvTZ3pFzXyPbNQReSN41CAhOg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "color-name": "^2.0.0"
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "jest-message-util": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "slash": "^3.0.0"
       },
       "engines": {
-        "node": ">=18"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/combined-stream": {
-      "version": "1.0.8",
-      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
-      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
+    "node_modules/@jest/core": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/core/-/core-29.7.0.tgz",
+      "integrity": "sha512-n7aeXWKMnGtDA48y8TLWJPJmLmmZ642Ceo78cYWEpiD7FzDgmNDV/GCVRorPABdXLJZ/9wzzgZAlHjXjxDHGsg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "delayed-stream": "~1.0.0"
+        "@jest/console": "^29.7.0",
+        "@jest/reporters": "^29.7.0",
+        "@jest/test-result": "^29.7.0",
+        "@jest/transform": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "ansi-escapes": "^4.2.1",
+        "chalk": "^4.0.0",
+        "ci-info": "^3.2.0",
+        "exit": "^0.1.2",
+        "graceful-fs": "^4.2.9",
+        "jest-changed-files": "^29.7.0",
+        "jest-config": "^29.7.0",
+        "jest-haste-map": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-regex-util": "^29.6.3",
+        "jest-resolve": "^29.7.0",
+        "jest-resolve-dependencies": "^29.7.0",
+        "jest-runner": "^29.7.0",
+        "jest-runtime": "^29.7.0",
+        "jest-snapshot": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "jest-validate": "^29.7.0",
+        "jest-watcher": "^29.7.0",
+        "micromatch": "^4.0.4",
+        "pretty-format": "^29.7.0",
+        "slash": "^3.0.0",
+        "strip-ansi": "^6.0.0"
       },
       "engines": {
-        "node": ">= 0.8"
-      }
-    },
-    "node_modules/concat-stream": {
-      "version": "1.6.2",
-      "resolved": "https://registry.npmjs.org/concat-stream/-/concat-stream-1.6.2.tgz",
-      "integrity": "sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==",
-      "engines": [
-        "node >= 0.8"
-      ],
-      "license": "MIT",
-      "dependencies": {
-        "buffer-from": "^1.0.0",
-        "inherits": "^2.0.3",
-        "readable-stream": "^2.2.2",
-        "typedarray": "^0.0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
+      },
+      "peerDependenciesMeta": {
+        "node-notifier": {
+          "optional": true
+        }
       }
     },
-    "node_modules/content-disposition": {
-      "version": "0.5.4",
-      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
-      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
+    "node_modules/@jest/environment": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/environment/-/environment-29.7.0.tgz",
+      "integrity": "sha512-aQIfHDq33ExsN4jP1NWGXhxgQ/wixs60gDiKO+XVMd8Mn0NWPWgc34ZQDTb2jKaUWQ7MuwoitXAsN2XVXNMpAw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "safe-buffer": "5.2.1"
+        "@jest/fake-timers": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "jest-mock": "^29.7.0"
       },
       "engines": {
-        "node": ">= 0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/content-type": {
-      "version": "1.0.5",
-      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
-      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
+    "node_modules/@jest/expect": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/expect/-/expect-29.7.0.tgz",
+      "integrity": "sha512-8uMeAMycttpva3P1lBHB8VciS9V0XAr3GymPpipdyQXbBcuhkLQOSe8E/p92RyAdToS6ZD1tFkX+CkhoECE0dQ==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "expect": "^29.7.0",
+        "jest-snapshot": "^29.7.0"
+      },
       "engines": {
-        "node": ">= 0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/cookie": {
-      "version": "0.7.2",
-      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
-      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
+    "node_modules/@jest/expect-utils": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/expect-utils/-/expect-utils-29.7.0.tgz",
+      "integrity": "sha512-GlsNBWiFQFCVi9QVSx7f5AgMeLxe9YCCs5PuP2O2LdjDAA8Jh9eX7lA1Jq/xdXw3Wb3hyvlFNfZIfcRetSzYcA==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "jest-get-type": "^29.6.3"
+      },
       "engines": {
-        "node": ">= 0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/cookie-parser": {
-      "version": "1.4.7",
-      "resolved": "https://registry.npmjs.org/cookie-parser/-/cookie-parser-1.4.7.tgz",
-      "integrity": "sha512-nGUvgXnotP3BsjiLX2ypbQnWoGUPIIfHQNZkkC668ntrzGWEZVW70HDEB1qnNGMicPje6EttlIgzo51YSwNQGw==",
+    "node_modules/@jest/fake-timers": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/fake-timers/-/fake-timers-29.7.0.tgz",
+      "integrity": "sha512-q4DH1Ha4TTFPdxLsqDXK1d3+ioSL7yL5oCMJZgDYm6i+6CygW5E5xVr/D1HdsGxjt1ZWSfUAs9OxSB/BNelWrQ==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "cookie": "0.7.2",
-        "cookie-signature": "1.0.6"
+        "@jest/types": "^29.6.3",
+        "@sinonjs/fake-timers": "^10.0.2",
+        "@types/node": "*",
+        "jest-message-util": "^29.7.0",
+        "jest-mock": "^29.7.0",
+        "jest-util": "^29.7.0"
       },
       "engines": {
-        "node": ">= 0.8.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/cookie-signature": {
-      "version": "1.0.6",
-      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.6.tgz",
-      "integrity": "sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==",
-      "license": "MIT"
-    },
-    "node_modules/core-util-is": {
-      "version": "1.0.3",
-      "resolved": "https://registry.npmjs.org/core-util-is/-/core-util-is-1.0.3.tgz",
-      "integrity": "sha512-ZQBvi1DcpJ4GDqanjucZ2Hj3wEO5pZDS89BWbkcrvdxksJorwUDDZamX9ldFkp9aw2lmBDLgkObEA4DWNJ9FYQ==",
-      "license": "MIT"
-    },
-    "node_modules/cors": {
-      "version": "2.8.6",
-      "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.6.tgz",
-      "integrity": "sha512-tJtZBBHA6vjIAaF6EnIaq6laBBP9aq/Y3ouVJjEfoHbRBcHBAHYcMh/w8LDrk2PvIMMq8gmopa5D4V8RmbrxGw==",
+    "node_modules/@jest/globals": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/globals/-/globals-29.7.0.tgz",
+      "integrity": "sha512-mpiz3dutLbkW2MNFubUGUEVLkTGiqW6yLVTA+JbP6fI6J5iL9Y0Nlg8k95pcF8ctKwCS7WVxteBs29hhfAotzQ==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "object-assign": "^4",
-        "vary": "^1"
+        "@jest/environment": "^29.7.0",
+        "@jest/expect": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "jest-mock": "^29.7.0"
       },
       "engines": {
-        "node": ">= 0.10"
-      },
-      "funding": {
-        "type": "opencollective",
-        "url": "https://opencollective.com/express"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/dayjs": {
-      "version": "1.11.19",
-      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
-      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
-      "license": "MIT"
-    },
-    "node_modules/debug": {
-      "version": "2.6.9",
-      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
-      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
+    "node_modules/@jest/reporters": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/reporters/-/reporters-29.7.0.tgz",
+      "integrity": "sha512-DApq0KJbJOEzAFYjHADNNxAE3KbhxQB1y5Kplb5Waqw6zVbuWatSnMjE5gs8FUgEPmNsnZA3NCWl9NG0ia04Pg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "ms": "2.0.0"
+        "@bcoe/v8-coverage": "^0.2.3",
+        "@jest/console": "^29.7.0",
+        "@jest/test-result": "^29.7.0",
+        "@jest/transform": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@jridgewell/trace-mapping": "^0.3.18",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "collect-v8-coverage": "^1.0.0",
+        "exit": "^0.1.2",
+        "glob": "^7.1.3",
+        "graceful-fs": "^4.2.9",
+        "istanbul-lib-coverage": "^3.0.0",
+        "istanbul-lib-instrument": "^6.0.0",
+        "istanbul-lib-report": "^3.0.0",
+        "istanbul-lib-source-maps": "^4.0.0",
+        "istanbul-reports": "^3.1.3",
+        "jest-message-util": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "jest-worker": "^29.7.0",
+        "slash": "^3.0.0",
+        "string-length": "^4.0.1",
+        "strip-ansi": "^6.0.0",
+        "v8-to-istanbul": "^9.0.1"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
+      },
+      "peerDependenciesMeta": {
+        "node-notifier": {
+          "optional": true
+        }
       }
     },
-    "node_modules/deepmerge": {
-      "version": "4.3.1",
-      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
-      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
+    "node_modules/@jest/schemas": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/@jest/schemas/-/schemas-29.6.3.tgz",
+      "integrity": "sha512-mo5j5X+jIZmJQveBKeS/clAueipV7KgiX1vMgCxam1RNYiqE1w62n0/tJJnHtjW8ZHcQco5gY85jA3mi0L+nSA==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@sinclair/typebox": "^0.27.8"
+      },
       "engines": {
-        "node": ">=0.10.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/delayed-stream": {
-      "version": "1.0.0",
-      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
-      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
+    "node_modules/@jest/source-map": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/@jest/source-map/-/source-map-29.6.3.tgz",
+      "integrity": "sha512-MHjT95QuipcPrpLM+8JMSzFx6eHp5Bm+4XeFDJlwsvVBjmKNiIAvasGK2fxz2WbGRlnvqehFbh07MMa7n3YJnw==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jridgewell/trace-mapping": "^0.3.18",
+        "callsites": "^3.0.0",
+        "graceful-fs": "^4.2.9"
+      },
       "engines": {
-        "node": ">=0.4.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/depd": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
-      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
+    "node_modules/@jest/test-result": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/test-result/-/test-result-29.7.0.tgz",
+      "integrity": "sha512-Fdx+tv6x1zlkJPcWXmMDAG2HBnaR9XPSd5aDWQVsfrZmLVT3lU1cwyxLgRmXR9yrq4NBoEm9BMsfgFzTQAbJYA==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/console": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/istanbul-lib-coverage": "^2.0.0",
+        "collect-v8-coverage": "^1.0.0"
+      },
       "engines": {
-        "node": ">= 0.8"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/destroy": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
-      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
+    "node_modules/@jest/test-sequencer": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/test-sequencer/-/test-sequencer-29.7.0.tgz",
+      "integrity": "sha512-GQwJ5WZVrKnOJuiYiAF52UNUJXgTZx1NHjFSEB0qEMmSZKAkdMoIzw/Cj6x6NF4AvV23AUqDpFzQkN/eYCYTxw==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/test-result": "^29.7.0",
+        "graceful-fs": "^4.2.9",
+        "jest-haste-map": "^29.7.0",
+        "slash": "^3.0.0"
+      },
       "engines": {
-        "node": ">= 0.8",
-        "npm": "1.2.8000 || >= 1.4.16"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/dotenv": {
-      "version": "16.6.1",
-      "resolved": "https://registry.npmjs.org/dotenv/-/dotenv-16.6.1.tgz",
-      "integrity": "sha512-uBq4egWHTcTt33a72vpSG0z3HnPuIl6NqYcTrKEg2azoEyl2hpW0zqlxysq2pK9HlDIHyHyakeYaYnSAwd8bow==",
-      "license": "BSD-2-Clause",
-      "engines": {
-        "node": ">=12"
+    "node_modules/@jest/transform": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/@jest/transform/-/transform-29.7.0.tgz",
+      "integrity": "sha512-ok/BTPFzFKVMwO5eOHRrvnBVHdRy9IrsrW1GpMaQ9MCnilNLXQKmAX8s1YXDFaai9xJpac2ySzV0YeRRECr2Vw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/core": "^7.11.6",
+        "@jest/types": "^29.6.3",
+        "@jridgewell/trace-mapping": "^0.3.18",
+        "babel-plugin-istanbul": "^6.1.1",
+        "chalk": "^4.0.0",
+        "convert-source-map": "^2.0.0",
+        "fast-json-stable-stringify": "^2.1.0",
+        "graceful-fs": "^4.2.9",
+        "jest-haste-map": "^29.7.0",
+        "jest-regex-util": "^29.6.3",
+        "jest-util": "^29.7.0",
+        "micromatch": "^4.0.4",
+        "pirates": "^4.0.4",
+        "slash": "^3.0.0",
+        "write-file-atomic": "^4.0.2"
       },
-      "funding": {
-        "url": "https://dotenvx.com"
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/dunder-proto": {
-      "version": "1.0.1",
-      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
-      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
+    "node_modules/@jest/types": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/@jest/types/-/types-29.6.3.tgz",
+      "integrity": "sha512-u3UPsIilWKOM3F9CXtrG8LEJmNxwoCQC/XVj4IKYXvvpx7QIi/Kg1LI5uDmDpKlac62NUtX7eLjRh+jVZcLOzw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "call-bind-apply-helpers": "^1.0.1",
-        "es-errors": "^1.3.0",
-        "gopd": "^1.2.0"
+        "@jest/schemas": "^29.6.3",
+        "@types/istanbul-lib-coverage": "^2.0.0",
+        "@types/istanbul-reports": "^3.0.0",
+        "@types/node": "*",
+        "@types/yargs": "^17.0.8",
+        "chalk": "^4.0.0"
       },
       "engines": {
-        "node": ">= 0.4"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/ecdsa-sig-formatter": {
-      "version": "1.0.11",
-      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
-      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
-      "license": "Apache-2.0",
+    "node_modules/@jridgewell/gen-mapping": {
+      "version": "0.3.13",
+      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
+      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
+      "dev": true,
+      "license": "MIT",
       "dependencies": {
-        "safe-buffer": "^5.0.1"
+        "@jridgewell/sourcemap-codec": "^1.5.0",
+        "@jridgewell/trace-mapping": "^0.3.24"
       }
     },
-    "node_modules/ee-first": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
-      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
-      "license": "MIT"
-    },
-    "node_modules/enabled": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/enabled/-/enabled-2.0.0.tgz",
-      "integrity": "sha512-AKrN98kuwOzMIdAizXGI86UFBoo26CL21UM763y1h/GMSJ4/OHU9k2YlsmBpyScFo/wbLzWQJBMCW4+IO3/+OQ==",
-      "license": "MIT"
+    "node_modules/@jridgewell/remapping": {
+      "version": "2.3.5",
+      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
+      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jridgewell/gen-mapping": "^0.3.5",
+        "@jridgewell/trace-mapping": "^0.3.24"
+      }
     },
-    "node_modules/encodeurl": {
-      "version": "2.0.0",
-      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
-      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
+    "node_modules/@jridgewell/resolve-uri": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
+      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
+      "dev": true,
       "license": "MIT",
       "engines": {
-        "node": ">= 0.8"
+        "node": ">=6.0.0"
       }
     },
-    "node_modules/engine.io": {
-      "version": "6.6.5",
-      "resolved": "https://registry.npmjs.org/engine.io/-/engine.io-6.6.5.tgz",
-      "integrity": "sha512-2RZdgEbXmp5+dVbRm0P7HQUImZpICccJy7rN7Tv+SFa55pH+lxnuw6/K1ZxxBfHoYpSkHLAO92oa8O4SwFXA2A==",
+    "node_modules/@jridgewell/sourcemap-codec": {
+      "version": "1.5.5",
+      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
+      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@jridgewell/trace-mapping": {
+      "version": "0.3.31",
+      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
+      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "@types/cors": "^2.8.12",
-        "@types/node": ">=10.0.0",
-        "accepts": "~1.3.4",
-        "base64id": "2.0.0",
-        "cookie": "~0.7.2",
-        "cors": "~2.8.5",
-        "debug": "~4.4.1",
-        "engine.io-parser": "~5.2.1",
-        "ws": "~8.18.3"
-      },
-      "engines": {
-        "node": ">=10.2.0"
+        "@jridgewell/resolve-uri": "^3.1.0",
+        "@jridgewell/sourcemap-codec": "^1.4.14"
       }
     },
-    "node_modules/engine.io-parser": {
-      "version": "5.2.3",
-      "resolved": "https://registry.npmjs.org/engine.io-parser/-/engine.io-parser-5.2.3.tgz",
-      "integrity": "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q==",
+    "node_modules/@noble/hashes": {
+      "version": "1.8.0",
+      "resolved": "https://registry.npmjs.org/@noble/hashes/-/hashes-1.8.0.tgz",
+      "integrity": "sha512-jCs9ldd7NwzpgXDIf6P3+NrHh9/sD6CQdxHyjQI+h/6rDNo88ypBxxz45UDuZHz9r3tNz7N/VInSVoVdtXEI4A==",
+      "dev": true,
       "license": "MIT",
       "engines": {
-        "node": ">=10.0.0"
+        "node": "^14.21.3 || >=16"
+      },
+      "funding": {
+        "url": "https://paulmillr.com/funding/"
       }
     },
-    "node_modules/engine.io/node_modules/debug": {
-      "version": "4.4.3",
-      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
-      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+    "node_modules/@paralleldrive/cuid2": {
+      "version": "2.3.1",
+      "resolved": "https://registry.npmjs.org/@paralleldrive/cuid2/-/cuid2-2.3.1.tgz",
+      "integrity": "sha512-XO7cAxhnTZl0Yggq6jOgjiOHhbgcO4NqFqwSmQpjK3b6TEE6Uj/jfSk6wzYyemh3+I0sHirKSetjQwn5cZktFw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "ms": "^2.1.3"
-      },
+        "@noble/hashes": "^1.1.5"
+      }
+    },
+    "node_modules/@prisma/client": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/client/-/client-5.22.0.tgz",
+      "integrity": "sha512-M0SVXfyHnQREBKxCgyo7sffrKttwE6R8PMq330MIUF0pTwjUhLbW84pFDlf06B27XyCR++VtjugEnIHdr07SVA==",
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
       "engines": {
-        "node": ">=6.0"
+        "node": ">=16.13"
+      },
+      "peerDependencies": {
+        "prisma": "*"
       },
       "peerDependenciesMeta": {
-        "supports-color": {
+        "prisma": {
           "optional": true
         }
       }
     },
-    "node_modules/engine.io/node_modules/ms": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
-      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
-      "license": "MIT"
+    "node_modules/@prisma/debug": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/debug/-/debug-5.22.0.tgz",
+      "integrity": "sha512-AUt44v3YJeggO2ZU5BkXI7M4hu9BF2zzH2iF2V5pyXT/lRTyWiElZ7It+bRH1EshoMRxHgpYg4VB6rCM+mG5jQ==",
+      "devOptional": true,
+      "license": "Apache-2.0"
     },
-    "node_modules/es-define-property": {
-      "version": "1.0.1",
-      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
-      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
-      "license": "MIT",
-      "engines": {
-        "node": ">= 0.4"
+    "node_modules/@prisma/engines": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/engines/-/engines-5.22.0.tgz",
+      "integrity": "sha512-UNjfslWhAt06kVL3CjkuYpHAWSO6L4kDCVPegV6itt7nD1kSJavd3vhgAEhjglLJJKEdJ7oIqDJ+yHk6qO8gPA==",
+      "devOptional": true,
+      "hasInstallScript": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0",
+        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+        "@prisma/fetch-engine": "5.22.0",
+        "@prisma/get-platform": "5.22.0"
       }
     },
-    "node_modules/es-errors": {
-      "version": "1.3.0",
-      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
+    "node_modules/@prisma/engines-version": {
+      "version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+      "resolved": "https://registry.npmjs.org/@prisma/engines-version/-/engines-version-5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2.tgz",
+      "integrity": "sha512-2PTmxFR2yHW/eB3uqWtcgRcgAbG1rwG9ZriSvQw+nnb7c4uCr3RAcGMb6/zfE88SKlC1Nj2ziUvc96Z379mHgQ==",
+      "devOptional": true,
+      "license": "Apache-2.0"
+    },
+    "node_modules/@prisma/fetch-engine": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/fetch-engine/-/fetch-engine-5.22.0.tgz",
+      "integrity": "sha512-bkrD/Mc2fSvkQBV5EpoFcZ87AvOgDxbG99488a5cexp5Ccny+UM6MAe/UFkUC0wLYD9+9befNOqGiIJhhq+HbA==",
+      "devOptional": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0",
+        "@prisma/engines-version": "5.22.0-44.605197351a3c8bdd595af2d2a9bc3025bca48ea2",
+        "@prisma/get-platform": "5.22.0"
+      }
+    },
+    "node_modules/@prisma/get-platform": {
+      "version": "5.22.0",
+      "resolved": "https://registry.npmjs.org/@prisma/get-platform/-/get-platform-5.22.0.tgz",
+      "integrity": "sha512-pHhpQdr1UPFpt+zFfnPazhulaZYCUqeIcPpJViYoq9R+D/yw4fjE+CtnsnKzPYm0ddUbeXUzjGVGIRVgPDCk4Q==",
+      "devOptional": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "@prisma/debug": "5.22.0"
+      }
+    },
+    "node_modules/@sinclair/typebox": {
+      "version": "0.27.10",
+      "resolved": "https://registry.npmjs.org/@sinclair/typebox/-/typebox-0.27.10.tgz",
+      "integrity": "sha512-MTBk/3jGLNB2tVxv6uLlFh1iu64iYOQ2PbdOSK3NW8JZsmlaOh2q6sdtKowBhfw8QFLmYNzTW4/oK4uATIi6ZA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@sinonjs/commons": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/@sinonjs/commons/-/commons-3.0.1.tgz",
+      "integrity": "sha512-K3mCHKQ9sVh8o1C9cxkwxaOmXoAMlDxC1mYyHrjqOWEcBjYr76t96zL2zlj5dUGZ3HSw240X1qgH3Mjf1yJWpQ==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "type-detect": "4.0.8"
+      }
+    },
+    "node_modules/@sinonjs/fake-timers": {
+      "version": "10.3.0",
+      "resolved": "https://registry.npmjs.org/@sinonjs/fake-timers/-/fake-timers-10.3.0.tgz",
+      "integrity": "sha512-V4BG07kuYSUkTCSBHG8G8TNhM+F19jXFWnQtzj+we8DrkpSBCee9Z3Ms8yiGer/dlmhe35/Xdgyo3/0rQKg7YA==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "@sinonjs/commons": "^3.0.0"
+      }
+    },
+    "node_modules/@so-ric/colorspace": {
+      "version": "1.1.6",
+      "resolved": "https://registry.npmjs.org/@so-ric/colorspace/-/colorspace-1.1.6.tgz",
+      "integrity": "sha512-/KiKkpHNOBgkFJwu9sh48LkHSMYGyuTcSFK/qMBdnOAlrRJzRSXAOFB5qwzaVQuDl8wAvHVMkaASQDReTahxuw==",
+      "license": "MIT",
+      "dependencies": {
+        "color": "^5.0.2",
+        "text-hex": "1.0.x"
+      }
+    },
+    "node_modules/@socket.io/component-emitter": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/@socket.io/component-emitter/-/component-emitter-3.1.2.tgz",
+      "integrity": "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA==",
+      "license": "MIT"
+    },
+    "node_modules/@swc/helpers": {
+      "version": "0.3.17",
+      "resolved": "https://registry.npmjs.org/@swc/helpers/-/helpers-0.3.17.tgz",
+      "integrity": "sha512-tb7Iu+oZ+zWJZ3HJqwx8oNwSDIU440hmVMDPhpACWQWnrZHK99Bxs70gT1L2dnr5Hg50ZRWEFkQCAnOVVV0z1Q==",
+      "license": "MIT",
+      "dependencies": {
+        "tslib": "^2.4.0"
+      }
+    },
+    "node_modules/@types/babel__core": {
+      "version": "7.20.5",
+      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
+      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.20.7",
+        "@babel/types": "^7.20.7",
+        "@types/babel__generator": "*",
+        "@types/babel__template": "*",
+        "@types/babel__traverse": "*"
+      }
+    },
+    "node_modules/@types/babel__generator": {
+      "version": "7.27.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
+      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.0.0"
+      }
+    },
+    "node_modules/@types/babel__template": {
+      "version": "7.4.4",
+      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
+      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/parser": "^7.1.0",
+        "@babel/types": "^7.0.0"
+      }
+    },
+    "node_modules/@types/babel__traverse": {
+      "version": "7.28.0",
+      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
+      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/types": "^7.28.2"
+      }
+    },
+    "node_modules/@types/cors": {
+      "version": "2.8.19",
+      "resolved": "https://registry.npmjs.org/@types/cors/-/cors-2.8.19.tgz",
+      "integrity": "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": "*"
+      }
+    },
+    "node_modules/@types/graceful-fs": {
+      "version": "4.1.9",
+      "resolved": "https://registry.npmjs.org/@types/graceful-fs/-/graceful-fs-4.1.9.tgz",
+      "integrity": "sha512-olP3sd1qOEe5dXTSaFvQG+02VdRXcdytWLAZsAq1PecU8uqQAhkrnbli7DagjtXKW/Bl7YJbUsa8MPcuc8LHEQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": "*"
+      }
+    },
+    "node_modules/@types/istanbul-lib-coverage": {
+      "version": "2.0.6",
+      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-coverage/-/istanbul-lib-coverage-2.0.6.tgz",
+      "integrity": "sha512-2QF/t/auWm0lsy8XtKVPG19v3sSOQlJe/YHZgfjb/KBBHOGSV+J2q/S671rcq9uTBrLAXmZpqJiaQbMT+zNU1w==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@types/istanbul-lib-report": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/@types/istanbul-lib-report/-/istanbul-lib-report-3.0.3.tgz",
+      "integrity": "sha512-NQn7AHQnk/RSLOxrBbGyJM/aVQ+pjj5HCgasFxc0K/KhoATfQ/47AyUl15I2yBUpihjmas+a+VJBOqecrFH+uA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@types/istanbul-lib-coverage": "*"
+      }
+    },
+    "node_modules/@types/istanbul-reports": {
+      "version": "3.0.4",
+      "resolved": "https://registry.npmjs.org/@types/istanbul-reports/-/istanbul-reports-3.0.4.tgz",
+      "integrity": "sha512-pk2B1NWalF9toCRu6gjBzR69syFjP4Od8WRAX+0mmf9lAjCRicLOWc+ZrxZHx/0XRjotgkF9t6iaMJ+aXcOdZQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@types/istanbul-lib-report": "*"
+      }
+    },
+    "node_modules/@types/node": {
+      "version": "25.3.0",
+      "resolved": "https://registry.npmjs.org/@types/node/-/node-25.3.0.tgz",
+      "integrity": "sha512-4K3bqJpXpqfg2XKGK9bpDTc6xO/xoUP/RBWS7AtRMug6zZFaRekiLzjVtAoZMquxoAbzBvy5nxQ7veS5eYzf8A==",
+      "license": "MIT",
+      "dependencies": {
+        "undici-types": "~7.18.0"
+      }
+    },
+    "node_modules/@types/stack-utils": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/@types/stack-utils/-/stack-utils-2.0.3.tgz",
+      "integrity": "sha512-9aEbYZ3TbYMznPdcdr3SmIrLXwC/AKZXQeCf9Pgao5CKb8CyHuEX5jzWPTkvregvhRJHcpRO6BFoGW9ycaOkYw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/@types/triple-beam": {
+      "version": "1.3.5",
+      "resolved": "https://registry.npmjs.org/@types/triple-beam/-/triple-beam-1.3.5.tgz",
+      "integrity": "sha512-6WaYesThRMCl19iryMYP7/x2OVgCtbIVflDGFpWnb9irXI3UjYE4AzmYuiUKY1AJstGijoY+MgUszMgRxIYTYw==",
+      "license": "MIT"
+    },
+    "node_modules/@types/yargs": {
+      "version": "17.0.35",
+      "resolved": "https://registry.npmjs.org/@types/yargs/-/yargs-17.0.35.tgz",
+      "integrity": "sha512-qUHkeCyQFxMXg79wQfTtfndEC+N9ZZg76HJftDJp+qH2tV7Gj4OJi7l+PiWwJ+pWtW8GwSmqsDj/oymhrTWXjg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@types/yargs-parser": "*"
+      }
+    },
+    "node_modules/@types/yargs-parser": {
+      "version": "21.0.3",
+      "resolved": "https://registry.npmjs.org/@types/yargs-parser/-/yargs-parser-21.0.3.tgz",
+      "integrity": "sha512-I4q9QU9MQv4oEOz4tAHJtNz1cwuLxn2F3xcc2iV5WdqLPpUnj30aUuxt1mAxYTG+oe8CZMV/+6rU4S4gRDzqtQ==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/accepts": {
+      "version": "1.3.8",
+      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
+      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-types": "~2.1.34",
+        "negotiator": "0.6.3"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/agent-base": {
+      "version": "6.0.2",
+      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
+      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "4"
+      },
+      "engines": {
+        "node": ">= 6.0.0"
+      }
+    },
+    "node_modules/agent-base/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/agent-base/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/ansi-escapes": {
+      "version": "4.3.2",
+      "resolved": "https://registry.npmjs.org/ansi-escapes/-/ansi-escapes-4.3.2.tgz",
+      "integrity": "sha512-gKXj5ALrKWQLsYG9jlTRmR/xKluxHV+Z9QEwNIgCfM1/uwPMCuzVVnh5mwTd+OuBZcwSIMbqssNWRm1lE51QaQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "type-fest": "^0.21.3"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/ansi-regex": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
+      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/ansi-styles": {
+      "version": "4.3.0",
+      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
+      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "color-convert": "^2.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
+      }
+    },
+    "node_modules/ansi-styles/node_modules/color-convert": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
+      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "~1.1.4"
+      },
+      "engines": {
+        "node": ">=7.0.0"
+      }
+    },
+    "node_modules/ansi-styles/node_modules/color-name": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
+      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/anymatch": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
+      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "normalize-path": "^3.0.0",
+        "picomatch": "^2.0.4"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/append-field": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/append-field/-/append-field-1.0.0.tgz",
+      "integrity": "sha512-klpgFSWLW1ZEs8svjfb7g4qWY0YS5imI82dTg+QahUvJ8YqAY0P10Uk8tTyh9ZGuYEZEMaeJYCF5BFuX552hsw==",
+      "license": "MIT"
+    },
+    "node_modules/argparse": {
+      "version": "1.0.10",
+      "resolved": "https://registry.npmjs.org/argparse/-/argparse-1.0.10.tgz",
+      "integrity": "sha512-o5Roy6tNG4SL/FOkCAN6RzjiakZS25RLYFrcMttJqbdd8BWrnA+fGz57iN5Pb06pvBGvl5gQ0B48dJlslXvoTg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "sprintf-js": "~1.0.2"
+      }
+    },
+    "node_modules/array-buffer-byte-length": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/array-buffer-byte-length/-/array-buffer-byte-length-1.0.2.tgz",
+      "integrity": "sha512-LHE+8BuR7RYGDKvnrmcuSq3tDcKv9OFEXQt/HpbZhY7V6h0zlUXutnAD82GiFx9rdieCMjkvtcsPqBwgUl1Iiw==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3",
+        "is-array-buffer": "^3.0.5"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/array-flatten": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/array-flatten/-/array-flatten-1.1.1.tgz",
+      "integrity": "sha512-PCVAQswWemu6UdxsDFFX/+gVeYqKAod3D3UVm91jHwynguOwAvYPhx8nNlM++NqRcK6CxxpUafjmhIdKiHibqg==",
+      "license": "MIT"
+    },
+    "node_modules/asap": {
+      "version": "2.0.6",
+      "resolved": "https://registry.npmjs.org/asap/-/asap-2.0.6.tgz",
+      "integrity": "sha512-BSHWgDSAiKs50o2Re8ppvp3seVHXSRM44cdSsT9FfNEUUZLOGWVCsiWaRPWM1Znn+mqZ1OfVZ3z3DWEzSp7hRA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/asn1.js": {
+      "version": "5.4.1",
+      "resolved": "https://registry.npmjs.org/asn1.js/-/asn1.js-5.4.1.tgz",
+      "integrity": "sha512-+I//4cYPccV8LdmBLiX8CYvf9Sp3vQsrqu2QNXRcrbiWvcx/UdlFiqUJJzxRQxgsZmvhXhn4cSKeSmoFjVdupA==",
+      "license": "MIT",
+      "dependencies": {
+        "bn.js": "^4.0.0",
+        "inherits": "^2.0.1",
+        "minimalistic-assert": "^1.0.0",
+        "safer-buffer": "^2.1.0"
+      }
+    },
+    "node_modules/async": {
+      "version": "3.2.6",
+      "resolved": "https://registry.npmjs.org/async/-/async-3.2.6.tgz",
+      "integrity": "sha512-htCUDlxyyCLMgaM3xXg0C0LW2xqfuQ6p05pCEIsXuyQ+a1koYKTuBMzRNwmybfLgvJDMd0r1LTn4+E0Ti6C2AA==",
+      "license": "MIT"
+    },
+    "node_modules/asynckit": {
+      "version": "0.4.0",
+      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
+      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
+      "license": "MIT"
+    },
+    "node_modules/available-typed-arrays": {
+      "version": "1.0.7",
+      "resolved": "https://registry.npmjs.org/available-typed-arrays/-/available-typed-arrays-1.0.7.tgz",
+      "integrity": "sha512-wvUjBtSGN7+7SjNpq/9M2Tg350UZD3q62IFZLbRAR1bSMlCo1ZaeW+BJ+D090e4hIIZLBcTDWe4Mh4jvUDajzQ==",
+      "license": "MIT",
+      "dependencies": {
+        "possible-typed-array-names": "^1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/axios": {
+      "version": "1.13.5",
+      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.5.tgz",
+      "integrity": "sha512-cz4ur7Vb0xS4/KUN0tPWe44eqxrIu31me+fbang3ijiNscE129POzipJJA6zniq2C/Z6sJCjMimjS8Lc/GAs8Q==",
+      "license": "MIT",
+      "dependencies": {
+        "follow-redirects": "^1.15.11",
+        "form-data": "^4.0.5",
+        "proxy-from-env": "^1.1.0"
+      }
+    },
+    "node_modules/babel-jest": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/babel-jest/-/babel-jest-29.7.0.tgz",
+      "integrity": "sha512-BrvGY3xZSwEcCzKvKsCi2GgHqDqsYkOP4/by5xCgIwGXQxIEh+8ew3gmrE1y7XRR6LHZIj6yLYnUi/mm2KXKBg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jest/transform": "^29.7.0",
+        "@types/babel__core": "^7.1.14",
+        "babel-plugin-istanbul": "^6.1.1",
+        "babel-preset-jest": "^29.6.3",
+        "chalk": "^4.0.0",
+        "graceful-fs": "^4.2.9",
+        "slash": "^3.0.0"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.8.0"
+      }
+    },
+    "node_modules/babel-plugin-istanbul": {
+      "version": "6.1.1",
+      "resolved": "https://registry.npmjs.org/babel-plugin-istanbul/-/babel-plugin-istanbul-6.1.1.tgz",
+      "integrity": "sha512-Y1IQok9821cC9onCx5otgFfRm7Lm+I+wwxOx738M/WLPZ9Q42m4IG5W0FNX8WLL2gYMZo3JkuXIH2DOpWM+qwA==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "@babel/helper-plugin-utils": "^7.0.0",
+        "@istanbuljs/load-nyc-config": "^1.0.0",
+        "@istanbuljs/schema": "^0.1.2",
+        "istanbul-lib-instrument": "^5.0.4",
+        "test-exclude": "^6.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/babel-plugin-istanbul/node_modules/istanbul-lib-instrument": {
+      "version": "5.2.1",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-instrument/-/istanbul-lib-instrument-5.2.1.tgz",
+      "integrity": "sha512-pzqtp31nLv/XFOzXGuvhCb8qhjmTVo5vjVk19XE4CRlSWz0KoeJ3bw9XsA7nOp9YBf4qHjwBxkDzKcME/J29Yg==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "@babel/core": "^7.12.3",
+        "@babel/parser": "^7.14.7",
+        "@istanbuljs/schema": "^0.1.2",
+        "istanbul-lib-coverage": "^3.2.0",
+        "semver": "^6.3.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/babel-plugin-istanbul/node_modules/semver": {
+      "version": "6.3.1",
+      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
+      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
+      "dev": true,
+      "license": "ISC",
+      "bin": {
+        "semver": "bin/semver.js"
+      }
+    },
+    "node_modules/babel-plugin-jest-hoist": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/babel-plugin-jest-hoist/-/babel-plugin-jest-hoist-29.6.3.tgz",
+      "integrity": "sha512-ESAc/RJvGTFEzRwOTT4+lNDk/GNHMkKbNzsvT0qKRfDyyYTskxB5rnU2njIDYVxXCBHHEI1c0YwHob3WaYujOg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/template": "^7.3.3",
+        "@babel/types": "^7.3.3",
+        "@types/babel__core": "^7.1.14",
+        "@types/babel__traverse": "^7.0.6"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      }
+    },
+    "node_modules/babel-preset-current-node-syntax": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/babel-preset-current-node-syntax/-/babel-preset-current-node-syntax-1.2.0.tgz",
+      "integrity": "sha512-E/VlAEzRrsLEb2+dv8yp3bo4scof3l9nR4lrld+Iy5NyVqgVYUJnDAmunkhPMisRI32Qc4iRiz425d8vM++2fg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/plugin-syntax-async-generators": "^7.8.4",
+        "@babel/plugin-syntax-bigint": "^7.8.3",
+        "@babel/plugin-syntax-class-properties": "^7.12.13",
+        "@babel/plugin-syntax-class-static-block": "^7.14.5",
+        "@babel/plugin-syntax-import-attributes": "^7.24.7",
+        "@babel/plugin-syntax-import-meta": "^7.10.4",
+        "@babel/plugin-syntax-json-strings": "^7.8.3",
+        "@babel/plugin-syntax-logical-assignment-operators": "^7.10.4",
+        "@babel/plugin-syntax-nullish-coalescing-operator": "^7.8.3",
+        "@babel/plugin-syntax-numeric-separator": "^7.10.4",
+        "@babel/plugin-syntax-object-rest-spread": "^7.8.3",
+        "@babel/plugin-syntax-optional-catch-binding": "^7.8.3",
+        "@babel/plugin-syntax-optional-chaining": "^7.8.3",
+        "@babel/plugin-syntax-private-property-in-object": "^7.14.5",
+        "@babel/plugin-syntax-top-level-await": "^7.14.5"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0 || ^8.0.0-0"
+      }
+    },
+    "node_modules/babel-preset-jest": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/babel-preset-jest/-/babel-preset-jest-29.6.3.tgz",
+      "integrity": "sha512-0B3bhxR6snWXJZtR/RliHTDPRgn1sNHOR0yVtq/IiQFyuOVjFS+wuio/R4gSNkyYmKmJB4wGZv2NZanmKmTnNA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "babel-plugin-jest-hoist": "^29.6.3",
+        "babel-preset-current-node-syntax": "^1.0.0"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "@babel/core": "^7.0.0"
+      }
+    },
+    "node_modules/balanced-match": {
+      "version": "4.0.4",
+      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-4.0.4.tgz",
+      "integrity": "sha512-BLrgEcRTwX2o6gGxGOCNyMvGSp35YofuYzw9h1IMTRmKqttAZZVU67bdb9Pr2vUHA8+j3i2tJfjO6C6+4myGTA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/base64-js": {
+      "version": "1.5.1",
+      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
+      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/feross"
+        },
+        {
+          "type": "patreon",
+          "url": "https://www.patreon.com/feross"
+        },
+        {
+          "type": "consulting",
+          "url": "https://feross.org/support"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/base64id": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/base64id/-/base64id-2.0.0.tgz",
+      "integrity": "sha512-lGe34o6EHj9y3Kts9R4ZYs/Gr+6N7MCaMlIFA3F1R2O5/m7K06AxfSeO5530PEERE6/WyEg3lsuyw4GHlPZHog==",
+      "license": "MIT",
+      "engines": {
+        "node": "^4.5.0 || >= 5.9"
+      }
+    },
+    "node_modules/baseline-browser-mapping": {
+      "version": "2.10.0",
+      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.10.0.tgz",
+      "integrity": "sha512-lIyg0szRfYbiy67j9KN8IyeD7q7hcmqnJ1ddWmNt19ItGpNN64mnllmxUNFIOdOm6by97jlL6wfpTTJrmnjWAA==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "bin": {
+        "baseline-browser-mapping": "dist/cli.cjs"
+      },
+      "engines": {
+        "node": ">=6.0.0"
+      }
+    },
+    "node_modules/bcryptjs": {
+      "version": "2.4.3",
+      "resolved": "https://registry.npmjs.org/bcryptjs/-/bcryptjs-2.4.3.tgz",
+      "integrity": "sha512-V/Hy/X9Vt7f3BbPJEi8BdVFMByHi+jNXrYkW3huaybV/kQ0KJg0Y6PkEMbn+zeT+i+SiKZ/HMqJGIIt4LZDqNQ==",
+      "license": "MIT"
+    },
+    "node_modules/binary-extensions": {
+      "version": "2.3.0",
+      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
+      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/bn.js": {
+      "version": "4.12.3",
+      "resolved": "https://registry.npmjs.org/bn.js/-/bn.js-4.12.3.tgz",
+      "integrity": "sha512-fGTi3gxV/23FTYdAoUtLYp6qySe2KE3teyZitipKNRuVYcBkoP/bB3guXN/XVKUe9mxCHXnc9C4ocyz8OmgN0g==",
+      "license": "MIT"
+    },
+    "node_modules/body-parser": {
+      "version": "1.20.4",
+      "resolved": "https://registry.npmjs.org/body-parser/-/body-parser-1.20.4.tgz",
+      "integrity": "sha512-ZTgYYLMOXY9qKU/57FAo8F+HA2dGX7bqGc71txDRC1rS4frdFI5R7NhluHxH6M0YItAP0sHB4uqAOcYKxO6uGA==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "~3.1.2",
+        "content-type": "~1.0.5",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "destroy": "~1.2.0",
+        "http-errors": "~2.0.1",
+        "iconv-lite": "~0.4.24",
+        "on-finished": "~2.4.1",
+        "qs": "~6.14.0",
+        "raw-body": "~2.5.3",
+        "type-is": "~1.6.18",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/brace-expansion": {
+      "version": "5.0.3",
+      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-5.0.3.tgz",
+      "integrity": "sha512-fy6KJm2RawA5RcHkLa1z/ScpBeA762UF9KmZQxwIbDtRJrgLzM10depAiEQ+CXYcoiqW1/m96OAAoke2nE9EeA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "balanced-match": "^4.0.2"
+      },
+      "engines": {
+        "node": "18 || 20 || >=22"
+      }
+    },
+    "node_modules/braces": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
+      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "fill-range": "^7.1.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/brotli": {
+      "version": "1.3.3",
+      "resolved": "https://registry.npmjs.org/brotli/-/brotli-1.3.3.tgz",
+      "integrity": "sha512-oTKjJdShmDuGW94SyyaoQvAjf30dZaHnjJ8uAF+u2/vGJkJbJPJAT1gDiOJP5v1Zb6f9KEyW/1HpuaWIXtGHPg==",
+      "license": "MIT",
+      "dependencies": {
+        "base64-js": "^1.1.2"
+      }
+    },
+    "node_modules/browserslist": {
+      "version": "4.28.1",
+      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
+      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
+      "dev": true,
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/browserslist"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "baseline-browser-mapping": "^2.9.0",
+        "caniuse-lite": "^1.0.30001759",
+        "electron-to-chromium": "^1.5.263",
+        "node-releases": "^2.0.27",
+        "update-browserslist-db": "^1.2.0"
+      },
+      "bin": {
+        "browserslist": "cli.js"
+      },
+      "engines": {
+        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
+      }
+    },
+    "node_modules/bser": {
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/bser/-/bser-2.1.1.tgz",
+      "integrity": "sha512-gQxTNE/GAfIIrmHLUE3oJyp5FO6HRBfhjnw4/wMmA63ZGDJnWBmgY/lyQBpnDUkGmAhbSe39tx2d/iTOAfglwQ==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "node-int64": "^0.4.0"
+      }
+    },
+    "node_modules/buffer-equal-constant-time": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/buffer-equal-constant-time/-/buffer-equal-constant-time-1.0.1.tgz",
+      "integrity": "sha512-zRpUiDwd/xk6ADqPMATG8vc9VPrkck7T07OIx0gnjmJAnHnTVXNQG3vfvWNuiZIkwu9KrKdA1iJKfsfTVxE6NA==",
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/buffer-from": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
+      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
+      "license": "MIT"
+    },
+    "node_modules/busboy": {
+      "version": "1.6.0",
+      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
+      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
+      "dependencies": {
+        "streamsearch": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=10.16.0"
+      }
+    },
+    "node_modules/bytes": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/bytes/-/bytes-3.1.2.tgz",
+      "integrity": "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/call-bind": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/call-bind/-/call-bind-1.0.8.tgz",
+      "integrity": "sha512-oKlSFMcMwpUg2ednkhQ454wfWiU/ul3CkJe/PEHcTKuiX6RpbehUiFMXu13HalGZxfUwCQzZG747YXBn1im9ww==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.0",
+        "es-define-property": "^1.0.0",
+        "get-intrinsic": "^1.2.4",
+        "set-function-length": "^1.2.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/call-bind-apply-helpers": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
+      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/call-bound": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
+      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "get-intrinsic": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/callsites": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
+      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/camelcase": {
+      "version": "5.3.1",
+      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-5.3.1.tgz",
+      "integrity": "sha512-L28STB170nwWS63UjtlEOE3dldQApaJXZkOI1uMFfzf3rRuPegHaHesyee+YxQ+W6SvRDQV6UrdOdRiR153wJg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/caniuse-lite": {
+      "version": "1.0.30001774",
+      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001774.tgz",
+      "integrity": "sha512-DDdwPGz99nmIEv216hKSgLD+D4ikHQHjBC/seF98N9CPqRX4M5mSxT9eTV6oyisnJcuzxtZy4n17yKKQYmYQOA==",
+      "dev": true,
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "CC-BY-4.0"
+    },
+    "node_modules/chalk": {
+      "version": "4.1.2",
+      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
+      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^4.1.0",
+        "supports-color": "^7.1.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/chalk?sponsor=1"
+      }
+    },
+    "node_modules/chalk/node_modules/has-flag": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
+      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/chalk/node_modules/supports-color": {
+      "version": "7.2.0",
+      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
+      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "has-flag": "^4.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/char-regex": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/char-regex/-/char-regex-1.0.2.tgz",
+      "integrity": "sha512-kWWXztvZ5SBQV+eRgKFeh8q5sLuZY2+8WUIzlxWVTg+oGwY14qylx1KbKzHd8P6ZYkAg0xyIDU9JMHhyJMZ1jw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/chokidar": {
+      "version": "3.6.0",
+      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
+      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "anymatch": "~3.1.2",
+        "braces": "~3.0.2",
+        "glob-parent": "~5.1.2",
+        "is-binary-path": "~2.1.0",
+        "is-glob": "~4.0.1",
+        "normalize-path": "~3.0.0",
+        "readdirp": "~3.6.0"
+      },
+      "engines": {
+        "node": ">= 8.10.0"
+      },
+      "funding": {
+        "url": "https://paulmillr.com/funding/"
+      },
+      "optionalDependencies": {
+        "fsevents": "~2.3.2"
+      }
+    },
+    "node_modules/ci-info": {
+      "version": "3.9.0",
+      "resolved": "https://registry.npmjs.org/ci-info/-/ci-info-3.9.0.tgz",
+      "integrity": "sha512-NIxF55hv4nSqQswkAeiOi1r83xy8JldOFDTWiug55KBu9Jnblncd2U6ViHmYgHf01TPZS77NJBhBMKdWj9HQMQ==",
+      "dev": true,
+      "funding": [
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/sibiraj-s"
+        }
+      ],
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/cjs-module-lexer": {
+      "version": "1.4.3",
+      "resolved": "https://registry.npmjs.org/cjs-module-lexer/-/cjs-module-lexer-1.4.3.tgz",
+      "integrity": "sha512-9z8TZaGM1pfswYeXrUpzPrkx8UnWYdhJclsiYMm6x/w5+nN+8Tf/LnAgfLGQCm59qAOxU8WwHEq2vNwF6i4j+Q==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/cliui": {
+      "version": "8.0.1",
+      "resolved": "https://registry.npmjs.org/cliui/-/cliui-8.0.1.tgz",
+      "integrity": "sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "string-width": "^4.2.0",
+        "strip-ansi": "^6.0.1",
+        "wrap-ansi": "^7.0.0"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/clone": {
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/clone/-/clone-2.1.2.tgz",
+      "integrity": "sha512-3Pe/CF1Nn94hyhIYpjtiLhdCoEoz0DqQ+988E9gmeEdQZlojxnOb74wctFyuwWQHzqyf9X7C7MG8juUpqBJT8w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.8"
+      }
+    },
+    "node_modules/co": {
+      "version": "4.6.0",
+      "resolved": "https://registry.npmjs.org/co/-/co-4.6.0.tgz",
+      "integrity": "sha512-QVb0dM5HvG+uaxitm8wONl7jltx8dqhfU33DcqtOZcLSVIKSDDLDi7+0LbAKiyI8hD9u42m2YxXSkMGWThaecQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "iojs": ">= 1.0.0",
+        "node": ">= 0.12.0"
+      }
+    },
+    "node_modules/collect-v8-coverage": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/collect-v8-coverage/-/collect-v8-coverage-1.0.3.tgz",
+      "integrity": "sha512-1L5aqIkwPfiodaMgQunkF1zRhNqifHBmtbbbxcr6yVxxBnliw4TDOW6NxpO8DJLgJ16OT+Y4ztZqP6p/FtXnAw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/color": {
+      "version": "5.0.3",
+      "resolved": "https://registry.npmjs.org/color/-/color-5.0.3.tgz",
+      "integrity": "sha512-ezmVcLR3xAVp8kYOm4GS45ZLLgIE6SPAFoduLr6hTDajwb3KZ2F46gulK3XpcwRFb5KKGCSezCBAY4Dw4HsyXA==",
+      "license": "MIT",
+      "dependencies": {
+        "color-convert": "^3.1.3",
+        "color-string": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/color-convert": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-3.1.3.tgz",
+      "integrity": "sha512-fasDH2ont2GqF5HpyO4w0+BcewlhHEZOFn9c1ckZdHpJ56Qb7MHhH/IcJZbBGgvdtwdwNbLvxiBEdg336iA9Sg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=14.6"
+      }
+    },
+    "node_modules/color-name": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/color-name/-/color-name-2.1.0.tgz",
+      "integrity": "sha512-1bPaDNFm0axzE4MEAzKPuqKWeRaT43U/hyxKPBdqTfmPF+d6n7FSoTFxLVULUJOmiLp01KjhIPPH+HrXZJN4Rg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=12.20"
+      }
+    },
+    "node_modules/color-string": {
+      "version": "2.1.4",
+      "resolved": "https://registry.npmjs.org/color-string/-/color-string-2.1.4.tgz",
+      "integrity": "sha512-Bb6Cq8oq0IjDOe8wJmi4JeNn763Xs9cfrBcaylK1tPypWzyoy2G3l90v9k64kjphl/ZJjPIShFztenRomi8WTg==",
+      "license": "MIT",
+      "dependencies": {
+        "color-name": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=18"
+      }
+    },
+    "node_modules/combined-stream": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
+      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
+      "license": "MIT",
+      "dependencies": {
+        "delayed-stream": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/commander": {
+      "version": "6.2.1",
+      "resolved": "https://registry.npmjs.org/commander/-/commander-6.2.1.tgz",
+      "integrity": "sha512-U7VdrJFnJgo4xjrHpTzu0yrHPGImdsmD95ZlgYSEajAn2JKzDhDTPG9kBTefmObL2w/ngeZnilk+OV9CG3d7UA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/component-emitter": {
+      "version": "1.3.1",
+      "resolved": "https://registry.npmjs.org/component-emitter/-/component-emitter-1.3.1.tgz",
+      "integrity": "sha512-T0+barUSQRTUQASh8bx02dl+DhF54GtIDY13Y3m9oWTklKbb3Wv974meRpeZ3lp1JpLVECWWNHC4vaG2XHXouQ==",
+      "dev": true,
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/compressible": {
+      "version": "2.0.18",
+      "resolved": "https://registry.npmjs.org/compressible/-/compressible-2.0.18.tgz",
+      "integrity": "sha512-AF3r7P5dWxL8MxyITRMlORQNaOA2IkAFaTr4k7BUumjPtRpGDTZpl0Pb1XCO6JeDCBdp126Cgs9sMxqSjgYyRg==",
+      "license": "MIT",
+      "dependencies": {
+        "mime-db": ">= 1.43.0 < 2"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/compression": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/compression/-/compression-1.8.1.tgz",
+      "integrity": "sha512-9mAqGPHLakhCLeNyxPkK4xVo746zQ/czLH1Ky+vkitMnWfWZps8r0qXuwhwizagCRttsL4lfG4pIOvaWLpAP0w==",
+      "license": "MIT",
+      "dependencies": {
+        "bytes": "3.1.2",
+        "compressible": "~2.0.18",
+        "debug": "2.6.9",
+        "negotiator": "~0.6.4",
+        "on-headers": "~1.1.0",
+        "safe-buffer": "5.2.1",
+        "vary": "~1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/compression/node_modules/negotiator": {
+      "version": "0.6.4",
+      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.4.tgz",
+      "integrity": "sha512-myRT3DiWPHqho5PrJaIRyaMv2kgYf0mUVgBNOYMuCH5Ki1yEiQaf/ZJuQ62nvpc44wL5WDbTX7yGJi1Neevw8w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/concat-map": {
+      "version": "0.0.1",
+      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
+      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/concat-stream": {
+      "version": "1.6.2",
+      "resolved": "https://registry.npmjs.org/concat-stream/-/concat-stream-1.6.2.tgz",
+      "integrity": "sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==",
+      "engines": [
+        "node >= 0.8"
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "buffer-from": "^1.0.0",
+        "inherits": "^2.0.3",
+        "readable-stream": "^2.2.2",
+        "typedarray": "^0.0.6"
+      }
+    },
+    "node_modules/content-disposition": {
+      "version": "0.5.4",
+      "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
+      "integrity": "sha512-FveZTNuGw04cxlAiWbzi6zTAL/lhehaWbTtgluJh4/E95DqMwTmha3KZN1aAWA8cFIhHzMZUvLevkw5Rqk+tSQ==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "5.2.1"
+      },
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/content-type": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/content-type/-/content-type-1.0.5.tgz",
+      "integrity": "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/convert-source-map": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
+      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/cookie": {
+      "version": "0.7.2",
+      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
+      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/cookie-parser": {
+      "version": "1.4.7",
+      "resolved": "https://registry.npmjs.org/cookie-parser/-/cookie-parser-1.4.7.tgz",
+      "integrity": "sha512-nGUvgXnotP3BsjiLX2ypbQnWoGUPIIfHQNZkkC668ntrzGWEZVW70HDEB1qnNGMicPje6EttlIgzo51YSwNQGw==",
+      "license": "MIT",
+      "dependencies": {
+        "cookie": "0.7.2",
+        "cookie-signature": "1.0.6"
+      },
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/cookie-signature": {
+      "version": "1.0.6",
+      "resolved": "https://registry.npmjs.org/cookie-signature/-/cookie-signature-1.0.6.tgz",
+      "integrity": "sha512-QADzlaHc8icV8I7vbaJXJwod9HWYp8uCqf1xa4OfNu1T7JVxQIrUgOWtHdNDtPiywmFbiS12VjotIXLrKM3orQ==",
+      "license": "MIT"
+    },
+    "node_modules/cookiejar": {
+      "version": "2.1.4",
+      "resolved": "https://registry.npmjs.org/cookiejar/-/cookiejar-2.1.4.tgz",
+      "integrity": "sha512-LDx6oHrK+PhzLKJU9j5S7/Y3jM/mUHvD/DeI1WQmJn652iPC5Y4TBzC9l+5OMOXlyTTA+SmVUPm0HQUwpD5Jqw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/core-util-is": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/core-util-is/-/core-util-is-1.0.3.tgz",
+      "integrity": "sha512-ZQBvi1DcpJ4GDqanjucZ2Hj3wEO5pZDS89BWbkcrvdxksJorwUDDZamX9ldFkp9aw2lmBDLgkObEA4DWNJ9FYQ==",
+      "license": "MIT"
+    },
+    "node_modules/cors": {
+      "version": "2.8.5",
+      "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.5.tgz",
+      "integrity": "sha512-KIHbLJqu73RGr/hnbrO9uBeixNGuvSQjul/jdFvS/KFSIH1hWVd1ng7zOHx+YrEfInLG7q4n6GHQ9cDtxv/P6g==",
+      "license": "MIT",
+      "dependencies": {
+        "object-assign": "^4",
+        "vary": "^1"
+      },
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/create-jest": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/create-jest/-/create-jest-29.7.0.tgz",
+      "integrity": "sha512-Adz2bdH0Vq3F53KEMJOoftQFutWCukm6J24wbPWRO4k1kMY7gS7ds/uoJkNuV8wDCtWWnuwGcJwpWcih+zEW1Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jest/types": "^29.6.3",
+        "chalk": "^4.0.0",
+        "exit": "^0.1.2",
+        "graceful-fs": "^4.2.9",
+        "jest-config": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "prompts": "^2.0.1"
+      },
+      "bin": {
+        "create-jest": "bin/create-jest.js"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      }
+    },
+    "node_modules/cross-spawn": {
+      "version": "7.0.6",
+      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
+      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "path-key": "^3.1.0",
+        "shebang-command": "^2.0.0",
+        "which": "^2.0.1"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/crypto-js": {
+      "version": "4.2.0",
+      "resolved": "https://registry.npmjs.org/crypto-js/-/crypto-js-4.2.0.tgz",
+      "integrity": "sha512-KALDyEYgpY+Rlob/iriUtjV6d5Eq+Y191A5g4UqLAi8CyGP9N1+FdVbkc1SxKc2r4YAYqG8JzO2KGL+AizD70Q==",
+      "license": "MIT"
+    },
+    "node_modules/date-fns": {
+      "version": "2.30.0",
+      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-2.30.0.tgz",
+      "integrity": "sha512-fnULvOpxnC5/Vg3NCiWelDsLiUc9bRwAPs/+LfTLNvetFCtCTN+yQz15C/fs4AwX1R9K5GLtLfn8QW+dWisaAw==",
+      "license": "MIT",
+      "dependencies": {
+        "@babel/runtime": "^7.21.0"
+      },
+      "engines": {
+        "node": ">=0.11"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/date-fns"
+      }
+    },
+    "node_modules/dayjs": {
+      "version": "1.11.19",
+      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
+      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
+      "license": "MIT"
+    },
+    "node_modules/debug": {
+      "version": "2.6.9",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-2.6.9.tgz",
+      "integrity": "sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "2.0.0"
+      }
+    },
+    "node_modules/dedent": {
+      "version": "1.7.1",
+      "resolved": "https://registry.npmjs.org/dedent/-/dedent-1.7.1.tgz",
+      "integrity": "sha512-9JmrhGZpOlEgOLdQgSm0zxFaYoQon408V1v49aqTWuXENVlnCuY9JBZcXZiCsZQWDjTm5Qf/nIvAy77mXDAjEg==",
+      "dev": true,
+      "license": "MIT",
+      "peerDependencies": {
+        "babel-plugin-macros": "^3.1.0"
+      },
+      "peerDependenciesMeta": {
+        "babel-plugin-macros": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/deep-equal": {
+      "version": "2.2.3",
+      "resolved": "https://registry.npmjs.org/deep-equal/-/deep-equal-2.2.3.tgz",
+      "integrity": "sha512-ZIwpnevOurS8bpT4192sqAowWM76JDKSHYzMLty3BZGSswgq6pBaH3DhCSW5xVAZICZyKdOBPjwww5wfgT/6PA==",
+      "license": "MIT",
+      "dependencies": {
+        "array-buffer-byte-length": "^1.0.0",
+        "call-bind": "^1.0.5",
+        "es-get-iterator": "^1.1.3",
+        "get-intrinsic": "^1.2.2",
+        "is-arguments": "^1.1.1",
+        "is-array-buffer": "^3.0.2",
+        "is-date-object": "^1.0.5",
+        "is-regex": "^1.1.4",
+        "is-shared-array-buffer": "^1.0.2",
+        "isarray": "^2.0.5",
+        "object-is": "^1.1.5",
+        "object-keys": "^1.1.1",
+        "object.assign": "^4.1.4",
+        "regexp.prototype.flags": "^1.5.1",
+        "side-channel": "^1.0.4",
+        "which-boxed-primitive": "^1.0.2",
+        "which-collection": "^1.0.1",
+        "which-typed-array": "^1.1.13"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/deep-equal/node_modules/isarray": {
+      "version": "2.0.5",
+      "resolved": "https://registry.npmjs.org/isarray/-/isarray-2.0.5.tgz",
+      "integrity": "sha512-xHjhDr3cNBK0BzdUJSPXZntQUx/mwMS5Rw4A7lPJ90XGAO6ISP/ePDNuo0vhqOZU+UD5JoodwCAAoZQd3FeAKw==",
+      "license": "MIT"
+    },
+    "node_modules/deepmerge": {
+      "version": "4.3.1",
+      "resolved": "https://registry.npmjs.org/deepmerge/-/deepmerge-4.3.1.tgz",
+      "integrity": "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/define-data-property": {
+      "version": "1.1.4",
+      "resolved": "https://registry.npmjs.org/define-data-property/-/define-data-property-1.1.4.tgz",
+      "integrity": "sha512-rBMvIzlpA8v6E+SJZoo++HAYqsLrkg7MSfIinMPFhmkorw7X+dOXVJQs+QT69zGkzMyfDnIMN2Wid1+NbL3T+A==",
+      "license": "MIT",
+      "dependencies": {
+        "es-define-property": "^1.0.0",
+        "es-errors": "^1.3.0",
+        "gopd": "^1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/define-properties": {
+      "version": "1.2.1",
+      "resolved": "https://registry.npmjs.org/define-properties/-/define-properties-1.2.1.tgz",
+      "integrity": "sha512-8QmQKqEASLd5nx0U1B1okLElbUuuttJ/AnYmRXbbbGDWh6uS208EjD4Xqq/I9wK7u0v6O08XhTWnt5XtEbR6Dg==",
+      "license": "MIT",
+      "dependencies": {
+        "define-data-property": "^1.0.1",
+        "has-property-descriptors": "^1.0.0",
+        "object-keys": "^1.1.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/delayed-stream": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
+      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.4.0"
+      }
+    },
+    "node_modules/depd": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
+      "integrity": "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/destroy": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/destroy/-/destroy-1.2.0.tgz",
+      "integrity": "sha512-2sJGJTaXIIaR1w4iJSNoN0hnMY7Gpc/n8D4qSCJw8QqFWXf7cuAgnEHxBpweaVcPevC2l3KpjYCx3NypQQgaJg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8",
+        "npm": "1.2.8000 || >= 1.4.16"
+      }
+    },
+    "node_modules/detect-newline": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/detect-newline/-/detect-newline-3.1.0.tgz",
+      "integrity": "sha512-TLz+x/vEXm/Y7P7wn1EJFNLxYpUD4TgMosxY6fAVJUnJMbupHBOncxyWUG9OpTaH9EBD7uFI5LfEgmMOc54DsA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/dezalgo": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/dezalgo/-/dezalgo-1.0.4.tgz",
+      "integrity": "sha512-rXSP0bf+5n0Qonsb+SVVfNfIsimO4HEtmnIpPHY8Q1UCzKlQrDMfdobr8nJOOsRgWCyMRqeSBQzmWUMq7zvVig==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "asap": "^2.0.0",
+        "wrappy": "1"
+      }
+    },
+    "node_modules/dfa": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/dfa/-/dfa-1.2.0.tgz",
+      "integrity": "sha512-ED3jP8saaweFTjeGX8HQPjeC1YYyZs98jGNZx6IiBvxW7JG5v492kamAQB3m2wop07CvU/RQmzcKr6bgcC5D/Q==",
+      "license": "MIT"
+    },
+    "node_modules/diff-sequences": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/diff-sequences/-/diff-sequences-29.6.3.tgz",
+      "integrity": "sha512-EjePK1srD3P08o2j4f0ExnylqRs5B9tJjcp9t1krH2qRi8CCdsYfwe9JgSLurFBWwq4uOlipzfk5fHNvwFKr8Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      }
+    },
+    "node_modules/dotenv": {
+      "version": "16.0.3",
+      "resolved": "https://registry.npmjs.org/dotenv/-/dotenv-16.0.3.tgz",
+      "integrity": "sha512-7GO6HghkA5fYG9TYnNxi14/7K9f5occMlp3zXAuSxn7CKCxt9xbNWG7yF8hTCSUchlfWSe3uLmlPfigevRItzQ==",
+      "license": "BSD-2-Clause",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/dunder-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
+      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "gopd": "^1.2.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/ecdsa-sig-formatter": {
+      "version": "1.0.11",
+      "resolved": "https://registry.npmjs.org/ecdsa-sig-formatter/-/ecdsa-sig-formatter-1.0.11.tgz",
+      "integrity": "sha512-nagl3RYrbNv6kQkeJIpt6NJZy8twLB/2vtz6yN9Z4vRKHN4/QZJIEbqohALSgwKdnksuY3k5Addp5lg8sVoVcQ==",
+      "license": "Apache-2.0",
+      "dependencies": {
+        "safe-buffer": "^5.0.1"
+      }
+    },
+    "node_modules/ee-first": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/ee-first/-/ee-first-1.1.1.tgz",
+      "integrity": "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow==",
+      "license": "MIT"
+    },
+    "node_modules/electron-to-chromium": {
+      "version": "1.5.302",
+      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.302.tgz",
+      "integrity": "sha512-sM6HAN2LyK82IyPBpznDRqlTQAtuSaO+ShzFiWTvoMJLHyZ+Y39r8VMfHzwbU8MVBzQ4Wdn85+wlZl2TLGIlwg==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/emittery": {
+      "version": "0.13.1",
+      "resolved": "https://registry.npmjs.org/emittery/-/emittery-0.13.1.tgz",
+      "integrity": "sha512-DeWwawk6r5yR9jFgnDKYt4sLS0LmHJJi3ZOnb5/JdbYwj3nW+FxQnHIjhBKz8YLC7oRNPVM9NQ47I3CVx34eqQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=12"
+      },
+      "funding": {
+        "url": "https://github.com/sindresorhus/emittery?sponsor=1"
+      }
+    },
+    "node_modules/emoji-regex": {
+      "version": "8.0.0",
+      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
+      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/enabled": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/enabled/-/enabled-2.0.0.tgz",
+      "integrity": "sha512-AKrN98kuwOzMIdAizXGI86UFBoo26CL21UM763y1h/GMSJ4/OHU9k2YlsmBpyScFo/wbLzWQJBMCW4+IO3/+OQ==",
+      "license": "MIT"
+    },
+    "node_modules/encodeurl": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/encodeurl/-/encodeurl-2.0.0.tgz",
+      "integrity": "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/engine.io": {
+      "version": "6.6.5",
+      "resolved": "https://registry.npmjs.org/engine.io/-/engine.io-6.6.5.tgz",
+      "integrity": "sha512-2RZdgEbXmp5+dVbRm0P7HQUImZpICccJy7rN7Tv+SFa55pH+lxnuw6/K1ZxxBfHoYpSkHLAO92oa8O4SwFXA2A==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/cors": "^2.8.12",
+        "@types/node": ">=10.0.0",
+        "accepts": "~1.3.4",
+        "base64id": "2.0.0",
+        "cookie": "~0.7.2",
+        "cors": "~2.8.5",
+        "debug": "~4.4.1",
+        "engine.io-parser": "~5.2.1",
+        "ws": "~8.18.3"
+      },
+      "engines": {
+        "node": ">=10.2.0"
+      }
+    },
+    "node_modules/engine.io-parser": {
+      "version": "5.2.3",
+      "resolved": "https://registry.npmjs.org/engine.io-parser/-/engine.io-parser-5.2.3.tgz",
+      "integrity": "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/engine.io/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/engine.io/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/error-ex": {
+      "version": "1.3.4",
+      "resolved": "https://registry.npmjs.org/error-ex/-/error-ex-1.3.4.tgz",
+      "integrity": "sha512-sqQamAnR14VgCr1A618A3sGrygcpK+HEbenA/HiEAkkUwcZIIB/tgWqHFxWgOyDh4nB4JCRimh79dR5Ywc9MDQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "is-arrayish": "^0.2.1"
+      }
+    },
+    "node_modules/es-define-property": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
+      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-errors": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
       "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
       "license": "MIT",
       "engines": {
         "node": ">= 0.4"
       }
     },
-    "node_modules/es-object-atoms": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
-      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
+    "node_modules/es-get-iterator": {
+      "version": "1.1.3",
+      "resolved": "https://registry.npmjs.org/es-get-iterator/-/es-get-iterator-1.1.3.tgz",
+      "integrity": "sha512-sPZmqHBe6JIiTfN5q2pEi//TwxmAFHwj/XEuYjTuse78i8KxaqMTTzxPoFKuzRpDpTJ+0NAbpfenkmH2rePtuw==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind": "^1.0.2",
+        "get-intrinsic": "^1.1.3",
+        "has-symbols": "^1.0.3",
+        "is-arguments": "^1.1.1",
+        "is-map": "^2.0.2",
+        "is-set": "^2.0.2",
+        "is-string": "^1.0.7",
+        "isarray": "^2.0.5",
+        "stop-iteration-iterator": "^1.0.0"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/es-get-iterator/node_modules/isarray": {
+      "version": "2.0.5",
+      "resolved": "https://registry.npmjs.org/isarray/-/isarray-2.0.5.tgz",
+      "integrity": "sha512-xHjhDr3cNBK0BzdUJSPXZntQUx/mwMS5Rw4A7lPJ90XGAO6ISP/ePDNuo0vhqOZU+UD5JoodwCAAoZQd3FeAKw==",
+      "license": "MIT"
+    },
+    "node_modules/es-object-atoms": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
+      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/es-set-tostringtag": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
+      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "get-intrinsic": "^1.2.6",
+        "has-tostringtag": "^1.0.2",
+        "hasown": "^2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/escalade": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
+      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/escape-html": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
+      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
+      "license": "MIT"
+    },
+    "node_modules/escape-string-regexp": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-2.0.0.tgz",
+      "integrity": "sha512-UpzcLCXolUWcNu5HtVMHYdXJjArjsF9C0aNnquZYY4uW/Vu0miy5YoWvbV345HauVvcAUnpRuhMMcqTcGOY2+w==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/esprima": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz",
+      "integrity": "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==",
+      "dev": true,
+      "license": "BSD-2-Clause",
+      "bin": {
+        "esparse": "bin/esparse.js",
+        "esvalidate": "bin/esvalidate.js"
+      },
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/etag": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
+      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/execa": {
+      "version": "5.1.1",
+      "resolved": "https://registry.npmjs.org/execa/-/execa-5.1.1.tgz",
+      "integrity": "sha512-8uSpZZocAZRBAPIEINJj3Lo9HyGitllczc27Eh5YYojjMFMn8yHMDMaUHE2Jqfq05D/wucwI4JGURyXt1vchyg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "cross-spawn": "^7.0.3",
+        "get-stream": "^6.0.0",
+        "human-signals": "^2.1.0",
+        "is-stream": "^2.0.0",
+        "merge-stream": "^2.0.0",
+        "npm-run-path": "^4.0.1",
+        "onetime": "^5.1.2",
+        "signal-exit": "^3.0.3",
+        "strip-final-newline": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sindresorhus/execa?sponsor=1"
+      }
+    },
+    "node_modules/exit": {
+      "version": "0.1.2",
+      "resolved": "https://registry.npmjs.org/exit/-/exit-0.1.2.tgz",
+      "integrity": "sha512-Zk/eNKV2zbjpKzrsQ+n1G6poVbErQxJ0LBOJXaKZ1EViLzH+hrLu9cdXI4zw9dBQJslwBEpbQ2P1oS7nDxs6jQ==",
+      "dev": true,
+      "engines": {
+        "node": ">= 0.8.0"
+      }
+    },
+    "node_modules/expect": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/expect/-/expect-29.7.0.tgz",
+      "integrity": "sha512-2Zks0hf1VLFYI1kbh0I5jP3KHHyCHpkfyHBzsSXRFgl/Bg9mWYfMW8oD+PdMPlEwy5HNsR9JutYy6pMeOh61nw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jest/expect-utils": "^29.7.0",
+        "jest-get-type": "^29.6.3",
+        "jest-matcher-utils": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-util": "^29.7.0"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      }
+    },
+    "node_modules/express": {
+      "version": "4.22.1",
+      "resolved": "https://registry.npmjs.org/express/-/express-4.22.1.tgz",
+      "integrity": "sha512-F2X8g9P1X7uCPZMA3MVf9wcTqlyNp7IhH5qPCI0izhaOIYXaW9L535tGA3qmjRzpH+bZczqq7hVKxTR4NWnu+g==",
+      "license": "MIT",
+      "dependencies": {
+        "accepts": "~1.3.8",
+        "array-flatten": "1.1.1",
+        "body-parser": "~1.20.3",
+        "content-disposition": "~0.5.4",
+        "content-type": "~1.0.4",
+        "cookie": "~0.7.1",
+        "cookie-signature": "~1.0.6",
+        "debug": "2.6.9",
+        "depd": "2.0.0",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "etag": "~1.8.1",
+        "finalhandler": "~1.3.1",
+        "fresh": "~0.5.2",
+        "http-errors": "~2.0.0",
+        "merge-descriptors": "1.0.3",
+        "methods": "~1.1.2",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "path-to-regexp": "~0.1.12",
+        "proxy-addr": "~2.0.7",
+        "qs": "~6.14.0",
+        "range-parser": "~1.2.1",
+        "safe-buffer": "5.2.1",
+        "send": "~0.19.0",
+        "serve-static": "~1.16.2",
+        "setprototypeof": "1.2.0",
+        "statuses": "~2.0.1",
+        "type-is": "~1.6.18",
+        "utils-merge": "1.0.1",
+        "vary": "~1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.10.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/express-rate-limit": {
+      "version": "6.11.2",
+      "resolved": "https://registry.npmjs.org/express-rate-limit/-/express-rate-limit-6.11.2.tgz",
+      "integrity": "sha512-a7uwwfNTh1U60ssiIkuLFWHt4hAC5yxlLGU2VP0X4YNlyEDZAqF4tK3GD3NSitVBrCQmQ0++0uOyFOgC2y4DDw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 14"
+      },
+      "peerDependencies": {
+        "express": "^4 || ^5"
+      }
+    },
+    "node_modules/fast-json-stable-stringify": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
+      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/fast-safe-stringify": {
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/fast-safe-stringify/-/fast-safe-stringify-2.1.1.tgz",
+      "integrity": "sha512-W+KJc2dmILlPplD/H4K9l9LcAHAfPtP6BY84uVLXQ6Evcz9Lcg33Y2z1IVblT6xdY54PXYVHEv+0Wpq8Io6zkA==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/fb-watchman": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/fb-watchman/-/fb-watchman-2.0.2.tgz",
+      "integrity": "sha512-p5161BqbuCaSnB8jIbzQHOlpgsPmK5rJVDfDKO91Axs5NC1uu3HRQm6wt9cd9/+GtQQIO53JdGXXoyDpTAsgYA==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "bser": "2.1.1"
+      }
+    },
+    "node_modules/fecha": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/fecha/-/fecha-4.2.3.tgz",
+      "integrity": "sha512-OP2IUU6HeYKJi3i0z4A19kHMQoLVs4Hc+DPqqxI2h/DPZHTm/vjsfC6P0b4jCMy14XizLBqvndQ+UilD7707Jw==",
+      "license": "MIT"
+    },
+    "node_modules/fill-range": {
+      "version": "7.1.1",
+      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
+      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "to-regex-range": "^5.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/finalhandler": {
+      "version": "1.3.2",
+      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.2.tgz",
+      "integrity": "sha512-aA4RyPcd3badbdABGDuTXCMTtOneUCAYH/gxoYRTZlIJdF0YPWuGqiAsIrhNnnqdXGswYk6dGujem4w80UJFhg==",
+      "license": "MIT",
+      "dependencies": {
+        "debug": "2.6.9",
+        "encodeurl": "~2.0.0",
+        "escape-html": "~1.0.3",
+        "on-finished": "~2.4.1",
+        "parseurl": "~1.3.3",
+        "statuses": "~2.0.2",
+        "unpipe": "~1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/find-up": {
+      "version": "4.1.0",
+      "resolved": "https://registry.npmjs.org/find-up/-/find-up-4.1.0.tgz",
+      "integrity": "sha512-PpOwAdQ/YlXQ2vj8a3h8IipDuYRi3wceVQQGYWxNINccq40Anw7BlsEXCMbt1Zt+OLA6Fq9suIpIWD0OsnISlw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "locate-path": "^5.0.0",
+        "path-exists": "^4.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/fn.name": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/fn.name/-/fn.name-1.1.0.tgz",
+      "integrity": "sha512-GRnmB5gPyJpAhTQdSZTSp9uaPSvl09KoYcMQtsB9rQoOmzs9dH6ffeccH+Z+cv6P68Hu5bC6JjRh4Ah/mHSNRw==",
+      "license": "MIT"
+    },
+    "node_modules/follow-redirects": {
+      "version": "1.15.11",
+      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
+      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
+      "funding": [
+        {
+          "type": "individual",
+          "url": "https://github.com/sponsors/RubenVerborgh"
+        }
+      ],
+      "license": "MIT",
+      "engines": {
+        "node": ">=4.0"
+      },
+      "peerDependenciesMeta": {
+        "debug": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/fontkit": {
+      "version": "1.9.0",
+      "resolved": "https://registry.npmjs.org/fontkit/-/fontkit-1.9.0.tgz",
+      "integrity": "sha512-HkW/8Lrk8jl18kzQHvAw9aTHe1cqsyx5sDnxncx652+CIfhawokEPkeM3BoIC+z/Xv7a0yMr0f3pRRwhGH455g==",
+      "license": "MIT",
+      "dependencies": {
+        "@swc/helpers": "^0.3.13",
+        "brotli": "^1.3.2",
+        "clone": "^2.1.2",
+        "deep-equal": "^2.0.5",
+        "dfa": "^1.2.0",
+        "restructure": "^2.0.1",
+        "tiny-inflate": "^1.0.3",
+        "unicode-properties": "^1.3.1",
+        "unicode-trie": "^2.0.0"
+      }
+    },
+    "node_modules/for-each": {
+      "version": "0.3.5",
+      "resolved": "https://registry.npmjs.org/for-each/-/for-each-0.3.5.tgz",
+      "integrity": "sha512-dKx12eRCVIzqCxFGplyFKJMPvLEWgmNtUrpTiJIR5u97zEhRG8ySrtboPHZXx7daLxQVrl643cTzbab2tkQjxg==",
+      "license": "MIT",
+      "dependencies": {
+        "is-callable": "^1.2.7"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/form-data": {
+      "version": "4.0.5",
+      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
+      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
+      "license": "MIT",
+      "dependencies": {
+        "asynckit": "^0.4.0",
+        "combined-stream": "^1.0.8",
+        "es-set-tostringtag": "^2.1.0",
+        "hasown": "^2.0.2",
+        "mime-types": "^2.1.12"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/formidable": {
+      "version": "2.1.5",
+      "resolved": "https://registry.npmjs.org/formidable/-/formidable-2.1.5.tgz",
+      "integrity": "sha512-Oz5Hwvwak/DCaXVVUtPn4oLMLLy1CdclLKO1LFgU7XzDpVMUU5UjlSLpGMocyQNNk8F6IJW9M/YdooSn2MRI+Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@paralleldrive/cuid2": "^2.2.2",
+        "dezalgo": "^1.0.4",
+        "once": "^1.4.0",
+        "qs": "^6.11.0"
+      },
+      "funding": {
+        "url": "https://ko-fi.com/tunnckoCore/commissions"
+      }
+    },
+    "node_modules/forwarded": {
+      "version": "0.2.0",
+      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
+      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/fresh": {
+      "version": "0.5.2",
+      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
+      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.6"
+      }
+    },
+    "node_modules/fs.realpath": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/fs.realpath/-/fs.realpath-1.0.0.tgz",
+      "integrity": "sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/fsevents": {
+      "version": "2.3.3",
+      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
+      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
+      "dev": true,
+      "hasInstallScript": true,
+      "license": "MIT",
+      "optional": true,
+      "os": [
+        "darwin"
+      ],
+      "engines": {
+        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
+      }
+    },
+    "node_modules/function-bind": {
+      "version": "1.1.2",
+      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
+      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/functions-have-names": {
+      "version": "1.2.3",
+      "resolved": "https://registry.npmjs.org/functions-have-names/-/functions-have-names-1.2.3.tgz",
+      "integrity": "sha512-xckBUXyTIqT97tq2x2AMb+g163b5JFysYk0x4qxNFwbfQkmNZoiRHb6sPzI9/QV33WeuvVYBUIiD4NzNIyqaRQ==",
+      "license": "MIT",
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/gensync": {
+      "version": "1.0.0-beta.2",
+      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
+      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.9.0"
+      }
+    },
+    "node_modules/get-caller-file": {
+      "version": "2.0.5",
+      "resolved": "https://registry.npmjs.org/get-caller-file/-/get-caller-file-2.0.5.tgz",
+      "integrity": "sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==",
+      "dev": true,
+      "license": "ISC",
+      "engines": {
+        "node": "6.* || 8.* || >= 10.*"
+      }
+    },
+    "node_modules/get-intrinsic": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
+      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind-apply-helpers": "^1.0.2",
+        "es-define-property": "^1.0.1",
+        "es-errors": "^1.3.0",
+        "es-object-atoms": "^1.1.1",
+        "function-bind": "^1.1.2",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "has-symbols": "^1.1.0",
+        "hasown": "^2.0.2",
+        "math-intrinsics": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/get-package-type": {
+      "version": "0.1.0",
+      "resolved": "https://registry.npmjs.org/get-package-type/-/get-package-type-0.1.0.tgz",
+      "integrity": "sha512-pjzuKtY64GYfWizNAJ0fr9VqttZkNiK2iS430LtIHzjBEr6bX8Am2zm4sW4Ro5wjWW5cAlRL1qAMTcXbjNAO2Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8.0.0"
+      }
+    },
+    "node_modules/get-proto": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
+      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
+      "license": "MIT",
+      "dependencies": {
+        "dunder-proto": "^1.0.1",
+        "es-object-atoms": "^1.0.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/get-stream": {
+      "version": "6.0.1",
+      "resolved": "https://registry.npmjs.org/get-stream/-/get-stream-6.0.1.tgz",
+      "integrity": "sha512-ts6Wi+2j3jQjqi70w5AlN8DFnkSwC+MqmxEzdEALB2qXZYV3X/b1CTfgPLGJNMeAWxdPfU8FO1ms3NUfaHCPYg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/glob": {
+      "version": "7.2.3",
+      "resolved": "https://registry.npmjs.org/glob/-/glob-7.2.3.tgz",
+      "integrity": "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==",
+      "deprecated": "Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "fs.realpath": "^1.0.0",
+        "inflight": "^1.0.4",
+        "inherits": "2",
+        "minimatch": "^3.1.1",
+        "once": "^1.3.0",
+        "path-is-absolute": "^1.0.0"
+      },
+      "engines": {
+        "node": "*"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/isaacs"
+      }
+    },
+    "node_modules/glob-parent": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
+      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "is-glob": "^4.0.1"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/glob/node_modules/balanced-match": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
+      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/glob/node_modules/brace-expansion": {
+      "version": "1.1.12",
+      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
+      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "balanced-match": "^1.0.0",
+        "concat-map": "0.0.1"
+      }
+    },
+    "node_modules/glob/node_modules/minimatch": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.3.tgz",
+      "integrity": "sha512-M2GCs7Vk83NxkUyQV1bkABc4yxgz9kILhHImZiBPAZ9ybuvCb0/H7lEl5XvIg3g+9d4eNotkZA5IWwYl0tibaA==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "brace-expansion": "^1.1.7"
+      },
+      "engines": {
+        "node": "*"
+      }
+    },
+    "node_modules/gopd": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
+      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/graceful-fs": {
+      "version": "4.2.11",
+      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
+      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/has-bigints": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/has-bigints/-/has-bigints-1.1.0.tgz",
+      "integrity": "sha512-R3pbpkcIqv2Pm3dUwgjclDRVmWpTJW2DcMzcIhEXEx1oh/CEMObMm3KLmRJOdvhM7o4uQBnwr8pzRK2sJWIqfg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-flag": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-3.0.0.tgz",
+      "integrity": "sha512-sKJf1+ceQBr4SMkvQnBDNDtf4TXpVhVGateu0t918bl30FnbE2m4vNLX+VWe/dpjlb+HugGYzW7uQXH98HPEYw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/has-property-descriptors": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/has-property-descriptors/-/has-property-descriptors-1.0.2.tgz",
+      "integrity": "sha512-55JNKuIW+vq4Ke1BjOTjM2YctQIvCT7GFzHwmfZPGo5wnrgkid0YQtnAleFSqumZm4az3n2BS+erby5ipJdgrg==",
+      "license": "MIT",
+      "dependencies": {
+        "es-define-property": "^1.0.0"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-symbols": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
+      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/has-tostringtag": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
+      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
+      "license": "MIT",
+      "dependencies": {
+        "has-symbols": "^1.0.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/hasown": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
+      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
+      "license": "MIT",
+      "dependencies": {
+        "function-bind": "^1.1.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/helmet": {
+      "version": "7.2.0",
+      "resolved": "https://registry.npmjs.org/helmet/-/helmet-7.2.0.tgz",
+      "integrity": "sha512-ZRiwvN089JfMXokizgqEPXsl2Guk094yExfoDXR0cBYWxtBbaSww/w+vT4WEJsBW2iTUi1GgZ6swmoug3Oy4Xw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=16.0.0"
+      }
+    },
+    "node_modules/html-escaper": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz",
+      "integrity": "sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/http_ece": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/http_ece/-/http_ece-1.2.0.tgz",
+      "integrity": "sha512-JrF8SSLVmcvc5NducxgyOrKXe3EsyHMgBFgSaIUGmArKe+rwr0uphRkRXvwiom3I+fpIfoItveHrfudL8/rxuA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=16"
+      }
+    },
+    "node_modules/http-errors": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.1.tgz",
+      "integrity": "sha512-4FbRdAX+bSdmo4AUFuS0WNiPz8NgFt+r8ThgNWmlrjQjt1Q7ZR9+zTlce2859x4KSXrwIsaeTqDoKQmtP8pLmQ==",
+      "license": "MIT",
+      "dependencies": {
+        "depd": "~2.0.0",
+        "inherits": "~2.0.4",
+        "setprototypeof": "~1.2.0",
+        "statuses": "~2.0.2",
+        "toidentifier": "~1.0.1"
+      },
+      "engines": {
+        "node": ">= 0.8"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/express"
+      }
+    },
+    "node_modules/https-proxy-agent": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
+      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
+      "license": "MIT",
+      "dependencies": {
+        "agent-base": "6",
+        "debug": "4"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/https-proxy-agent/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/https-proxy-agent/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/human-signals": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/human-signals/-/human-signals-2.1.0.tgz",
+      "integrity": "sha512-B4FFZ6q/T2jhhksgkbEW3HBvWIfDW85snkQgawt07S7J5QXTk6BkNV+0yAeZrM5QpMAdYlocGoljn0sJ/WQkFw==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "engines": {
+        "node": ">=10.17.0"
+      }
+    },
+    "node_modules/iconv-lite": {
+      "version": "0.4.24",
+      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
+      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
+      "license": "MIT",
+      "dependencies": {
+        "safer-buffer": ">= 2.1.2 < 3"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/ignore-by-default": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/ignore-by-default/-/ignore-by-default-1.0.1.tgz",
+      "integrity": "sha512-Ius2VYcGNk7T90CppJqcIkS5ooHUZyIQK+ClZfMfMNFEF9VSE73Fq+906u/CWu92x4gzZMWOwfFYckPObzdEbA==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/import-local": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/import-local/-/import-local-3.2.0.tgz",
+      "integrity": "sha512-2SPlun1JUPWoM6t3F0dw0FkCF/jWY8kttcY4f599GLTSjh2OCuuhdTkJQsEcZzBqbXZGKMK2OqW1oZsjtf/gQA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "pkg-dir": "^4.2.0",
+        "resolve-cwd": "^3.0.0"
+      },
+      "bin": {
+        "import-local-fixture": "fixtures/cli.js"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/imurmurhash": {
+      "version": "0.1.4",
+      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
+      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.8.19"
+      }
+    },
+    "node_modules/inflight": {
+      "version": "1.0.6",
+      "resolved": "https://registry.npmjs.org/inflight/-/inflight-1.0.6.tgz",
+      "integrity": "sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==",
+      "deprecated": "This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "once": "^1.3.0",
+        "wrappy": "1"
+      }
+    },
+    "node_modules/inherits": {
+      "version": "2.0.4",
+      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
+      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
+      "license": "ISC"
+    },
+    "node_modules/internal-slot": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/internal-slot/-/internal-slot-1.1.0.tgz",
+      "integrity": "sha512-4gd7VpWNQNB4UKKCFFVcp1AVv+FMOgs9NKzjHKusc8jTMhd5eL1NqQqOpE0KzMds804/yHlglp3uxgluOqAPLw==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "hasown": "^2.0.2",
+        "side-channel": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/ipaddr.js": {
+      "version": "1.9.1",
+      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
+      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.10"
+      }
+    },
+    "node_modules/is-arguments": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/is-arguments/-/is-arguments-1.2.0.tgz",
+      "integrity": "sha512-7bVbi0huj/wrIAOzb8U1aszg9kdi3KN/CyU19CTI7tAoZYEZoL9yCDXpbXN+uPsuWnP02cyug1gleqq+TU+YCA==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-array-buffer": {
+      "version": "3.0.5",
+      "resolved": "https://registry.npmjs.org/is-array-buffer/-/is-array-buffer-3.0.5.tgz",
+      "integrity": "sha512-DDfANUiiG2wC1qawP66qlTugJeL5HyzMpfr8lLK+jMQirGzNod0B12cFB/9q838Ru27sBwfw78/rdoU7RERz6A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind": "^1.0.8",
+        "call-bound": "^1.0.3",
+        "get-intrinsic": "^1.2.6"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-arrayish": {
+      "version": "0.2.1",
+      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.2.1.tgz",
+      "integrity": "sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/is-bigint": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/is-bigint/-/is-bigint-1.1.0.tgz",
+      "integrity": "sha512-n4ZT37wG78iz03xPRKJrHTdZbe3IicyucEtdRsV5yglwc3GyUfbAfpSeD0FJ41NbUNSt5wbhqfp1fS+BgnvDFQ==",
+      "license": "MIT",
+      "dependencies": {
+        "has-bigints": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-binary-path": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
+      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "binary-extensions": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/is-boolean-object": {
+      "version": "1.2.2",
+      "resolved": "https://registry.npmjs.org/is-boolean-object/-/is-boolean-object-1.2.2.tgz",
+      "integrity": "sha512-wa56o2/ElJMYqjCjGkXri7it5FbebW5usLw/nPmCMs5DeZ7eziSYZhSmPRn0txqeW4LnAmQQU7FgqLpsEFKM4A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-callable": {
+      "version": "1.2.7",
+      "resolved": "https://registry.npmjs.org/is-callable/-/is-callable-1.2.7.tgz",
+      "integrity": "sha512-1BC0BVFhS/p0qtw6enp8e+8OD0UrK0oFLztSjNzhcKA3WDuJxxAPXzPuPtKkjEY9UUoEWlX/8fgKeu2S8i9JTA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-core-module": {
+      "version": "2.16.1",
+      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz",
+      "integrity": "sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "es-errors": "^1.3.0"
+        "hasown": "^2.0.2"
       },
       "engines": {
         "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
       }
     },
-    "node_modules/es-set-tostringtag": {
+    "node_modules/is-date-object": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/is-date-object/-/is-date-object-1.1.0.tgz",
+      "integrity": "sha512-PwwhEakHVKTdRNVOw+/Gyh0+MzlCl4R6qKvkhuvLtPMggI1WAHt9sOwZxQLSGpUaDnrdyDsomoRgNnCfKNSXXg==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-extglob": {
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
+      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/is-fullwidth-code-point": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
+      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/is-generator-fn": {
       "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
-      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
+      "resolved": "https://registry.npmjs.org/is-generator-fn/-/is-generator-fn-2.1.0.tgz",
+      "integrity": "sha512-cTIB4yPYL/Grw0EaSzASzg6bBy9gqCofvWN8okThAYIxKJZC+udlRAmGbM0XLeniEJSs8uEgHPGuHSe1XsOLSQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/is-glob": {
+      "version": "4.0.3",
+      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
+      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "es-errors": "^1.3.0",
-        "get-intrinsic": "^1.2.6",
+        "is-extglob": "^2.1.1"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/is-map": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/is-map/-/is-map-2.0.3.tgz",
+      "integrity": "sha512-1Qed0/Hr2m+YqxnM09CjA2d/i6YZNfF6R2oRAOj36eUdS6qIV/huPJNSEpKbupewFs+ZsJlxsjjPbc0/afW6Lw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-number": {
+      "version": "7.0.0",
+      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
+      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.12.0"
+      }
+    },
+    "node_modules/is-number-object": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/is-number-object/-/is-number-object-1.1.1.tgz",
+      "integrity": "sha512-lZhclumE1G6VYD8VHe35wFaIif+CTy5SJIi5+3y4psDgWu4wPDoBhF8NxUOinEc7pHgiTsT6MaBb92rKhhD+Xw==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-regex": {
+      "version": "1.2.1",
+      "resolved": "https://registry.npmjs.org/is-regex/-/is-regex-1.2.1.tgz",
+      "integrity": "sha512-MjYsKHO5O7mCsmRGxWcLWheFqN9DJ/2TmngvjKXihe6efViPqc274+Fx/4fYj/r03+ESvBdTXK0V6tA3rgez1g==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "gopd": "^1.2.0",
         "has-tostringtag": "^1.0.2",
         "hasown": "^2.0.2"
       },
       "engines": {
         "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-set": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/is-set/-/is-set-2.0.3.tgz",
+      "integrity": "sha512-iPAjerrse27/ygGLxw+EBR9agv9Y6uLeYVJMu+QNCoouJ1/1ri0mGrcWpfCqFZuzzx3WjtwxG098X+n4OuRkPg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-shared-array-buffer": {
+      "version": "1.0.4",
+      "resolved": "https://registry.npmjs.org/is-shared-array-buffer/-/is-shared-array-buffer-1.0.4.tgz",
+      "integrity": "sha512-ISWac8drv4ZGfwKl5slpHG9OwPNty4jOWPRIhBpxOoD+hqITiwuipOQ2bNthAzwA3B4fIjO4Nln74N0S9byq8A==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-stream": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
+      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/is-string": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/is-string/-/is-string-1.1.1.tgz",
+      "integrity": "sha512-BtEeSsoaQjlSPBemMQIrY1MY0uM6vnS1g5fmufYOtnxLGUZM2178PKbhsk7Ffv58IX+ZtcvoGwccYsh0PglkAA==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-symbol": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/is-symbol/-/is-symbol-1.1.1.tgz",
+      "integrity": "sha512-9gGx6GTtCQM73BgmHQXfDmLtfjjTUDSyoxTCbp5WtoixAhfgsDirWIcVQ/IHpvI5Vgd5i/J5F7B9cN/WlVbC/w==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "has-symbols": "^1.1.0",
+        "safe-regex-test": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-weakmap": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/is-weakmap/-/is-weakmap-2.0.2.tgz",
+      "integrity": "sha512-K5pXYOm9wqY1RgjpL3YTkF39tni1XajUIkawTLUo9EZEVUFga5gSQJF8nNS7ZwJQ02y+1YCNYcMh+HIf1ZqE+w==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/is-weakset": {
+      "version": "2.0.4",
+      "resolved": "https://registry.npmjs.org/is-weakset/-/is-weakset-2.0.4.tgz",
+      "integrity": "sha512-mfcwb6IzQyOKTs84CQMrOwW4gQcaTOAWJ0zzJCl2WSPDrWk/OzDaImWFH3djXhb24g4eudZfLRozAvPGw4d9hQ==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.3",
+        "get-intrinsic": "^1.2.6"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/isarray": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/isarray/-/isarray-1.0.0.tgz",
+      "integrity": "sha512-VLghIWNM6ELQzo7zwmcg0NmTVyWKYjvIeM83yjp0wRDTmUnrM678fQbcKBo6n2CJEF0szoG//ytg+TKla89ALQ==",
+      "license": "MIT"
+    },
+    "node_modules/isexe": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
+      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/istanbul-lib-coverage": {
+      "version": "3.2.2",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-coverage/-/istanbul-lib-coverage-3.2.2.tgz",
+      "integrity": "sha512-O8dpsF+r0WV/8MNRKfnmrtCWhuKjxrq2w+jpzBL5UZKTi2LeVWnWOmWRxFlesJONmc+wLAGvKQZEOanko0LFTg==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/istanbul-lib-instrument": {
+      "version": "6.0.3",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-instrument/-/istanbul-lib-instrument-6.0.3.tgz",
+      "integrity": "sha512-Vtgk7L/R2JHyyGW07spoFlB8/lpjiOLTjMdms6AFMraYt3BaJauod/NGrfnVG/y4Ix1JEuMRPDPEj2ua+zz1/Q==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "@babel/core": "^7.23.9",
+        "@babel/parser": "^7.23.9",
+        "@istanbuljs/schema": "^0.1.3",
+        "istanbul-lib-coverage": "^3.2.0",
+        "semver": "^7.5.4"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/istanbul-lib-report": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-report/-/istanbul-lib-report-3.0.1.tgz",
+      "integrity": "sha512-GCfE1mtsHGOELCU8e/Z7YWzpmybrx/+dSTfLrvY8qRmaY6zXTKWn6WQIjaAFw069icm6GVMNkgu0NzI4iPZUNw==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "istanbul-lib-coverage": "^3.0.0",
+        "make-dir": "^4.0.0",
+        "supports-color": "^7.1.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/istanbul-lib-report/node_modules/has-flag": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
+      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/istanbul-lib-report/node_modules/supports-color": {
+      "version": "7.2.0",
+      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
+      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "has-flag": "^4.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/istanbul-lib-source-maps": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/istanbul-lib-source-maps/-/istanbul-lib-source-maps-4.0.1.tgz",
+      "integrity": "sha512-n3s8EwkdFIJCG3BPKBYvskgXGoy88ARzvegkitk60NxRdwltLOTaH7CUiMRXvwYorl0Q712iEjcWB+fK/MrWVw==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "debug": "^4.1.1",
+        "istanbul-lib-coverage": "^3.0.0",
+        "source-map": "^0.6.1"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/istanbul-lib-source-maps/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
       }
     },
-    "node_modules/escape-html": {
-      "version": "1.0.3",
-      "resolved": "https://registry.npmjs.org/escape-html/-/escape-html-1.0.3.tgz",
-      "integrity": "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow==",
+    "node_modules/istanbul-lib-source-maps/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "dev": true,
       "license": "MIT"
     },
-    "node_modules/etag": {
-      "version": "1.8.1",
-      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
-      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
-      "license": "MIT",
+    "node_modules/istanbul-reports": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/istanbul-reports/-/istanbul-reports-3.2.0.tgz",
+      "integrity": "sha512-HGYWWS/ehqTV3xN10i23tkPkpH46MLCIMFNCaaKNavAXTF1RkqxawEPtnjnGZ6XKSInBKkiOA5BKS+aZiY3AvA==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "html-escaper": "^2.0.0",
+        "istanbul-lib-report": "^3.0.0"
+      },
       "engines": {
-        "node": ">= 0.6"
+        "node": ">=8"
       }
     },
-    "node_modules/express": {
-      "version": "4.22.1",
-      "resolved": "https://registry.npmjs.org/express/-/express-4.22.1.tgz",
-      "integrity": "sha512-F2X8g9P1X7uCPZMA3MVf9wcTqlyNp7IhH5qPCI0izhaOIYXaW9L535tGA3qmjRzpH+bZczqq7hVKxTR4NWnu+g==",
+    "node_modules/jest": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest/-/jest-29.7.0.tgz",
+      "integrity": "sha512-NIy3oAFp9shda19hy4HK0HRTWKtPJmGdnvywu01nOqNC2vZg+Z+fvJDxpMQA88eb2I9EcafcdjYgsDthnYTvGw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "accepts": "~1.3.8",
-        "array-flatten": "1.1.1",
-        "body-parser": "~1.20.3",
-        "content-disposition": "~0.5.4",
-        "content-type": "~1.0.4",
-        "cookie": "~0.7.1",
-        "cookie-signature": "~1.0.6",
-        "debug": "2.6.9",
-        "depd": "2.0.0",
-        "encodeurl": "~2.0.0",
-        "escape-html": "~1.0.3",
-        "etag": "~1.8.1",
-        "finalhandler": "~1.3.1",
-        "fresh": "~0.5.2",
-        "http-errors": "~2.0.0",
-        "merge-descriptors": "1.0.3",
-        "methods": "~1.1.2",
-        "on-finished": "~2.4.1",
-        "parseurl": "~1.3.3",
-        "path-to-regexp": "~0.1.12",
-        "proxy-addr": "~2.0.7",
-        "qs": "~6.14.0",
-        "range-parser": "~1.2.1",
-        "safe-buffer": "5.2.1",
-        "send": "~0.19.0",
-        "serve-static": "~1.16.2",
-        "setprototypeof": "1.2.0",
-        "statuses": "~2.0.1",
-        "type-is": "~1.6.18",
-        "utils-merge": "1.0.1",
-        "vary": "~1.1.2"
+        "@jest/core": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "import-local": "^3.0.2",
+        "jest-cli": "^29.7.0"
+      },
+      "bin": {
+        "jest": "bin/jest.js"
       },
       "engines": {
-        "node": ">= 0.10.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       },
-      "funding": {
-        "type": "opencollective",
-        "url": "https://opencollective.com/express"
+      "peerDependencies": {
+        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
+      },
+      "peerDependenciesMeta": {
+        "node-notifier": {
+          "optional": true
+        }
       }
     },
-    "node_modules/express-rate-limit": {
-      "version": "7.5.1",
-      "resolved": "https://registry.npmjs.org/express-rate-limit/-/express-rate-limit-7.5.1.tgz",
-      "integrity": "sha512-7iN8iPMDzOMHPUYllBEsQdWVB6fPDMPqwjBaFrgr4Jgr/+okjvzAy+UHlYYL/Vs0OsOrMkwS6PJDkFlJwoxUnw==",
+    "node_modules/jest-changed-files": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-changed-files/-/jest-changed-files-29.7.0.tgz",
+      "integrity": "sha512-fEArFiwf1BpQ+4bXSprcDc3/x4HSzL4al2tozwVpDFpsxALjLYdyiIK4e5Vz66GQJIbXJ82+35PtysofptNX2w==",
+      "dev": true,
       "license": "MIT",
-      "engines": {
-        "node": ">= 16"
-      },
-      "funding": {
-        "url": "https://github.com/sponsors/express-rate-limit"
+      "dependencies": {
+        "execa": "^5.0.0",
+        "jest-util": "^29.7.0",
+        "p-limit": "^3.1.0"
       },
-      "peerDependencies": {
-        "express": ">= 4.11"
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/fecha": {
-      "version": "4.2.3",
-      "resolved": "https://registry.npmjs.org/fecha/-/fecha-4.2.3.tgz",
-      "integrity": "sha512-OP2IUU6HeYKJi3i0z4A19kHMQoLVs4Hc+DPqqxI2h/DPZHTm/vjsfC6P0b4jCMy14XizLBqvndQ+UilD7707Jw==",
-      "license": "MIT"
-    },
-    "node_modules/fill-range": {
-      "version": "7.1.1",
-      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
-      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
+    "node_modules/jest-circus": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-circus/-/jest-circus-29.7.0.tgz",
+      "integrity": "sha512-3E1nCMgipcTkCocFwM90XXQab9bS+GMsjdpmPrlelaxwD93Ad8iVEjX/vvHPdLPnFf+L40u+5+iutRdA1N9myw==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "to-regex-range": "^5.0.1"
+        "@jest/environment": "^29.7.0",
+        "@jest/expect": "^29.7.0",
+        "@jest/test-result": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "co": "^4.6.0",
+        "dedent": "^1.0.0",
+        "is-generator-fn": "^2.0.0",
+        "jest-each": "^29.7.0",
+        "jest-matcher-utils": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-runtime": "^29.7.0",
+        "jest-snapshot": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "p-limit": "^3.1.0",
+        "pretty-format": "^29.7.0",
+        "pure-rand": "^6.0.0",
+        "slash": "^3.0.0",
+        "stack-utils": "^2.0.3"
       },
       "engines": {
-        "node": ">=8"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/finalhandler": {
-      "version": "1.3.2",
-      "resolved": "https://registry.npmjs.org/finalhandler/-/finalhandler-1.3.2.tgz",
-      "integrity": "sha512-aA4RyPcd3badbdABGDuTXCMTtOneUCAYH/gxoYRTZlIJdF0YPWuGqiAsIrhNnnqdXGswYk6dGujem4w80UJFhg==",
+    "node_modules/jest-cli": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-cli/-/jest-cli-29.7.0.tgz",
+      "integrity": "sha512-OVVobw2IubN/GSYsxETi+gOe7Ka59EFMR/twOU3Jb2GnKKeMGJB5SGUUrEz3SFVmJASUdZUzy83sLNNQ2gZslg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "debug": "2.6.9",
-        "encodeurl": "~2.0.0",
-        "escape-html": "~1.0.3",
-        "on-finished": "~2.4.1",
-        "parseurl": "~1.3.3",
-        "statuses": "~2.0.2",
-        "unpipe": "~1.0.0"
+        "@jest/core": "^29.7.0",
+        "@jest/test-result": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "chalk": "^4.0.0",
+        "create-jest": "^29.7.0",
+        "exit": "^0.1.2",
+        "import-local": "^3.0.2",
+        "jest-config": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "jest-validate": "^29.7.0",
+        "yargs": "^17.3.1"
+      },
+      "bin": {
+        "jest": "bin/jest.js"
       },
       "engines": {
-        "node": ">= 0.8"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "node-notifier": "^8.0.1 || ^9.0.0 || ^10.0.0"
+      },
+      "peerDependenciesMeta": {
+        "node-notifier": {
+          "optional": true
+        }
       }
     },
-    "node_modules/fn.name": {
-      "version": "1.1.0",
-      "resolved": "https://registry.npmjs.org/fn.name/-/fn.name-1.1.0.tgz",
-      "integrity": "sha512-GRnmB5gPyJpAhTQdSZTSp9uaPSvl09KoYcMQtsB9rQoOmzs9dH6ffeccH+Z+cv6P68Hu5bC6JjRh4Ah/mHSNRw==",
-      "license": "MIT"
-    },
-    "node_modules/follow-redirects": {
-      "version": "1.15.11",
-      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
-      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
-      "funding": [
-        {
-          "type": "individual",
-          "url": "https://github.com/sponsors/RubenVerborgh"
-        }
-      ],
+    "node_modules/jest-config": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-config/-/jest-config-29.7.0.tgz",
+      "integrity": "sha512-uXbpfeQ7R6TZBqI3/TxCU4q4ttk3u0PJeC+E0zbfSoSjq6bJ7buBPxzQPL0ifrkY4DNu4JUdk0ImlBUYi840eQ==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@babel/core": "^7.11.6",
+        "@jest/test-sequencer": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "babel-jest": "^29.7.0",
+        "chalk": "^4.0.0",
+        "ci-info": "^3.2.0",
+        "deepmerge": "^4.2.2",
+        "glob": "^7.1.3",
+        "graceful-fs": "^4.2.9",
+        "jest-circus": "^29.7.0",
+        "jest-environment-node": "^29.7.0",
+        "jest-get-type": "^29.6.3",
+        "jest-regex-util": "^29.6.3",
+        "jest-resolve": "^29.7.0",
+        "jest-runner": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "jest-validate": "^29.7.0",
+        "micromatch": "^4.0.4",
+        "parse-json": "^5.2.0",
+        "pretty-format": "^29.7.0",
+        "slash": "^3.0.0",
+        "strip-json-comments": "^3.1.1"
+      },
       "engines": {
-        "node": ">=4.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      },
+      "peerDependencies": {
+        "@types/node": "*",
+        "ts-node": ">=9.0.0"
       },
       "peerDependenciesMeta": {
-        "debug": {
+        "@types/node": {
+          "optional": true
+        },
+        "ts-node": {
           "optional": true
         }
       }
     },
-    "node_modules/form-data": {
-      "version": "4.0.5",
-      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
-      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
+    "node_modules/jest-diff": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-diff/-/jest-diff-29.7.0.tgz",
+      "integrity": "sha512-LMIgiIrhigmPrs03JHpxUh2yISK3vLFPkAodPeo0+BuF7wA2FoQbkEg1u8gBYBThncu7e1oEDUfIXVuTqLRUjw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "asynckit": "^0.4.0",
-        "combined-stream": "^1.0.8",
-        "es-set-tostringtag": "^2.1.0",
-        "hasown": "^2.0.2",
-        "mime-types": "^2.1.12"
+        "chalk": "^4.0.0",
+        "diff-sequences": "^29.6.3",
+        "jest-get-type": "^29.6.3",
+        "pretty-format": "^29.7.0"
       },
       "engines": {
-        "node": ">= 6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/forwarded": {
-      "version": "0.2.0",
-      "resolved": "https://registry.npmjs.org/forwarded/-/forwarded-0.2.0.tgz",
-      "integrity": "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow==",
+    "node_modules/jest-docblock": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-docblock/-/jest-docblock-29.7.0.tgz",
+      "integrity": "sha512-q617Auw3A612guyaFgsbFeYpNP5t2aoUNLwBUbc/0kD1R4t9ixDbyFTHd1nok4epoVFpr7PmeWHrhvuV3XaJ4g==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "detect-newline": "^3.0.0"
+      },
       "engines": {
-        "node": ">= 0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/fresh": {
-      "version": "0.5.2",
-      "resolved": "https://registry.npmjs.org/fresh/-/fresh-0.5.2.tgz",
-      "integrity": "sha512-zJ2mQYM18rEFOudeV4GShTGIQ7RbzA7ozbU9I/XBpm7kqgMywgmylMwXHxZJmkVoYkna9d2pVXVXPdYTP9ej8Q==",
+    "node_modules/jest-each": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-each/-/jest-each-29.7.0.tgz",
+      "integrity": "sha512-gns+Er14+ZrEoC5fhOfYCY1LOHHr0TI+rQUHZS8Ttw2l7gl+80eHc/gFf2Ktkw0+SIACDTeWvpFcv3B04VembQ==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/types": "^29.6.3",
+        "chalk": "^4.0.0",
+        "jest-get-type": "^29.6.3",
+        "jest-util": "^29.7.0",
+        "pretty-format": "^29.7.0"
+      },
       "engines": {
-        "node": ">= 0.6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/fsevents": {
-      "version": "2.3.3",
-      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
-      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
+    "node_modules/jest-environment-node": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-environment-node/-/jest-environment-node-29.7.0.tgz",
+      "integrity": "sha512-DOSwCRqXirTOyheM+4d5YZOrWcdu0LNZ87ewUoywbcb2XR4wKgqiG8vNeYwhjFMbEkfju7wx2GYH0P2gevGvFw==",
       "dev": true,
-      "hasInstallScript": true,
       "license": "MIT",
-      "optional": true,
-      "os": [
-        "darwin"
-      ],
+      "dependencies": {
+        "@jest/environment": "^29.7.0",
+        "@jest/fake-timers": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "jest-mock": "^29.7.0",
+        "jest-util": "^29.7.0"
+      },
       "engines": {
-        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/function-bind": {
-      "version": "1.1.2",
-      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
-      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
+    "node_modules/jest-get-type": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/jest-get-type/-/jest-get-type-29.6.3.tgz",
+      "integrity": "sha512-zrteXnqYxfQh7l5FHyL38jL39di8H8rHoecLH3JNxH3BwOrBsNeabdap5e0I23lD4HHI8W5VFBZqG4Eaq5LNcw==",
+      "dev": true,
       "license": "MIT",
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/get-intrinsic": {
-      "version": "1.3.0",
-      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
-      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
+    "node_modules/jest-haste-map": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-haste-map/-/jest-haste-map-29.7.0.tgz",
+      "integrity": "sha512-fP8u2pyfqx0K1rGn1R9pyE0/KTn+G7PxktWidOBTqFPLYX0b9ksaMFkhK5vrS3DVun09pckLdlx90QthlW7AmA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "call-bind-apply-helpers": "^1.0.2",
-        "es-define-property": "^1.0.1",
-        "es-errors": "^1.3.0",
-        "es-object-atoms": "^1.1.1",
-        "function-bind": "^1.1.2",
-        "get-proto": "^1.0.1",
-        "gopd": "^1.2.0",
-        "has-symbols": "^1.1.0",
-        "hasown": "^2.0.2",
-        "math-intrinsics": "^1.1.0"
+        "@jest/types": "^29.6.3",
+        "@types/graceful-fs": "^4.1.3",
+        "@types/node": "*",
+        "anymatch": "^3.0.3",
+        "fb-watchman": "^2.0.0",
+        "graceful-fs": "^4.2.9",
+        "jest-regex-util": "^29.6.3",
+        "jest-util": "^29.7.0",
+        "jest-worker": "^29.7.0",
+        "micromatch": "^4.0.4",
+        "walker": "^1.0.8"
       },
       "engines": {
-        "node": ">= 0.4"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       },
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+      "optionalDependencies": {
+        "fsevents": "^2.3.2"
       }
     },
-    "node_modules/get-proto": {
-      "version": "1.0.1",
-      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
-      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
+    "node_modules/jest-leak-detector": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-leak-detector/-/jest-leak-detector-29.7.0.tgz",
+      "integrity": "sha512-kYA8IJcSYtST2BY9I+SMC32nDpBT3J2NvWJx8+JCuCdl/CR1I4EKUJROiP8XtCcxqgTTBGJNdbB1A8XRKbTetw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "dunder-proto": "^1.0.1",
-        "es-object-atoms": "^1.0.0"
+        "jest-get-type": "^29.6.3",
+        "pretty-format": "^29.7.0"
       },
       "engines": {
-        "node": ">= 0.4"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/glob-parent": {
-      "version": "5.1.2",
-      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
-      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
+    "node_modules/jest-matcher-utils": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-matcher-utils/-/jest-matcher-utils-29.7.0.tgz",
+      "integrity": "sha512-sBkD+Xi9DtcChsI3L3u0+N0opgPYnCRPtGcQYrgXmR+hmt/fYfWAL0xRXYU8eWOdfuLgBe0YCW3AFtnRLagq/g==",
       "dev": true,
-      "license": "ISC",
+      "license": "MIT",
       "dependencies": {
-        "is-glob": "^4.0.1"
+        "chalk": "^4.0.0",
+        "jest-diff": "^29.7.0",
+        "jest-get-type": "^29.6.3",
+        "pretty-format": "^29.7.0"
       },
       "engines": {
-        "node": ">= 6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/gopd": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
-      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
+    "node_modules/jest-message-util": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-message-util/-/jest-message-util-29.7.0.tgz",
+      "integrity": "sha512-GBEV4GRADeP+qtB2+6u61stea8mGcOT4mCtrYISZwfu9/ISHFJ/5zOMXYbpBE9RsS5+Gb63DW4FgmnKJ79Kf6w==",
+      "dev": true,
       "license": "MIT",
-      "engines": {
-        "node": ">= 0.4"
+      "dependencies": {
+        "@babel/code-frame": "^7.12.13",
+        "@jest/types": "^29.6.3",
+        "@types/stack-utils": "^2.0.0",
+        "chalk": "^4.0.0",
+        "graceful-fs": "^4.2.9",
+        "micromatch": "^4.0.4",
+        "pretty-format": "^29.7.0",
+        "slash": "^3.0.0",
+        "stack-utils": "^2.0.3"
       },
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/has-flag": {
-      "version": "3.0.0",
-      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-3.0.0.tgz",
-      "integrity": "sha512-sKJf1+ceQBr4SMkvQnBDNDtf4TXpVhVGateu0t918bl30FnbE2m4vNLX+VWe/dpjlb+HugGYzW7uQXH98HPEYw==",
+    "node_modules/jest-mock": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-mock/-/jest-mock-29.7.0.tgz",
+      "integrity": "sha512-ITOMZn+UkYS4ZFh83xYAOzWStloNzJFO2s8DWrE4lhtGD+AorgnbkiKERe4wQVBydIGPx059g6riW5Btp6Llnw==",
       "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "jest-util": "^29.7.0"
+      },
       "engines": {
-        "node": ">=4"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/has-symbols": {
-      "version": "1.1.0",
-      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
-      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
+    "node_modules/jest-pnp-resolver": {
+      "version": "1.2.3",
+      "resolved": "https://registry.npmjs.org/jest-pnp-resolver/-/jest-pnp-resolver-1.2.3.tgz",
+      "integrity": "sha512-+3NpwQEnRoIBtx4fyhblQDPgJI0H1IEIkX7ShLUjPGA7TtUTvI1oiKi3SR4oBR0hQhQR80l4WAe5RrXBwWMA8w==",
+      "dev": true,
       "license": "MIT",
       "engines": {
-        "node": ">= 0.4"
+        "node": ">=6"
       },
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+      "peerDependencies": {
+        "jest-resolve": "*"
+      },
+      "peerDependenciesMeta": {
+        "jest-resolve": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/jest-regex-util": {
+      "version": "29.6.3",
+      "resolved": "https://registry.npmjs.org/jest-regex-util/-/jest-regex-util-29.6.3.tgz",
+      "integrity": "sha512-KJJBsRCyyLNWCNBOvZyRDnAIfUiRJ8v+hOBQYGn8gDyF3UegwiP4gwRR3/SDa42g1YbVycTidUF3rKjyLFDWbg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/has-tostringtag": {
-      "version": "1.0.2",
-      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
-      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
+    "node_modules/jest-resolve": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-resolve/-/jest-resolve-29.7.0.tgz",
+      "integrity": "sha512-IOVhZSrg+UvVAshDSDtHyFCCBUl/Q3AAJv8iZ6ZjnZ74xzvwuzLXid9IIIPgTnY62SJjfuupMKZsZQRsCvxEgA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "has-symbols": "^1.0.3"
+        "chalk": "^4.0.0",
+        "graceful-fs": "^4.2.9",
+        "jest-haste-map": "^29.7.0",
+        "jest-pnp-resolver": "^1.2.2",
+        "jest-util": "^29.7.0",
+        "jest-validate": "^29.7.0",
+        "resolve": "^1.20.0",
+        "resolve.exports": "^2.0.0",
+        "slash": "^3.0.0"
       },
       "engines": {
-        "node": ">= 0.4"
-      },
-      "funding": {
-        "url": "https://github.com/sponsors/ljharb"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/hasown": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
-      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
+    "node_modules/jest-resolve-dependencies": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-resolve-dependencies/-/jest-resolve-dependencies-29.7.0.tgz",
+      "integrity": "sha512-un0zD/6qxJ+S0et7WxeI3H5XSe9lTBBR7bOHCHXkKR6luG5mwDDlIzVQ0V5cZCuoTgEdcdwzTghYkTWfubi+nA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "function-bind": "^1.1.2"
+        "jest-regex-util": "^29.6.3",
+        "jest-snapshot": "^29.7.0"
       },
       "engines": {
-        "node": ">= 0.4"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/helmet": {
-      "version": "7.2.0",
-      "resolved": "https://registry.npmjs.org/helmet/-/helmet-7.2.0.tgz",
-      "integrity": "sha512-ZRiwvN089JfMXokizgqEPXsl2Guk094yExfoDXR0cBYWxtBbaSww/w+vT4WEJsBW2iTUi1GgZ6swmoug3Oy4Xw==",
+    "node_modules/jest-runner": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-runner/-/jest-runner-29.7.0.tgz",
+      "integrity": "sha512-fsc4N6cPCAahybGBfTRcq5wFR6fpLznMg47sY5aDpsoejOcVYFb07AHuSnR0liMcPTgBsA3ZJL6kFOjPdoNipQ==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/console": "^29.7.0",
+        "@jest/environment": "^29.7.0",
+        "@jest/test-result": "^29.7.0",
+        "@jest/transform": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "emittery": "^0.13.1",
+        "graceful-fs": "^4.2.9",
+        "jest-docblock": "^29.7.0",
+        "jest-environment-node": "^29.7.0",
+        "jest-haste-map": "^29.7.0",
+        "jest-leak-detector": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-resolve": "^29.7.0",
+        "jest-runtime": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "jest-watcher": "^29.7.0",
+        "jest-worker": "^29.7.0",
+        "p-limit": "^3.1.0",
+        "source-map-support": "0.5.13"
+      },
       "engines": {
-        "node": ">=16.0.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/http_ece": {
-      "version": "1.2.0",
-      "resolved": "https://registry.npmjs.org/http_ece/-/http_ece-1.2.0.tgz",
-      "integrity": "sha512-JrF8SSLVmcvc5NducxgyOrKXe3EsyHMgBFgSaIUGmArKe+rwr0uphRkRXvwiom3I+fpIfoItveHrfudL8/rxuA==",
+    "node_modules/jest-runtime": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-runtime/-/jest-runtime-29.7.0.tgz",
+      "integrity": "sha512-gUnLjgwdGqW7B4LvOIkbKs9WGbn+QLqRQQ9juC6HndeDiezIwhDP+mhMwHWCEcfQ5RUXa6OPnFF8BJh5xegwwQ==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "@jest/environment": "^29.7.0",
+        "@jest/fake-timers": "^29.7.0",
+        "@jest/globals": "^29.7.0",
+        "@jest/source-map": "^29.6.3",
+        "@jest/test-result": "^29.7.0",
+        "@jest/transform": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "cjs-module-lexer": "^1.0.0",
+        "collect-v8-coverage": "^1.0.0",
+        "glob": "^7.1.3",
+        "graceful-fs": "^4.2.9",
+        "jest-haste-map": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-mock": "^29.7.0",
+        "jest-regex-util": "^29.6.3",
+        "jest-resolve": "^29.7.0",
+        "jest-snapshot": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "slash": "^3.0.0",
+        "strip-bom": "^4.0.0"
+      },
       "engines": {
-        "node": ">=16"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/http-errors": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.1.tgz",
-      "integrity": "sha512-4FbRdAX+bSdmo4AUFuS0WNiPz8NgFt+r8ThgNWmlrjQjt1Q7ZR9+zTlce2859x4KSXrwIsaeTqDoKQmtP8pLmQ==",
+    "node_modules/jest-snapshot": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-snapshot/-/jest-snapshot-29.7.0.tgz",
+      "integrity": "sha512-Rm0BMWtxBcioHr1/OX5YCP8Uov4riHvKPknOGs804Zg9JGZgmIBkbtlxJC/7Z4msKYVbIJtfU+tKb8xlYNfdkw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "depd": "~2.0.0",
-        "inherits": "~2.0.4",
-        "setprototypeof": "~1.2.0",
-        "statuses": "~2.0.2",
-        "toidentifier": "~1.0.1"
+        "@babel/core": "^7.11.6",
+        "@babel/generator": "^7.7.2",
+        "@babel/plugin-syntax-jsx": "^7.7.2",
+        "@babel/plugin-syntax-typescript": "^7.7.2",
+        "@babel/types": "^7.3.3",
+        "@jest/expect-utils": "^29.7.0",
+        "@jest/transform": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "babel-preset-current-node-syntax": "^1.0.0",
+        "chalk": "^4.0.0",
+        "expect": "^29.7.0",
+        "graceful-fs": "^4.2.9",
+        "jest-diff": "^29.7.0",
+        "jest-get-type": "^29.6.3",
+        "jest-matcher-utils": "^29.7.0",
+        "jest-message-util": "^29.7.0",
+        "jest-util": "^29.7.0",
+        "natural-compare": "^1.4.0",
+        "pretty-format": "^29.7.0",
+        "semver": "^7.5.3"
       },
       "engines": {
-        "node": ">= 0.8"
-      },
-      "funding": {
-        "type": "opencollective",
-        "url": "https://opencollective.com/express"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/https-proxy-agent": {
-      "version": "5.0.1",
-      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
-      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
+    "node_modules/jest-util": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-util/-/jest-util-29.7.0.tgz",
+      "integrity": "sha512-z6EbKajIpqGKU56y5KBUgy1dt1ihhQJgWzUlZHArA/+X2ad7Cb5iF+AK1EWVL/Bo7Rz9uurpqw6SiBCefUbCGA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "agent-base": "6",
-        "debug": "4"
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "chalk": "^4.0.0",
+        "ci-info": "^3.2.0",
+        "graceful-fs": "^4.2.9",
+        "picomatch": "^2.2.3"
       },
       "engines": {
-        "node": ">= 6"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/https-proxy-agent/node_modules/debug": {
-      "version": "4.4.3",
-      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
-      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+    "node_modules/jest-validate": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-validate/-/jest-validate-29.7.0.tgz",
+      "integrity": "sha512-ZB7wHqaRGVw/9hST/OuFUReG7M8vKeq0/J2egIGLdvjHCmYqGARhzXmtgi+gVeZ5uXFF219aOc3Ls2yLg27tkw==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "ms": "^2.1.3"
+        "@jest/types": "^29.6.3",
+        "camelcase": "^6.2.0",
+        "chalk": "^4.0.0",
+        "jest-get-type": "^29.6.3",
+        "leven": "^3.1.0",
+        "pretty-format": "^29.7.0"
       },
       "engines": {
-        "node": ">=6.0"
-      },
-      "peerDependenciesMeta": {
-        "supports-color": {
-          "optional": true
-        }
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/https-proxy-agent/node_modules/ms": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
-      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
-      "license": "MIT"
+    "node_modules/jest-validate/node_modules/camelcase": {
+      "version": "6.3.0",
+      "resolved": "https://registry.npmjs.org/camelcase/-/camelcase-6.3.0.tgz",
+      "integrity": "sha512-Gmy6FhYlCY7uOElZUSbxo2UCDH8owEk996gkbrpsgGtrJLM3J7jGxl9Ic7Qwwj4ivOE5AWZWRMecDdF7hqGjFA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
     },
-    "node_modules/iconv-lite": {
-      "version": "0.4.24",
-      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz",
-      "integrity": "sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==",
+    "node_modules/jest-watcher": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-watcher/-/jest-watcher-29.7.0.tgz",
+      "integrity": "sha512-49Fg7WXkU3Vl2h6LbLtMQ/HyB6rXSIX7SqvBLQmssRBGN9I0PNvPmAmCWSOY6SOvrjhI/F7/bGAv9RtnsPA03g==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "safer-buffer": ">= 2.1.2 < 3"
+        "@jest/test-result": "^29.7.0",
+        "@jest/types": "^29.6.3",
+        "@types/node": "*",
+        "ansi-escapes": "^4.2.1",
+        "chalk": "^4.0.0",
+        "emittery": "^0.13.1",
+        "jest-util": "^29.7.0",
+        "string-length": "^4.0.1"
       },
       "engines": {
-        "node": ">=0.10.0"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/ignore-by-default": {
-      "version": "1.0.1",
-      "resolved": "https://registry.npmjs.org/ignore-by-default/-/ignore-by-default-1.0.1.tgz",
-      "integrity": "sha512-Ius2VYcGNk7T90CppJqcIkS5ooHUZyIQK+ClZfMfMNFEF9VSE73Fq+906u/CWu92x4gzZMWOwfFYckPObzdEbA==",
+    "node_modules/jest-worker": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/jest-worker/-/jest-worker-29.7.0.tgz",
+      "integrity": "sha512-eIz2msL/EzL9UFTFFx7jBTkeZfku0yUAyZZZmJ93H2TYEiroIx2PQjEXcwYtYl8zXCxb+PAmA2hLIt/6ZEkPHw==",
       "dev": true,
-      "license": "ISC"
-    },
-    "node_modules/inherits": {
-      "version": "2.0.4",
-      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
-      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
-      "license": "ISC"
-    },
-    "node_modules/ipaddr.js": {
-      "version": "1.9.1",
-      "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
-      "integrity": "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g==",
       "license": "MIT",
+      "dependencies": {
+        "@types/node": "*",
+        "jest-util": "^29.7.0",
+        "merge-stream": "^2.0.0",
+        "supports-color": "^8.0.0"
+      },
       "engines": {
-        "node": ">= 0.10"
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
       }
     },
-    "node_modules/is-binary-path": {
-      "version": "2.1.0",
-      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
-      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
+    "node_modules/jest-worker/node_modules/has-flag": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
+      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
       "dev": true,
       "license": "MIT",
-      "dependencies": {
-        "binary-extensions": "^2.0.0"
-      },
       "engines": {
         "node": ">=8"
       }
     },
-    "node_modules/is-extglob": {
-      "version": "2.1.1",
-      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
-      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
+    "node_modules/jest-worker/node_modules/supports-color": {
+      "version": "8.1.1",
+      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-8.1.1.tgz",
+      "integrity": "sha512-MpUEN2OodtUzxvKQl72cUF7RQ5EiHsGvSsVG0ia9c5RbWGL2CI4C7EpPS8UTBIplnlzZiNuV56w+FuNxy3ty2Q==",
       "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "has-flag": "^4.0.0"
+      },
       "engines": {
-        "node": ">=0.10.0"
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/supports-color?sponsor=1"
       }
     },
-    "node_modules/is-glob": {
-      "version": "4.0.3",
-      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
-      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
+    "node_modules/js-tokens": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
+      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/js-yaml": {
+      "version": "3.14.2",
+      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-3.14.2.tgz",
+      "integrity": "sha512-PMSmkqxr106Xa156c2M265Z+FTrPl+oxd/rgOQy2tijQeK5TxQ43psO1ZCwhVOSdnn+RzkzlRz/eY4BgJBYVpg==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "is-extglob": "^2.1.1"
+        "argparse": "^1.0.7",
+        "esprima": "^4.0.0"
       },
-      "engines": {
-        "node": ">=0.10.0"
+      "bin": {
+        "js-yaml": "bin/js-yaml.js"
       }
     },
-    "node_modules/is-number": {
-      "version": "7.0.0",
-      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
-      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
+    "node_modules/jsesc": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
+      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
       "dev": true,
       "license": "MIT",
+      "bin": {
+        "jsesc": "bin/jsesc"
+      },
       "engines": {
-        "node": ">=0.12.0"
+        "node": ">=6"
       }
     },
-    "node_modules/is-stream": {
-      "version": "2.0.1",
-      "resolved": "https://registry.npmjs.org/is-stream/-/is-stream-2.0.1.tgz",
-      "integrity": "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg==",
+    "node_modules/json-parse-even-better-errors": {
+      "version": "2.3.1",
+      "resolved": "https://registry.npmjs.org/json-parse-even-better-errors/-/json-parse-even-better-errors-2.3.1.tgz",
+      "integrity": "sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/json2csv": {
+      "version": "5.0.7",
+      "resolved": "https://registry.npmjs.org/json2csv/-/json2csv-5.0.7.tgz",
+      "integrity": "sha512-YRZbUnyaJZLZUJSRi2G/MqahCyRv9n/ds+4oIetjDF3jWQA7AG7iSeKTiZiCNqtMZM7HDyt0e/W6lEnoGEmMGA==",
+      "deprecated": "Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.",
       "license": "MIT",
+      "dependencies": {
+        "commander": "^6.1.0",
+        "jsonparse": "^1.3.1",
+        "lodash.get": "^4.4.2"
+      },
+      "bin": {
+        "json2csv": "bin/json2csv.js"
+      },
       "engines": {
-        "node": ">=8"
+        "node": ">= 10",
+        "npm": ">= 6.13.0"
+      }
+    },
+    "node_modules/json5": {
+      "version": "2.2.3",
+      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
+      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
+      "dev": true,
+      "license": "MIT",
+      "bin": {
+        "json5": "lib/cli.js"
       },
-      "funding": {
-        "url": "https://github.com/sponsors/sindresorhus"
+      "engines": {
+        "node": ">=6"
       }
     },
-    "node_modules/isarray": {
-      "version": "1.0.0",
-      "resolved": "https://registry.npmjs.org/isarray/-/isarray-1.0.0.tgz",
-      "integrity": "sha512-VLghIWNM6ELQzo7zwmcg0NmTVyWKYjvIeM83yjp0wRDTmUnrM678fQbcKBo6n2CJEF0szoG//ytg+TKla89ALQ==",
+    "node_modules/jsonparse": {
+      "version": "1.3.1",
+      "resolved": "https://registry.npmjs.org/jsonparse/-/jsonparse-1.3.1.tgz",
+      "integrity": "sha512-POQXvpdL69+CluYsillJ7SUhKvytYjW9vG/GKpnf+xP8UWgYEM/RaMzHHofbALDiKbbP1W8UEYmgGl39WkPZsg==",
+      "engines": [
+        "node >= 0.2.0"
+      ],
       "license": "MIT"
     },
     "node_modules/jsonwebtoken": {
@@ -1367,12 +4710,78 @@
         "safe-buffer": "^5.0.1"
       }
     },
+    "node_modules/kleur": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/kleur/-/kleur-3.0.3.tgz",
+      "integrity": "sha512-eTIzlVOSUR+JxdDFepEYcBMtZ9Qqdef+rnzWdRZuMbOywu5tO2w2N7rqjoANZ5k9vywhL6Br1VRjUIgTQx4E8w==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
     "node_modules/kuler": {
       "version": "2.0.0",
       "resolved": "https://registry.npmjs.org/kuler/-/kuler-2.0.0.tgz",
       "integrity": "sha512-Xq9nH7KlWZmXAtodXDDRE7vs6DU1gTU8zYDHDiWLSip45Egwq3plLHzPn27NgvzL2r1LMPC1vdqh98sQxtqj4A==",
       "license": "MIT"
     },
+    "node_modules/leven": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/leven/-/leven-3.1.0.tgz",
+      "integrity": "sha512-qsda+H8jTaUaN/x5vzW2rzc+8Rw4TAQ/4KjB46IwK5VH+IlVeeeje/EoZRpiXvIqjFgK84QffqPztGI3VBLG1A==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/linebreak": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/linebreak/-/linebreak-1.1.0.tgz",
+      "integrity": "sha512-MHp03UImeVhB7XZtjd0E4n6+3xr5Dq/9xI/5FptGk5FrbDR3zagPa2DS6U8ks/3HjbKWG9Q1M2ufOzxV2qLYSQ==",
+      "license": "MIT",
+      "dependencies": {
+        "base64-js": "0.0.8",
+        "unicode-trie": "^2.0.0"
+      }
+    },
+    "node_modules/linebreak/node_modules/base64-js": {
+      "version": "0.0.8",
+      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-0.0.8.tgz",
+      "integrity": "sha512-3XSA2cR/h/73EzlXXdU6YNycmYI7+kicTxks4eJg2g39biHR84slg2+des+p7iHYhbRg/udIS4TD53WabcOUkw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/lines-and-columns": {
+      "version": "1.2.4",
+      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
+      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/locate-path": {
+      "version": "5.0.0",
+      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-5.0.0.tgz",
+      "integrity": "sha512-t7hw9pI+WvuwNJXwk5zVHpyhIqzg2qTlklJOf0mVxGSbe3Fp2VieZcduNYjaLDoy6p9uGpQEGWG87WpMKlNq8g==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "p-locate": "^4.1.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/lodash.get": {
+      "version": "4.4.2",
+      "resolved": "https://registry.npmjs.org/lodash.get/-/lodash.get-4.4.2.tgz",
+      "integrity": "sha512-z+Uw/vLuy6gQe8cfaFWD7p0wVv8fJl3mbzXh33RS+0oW2wvUqiRXiQ69gLWSLpgB5/6sU+r6BlQR0MBILadqTQ==",
+      "deprecated": "This package is deprecated. Use the optional chaining (?.) operator instead.",
+      "license": "MIT"
+    },
     "node_modules/lodash.includes": {
       "version": "4.3.0",
       "resolved": "https://registry.npmjs.org/lodash.includes/-/lodash.includes-4.3.0.tgz",
@@ -1438,6 +4847,42 @@
       "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
       "license": "MIT"
     },
+    "node_modules/lru-cache": {
+      "version": "5.1.1",
+      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
+      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "yallist": "^3.0.2"
+      }
+    },
+    "node_modules/make-dir": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/make-dir/-/make-dir-4.0.0.tgz",
+      "integrity": "sha512-hXdUTZYIVOt1Ex//jAQi+wTZZpUpwBj/0QsOzqegb3rGMMeJiSEu5xLHnYfBrRV4RH2+OCSOO95Is/7x1WJ4bw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "semver": "^7.5.3"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/makeerror": {
+      "version": "1.0.12",
+      "resolved": "https://registry.npmjs.org/makeerror/-/makeerror-1.0.12.tgz",
+      "integrity": "sha512-JmqCvUhmt43madlpFzG4BQzG2Z3m6tvQDNKdClZnO3VbIudJYmxsT0FNJMeiB2+JTSlTQTSbU8QdesVmwJcmLg==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "tmpl": "1.0.5"
+      }
+    },
     "node_modules/math-intrinsics": {
       "version": "1.1.0",
       "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
@@ -1465,6 +4910,13 @@
         "url": "https://github.com/sponsors/sindresorhus"
       }
     },
+    "node_modules/merge-stream": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/merge-stream/-/merge-stream-2.0.0.tgz",
+      "integrity": "sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/methods": {
       "version": "1.1.2",
       "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
@@ -1474,6 +4926,20 @@
         "node": ">= 0.6"
       }
     },
+    "node_modules/micromatch": {
+      "version": "4.0.8",
+      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
+      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "braces": "^3.0.3",
+        "picomatch": "^2.3.1"
+      },
+      "engines": {
+        "node": ">=8.6"
+      }
+    },
     "node_modules/mime": {
       "version": "1.6.0",
       "resolved": "https://registry.npmjs.org/mime/-/mime-1.6.0.tgz",
@@ -1507,6 +4973,16 @@
         "node": ">= 0.6"
       }
     },
+    "node_modules/mimic-fn": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/mimic-fn/-/mimic-fn-2.1.0.tgz",
+      "integrity": "sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
     "node_modules/minimalistic-assert": {
       "version": "1.0.1",
       "resolved": "https://registry.npmjs.org/minimalistic-assert/-/minimalistic-assert-1.0.1.tgz",
@@ -1575,6 +5051,13 @@
         "node": ">= 6.0.0"
       }
     },
+    "node_modules/natural-compare": {
+      "version": "1.4.0",
+      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
+      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/negotiator": {
       "version": "0.6.3",
       "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
@@ -1584,14 +5067,19 @@
         "node": ">= 0.6"
       }
     },
-    "node_modules/nodemailer": {
-      "version": "6.10.1",
-      "resolved": "https://registry.npmjs.org/nodemailer/-/nodemailer-6.10.1.tgz",
-      "integrity": "sha512-Z+iLaBGVaSjbIzQ4pX6XV41HrooLsQ10ZWPUehGmuantvzWoDVBnmsdUcOIDM1t+yPor5pDhVlDESgOMEGxhHA==",
-      "license": "MIT-0",
-      "engines": {
-        "node": ">=6.0.0"
-      }
+    "node_modules/node-int64": {
+      "version": "0.4.0",
+      "resolved": "https://registry.npmjs.org/node-int64/-/node-int64-0.4.0.tgz",
+      "integrity": "sha512-O5lz91xSOeoXP6DulyHfllpq+Eg00MWitZIbtPfoSEvqIHdl5gfcY6hYzDWnj0qD5tz52PI08u9qUvSVeUBeHw==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/node-releases": {
+      "version": "2.0.27",
+      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
+      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
+      "dev": true,
+      "license": "MIT"
     },
     "node_modules/nodemon": {
       "version": "3.1.14",
@@ -1657,6 +5145,19 @@
         "node": ">=0.10.0"
       }
     },
+    "node_modules/npm-run-path": {
+      "version": "4.0.1",
+      "resolved": "https://registry.npmjs.org/npm-run-path/-/npm-run-path-4.0.1.tgz",
+      "integrity": "sha512-S48WzZW777zhNIrn7gxOlISNAqi9ZC/uQFnRdbeIHhZhCA6UqpkOT8T1G7BvfdgP4Er8gF4sUbaS0i7QvIfCWw==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "path-key": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/object-assign": {
       "version": "4.1.1",
       "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
@@ -1678,6 +5179,51 @@
         "url": "https://github.com/sponsors/ljharb"
       }
     },
+    "node_modules/object-is": {
+      "version": "1.1.6",
+      "resolved": "https://registry.npmjs.org/object-is/-/object-is-1.1.6.tgz",
+      "integrity": "sha512-F8cZ+KfGlSGi09lJT7/Nd6KJZ9ygtvYC0/UYYLI9nmQKLMnydpB9yvbv9K1uSkEu7FU9vYPmVwLg328tX+ot3Q==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind": "^1.0.7",
+        "define-properties": "^1.2.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/object-keys": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/object-keys/-/object-keys-1.1.1.tgz",
+      "integrity": "sha512-NuAESUOUMrlIXOfHKzD6bpPu3tYt3xvjNdRIQ+FeT0lNb4K8WR70CaDxhuNguS2XG+GjkyMwOzsN5ZktImfhLA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/object.assign": {
+      "version": "4.1.7",
+      "resolved": "https://registry.npmjs.org/object.assign/-/object.assign-4.1.7.tgz",
+      "integrity": "sha512-nK28WOo+QIjBkDduTINE4JkF/UJJKyf2EJxvJKfblDpyg0Q+pkOHNTL0Qwy6NP6FhE/EnzV73BxxqcJaXY9anw==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind": "^1.0.8",
+        "call-bound": "^1.0.3",
+        "define-properties": "^1.2.1",
+        "es-object-atoms": "^1.0.0",
+        "has-symbols": "^1.1.0",
+        "object-keys": "^1.1.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
     "node_modules/on-finished": {
       "version": "2.4.1",
       "resolved": "https://registry.npmjs.org/on-finished/-/on-finished-2.4.1.tgz",
@@ -1690,6 +5236,25 @@
         "node": ">= 0.8"
       }
     },
+    "node_modules/on-headers": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/on-headers/-/on-headers-1.1.0.tgz",
+      "integrity": "sha512-737ZY3yNnXy37FHkQxPzt4UZ2UWPWiCZWLvFZ4fu5cueciegX0zGPnrlY6bwRg4FdQOe9YU8MkmJwGhoMybl8A==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/once": {
+      "version": "1.4.0",
+      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
+      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "wrappy": "1"
+      }
+    },
     "node_modules/one-time": {
       "version": "1.0.0",
       "resolved": "https://registry.npmjs.org/one-time/-/one-time-1.0.0.tgz",
@@ -1699,6 +5264,108 @@
         "fn.name": "1.x.x"
       }
     },
+    "node_modules/onetime": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/onetime/-/onetime-5.1.2.tgz",
+      "integrity": "sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "mimic-fn": "^2.1.0"
+      },
+      "engines": {
+        "node": ">=6"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/p-limit": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
+      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "yocto-queue": "^0.1.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/p-locate": {
+      "version": "4.1.0",
+      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-4.1.0.tgz",
+      "integrity": "sha512-R79ZZ/0wAxKGu3oYMlz8jy/kbhsNrS7SKZ7PxEHBgJ5+F2mtFW2fK2cOtBh1cHYkQsbzFV7I+EoRKe6Yt0oK7A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "p-limit": "^2.2.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/p-locate/node_modules/p-limit": {
+      "version": "2.3.0",
+      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-2.3.0.tgz",
+      "integrity": "sha512-//88mFWSJx8lxCzwdAABTJL2MyWB12+eIY7MDL2SqLmAkeKU9qxRvWuSyTjm3FUmpBEMuFfckAIqEaVGUDxb6w==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "p-try": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=6"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/p-try": {
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/p-try/-/p-try-2.2.0.tgz",
+      "integrity": "sha512-R4nPAVTAU0B9D35/Gk3uJf/7XYbQcyohSKdvAxIRSNghFl4e71hVoGnBNQz9cWaXxO2I10KTC+3jMdvvoKw6dQ==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/pako": {
+      "version": "0.2.9",
+      "resolved": "https://registry.npmjs.org/pako/-/pako-0.2.9.tgz",
+      "integrity": "sha512-NUcwaKxUxWrZLpDG+z/xZaCgQITkA/Dv4V/T6bw7VON6l1Xz/VnrBqrYjZQ12TamKHzITTfOEIYUj48y2KXImA==",
+      "license": "MIT"
+    },
+    "node_modules/papaparse": {
+      "version": "5.4.1",
+      "resolved": "https://registry.npmjs.org/papaparse/-/papaparse-5.4.1.tgz",
+      "integrity": "sha512-HipMsgJkZu8br23pW15uvo6sib6wne/4woLZPlFf3rpDyMe9ywEXUsuD7+6K9PRkJlVT51j/sCOYDKGGS3ZJrw==",
+      "license": "MIT"
+    },
+    "node_modules/parse-json": {
+      "version": "5.2.0",
+      "resolved": "https://registry.npmjs.org/parse-json/-/parse-json-5.2.0.tgz",
+      "integrity": "sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@babel/code-frame": "^7.0.0",
+        "error-ex": "^1.3.1",
+        "json-parse-even-better-errors": "^2.3.0",
+        "lines-and-columns": "^1.1.6"
+      },
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
     "node_modules/parseurl": {
       "version": "1.3.3",
       "resolved": "https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz",
@@ -1708,12 +5375,68 @@
         "node": ">= 0.8"
       }
     },
+    "node_modules/path-exists": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
+      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/path-is-absolute": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/path-is-absolute/-/path-is-absolute-1.0.1.tgz",
+      "integrity": "sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/path-key": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
+      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/path-parse": {
+      "version": "1.0.7",
+      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
+      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/path-to-regexp": {
       "version": "0.1.12",
       "resolved": "https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.12.tgz",
       "integrity": "sha512-RA1GjUVMnvYFxuqovrEqZoxxW5NUZqbwKtYz/Tt7nXerk0LbLblQmrsgdeOxV5SFHf0UDggjS/bSeOZwt1pmEQ==",
       "license": "MIT"
     },
+    "node_modules/pdfkit": {
+      "version": "0.12.3",
+      "resolved": "https://registry.npmjs.org/pdfkit/-/pdfkit-0.12.3.tgz",
+      "integrity": "sha512-+qDLgm2yq6WOKcxTb43lDeo3EtMIDQs0CK1RNqhHC9iT6u0KOmgwAClkYh9xFw2ATbmUZzt4f7KMwDCOfPDluA==",
+      "license": "MIT",
+      "dependencies": {
+        "crypto-js": "^4.0.0",
+        "fontkit": "^1.8.1",
+        "linebreak": "^1.0.2",
+        "png-js": "^1.0.0"
+      }
+    },
+    "node_modules/picocolors": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
+      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
+      "dev": true,
+      "license": "ISC"
+    },
     "node_modules/picomatch": {
       "version": "2.3.1",
       "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
@@ -1727,6 +5450,71 @@
         "url": "https://github.com/sponsors/jonschlinkert"
       }
     },
+    "node_modules/pirates": {
+      "version": "4.0.7",
+      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz",
+      "integrity": "sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">= 6"
+      }
+    },
+    "node_modules/pkg-dir": {
+      "version": "4.2.0",
+      "resolved": "https://registry.npmjs.org/pkg-dir/-/pkg-dir-4.2.0.tgz",
+      "integrity": "sha512-HRDzbaKjC+AOWVXxAU/x54COGeIv9eb+6CkDSQoNTt4XyWoIJvuPsXizxu/Fr23EiekbtZwmh1IcIG/l/a10GQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "find-up": "^4.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/png-js": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/png-js/-/png-js-1.0.0.tgz",
+      "integrity": "sha512-k+YsbhpA9e+EFfKjTCH3VW6aoKlyNYI6NYdTfDL4CIvFnvsuO84ttonmZE7rc+v23SLTH8XX+5w/Ak9v0xGY4g=="
+    },
+    "node_modules/possible-typed-array-names": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/possible-typed-array-names/-/possible-typed-array-names-1.1.0.tgz",
+      "integrity": "sha512-/+5VFTchJDoVj3bhoqi6UeymcD00DAwb1nJwamzPvHEszJ4FpF6SNNbUbOS8yI56qHzdV8eK0qEfOSiodkTdxg==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/pretty-format": {
+      "version": "29.7.0",
+      "resolved": "https://registry.npmjs.org/pretty-format/-/pretty-format-29.7.0.tgz",
+      "integrity": "sha512-Pdlw/oPxN+aXdmM9R00JVC9WVFoCLTKJvDVLgmJ+qAffBMxsV85l/Lu7sNx4zSzPyoL2euImuEwHhOXdEgNFZQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "@jest/schemas": "^29.6.3",
+        "ansi-styles": "^5.0.0",
+        "react-is": "^18.0.0"
+      },
+      "engines": {
+        "node": "^14.15.0 || ^16.10.0 || >=18.0.0"
+      }
+    },
+    "node_modules/pretty-format/node_modules/ansi-styles": {
+      "version": "5.2.0",
+      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-5.2.0.tgz",
+      "integrity": "sha512-Cxwpt2SfTzTtXcfOlzGEee8O+c+MmUgGrNiBcXnuWxuFJHe6a5Hz7qwhwe5OgaSYI0IJvkLqWX1ASG+cJOkEiA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
+      }
+    },
     "node_modules/prisma": {
       "version": "5.22.0",
       "resolved": "https://registry.npmjs.org/prisma/-/prisma-5.22.0.tgz",
@@ -1753,6 +5541,20 @@
       "integrity": "sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==",
       "license": "MIT"
     },
+    "node_modules/prompts": {
+      "version": "2.4.2",
+      "resolved": "https://registry.npmjs.org/prompts/-/prompts-2.4.2.tgz",
+      "integrity": "sha512-NxNv/kLguCA7p3jE8oL2aEBsrJWgAakBpgmgK6lpPWV+WuOmY6r2/zbAVnP+T8bQlA0nzHXSJSJW0Hq7ylaD2Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "kleur": "^3.0.3",
+        "sisteransi": "^1.0.5"
+      },
+      "engines": {
+        "node": ">= 6"
+      }
+    },
     "node_modules/proxy-addr": {
       "version": "2.0.7",
       "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
@@ -1779,6 +5581,23 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/pure-rand": {
+      "version": "6.1.0",
+      "resolved": "https://registry.npmjs.org/pure-rand/-/pure-rand-6.1.0.tgz",
+      "integrity": "sha512-bVWawvoZoBYpp6yIoQtQXHZjmz35RSVHnUOTefl8Vcjr8snTPY1wnpSPMWekcFwbxI6gtmT7rSYPFvz71ldiOA==",
+      "dev": true,
+      "funding": [
+        {
+          "type": "individual",
+          "url": "https://github.com/sponsors/dubzzz"
+        },
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/fast-check"
+        }
+      ],
+      "license": "MIT"
+    },
     "node_modules/qs": {
       "version": "6.14.2",
       "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.2.tgz",
@@ -1794,6 +5613,12 @@
         "url": "https://github.com/sponsors/ljharb"
       }
     },
+    "node_modules/querystringify": {
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/querystringify/-/querystringify-2.2.0.tgz",
+      "integrity": "sha512-FIqgj2EUvTa7R50u0rGsyTftzjYmv/a3hO345bZNrqabNqjtgiDMgmo4mkUjd+nzU5oF3dClKqFIPUKybUyqoQ==",
+      "license": "MIT"
+    },
     "node_modules/range-parser": {
       "version": "1.2.1",
       "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
@@ -1818,6 +5643,13 @@
         "node": ">= 0.8"
       }
     },
+    "node_modules/react-is": {
+      "version": "18.3.1",
+      "resolved": "https://registry.npmjs.org/react-is/-/react-is-18.3.1.tgz",
+      "integrity": "sha512-/LLMVyas0ljjAtoYiPqYiL8VWXzUUdThrmU5+n20DZv+a+ClRoevUzw5JxU+Ieh5/c87ytoTBV9G1FiKfNJdmg==",
+      "dev": true,
+      "license": "MIT"
+    },
     "node_modules/readable-stream": {
       "version": "2.3.8",
       "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-2.3.8.tgz",
@@ -1833,25 +5665,121 @@
         "util-deprecate": "~1.0.1"
       }
     },
-    "node_modules/readable-stream/node_modules/safe-buffer": {
-      "version": "5.1.2",
-      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
-      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
-      "license": "MIT"
-    },
-    "node_modules/readdirp": {
-      "version": "3.6.0",
-      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
-      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
+    "node_modules/readable-stream/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/readdirp": {
+      "version": "3.6.0",
+      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
+      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "picomatch": "^2.2.1"
+      },
+      "engines": {
+        "node": ">=8.10.0"
+      }
+    },
+    "node_modules/regexp.prototype.flags": {
+      "version": "1.5.4",
+      "resolved": "https://registry.npmjs.org/regexp.prototype.flags/-/regexp.prototype.flags-1.5.4.tgz",
+      "integrity": "sha512-dYqgNSZbDwkaJ2ceRd9ojCGjBq+mOm9LmtXnAnEGyHhN/5R7iDW2TRw3h+o/jCFxus3P2LfWIIiwowAjANm7IA==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bind": "^1.0.8",
+        "define-properties": "^1.2.1",
+        "es-errors": "^1.3.0",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "set-function-name": "^2.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/require-directory": {
+      "version": "2.1.1",
+      "resolved": "https://registry.npmjs.org/require-directory/-/require-directory-2.1.1.tgz",
+      "integrity": "sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/requires-port": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/requires-port/-/requires-port-1.0.0.tgz",
+      "integrity": "sha512-KigOCHcocU3XODJxsu8i/j8T9tzT4adHiecwORRQ0ZZFcp7ahwXuRU1m+yuO90C5ZUyGeGfocHDI14M3L3yDAQ==",
+      "license": "MIT"
+    },
+    "node_modules/resolve": {
+      "version": "1.22.11",
+      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz",
+      "integrity": "sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "is-core-module": "^2.16.1",
+        "path-parse": "^1.0.7",
+        "supports-preserve-symlinks-flag": "^1.0.0"
+      },
+      "bin": {
+        "resolve": "bin/resolve"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/resolve-cwd": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/resolve-cwd/-/resolve-cwd-3.0.0.tgz",
+      "integrity": "sha512-OrZaX2Mb+rJCpH/6CpSqt9xFVpN++x01XnN2ie9g6P5/3xelLAkXWVADpdz1IHD/KFfEXyE6V0U01OQ3UO2rEg==",
       "dev": true,
       "license": "MIT",
       "dependencies": {
-        "picomatch": "^2.2.1"
+        "resolve-from": "^5.0.0"
       },
       "engines": {
-        "node": ">=8.10.0"
+        "node": ">=8"
+      }
+    },
+    "node_modules/resolve-from": {
+      "version": "5.0.0",
+      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-5.0.0.tgz",
+      "integrity": "sha512-qYg9KP24dD5qka9J47d0aVky0N+b4fTU89LN9iDnjB5waksiC49rvMB0PrUJQGoTmH50XPiqOvAjDfaijGxYZw==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/resolve.exports": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/resolve.exports/-/resolve.exports-2.0.3.tgz",
+      "integrity": "sha512-OcXjMsGdhL4XnbShKpAcSqPMzQoYkYyhbEaeSko47MjRP9NfEQMhZkXL1DoFlt9LWQn4YttrdnV6X2OiyzBi+A==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
       }
     },
+    "node_modules/restructure": {
+      "version": "2.0.1",
+      "resolved": "https://registry.npmjs.org/restructure/-/restructure-2.0.1.tgz",
+      "integrity": "sha512-e0dOpjm5DseomnXx2M5lpdZ5zoHqF1+bqdMJUohoYVVQa7cBdnk7fdmeI6byNWP/kiME72EeTiSypTCVnpLiDg==",
+      "license": "MIT"
+    },
     "node_modules/safe-buffer": {
       "version": "5.2.1",
       "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
@@ -1872,6 +5800,23 @@
       ],
       "license": "MIT"
     },
+    "node_modules/safe-regex-test": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/safe-regex-test/-/safe-regex-test-1.1.0.tgz",
+      "integrity": "sha512-x/+Cz4YrimQxQccJf5mKEbIa1NzeCRNI5Ecl/ekmlYaampdNLPalVyIcCZNNH3MvmqBugV5TMYZXv0ljslUlaw==",
+      "license": "MIT",
+      "dependencies": {
+        "call-bound": "^1.0.2",
+        "es-errors": "^1.3.0",
+        "is-regex": "^1.2.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
     "node_modules/safe-stable-stringify": {
       "version": "2.5.0",
       "resolved": "https://registry.npmjs.org/safe-stable-stringify/-/safe-stable-stringify-2.5.0.tgz",
@@ -1951,12 +5896,67 @@
         "node": ">= 0.8.0"
       }
     },
+    "node_modules/set-function-length": {
+      "version": "1.2.2",
+      "resolved": "https://registry.npmjs.org/set-function-length/-/set-function-length-1.2.2.tgz",
+      "integrity": "sha512-pgRc4hJ4/sNjWCSS9AmnS40x3bNMDTknHgL5UaMBTMyJnU90EgWh1Rz+MC9eFu4BuN/UwZjKQuY/1v3rM7HMfg==",
+      "license": "MIT",
+      "dependencies": {
+        "define-data-property": "^1.1.4",
+        "es-errors": "^1.3.0",
+        "function-bind": "^1.1.2",
+        "get-intrinsic": "^1.2.4",
+        "gopd": "^1.0.1",
+        "has-property-descriptors": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/set-function-name": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/set-function-name/-/set-function-name-2.0.2.tgz",
+      "integrity": "sha512-7PGFlmtwsEADb0WYyvCMa1t+yke6daIG4Wirafur5kcf+MhUnPms1UeR0CKQdTZD81yESwMHbtn+TR+dMviakQ==",
+      "license": "MIT",
+      "dependencies": {
+        "define-data-property": "^1.1.4",
+        "es-errors": "^1.3.0",
+        "functions-have-names": "^1.2.3",
+        "has-property-descriptors": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
     "node_modules/setprototypeof": {
       "version": "1.2.0",
       "resolved": "https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.2.0.tgz",
       "integrity": "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw==",
       "license": "ISC"
     },
+    "node_modules/shebang-command": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
+      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "shebang-regex": "^3.0.0"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/shebang-regex": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
+      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/side-channel": {
       "version": "1.1.0",
       "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
@@ -2029,6 +6029,13 @@
         "url": "https://github.com/sponsors/ljharb"
       }
     },
+    "node_modules/signal-exit": {
+      "version": "3.0.7",
+      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-3.0.7.tgz",
+      "integrity": "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ==",
+      "dev": true,
+      "license": "ISC"
+    },
     "node_modules/simple-update-notifier": {
       "version": "2.0.0",
       "resolved": "https://registry.npmjs.org/simple-update-notifier/-/simple-update-notifier-2.0.0.tgz",
@@ -2042,6 +6049,23 @@
         "node": ">=10"
       }
     },
+    "node_modules/sisteransi": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/sisteransi/-/sisteransi-1.0.5.tgz",
+      "integrity": "sha512-bLGGlR1QxBcynn2d5YmDX4MGjlZvy2MRBDRNHLJ8VI6l6+9FUiyTFNJ0IveOSP0bcXgVDPRcfGqA0pjaqUpfVg==",
+      "dev": true,
+      "license": "MIT"
+    },
+    "node_modules/slash": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/slash/-/slash-3.0.0.tgz",
+      "integrity": "sha512-g9Q1haeby36OSStwb4ntCGGGaKsaVSjQ68fBxoQcutl5fS1vuY18H3wSt3jFyFtrkx+Kz0V1G85A4MyAdDMi2Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/socket.io": {
       "version": "4.8.3",
       "resolved": "https://registry.npmjs.org/socket.io/-/socket.io-4.8.3.tgz",
@@ -2123,16 +6147,246 @@
         }
       }
     },
-    "node_modules/socket.io-parser/node_modules/ms": {
-      "version": "2.1.3",
-      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
-      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
-      "license": "MIT"
-    },
-    "node_modules/socket.io/node_modules/debug": {
+    "node_modules/socket.io-parser/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/socket.io/node_modules/debug": {
+      "version": "4.4.3",
+      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "license": "MIT",
+      "dependencies": {
+        "ms": "^2.1.3"
+      },
+      "engines": {
+        "node": ">=6.0"
+      },
+      "peerDependenciesMeta": {
+        "supports-color": {
+          "optional": true
+        }
+      }
+    },
+    "node_modules/socket.io/node_modules/ms": {
+      "version": "2.1.3",
+      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "license": "MIT"
+    },
+    "node_modules/source-map": {
+      "version": "0.6.1",
+      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
+      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
+      "dev": true,
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/source-map-support": {
+      "version": "0.5.13",
+      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.13.tgz",
+      "integrity": "sha512-SHSKFHadjVA5oR4PPqhtAVdcBWwRYVd6g6cAXnIbRiIwc2EhPrTuKUBdSLvlEKyIP3GCf89fltvcZiP9MMFA1w==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "buffer-from": "^1.0.0",
+        "source-map": "^0.6.0"
+      }
+    },
+    "node_modules/sprintf-js": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/sprintf-js/-/sprintf-js-1.0.3.tgz",
+      "integrity": "sha512-D9cPgkvLlV3t3IzL0D0YLvGA9Ahk4PcvVwUbN0dSGr1aP0Nrt4AEnTUbuGvquEC0mA64Gqt1fzirlRs5ibXx8g==",
+      "dev": true,
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/stack-trace": {
+      "version": "0.0.10",
+      "resolved": "https://registry.npmjs.org/stack-trace/-/stack-trace-0.0.10.tgz",
+      "integrity": "sha512-KGzahc7puUKkzyMt+IqAep+TVNbKP+k2Lmwhub39m1AsTSkaDutx56aDCo+HLDzf/D26BIHTJWNiTG1KAJiQCg==",
+      "license": "MIT",
+      "engines": {
+        "node": "*"
+      }
+    },
+    "node_modules/stack-utils": {
+      "version": "2.0.6",
+      "resolved": "https://registry.npmjs.org/stack-utils/-/stack-utils-2.0.6.tgz",
+      "integrity": "sha512-XlkWvfIm6RmsWtNJx+uqtKLS8eqFbxUg0ZzLXqY0caEy9l7hruX8IpiDnjsLavoBgqCCR71TqWO8MaXYheJ3RQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "escape-string-regexp": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/statuses": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.2.tgz",
+      "integrity": "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 0.8"
+      }
+    },
+    "node_modules/stop-iteration-iterator": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/stop-iteration-iterator/-/stop-iteration-iterator-1.1.0.tgz",
+      "integrity": "sha512-eLoXW/DHyl62zxY4SCaIgnRhuMr6ri4juEYARS8E6sCEqzKpOiE521Ucofdx+KnDZl5xmvGYaaKCk5FEOxJCoQ==",
+      "license": "MIT",
+      "dependencies": {
+        "es-errors": "^1.3.0",
+        "internal-slot": "^1.1.0"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      }
+    },
+    "node_modules/streamsearch": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
+      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
+      "engines": {
+        "node": ">=10.0.0"
+      }
+    },
+    "node_modules/string_decoder": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.1.1.tgz",
+      "integrity": "sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==",
+      "license": "MIT",
+      "dependencies": {
+        "safe-buffer": "~5.1.0"
+      }
+    },
+    "node_modules/string_decoder/node_modules/safe-buffer": {
+      "version": "5.1.2",
+      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
+      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+      "license": "MIT"
+    },
+    "node_modules/string-length": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/string-length/-/string-length-4.0.2.tgz",
+      "integrity": "sha512-+l6rNN5fYHNhZZy41RXsYptCjA2Igmq4EG7kZAYFQI1E1VTXarr6ZPXBg6eq7Y6eK4FEhY6AJlyuFIb/v/S0VQ==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "char-regex": "^1.0.2",
+        "strip-ansi": "^6.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/string-width": {
+      "version": "4.2.3",
+      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
+      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "emoji-regex": "^8.0.0",
+        "is-fullwidth-code-point": "^3.0.0",
+        "strip-ansi": "^6.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/strip-ansi": {
+      "version": "6.0.1",
+      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
+      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-regex": "^5.0.1"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/strip-bom": {
+      "version": "4.0.0",
+      "resolved": "https://registry.npmjs.org/strip-bom/-/strip-bom-4.0.0.tgz",
+      "integrity": "sha512-3xurFv5tEgii33Zi8Jtp55wEIILR9eh34FAW00PZf+JnSsTmV/ioewSgQl97JHvgjoRGwPShsWm+IdrxB35d0w==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      }
+    },
+    "node_modules/strip-final-newline": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/strip-final-newline/-/strip-final-newline-2.0.0.tgz",
+      "integrity": "sha512-BrpvfNAE3dcvq7ll3xVumzjKjZQ5tI1sEUIKr3Uoks0XUl45St3FlatVqef9prk4jRDzhW6WZg+3bk93y6pLjA==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/strip-json-comments": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
+      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=8"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
+    "node_modules/stripe": {
+      "version": "12.18.0",
+      "resolved": "https://registry.npmjs.org/stripe/-/stripe-12.18.0.tgz",
+      "integrity": "sha512-cYjgBM2SY/dTm8Lr6eMyyONaHTZHA/QjHxFUIW5WH8FevSRIGAVtXEmBkUXF1fsqe7QvvRgQSGSJZmjDacegGg==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/node": ">=8.1.0",
+        "qs": "^6.11.0"
+      },
+      "engines": {
+        "node": ">=12.*"
+      }
+    },
+    "node_modules/superagent": {
+      "version": "8.1.2",
+      "resolved": "https://registry.npmjs.org/superagent/-/superagent-8.1.2.tgz",
+      "integrity": "sha512-6WTxW1EB6yCxV5VFOIPQruWGHqc3yI7hEmZK6h+pyk69Lk/Ut7rLUY6W/ONF2MjBuGjvmMiIpsrVJ2vjrHlslA==",
+      "deprecated": "Please upgrade to superagent v10.2.2+, see release notes at https://github.com/forwardemail/superagent/releases/tag/v10.2.2 - maintenance is supported by Forward Email @ https://forwardemail.net",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "component-emitter": "^1.3.0",
+        "cookiejar": "^2.1.4",
+        "debug": "^4.3.4",
+        "fast-safe-stringify": "^2.1.1",
+        "form-data": "^4.0.0",
+        "formidable": "^2.1.2",
+        "methods": "^1.1.2",
+        "mime": "2.6.0",
+        "qs": "^6.11.0",
+        "semver": "^7.3.8"
+      },
+      "engines": {
+        "node": ">=6.4.0 <13 || >=14"
+      }
+    },
+    "node_modules/superagent/node_modules/debug": {
       "version": "4.4.3",
       "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
       "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
         "ms": "^2.1.3"
@@ -2146,77 +6400,111 @@
         }
       }
     },
-    "node_modules/socket.io/node_modules/ms": {
+    "node_modules/superagent/node_modules/mime": {
+      "version": "2.6.0",
+      "resolved": "https://registry.npmjs.org/mime/-/mime-2.6.0.tgz",
+      "integrity": "sha512-USPkMeET31rOMiarsBNIHZKLGgvKc/LrjofAnBlOttf5ajRvqiRA8QsenbcooctK6d6Ts6aqZXBA+XbkKthiQg==",
+      "dev": true,
+      "license": "MIT",
+      "bin": {
+        "mime": "cli.js"
+      },
+      "engines": {
+        "node": ">=4.0.0"
+      }
+    },
+    "node_modules/superagent/node_modules/ms": {
       "version": "2.1.3",
       "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
       "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+      "dev": true,
       "license": "MIT"
     },
-    "node_modules/stack-trace": {
-      "version": "0.0.10",
-      "resolved": "https://registry.npmjs.org/stack-trace/-/stack-trace-0.0.10.tgz",
-      "integrity": "sha512-KGzahc7puUKkzyMt+IqAep+TVNbKP+k2Lmwhub39m1AsTSkaDutx56aDCo+HLDzf/D26BIHTJWNiTG1KAJiQCg==",
+    "node_modules/supertest": {
+      "version": "6.3.4",
+      "resolved": "https://registry.npmjs.org/supertest/-/supertest-6.3.4.tgz",
+      "integrity": "sha512-erY3HFDG0dPnhw4U+udPfrzXa4xhSG+n4rxfRuZWCUvjFWwKl+OxWf/7zk50s84/fAAs7vf5QAb9uRa0cCykxw==",
+      "deprecated": "Please upgrade to supertest v7.1.3+, see release notes at https://github.com/forwardemail/supertest/releases/tag/v7.1.3 - maintenance is supported by Forward Email @ https://forwardemail.net",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "methods": "^1.1.2",
+        "superagent": "^8.1.2"
+      },
       "engines": {
-        "node": "*"
+        "node": ">=6.4.0"
       }
     },
-    "node_modules/statuses": {
-      "version": "2.0.2",
-      "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.2.tgz",
-      "integrity": "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw==",
+    "node_modules/supports-color": {
+      "version": "5.5.0",
+      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-5.5.0.tgz",
+      "integrity": "sha512-QjVjwdXIt408MIiAqCX4oUKsgU2EqAGzs2Ppkm4aQYbjm+ZEWEcW4SfFNTr4uMNZma0ey4f5lgLrkB0aX0QMow==",
+      "dev": true,
       "license": "MIT",
+      "dependencies": {
+        "has-flag": "^3.0.0"
+      },
       "engines": {
-        "node": ">= 0.8"
+        "node": ">=4"
       }
     },
-    "node_modules/streamsearch": {
-      "version": "1.1.0",
-      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
-      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
+    "node_modules/supports-preserve-symlinks-flag": {
+      "version": "1.0.0",
+      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
+      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
+      "dev": true,
+      "license": "MIT",
       "engines": {
-        "node": ">=10.0.0"
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
       }
     },
-    "node_modules/string_decoder": {
-      "version": "1.1.1",
-      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.1.1.tgz",
-      "integrity": "sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==",
-      "license": "MIT",
+    "node_modules/test-exclude": {
+      "version": "6.0.0",
+      "resolved": "https://registry.npmjs.org/test-exclude/-/test-exclude-6.0.0.tgz",
+      "integrity": "sha512-cAGWPIyOHU6zlmg88jwm7VRyXnMN7iV68OGAbYDk/Mh/xC/pzVPlQtY6ngoIH/5/tciuhGfvESU8GrHrcxD56w==",
+      "dev": true,
+      "license": "ISC",
       "dependencies": {
-        "safe-buffer": "~5.1.0"
+        "@istanbuljs/schema": "^0.1.2",
+        "glob": "^7.1.4",
+        "minimatch": "^3.0.4"
+      },
+      "engines": {
+        "node": ">=8"
       }
     },
-    "node_modules/string_decoder/node_modules/safe-buffer": {
-      "version": "5.1.2",
-      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.1.2.tgz",
-      "integrity": "sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==",
+    "node_modules/test-exclude/node_modules/balanced-match": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
+      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
+      "dev": true,
       "license": "MIT"
     },
-    "node_modules/stripe": {
-      "version": "14.25.0",
-      "resolved": "https://registry.npmjs.org/stripe/-/stripe-14.25.0.tgz",
-      "integrity": "sha512-wQS3GNMofCXwH8TSje8E1SE8zr6ODiGtHQgPtO95p9Mb4FhKC9jvXR2NUTpZ9ZINlckJcFidCmaTFV4P6vsb9g==",
+    "node_modules/test-exclude/node_modules/brace-expansion": {
+      "version": "1.1.12",
+      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
+      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
+      "dev": true,
       "license": "MIT",
       "dependencies": {
-        "@types/node": ">=8.1.0",
-        "qs": "^6.11.0"
-      },
-      "engines": {
-        "node": ">=12.*"
+        "balanced-match": "^1.0.0",
+        "concat-map": "0.0.1"
       }
     },
-    "node_modules/supports-color": {
-      "version": "5.5.0",
-      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-5.5.0.tgz",
-      "integrity": "sha512-QjVjwdXIt408MIiAqCX4oUKsgU2EqAGzs2Ppkm4aQYbjm+ZEWEcW4SfFNTr4uMNZma0ey4f5lgLrkB0aX0QMow==",
+    "node_modules/test-exclude/node_modules/minimatch": {
+      "version": "3.1.3",
+      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.3.tgz",
+      "integrity": "sha512-M2GCs7Vk83NxkUyQV1bkABc4yxgz9kILhHImZiBPAZ9ybuvCb0/H7lEl5XvIg3g+9d4eNotkZA5IWwYl0tibaA==",
       "dev": true,
-      "license": "MIT",
+      "license": "ISC",
       "dependencies": {
-        "has-flag": "^3.0.0"
+        "brace-expansion": "^1.1.7"
       },
       "engines": {
-        "node": ">=4"
+        "node": "*"
       }
     },
     "node_modules/text-hex": {
@@ -2225,6 +6513,19 @@
       "integrity": "sha512-uuVGNWzgJ4yhRaNSiubPY7OjISw4sw4E5Uv0wbjp+OzcbmVU/rsT8ujgcXJhn9ypzsgr5vlzpPqP+MBBKcGvbg==",
       "license": "MIT"
     },
+    "node_modules/tiny-inflate": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/tiny-inflate/-/tiny-inflate-1.0.3.tgz",
+      "integrity": "sha512-pkY1fj1cKHb2seWDy0B16HeWyczlJA9/WW3u3c4z/NiWDsO3DOU5D7nhTLE9CF0yXv/QZFY7sEJmj24dK+Rrqw==",
+      "license": "MIT"
+    },
+    "node_modules/tmpl": {
+      "version": "1.0.5",
+      "resolved": "https://registry.npmjs.org/tmpl/-/tmpl-1.0.5.tgz",
+      "integrity": "sha512-3f0uOEAQwIqGuWW2MVzYg8fV/QNnc/IpuJNG837rLuczAaLVHslWHZQj4IGiEl5Hs3kkbhwL9Ab7Hrsmuj+Smw==",
+      "dev": true,
+      "license": "BSD-3-Clause"
+    },
     "node_modules/to-regex-range": {
       "version": "5.0.1",
       "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
@@ -2266,24 +6567,54 @@
         "node": ">= 14.0.0"
       }
     },
+    "node_modules/tslib": {
+      "version": "2.8.1",
+      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
+      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
+      "license": "0BSD"
+    },
     "node_modules/twilio": {
-      "version": "5.12.2",
-      "resolved": "https://registry.npmjs.org/twilio/-/twilio-5.12.2.tgz",
-      "integrity": "sha512-yjTH04Ig0Z3PAxIXhwrto0IJC4Gv7lBDQQ9f4/P9zJhnxVdd+3tENqBMJOtdmmRags3X0jl2IGKEQefCEpJE9g==",
+      "version": "4.23.0",
+      "resolved": "https://registry.npmjs.org/twilio/-/twilio-4.23.0.tgz",
+      "integrity": "sha512-LdNBQfOe0dY2oJH2sAsrxazpgfFQo5yXGxe96QA8UWB5uu+433PrUbkv8gQ5RmrRCqUTPQ0aOrIyAdBr1aB03Q==",
       "license": "MIT",
       "dependencies": {
-        "axios": "^1.12.0",
+        "axios": "^1.6.0",
         "dayjs": "^1.11.9",
         "https-proxy-agent": "^5.0.0",
-        "jsonwebtoken": "^9.0.2",
-        "qs": "^6.14.1",
+        "jsonwebtoken": "^9.0.0",
+        "qs": "^6.9.4",
         "scmp": "^2.1.0",
+        "url-parse": "^1.5.9",
         "xmlbuilder": "^13.0.2"
       },
       "engines": {
         "node": ">=14.0"
       }
     },
+    "node_modules/type-detect": {
+      "version": "4.0.8",
+      "resolved": "https://registry.npmjs.org/type-detect/-/type-detect-4.0.8.tgz",
+      "integrity": "sha512-0fr/mIH1dlO+x7TlcMy+bIDqKPsw/70tVyeHW787goQjhmqaZe10uwLujubK9q9Lg6Fiho1KUKDYz0Z7k7g5/g==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=4"
+      }
+    },
+    "node_modules/type-fest": {
+      "version": "0.21.3",
+      "resolved": "https://registry.npmjs.org/type-fest/-/type-fest-0.21.3.tgz",
+      "integrity": "sha512-t0rzBq87m3fVcduHDUFhKmyyX+9eo6WQjZvf51Ea/M0Q7+T374Jp1aUiyUl0GKxp8M/OETVHSDvmkyPgvX+X2w==",
+      "dev": true,
+      "license": "(MIT OR CC0-1.0)",
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
     "node_modules/type-is": {
       "version": "1.6.18",
       "resolved": "https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz",
@@ -2316,6 +6647,26 @@
       "integrity": "sha512-AsuCzffGHJybSaRrmr5eHr81mwJU3kjw6M+uprWvCXiNeN9SOGwQ3Jn8jb8m3Z6izVgknn1R0FTCEAP2QrLY/w==",
       "license": "MIT"
     },
+    "node_modules/unicode-properties": {
+      "version": "1.4.1",
+      "resolved": "https://registry.npmjs.org/unicode-properties/-/unicode-properties-1.4.1.tgz",
+      "integrity": "sha512-CLjCCLQ6UuMxWnbIylkisbRj31qxHPAurvena/0iwSVbQ2G1VY5/HjV0IRabOEbDHlzZlRdCrD4NhB0JtU40Pg==",
+      "license": "MIT",
+      "dependencies": {
+        "base64-js": "^1.3.0",
+        "unicode-trie": "^2.0.0"
+      }
+    },
+    "node_modules/unicode-trie": {
+      "version": "2.0.0",
+      "resolved": "https://registry.npmjs.org/unicode-trie/-/unicode-trie-2.0.0.tgz",
+      "integrity": "sha512-x7bc76x0bm4prf1VLg79uhAzKw8DVboClSN5VxJuQ+LKDOVEW9CdH+VY7SP+vX7xCYQqzzgQpFqz15zeLvAtZQ==",
+      "license": "MIT",
+      "dependencies": {
+        "pako": "^0.2.5",
+        "tiny-inflate": "^1.0.0"
+      }
+    },
     "node_modules/unpipe": {
       "version": "1.0.0",
       "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
@@ -2325,6 +6676,47 @@
         "node": ">= 0.8"
       }
     },
+    "node_modules/update-browserslist-db": {
+      "version": "1.2.3",
+      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
+      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
+      "dev": true,
+      "funding": [
+        {
+          "type": "opencollective",
+          "url": "https://opencollective.com/browserslist"
+        },
+        {
+          "type": "tidelift",
+          "url": "https://tidelift.com/funding/github/npm/browserslist"
+        },
+        {
+          "type": "github",
+          "url": "https://github.com/sponsors/ai"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "escalade": "^3.2.0",
+        "picocolors": "^1.1.1"
+      },
+      "bin": {
+        "update-browserslist-db": "cli.js"
+      },
+      "peerDependencies": {
+        "browserslist": ">= 4.21.0"
+      }
+    },
+    "node_modules/url-parse": {
+      "version": "1.5.10",
+      "resolved": "https://registry.npmjs.org/url-parse/-/url-parse-1.5.10.tgz",
+      "integrity": "sha512-WypcfiRhfeUP9vvF0j6rw0J3hrWrw6iZv3+22h6iRMJ/8z1Tj6XfLP4DsUix5MhMPnXpiHDoKyoZ/bdCkwBCiQ==",
+      "license": "MIT",
+      "dependencies": {
+        "querystringify": "^2.1.1",
+        "requires-port": "^1.0.0"
+      }
+    },
     "node_modules/util-deprecate": {
       "version": "1.0.2",
       "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
@@ -2353,6 +6745,21 @@
         "uuid": "dist/bin/uuid"
       }
     },
+    "node_modules/v8-to-istanbul": {
+      "version": "9.3.0",
+      "resolved": "https://registry.npmjs.org/v8-to-istanbul/-/v8-to-istanbul-9.3.0.tgz",
+      "integrity": "sha512-kiGUalWN+rgBJ/1OHZsBtU4rXZOfj/7rKQxULKlIzwzQSvMJUUNgPwJEEh7gU6xEVxC0ahoOBvN2YI8GH6FNgA==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "@jridgewell/trace-mapping": "^0.3.12",
+        "@types/istanbul-lib-coverage": "^2.0.1",
+        "convert-source-map": "^2.0.0"
+      },
+      "engines": {
+        "node": ">=10.12.0"
+      }
+    },
     "node_modules/vary": {
       "version": "1.1.2",
       "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
@@ -2362,6 +6769,16 @@
         "node": ">= 0.8"
       }
     },
+    "node_modules/walker": {
+      "version": "1.0.8",
+      "resolved": "https://registry.npmjs.org/walker/-/walker-1.0.8.tgz",
+      "integrity": "sha512-ts/8E8l5b7kY0vlWLewOkDXMmPdLcVV4GmOQLyxuSswIJsweeFZtAsMF7k1Nszz+TYBQrlYRmzOnr398y1JemQ==",
+      "dev": true,
+      "license": "Apache-2.0",
+      "dependencies": {
+        "makeerror": "1.0.12"
+      }
+    },
     "node_modules/web-push": {
       "version": "3.6.7",
       "resolved": "https://registry.npmjs.org/web-push/-/web-push-3.6.7.tgz",
@@ -2426,6 +6843,80 @@
       "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
       "license": "MIT"
     },
+    "node_modules/which": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
+      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "isexe": "^2.0.0"
+      },
+      "bin": {
+        "node-which": "bin/node-which"
+      },
+      "engines": {
+        "node": ">= 8"
+      }
+    },
+    "node_modules/which-boxed-primitive": {
+      "version": "1.1.1",
+      "resolved": "https://registry.npmjs.org/which-boxed-primitive/-/which-boxed-primitive-1.1.1.tgz",
+      "integrity": "sha512-TbX3mj8n0odCBFVlY8AxkqcHASw3L60jIuF8jFP78az3C2YhmGvqbHBpAjTRH2/xqYunrJ9g1jSyjCjpoWzIAA==",
+      "license": "MIT",
+      "dependencies": {
+        "is-bigint": "^1.1.0",
+        "is-boolean-object": "^1.2.1",
+        "is-number-object": "^1.1.1",
+        "is-string": "^1.1.1",
+        "is-symbol": "^1.1.1"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/which-collection": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/which-collection/-/which-collection-1.0.2.tgz",
+      "integrity": "sha512-K4jVyjnBdgvc86Y6BkaLZEN933SwYOuBFkdmBu9ZfkcAbdVbpITnDmjvZ/aQjRXQrv5EPkTnD1s39GiiqbngCw==",
+      "license": "MIT",
+      "dependencies": {
+        "is-map": "^2.0.3",
+        "is-set": "^2.0.3",
+        "is-weakmap": "^2.0.2",
+        "is-weakset": "^2.0.3"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
+    "node_modules/which-typed-array": {
+      "version": "1.1.20",
+      "resolved": "https://registry.npmjs.org/which-typed-array/-/which-typed-array-1.1.20.tgz",
+      "integrity": "sha512-LYfpUkmqwl0h9A2HL09Mms427Q1RZWuOHsukfVcKRq9q95iQxdw0ix1JQrqbcDR9PH1QDwf5Qo8OZb5lksZ8Xg==",
+      "license": "MIT",
+      "dependencies": {
+        "available-typed-arrays": "^1.0.7",
+        "call-bind": "^1.0.8",
+        "call-bound": "^1.0.4",
+        "for-each": "^0.3.5",
+        "get-proto": "^1.0.1",
+        "gopd": "^1.2.0",
+        "has-tostringtag": "^1.0.2"
+      },
+      "engines": {
+        "node": ">= 0.4"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/ljharb"
+      }
+    },
     "node_modules/winston": {
       "version": "3.19.0",
       "resolved": "https://registry.npmjs.org/winston/-/winston-3.19.0.tgz",
@@ -2490,6 +6981,45 @@
         "node": ">= 6"
       }
     },
+    "node_modules/wrap-ansi": {
+      "version": "7.0.0",
+      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
+      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "ansi-styles": "^4.0.0",
+        "string-width": "^4.1.0",
+        "strip-ansi": "^6.0.0"
+      },
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
+      }
+    },
+    "node_modules/wrappy": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
+      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/write-file-atomic": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/write-file-atomic/-/write-file-atomic-4.0.2.tgz",
+      "integrity": "sha512-7KxauUdBmSdWnmpaGFg+ppNjKF8uNLry8LyzjauQDOVONfFLNKrKvQOxZ/VuTIcS/gge/YNahf5RIIQWTSarlg==",
+      "dev": true,
+      "license": "ISC",
+      "dependencies": {
+        "imurmurhash": "^0.1.4",
+        "signal-exit": "^3.0.7"
+      },
+      "engines": {
+        "node": "^12.13.0 || ^14.15.0 || >=16.0.0"
+      }
+    },
     "node_modules/ws": {
       "version": "8.18.3",
       "resolved": "https://registry.npmjs.org/ws/-/ws-8.18.3.tgz",
@@ -2529,6 +7059,65 @@
         "node": ">=0.4"
       }
     },
+    "node_modules/y18n": {
+      "version": "5.0.8",
+      "resolved": "https://registry.npmjs.org/y18n/-/y18n-5.0.8.tgz",
+      "integrity": "sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==",
+      "dev": true,
+      "license": "ISC",
+      "engines": {
+        "node": ">=10"
+      }
+    },
+    "node_modules/yallist": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
+      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
+      "dev": true,
+      "license": "ISC"
+    },
+    "node_modules/yargs": {
+      "version": "17.7.2",
+      "resolved": "https://registry.npmjs.org/yargs/-/yargs-17.7.2.tgz",
+      "integrity": "sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==",
+      "dev": true,
+      "license": "MIT",
+      "dependencies": {
+        "cliui": "^8.0.1",
+        "escalade": "^3.1.1",
+        "get-caller-file": "^2.0.5",
+        "require-directory": "^2.1.1",
+        "string-width": "^4.2.3",
+        "y18n": "^5.0.5",
+        "yargs-parser": "^21.1.1"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/yargs-parser": {
+      "version": "21.1.1",
+      "resolved": "https://registry.npmjs.org/yargs-parser/-/yargs-parser-21.1.1.tgz",
+      "integrity": "sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==",
+      "dev": true,
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/yocto-queue": {
+      "version": "0.1.0",
+      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
+      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
+      "dev": true,
+      "license": "MIT",
+      "engines": {
+        "node": ">=10"
+      },
+      "funding": {
+        "url": "https://github.com/sponsors/sindresorhus"
+      }
+    },
     "node_modules/zod": {
       "version": "3.25.76",
       "resolved": "https://registry.npmjs.org/zod/-/zod-3.25.76.tgz",
diff --git a/templates/crm-homecare/backend/package.json b/templates/crm-homecare/backend/package.json
index a833536..2c11935 100644
--- a/templates/crm-homecare/backend/package.json
+++ b/templates/crm-homecare/backend/package.json
@@ -1,42 +1,45 @@
 {
-  "name": "twomiah-care-api",
-  "version": "1.0.0",
-  "type": "module",
+  "name": "chippewa-home-care-backend",
   "scripts": {
-    "dev": "nodemon src/index.js",
-    "start": "node src/index.js",
-    "db:generate": "prisma generate",
-    "db:migrate": "prisma migrate dev",
-    "db:push": "prisma db push",
-    "db:seed": "node prisma/seed.js",
-    "db:reset": "prisma db push --force-reset && npm run db:seed"
+    "start": "node src/server.js",
+    "dev": "nodemon src/server.js",
+    "test": "jest --testPathPattern=tests/ --forceExit --detectOpenHandles",
+    "test:watch": "jest --watch",
+    "test:coverage": "jest --coverage"
   },
-  "prisma": {
-    "seed": "node prisma/seed.js"
+  "jest": {
+    "testEnvironment": "node",
+    "testTimeout": 10000
   },
   "dependencies": {
-    "@prisma/client": "^5.10.0",
-    "@sendgrid/mail": "^8.1.0",
     "bcryptjs": "^2.4.3",
-    "cookie-parser": "^1.4.6",
-    "cors": "^2.8.5",
-    "dotenv": "^16.4.5",
-    "express": "^4.18.3",
-    "express-rate-limit": "^7.2.0",
-    "helmet": "^7.1.0",
-    "jsonwebtoken": "^9.0.2",
+    "compression": "^1.7.4",
+    "cors": "2.8.5",
+    "date-fns": "2.30.0",
+    "dotenv": "16.0.3",
+    "express": "^4.22.1",
+    "express-rate-limit": "^6.7.0",
+    "helmet": "^7.0.0",
+    "json2csv": "5.0.7",
+    "jsonwebtoken": "^9.0.3",
     "multer": "^1.4.5-lts.1",
-    "nodemailer": "^6.9.12",
-    "socket.io": "^4.7.4",
-    "stripe": "^14.25.0",
-    "twilio": "^5.0.0",
-    "uuid": "^9.0.1",
-    "web-push": "^3.6.7",
+    "papaparse": "5.4.1",
+    "pdfkit": "^0.12.3",
+    "stripe": "^12.0.0",
+    "twilio": "^4.0.0",
+    "uuid": "^9.0.0",
+    "web-push": "^3.6.6",
+    "cookie-parser": "^1.4.6",
+    "socket.io": "^4.7.2",
     "winston": "^3.11.0",
-    "zod": "^3.22.4"
+    "zod": "^3.22.4",
+    "@prisma/client": "^5.22.0"
   },
   "devDependencies": {
-    "nodemon": "^3.1.0",
-    "prisma": "^5.10.0"
-  }
-}
+    "jest": "^29.7.0",
+    "nodemon": "^3.1.11",
+    "supertest": "^6.3.4",
+    "prisma": "^5.22.0"
+  },
+  "type": "module"
+}
\ No newline at end of file
diff --git a/templates/crm-homecare/backend/src/db.js b/templates/crm-homecare/backend/src/db.js
new file mode 100644
index 0000000..0d0e77f
--- /dev/null
+++ b/templates/crm-homecare/backend/src/db.js
@@ -0,0 +1,45 @@
+// src/db.js
+// Shared database connection pool
+const { Pool } = require('pg');
+require('dotenv').config();
+
+const pool = new Pool({
+  connectionString: process.env.DATABASE_URL,
+  ssl: { rejectUnauthorized: false },
+  max: 20,                   // max simultaneous connections
+  idleTimeoutMillis: 30000,  // close idle connections after 30s
+  connectionTimeoutMillis: 5000, // fail fast if can't connect within 5s
+});
+
+// Test connection on startup
+pool.query('SELECT NOW()', (err, res) => {
+  if (err) {
+    console.error('❌ Database connection failed:', err);
+  } else {
+    console.log('✅ Database connected:', res.rows[0].now);
+  }
+});
+
+// Helper for audit logging
+const auditLog = async (userId, action, tableName, recordId, oldData, newData) => {
+  try {
+    if (recordId && typeof recordId === 'string' && !recordId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)) {
+      console.warn('Skipping audit log: invalid recordId format:', recordId);
+      return;
+    }
+    
+    await pool.query(
+      `INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data, created_at)
+       VALUES ($1, $2, $3, $4, $5, $6, NOW())`,
+      [userId || '00000000-0000-0000-0000-000000000000', action, tableName, recordId, JSON.stringify(oldData), JSON.stringify(newData)]
+    );
+  } catch (error) {
+    console.error('Audit log database error:', error.message);
+  }
+};
+
+module.exports = {
+  pool,
+  query: (text, params) => pool.query(text, params),
+  auditLog
+};
diff --git a/templates/crm-homecare/backend/src/middleware/auditLogger.js b/templates/crm-homecare/backend/src/middleware/auditLogger.js
new file mode 100644
index 0000000..28d75f7
--- /dev/null
+++ b/templates/crm-homecare/backend/src/middleware/auditLogger.js
@@ -0,0 +1,264 @@
+// src/middleware/auditLogger.js
+/**
+ * HIPAA-Compliant Audit Logger
+ * - Every action has an actor (user or SYSTEM)
+ * - Flags sensitive PHI access
+ * - Detects suspicious activity patterns
+ */
+
+const SYSTEM_USER_ID = '00000000-0000-0000-0000-000000000000';
+
+// Tables/actions containing PHI or sensitive data
+const SENSITIVE_TABLES = [
+  'clients',
+  'care_plans',
+  'visits',
+  'medical_records',
+  'medications',
+  'diagnoses',
+  'emergency_contacts',
+  'insurance',
+  'billing',
+  'invoices',
+  'payments',
+  'documents'
+];
+
+const SENSITIVE_ACTIONS = [
+  'export',
+  'download',
+  'bulk',
+  'delete',
+  'password',
+  'login',
+  'role'
+];
+
+const auditLogger = (pool) => {
+
+  // Check if operation involves PHI or sensitive data
+  const isSensitiveOperation = (table_name, action, req_body) => {
+    // Table contains PHI
+    if (SENSITIVE_TABLES.some(t => table_name?.toLowerCase().includes(t))) {
+      return true;
+    }
+    
+    // Action is sensitive
+    if (SENSITIVE_ACTIONS.some(a => action?.toLowerCase().includes(a))) {
+      return true;
+    }
+    
+    // Body contains sensitive fields
+    const sensitiveFields = ['ssn', 'social_security', 'diagnosis', 'medication', 'medical', 'insurance', 'dob', 'date_of_birth'];
+    if (req_body) {
+      const bodyStr = JSON.stringify(req_body).toLowerCase();
+      if (sensitiveFields.some(f => bodyStr.includes(f))) {
+        return true;
+      }
+    }
+    
+    return false;
+  };
+
+  // Detect suspicious activity patterns
+  const checkSuspiciousActivity = async (user_id, action, table_name, ip_address) => {
+    try {
+      // Skip for system user
+      if (user_id === SYSTEM_USER_ID) return null;
+
+      const alerts = [];
+      const now = new Date();
+      const oneHourAgo = new Date(now - 60 * 60 * 1000);
+      const fiveMinutesAgo = new Date(now - 5 * 60 * 1000);
+
+      // Check 1: Bulk data access (>20 records in 5 minutes)
+      const bulkCheck = await pool.query(
+        `SELECT COUNT(*) as count FROM audit_logs 
+         WHERE user_id = $1 
+         AND created_at > $2 
+         AND action LIKE '%GET%'`,
+        [user_id, fiveMinutesAgo]
+      );
+      if (parseInt(bulkCheck.rows[0]?.count) > 20) {
+        alerts.push('BULK_ACCESS: High volume data retrieval detected');
+      }
+
+      // Check 2: After-hours access (before 6am or after 10pm)
+      const hour = now.getHours();
+      if (hour < 6 || hour > 22) {
+        alerts.push('AFTER_HOURS: Access outside normal business hours');
+      }
+
+      // Check 3: Multiple failed actions (>5 in 5 minutes)
+      const failCheck = await pool.query(
+        `SELECT COUNT(*) as count FROM audit_logs 
+         WHERE user_id = $1 
+         AND created_at > $2 
+         AND action LIKE '%fail%'`,
+        [user_id, fiveMinutesAgo]
+      );
+      if (parseInt(failCheck.rows[0]?.count) > 5) {
+        alerts.push('MULTIPLE_FAILURES: Repeated failed operations');
+      }
+
+      // Check 4: Accessing many different client records (>10 in 1 hour)
+      const clientCheck = await pool.query(
+        `SELECT COUNT(DISTINCT record_id) as count FROM audit_logs 
+         WHERE user_id = $1 
+         AND created_at > $2 
+         AND table_name = 'clients'`,
+        [user_id, oneHourAgo]
+      );
+      if (parseInt(clientCheck.rows[0]?.count) > 10) {
+        alerts.push('UNUSUAL_ACCESS: Accessing unusually high number of client records');
+      }
+
+      // Check 5: IP address change mid-session
+      const ipCheck = await pool.query(
+        `SELECT DISTINCT ip_address FROM audit_logs 
+         WHERE user_id = $1 
+         AND created_at > $2 
+         AND ip_address IS NOT NULL`,
+        [user_id, oneHourAgo]
+      );
+      if (ipCheck.rows.length > 2) {
+        alerts.push('IP_CHANGE: Multiple IP addresses detected for same user');
+      }
+
+      // Check 6: Sensitive data export
+      if (action?.toLowerCase().includes('export') || action?.toLowerCase().includes('download')) {
+        if (SENSITIVE_TABLES.some(t => table_name?.toLowerCase().includes(t))) {
+          alerts.push('PHI_EXPORT: Sensitive data export detected');
+        }
+      }
+
+      // Log alerts if any
+      if (alerts.length > 0) {
+        console.warn(`⚠️ SECURITY ALERT - User ${user_id}:`, alerts);
+        
+        // Log the alert itself
+        await pool.query(
+          `INSERT INTO audit_logs (user_id, action, table_name, record_id, new_data, ip_address, is_sensitive)
+           VALUES ($1, $2, $3, $4, $5, $6, $7)`,
+          [
+            SYSTEM_USER_ID,
+            'SECURITY_ALERT',
+            'audit_logs',
+            null,
+            JSON.stringify({ user_id, alerts, original_action: action }),
+            ip_address,
+            true
+          ]
+        );
+      }
+
+      return alerts.length > 0 ? alerts : null;
+
+    } catch (err) {
+      console.error('Suspicious activity check failed:', err.message);
+      return null;
+    }
+  };
+
+  // Direct logging function for non-request events
+  const log = async ({ 
+    user_id = SYSTEM_USER_ID, 
+    action, 
+    table_name, 
+    record_id = null, 
+    old_data = null, 
+    new_data = null, 
+    ip_address = null 
+  }) => {
+    try {
+      const is_sensitive = isSensitiveOperation(table_name, action, new_data);
+
+      await pool.query(
+        `INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data, ip_address, is_sensitive)
+         VALUES ($1, $2, $3, $4, $5, $6, $7, $8)`,
+        [
+          user_id || SYSTEM_USER_ID,
+          action,
+          table_name,
+          record_id,
+          old_data ? JSON.stringify(old_data) : null,
+          new_data ? JSON.stringify(new_data) : null,
+          ip_address,
+          is_sensitive
+        ]
+      );
+
+      // Check for suspicious activity on sensitive operations
+      if (is_sensitive && user_id !== SYSTEM_USER_ID) {
+        await checkSuspiciousActivity(user_id, action, table_name, ip_address);
+      }
+
+    } catch (err) {
+      console.error('Audit insert failed:', err.message);
+    }
+  };
+
+  // Middleware for HTTP requests
+  const middleware = async (req, res, next) => {
+    // Skip GET requests for logging, but still check suspicious activity
+    if (req.method === 'GET') {
+      const user_id = req.user?.id || req.user?.userId;
+      if (user_id) {
+        const table_name = extractTableName(req.path);
+        // Check suspicious activity for sensitive GETs
+        if (isSensitiveOperation(table_name, 'GET', null)) {
+          checkSuspiciousActivity(user_id, `GET ${req.path}`, table_name, req.ip);
+        }
+      }
+      return next();
+    }
+
+    const originalJson = res.json;
+    
+    res.json = function(data) {
+      res.on('finish', async () => {
+        if (res.statusCode < 400) {
+          const user_id = req.user?.id || req.user?.userId || SYSTEM_USER_ID;
+          const table_name = extractTableName(req.path);
+          const record_id = req.params?.id || data?.id || null;
+          const ip_address = req.ip || req.headers['x-forwarded-for'] || 'unknown';
+          
+          await log({
+            user_id,
+            action: `${req.method} ${req.path}`,
+            table_name,
+            record_id,
+            old_data: null,
+            new_data: req.body,
+            ip_address
+          });
+        }
+      });
+      return originalJson.call(this, data);
+    };
+
+    next();
+  };
+
+  // Extract table name from path
+  const extractTableName = (path) => {
+    const parts = path.split('/').filter(Boolean);
+    for (let i = parts.length - 1; i >= 0; i--) {
+      const part = parts[i];
+      if (part !== 'api' && part !== 'admin' && !/^[0-9a-f-]+$/i.test(part)) {
+        return part;
+      }
+    }
+    return 'unknown';
+  };
+
+  // Attach functions for direct access
+  middleware.log = log;
+  middleware.SYSTEM_USER_ID = SYSTEM_USER_ID;
+  middleware.isSensitiveOperation = isSensitiveOperation;
+  middleware.checkSuspiciousActivity = checkSuspiciousActivity;
+
+  return middleware;
+};
+
+module.exports = auditLogger;
diff --git a/templates/crm-homecare/backend/src/middleware/auth.js b/templates/crm-homecare/backend/src/middleware/auth.js
index e3a0db4..7cc3a11 100644
--- a/templates/crm-homecare/backend/src/middleware/auth.js
+++ b/templates/crm-homecare/backend/src/middleware/auth.js
@@ -1,49 +1,29 @@
 import jwt from 'jsonwebtoken';
-import { prisma } from '../index.js';
 
-export const authenticate = async (req, res, next) => {
-  try {
-    const authHeader = req.headers.authorization;
-    if (!authHeader?.startsWith('Bearer ')) {
-      return res.status(401).json({ error: 'No token provided' });
-    }
+export const authenticate = (req, res, next) => {
+  const authHeader = req.headers['authorization'];
+  const token = authHeader && authHeader.split(' ')[1];
+  if (!token) return res.status(401).json({ error: 'Access token required' });
 
-    const token = authHeader.split(' ')[1];
+  try {
     const decoded = jwt.verify(token, process.env.JWT_SECRET);
-
-    const user = await prisma.user.findUnique({
-      where: { id: decoded.userId },
-      select: { id: true, email: true, role: true, isActive: true, firstName: true, lastName: true },
-    });
-
-    if (!user || !user.isActive) {
-      return res.status(401).json({ error: 'User not found or inactive' });
-    }
-
-    req.user = { userId: user.id, email: user.email, role: user.role, firstName: user.firstName, lastName: user.lastName };
+    req.user = decoded;
     next();
-  } catch (error) {
-    if (error.name === 'TokenExpiredError') {
-      return res.status(401).json({ error: 'Token expired' });
-    }
-    return res.status(401).json({ error: 'Invalid token' });
+  } catch (err) {
+    return res.status(403).json({ error: 'Invalid or expired token' });
   }
 };
 
-export const requireRole = (...roles) => (req, res, next) => {
-  if (!req.user) return res.status(401).json({ error: 'Not authenticated' });
-  if (!roles.includes(req.user.role)) return res.status(403).json({ error: 'Insufficient permissions' });
+export const requireAdmin = (req, res, next) => {
+  if (!req.user || req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
   next();
 };
 
-export const requireAdmin = requireRole('admin', 'billing');
-export const adminOnly = requireRole('admin');
-
-// Log auth events (HIPAA requirement)
-export const logAuthEvent = async (prisma, { email, userId, success, ipAddress, userAgent, failReason }) => {
-  try {
-    await prisma.loginActivity.create({
-      data: { email, userId, success, ipAddress, userAgent, failReason },
-    });
-  } catch (_) { /* non-blocking */ }
+export const logAuthEvent = (req, res, next) => {
+  // Placeholder - can be wired to audit log later
+  next();
 };
+
+export default authenticate;
diff --git a/templates/crm-homecare/backend/src/middleware/authorizeAdmin.js b/templates/crm-homecare/backend/src/middleware/authorizeAdmin.js
new file mode 100644
index 0000000..c3d980e
--- /dev/null
+++ b/templates/crm-homecare/backend/src/middleware/authorizeAdmin.js
@@ -0,0 +1,9 @@
+// src/middleware/authorizeAdmin.js
+const authorizeAdmin = (req, res, next) => {
+  if (req.user?.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+  next();
+};
+
+module.exports = authorizeAdmin;
diff --git a/templates/crm-homecare/backend/src/middleware/shared.js b/templates/crm-homecare/backend/src/middleware/shared.js
new file mode 100644
index 0000000..292c8bf
--- /dev/null
+++ b/templates/crm-homecare/backend/src/middleware/shared.js
@@ -0,0 +1,40 @@
+// middleware/shared.js
+// Shared helpers re-used across all route files
+
+const jwt = require('jsonwebtoken');
+const db = require('../db');
+
+const verifyToken = (req, res, next) => {
+  const token = req.headers.authorization?.split(' ')[1];
+  if (!token) return res.status(401).json({ error: 'No token provided' });
+  if (!process.env.JWT_SECRET) {
+    console.error('FATAL: JWT_SECRET not set');
+    return res.status(500).json({ error: 'Server configuration error' });
+  }
+  try {
+    req.user = jwt.verify(token, process.env.JWT_SECRET);
+    next();
+  } catch {
+    return res.status(401).json({ error: 'Invalid token' });
+  }
+};
+
+const requireAdmin = (req, res, next) => {
+  if (req.user?.role !== 'admin') return res.status(403).json({ error: 'Admin access required' });
+  next();
+};
+
+const auditLog = async (userId, action, tableName, recordId, oldData, newData) => {
+  try {
+    if (recordId && typeof recordId === 'string' && !recordId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)) return;
+    await db.query(
+      `INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data, created_at)
+       VALUES ($1, $2, $3, $4, $5, $6, NOW())`,
+      [userId || '00000000-0000-0000-0000-000000000000', action, tableName, recordId, JSON.stringify(oldData), JSON.stringify(newData)]
+    );
+  } catch (e) {
+    console.error('Audit log error:', e.message);
+  }
+};
+
+module.exports = { verifyToken, requireAdmin, auditLog };
diff --git a/templates/crm-homecare/backend/src/routes/absenceRoutes.js b/templates/crm-homecare/backend/src/routes/absenceRoutes.js
new file mode 100644
index 0000000..a8ec6c8
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/absenceRoutes.js
@@ -0,0 +1,72 @@
+// routes/absenceRoutes.js — mounted at /api via app.use('/api', absenceRoutes)
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── ABSENCES ─────────────────────────────────────────────────────────────────
+
+router.post('/absences', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, date, type, reason } = req.body;
+    if (!caregiverId || !date || !type) return res.status(400).json({ error: 'caregiverId, date, and type are required' });
+    const absenceId = uuidv4();
+    const result = await db.query(`INSERT INTO absences (id, caregiver_id, date, type, reason, reported_by, coverage_needed, created_at) VALUES ($1,$2,$3,$4,$5,$6,$7,NOW()) RETURNING *`, [absenceId, caregiverId, date, type, reason||null, req.user.id, true]);
+    await auditLog(req.user.id, 'CREATE', 'absences', absenceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT type, COUNT(*) as count, DATE_TRUNC('month', date)::DATE as month FROM absences GROUP BY type, DATE_TRUNC('month', date) ORDER BY month DESC, type`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences/caregiver/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM absences WHERE caregiver_id=$1 ORDER BY date DESC`, [req.params.caregiverId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { type, startDate, endDate } = req.query;
+    let query = `SELECT a.*, u.first_name, u.last_name FROM absences a JOIN users u ON a.caregiver_id=u.id WHERE 1=1`;
+    const params = [];
+    if (type) { params.push(type); query += ` AND a.type=$${params.length}`; }
+    if (startDate) { params.push(startDate); query += ` AND a.date>=$${params.length}`; }
+    if (endDate) { params.push(endDate); query += ` AND a.date<=$${params.length}`; }
+    query += ` ORDER BY a.date DESC`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/absences/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { date, type, reason, coverageAssignedTo } = req.body;
+    const updates = [], params = [];
+    let i = 1;
+    if (date) { updates.push(`date=$${i++}`); params.push(date); }
+    if (type) { updates.push(`type=$${i++}`); params.push(type); }
+    if (reason) { updates.push(`reason=$${i++}`); params.push(reason); }
+    if (coverageAssignedTo) { updates.push(`coverage_assigned_to=$${i++}`); params.push(coverageAssignedTo); }
+    if (updates.length === 0) return res.status(400).json({ error: 'No fields to update' });
+    params.push(req.params.id);
+    const result = await db.query(`UPDATE absences SET ${updates.join(', ')} WHERE id=$${i} RETURNING *`, params);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Absence not found' });
+    await auditLog(req.user.id, 'UPDATE', 'absences', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/absences/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM absences WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Absence not found' });
+    await auditLog(req.user.id, 'DELETE', 'absences', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Absence deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/adlRoutes.js b/templates/crm-homecare/backend/src/routes/adlRoutes.js
new file mode 100644
index 0000000..0686afa
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/adlRoutes.js
@@ -0,0 +1,185 @@
+// routes/adlRoutes.js
+// ADL (Activities of Daily Living) Tracking
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// ==================== REQUIREMENTS ====================
+
+// Get client's ADL requirements
+router.get('/client/:clientId/requirements', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT * FROM client_adl_requirements
+      WHERE client_id = $1
+      ORDER BY adl_category
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Add ADL requirement
+router.post('/requirements', auth, async (req, res) => {
+  const { clientId, adlCategory, assistanceLevel, frequency, specialInstructions } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO client_adl_requirements (client_id, adl_category, assistance_level, frequency, special_instructions)
+      VALUES ($1, $2, $3, $4, $5)
+      RETURNING *
+    `, [clientId, adlCategory, assistanceLevel, frequency, specialInstructions]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update ADL requirement
+router.put('/requirements/:id', auth, async (req, res) => {
+  const { assistanceLevel, frequency, specialInstructions } = req.body;
+  
+  try {
+    const result = await db.query(`
+      UPDATE client_adl_requirements SET
+        assistance_level = COALESCE($1, assistance_level),
+        frequency = COALESCE($2, frequency),
+        special_instructions = COALESCE($3, special_instructions),
+        updated_at = NOW()
+      WHERE id = $4
+      RETURNING *
+    `, [assistanceLevel, frequency, specialInstructions, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete ADL requirement
+router.delete('/requirements/:id', auth, async (req, res) => {
+  try {
+    await db.query('DELETE FROM client_adl_requirements WHERE id = $1', [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== LOGS ====================
+
+// Get ADL logs for a client (with date range)
+router.get('/client/:clientId/logs', auth, async (req, res) => {
+  const { startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT al.*, 
+        cp.first_name as caregiver_first, cp.last_name as caregiver_last
+      FROM adl_logs al
+      LEFT JOIN caregiver_profiles cp ON al.caregiver_id = cp.id
+      WHERE al.client_id = $1
+    `;
+    const params = [req.params.clientId];
+
+    if (startDate) {
+      params.push(startDate);
+      query += ` AND al.performed_at >= $${params.length}::date`;
+    }
+    if (endDate) {
+      params.push(endDate);
+      query += ` AND al.performed_at <= ($${params.length}::date + INTERVAL '1 day')`;
+    }
+
+    query += ` ORDER BY al.performed_at DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Log ADL activity
+router.post('/log', auth, async (req, res) => {
+  const { clientId, adlCategory, status, assistanceLevel, performedAt, notes } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO adl_logs (client_id, caregiver_id, adl_category, status, assistance_level, performed_at, notes)
+      VALUES ($1, $2, $3, $4, $5, $6, $7)
+      RETURNING *
+    `, [clientId, req.user.caregiverId || req.user.id, adlCategory, status, assistanceLevel, performedAt || new Date(), notes]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get ADL logs for a time entry (visit)
+router.get('/logs/time-entry/:timeEntryId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT al.*, cp.first_name as caregiver_first, cp.last_name as caregiver_last
+      FROM adl_logs al
+      LEFT JOIN caregiver_profiles cp ON al.caregiver_id = cp.id
+      WHERE al.time_entry_id = $1
+      ORDER BY al.performed_at
+    `, [req.params.timeEntryId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== REPORTS ====================
+
+// ADL completion report for a client
+router.get('/reports/completion/:clientId', auth, async (req, res) => {
+  const { startDate, endDate } = req.query;
+  try {
+    const result = await db.query(`
+      SELECT 
+        al.adl_category,
+        COUNT(*) as total_entries,
+        COUNT(*) FILTER (WHERE al.status = 'completed') as completed_count,
+        COUNT(*) FILTER (WHERE al.status = 'partial') as partial_count,
+        COUNT(*) FILTER (WHERE al.status = 'refused') as refused_count,
+        COUNT(*) FILTER (WHERE al.status = 'not_needed') as not_needed_count
+      FROM adl_logs al
+      WHERE al.client_id = $1
+      AND al.performed_at >= COALESCE($2::date, CURRENT_DATE - INTERVAL '30 days')
+      AND al.performed_at <= COALESCE($3::date, CURRENT_DATE) + INTERVAL '1 day'
+      GROUP BY al.adl_category
+      ORDER BY al.adl_category
+    `, [req.params.clientId, startDate, endDate]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== LEGACY ENDPOINTS ====================
+
+// Get ADL categories (static list since frontend has them)
+router.get('/categories', auth, async (req, res) => {
+  res.json([
+    { id: 'bathing', name: 'Bathing', icon: '🛁' },
+    { id: 'dressing', name: 'Dressing', icon: '👕' },
+    { id: 'grooming', name: 'Grooming', icon: '💇' },
+    { id: 'feeding', name: 'Feeding/Eating', icon: '🍽️' },
+    { id: 'toileting', name: 'Toileting', icon: '🚽' },
+    { id: 'transferring', name: 'Transferring', icon: '🧑‍🦽' },
+    { id: 'mobility', name: 'Mobility', icon: '🚶' },
+    { id: 'medication', name: 'Medication Reminders', icon: '💊' },
+    { id: 'housekeeping', name: 'Light Housekeeping', icon: '🧹' },
+    { id: 'laundry', name: 'Laundry', icon: '🧺' },
+    { id: 'meal_prep', name: 'Meal Preparation', icon: '👨‍🍳' },
+    { id: 'companionship', name: 'Companionship', icon: '💬' },
+    { id: 'errands', name: 'Errands/Shopping', icon: '🛒' },
+    { id: 'transportation', name: 'Transportation', icon: '🚗' }
+  ]);
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/alertsRoutes.js b/templates/crm-homecare/backend/src/routes/alertsRoutes.js
new file mode 100644
index 0000000..53a483e
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/alertsRoutes.js
@@ -0,0 +1,232 @@
+// routes/alertsRoutes.js
+// General Alerts System + Certification Expiration Alerts
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// ==================== GENERAL ALERTS ====================
+
+// Get all alerts with filtering
+router.get('/', auth, async (req, res) => {
+  const { type, priority, status } = req.query;
+  try {
+    let query = `
+      SELECT a.*,
+        CASE 
+          WHEN a.related_entity_type = 'client' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM clients WHERE id = a.related_entity_id)
+          WHEN a.related_entity_type = 'caregiver' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM users WHERE id = a.related_entity_id)
+          ELSE NULL
+        END as related_entity_name
+      FROM alerts a
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (type) {
+      params.push(type);
+      query += ` AND a.alert_type = $${params.length}`;
+    }
+    if (priority) {
+      params.push(priority);
+      query += ` AND a.priority = $${params.length}`;
+    }
+    if (status) {
+      params.push(status);
+      query += ` AND a.status = $${params.length}`;
+    }
+
+    query += ` ORDER BY 
+      CASE a.priority 
+        WHEN 'critical' THEN 1 
+        WHEN 'high' THEN 2 
+        WHEN 'medium' THEN 3 
+        WHEN 'low' THEN 4 
+      END,
+      a.created_at DESC`;
+
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create alert
+router.post('/', auth, async (req, res) => {
+  const { alertType, priority, message, dueDate, relatedEntityType, relatedEntityId } = req.body;
+  try {
+    const result = await db.query(`
+      INSERT INTO alerts (alert_type, priority, message, due_date, related_entity_type, related_entity_id, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7)
+      RETURNING *
+    `, [alertType, priority || 'medium', message, dueDate || null, relatedEntityType || null, relatedEntityId || null, req.user.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Acknowledge alert
+router.put('/:id/acknowledge', auth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE alerts 
+      SET status = 'acknowledged', acknowledged_at = NOW(), acknowledged_by = $1
+      WHERE id = $2
+    `, [req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Resolve alert
+router.put('/:id/resolve', auth, async (req, res) => {
+  const { resolution } = req.body;
+  try {
+    await db.query(`
+      UPDATE alerts 
+      SET status = 'resolved', resolution = $1, resolved_at = NOW(), resolved_by = $2
+      WHERE id = $3
+    `, [resolution, req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Dismiss alert
+router.put('/:id/dismiss', auth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE alerts 
+      SET status = 'dismissed', resolved_at = NOW(), resolved_by = $1
+      WHERE id = $2
+    `, [req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== CERTIFICATION ALERTS ====================
+
+// Get certification alerts
+router.get('/certifications', auth, async (req, res) => {
+  const { acknowledged } = req.query;
+  try {
+    let query = `
+      SELECT ca.*, 
+        u.first_name, u.last_name, u.phone, u.email,
+        cc.certification_type, cc.expiration_date
+      FROM certification_alerts ca
+      JOIN users u ON ca.caregiver_id = u.id
+      JOIN caregiver_certifications cc ON ca.certification_id = cc.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (acknowledged === 'false') {
+      query += ` AND ca.acknowledged = false`;
+    }
+
+    query += ` ORDER BY cc.expiration_date ASC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Acknowledge certification alert
+router.put('/certifications/:id/acknowledge', auth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE certification_alerts 
+      SET acknowledged = true, acknowledged_at = NOW(), acknowledged_by = $1
+      WHERE id = $2
+    `, [req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Generate certification alerts (run daily via cron)
+router.post('/certifications/generate', auth, async (req, res) => {
+  try {
+    const expiring = await db.query(`
+      SELECT cc.id as cert_id, cc.caregiver_id, cc.expiration_date,
+        CASE 
+          WHEN cc.expiration_date <= CURRENT_DATE THEN 'expired'
+          WHEN cc.expiration_date <= CURRENT_DATE + 7 THEN 'expiring_7'
+          WHEN cc.expiration_date <= CURRENT_DATE + 14 THEN 'expiring_14'
+          WHEN cc.expiration_date <= CURRENT_DATE + 30 THEN 'expiring_30'
+        END as alert_type
+      FROM caregiver_certifications cc
+      JOIN users u ON cc.caregiver_id = u.id
+      WHERE cc.expiration_date <= CURRENT_DATE + 30
+      AND u.is_active = true
+      AND NOT EXISTS (
+        SELECT 1 FROM certification_alerts ca 
+        WHERE ca.certification_id = cc.id 
+        AND ca.alert_type = CASE 
+          WHEN cc.expiration_date <= CURRENT_DATE THEN 'expired'
+          WHEN cc.expiration_date <= CURRENT_DATE + 7 THEN 'expiring_7'
+          WHEN cc.expiration_date <= CURRENT_DATE + 14 THEN 'expiring_14'
+          WHEN cc.expiration_date <= CURRENT_DATE + 30 THEN 'expiring_30'
+        END
+      )
+    `);
+
+    let created = 0;
+    for (const cert of expiring.rows) {
+      if (cert.alert_type) {
+        await db.query(`
+          INSERT INTO certification_alerts (caregiver_id, certification_id, alert_type, alert_date)
+          VALUES ($1, $2, $3, CURRENT_DATE)
+        `, [cert.caregiver_id, cert.cert_id, cert.alert_type]);
+        created++;
+      }
+    }
+
+    res.json({ created, total: expiring.rows.length });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== DASHBOARD ====================
+
+router.get('/dashboard', auth, async (req, res) => {
+  try {
+    const certs = await db.query(`SELECT COUNT(*) as count FROM certification_alerts WHERE acknowledged = false`);
+    const auths = await db.query(`SELECT COUNT(*) as count FROM authorizations WHERE end_date <= CURRENT_DATE + 30 AND end_date >= CURRENT_DATE`);
+    const bgChecks = await db.query(`SELECT COUNT(*) as count FROM background_checks WHERE expiration_date <= CURRENT_DATE + 30 AND expiration_date >= CURRENT_DATE`);
+    const openShifts = await db.query(`SELECT COUNT(*) as count FROM open_shifts WHERE status = 'open' AND shift_date >= CURRENT_DATE`);
+    const swaps = await db.query(`SELECT COUNT(*) as count FROM shift_swap_requests WHERE status IN ('pending', 'accepted')`);
+    const overdueInvoices = await db.query(`
+      SELECT COUNT(*) as count, COALESCE(SUM(total - COALESCE(amount_paid, 0)), 0) as amount
+      FROM invoices WHERE payment_status != 'paid' AND payment_due_date < CURRENT_DATE
+    `);
+
+    res.json({
+      expiringCertifications: parseInt(certs.rows[0].count),
+      expiringAuthorizations: parseInt(auths.rows[0].count),
+      expiringBackgroundChecks: parseInt(bgChecks.rows[0].count),
+      openShifts: parseInt(openShifts.rows[0].count),
+      pendingSwapRequests: parseInt(swaps.rows[0].count),
+      overdueInvoices: {
+        count: parseInt(overdueInvoices.rows[0].count),
+        amount: parseFloat(overdueInvoices.rows[0].amount)
+      }
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/applicationsRoutes.js b/templates/crm-homecare/backend/src/routes/applicationsRoutes.js
new file mode 100644
index 0000000..9871c07
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/applicationsRoutes.js
@@ -0,0 +1,273 @@
+// routes/applicationsRoutes.js
+// Job Applications - Public submission, admin review
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// ==================== PUBLIC ENDPOINT (NO AUTH) ====================
+
+// Submit job application (public - from website)
+router.post('/', async (req, res) => {
+  const {
+    firstName, lastName, email, phone, address, city, state, zip, dob,
+    driversLicense, transportation, legalToWork, backgroundCheck,
+    felony, felonyExplanation, yearsExperience, cnaLicense, certifications,
+    previousEmployer, reasonForLeaving, availability, shifts, hoursDesired, startDate,
+    ref1Name, ref1Relationship, ref1Phone, ref1Email,
+    ref2Name, ref2Relationship, ref2Phone, ref2Email,
+    whyInterested, additionalInfo
+  } = req.body;
+
+  try {
+    const result = await db.query(`
+      INSERT INTO job_applications (
+        first_name, last_name, email, phone, address, city, state, zip, date_of_birth,
+        has_drivers_license, has_transportation, legal_to_work, willing_background_check,
+        felony_conviction, felony_explanation, years_experience, cna_license, certifications,
+        previous_employer, reason_for_leaving, availability_days, availability_shifts, 
+        hours_desired, earliest_start_date,
+        ref1_name, ref1_relationship, ref1_phone, ref1_email,
+        ref2_name, ref2_relationship, ref2_phone, ref2_email,
+        why_interested, additional_info, status
+      ) VALUES (
+        $1, $2, $3, $4, $5, $6, $7, $8, $9,
+        $10, $11, $12, $13, $14, $15, $16, $17, $18,
+        $19, $20, $21, $22, $23, $24,
+        $25, $26, $27, $28, $29, $30, $31, $32,
+        $33, $34, 'new'
+      )
+      RETURNING id, first_name, last_name, created_at
+    `, [
+      firstName, lastName, email, phone, address, city, state, zip, dob,
+      driversLicense === 'yes', transportation === 'yes', legalToWork === 'yes', backgroundCheck === 'yes',
+      felony === 'yes', felonyExplanation, yearsExperience, cnaLicense, 
+      Array.isArray(certifications) ? certifications.join(',') : certifications,
+      previousEmployer, reasonForLeaving,
+      Array.isArray(availability) ? availability.join(',') : availability,
+      Array.isArray(shifts) ? shifts.join(',') : shifts,
+      hoursDesired, startDate,
+      ref1Name, ref1Relationship, ref1Phone, ref1Email,
+      ref2Name, ref2Relationship, ref2Phone, ref2Email,
+      whyInterested, additionalInfo
+    ]);
+
+    res.json({ 
+      success: true, 
+      message: 'Application submitted successfully',
+      applicationId: result.rows[0].id 
+    });
+  } catch (error) {
+    console.error('Application submission error:', error);
+    res.status(500).json({ error: 'Failed to submit application. Please try again.' });
+  }
+});
+
+// ==================== ADMIN ENDPOINTS (AUTH REQUIRED) ====================
+
+// Get all applications
+router.get('/', auth, async (req, res) => {
+  const { status, startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT id, first_name, last_name, email, phone, city, state,
+        years_experience, cna_license, status, created_at, updated_at
+      FROM job_applications
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status) {
+      params.push(status);
+      query += ` AND status = $${params.length}`;
+    }
+    if (startDate) {
+      params.push(startDate);
+      query += ` AND created_at >= $${params.length}`;
+    }
+    if (endDate) {
+      params.push(endDate);
+      query += ` AND created_at <= $${params.length}`;
+    }
+
+    query += ` ORDER BY created_at DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get single application details
+router.get('/:id', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT * FROM job_applications WHERE id = $1
+    `, [req.params.id]);
+
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Application not found' });
+    }
+
+    // Get status history
+    const history = await db.query(`
+      SELECT * FROM application_status_history 
+      WHERE application_id = $1 
+      ORDER BY created_at DESC
+    `, [req.params.id]);
+
+    res.json({ 
+      ...result.rows[0], 
+      status_history: history.rows 
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update application status
+router.put('/:id/status', auth, async (req, res) => {
+  const { status, notes } = req.body;
+  
+  try {
+    await db.query(`
+      UPDATE job_applications 
+      SET status = $1, updated_at = NOW()
+      WHERE id = $2
+    `, [status, req.params.id]);
+
+    // Log status change
+    await db.query(`
+      INSERT INTO application_status_history (application_id, status, notes, changed_by)
+      VALUES ($1, $2, $3, $4)
+    `, [req.params.id, status, notes, req.user.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Add interview notes
+router.post('/:id/notes', auth, async (req, res) => {
+  const { notes } = req.body;
+  
+  try {
+    await db.query(`
+      UPDATE job_applications 
+      SET interview_notes = COALESCE(interview_notes, '') || E'\n\n' || $1 || ' - ' || NOW()::date,
+          updated_at = NOW()
+      WHERE id = $2
+    `, [notes, req.params.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Convert approved applicant to caregiver
+router.post('/:id/hire', auth, async (req, res) => {
+  const { hourlyRate, email, password } = req.body;
+  
+  try {
+    const bcrypt = require('bcryptjs');
+    const { v4: uuidv4 } = require('uuid');
+
+    // Get application
+    const app = await db.query('SELECT * FROM job_applications WHERE id = $1', [req.params.id]);
+    if (app.rows.length === 0) {
+      return res.status(404).json({ error: 'Application not found' });
+    }
+
+    const a = app.rows[0];
+
+    // Check if already hired
+    if (a.status === 'hired') {
+      return res.status(400).json({ error: 'This applicant has already been hired' });
+    }
+
+    // Use applicant's email or provided email
+    const caregiverEmail = email || a.email;
+    if (!caregiverEmail) {
+      return res.status(400).json({ error: 'Email is required to create caregiver account' });
+    }
+
+    // Check email not already in use
+    const existing = await db.query('SELECT id FROM users WHERE email = $1', [caregiverEmail]);
+    if (existing.rows.length > 0) {
+      return res.status(409).json({ error: 'A user with this email already exists' });
+    }
+
+    // Generate temp password if not provided
+    const tempPassword = password || `CVHC${a.last_name.charAt(0).toUpperCase()}${Math.random().toString(36).slice(-6)}`;
+    const hashedPassword = await bcrypt.hash(tempPassword, 10);
+    const userId = uuidv4();
+
+    // Create caregiver in users table
+    const caregiver = await db.query(`
+      INSERT INTO users (id, email, password_hash, first_name, last_name, phone, role, default_pay_rate)
+      VALUES ($1, $2, $3, $4, $5, $6, 'caregiver', $7)
+      RETURNING id, email, first_name, last_name, role, default_pay_rate
+    `, [userId, caregiverEmail, hashedPassword, a.first_name, a.last_name, a.phone, hourlyRate || 15.00]);
+
+    // Update application status
+    await db.query(`
+      UPDATE job_applications SET status = 'hired', hired_caregiver_id = $1, updated_at = NOW() WHERE id = $2
+    `, [userId, req.params.id]);
+
+    // Log it
+    await db.query(`
+      INSERT INTO application_status_history (application_id, status, notes, changed_by)
+      VALUES ($1, 'hired', $2, $3)
+    `, [req.params.id, `Converted to caregiver. Temp password: ${tempPassword}`, req.user.id]);
+
+    res.json({ 
+      success: true, 
+      caregiverId: userId, 
+      tempPassword,
+      caregiver: caregiver.rows[0],
+      message: `${a.first_name} ${a.last_name} is now a caregiver. Temp password: ${tempPassword}`
+    });
+  } catch (error) {
+    console.error('Hire error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete application
+router.delete('/:id', auth, async (req, res) => {
+  try {
+    await db.query('DELETE FROM application_status_history WHERE application_id = $1', [req.params.id]);
+    await db.query('DELETE FROM job_applications WHERE id = $1', [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get application stats
+router.get('/stats/summary', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT 
+        COUNT(*) as total,
+        COUNT(*) FILTER (WHERE status = 'new') as new_count,
+        COUNT(*) FILTER (WHERE status = 'reviewing') as reviewing_count,
+        COUNT(*) FILTER (WHERE status = 'interviewed') as interviewed_count,
+        COUNT(*) FILTER (WHERE status = 'offered') as offered_count,
+        COUNT(*) FILTER (WHERE status = 'hired') as hired_count,
+        COUNT(*) FILTER (WHERE status = 'rejected') as rejected_count,
+        COUNT(*) FILTER (WHERE created_at >= CURRENT_DATE - INTERVAL '7 days') as last_7_days,
+        COUNT(*) FILTER (WHERE created_at >= CURRENT_DATE - INTERVAL '30 days') as last_30_days
+      FROM job_applications
+    `);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/auditLogs.js b/templates/crm-homecare/backend/src/routes/auditLogs.js
new file mode 100644
index 0000000..d2e4e2c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/auditLogs.js
@@ -0,0 +1,110 @@
+// src/routes/auditLogs.js
+const express = require('express');
+const router = express.Router();
+
+/**
+ * GET /api/audit-logs
+ * Retrieve audit logs with filtering
+ */
+router.get('/', async (req, res) => {
+  try {
+    const { startDate, endDate, userId, action, entityType, page = 1, limit = 50 } = req.query;
+
+    res.json({
+      success: true,
+      logs: [],
+      pagination: {
+        total: 0,
+        pages: 0,
+        currentPage: parseInt(page)
+      }
+    });
+  } catch (error) {
+    console.error('Error retrieving audit logs:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+/**
+ * GET /api/audit-logs/:id
+ * Get a specific audit log entry
+ */
+router.get('/:id', async (req, res) => {
+  try {
+    res.status(404).json({ error: 'Audit log not found' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+/**
+ * GET /api/audit-logs/entity/:entityType/:entityId
+ * Get all logs for a specific entity
+ */
+router.get('/entity/:entityType/:entityId', async (req, res) => {
+  try {
+    res.json({
+      success: true,
+      logs: [],
+      count: 0
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+/**
+ * POST /api/audit-logs/export
+ * Export audit logs as CSV or PDF
+ */
+router.post('/export', async (req, res) => {
+  try {
+    const { format = 'csv' } = req.body;
+    res.json({
+      success: true,
+      message: 'Export initiated'
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+/**
+ * POST /api/audit-logs/compliance-report
+ * Generate HIPAA compliance report
+ */
+router.post('/compliance-report', async (req, res) => {
+  try {
+    const { startDate, endDate } = req.body;
+    res.json({
+      success: true,
+      message: 'Compliance report generated'
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+/**
+ * GET /api/audit-logs/stats/summary
+ * Get audit log statistics
+ */
+router.get('/stats/summary', async (req, res) => {
+  try {
+    res.json({
+      success: true,
+      stats: {
+        totalEvents: 0,
+        uniqueUsers: 0,
+        dataChanges: 0,
+        accessEvents: 0,
+        failedLogins: 0,
+        suspiciousActivity: 0
+      }
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/authRoutes.js b/templates/crm-homecare/backend/src/routes/authRoutes.js
new file mode 100644
index 0000000..c0fc670
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/authRoutes.js
@@ -0,0 +1,228 @@
+// routes/authRoutes.js
+const express = require('express');
+const router = express.Router();
+const bcrypt = require('bcryptjs');
+const jwt = require('jsonwebtoken');
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// Helper: log a login attempt (fire-and-forget, never blocks the response)
+async function logLoginAttempt({ email, userId, success, failReason, req }) {
+  try {
+    const ip = req.headers['x-forwarded-for']?.split(',')[0]?.trim() || req.ip || 'unknown';
+    const userAgent = req.headers['user-agent'] || null;
+    await db.query(
+      `INSERT INTO login_activity (email, user_id, success, ip_address, user_agent, fail_reason)
+       VALUES ($1, $2, $3, $4, $5, $6)`,
+      [email, userId || null, success, ip, userAgent, failReason || null]
+    );
+  } catch (err) {
+    console.error('Failed to log login activity:', err.message);
+  }
+}
+
+// POST /api/auth/login
+router.post('/login', async (req, res) => {
+  try {
+    const { email, password } = req.body;
+    const result = await db.query('SELECT * FROM users WHERE email = $1', [email]);
+    const user = result.rows[0];
+
+    if (!user) {
+      logLoginAttempt({ email, userId: null, success: false, failReason: 'user_not_found', req });
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    const passwordMatch = await bcrypt.compare(password, user.password_hash);
+    if (!passwordMatch) {
+      logLoginAttempt({ email, userId: user.id, success: false, failReason: 'invalid_password', req });
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    if (user.is_active === false) {
+      logLoginAttempt({ email, userId: user.id, success: false, failReason: 'account_inactive', req });
+      return res.status(401).json({ error: 'Account is inactive' });
+    }
+
+    logLoginAttempt({ email, userId: user.id, success: true, failReason: null, req });
+
+    const token = jwt.sign(
+      { id: user.id, email: user.email, role: user.role, name: `${user.first_name} ${user.last_name}` },
+      process.env.JWT_SECRET,
+      { expiresIn: '8h' }
+    );
+    res.json({
+      token,
+      user: { id: user.id, email: user.email, name: `${user.first_name} ${user.last_name}`, role: user.role }
+    });
+  } catch (error) {
+    console.error('Login error:', error);
+    res.status(500).json({ error: 'Login failed' });
+  }
+});
+
+// POST /api/auth/register-caregiver
+router.post('/register-caregiver', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { email, password, firstName, lastName, phone, payRate } = req.body;
+    const hashedPassword = await bcrypt.hash(password, 10);
+    const userId = uuidv4();
+    await db.query("SELECT set_config('app.current_user_id', $1, false)", [req.user.id]);
+    const result = await db.query(
+      `INSERT INTO users (id, email, password_hash, first_name, last_name, phone, role, default_pay_rate)
+       VALUES ($1, $2, $3, $4, $5, $6, 'caregiver', $7)
+       RETURNING id, email, first_name, last_name, role, default_pay_rate`,
+      [userId, email, hashedPassword, firstName, lastName, phone, payRate || 15.00]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    console.error('Caregiver registration error:', error);
+    if (error.code === '23505') return res.status(409).json({ error: 'Email already exists' });
+    res.status(500).json({ error: 'Registration failed' });
+  }
+});
+
+// POST /api/auth/register-admin
+router.post('/register-admin', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { email, password, firstName, lastName, phone } = req.body;
+    const hashedPassword = await bcrypt.hash(password, 10);
+    const userId = uuidv4();
+    await db.query("SELECT set_config('app.current_user_id', $1, false)", [req.user.id]);
+    const result = await db.query(
+      `INSERT INTO users (id, email, password_hash, first_name, last_name, phone, role)
+       VALUES ($1, $2, $3, $4, $5, $6, 'admin')
+       RETURNING id, email, first_name, last_name, role`,
+      [userId, email, hashedPassword, firstName, lastName, phone]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    console.error('Admin registration error:', error);
+    if (error.code === '23505') return res.status(409).json({ error: 'Email already exists' });
+    res.status(500).json({ error: 'Registration failed' });
+  }
+});
+
+// POST /api/auth/impersonate/:userId
+// Admin only — generates a short-lived token to view the app as another user
+router.post('/impersonate/:userId', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { userId } = req.params;
+
+    const result = await db.query('SELECT * FROM users WHERE id = $1', [userId]);
+    const targetUser = result.rows[0];
+    if (!targetUser) return res.status(404).json({ error: 'User not found' });
+
+    // Log the impersonation action
+    await auditLog(req.user.id, 'ADMIN_IMPERSONATE', 'users', userId, null, {
+      impersonating: targetUser.email,
+      impersonatedBy: req.user.email
+    });
+
+    const token = jwt.sign(
+      {
+        id: targetUser.id,
+        email: targetUser.email,
+        role: targetUser.role,
+        name: `${targetUser.first_name} ${targetUser.last_name}`,
+        impersonatedBy: req.user.email,
+        impersonation: true
+      },
+      process.env.JWT_SECRET,
+      { expiresIn: '2h' }
+    );
+
+    res.json({
+      token,
+      user: {
+        id: targetUser.id,
+        email: targetUser.email,
+        name: `${targetUser.first_name} ${targetUser.last_name}`,
+        role: targetUser.role,
+        impersonatedBy: req.user.email
+      }
+    });
+  } catch (error) {
+    console.error('Impersonation error:', error);
+    res.status(500).json({ error: 'Impersonation failed' });
+  }
+});
+
+// GET /api/auth/users — admin only, returns list of users to impersonate
+router.get('/users', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT id, email, first_name, last_name, role, is_active
+       FROM users
+       ORDER BY role, last_name, first_name`
+    );
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Error fetching users:', error);
+    res.status(500).json({ error: 'Failed to fetch users' });
+  }
+});
+
+// GET /api/auth/login-activity — admin only
+router.get('/login-activity', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { page = 1, limit = 50, email, success } = req.query;
+    const offset = (parseInt(page) - 1) * parseInt(limit);
+
+    const conditions = [];
+    const params = [];
+
+    if (email) {
+      params.push(`%${email.toLowerCase()}%`);
+      conditions.push(`la.email ILIKE $${params.length}`);
+    }
+    if (success !== undefined && success !== '') {
+      params.push(success === 'true');
+      conditions.push(`la.success = $${params.length}`);
+    }
+
+    const where = conditions.length ? `WHERE ${conditions.join(' AND ')}` : '';
+
+    const dataParams = [...params, parseInt(limit), offset];
+    const rows = await db.query(
+      `SELECT
+         la.id,
+         la.email,
+         la.success,
+         la.ip_address,
+         la.user_agent,
+         la.fail_reason,
+         la.created_at,
+         u.first_name,
+         u.last_name,
+         u.role
+       FROM login_activity la
+       LEFT JOIN users u ON u.id = la.user_id
+       ${where}
+       ORDER BY la.created_at DESC
+       LIMIT $${dataParams.length - 1} OFFSET $${dataParams.length}`,
+      dataParams
+    );
+
+    const countResult = await db.query(
+      `SELECT COUNT(*) FROM login_activity la ${where}`,
+      params
+    );
+
+    res.json({
+      success: true,
+      activity: rows.rows,
+      pagination: {
+        total: parseInt(countResult.rows[0].count),
+        page: parseInt(page),
+        pages: Math.ceil(parseInt(countResult.rows[0].count) / parseInt(limit))
+      }
+    });
+  } catch (error) {
+    console.error('Login activity fetch error:', error);
+    res.status(500).json({ error: 'Failed to fetch login activity' });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/authorizationRoutes.js b/templates/crm-homecare/backend/src/routes/authorizationRoutes.js
new file mode 100644
index 0000000..a1ac578
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/authorizationRoutes.js
@@ -0,0 +1,215 @@
+// routes/authorizationRoutes.js
+// MIDAS Authorization Management - import, track, burn-down alerts
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── GET ALL AUTHORIZATIONS ───────────────────────────────────────────────────
+router.get('/', auth, requireAdmin, async (req, res) => {
+  try {
+    const { clientId, status, payerId, expiringSoon } = req.query;
+    let query = `
+      SELECT a.*,
+        c.first_name as client_first, c.last_name as client_last,
+        rs.name as payer_name, rs.payer_type,
+        ROUND((a.used_units / NULLIF(a.authorized_units, 0)) * 100, 1) as pct_used,
+        a.authorized_units - a.used_units as remaining_units,
+        CASE
+          WHEN a.end_date < CURRENT_DATE THEN 'expired'
+          WHEN a.authorized_units - a.used_units <= a.low_units_alert_threshold THEN 'low'
+          WHEN a.end_date <= CURRENT_DATE + 30 THEN 'expiring_soon'
+          ELSE 'ok'
+        END as health_status
+      FROM authorizations a
+      JOIN clients c ON a.client_id = c.id
+      LEFT JOIN referral_sources rs ON a.payer_id = rs.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (clientId) { params.push(clientId); query += ` AND a.client_id = $${params.length}`; }
+    if (status) { params.push(status); query += ` AND a.status = $${params.length}`; }
+    if (payerId) { params.push(payerId); query += ` AND a.payer_id = $${params.length}`; }
+    if (expiringSoon) { query += ` AND a.end_date BETWEEN CURRENT_DATE AND CURRENT_DATE + 30`; }
+
+    query += ` ORDER BY a.end_date ASC, c.last_name ASC`;
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET AUTH DASHBOARD SUMMARY ───────────────────────────────────────────────
+router.get('/summary', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        COUNT(*) as total,
+        COUNT(CASE WHEN status = 'active' THEN 1 END) as active,
+        COUNT(CASE WHEN end_date < CURRENT_DATE THEN 1 END) as expired,
+        COUNT(CASE WHEN end_date BETWEEN CURRENT_DATE AND CURRENT_DATE + 30 AND status = 'active' THEN 1 END) as expiring_soon,
+        COUNT(CASE WHEN (authorized_units - used_units) <= low_units_alert_threshold AND status = 'active' THEN 1 END) as low_units,
+        COUNT(CASE WHEN status = 'exhausted' THEN 1 END) as exhausted
+      FROM authorizations
+    `);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── CREATE AUTHORIZATION (manual entry) ────────────────────────────────────
+router.post('/', auth, requireAdmin, async (req, res) => {
+  try {
+    const {
+      clientId, payerId, authNumber, midasAuthId,
+      procedureCode, modifier, authorizedUnits, unitType,
+      startDate, endDate, notes, lowUnitsThreshold
+    } = req.body;
+
+    if (!clientId || !authorizedUnits || !startDate || !endDate) {
+      return res.status(400).json({ error: 'Client, authorized units, and date range are required' });
+    }
+
+    const result = await db.query(`
+      INSERT INTO authorizations (
+        id, client_id, payer_id, auth_number, midas_auth_id,
+        procedure_code, modifier, authorized_units, unit_type,
+        start_date, end_date, notes, low_units_alert_threshold, created_by
+      ) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14)
+      RETURNING *
+    `, [
+      uuidv4(), clientId, payerId || null, authNumber || null, midasAuthId || null,
+      procedureCode || 'T1019', modifier || null,
+      authorizedUnits, unitType || '15min',
+      startDate, endDate, notes || null,
+      lowUnitsThreshold || 20, req.user.id
+    ]);
+
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── IMPORT FROM MIDAS CSV ────────────────────────────────────────────────────
+// MIDAS doesn't have an API - export CSV from portal, import here
+// Expected columns: MemberID, AuthNumber, ServiceCode, AuthorizedUnits, StartDate, EndDate
+router.post('/import-csv', auth, requireAdmin, async (req, res) => {
+  try {
+    const { rows } = req.body; // Array of parsed CSV rows from frontend
+    if (!rows || !rows.length) return res.status(400).json({ error: 'No data provided' });
+
+    let imported = 0, skipped = 0, errors = [];
+
+    for (const row of rows) {
+      try {
+        // Match member ID to client
+        const client = await db.query(`
+          SELECT id FROM clients
+          WHERE medicaid_id = $1 OR mco_member_id = $1
+          LIMIT 1
+        `, [row.MemberID || row.member_id || row['Member ID']]);
+
+        if (!client.rows.length) {
+          skipped++;
+          errors.push(`No client found for Member ID: ${row.MemberID || row.member_id}`);
+          continue;
+        }
+
+        const clientId = client.rows[0].id;
+        const authNumber = row.AuthNumber || row.auth_number || row['Auth Number'];
+        const procedureCode = row.ServiceCode || row.service_code || row['Service Code'] || 'T1019';
+        const authorizedUnits = parseFloat(row.AuthorizedUnits || row.authorized_units || row['Authorized Units'] || 0);
+        const startDate = row.StartDate || row.start_date || row['Start Date'];
+        const endDate = row.EndDate || row.end_date || row['End Date'];
+
+        if (!authorizedUnits || !startDate || !endDate) {
+          skipped++;
+          errors.push(`Missing data for auth ${authNumber}`);
+          continue;
+        }
+
+        // Check for existing auth with same number
+        const existing = await db.query(
+          `SELECT id FROM authorizations WHERE auth_number = $1 AND client_id = $2`,
+          [authNumber, clientId]
+        );
+
+        if (existing.rows.length) {
+          // Update existing
+          await db.query(`
+            UPDATE authorizations SET
+              authorized_units = $1, start_date = $2, end_date = $3,
+              status = CASE WHEN $3::date < CURRENT_DATE THEN 'expired' ELSE 'active' END,
+              imported_from = 'midas_csv', updated_at = NOW()
+            WHERE id = $4
+          `, [authorizedUnits, startDate, endDate, existing.rows[0].id]);
+        } else {
+          await db.query(`
+            INSERT INTO authorizations (id, client_id, auth_number, procedure_code,
+              authorized_units, unit_type, start_date, end_date, status, imported_from, created_by)
+            VALUES ($1,$2,$3,$4,$5,'15min',$6,$7,
+              CASE WHEN $7::date < CURRENT_DATE THEN 'expired' ELSE 'active' END,
+              'midas_csv',$8)
+          `, [uuidv4(), clientId, authNumber, procedureCode, authorizedUnits, startDate, endDate, req.user.id]);
+        }
+        imported++;
+      } catch (e) {
+        errors.push(`Row error: ${e.message}`);
+        skipped++;
+      }
+    }
+
+    res.json({ imported, skipped, errors: errors.slice(0, 20) });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── UPDATE AUTHORIZATION ────────────────────────────────────────────────────
+router.put('/:id', auth, requireAdmin, async (req, res) => {
+  try {
+    const { authorizedUnits, startDate, endDate, status, notes, lowUnitsThreshold } = req.body;
+    await db.query(`
+      UPDATE authorizations SET
+        authorized_units = COALESCE($1, authorized_units),
+        start_date = COALESCE($2, start_date),
+        end_date = COALESCE($3, end_date),
+        status = COALESCE($4, status),
+        notes = COALESCE($5, notes),
+        low_units_alert_threshold = COALESCE($6, low_units_alert_threshold),
+        updated_at = NOW()
+      WHERE id = $7
+    `, [authorizedUnits, startDate, endDate, status, notes, lowUnitsThreshold, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET CLIENT AUTHORIZATIONS ────────────────────────────────────────────────
+router.get('/client/:clientId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT a.*,
+        rs.name as payer_name,
+        a.authorized_units - a.used_units as remaining_units,
+        ROUND((a.used_units / NULLIF(a.authorized_units, 0)) * 100, 1) as pct_used
+      FROM authorizations a
+      LEFT JOIN referral_sources rs ON a.payer_id = rs.id
+      WHERE a.client_id = $1
+      ORDER BY a.status ASC, a.end_date ASC
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/backgroundChecksRoutes.js b/templates/crm-homecare/backend/src/routes/backgroundChecksRoutes.js
new file mode 100644
index 0000000..7b7fbca
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/backgroundChecksRoutes.js
@@ -0,0 +1,146 @@
+// routes/backgroundChecksRoutes.js
+// Background Check Tracking
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Get all background checks (with optional filters)
+router.get('/', auth, async (req, res) => {
+  const { status, type, caregiverId } = req.query;
+  try {
+    let query = `
+      SELECT bc.*, 
+        u.first_name as caregiver_first, u.last_name as caregiver_last
+      FROM background_checks bc
+      JOIN users u ON bc.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status) {
+      params.push(status);
+      query += ` AND bc.status = $${params.length}`;
+    }
+    if (type) {
+      params.push(type);
+      query += ` AND bc.check_type = $${params.length}`;
+    }
+    if (caregiverId) {
+      params.push(caregiverId);
+      query += ` AND bc.caregiver_id = $${params.length}`;
+    }
+
+    query += ` ORDER BY bc.request_date DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get background checks for a specific caregiver
+router.get('/caregiver/:caregiverId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT * FROM background_checks
+      WHERE caregiver_id = $1
+      ORDER BY request_date DESC
+    `, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Add background check
+router.post('/', auth, async (req, res) => {
+  const { caregiverId, checkType, provider, cost, notes } = req.body;
+  try {
+    const result = await db.query(`
+      INSERT INTO background_checks (caregiver_id, check_type, provider, cost, status, initiated_date, notes, created_by)
+      VALUES ($1, $2, $3, $4, 'pending', CURRENT_DATE, $5, $6)
+      RETURNING *
+    `, [caregiverId, checkType, provider, cost || null, notes, req.user.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update background check
+router.put('/:id', auth, async (req, res) => {
+  const { status, result, completedDate, expirationDate, referenceNumber, findings, notes } = req.body;
+  try {
+    const dbResult = await db.query(`
+      UPDATE background_checks SET
+        status = COALESCE($1, status),
+        result = COALESCE($2, result),
+        completed_date = COALESCE($3, completed_date),
+        expiration_date = COALESCE($4, expiration_date),
+        reference_number = COALESCE($5, reference_number),
+        findings = COALESCE($6, findings),
+        notes = COALESCE($7, notes),
+        updated_at = NOW()
+      WHERE id = $8
+      RETURNING *
+    `, [status, result, completedDate, expirationDate, referenceNumber, findings, notes, req.params.id]);
+    res.json(dbResult.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete background check
+router.delete('/:id', auth, async (req, res) => {
+  try {
+    await db.query('DELETE FROM background_checks WHERE id = $1', [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get expiring background checks
+router.get('/reports/expiring', auth, async (req, res) => {
+  const { days = 30 } = req.query;
+  try {
+    const result = await db.query(`
+      SELECT bc.*, u.first_name, u.last_name, u.phone, u.email
+      FROM background_checks bc
+      JOIN users u ON bc.caregiver_id = u.id
+      WHERE bc.expiration_date IS NOT NULL
+      AND bc.expiration_date <= CURRENT_DATE + $1::integer
+      AND bc.status = 'completed'
+      AND bc.result = 'clear'
+      ORDER BY bc.expiration_date ASC
+    `, [days]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get caregivers with missing/failed checks
+router.get('/reports/compliance', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT u.id, u.first_name, u.last_name,
+        ARRAY_AGG(DISTINCT bc.check_type) FILTER (WHERE bc.status = 'completed' AND bc.result = 'clear' AND (bc.expiration_date IS NULL OR bc.expiration_date > CURRENT_DATE)) as passed_checks,
+        ARRAY_AGG(DISTINCT bc.check_type) FILTER (WHERE bc.result = 'disqualifying') as failed_checks,
+        ARRAY_AGG(DISTINCT bc.check_type) FILTER (WHERE bc.status = 'pending' OR bc.status = 'in_progress') as pending_checks
+      FROM users u
+      LEFT JOIN background_checks bc ON bc.caregiver_id = u.id
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      GROUP BY u.id, u.first_name, u.last_name
+      ORDER BY u.last_name
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/billingRoutes.js b/templates/crm-homecare/backend/src/routes/billingRoutes.js
new file mode 100644
index 0000000..1a84202
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/billingRoutes.js
@@ -0,0 +1,978 @@
+// routes/billingRoutes.js
+// Consolidated billing routes - invoices, payments, authorizations, rates
+// All billing-related endpoints in one place
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// ==================== HELPER FUNCTIONS ====================
+
+/**
+ * Generate line items for a client's billing period
+ */
+async function generateLineItems(clientId, referralSourceId, careTypeId, billingPeriodStart, billingPeriodEnd) {
+  const entriesResult = await db.query(`
+    SELECT 
+      te.id as time_entry_id,
+      te.caregiver_id,
+      u.first_name as caregiver_first_name,
+      u.last_name as caregiver_last_name,
+      DATE(te.start_time) as service_date,
+      te.start_time,
+      te.end_time,
+      te.duration_minutes,
+      te.notes
+    FROM time_entries te
+    JOIN users u ON te.caregiver_id = u.id
+    WHERE te.client_id = $1
+      AND te.start_time >= $2
+      AND te.start_time < ($3::date + INTERVAL '1 day')
+      AND te.is_complete = true
+    ORDER BY te.start_time
+  `, [clientId, billingPeriodStart, billingPeriodEnd]);
+
+  let rate = 25.00;
+  let rateType = 'hourly';
+
+  if (referralSourceId) {
+    const rateResult = await db.query(`
+      SELECT rate_amount, rate_type 
+      FROM referral_source_rates 
+      WHERE referral_source_id = $1 
+        AND (care_type_id = $2 OR care_type_id IS NULL)
+        AND (is_active = true OR is_active IS NULL)
+        AND (effective_date IS NULL OR effective_date <= $3)
+        AND (end_date IS NULL OR end_date >= $4)
+      ORDER BY 
+        CASE WHEN care_type_id = $2 THEN 0 ELSE 1 END,
+        effective_date DESC NULLS LAST
+      LIMIT 1
+    `, [referralSourceId, careTypeId, billingPeriodEnd, billingPeriodStart]);
+
+    if (rateResult.rows.length > 0) {
+      rate = parseFloat(rateResult.rows[0].rate_amount);
+      rateType = rateResult.rows[0].rate_type || 'hourly';
+    }
+  }
+
+  const lineItems = [];
+  let invoiceTotal = 0;
+
+  for (const entry of entriesResult.rows) {
+    let hours = 0;
+    if (entry.duration_minutes) {
+      hours = entry.duration_minutes / 60.0;
+    } else if (entry.start_time && entry.end_time) {
+      const start = new Date(entry.start_time);
+      const end = new Date(entry.end_time);
+      hours = (end - start) / (1000 * 60 * 60);
+    }
+
+    if (hours <= 0) continue;
+
+    const amount = rateType === 'hourly' ? hours * rate : rate;
+    invoiceTotal += amount;
+
+    // Format times for display
+    const startTime = new Date(entry.start_time);
+    const endTime = entry.end_time ? new Date(entry.end_time) : null;
+    const timeRange = endTime 
+      ? `${startTime.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })} - ${endTime.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}`
+      : '';
+
+    lineItems.push({
+      time_entry_id: entry.time_entry_id,
+      caregiver_id: entry.caregiver_id,
+      caregiver_first_name: entry.caregiver_first_name,
+      caregiver_last_name: entry.caregiver_last_name,
+      service_date: entry.service_date,
+      start_time: entry.start_time,
+      end_time: entry.end_time,
+      time_range: timeRange,
+      description: entry.notes || 'Home Care Services',
+      hours: hours,
+      rate: rate,
+      rate_type: rateType,
+      amount: amount
+    });
+  }
+
+  return { lineItems, total: invoiceTotal };
+}
+
+/**
+ * Insert line items into database
+ */
+async function insertLineItems(invoiceId, lineItems) {
+  for (const item of lineItems) {
+    await db.query(`
+      INSERT INTO invoice_line_items (
+        invoice_id, time_entry_id, caregiver_id, description, hours, rate, amount, service_date
+      ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
+    `, [
+      invoiceId,
+      item.time_entry_id,
+      item.caregiver_id,
+      item.description,
+      item.hours,
+      item.rate,
+      item.amount,
+      item.service_date || null
+    ]);
+  }
+}
+
+/**
+ * Generate unique invoice number
+ */
+function generateInvoiceNumber(clientId) {
+  const timestamp = Date.now().toString(36).toUpperCase();
+  const clientPart = clientId.slice(0, 4).toUpperCase();
+  return `INV-${timestamp}-${clientPart}`;
+}
+
+// ==================== INVOICES ====================
+
+// List all invoices
+router.get('/invoices', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT i.*, 
+        c.first_name, c.last_name,
+        rs.name as referral_source_name,
+        (SELECT COALESCE(SUM(hours), 0) FROM invoice_line_items WHERE invoice_id = i.id) as total_hours
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      LEFT JOIN referral_sources rs ON i.referral_source_id = rs.id
+      ORDER BY i.created_at DESC
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Error fetching invoices:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get single invoice with line items
+router.get('/invoices/:id', auth, async (req, res) => {
+  try {
+    const invoiceResult = await db.query(`
+      SELECT i.*, 
+        c.first_name, c.last_name, c.referral_source_id, c.care_type_id,
+        c.email, c.phone, c.address, c.city, c.state, c.zip,
+        rs.name as referral_source_name
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      LEFT JOIN referral_sources rs ON c.referral_source_id = rs.id
+      WHERE i.id = $1
+    `, [req.params.id]);
+
+    if (invoiceResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const invoice = invoiceResult.rows[0];
+
+    const lineItemsResult = await db.query(`
+      SELECT 
+        ili.*,
+        u.first_name as caregiver_first_name,
+        u.last_name as caregiver_last_name,
+        COALESCE(ili.service_date, DATE(te.start_time)) as service_date
+      FROM invoice_line_items ili
+      LEFT JOIN users u ON ili.caregiver_id = u.id
+      LEFT JOIN time_entries te ON ili.time_entry_id = te.id
+      WHERE ili.invoice_id = $1
+      ORDER BY COALESCE(ili.service_date, DATE(te.start_time)), u.last_name
+    `, [req.params.id]);
+
+    let lineItems = lineItemsResult.rows;
+
+    if (lineItems.length === 0) {
+      const regenerated = await generateLineItems(
+        invoice.client_id,
+        invoice.referral_source_id,
+        invoice.care_type_id,
+        invoice.billing_period_start,
+        invoice.billing_period_end
+      );
+      lineItems = regenerated.lineItems;
+    }
+
+    res.json({
+      ...invoice,
+      line_items: lineItems,
+      total_hours: lineItems.reduce((sum, item) => sum + parseFloat(item.hours || 0), 0)
+    });
+
+  } catch (error) {
+    console.error('Error fetching invoice:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Generate single invoice
+router.post('/invoices/generate-with-rates', auth, async (req, res) => {
+  const { clientId, billingPeriodStart, billingPeriodEnd, notes } = req.body;
+
+  if (!clientId || !billingPeriodStart || !billingPeriodEnd) {
+    return res.status(400).json({ error: 'Client and billing period are required' });
+  }
+
+  try {
+    const clientResult = await db.query(`
+      SELECT id, first_name, last_name, referral_source_id, care_type_id,
+             is_private_pay, private_pay_rate, private_pay_rate_type
+      FROM clients WHERE id = $1
+    `, [clientId]);
+
+    if (clientResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Client not found' });
+    }
+
+    const client = clientResult.rows[0];
+
+    const existingResult = await db.query(`
+      SELECT id, invoice_number FROM invoices 
+      WHERE client_id = $1 
+        AND billing_period_start = $2 
+        AND billing_period_end = $3
+    `, [clientId, billingPeriodStart, billingPeriodEnd]);
+
+    if (existingResult.rows.length > 0) {
+      return res.status(400).json({ 
+        error: `Invoice ${existingResult.rows[0].invoice_number} already exists for this period` 
+      });
+    }
+
+    const { lineItems, total } = await generateLineItems(
+      clientId, 
+      client.referral_source_id,
+      client.care_type_id,
+      billingPeriodStart, 
+      billingPeriodEnd
+    );
+
+    if (lineItems.length === 0) {
+      return res.status(400).json({ 
+        error: 'No completed time entries found for this client in the selected period' 
+      });
+    }
+
+    const dueDate = new Date(billingPeriodEnd);
+    dueDate.setDate(dueDate.getDate() + 30);
+
+    const invoiceNumber = generateInvoiceNumber(clientId);
+    
+    const invoiceResult = await db.query(`
+      INSERT INTO invoices (
+        client_id, invoice_number, billing_period_start, billing_period_end,
+        subtotal, total, payment_status, payment_due_date, notes,
+        referral_source_id, invoice_type
+      ) VALUES ($1, $2, $3, $4, $5, $6, 'pending', $7, $8, $9, $10)
+      RETURNING *
+    `, [
+      clientId, invoiceNumber, billingPeriodStart, billingPeriodEnd,
+      total, total, dueDate, notes,
+      client.referral_source_id,
+      client.is_private_pay ? 'private_pay' : 'insurance'
+    ]);
+
+    const invoice = invoiceResult.rows[0];
+    await insertLineItems(invoice.id, lineItems);
+
+    let referralSourceName = null;
+    if (client.referral_source_id) {
+      const rsResult = await db.query(
+        'SELECT name FROM referral_sources WHERE id = $1',
+        [client.referral_source_id]
+      );
+      referralSourceName = rsResult.rows[0]?.name;
+    }
+
+    res.json({
+      ...invoice,
+      first_name: client.first_name,
+      last_name: client.last_name,
+      referral_source_name: referralSourceName,
+      line_items: lineItems,
+      total_hours: lineItems.reduce((sum, item) => sum + parseFloat(item.hours), 0)
+    });
+
+  } catch (error) {
+    console.error('Error generating invoice:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create manual invoice with custom line items
+router.post('/invoices/manual', auth, async (req, res) => {
+  const { clientId, billingPeriodStart, billingPeriodEnd, notes, lineItems, detailedMode } = req.body;
+
+  if (!clientId || !billingPeriodStart || !billingPeriodEnd) {
+    return res.status(400).json({ error: 'Client and billing period are required' });
+  }
+
+  if (!lineItems || lineItems.length === 0) {
+    return res.status(400).json({ error: 'At least one line item is required' });
+  }
+
+  try {
+    // Get client info
+    const clientResult = await db.query(`
+      SELECT id, first_name, last_name, referral_source_id, care_type_id, is_private_pay
+      FROM clients WHERE id = $1
+    `, [clientId]);
+
+    if (clientResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Client not found' });
+    }
+
+    const client = clientResult.rows[0];
+
+    // Check for existing invoice
+    const existingResult = await db.query(`
+      SELECT id, invoice_number FROM invoices 
+      WHERE client_id = $1 
+        AND billing_period_start = $2 
+        AND billing_period_end = $3
+    `, [clientId, billingPeriodStart, billingPeriodEnd]);
+
+    if (existingResult.rows.length > 0) {
+      return res.status(400).json({ 
+        error: `Invoice ${existingResult.rows[0].invoice_number} already exists for this period` 
+      });
+    }
+
+    // Calculate total from line items
+    let total = 0;
+    for (const item of lineItems) {
+      const amount = parseFloat(item.hours || 0) * parseFloat(item.rate || 0);
+      total += amount;
+    }
+
+    // Generate invoice number
+    const timestamp = Date.now().toString(36).toUpperCase();
+    const clientPart = clientId.slice(0, 4).toUpperCase();
+    const invoiceNumber = `INV-${timestamp}-${clientPart}`;
+
+    // Calculate due date
+    const dueDate = new Date(billingPeriodEnd);
+    dueDate.setDate(dueDate.getDate() + 30);
+
+    // Create invoice
+    const invoiceResult = await db.query(`
+      INSERT INTO invoices (
+        client_id, invoice_number, billing_period_start, billing_period_end,
+        subtotal, total, payment_status, payment_due_date, notes,
+        referral_source_id, invoice_type
+      ) VALUES ($1, $2, $3, $4, $5, $6, 'pending', $7, $8, $9, $10)
+      RETURNING *
+    `, [
+      clientId, invoiceNumber, billingPeriodStart, billingPeriodEnd,
+      total, total, dueDate, notes,
+      client.referral_source_id,
+      client.is_private_pay ? 'private_pay' : 'insurance'
+    ]);
+
+    const invoice = invoiceResult.rows[0];
+
+    // Insert line items with optional service_date and times
+    const insertedLineItems = [];
+    for (const item of lineItems) {
+      const amount = parseFloat(item.hours || 0) * parseFloat(item.rate || 0);
+      
+      // Build description with time info if provided
+      let description = item.description || 'Home Care Services';
+      if (detailedMode && item.startTime && item.endTime) {
+        description = `${description} (${item.startTime} - ${item.endTime})`;
+      }
+      
+      await db.query(`
+        INSERT INTO invoice_line_items (
+          invoice_id, caregiver_id, description, hours, rate, amount, service_date
+        ) VALUES ($1, $2, $3, $4, $5, $6, $7)
+      `, [
+        invoice.id,
+        item.caregiverId || null,
+        description,
+        item.hours,
+        item.rate,
+        amount,
+        item.serviceDate || null
+      ]);
+
+      insertedLineItems.push({
+        caregiver_id: item.caregiverId,
+        caregiver_first_name: item.caregiverName?.split(' ')[0] || '',
+        caregiver_last_name: item.caregiverName?.split(' ').slice(1).join(' ') || '',
+        description: description,
+        service_date: item.serviceDate,
+        hours: item.hours,
+        rate: item.rate,
+        amount: amount
+      });
+    }
+
+    // Get referral source name
+    let referralSourceName = null;
+    if (client.referral_source_id) {
+      const rsResult = await db.query(
+        'SELECT name FROM referral_sources WHERE id = $1',
+        [client.referral_source_id]
+      );
+      referralSourceName = rsResult.rows[0]?.name;
+    }
+
+    res.json({
+      ...invoice,
+      first_name: client.first_name,
+      last_name: client.last_name,
+      referral_source_name: referralSourceName,
+      line_items: insertedLineItems,
+      total_hours: insertedLineItems.reduce((sum, item) => sum + parseFloat(item.hours), 0)
+    });
+
+  } catch (error) {
+    console.error('Error creating manual invoice:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Batch generate invoices
+router.post('/invoices/batch-generate', auth, async (req, res) => {
+  const { billingPeriodStart, billingPeriodEnd, clientFilter, referralSourceId } = req.body;
+
+  if (!billingPeriodStart || !billingPeriodEnd) {
+    return res.status(400).json({ error: 'Billing period is required' });
+  }
+
+  try {
+    let clientQuery = `
+      SELECT DISTINCT c.id, c.first_name, c.last_name, c.referral_source_id, c.care_type_id,
+                      c.is_private_pay
+      FROM clients c
+      JOIN time_entries te ON te.client_id = c.id
+      WHERE te.start_time >= $1 
+        AND te.start_time < ($2::date + INTERVAL '1 day')
+        AND te.is_complete = true
+        AND (c.status = 'active' OR c.is_active = true)
+    `;
+    const params = [billingPeriodStart, billingPeriodEnd];
+
+    if (clientFilter === 'insurance') {
+      clientQuery += ` AND c.referral_source_id IS NOT NULL AND c.is_private_pay IS NOT TRUE`;
+    } else if (clientFilter === 'private') {
+      clientQuery += ` AND (c.referral_source_id IS NULL OR c.is_private_pay = TRUE)`;
+    }
+
+    if (referralSourceId) {
+      clientQuery += ` AND c.referral_source_id = $${params.length + 1}`;
+      params.push(referralSourceId);
+    }
+
+    clientQuery += ` ORDER BY c.last_name, c.first_name`;
+
+    const clientsResult = await db.query(clientQuery, params);
+
+    let generatedCount = 0;
+    let skippedCount = 0;
+    let totalAmount = 0;
+    let totalHours = 0;
+    const generatedInvoices = [];
+    const skippedClients = [];
+
+    for (const client of clientsResult.rows) {
+      const existingResult = await db.query(`
+        SELECT id, invoice_number FROM invoices 
+        WHERE client_id = $1 
+          AND billing_period_start = $2 
+          AND billing_period_end = $3
+      `, [client.id, billingPeriodStart, billingPeriodEnd]);
+
+      if (existingResult.rows.length > 0) {
+        skippedCount++;
+        skippedClients.push({
+          name: `${client.first_name} ${client.last_name}`,
+          reason: `Invoice ${existingResult.rows[0].invoice_number} already exists`
+        });
+        continue;
+      }
+
+      const { lineItems, total } = await generateLineItems(
+        client.id,
+        client.referral_source_id,
+        client.care_type_id,
+        billingPeriodStart,
+        billingPeriodEnd
+      );
+
+      if (lineItems.length === 0 || total <= 0) {
+        skippedCount++;
+        skippedClients.push({
+          name: `${client.first_name} ${client.last_name}`,
+          reason: 'No billable hours found'
+        });
+        continue;
+      }
+
+      const dueDate = new Date(billingPeriodEnd);
+      dueDate.setDate(dueDate.getDate() + 30);
+
+      const invoiceNumber = generateInvoiceNumber(client.id);
+
+      const invoiceResult = await db.query(`
+        INSERT INTO invoices (
+          client_id, invoice_number, billing_period_start, billing_period_end,
+          subtotal, total, payment_status, payment_due_date,
+          referral_source_id, invoice_type
+        ) VALUES ($1, $2, $3, $4, $5, $6, 'pending', $7, $8, $9)
+        RETURNING *
+      `, [
+        client.id, invoiceNumber, billingPeriodStart, billingPeriodEnd,
+        total, total, dueDate,
+        client.referral_source_id,
+        client.is_private_pay ? 'private_pay' : 'insurance'
+      ]);
+
+      const invoice = invoiceResult.rows[0];
+      await insertLineItems(invoice.id, lineItems);
+
+      const hours = lineItems.reduce((sum, item) => sum + parseFloat(item.hours), 0);
+
+      generatedCount++;
+      totalAmount += total;
+      totalHours += hours;
+
+      generatedInvoices.push({
+        invoiceNumber,
+        clientName: `${client.first_name} ${client.last_name}`,
+        total,
+        hours
+      });
+    }
+
+    res.json({
+      count: generatedCount,
+      skipped: skippedCount,
+      total: totalAmount,
+      totalHours: totalHours,
+      invoices: generatedInvoices,
+      skippedClients: skippedClients
+    });
+
+  } catch (error) {
+    console.error('Error in batch generation:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update invoice payment status
+router.put('/invoices/:id/payment-status', auth, async (req, res) => {
+  const { status, paymentDate } = req.body;
+  
+  try {
+    const result = await db.query(`
+      UPDATE invoices 
+      SET payment_status = $1,
+          payment_date = $2,
+          paid_at = CASE WHEN $1 = 'paid' THEN NOW() ELSE paid_at END,
+          amount_paid = CASE WHEN $1 = 'paid' THEN total ELSE amount_paid END,
+          updated_at = NOW()
+      WHERE id = $3
+      RETURNING *
+    `, [status, paymentDate || new Date(), req.params.id]);
+
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    console.error('Error updating invoice status:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete invoice
+router.delete('/invoices/:id', auth, async (req, res) => {
+  try {
+    // Check if invoice exists
+    const invoiceCheck = await db.query('SELECT id, invoice_number FROM invoices WHERE id = $1', [req.params.id]);
+    if (invoiceCheck.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+    
+    const invoiceNumber = invoiceCheck.rows[0].invoice_number;
+
+    // Delete line items first (foreign key constraint)
+    await db.query('DELETE FROM invoice_line_items WHERE invoice_id = $1', [req.params.id]);
+    
+    // Delete payments if table exists
+    try {
+      await db.query('DELETE FROM invoice_payments WHERE invoice_id = $1', [req.params.id]);
+    } catch (e) { /* table might not exist */ }
+    
+    // Delete adjustments if table exists
+    try {
+      await db.query('DELETE FROM invoice_adjustments WHERE invoice_id = $1', [req.params.id]);
+    } catch (e) { /* table might not exist */ }
+    
+    // Delete invoice
+    await db.query('DELETE FROM invoices WHERE id = $1', [req.params.id]);
+
+    res.json({ message: `Invoice ${invoiceNumber} deleted successfully` });
+  } catch (error) {
+    console.error('Error deleting invoice:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== INVOICE PAYMENTS ====================
+
+router.get('/invoice-payments', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ip.*, i.invoice_number,
+        CONCAT(c.first_name, ' ', c.last_name) as client_name
+      FROM invoice_payments ip
+      JOIN invoices i ON ip.invoice_id = i.id
+      JOIN clients c ON i.client_id = c.id
+      ORDER BY ip.payment_date DESC
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Error fetching payments:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/invoice-payments', auth, async (req, res) => {
+  const { invoiceId, amount, paymentDate, paymentMethod, referenceNumber, notes } = req.body;
+  try {
+    const paymentResult = await db.query(`
+      INSERT INTO invoice_payments (invoice_id, amount, payment_date, payment_method, reference_number, notes)
+      VALUES ($1, $2, $3, $4, $5, $6)
+      RETURNING *
+    `, [invoiceId, amount, paymentDate, paymentMethod, referenceNumber, notes]);
+
+    await db.query(`
+      UPDATE invoices 
+      SET amount_paid = COALESCE(amount_paid, 0) + $1,
+          payment_status = CASE 
+            WHEN COALESCE(amount_paid, 0) + $1 >= total THEN 'paid'
+            WHEN COALESCE(amount_paid, 0) + $1 > 0 THEN 'partial'
+            ELSE 'pending'
+          END,
+          payment_date = CASE WHEN COALESCE(amount_paid, 0) + $1 >= total THEN $2 ELSE payment_date END,
+          paid_at = CASE WHEN COALESCE(amount_paid, 0) + $1 >= total THEN NOW() ELSE paid_at END
+      WHERE id = $3
+    `, [amount, paymentDate, invoiceId]);
+
+    res.json(paymentResult.rows[0]);
+  } catch (error) {
+    console.error('Error recording payment:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== INVOICE ADJUSTMENTS ====================
+
+router.get('/invoice-adjustments', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ia.*, i.invoice_number,
+        CONCAT(c.first_name, ' ', c.last_name) as client_name
+      FROM invoice_adjustments ia
+      JOIN invoices i ON ia.invoice_id = i.id
+      JOIN clients c ON i.client_id = c.id
+      ORDER BY ia.created_at DESC
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Error fetching adjustments:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/invoice-adjustments', auth, async (req, res) => {
+  const { invoiceId, amount, type, reason, notes } = req.body;
+  try {
+    const result = await db.query(`
+      INSERT INTO invoice_adjustments (invoice_id, amount, adjustment_type, reason, notes)
+      VALUES ($1, $2, $3, $4, $5)
+      RETURNING *
+    `, [invoiceId, amount, type, reason, notes]);
+
+    if (type === 'write_off' || type === 'discount') {
+      await db.query(`
+        UPDATE invoices 
+        SET amount_adjusted = COALESCE(amount_adjusted, 0) + $1,
+            payment_status = CASE 
+              WHEN COALESCE(amount_paid, 0) + COALESCE(amount_adjusted, 0) + $1 >= total THEN 'paid'
+              ELSE payment_status
+            END
+        WHERE id = $2
+      `, [amount, invoiceId]);
+    }
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    console.error('Error recording adjustment:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== REFERRAL SOURCE RATES ====================
+
+router.get('/referral-source-rates', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT rsr.*, 
+        rs.name as referral_source_name,
+        ct.name as care_type_name
+      FROM referral_source_rates rsr
+      LEFT JOIN referral_sources rs ON rsr.referral_source_id = rs.id
+      LEFT JOIN care_types ct ON rsr.care_type_id = ct.id
+      ORDER BY rs.name, ct.name
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Error fetching rates:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/referral-source-rates', auth, async (req, res) => {
+  const { referralSourceId, careTypeId, rateAmount, rateType, effectiveDate } = req.body;
+  try {
+    const existing = await db.query(`
+      SELECT id FROM referral_source_rates 
+      WHERE referral_source_id = $1 
+        AND (care_type_id = $2 OR (care_type_id IS NULL AND $2 IS NULL))
+        AND (is_active = true OR is_active IS NULL)
+    `, [referralSourceId, careTypeId || null]);
+
+    if (existing.rows.length > 0) {
+      await db.query(`
+        UPDATE referral_source_rates 
+        SET is_active = false, end_date = $1
+        WHERE id = $2
+      `, [effectiveDate || new Date(), existing.rows[0].id]);
+    }
+
+    const result = await db.query(`
+      INSERT INTO referral_source_rates (referral_source_id, care_type_id, rate_amount, rate_type, effective_date, is_active)
+      VALUES ($1, $2, $3, $4, $5, true)
+      RETURNING *
+    `, [referralSourceId, careTypeId || null, rateAmount, rateType || 'hourly', effectiveDate || new Date()]);
+    
+    res.json(result.rows[0]);
+  } catch (error) {
+    console.error('Error creating rate:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.delete('/referral-source-rates/:id', auth, async (req, res) => {
+  try {
+    const result = await db.query('DELETE FROM referral_source_rates WHERE id = $1 RETURNING *', [req.params.id]);
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Rate not found' });
+    }
+    res.json({ message: 'Rate deleted' });
+  } catch (error) {
+    console.error('Error deleting rate:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== EXPORTS ====================
+
+router.get('/export/invoices-csv', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT 
+        i.invoice_number,
+        i.billing_period_start,
+        i.billing_period_end,
+        c.first_name || ' ' || c.last_name as client_name,
+        COALESCE(rs.name, 'Private Pay') as payer,
+        i.total,
+        COALESCE(i.amount_paid, 0) as amount_paid,
+        i.total - COALESCE(i.amount_paid, 0) - COALESCE(i.amount_adjusted, 0) as balance,
+        i.payment_status,
+        i.payment_due_date,
+        i.created_at
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      LEFT JOIN referral_sources rs ON i.referral_source_id = rs.id
+      ORDER BY i.created_at DESC
+    `);
+
+    const headers = [
+      'Invoice Number', 'Period Start', 'Period End', 'Client', 'Payer',
+      'Total', 'Paid', 'Balance', 'Status', 'Due Date', 'Created'
+    ];
+
+    const rows = result.rows.map(row => [
+      row.invoice_number,
+      row.billing_period_start,
+      row.billing_period_end,
+      row.client_name,
+      row.payer,
+      row.total,
+      row.amount_paid,
+      row.balance,
+      row.payment_status,
+      row.payment_due_date,
+      row.created_at
+    ]);
+
+    const csv = [
+      headers.join(','),
+      ...rows.map(r => r.map(cell => `"${cell || ''}"`).join(','))
+    ].join('\n');
+
+    res.setHeader('Content-Type', 'text/csv');
+    res.setHeader('Content-Disposition', `attachment; filename=invoices-${new Date().toISOString().split('T')[0]}.csv`);
+    res.send(csv);
+  } catch (error) {
+    console.error('Error exporting invoices:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.get('/export/evv', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT 
+        te.id,
+        te.start_time,
+        te.end_time,
+        CASE 
+          WHEN te.duration_minutes IS NOT NULL THEN te.duration_minutes / 60.0
+          WHEN te.end_time IS NOT NULL THEN 
+            EXTRACT(EPOCH FROM (te.end_time - te.start_time)) / 3600.0
+          ELSE 0
+        END as hours,
+        te.clock_in_location,
+        te.clock_out_location,
+        c.first_name as client_first_name,
+        c.last_name as client_last_name,
+        c.medicaid_id,
+        u.first_name as caregiver_first_name,
+        u.last_name as caregiver_last_name,
+        cp.npi_number
+      FROM time_entries te
+      JOIN clients c ON te.client_id = c.id
+      JOIN users u ON te.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      WHERE te.start_time >= CURRENT_DATE - INTERVAL '30 days'
+        AND te.is_complete = true
+      ORDER BY te.start_time DESC
+    `);
+
+    const headers = [
+      'ServiceDate', 'ClientFirstName', 'ClientLastName', 'MedicaidID',
+      'ProviderFirstName', 'ProviderLastName', 'NPI',
+      'ClockInTime', 'ClockOutTime', 'TotalHours',
+      'ClockInLatitude', 'ClockInLongitude', 'ClockOutLatitude', 'ClockOutLongitude',
+      'VerificationMethod'
+    ];
+
+    const rows = result.rows.map(row => {
+      const clockInLoc = row.clock_in_location || {};
+      const clockOutLoc = row.clock_out_location || {};
+      return [
+        new Date(row.start_time).toISOString().split('T')[0],
+        row.client_first_name,
+        row.client_last_name,
+        row.medicaid_id || '',
+        row.caregiver_first_name,
+        row.caregiver_last_name,
+        row.npi_number || '',
+        new Date(row.start_time).toISOString(),
+        row.end_time ? new Date(row.end_time).toISOString() : '',
+        parseFloat(row.hours).toFixed(2),
+        clockInLoc.latitude || clockInLoc.lat || '',
+        clockInLoc.longitude || clockInLoc.lng || '',
+        clockOutLoc.latitude || clockOutLoc.lat || '',
+        clockOutLoc.longitude || clockOutLoc.lng || '',
+        'GPS'
+      ];
+    });
+
+    const csv = [
+      headers.join(','),
+      ...rows.map(r => r.map(cell => `"${cell}"`).join(','))
+    ].join('\n');
+
+    res.setHeader('Content-Type', 'text/csv');
+    res.setHeader('Content-Disposition', `attachment; filename=evv-export-${new Date().toISOString().split('T')[0]}.csv`);
+    res.send(csv);
+  } catch (error) {
+    console.error('Error exporting EVV:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== BILLING SUMMARY ====================
+
+router.get('/billing-summary', auth, async (req, res) => {
+  const { startDate, endDate } = req.query;
+  
+  try {
+    const billedResult = await db.query(`
+      SELECT 
+        COUNT(*) as invoice_count,
+        COALESCE(SUM(total), 0) as total_billed,
+        COALESCE(SUM(amount_paid), 0) as total_collected,
+        COALESCE(SUM(total - COALESCE(amount_paid, 0) - COALESCE(amount_adjusted, 0)), 0) as total_outstanding
+      FROM invoices
+      WHERE ($1::date IS NULL OR created_at >= $1)
+        AND ($2::date IS NULL OR created_at <= $2)
+    `, [startDate || null, endDate || null]);
+
+    const byPayerResult = await db.query(`
+      SELECT 
+        COALESCE(rs.name, 'Private Pay') as payer,
+        COUNT(*) as invoice_count,
+        COALESCE(SUM(i.total), 0) as total_billed,
+        COALESCE(SUM(i.amount_paid), 0) as total_collected
+      FROM invoices i
+      LEFT JOIN referral_sources rs ON i.referral_source_id = rs.id
+      WHERE ($1::date IS NULL OR i.created_at >= $1)
+        AND ($2::date IS NULL OR i.created_at <= $2)
+      GROUP BY rs.name
+      ORDER BY total_billed DESC
+    `, [startDate || null, endDate || null]);
+
+    const byCaregiverResult = await db.query(`
+      SELECT 
+        u.first_name || ' ' || u.last_name as caregiver_name,
+        COALESCE(SUM(ili.hours), 0) as total_hours,
+        COALESCE(SUM(ili.amount), 0) as total_billed
+      FROM invoice_line_items ili
+      JOIN invoices i ON ili.invoice_id = i.id
+      LEFT JOIN users u ON ili.caregiver_id = u.id
+      WHERE ($1::date IS NULL OR i.created_at >= $1)
+        AND ($2::date IS NULL OR i.created_at <= $2)
+      GROUP BY u.first_name, u.last_name
+      ORDER BY total_hours DESC
+    `, [startDate || null, endDate || null]);
+
+    res.json({
+      summary: billedResult.rows[0],
+      byPayer: byPayerResult.rows,
+      byCaregiver: byCaregiverResult.rows
+    });
+  } catch (error) {
+    console.error('Error generating billing summary:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/caregiverRoutes.js b/templates/crm-homecare/backend/src/routes/caregiverRoutes.js
new file mode 100644
index 0000000..5aa4c78
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/caregiverRoutes.js
@@ -0,0 +1,327 @@
+// routes/caregiverRoutes.js
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// GET /api/caregivers - All active caregivers
+router.get('/', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT id, email, first_name, last_name, phone, hire_date, is_active, certifications, role, default_pay_rate,
+              address, city, state, zip, latitude, longitude
+       FROM users WHERE role = 'caregiver' AND is_active = true ORDER BY first_name`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/available - Find available caregivers for a shift
+router.get('/available', verifyToken, async (req, res) => {
+  try {
+    const { date, dayOfWeek, startTime, endTime } = req.query;
+    if (!dayOfWeek || !startTime || !endTime) return res.status(400).json({ error: 'dayOfWeek, startTime, and endTime are required' });
+
+    const dayMap = { 0: 'sunday', 1: 'monday', 2: 'tuesday', 3: 'wednesday', 4: 'thursday', 5: 'friday', 6: 'saturday' };
+    const dayName = dayMap[parseInt(dayOfWeek)];
+    const availableField = `${dayName}_available`;
+    const startField = `${dayName}_start_time`;
+    const endField = `${dayName}_end_time`;
+
+    let query = `
+      SELECT u.id, u.first_name, u.last_name, ca.${availableField}, ca.${startField}, ca.${endField}
+      FROM users u
+      LEFT JOIN caregiver_availability ca ON u.id = ca.caregiver_id
+      WHERE u.role = 'caregiver'
+      AND ca.${availableField} = true
+      AND ca.${startField} <= $1
+      AND ca.${endField} >= $2
+    `;
+    const params = [startTime, endTime];
+    if (date) {
+      query += ` AND NOT EXISTS (SELECT 1 FROM caregiver_blackout_dates WHERE caregiver_id = u.id AND start_date <= $3 AND end_date >= $3)`;
+      params.push(date);
+    }
+    query += ` ORDER BY u.first_name, u.last_name`;
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PUT /api/caregivers/:id - Update caregiver info
+router.put('/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { firstName, lastName, email, phone, payRate, address, city, state, zip,
+            latitude, longitude, hireDate, emergencyContactName, emergencyContactPhone,
+            isActive, notes } = req.body;
+    if (email) {
+      const existing = await db.query('SELECT id FROM users WHERE email = $1 AND id != $2', [email, req.params.id]);
+      if (existing.rows.length > 0) return res.status(409).json({ error: 'Email already in use by another account' });
+    }
+    const result = await db.query(
+      `UPDATE users SET 
+        first_name = COALESCE($1, first_name), last_name = COALESCE($2, last_name),
+        email = COALESCE($3, email), phone = COALESCE($4, phone),
+        default_pay_rate = COALESCE($5, default_pay_rate), address = COALESCE($6, address),
+        city = COALESCE($7, city), state = COALESCE($8, state), zip = COALESCE($9, zip),
+        latitude = COALESCE($10, latitude), longitude = COALESCE($11, longitude),
+        hire_date = COALESCE($12, hire_date),
+        emergency_contact_name = COALESCE($13, emergency_contact_name),
+        emergency_contact_phone = COALESCE($14, emergency_contact_phone),
+        is_active = COALESCE($15, is_active), updated_at = NOW()
+       WHERE id = $16 AND role = 'caregiver'
+       RETURNING id, email, first_name, last_name, phone, default_pay_rate, address, city, state, zip,
+                 latitude, longitude, hire_date, emergency_contact_name, emergency_contact_phone, is_active, created_at`,
+      [firstName, lastName, email, phone, payRate, address, city, state, zip,
+       latitude, longitude, hireDate || null, emergencyContactName, emergencyContactPhone, isActive, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver not found' });
+    await auditLog(req.user.id, 'UPDATE', 'users', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:id/summary - Full earnings/hours/clients summary
+router.get('/:id/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const caregiverId = req.params.id;
+    const safeQuery = async (q, params) => {
+      try { return await db.query(q, params); } catch(e) { console.error('[summary query error]', e.message); return { rows: [] }; }
+    };
+    const [userRes, earningsRes, clientsRes, recentShiftsRes, scheduleRes, ratesRes] = await Promise.all([
+      safeQuery(`SELECT u.*, cp.notes, cp.capabilities, cp.limitations FROM users u LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id WHERE u.id = $1`, [caregiverId]),
+      safeQuery(`SELECT COUNT(*) as total_shifts, COUNT(*) FILTER (WHERE is_complete = true) as completed_shifts,
+        ROUND(COALESCE(SUM(CASE WHEN te.is_complete THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0 ELSE 0 END), 0)::numeric, 2) as total_hours,
+        ROUND(COALESCE(SUM(CASE WHEN te.is_complete THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0 * COALESCE(u.default_pay_rate,0) ELSE 0 END), 0)::numeric, 2) as total_earnings,
+        ROUND(COALESCE(SUM(CASE WHEN te.is_complete AND te.start_time >= NOW() - INTERVAL '7 days' THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0 ELSE 0 END), 0)::numeric, 2) as hours_this_week,
+        ROUND(COALESCE(SUM(CASE WHEN te.is_complete AND te.start_time >= date_trunc('month', NOW()) THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0 * COALESCE(u.default_pay_rate,0) ELSE 0 END), 0)::numeric, 2) as earnings_this_month,
+        ROUND(COALESCE(SUM(CASE WHEN te.is_complete AND te.start_time >= date_trunc('month', NOW()) THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0 ELSE 0 END), 0)::numeric, 2) as hours_this_month,
+        MAX(te.start_time) as last_shift_date
+       FROM time_entries te JOIN users u ON u.id = te.caregiver_id WHERE te.caregiver_id = $1`, [caregiverId]),
+      safeQuery(`SELECT DISTINCT c.id, c.first_name, c.last_name, c.address, c.city,
+        COUNT(te.id) as shift_count, ROUND(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600)::numeric, 1) as total_hours, MAX(te.start_time) as last_visit
+        FROM time_entries te JOIN clients c ON te.client_id = c.id
+        WHERE te.caregiver_id = $1 AND te.is_complete = true
+        GROUP BY c.id, c.first_name, c.last_name, c.address, c.city ORDER BY last_visit DESC`, [caregiverId]),
+      safeQuery(`SELECT te.id, te.start_time, te.end_time, te.is_complete,
+        CASE WHEN te.end_time IS NOT NULL THEN ROUND(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600.0::numeric, 2) ELSE NULL END as hours,
+        c.first_name as client_first, c.last_name as client_last, c.address as client_address
+        FROM time_entries te JOIN clients c ON te.client_id = c.id
+        WHERE te.caregiver_id = $1 ORDER BY te.start_time DESC LIMIT 10`, [caregiverId]),
+      safeQuery(`SELECT s.id, s.caregiver_id, s.client_id, s.date, s.start_time, s.end_time, s.schedule_type, s.notes, s.frequency, s.day_of_week,
+        c.first_name as client_first, c.last_name as client_last, c.address as client_address, c.city as client_city,
+        ROUND(EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time))/3600.0::numeric, 2) as shift_hours
+        FROM schedules s LEFT JOIN clients c ON s.client_id = c.id
+        WHERE s.caregiver_id = $1 AND s.is_active = true
+          AND (s.date >= CURRENT_DATE OR s.day_of_week IS NOT NULL)
+        ORDER BY s.day_of_week NULLS LAST, s.date, s.start_time LIMIT 30`, [caregiverId]),
+      db.query(`SELECT default_pay_rate as rate, hire_date as effective_date, 'Current rate' as notes FROM users WHERE id = $1`, [caregiverId]).catch(() => ({ rows: [] })),
+    ]);
+
+    const now = new Date();
+    const weekStart = new Date(now); weekStart.setDate(now.getDate() - now.getDay()); weekStart.setHours(0,0,0,0);
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate() + 6); weekEnd.setHours(23,59,59,999);
+    const scheduledWeekRes = await safeQuery(`SELECT COALESCE(SUM(EXTRACT(EPOCH FROM (end_time::time - start_time::time))/3600.0), 0) as scheduled_hours_week
+      FROM schedules WHERE caregiver_id = $1 AND is_active = true AND ((date >= $2 AND date <= $3) OR day_of_week = $4)`,
+      [caregiverId, weekStart.toISOString().split('T')[0], weekEnd.toISOString().split('T')[0], now.getDay()]);
+    const earnings = earningsRes.rows[0] || {};
+    const scheduledHrsWeek = parseFloat(scheduledWeekRes.rows[0]?.scheduled_hours_week || 0);
+    if (parseFloat(earnings.hours_this_week || 0) === 0 && scheduledHrsWeek > 0) {
+      earnings.hours_this_week = scheduledHrsWeek.toFixed(2);
+      earnings.hours_this_week_source = 'scheduled';
+    }
+    res.json({ profile: userRes.rows[0], earnings, clients: clientsRes.rows, recentShifts: recentShiftsRes.rows, schedule: scheduleRes.rows, payRates: ratesRes.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/availability
+router.get('/:caregiverId/availability', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM caregiver_availability WHERE caregiver_id = $1`, [req.params.caregiverId]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO caregiver_availability (caregiver_id, status, max_hours_per_week,
+        monday_available, monday_start_time, monday_end_time, tuesday_available, tuesday_start_time, tuesday_end_time,
+        wednesday_available, wednesday_start_time, wednesday_end_time, thursday_available, thursday_start_time, thursday_end_time,
+        friday_available, friday_start_time, friday_end_time, saturday_available, sunday_available)
+        VALUES ($1, $2, $3, true, '08:00', '17:00', true, '08:00', '17:00', true, '08:00', '17:00', true, '08:00', '17:00', true, '08:00', '17:00', false, false)`,
+        [req.params.caregiverId, 'available', 40]);
+      result = await db.query(`SELECT * FROM caregiver_availability WHERE caregiver_id = $1`, [req.params.caregiverId]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PUT /api/caregivers/:caregiverId/availability
+router.put('/:caregiverId/availability', verifyToken, async (req, res) => {
+  try {
+    const { status, maxHoursPerWeek, mondayAvailable, mondayStartTime, mondayEndTime, tuesdayAvailable, tuesdayStartTime, tuesdayEndTime,
+      wednesdayAvailable, wednesdayStartTime, wednesdayEndTime, thursdayAvailable, thursdayStartTime, thursdayEndTime,
+      fridayAvailable, fridayStartTime, fridayEndTime, saturdayAvailable, saturdayStartTime, saturdayEndTime,
+      sundayAvailable, sundayStartTime, sundayEndTime } = req.body;
+    const result = await db.query(
+      `UPDATE caregiver_availability SET status=COALESCE($1,status), max_hours_per_week=COALESCE($2,max_hours_per_week),
+        monday_available=COALESCE($3,monday_available), monday_start_time=COALESCE($4,monday_start_time), monday_end_time=COALESCE($5,monday_end_time),
+        tuesday_available=COALESCE($6,tuesday_available), tuesday_start_time=COALESCE($7,tuesday_start_time), tuesday_end_time=COALESCE($8,tuesday_end_time),
+        wednesday_available=COALESCE($9,wednesday_available), wednesday_start_time=COALESCE($10,wednesday_start_time), wednesday_end_time=COALESCE($11,wednesday_end_time),
+        thursday_available=COALESCE($12,thursday_available), thursday_start_time=COALESCE($13,thursday_start_time), thursday_end_time=COALESCE($14,thursday_end_time),
+        friday_available=COALESCE($15,friday_available), friday_start_time=COALESCE($16,friday_start_time), friday_end_time=COALESCE($17,friday_end_time),
+        saturday_available=COALESCE($18,saturday_available), saturday_start_time=COALESCE($19,saturday_start_time), saturday_end_time=COALESCE($20,saturday_end_time),
+        sunday_available=COALESCE($21,sunday_available), sunday_start_time=COALESCE($22,sunday_start_time), sunday_end_time=COALESCE($23,sunday_end_time), updated_at=NOW()
+       WHERE caregiver_id = $24 RETURNING *`,
+      [status, maxHoursPerWeek, mondayAvailable, mondayStartTime, mondayEndTime, tuesdayAvailable, tuesdayStartTime, tuesdayEndTime,
+       wednesdayAvailable, wednesdayStartTime, wednesdayEndTime, thursdayAvailable, thursdayStartTime, thursdayEndTime,
+       fridayAvailable, fridayStartTime, fridayEndTime, saturdayAvailable, saturdayStartTime, saturdayEndTime,
+       sundayAvailable, sundayStartTime, sundayEndTime, req.params.caregiverId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver availability not found' });
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_availability', req.params.caregiverId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/blackout-dates
+router.get('/:caregiverId/blackout-dates', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM caregiver_blackout_dates WHERE caregiver_id = $1 ORDER BY start_date DESC`, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/caregivers/:caregiverId/blackout-dates
+router.post('/:caregiverId/blackout-dates', verifyToken, async (req, res) => {
+  try {
+    const { startDate, endDate, reason } = req.body;
+    if (!startDate || !endDate) return res.status(400).json({ error: 'startDate and endDate are required' });
+    const blackoutId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO caregiver_blackout_dates (id, caregiver_id, start_date, end_date, reason) VALUES ($1, $2, $3, $4, $5) RETURNING *`,
+      [blackoutId, req.params.caregiverId, startDate, endDate, reason || null]
+    );
+    await auditLog(req.user.id, 'CREATE', 'caregiver_blackout_dates', blackoutId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/certifications
+router.get('/:caregiverId/certifications', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM caregiver_certifications WHERE caregiver_id = $1 ORDER BY expiration_date DESC`, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/caregivers/:caregiverId/certifications
+router.post('/:caregiverId/certifications', verifyToken, async (req, res) => {
+  try {
+    const { certificationName, certificationNumber, issuer, issuedDate, expirationDate } = req.body;
+    const certId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO caregiver_certifications (id, caregiver_id, certification_name, certification_number, issuer, issued_date, expiration_date)
+       VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING *`,
+      [certId, req.params.caregiverId, certificationName, certificationNumber, issuer, issuedDate, expirationDate]
+    );
+    await auditLog(req.user.id, 'CREATE', 'caregiver_certifications', certId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// DELETE /api/caregivers/certifications/:certId
+router.delete('/certifications/:certId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM caregiver_certifications WHERE id = $1 RETURNING *`, [req.params.certId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Certification not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_certifications', req.params.certId, null, result.rows[0]);
+    res.json({ message: 'Certification deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/background-check
+router.get('/:caregiverId/background-check', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM background_checks WHERE caregiver_id = $1 ORDER BY check_date DESC LIMIT 1`, [req.params.caregiverId]);
+    res.json(result.rows.length > 0 ? result.rows[0] : null);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/caregivers/:caregiverId/background-check
+router.post('/:caregiverId/background-check', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { checkDate, expirationDate, status, clearanceNumber, notes } = req.body;
+    if (!checkDate || !status) return res.status(400).json({ error: 'Check date and status are required' });
+    const checkId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO background_checks (id, caregiver_id, check_date, expiration_date, status, clearance_number, notes, checked_by)
+       VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING *`,
+      [checkId, req.params.caregiverId, checkDate, expirationDate || null, status, clearanceNumber || null, notes || null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'background_checks', checkId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/training-records
+router.get('/:caregiverId/training-records', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM training_records WHERE caregiver_id = $1 ORDER BY completion_date DESC`, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/caregivers/:caregiverId/training-records
+router.post('/:caregiverId/training-records', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { trainingType, completionDate, expirationDate, certificationNumber, provider, status } = req.body;
+    if (!trainingType || !completionDate) return res.status(400).json({ error: 'Training type and completion date are required' });
+    const recordId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO training_records (id, caregiver_id, training_type, completion_date, expiration_date, certification_number, provider, status, recorded_by)
+       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *`,
+      [recordId, req.params.caregiverId, trainingType, completionDate, expirationDate || null, certificationNumber || null, provider || null, status || 'completed', req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'training_records', recordId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:caregiverId/compliance-documents
+router.get('/:caregiverId/compliance-documents', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM compliance_documents WHERE caregiver_id = $1 ORDER BY upload_date DESC`, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/caregivers/:caregiverId/compliance-documents
+router.post('/:caregiverId/compliance-documents', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { documentType, documentName, expirationDate, fileUrl, notes } = req.body;
+    if (!documentType || !documentName) return res.status(400).json({ error: 'Document type and name are required' });
+    const docId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO compliance_documents (id, caregiver_id, document_type, document_name, expiration_date, file_url, notes, uploaded_by)
+       VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING *`,
+      [docId, req.params.caregiverId, documentType, documentName, expirationDate || null, fileUrl || null, notes || null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'compliance_documents', docId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/caregivers/:id/pay-rate-for-client/:clientId
+router.get('/:id/pay-rate-for-client/:clientId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT cctr.hourly_rate, ct.name as care_type_name, u.default_pay_rate
+      FROM clients c JOIN users u ON u.id = $1
+      LEFT JOIN care_types ct ON c.care_type_id = ct.id
+      LEFT JOIN caregiver_care_type_rates cctr ON cctr.caregiver_id = $1 AND cctr.care_type_id = c.care_type_id AND cctr.is_active = true
+      WHERE c.id = $2
+    `, [req.params.id, req.params.clientId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    const row = result.rows[0];
+    res.json({ hourlyRate: row.hourly_rate || row.default_pay_rate || 15.00, careTypeName: row.care_type_name, isDefaultRate: !row.hourly_rate });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/claimsRoutes.js b/templates/crm-homecare/backend/src/routes/claimsRoutes.js
new file mode 100644
index 0000000..10b0a37
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/claimsRoutes.js
@@ -0,0 +1,286 @@
+// src/routes/claimsRoutes.js
+// Claims Management: Submit, track, export 837P
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { verifyToken: auth } = require('../middleware/auth');
+
+// Get all claims
+router.get('/', auth, async (req, res) => {
+  const { status, payerId, startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT c.*, 
+        rs.name as payer_name,
+        cl.first_name as client_first_name, cl.last_name as client_last_name,
+        i.invoice_number
+      FROM claims c
+      LEFT JOIN referral_sources rs ON c.payer_id = rs.id
+      LEFT JOIN clients cl ON c.client_id = cl.id
+      LEFT JOIN invoices i ON c.invoice_id = i.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status) {
+      params.push(status);
+      query += ` AND c.status = $${params.length}`;
+    }
+    if (payerId) {
+      params.push(payerId);
+      query += ` AND c.payer_id = $${params.length}`;
+    }
+    if (startDate) {
+      params.push(startDate);
+      query += ` AND c.service_date_from >= $${params.length}`;
+    }
+    if (endDate) {
+      params.push(endDate);
+      query += ` AND c.service_date_to <= $${params.length}`;
+    }
+
+    query += ` ORDER BY c.created_at DESC`;
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get claim by ID
+router.get('/:id', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT c.*, 
+        rs.name as payer_name, rs.billing_address, rs.billing_contact,
+        cl.first_name as client_first_name, cl.last_name as client_last_name,
+        cl.medicaid_id, cl.insurance_id,
+        i.invoice_number, i.total as invoice_total
+      FROM claims c
+      LEFT JOIN referral_sources rs ON c.payer_id = rs.id
+      LEFT JOIN clients cl ON c.client_id = cl.id
+      LEFT JOIN invoices i ON c.invoice_id = i.id
+      WHERE c.id = $1
+    `, [req.params.id]);
+
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Claim not found' });
+    }
+
+    // Get status history
+    const history = await db.query(`
+      SELECT * FROM claim_status_history 
+      WHERE claim_id = $1 
+      ORDER BY created_at DESC
+    `, [req.params.id]);
+
+    res.json({ ...result.rows[0], status_history: history.rows });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create claim from invoice
+router.post('/', auth, async (req, res) => {
+  const { invoiceId, procedureCode, diagnosisCode, modifier, placeOfService } = req.body;
+  
+  try {
+    // Get invoice details
+    const invoice = await db.query(`
+      SELECT i.*, c.referral_source_id, c.medicaid_id,
+        c.first_name, c.last_name
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoice.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const inv = invoice.rows[0];
+    const claimNumber = `CLM-${Date.now()}`;
+
+    const result = await db.query(`
+      INSERT INTO claims (
+        invoice_id, claim_number, payer_id, client_id,
+        service_date_from, service_date_to, place_of_service,
+        procedure_code, modifier, diagnosis_code,
+        units, charge_amount, status, created_by
+      ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, 'draft', $13)
+      RETURNING *
+    `, [
+      invoiceId, claimNumber, inv.referral_source_id, inv.client_id,
+      inv.billing_period_start, inv.billing_period_end, placeOfService || '12',
+      procedureCode, modifier, diagnosisCode,
+      inv.total_hours || inv.total, inv.total, req.user.id
+    ]);
+
+    // Log status
+    await db.query(`
+      INSERT INTO claim_status_history (claim_id, status, notes, created_by)
+      VALUES ($1, 'draft', 'Claim created', $2)
+    `, [result.rows[0].id, req.user.id]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update claim status
+router.put('/:id/status', auth, async (req, res) => {
+  const { status, notes, paidAmount, denialReason } = req.body;
+  
+  try {
+    let updateFields = ['status = $1', 'updated_at = NOW()'];
+    let params = [status];
+    let paramIndex = 2;
+
+    if (status === 'submitted') {
+      updateFields.push(`submitted_date = NOW()`);
+    }
+    if (status === 'accepted') {
+      updateFields.push(`accepted_date = NOW()`);
+    }
+    if (status === 'paid' && paidAmount) {
+      updateFields.push(`paid_date = NOW()`, `paid_amount = $${paramIndex}`);
+      params.push(paidAmount);
+      paramIndex++;
+    }
+    if (status === 'denied' && denialReason) {
+      updateFields.push(`denial_reason = $${paramIndex}`);
+      params.push(denialReason);
+      paramIndex++;
+    }
+
+    params.push(req.params.id);
+    
+    await db.query(`
+      UPDATE claims SET ${updateFields.join(', ')} WHERE id = $${paramIndex}
+    `, params);
+
+    // Log status change
+    await db.query(`
+      INSERT INTO claim_status_history (claim_id, status, notes, created_by)
+      VALUES ($1, $2, $3, $4)
+    `, [req.params.id, status, notes, req.user.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Generate 837P file
+router.post('/export/837p', auth, async (req, res) => {
+  const { claimIds } = req.body;
+  
+  try {
+    const claims = await db.query(`
+      SELECT c.*, 
+        rs.name as payer_name, rs.payer_id as payer_identifier,
+        cl.first_name, cl.last_name, cl.medicaid_id, cl.date_of_birth,
+        cl.address, cl.city, cl.state, cl.zip
+      FROM claims c
+      JOIN referral_sources rs ON c.payer_id = rs.id
+      JOIN clients cl ON c.client_id = cl.id
+      WHERE c.id = ANY($1)
+    `, [claimIds]);
+
+    // Generate 837P EDI format (simplified)
+    let edi = '';
+    edi += `ISA*00*          *00*          *ZZ*SENDERID       *ZZ*RECEIVERID     *${formatDate(new Date())}*${formatTime(new Date())}*^*00501*000000001*0*P*:~\n`;
+    edi += `GS*HC*SENDERID*RECEIVERID*${formatDateShort(new Date())}*${formatTime(new Date())}*1*X*005010X222A1~\n`;
+    edi += `ST*837*0001*005010X222A1~\n`;
+    edi += `BHT*0019*00*${Date.now()}*${formatDateShort(new Date())}*${formatTime(new Date())}*CH~\n`;
+
+    // Add claim segments
+    let claimIndex = 1;
+    for (const claim of claims.rows) {
+      edi += `CLM*${claim.claim_number}*${claim.charge_amount}***${claim.place_of_service}:B:1*Y*A*Y*Y~\n`;
+      edi += `HI*ABK:${claim.diagnosis_code || 'Z7689'}~\n`;
+      edi += `SV1*HC:${claim.procedure_code || 'T1019'}${claim.modifier ? ':' + claim.modifier : ''}*${claim.charge_amount}*UN*${claim.units}***1~\n`;
+      edi += `DTP*472*D8*${formatDateShort(new Date(claim.service_date_from))}~\n`;
+      claimIndex++;
+    }
+
+    edi += `SE*${10 + (claimIndex * 4)}*0001~\n`;
+    edi += `GE*1*1~\n`;
+    edi += `IEA*1*000000001~\n`;
+
+    // Update claims as submitted
+    await db.query(`
+      UPDATE claims SET status = 'submitted', submitted_date = NOW()
+      WHERE id = ANY($1) AND status IN ('draft', 'ready')
+    `, [claimIds]);
+
+    res.setHeader('Content-Type', 'text/plain');
+    res.setHeader('Content-Disposition', `attachment; filename=claims-837p-${Date.now()}.edi`);
+    res.send(edi);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get claims summary/dashboard
+router.get('/reports/summary', auth, async (req, res) => {
+  try {
+    const summary = await db.query(`
+      SELECT 
+        status,
+        COUNT(*) as count,
+        SUM(charge_amount) as total_charged,
+        SUM(paid_amount) as total_paid
+      FROM claims
+      GROUP BY status
+    `);
+
+    const byPayer = await db.query(`
+      SELECT 
+        rs.name as payer_name,
+        COUNT(*) as claim_count,
+        SUM(c.charge_amount) as total_charged,
+        SUM(c.paid_amount) as total_paid,
+        SUM(CASE WHEN c.status = 'denied' THEN c.charge_amount ELSE 0 END) as total_denied
+      FROM claims c
+      JOIN referral_sources rs ON c.payer_id = rs.id
+      GROUP BY rs.id, rs.name
+      ORDER BY total_charged DESC
+    `);
+
+    const aging = await db.query(`
+      SELECT
+        SUM(CASE WHEN submitted_date > NOW() - INTERVAL '30 days' THEN charge_amount ELSE 0 END) as under_30,
+        SUM(CASE WHEN submitted_date BETWEEN NOW() - INTERVAL '60 days' AND NOW() - INTERVAL '30 days' THEN charge_amount ELSE 0 END) as days_30_60,
+        SUM(CASE WHEN submitted_date BETWEEN NOW() - INTERVAL '90 days' AND NOW() - INTERVAL '60 days' THEN charge_amount ELSE 0 END) as days_60_90,
+        SUM(CASE WHEN submitted_date < NOW() - INTERVAL '90 days' THEN charge_amount ELSE 0 END) as over_90
+      FROM claims
+      WHERE status IN ('submitted', 'accepted')
+    `);
+
+    res.json({
+      byStatus: summary.rows,
+      byPayer: byPayer.rows,
+      aging: aging.rows[0]
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Helper functions
+function formatDate(date) {
+  return date.toISOString().slice(2, 10).replace(/-/g, '');
+}
+
+function formatDateShort(date) {
+  return date.toISOString().slice(0, 10).replace(/-/g, '');
+}
+
+function formatTime(date) {
+  return date.toISOString().slice(11, 16).replace(/:/g, '');
+}
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/clientPortalRoutes.js b/templates/crm-homecare/backend/src/routes/clientPortalRoutes.js
new file mode 100644
index 0000000..366dbd5
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/clientPortalRoutes.js
@@ -0,0 +1,678 @@
+// routes/clientPortalRoutes.js
+// Client Patient Portal — allows clients to view their own visits, caregivers,
+// invoices, and notifications. Separate auth from users/family tables.
+
+const express = require('express');
+const router  = express.Router();
+const db      = require('../db');
+const auth    = require('../middleware/auth');
+const bcrypt  = require('bcryptjs');
+const jwt     = require('jsonwebtoken');
+const crypto  = require('crypto');
+
+// ─────────────────────────────────────────────────────────────────────────────
+// CLIENT PORTAL AUTH MIDDLEWARE
+// JWT must carry { role: 'client', clientId: uuid }
+// ─────────────────────────────────────────────────────────────────────────────
+const clientAuth = async (req, res, next) => {
+  try {
+    const token = req.headers.authorization?.split(' ')[1];
+    if (!token) return res.status(401).json({ error: 'No token provided' });
+
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+    if (decoded.role !== 'client') {
+      return res.status(403).json({ error: 'Client access required' });
+    }
+
+    // Verify portal is still enabled and client is active
+    const result = await db.query(`
+      SELECT cpa.*, c.first_name, c.last_name, c.is_active
+      FROM client_portal_auth cpa
+      JOIN clients c ON cpa.client_id = c.id
+      WHERE cpa.client_id = $1 AND cpa.portal_enabled = true AND c.is_active = true
+    `, [decoded.clientId]);
+
+    if (result.rows.length === 0) {
+      return res.status(403).json({ error: 'Portal access revoked or client inactive' });
+    }
+
+    req.clientId   = decoded.clientId;
+    req.portalUser = result.rows[0];
+    next();
+  } catch (error) {
+    return res.status(401).json({ error: 'Invalid or expired token' });
+  }
+};
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PUBLIC: CLIENT LOGIN
+// POST /api/client-portal/login
+// ─────────────────────────────────────────────────────────────────────────────
+router.post('/login', async (req, res) => {
+  const { email, password } = req.body;
+  if (!email || !password) {
+    return res.status(400).json({ error: 'Email and password are required' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT cpa.*, c.first_name, c.last_name, c.is_active
+      FROM client_portal_auth cpa
+      JOIN clients c ON cpa.client_id = c.id
+      WHERE LOWER(cpa.email) = LOWER($1) AND cpa.portal_enabled = true
+    `, [email]);
+
+    if (result.rows.length === 0) {
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    const portal = result.rows[0];
+
+    // Account lockout check
+    if (portal.locked_until && new Date(portal.locked_until) > new Date()) {
+      return res.status(423).json({ error: 'Account temporarily locked. Please try again later.' });
+    }
+
+    if (!portal.password_hash) {
+      return res.status(401).json({ error: 'Account setup not complete. Please check your invite email.' });
+    }
+
+    const valid = await bcrypt.compare(password, portal.password_hash);
+
+    if (!valid) {
+      // Increment failed login count, lock after 5 attempts
+      const failCount = portal.failed_login_count + 1;
+      const lockUntil = failCount >= 5 ? new Date(Date.now() + 15 * 60 * 1000) : null;
+
+      await db.query(`
+        UPDATE client_portal_auth
+        SET failed_login_count = $1, locked_until = $2, updated_at = NOW()
+        WHERE client_id = $3
+      `, [failCount, lockUntil, portal.client_id]);
+
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    // Successful login — reset fail count, update last_login
+    await db.query(`
+      UPDATE client_portal_auth
+      SET failed_login_count = 0, locked_until = NULL, last_login = NOW(), updated_at = NOW()
+      WHERE client_id = $1
+    `, [portal.client_id]);
+
+    const token = jwt.sign(
+      { role: 'client', clientId: portal.client_id },
+      process.env.JWT_SECRET,
+      { expiresIn: '8h' }
+    );
+
+    res.json({
+      token,
+      client: {
+        id:        portal.client_id,
+        firstName: portal.first_name,
+        lastName:  portal.last_name,
+        email:     portal.email,
+      }
+    });
+  } catch (error) {
+    console.error('[ClientPortal] login error:', error.message);
+    res.status(500).json({ error: 'Server error' });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PUBLIC: ACCEPT INVITE & SET PASSWORD
+// POST /api/client-portal/set-password
+// Body: { token, password }
+// ─────────────────────────────────────────────────────────────────────────────
+router.post('/set-password', async (req, res) => {
+  const { token, password } = req.body;
+  if (!token || !password) {
+    return res.status(400).json({ error: 'Token and password are required' });
+  }
+  if (password.length < 8) {
+    return res.status(400).json({ error: 'Password must be at least 8 characters' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT * FROM client_portal_auth
+      WHERE invite_token = $1 AND invite_expires_at > NOW()
+    `, [token]);
+
+    if (result.rows.length === 0) {
+      return res.status(400).json({ error: 'Invalid or expired invite link. Please contact your care coordinator.' });
+    }
+
+    const passwordHash = await bcrypt.hash(password, 12);
+
+    await db.query(`
+      UPDATE client_portal_auth
+      SET password_hash  = $1,
+          invite_token   = NULL,
+          invite_expires_at = NULL,
+          portal_enabled = true,
+          updated_at     = NOW()
+      WHERE client_id = $2
+    `, [passwordHash, result.rows[0].client_id]);
+
+    res.json({ success: true, message: 'Password set. You can now log in.' });
+  } catch (error) {
+    console.error('[ClientPortal] set-password error:', error.message);
+    res.status(500).json({ error: 'Server error' });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET MY PROFILE
+// GET /api/client-portal/portal/me
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/me', clientAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        c.id, c.first_name, c.last_name, c.date_of_birth,
+        c.phone, c.email, c.address, c.city, c.state, c.zip,
+        c.service_type, c.start_date,
+        cpa.email as portal_email, cpa.last_login
+      FROM clients c
+      JOIN client_portal_auth cpa ON cpa.client_id = c.id
+      WHERE c.id = $1
+    `, [req.clientId]);
+
+    res.json(result.rows[0] || null);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET UPCOMING SCHEDULED VISITS
+// GET /api/client-portal/portal/visits
+// Query: ?limit=20&offset=0&past=false
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/visits', clientAuth, async (req, res) => {
+  const limit  = Math.min(parseInt(req.query.limit)  || 20, 50);
+  const offset = parseInt(req.query.offset) || 0;
+  const past   = req.query.past === 'true';
+
+  try {
+    const result = await db.query(`
+      SELECT
+        sv.id, sv.scheduled_date, sv.start_time, sv.end_time, sv.status, sv.notes,
+        sv.cancelled_reason,
+        u.first_name as caregiver_first_name,
+        u.last_name  as caregiver_last_name,
+        u.phone      as caregiver_phone
+      FROM scheduled_visits sv
+      JOIN users u ON sv.caregiver_id = u.id
+      WHERE sv.client_id = $1
+        AND sv.scheduled_date ${past ? '<' : '>='} CURRENT_DATE
+        AND sv.status != 'cancelled'
+      ORDER BY sv.scheduled_date ${past ? 'DESC' : 'ASC'}, sv.start_time ASC
+      LIMIT $2 OFFSET $3
+    `, [req.clientId, limit, offset]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET VISIT HISTORY (completed time entries)
+// GET /api/client-portal/portal/history
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/history', clientAuth, async (req, res) => {
+  const limit  = Math.min(parseInt(req.query.limit) || 20, 50);
+  const offset = parseInt(req.query.offset) || 0;
+
+  try {
+    const result = await db.query(`
+      SELECT
+        te.id, te.start_time, te.end_time, te.duration_minutes, te.notes,
+        u.first_name as caregiver_first_name,
+        u.last_name  as caregiver_last_name
+      FROM time_entries te
+      JOIN users u ON te.caregiver_id = u.id
+      WHERE te.client_id = $1 AND te.is_complete = true
+      ORDER BY te.start_time DESC
+      LIMIT $2 OFFSET $3
+    `, [req.clientId, limit, offset]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET MY CAREGIVERS (active assignments)
+// GET /api/client-portal/portal/caregivers
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/caregivers', clientAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        ca.id as assignment_id, ca.assignment_date, ca.hours_per_week, ca.status,
+        u.id  as caregiver_id,
+        u.first_name, u.last_name, u.phone,
+        u.certifications
+      FROM client_assignments ca
+      JOIN users u ON ca.caregiver_id = u.id
+      WHERE ca.client_id = $1 AND ca.status = 'active'
+      ORDER BY ca.assignment_date DESC
+    `, [req.clientId]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET MY INVOICES
+// GET /api/client-portal/portal/invoices
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/invoices', clientAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        i.id, i.invoice_number, i.billing_period_start, i.billing_period_end,
+        i.subtotal, i.tax, i.total, i.payment_status,
+        i.payment_due_date, i.payment_date, i.created_at
+      FROM invoices i
+      WHERE i.client_id = $1
+      ORDER BY i.created_at DESC
+      LIMIT 24
+    `, [req.clientId]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: GET MY NOTIFICATIONS
+// GET /api/client-portal/portal/notifications
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/portal/notifications', clientAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        cn.id, cn.type, cn.title, cn.message, cn.is_read, cn.created_at,
+        cn.related_visit_id, cn.related_invoice_id, cn.related_caregiver_id
+      FROM client_notifications cn
+      WHERE cn.client_id = $1
+      ORDER BY cn.created_at DESC
+      LIMIT 50
+    `, [req.clientId]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: MARK NOTIFICATION READ
+// PUT /api/client-portal/portal/notifications/:id/read
+// ─────────────────────────────────────────────────────────────────────────────
+router.put('/portal/notifications/:id/read', clientAuth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE client_notifications
+      SET is_read = true
+      WHERE id = $1 AND client_id = $2
+    `, [req.params.id, req.clientId]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: MARK ALL NOTIFICATIONS READ
+// PUT /api/client-portal/portal/notifications/read-all
+// ─────────────────────────────────────────────────────────────────────────────
+router.put('/portal/notifications/read-all', clientAuth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE client_notifications
+      SET is_read = true
+      WHERE client_id = $1 AND is_read = false
+    `, [req.clientId]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// PORTAL: UPDATE NOTIFICATION PREFERENCES
+// PUT /api/client-portal/portal/preferences
+// ─────────────────────────────────────────────────────────────────────────────
+router.put('/portal/preferences', clientAuth, async (req, res) => {
+  const { emailEnabled, portalEnabled, caregiverAlerts, scheduleAlerts, billingAlerts, assignmentAlerts } = req.body;
+
+  try {
+    await db.query(`
+      INSERT INTO client_notification_preferences
+        (client_id, email_enabled, portal_enabled, caregiver_alerts, schedule_alerts, billing_alerts, assignment_alerts)
+      VALUES ($1, $2, $3, $4, $5, $6, $7)
+      ON CONFLICT (client_id) DO UPDATE SET
+        email_enabled     = COALESCE($2, client_notification_preferences.email_enabled),
+        portal_enabled    = COALESCE($3, client_notification_preferences.portal_enabled),
+        caregiver_alerts  = COALESCE($4, client_notification_preferences.caregiver_alerts),
+        schedule_alerts   = COALESCE($5, client_notification_preferences.schedule_alerts),
+        billing_alerts    = COALESCE($6, client_notification_preferences.billing_alerts),
+        assignment_alerts = COALESCE($7, client_notification_preferences.assignment_alerts),
+        updated_at        = NOW()
+    `, [req.clientId, emailEnabled, portalEnabled, caregiverAlerts, scheduleAlerts, billingAlerts, assignmentAlerts]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: INVITE CLIENT TO PORTAL
+// POST /api/client-portal/admin/invite
+// Body: { clientId, email }
+// Requires admin JWT
+// ─────────────────────────────────────────────────────────────────────────────
+router.post('/admin/invite', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { clientId, email } = req.body;
+  if (!clientId || !email) {
+    return res.status(400).json({ error: 'clientId and email are required' });
+  }
+
+  try {
+    // Verify client exists and is active
+    const client = await db.query(
+      'SELECT id, first_name, last_name FROM clients WHERE id = $1 AND is_active = true',
+      [clientId]
+    );
+    if (client.rows.length === 0) {
+      return res.status(404).json({ error: 'Client not found or inactive' });
+    }
+
+    // Generate secure invite token (48hr expiry)
+    const inviteToken   = crypto.randomBytes(32).toString('hex');
+    const inviteExpires = new Date(Date.now() + 48 * 60 * 60 * 1000);
+
+    await db.query(`
+      INSERT INTO client_portal_auth
+        (client_id, email, invite_token, invite_expires_at, portal_enabled)
+      VALUES ($1, $2, $3, $4, false)
+      ON CONFLICT (client_id) DO UPDATE SET
+        email             = $2,
+        invite_token      = $3,
+        invite_expires_at = $4,
+        updated_at        = NOW()
+    `, [clientId, email, inviteToken, inviteExpires]);
+
+    // TODO: Send invite email via your email service
+    // The invite URL would be: https://your-app.com/portal/setup?token=<inviteToken>
+    const inviteUrl = `${process.env.FRONTEND_URL || 'https://chippewa-home-care.netlify.app'}/portal/setup?token=${inviteToken}`;
+
+    res.json({
+      success:   true,
+      inviteUrl, // Return URL so admin can manually share if email isn't configured
+      message:   `Invite created for ${client.rows[0].first_name} ${client.rows[0].last_name}`,
+      expiresAt: inviteExpires,
+    });
+  } catch (error) {
+    if (error.code === '23505') {
+      return res.status(400).json({ error: 'A portal account already exists with this email' });
+    }
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: GET PORTAL STATUS FOR ALL CLIENTS
+// GET /api/client-portal/admin/clients
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/admin/clients', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT
+        c.id, c.first_name, c.last_name, c.phone, c.email, c.is_active,
+        cpa.portal_enabled,
+        cpa.email      as portal_email,
+        cpa.last_login,
+        cpa.invite_expires_at,
+        CASE
+          WHEN cpa.invite_token IS NOT NULL AND cpa.invite_expires_at > NOW() THEN 'invite_pending'
+          WHEN cpa.invite_token IS NOT NULL AND cpa.invite_expires_at <= NOW() THEN 'invite_expired'
+          WHEN cpa.portal_enabled = true THEN 'active'
+          WHEN cpa.id IS NOT NULL THEN 'disabled'
+          ELSE 'not_invited'
+        END as portal_status
+      FROM clients c
+      LEFT JOIN client_portal_auth cpa ON cpa.client_id = c.id
+      WHERE c.is_active = true
+      ORDER BY c.last_name, c.first_name
+    `);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: TOGGLE PORTAL ACCESS ON/OFF
+// PUT /api/client-portal/admin/clients/:clientId/toggle
+// ─────────────────────────────────────────────────────────────────────────────
+router.put('/admin/clients/:clientId/toggle', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { enabled } = req.body;
+
+  try {
+    await db.query(`
+      UPDATE client_portal_auth
+      SET portal_enabled = $1, updated_at = NOW()
+      WHERE client_id = $2
+    `, [enabled, req.params.clientId]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: CREATE SCHEDULED VISIT
+// POST /api/client-portal/admin/scheduled-visits
+// ─────────────────────────────────────────────────────────────────────────────
+router.post('/admin/scheduled-visits', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { clientId, caregiverId, assignmentId, scheduledDate, startTime, endTime, notes } = req.body;
+  if (!clientId || !caregiverId || !scheduledDate || !startTime || !endTime) {
+    return res.status(400).json({ error: 'clientId, caregiverId, scheduledDate, startTime, endTime are required' });
+  }
+
+  try {
+    const result = await db.query(`
+      INSERT INTO scheduled_visits
+        (client_id, caregiver_id, assignment_id, scheduled_date, start_time, end_time, notes, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
+      RETURNING *
+    `, [clientId, caregiverId, assignmentId || null, scheduledDate, startTime, endTime, notes || null, req.user.id]);
+
+    // Notify client if they have portal access and schedule alerts enabled
+    const prefs = await db.query(`
+      SELECT cnp.schedule_alerts, cpa.portal_enabled
+      FROM client_notification_preferences cnp
+      JOIN client_portal_auth cpa ON cpa.client_id = cnp.client_id
+      WHERE cnp.client_id = $1
+    `, [clientId]);
+
+    if (prefs.rows[0]?.portal_enabled && prefs.rows[0]?.schedule_alerts) {
+      const caregiver = await db.query(
+        'SELECT first_name, last_name FROM users WHERE id = $1',
+        [caregiverId]
+      );
+      const cg = caregiver.rows[0];
+      await db.query(`
+        INSERT INTO client_notifications
+          (client_id, type, title, message, related_visit_id)
+        VALUES ($1, 'visit_scheduled', 'Visit Scheduled', $2, $3)
+      `, [
+        clientId,
+        `A visit has been scheduled for ${scheduledDate} at ${startTime} with ${cg?.first_name} ${cg?.last_name}.`,
+        result.rows[0].id
+      ]);
+    }
+
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: GET ALL SCHEDULED VISITS
+// GET /api/client-portal/admin/scheduled-visits
+// Query: ?clientId=uuid&caregiverId=uuid&date=YYYY-MM-DD&status=scheduled
+// ─────────────────────────────────────────────────────────────────────────────
+router.get('/admin/scheduled-visits', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { clientId, caregiverId, date, status } = req.query;
+
+  try {
+    let query = `
+      SELECT
+        sv.*,
+        c.first_name  as client_first_name,  c.last_name  as client_last_name,
+        u.first_name  as caregiver_first_name, u.last_name as caregiver_last_name
+      FROM scheduled_visits sv
+      JOIN clients c ON sv.client_id = c.id
+      JOIN users   u ON sv.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (clientId)   { params.push(clientId);   query += ` AND sv.client_id = $${params.length}`; }
+    if (caregiverId){ params.push(caregiverId); query += ` AND sv.caregiver_id = $${params.length}`; }
+    if (date)       { params.push(date);        query += ` AND sv.scheduled_date = $${params.length}`; }
+    if (status)     { params.push(status);      query += ` AND sv.status = $${params.length}`; }
+
+    query += ` ORDER BY sv.scheduled_date ASC, sv.start_time ASC`;
+
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: CANCEL SCHEDULED VISIT
+// PUT /api/client-portal/admin/scheduled-visits/:id/cancel
+// ─────────────────────────────────────────────────────────────────────────────
+router.put('/admin/scheduled-visits/:id/cancel', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { reason } = req.body;
+
+  try {
+    const result = await db.query(`
+      UPDATE scheduled_visits
+      SET status           = 'cancelled',
+          cancelled_reason = $1,
+          cancelled_by     = $2,
+          cancelled_at     = NOW(),
+          updated_at       = NOW()
+      WHERE id = $3
+      RETURNING client_id, scheduled_date, start_time
+    `, [reason || null, req.user.id, req.params.id]);
+
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Visit not found' });
+    }
+
+    const visit = result.rows[0];
+
+    // Notify client
+    const prefs = await db.query(`
+      SELECT cnp.schedule_alerts, cpa.portal_enabled
+      FROM client_notification_preferences cnp
+      JOIN client_portal_auth cpa ON cpa.client_id = cnp.client_id
+      WHERE cnp.client_id = $1
+    `, [visit.client_id]);
+
+    if (prefs.rows[0]?.portal_enabled && prefs.rows[0]?.schedule_alerts) {
+      await db.query(`
+        INSERT INTO client_notifications
+          (client_id, type, title, message, related_visit_id)
+        VALUES ($1, 'visit_cancelled', 'Visit Cancelled', $2, $3)
+      `, [
+        visit.client_id,
+        `Your visit on ${visit.scheduled_date} at ${visit.start_time} has been cancelled.${reason ? ' Reason: ' + reason : ''}`,
+        req.params.id
+      ]);
+    }
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─────────────────────────────────────────────────────────────────────────────
+// ADMIN: SEND NOTIFICATION TO CLIENT
+// POST /api/client-portal/admin/notify
+// Body: { clientId, type, title, message, relatedVisitId?, relatedInvoiceId? }
+// ─────────────────────────────────────────────────────────────────────────────
+router.post('/admin/notify', auth, async (req, res) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+
+  const { clientId, type, title, message, relatedVisitId, relatedInvoiceId, relatedCaregiverId } = req.body;
+  if (!clientId || !type || !title) {
+    return res.status(400).json({ error: 'clientId, type, and title are required' });
+  }
+
+  try {
+    const result = await db.query(`
+      INSERT INTO client_notifications
+        (client_id, type, title, message, related_visit_id, related_invoice_id, related_caregiver_id)
+      VALUES ($1, $2, $3, $4, $5, $6, $7)
+      RETURNING *
+    `, [clientId, type, title, message || null, relatedVisitId || null, relatedInvoiceId || null, relatedCaregiverId || null]);
+
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/clientsRoutes.js b/templates/crm-homecare/backend/src/routes/clientsRoutes.js
new file mode 100644
index 0000000..0062241
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/clientsRoutes.js
@@ -0,0 +1,258 @@
+// routes/clientsRoutes.js
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// POST /api/clients
+router.post('/', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, dateOfBirth, phone, email, address, city, state, zip,
+      referredBy, serviceType, referralSourceId, careTypeId,
+      isPrivatePay, privatePayRate, privatePayRateType, weeklyAuthorizedUnits } = req.body;
+    const clientId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO clients (id, first_name, last_name, date_of_birth, phone, email, address, city, state, zip,
+        referred_by, service_type, start_date, referral_source_id, care_type_id,
+        is_private_pay, private_pay_rate, private_pay_rate_type, weekly_authorized_units)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,CURRENT_DATE,$13,$14,$15,$16,$17,$18) RETURNING *`,
+      [clientId, firstName, lastName, dateOfBirth, phone, email, address, city, state, zip,
+       referredBy || referralSourceId, serviceType, referralSourceId, careTypeId,
+       isPrivatePay || false, privatePayRate, privatePayRateType || 'hourly', weeklyAuthorizedUnits || null]
+    );
+    await db.query(`INSERT INTO client_onboarding (client_id) VALUES ($1)`, [clientId]);
+    await auditLog(req.user.id, 'CREATE', 'clients', clientId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients
+router.get('/', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT c.*, rs.name as referral_source_name, ct.name as care_type_name
+       FROM clients c
+       LEFT JOIN referral_sources rs ON c.referral_source_id = rs.id
+       LEFT JOIN care_types ct ON c.care_type_id = ct.id
+       WHERE c.is_active = true ORDER BY c.first_name`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:id
+router.get('/:id', verifyToken, async (req, res) => {
+  try {
+    const [clientResult, emergencyResult, onboardingResult] = await Promise.all([
+      db.query('SELECT * FROM clients WHERE id = $1', [req.params.id]),
+      db.query('SELECT * FROM client_emergency_contacts WHERE client_id = $1', [req.params.id]),
+      db.query('SELECT * FROM client_onboarding WHERE client_id = $1', [req.params.id]),
+    ]);
+    res.json({ client: clientResult.rows[0], emergencyContacts: emergencyResult.rows, onboarding: onboardingResult.rows[0] });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PUT /api/clients/:id
+router.put('/:id', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, dateOfBirth, phone, email, address, city, state, zip,
+      serviceType, medicalConditions, allergies, medications, notes,
+      insuranceProvider, insuranceId, insuranceGroup, gender, preferredCaregivers,
+      emergencyContactName, emergencyContactPhone, emergencyContactRelationship,
+      medicalNotes, doNotUseCaregivers, carePreferences, mobilityAssistanceNeeds,
+      referralSourceId, careTypeId, isPrivatePay, privatePayRate, privatePayRateType, billingNotes,
+      weeklyAuthorizedUnits, serviceDaysPerWeek, serviceAllowedDays } = req.body;
+    const result = await db.query(
+      `UPDATE clients SET
+        first_name=COALESCE($1,first_name), last_name=COALESCE($2,last_name), date_of_birth=$3,
+        phone=$4, email=$5, address=$6, city=$7, state=$8, zip=$9,
+        service_type=COALESCE($10,service_type), medical_conditions=$11, allergies=$12,
+        medications=$13, notes=$14, insurance_provider=$15, insurance_id=$16, insurance_group=$17,
+        gender=$18, preferred_caregivers=$19, emergency_contact_name=$20, emergency_contact_phone=$21,
+        emergency_contact_relationship=$22, medical_notes=$23, do_not_use_caregivers=$24,
+        care_preferences=$25, mobility_assistance_needs=$26, referral_source_id=$27, care_type_id=$28,
+        is_private_pay=COALESCE($29,is_private_pay), private_pay_rate=$30,
+        private_pay_rate_type=COALESCE($31,private_pay_rate_type), billing_notes=$32,
+        weekly_authorized_units=$33, service_days_per_week=COALESCE($34,service_days_per_week),
+        service_allowed_days=COALESCE($35,service_allowed_days), updated_at=NOW()
+       WHERE id=$36 RETURNING *`,
+      [firstName, lastName, dateOfBirth, phone, email, address, city, state, zip,
+       serviceType, medicalConditions, allergies, medications, notes,
+       insuranceProvider, insuranceId, insuranceGroup, gender, preferredCaregivers,
+       emergencyContactName, emergencyContactPhone, emergencyContactRelationship,
+       medicalNotes, doNotUseCaregivers, carePreferences, mobilityAssistanceNeeds,
+       referralSourceId, careTypeId, isPrivatePay, privatePayRate, privatePayRateType, billingNotes,
+       weeklyAuthorizedUnits, serviceDaysPerWeek || null,
+       serviceAllowedDays ? JSON.stringify(serviceAllowedDays) : null, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    await auditLog(req.user.id, 'UPDATE', 'clients', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// DELETE /api/clients/:id
+router.delete('/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const existing = await db.query('SELECT * FROM clients WHERE id = $1', [req.params.id]);
+    if (existing.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    const result = await db.query(`UPDATE clients SET is_active=false, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    await auditLog(req.user.id, 'DELETE', 'clients', req.params.id, existing.rows[0], result.rows[0]);
+    res.json({ message: 'Client deleted successfully', client: result.rows[0] });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:id/onboarding
+router.get('/:id/onboarding', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM client_onboarding WHERE client_id = $1`, [req.params.id]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO client_onboarding (client_id) VALUES ($1)`, [req.params.id]);
+      result = await db.query(`SELECT * FROM client_onboarding WHERE client_id = $1`, [req.params.id]);
+    }
+    res.json(result.rows[0] || {});
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PATCH /api/clients/:id/onboarding/:stepId
+router.patch('/:id/onboarding/:stepId', verifyToken, async (req, res) => {
+  try {
+    const ALLOWED_COLUMNS = new Set(['step_name','step_status','completed_at','completed_by','notes','documents_received',
+      'signature_obtained','effective_date','review_date','assigned_to','form_data','is_complete','skipped','skipped_reason']);
+    const updates = req.body;
+    let updateFields = [], params = [], paramIndex = 1;
+    Object.keys(updates).forEach(key => {
+      if (!ALLOWED_COLUMNS.has(key)) throw new Error(`Invalid field: ${key}`);
+      updateFields.push(`${key} = $${paramIndex}`);
+      params.push(updates[key]);
+      paramIndex++;
+    });
+    if (updateFields.length === 0) return res.json({ message: 'No fields to update' });
+    updateFields.push(`updated_at = NOW()`);
+    params.push(req.params.id);
+    const result = await db.query(
+      `UPDATE client_onboarding SET ${updateFields.join(', ')} WHERE client_id = $${paramIndex} RETURNING *`, params
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Onboarding record not found' });
+    await auditLog(req.user.id, 'UPDATE', 'client_onboarding', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:id/caregiver-view
+router.get('/:id/caregiver-view', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT id, first_name, last_name, date_of_birth, phone, email, address, city, state, zip,
+        emergency_contact_name, emergency_contact_phone, emergency_contact_relationship,
+        medical_conditions, medications, allergies, medical_notes, care_preferences,
+        mobility_assistance_needs, preferred_caregivers, notes
+       FROM clients WHERE id = $1`, [req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:id/visit-notes
+router.get('/:id/visit-notes', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT vn.*, u.first_name || ' ' || u.last_name as caregiver_name
+       FROM client_visit_notes vn LEFT JOIN users u ON vn.caregiver_id = u.id
+       WHERE vn.client_id = $1 ORDER BY vn.created_at DESC LIMIT 50`, [req.params.id]
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/clients/:id/visit-notes
+router.post('/:id/visit-notes', verifyToken, async (req, res) => {
+  try {
+    const noteId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO client_visit_notes (id, client_id, caregiver_id, note) VALUES ($1, $2, $3, $4) RETURNING *`,
+      [noteId, req.params.id, req.user.id, req.body.note]
+    );
+    await auditLog(req.user.id, 'CREATE', 'client_visit_notes', noteId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:clientId/services
+router.get('/:clientId/services', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT cs.*, sp.service_name, sp.client_hourly_rate, sp.caregiver_hourly_rate
+       FROM client_services cs JOIN service_pricing sp ON cs.service_pricing_id = sp.id
+       WHERE cs.client_id = $1 ORDER BY cs.is_primary DESC, sp.service_name`, [req.params.clientId]
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/clients/:clientId/services
+router.post('/:clientId/services', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { servicePricingId, isPrimary, notes } = req.body;
+    if (!servicePricingId) return res.status(400).json({ error: 'servicePricingId is required' });
+    if (isPrimary) await db.query(`UPDATE client_services SET is_primary=false WHERE client_id=$1`, [req.params.clientId]);
+    const assignmentId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO client_services (id, client_id, service_pricing_id, is_primary, notes) VALUES ($1,$2,$3,$4,$5) RETURNING *`,
+      [assignmentId, req.params.clientId, servicePricingId, isPrimary || false, notes || null]
+    );
+    await auditLog(req.user.id, 'CREATE', 'client_services', assignmentId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// DELETE /api/clients/:clientId/services/:serviceId
+router.delete('/:clientId/services/:serviceId', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `DELETE FROM client_services WHERE id=$1 AND client_id=$2 RETURNING *`,
+      [req.params.serviceId, req.params.clientId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Service assignment not found' });
+    await auditLog(req.user.id, 'DELETE', 'client_services', req.params.serviceId, null, result.rows[0]);
+    res.json({ message: 'Service removed from client' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/clients/:id/billing-rate
+router.get('/:id/billing-rate', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT c.is_private_pay,
+        CASE WHEN c.is_private_pay THEN c.private_pay_rate ELSE rsr.rate_amount END as rate_amount,
+        CASE WHEN c.is_private_pay THEN c.private_pay_rate_type ELSE rsr.rate_type END as rate_type,
+        rs.name as referral_source_name, ct.name as care_type_name
+      FROM clients c
+      LEFT JOIN referral_sources rs ON c.referral_source_id = rs.id
+      LEFT JOIN care_types ct ON c.care_type_id = ct.id
+      LEFT JOIN referral_source_rates rsr ON rsr.referral_source_id=c.referral_source_id AND rsr.care_type_id=c.care_type_id AND rsr.is_active=true
+      WHERE c.id = $1`, [req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PUT /api/clients/:id/billing
+router.put('/:id/billing', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { referralSourceId, careTypeId, isPrivatePay, privatePayRate, privatePayRateType, billingNotes } = req.body;
+    const result = await db.query(
+      `UPDATE clients SET referral_source_id=$1, care_type_id=$2, is_private_pay=$3, private_pay_rate=$4,
+        private_pay_rate_type=$5, billing_notes=$6, updated_at=NOW() WHERE id=$7 RETURNING *`,
+      [referralSourceId, careTypeId, isPrivatePay, privatePayRate, privatePayRateType, billingNotes, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    await auditLog(req.user.id, 'UPDATE', 'clients', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/clinicalRoutes.js b/templates/crm-homecare/backend/src/routes/clinicalRoutes.js
new file mode 100644
index 0000000..fa9572c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/clinicalRoutes.js
@@ -0,0 +1,239 @@
+// routes/clinicalRoutes.js — mounted at /api via app.use('/api', clinicalRoutes)
+// Covers: compliance summary, care plans, incidents, performance reviews, schedules-enhanced
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── COMPLIANCE ───────────────────────────────────────────────────────────────
+
+router.get('/compliance/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [expiredBg, expiredTraining, trainingByType, bgStatus] = await Promise.all([
+      db.query(`SELECT COUNT(*) as expired_bg FROM background_checks WHERE expiration_date < CURRENT_DATE`),
+      db.query(`SELECT COUNT(*) as expired_training FROM training_records WHERE expiration_date < CURRENT_DATE AND status != 'expired'`),
+      db.query(`SELECT training_type, COUNT(*) as count FROM training_records WHERE status='completed' GROUP BY training_type ORDER BY count DESC`),
+      db.query(`SELECT status, COUNT(*) as count FROM background_checks GROUP BY status`),
+    ]);
+    res.json({ expiredBackgroundChecks: expiredBg.rows[0].expired_bg, expiredTraining: expiredTraining.rows[0].expired_training, trainingByType: trainingByType.rows, backgroundCheckStatus: bgStatus.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/training-records/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM training_records WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Training record not found' });
+    await auditLog(req.user.id, 'DELETE', 'training_records', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Training record deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/compliance-documents/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM compliance_documents WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Document not found' });
+    await auditLog(req.user.id, 'DELETE', 'compliance_documents', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Document deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/blackout-dates/:dateId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM caregiver_blackout_dates WHERE id=$1 RETURNING *`, [req.params.dateId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Blackout date not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_blackout_dates', req.params.dateId, null, result.rows[0]);
+    res.json({ message: 'Blackout date deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CARE PLANS ───────────────────────────────────────────────────────────────
+
+router.get('/care-plans/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, active, byServiceType, byClient] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total_plans FROM care_plans`),
+      db.query(`SELECT COUNT(*) as active_plans FROM care_plans WHERE (start_date IS NULL OR start_date<=CURRENT_DATE) AND (end_date IS NULL OR end_date>=CURRENT_DATE)`),
+      db.query(`SELECT service_type, COUNT(*) as count FROM care_plans GROUP BY service_type ORDER BY count DESC`),
+      db.query(`SELECT c.id, c.first_name||' '||c.last_name as client_name, COUNT(cp.id) as plan_count FROM clients c LEFT JOIN care_plans cp ON c.id=cp.client_id GROUP BY c.id, c.first_name, c.last_name HAVING COUNT(cp.id)>0 ORDER BY plan_count DESC`),
+    ]);
+    res.json({ total: total.rows[0].total_plans, active: active.rows[0].active_plans, byServiceType: byServiceType.rows, byClient: byClient.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/care-plans/:clientId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM care_plans WHERE client_id=$1 ORDER BY start_date DESC`, [req.params.clientId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/care-plans', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT cp.*, c.first_name||' '||c.last_name as client_name FROM care_plans cp JOIN clients c ON cp.client_id=c.id ORDER BY cp.created_at DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/care-plans', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { clientId, serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate } = req.body;
+    if (!clientId || !serviceType) return res.status(400).json({ error: 'clientId and serviceType are required' });
+    const planId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO care_plans (id, client_id, service_type, service_description, frequency, care_goals, special_instructions, precautions, medication_notes, mobility_notes, dietary_notes, communication_notes, start_date, end_date, created_by)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING *`,
+      [planId, clientId, serviceType, serviceDescription||null, frequency||null, careGoals||null, specialInstructions||null, precautions||null, medicationNotes||null, mobilityNotes||null, dietaryNotes||null, communicationNotes||null, startDate||null, endDate||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'care_plans', planId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/care-plans/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate } = req.body;
+    const result = await db.query(
+      `UPDATE care_plans SET service_type=COALESCE($1,service_type), service_description=COALESCE($2,service_description), frequency=COALESCE($3,frequency), care_goals=COALESCE($4,care_goals), special_instructions=COALESCE($5,special_instructions), precautions=COALESCE($6,precautions), medication_notes=COALESCE($7,medication_notes), mobility_notes=COALESCE($8,mobility_notes), dietary_notes=COALESCE($9,dietary_notes), communication_notes=COALESCE($10,communication_notes), start_date=COALESCE($11,start_date), end_date=COALESCE($12,end_date), updated_at=NOW() WHERE id=$13 RETURNING *`,
+      [serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care plan not found' });
+    await auditLog(req.user.id, 'UPDATE', 'care_plans', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/care-plans/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM care_plans WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care plan not found' });
+    await auditLog(req.user.id, 'DELETE', 'care_plans', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Care plan deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── INCIDENTS ────────────────────────────────────────────────────────────────
+
+router.get('/incidents/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, bySeverity, byType, followUp, monthly, byClient] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total FROM incident_reports`),
+      db.query(`SELECT severity, COUNT(*) as count FROM incident_reports GROUP BY severity ORDER BY CASE severity WHEN 'critical' THEN 1 WHEN 'severe' THEN 2 WHEN 'moderate' THEN 3 WHEN 'minor' THEN 4 END`),
+      db.query(`SELECT incident_type, COUNT(*) as count FROM incident_reports GROUP BY incident_type ORDER BY count DESC`),
+      db.query(`SELECT COUNT(*) as pending_followup FROM incident_reports WHERE follow_up_required=true`),
+      db.query(`SELECT DATE_TRUNC('month', incident_date)::DATE as month, COUNT(*) as count, COUNT(CASE WHEN severity IN ('critical','severe') THEN 1 END) as serious_count FROM incident_reports GROUP BY DATE_TRUNC('month', incident_date) ORDER BY month DESC LIMIT 12`),
+      db.query(`SELECT c.id, c.first_name||' '||c.last_name as client_name, COUNT(ir.id) as incident_count FROM clients c LEFT JOIN incident_reports ir ON c.id=ir.client_id WHERE ir.id IS NOT NULL GROUP BY c.id, c.first_name, c.last_name ORDER BY incident_count DESC LIMIT 10`),
+    ]);
+    res.json({ total: total.rows[0].total, bySeverity: bySeverity.rows, byType: byType.rows, pendingFollowUp: followUp.rows[0].pending_followup, monthlyTrend: monthly.rows, topClients: byClient.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/incidents/:id', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT ir.*, c.first_name||' '||c.last_name as client_name, u.first_name||' '||u.last_name as caregiver_name FROM incident_reports ir LEFT JOIN clients c ON ir.client_id=c.id LEFT JOIN users u ON ir.caregiver_id=u.id WHERE ir.id=$1`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/incidents', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT ir.*, c.first_name||' '||c.last_name as client_name, u.first_name||' '||u.last_name as caregiver_name FROM incident_reports ir LEFT JOIN clients c ON ir.client_id=c.id LEFT JOIN users u ON ir.caregiver_id=u.id ORDER BY ir.incident_date DESC, ir.incident_time DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/incidents', verifyToken, async (req, res) => {
+  try {
+    const { clientId, caregiverId, incidentType, severity, incidentDate, incidentTime, description, witnesses, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes, reportedBy, reportedDate } = req.body;
+    if (!clientId || !incidentType || !description) return res.status(400).json({ error: 'Client, incident type, and description are required' });
+    const incidentId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO incident_reports (id, client_id, caregiver_id, incident_type, severity, incident_date, incident_time, description, witnesses, injuries_or_damage, actions_taken, follow_up_required, follow_up_notes, reported_by, reported_date, reported_by_user_id)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16) RETURNING *`,
+      [incidentId, clientId, caregiverId||null, incidentType, severity||'moderate', incidentDate, incidentTime||null, description, witnesses||null, injuriesOrDamage||null, actionsTaken||null, followUpRequired||false, followUpNotes||null, reportedBy||null, reportedDate||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'incident_reports', incidentId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/incidents/:id', verifyToken, async (req, res) => {
+  try {
+    const { severity, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes } = req.body;
+    const result = await db.query(
+      `UPDATE incident_reports SET severity=COALESCE($1,severity), injuries_or_damage=COALESCE($2,injuries_or_damage), actions_taken=COALESCE($3,actions_taken), follow_up_required=COALESCE($4,follow_up_required), follow_up_notes=COALESCE($5,follow_up_notes), updated_at=NOW() WHERE id=$6 RETURNING *`,
+      [severity, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    await auditLog(req.user.id, 'UPDATE', 'incident_reports', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/incidents/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM incident_reports WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    await auditLog(req.user.id, 'DELETE', 'incident_reports', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Incident report deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── PERFORMANCE REVIEWS ──────────────────────────────────────────────────────
+
+router.get('/performance-reviews/summary/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT COUNT(*) as total_reviews, AVG(CASE WHEN overall_assessment='excellent' THEN 3 WHEN overall_assessment='satisfactory' THEN 2 WHEN overall_assessment='needs_improvement' THEN 1 ELSE 0 END) as avg_score, COUNT(CASE WHEN overall_assessment='excellent' THEN 1 END) as excellent_count, COUNT(CASE WHEN overall_assessment='satisfactory' THEN 1 END) as satisfactory_count, COUNT(CASE WHEN overall_assessment='needs_improvement' THEN 1 END) as needs_improvement_count, MAX(review_date) as last_review_date FROM performance_reviews WHERE caregiver_id=$1`, [req.params.caregiverId])).rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/performance-reviews/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT pr.*, cl.first_name||' '||cl.last_name as client_name FROM performance_reviews pr LEFT JOIN clients cl ON pr.client_id=cl.id WHERE pr.caregiver_id=$1 ORDER BY pr.review_date DESC`, [req.params.caregiverId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/performance-reviews', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT pr.*, c.first_name||' '||c.last_name as caregiver_name, cl.first_name||' '||cl.last_name as client_name FROM performance_reviews pr LEFT JOIN users c ON pr.caregiver_id=c.id LEFT JOIN clients cl ON pr.client_id=cl.id ORDER BY pr.review_date DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/performance-reviews', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, clientId, reviewDate, performanceNotes, strengths, areasForImprovement, overallAssessment } = req.body;
+    if (!caregiverId || !clientId || !performanceNotes) return res.status(400).json({ error: 'Caregiver, client, and performance notes are required' });
+    const reviewId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO performance_reviews (id, caregiver_id, client_id, review_date, performance_notes, strengths, areas_for_improvement, overall_assessment, reviewed_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [reviewId, caregiverId, clientId, reviewDate, performanceNotes, strengths||null, areasForImprovement||null, overallAssessment||'satisfactory', req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'performance_reviews', reviewId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/performance-reviews/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM performance_reviews WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Review not found' });
+    await auditLog(req.user.id, 'DELETE', 'performance_reviews', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Review deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── SCHEDULES ENHANCED ───────────────────────────────────────────────────────
+
+router.post('/schedules-enhanced', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, clientId, scheduleType, dayOfWeek, date, startTime, endTime, notes, frequency, effectiveDate, anchorDate } = req.body;
+    if (!caregiverId || !clientId || !startTime || !endTime) return res.status(400).json({ error: 'Missing required fields' });
+    const id = uuidv4();
+    const result = await db.query(
+      `INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, day_of_week, date, start_time, end_time, notes, frequency, effective_date, anchor_date)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12) RETURNING *`,
+      [id, caregiverId, clientId, scheduleType||'recurring', dayOfWeek!=null?dayOfWeek:null, date||null, startTime, endTime, notes||null, frequency||'weekly', effectiveDate||null, anchorDate||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/communicationRoutes.js b/templates/crm-homecare/backend/src/routes/communicationRoutes.js
new file mode 100644
index 0000000..bf4f217
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/communicationRoutes.js
@@ -0,0 +1,91 @@
+// routes/communicationRoutes.js
+// Communication Log — timestamped notes/calls/emails per client or caregiver
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// GET logs for an entity
+router.get('/:entityType/:entityId', auth, async (req, res) => {
+  const { entityType, entityId } = req.params;
+  const { type, limit = 50, offset = 0 } = req.query;
+  try {
+    let q = `
+      SELECT cl.*,
+        u.first_name || ' ' || u.last_name AS logged_by_full
+      FROM communication_log cl
+      LEFT JOIN users u ON cl.logged_by = u.id
+      WHERE cl.entity_type = $1 AND cl.entity_id = $2
+    `;
+    const params = [entityType, entityId];
+    if (type) { params.push(type); q += ` AND cl.log_type = $${params.length}`; }
+    q += ` ORDER BY cl.is_pinned DESC, cl.created_at DESC LIMIT $${params.length+1} OFFSET $${params.length+2}`;
+    params.push(parseInt(limit), parseInt(offset));
+    const result = await db.query(q, params);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// GET follow-ups due
+router.get('/follow-ups/pending', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT cl.*,
+        CASE WHEN cl.entity_type = 'client'
+          THEN (SELECT first_name || ' ' || last_name FROM clients WHERE id = cl.entity_id)
+          ELSE (SELECT first_name || ' ' || last_name FROM users WHERE id = cl.entity_id)
+        END AS entity_name
+      FROM communication_log cl
+      WHERE cl.follow_up_done = FALSE
+        AND cl.follow_up_date IS NOT NULL
+        AND cl.follow_up_date <= CURRENT_DATE + INTERVAL '3 days'
+      ORDER BY cl.follow_up_date ASC
+      LIMIT 50
+    `);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// POST create log entry
+router.post('/', auth, async (req, res) => {
+  const { entityType, entityId, logType = 'note', direction, subject, body, followUpDate } = req.body;
+  if (!entityType || !entityId || !body) return res.status(400).json({ error: 'entityType, entityId, and body required' });
+  try {
+    const user = await db.query('SELECT first_name, last_name FROM users WHERE id = $1', [req.user.id]);
+    const name = user.rows[0] ? `${user.rows[0].first_name} ${user.rows[0].last_name}` : 'Admin';
+    const result = await db.query(`
+      INSERT INTO communication_log (entity_type, entity_id, log_type, direction, subject, body, logged_by, logged_by_name, follow_up_date)
+      VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *
+    `, [entityType, entityId, logType, direction || null, subject || null, body, req.user.id, name, followUpDate || null]);
+    res.status(201).json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// PUT update (pin/follow-up done)
+router.put('/:id', auth, async (req, res) => {
+  const { isPinned, followUpDone, body, subject } = req.body;
+  try {
+    const fields = [], params = [];
+    if (isPinned !== undefined) { params.push(isPinned); fields.push(`is_pinned=$${params.length}`); }
+    if (followUpDone !== undefined) { params.push(followUpDone); fields.push(`follow_up_done=$${params.length}`); }
+    if (body) { params.push(body); fields.push(`body=$${params.length}`); }
+    if (subject !== undefined) { params.push(subject); fields.push(`subject=$${params.length}`); }
+    params.push(req.params.id);
+    const result = await db.query(
+      `UPDATE communication_log SET ${fields.join(', ')}, updated_at=NOW() WHERE id=$${params.length} RETURNING *`,
+      params
+    );
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// DELETE
+router.delete('/:id', auth, async (req, res) => {
+  try {
+    await db.query('DELETE FROM communication_log WHERE id=$1', [req.params.id]);
+    res.json({ message: 'Deleted' });
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/dashboardRoutes.js b/templates/crm-homecare/backend/src/routes/dashboardRoutes.js
new file mode 100644
index 0000000..15bec9e
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/dashboardRoutes.js
@@ -0,0 +1,74 @@
+// routes/dashboardRoutes.js
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// GET /api/dashboard/summary
+router.get('/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [totalClients, activeCaregivers, pendingInvoices, thisMonthRevenue, clockedInNow, todayShifts, remainingShifts] = await Promise.all([
+      db.query('SELECT COUNT(*) as count FROM clients WHERE is_active = true'),
+      db.query("SELECT COUNT(*) as count FROM users WHERE role = 'caregiver' AND is_active = true"),
+      db.query("SELECT COUNT(*) as count, SUM(total) as amount FROM invoices WHERE payment_status = 'pending'"),
+      db.query(`SELECT SUM(total) as amount FROM invoices WHERE billing_period_start >= date_trunc('month', CURRENT_DATE) AND payment_status = 'paid'`),
+      // Caregivers currently clocked in (open time entry today)
+      db.query(`SELECT COUNT(DISTINCT caregiver_id) as count FROM time_entries WHERE end_time IS NULL AND DATE(start_time) = CURRENT_DATE`),
+      // Shifts today
+      db.query(`SELECT COUNT(*) as count FROM schedules WHERE is_active = true AND
+        (date = CURRENT_DATE OR 
+         (day_of_week = EXTRACT(DOW FROM CURRENT_DATE)::integer AND
+          (effective_date IS NULL OR effective_date <= CURRENT_DATE)))`),
+      // Remaining shifts today (not yet clocked in)
+      db.query(`SELECT COUNT(*) as count FROM schedules s WHERE s.is_active = true AND
+        (s.date = CURRENT_DATE OR (s.day_of_week = EXTRACT(DOW FROM CURRENT_DATE)::integer AND (s.effective_date IS NULL OR s.effective_date <= CURRENT_DATE)))
+        AND NOT EXISTS (SELECT 1 FROM time_entries te WHERE te.caregiver_id = s.caregiver_id AND DATE(te.start_time) = CURRENT_DATE AND te.end_time IS NULL)`),
+    ]);
+    res.json({
+      totalClients: parseInt(totalClients.rows[0].count),
+      activeCaregivers: parseInt(activeCaregivers.rows[0].count),
+      pendingInvoices: { count: parseInt(pendingInvoices.rows[0].count), amount: parseFloat(pendingInvoices.rows[0].amount || 0) },
+      thisMonthRevenue: parseFloat(thisMonthRevenue.rows[0].amount || 0),
+      clockedInNow: parseInt(clockedInNow.rows[0].count || 0),
+      todayShifts: parseInt(todayShifts.rows[0].count || 0),
+      remainingShifts: parseInt(remainingShifts.rows[0].count || 0),
+      coverageGaps: 0,
+    });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/dashboard/referrals
+router.get('/referrals', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT rs.name, rs.type, COUNT(c.id) as referral_count,
+        SUM(CASE WHEN i.payment_status = 'paid' THEN i.total ELSE 0 END) as total_revenue
+       FROM referral_sources rs
+       LEFT JOIN clients c ON rs.id = c.referred_by
+       LEFT JOIN invoices i ON c.id = i.client_id
+       WHERE rs.is_active = true
+       GROUP BY rs.id, rs.name, rs.type ORDER BY referral_count DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/dashboard/caregiver-hours
+router.get('/caregiver-hours', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT u.id, u.first_name, u.last_name, COUNT(te.id) as shifts,
+        COALESCE(SUM(te.duration_minutes)::integer/60, 0) as total_hours,
+        COALESCE(AVG(pr.satisfaction_score), 0) as avg_satisfaction
+       FROM users u
+       LEFT JOIN time_entries te ON u.id = te.caregiver_id AND te.end_time IS NOT NULL
+       LEFT JOIN performance_ratings pr ON u.id = pr.caregiver_id
+       WHERE u.role = 'caregiver' AND u.is_active = true
+       GROUP BY u.id, u.first_name, u.last_name ORDER BY total_hours DESC NULLS LAST`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/documentsRoutes.js b/templates/crm-homecare/backend/src/routes/documentsRoutes.js
new file mode 100644
index 0000000..60f29ce
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/documentsRoutes.js
@@ -0,0 +1,216 @@
+// routes/documentsRoutes.js
+// Document Storage - I-9, W-4, Policies, etc.
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const multer = require('multer');
+const path = require('path');
+const fs = require('fs');
+
+// Configure multer for file uploads
+const storage = multer.diskStorage({
+  destination: (req, file, cb) => {
+    const uploadDir = process.env.UPLOAD_DIR || './uploads';
+    if (!fs.existsSync(uploadDir)) {
+      fs.mkdirSync(uploadDir, { recursive: true });
+    }
+    cb(null, uploadDir);
+  },
+  filename: (req, file, cb) => {
+    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);
+    cb(null, uniqueSuffix + path.extname(file.originalname));
+  }
+});
+
+const upload = multer({ 
+  storage,
+  limits: { fileSize: 10 * 1024 * 1024 }, // 10MB
+  fileFilter: (req, file, cb) => {
+    const allowed = ['.pdf', '.doc', '.docx', '.jpg', '.jpeg', '.png', '.gif'];
+    const ext = path.extname(file.originalname).toLowerCase();
+    if (allowed.includes(ext)) {
+      cb(null, true);
+    } else {
+      cb(new Error('Invalid file type'));
+    }
+  }
+});
+
+// Get all documents (with optional filters)
+router.get('/', auth, async (req, res) => {
+  const { entityType, entityId, documentType } = req.query;
+  try {
+    let query = `
+      SELECT d.*, 
+        u.first_name as uploaded_by_first, u.last_name as uploaded_by_last,
+        CASE 
+          WHEN d.entity_type = 'caregiver' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM users WHERE id = d.entity_id)
+          WHEN d.entity_type = 'client' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM clients WHERE id = d.entity_id)
+          ELSE 'Company'
+        END as entity_name
+      FROM documents d
+      LEFT JOIN users u ON d.uploaded_by = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (entityType) {
+      params.push(entityType);
+      query += ` AND d.entity_type = $${params.length}`;
+    }
+    if (entityId) {
+      params.push(entityId);
+      query += ` AND d.entity_id = $${params.length}`;
+    }
+    if (documentType) {
+      params.push(documentType);
+      query += ` AND d.document_type = $${params.length}`;
+    }
+
+    query += ` ORDER BY d.created_at DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get documents for an entity
+router.get('/:entityType/:entityId', auth, async (req, res) => {
+  const { entityType, entityId } = req.params;
+  const { documentType } = req.query;
+  
+  try {
+    let query = `
+      SELECT d.*, u.first_name as uploaded_by_name
+      FROM documents d
+      LEFT JOIN users u ON d.uploaded_by = u.id
+      WHERE d.entity_type = $1 AND d.entity_id = $2
+    `;
+    const params = [entityType, entityId];
+
+    if (documentType) {
+      params.push(documentType);
+      query += ` AND d.document_type = $${params.length}`;
+    }
+
+    query += ` ORDER BY d.created_at DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Upload document
+router.post('/upload', auth, upload.single('file'), async (req, res) => {
+  const { entityType, entityId, documentType, name, description, requiresSignature, expirationDate, isConfidential } = req.body;
+  
+  try {
+    if (!req.file) {
+      return res.status(400).json({ error: 'No file uploaded' });
+    }
+
+    const fileUrl = `/uploads/${req.file.filename}`;
+    const fileType = path.extname(req.file.originalname).slice(1);
+
+    const result = await db.query(`
+      INSERT INTO documents 
+      (entity_type, entity_id, document_type, name, description, file_url, file_type, file_size, requires_signature, expiration_date, is_confidential, uploaded_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)
+      RETURNING *
+    `, [entityType, entityId, documentType, name || req.file.originalname, description, fileUrl, fileType, req.file.size, requiresSignature === 'true', expirationDate || null, isConfidential === 'true', req.user.id]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete document
+router.delete('/:id', auth, async (req, res) => {
+  try {
+    const doc = await db.query('SELECT file_url FROM documents WHERE id = $1', [req.params.id]);
+    
+    if (doc.rows[0]?.file_url) {
+      const filePath = path.join(process.env.UPLOAD_DIR || './uploads', path.basename(doc.rows[0].file_url));
+      if (fs.existsSync(filePath)) {
+        fs.unlinkSync(filePath);
+      }
+    }
+
+    await db.query('DELETE FROM documents WHERE id = $1', [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Sign/acknowledge document
+router.post('/:id/acknowledge', auth, async (req, res) => {
+  const { signatureData } = req.body;
+  
+  try {
+    await db.query(`
+      INSERT INTO document_acknowledgments (document_id, user_id, ip_address, signature_data)
+      VALUES ($1, $2, $3, $4)
+    `, [req.params.id, req.user.id, req.ip, signatureData]);
+
+    await db.query(`
+      UPDATE documents SET signed_at = NOW(), signed_by = $1
+      WHERE id = $2
+    `, [req.user.id, req.params.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get expiring documents
+router.get('/reports/expiring', auth, async (req, res) => {
+  const { days = 30 } = req.query;
+  try {
+    const result = await db.query(`
+      SELECT d.*, 
+        CASE 
+          WHEN d.entity_type = 'caregiver' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM users WHERE id = d.entity_id)
+          WHEN d.entity_type = 'client' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM clients WHERE id = d.entity_id)
+          ELSE 'Company'
+        END as entity_name
+      FROM documents d
+      WHERE d.expiration_date IS NOT NULL
+      AND d.expiration_date <= CURRENT_DATE + $1::integer
+      AND d.expiration_date >= CURRENT_DATE
+      ORDER BY d.expiration_date ASC
+    `, [days]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get unsigned documents for a user
+router.get('/unsigned/:userId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT d.* FROM documents d
+      WHERE d.requires_signature = true
+      AND d.signed_at IS NULL
+      AND (
+        (d.entity_type = 'company')
+        OR (d.entity_type = 'caregiver' AND d.entity_id = $1)
+      )
+      ORDER BY d.created_at DESC
+    `, [req.params.userId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
\ No newline at end of file
diff --git a/templates/crm-homecare/backend/src/routes/ediRoutes.js b/templates/crm-homecare/backend/src/routes/ediRoutes.js
new file mode 100644
index 0000000..9715d9d
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/ediRoutes.js
@@ -0,0 +1,259 @@
+// routes/ediRoutes.js
+// EDI 837P (Professional) claim generation for WPS / clearinghouse submission
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── EDI HELPERS ──────────────────────────────────────────────────────────────
+function ediDate(d) { return d ? new Date(d).toISOString().split('T')[0].replace(/-/g, '') : ''; }
+function ediTime(d) { return d ? new Date(d).toISOString().split('T')[1].slice(0, 5).replace(':', '') : '0000'; }
+function pad(s, n) { return String(s || '').padEnd(n).slice(0, n); }
+function ediName(s) { return String(s || '').toUpperCase().replace(/[^A-Z0-9 ]/g, '').slice(0, 35); }
+function ediId(s) { return String(s || '').replace(/[^A-Z0-9]/gi, '').toUpperCase().slice(0, 30); }
+
+// Build EDI 837P content for a batch of claims
+function buildEDI837P(claims, payer, providerInfo, interchangeControlNum) {
+  const icn = String(interchangeControlNum || Date.now()).padStart(9, '0');
+  const today = ediDate(new Date());
+  const now = ediTime(new Date());
+  const segments = [];
+  let segCount = 0;
+  let claimCount = 0;
+
+  const seg = (...parts) => { segments.push(parts.join('*') + '~'); segCount++; };
+
+  // ISA - Interchange Control Header
+  seg('ISA', '00', '          ', '00', '          ',
+    'ZZ', pad(providerInfo.npi || providerInfo.taxId || 'PROVIDER', 15),
+    'ZZ', pad(payer.edi_payer_id || 'PAYER', 15),
+    today, now, '^', '00501', icn, '0', 'P', ':');
+
+  // GS - Functional Group Header
+  seg('GS', 'HC', providerInfo.npi || 'PROVIDER', payer.edi_payer_id || 'PAYER',
+    today, now, '1', 'X', '005010X222A1');
+
+  // ST - Transaction Set Header
+  seg('ST', '837', '0001', '005010X222A1');
+  seg('BPR', 'I', '0', 'C', 'CHK', '01', '', '', '', '', '', '', '', '', '', today);
+  seg('TRN', '1', icn, '1' + (providerInfo.npi || '000000000'));
+  seg('DTM', '232', today);
+
+  // 1000A - Submitter
+  seg('NM1', '41', '2', ediName(providerInfo.agencyName), '', '', '', '', '46', ediId(providerInfo.npi || providerInfo.taxId));
+  seg('PER', 'IC', ediName(providerInfo.contactName || providerInfo.agencyName), 'TE', (providerInfo.phone || '7155551234').replace(/\D/g, ''));
+
+  // 1000B - Receiver
+  seg('NM1', '40', '2', ediName(payer.name), '', '', '', '', '46', ediId(payer.edi_payer_id || payer.id));
+
+  // Loop 2000A - Billing Provider
+  seg('HL', '1', '', '20', '1');
+  seg('PRV', 'BI', 'PXC', providerInfo.taxonomyCode || '374700000X');
+  seg('NM1', '85', '2', ediName(providerInfo.agencyName), '', '', '', '', 'XX', ediId(providerInfo.npi));
+  seg('N3', providerInfo.address || '123 MAIN ST');
+  seg('N4', providerInfo.city || 'EAU CLAIRE', providerInfo.state || 'WI', (providerInfo.zip || '54701').replace(/\D/g, ''));
+  seg('REF', 'EI', (providerInfo.taxId || '').replace(/\D/g, ''));
+
+  // Loop 2000B - Subscriber / Payer  
+  seg('HL', '2', '1', '22', '0');
+  seg('SBR', 'P', '18', '', '', '', '', '', '', 'MC'); // MC = Medicaid
+  seg('NM1', 'IL', '1', 'SUBSCRIBER', 'LAST', '', '', '', 'MI', 'MEDICAIDID');
+  seg('NM1', 'PR', '2', ediName(payer.name), '', '', '', '', 'PI', ediId(payer.edi_payer_id || payer.npi || ''));
+
+  // Loop 2300 - Claims
+  for (const claim of claims) {
+    claimCount++;
+    const claimAmt = parseFloat(claim.charge_amount || claim.billed_amount || 0).toFixed(2);
+    const claimRef = ediId(claim.claim_number || claim.id);
+    const svcFrom = ediDate(claim.service_date_from);
+    const svcTo = ediDate(claim.service_date_to || claim.service_date_from);
+
+    seg('HL', String(2 + claimCount), '2', '23', '0');
+    seg('PAT', '18');
+    seg('NM1', 'QC', '1',
+      ediName(claim.client_last_name), ediName(claim.client_first_name),
+      '', '', '', 'MI', ediId(claim.medicaid_id || claim.mco_member_id || ''));
+    if (claim.client_dob) seg('DMG', 'D8', ediDate(claim.client_dob), claim.gender === 'Female' ? 'F' : 'M');
+
+    seg('CLM', claimRef, claimAmt, '', '', '12:B:1', 'Y', 'A', 'Y', 'I');
+    seg('DTP', '435', 'D8', svcFrom);
+    seg('DTP', '096', 'D8', svcTo);
+    if (claim.authorization_id || claim.auth_number) {
+      seg('REF', 'G1', ediId(claim.auth_number || claim.authorization_id));
+    }
+    seg('REF', 'EA', claimRef); // Original Ref Number
+
+    // Diagnosis code
+    if (claim.diagnosis_code || claim.primary_diagnosis_code) {
+      seg('HI', `ABK:${ediId(claim.diagnosis_code || claim.primary_diagnosis_code || 'Z00.00')}`);
+    } else {
+      seg('HI', 'ABK:Z00000'); // placeholder
+    }
+
+    // Rendering Provider
+    seg('NM1', '82', '1',
+      ediName(claim.caregiver_last), ediName(claim.caregiver_first),
+      '', '', '', 'XX', ediId(claim.npi_number || claim.caregiver_npi || ''));
+    if (claim.taxonomy_code) seg('PRV', 'PE', 'PXC', claim.taxonomy_code);
+
+    // Loop 2400 - Service Line
+    const units = parseFloat(claim.units || 1).toFixed(3);
+    const unitCode = claim.unit_type === 'hour' ? 'UN' : claim.unit_type === 'day' ? 'DA' : 'UN';
+    const unitRate = (parseFloat(claimAmt) / parseFloat(units)).toFixed(2);
+    seg('LX', '1');
+    seg('SV1',
+      `HC:${ediId(claim.procedure_code || 'T1019')}${claim.modifier ? ':' + claim.modifier : ''}`,
+      claimAmt, unitCode, units, '', '1');
+    seg('DTP', '472', 'D8', svcFrom);
+
+    // EVV reference if available
+    if (claim.sandata_visit_id) {
+      seg('REF', 'LU', ediId(claim.sandata_visit_id));
+    }
+  }
+
+  // SE - Transaction Set Trailer
+  seg('SE', String(segCount + 1), '0001');
+  seg('GE', String(claimCount), '1');
+  seg('IEA', '1', icn);
+
+  return segments.join('\n');
+}
+
+// ─── GENERATE EDI BATCH ───────────────────────────────────────────────────────
+router.post('/generate', auth, requireAdmin, async (req, res) => {
+  try {
+    const { claimIds, payerId } = req.body;
+    if (!claimIds?.length) return res.status(400).json({ error: 'No claims selected' });
+
+    // Get claims with all needed data
+    const claimsResult = await db.query(`
+      SELECT c.*,
+        cl.first_name as client_first_name, cl.last_name as client_last_name,
+        cl.medicaid_id, cl.mco_member_id, cl.date_of_birth as client_dob, cl.gender,
+        cl.primary_diagnosis_code as diagnosis_code,
+        u.first_name as caregiver_first, u.last_name as caregiver_last,
+        cp.npi_number as caregiver_npi, cp.taxonomy_code,
+        ev.sandata_visit_id, ev.actual_start, ev.actual_end, ev.units_of_service as units,
+        a.auth_number,
+        rs.name as payer_name, rs.edi_payer_id, rs.npi as payer_npi
+      FROM claims c
+      JOIN clients cl ON c.client_id = cl.id
+      LEFT JOIN users u ON c.created_by = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      LEFT JOIN evv_visits ev ON c.evv_visit_id = ev.id
+      LEFT JOIN authorizations a ON c.authorization_id = a.id
+      LEFT JOIN referral_sources rs ON c.payer_id = rs.id
+      WHERE c.id = ANY($1)
+        AND c.status IN ('draft', 'approved')
+    `, [claimIds]);
+
+    if (!claimsResult.rows.length) return res.status(400).json({ error: 'No eligible claims found' });
+
+    // Get agency/provider info from settings or env
+    const providerInfo = {
+      agencyName: process.env.AGENCY_NAME || 'CHIPPEWA VALLEY HOME CARE',
+      npi: process.env.AGENCY_NPI || '',
+      taxId: process.env.AGENCY_TAX_ID || '',
+      taxonomyCode: process.env.AGENCY_TAXONOMY || '374700000X',
+      address: process.env.AGENCY_ADDRESS || '123 MAIN ST',
+      city: process.env.AGENCY_CITY || 'EAU CLAIRE',
+      state: process.env.AGENCY_STATE || 'WI',
+      zip: process.env.AGENCY_ZIP || '54701',
+      phone: process.env.AGENCY_PHONE || '7155551234',
+      contactName: process.env.AGENCY_CONTACT || 'ALEXIS',
+    };
+
+    // Get payer info
+    const payer = claimsResult.rows[0];
+    const payerInfo = {
+      name: payer.payer_name || 'PAYER',
+      edi_payer_id: payer.edi_payer_id || '',
+      npi: payer.payer_npi || '',
+    };
+
+    const batchNumber = `EDI-${Date.now()}`;
+    const ediContent = buildEDI837P(claimsResult.rows, payerInfo, providerInfo, Date.now());
+    const totalBilled = claimsResult.rows.reduce((sum, c) => sum + parseFloat(c.charge_amount || 0), 0);
+
+    // Save batch
+    const batch = await db.query(`
+      INSERT INTO edi_batches (id, payer_id, batch_number, status, claim_count, total_billed, edi_content, created_by)
+      VALUES ($1,$2,$3,'generated',$4,$5,$6,$7)
+      RETURNING *
+    `, [uuidv4(), payerId || claimsResult.rows[0].payer_id, batchNumber, claimsResult.rows.length, totalBilled, ediContent, req.user.id]);
+
+    // Link claims to batch
+    for (const claim of claimsResult.rows) {
+      await db.query(`UPDATE claims SET edi_batch_id = $1, status = 'submitted', submission_date = CURRENT_DATE WHERE id = $2`, [batch.rows[0].id, claim.id]);
+    }
+
+    res.json({
+      batch: batch.rows[0],
+      claimCount: claimsResult.rows.length,
+      totalBilled,
+      ediContent,
+      downloadUrl: `/api/edi/batch/${batch.rows[0].id}/download`
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── DOWNLOAD EDI FILE ────────────────────────────────────────────────────────
+router.get('/batch/:id/download', auth, requireAdmin, async (req, res) => {
+  try {
+    const batch = await db.query('SELECT * FROM edi_batches WHERE id = $1', [req.params.id]);
+    if (!batch.rows.length) return res.status(404).json({ error: 'Batch not found' });
+
+    res.setHeader('Content-Type', 'text/plain');
+    res.setHeader('Content-Disposition', `attachment; filename="${batch.rows[0].batch_number}.edi"`);
+    res.send(batch.rows[0].edi_content);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET ALL BATCHES ──────────────────────────────────────────────────────────
+router.get('/batches', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT eb.*, rs.name as payer_name
+      FROM edi_batches eb
+      LEFT JOIN referral_sources rs ON eb.payer_id = rs.id
+      ORDER BY eb.created_at DESC
+      LIMIT 50
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── SERVICE CODES ────────────────────────────────────────────────────────────
+router.get('/service-codes', auth, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM service_codes WHERE is_active = true ORDER BY code, modifier1`);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/service-codes', auth, requireAdmin, async (req, res) => {
+  try {
+    const { code, modifier1, modifier2, description, serviceCategory, payerType, unitType, ratePerUnit, requiresEvv } = req.body;
+    const result = await db.query(`
+      INSERT INTO service_codes (id, code, modifier1, modifier2, description, service_category, payer_type, unit_type, rate_per_unit, requires_evv)
+      VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10) RETURNING *
+    `, [uuidv4(), code, modifier1 || null, modifier2 || null, description, serviceCategory || 'personal_care', payerType || 'all', unitType || '15min', ratePerUnit || null, requiresEvv !== false]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/emergencyRoutes.js b/templates/crm-homecare/backend/src/routes/emergencyRoutes.js
new file mode 100644
index 0000000..f8173cd
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/emergencyRoutes.js
@@ -0,0 +1,384 @@
+// src/routes/emergencyRoutes.js - Emergency coverage + shift miss reporting
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+
+// ═══════════════════════════════════════════
+// SHIFT MISS REPORTING (caregiver-initiated)
+// ═══════════════════════════════════════════
+
+// POST /api/emergency/miss-report - Caregiver reports they can't make a shift
+router.post('/miss-report', auth, async (req, res) => {
+  try {
+    const { scheduleId, date, reason, alternativeContact } = req.body;
+    const caregiverId = req.user.id;
+
+    if (!date) return res.status(400).json({ error: 'Date is required' });
+
+    const reportId = uuidv4();
+
+    // Get schedule details if provided
+    let scheduleInfo = null;
+    if (scheduleId) {
+      const sched = await db.query(
+        `SELECT s.*, c.first_name as client_first_name, c.last_name as client_last_name,
+                u.first_name as caregiver_first_name, u.last_name as caregiver_last_name
+         FROM schedules s
+         LEFT JOIN clients c ON s.client_id = c.id
+         LEFT JOIN users u ON s.caregiver_id = u.id
+         WHERE s.id = $1`,
+        [scheduleId]
+      );
+      scheduleInfo = sched.rows[0] || null;
+    }
+
+    // Record the miss report as an absence
+    const absenceResult = await db.query(`
+      INSERT INTO absences (id, caregiver_id, date, type, reason, coverage_needed, created_at)
+      VALUES ($1, $2, $3, 'call_out', $4, true, NOW())
+      RETURNING *`,
+      [reportId, caregiverId, date, reason || 'No reason provided']
+    );
+
+    // Create an alert for admins
+    const admins = await db.query(
+      `SELECT id FROM users WHERE role = 'admin' AND is_active = true`
+    );
+
+    const caregiverInfo = await db.query(
+      `SELECT first_name, last_name FROM users WHERE id = $1`,
+      [caregiverId]
+    );
+    const cg = caregiverInfo.rows[0];
+    const cgName = cg ? `${cg.first_name} ${cg.last_name}` : 'A caregiver';
+
+    const alertMessage = scheduleInfo
+      ? `${cgName} cannot make their shift on ${date} with ${scheduleInfo.client_first_name} ${scheduleInfo.client_last_name}. Reason: ${reason || 'None given'}`
+      : `${cgName} has reported they cannot work on ${date}. Reason: ${reason || 'None given'}`;
+
+    for (const admin of admins.rows) {
+      await db.query(`
+        INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+        VALUES ($1, $2, 'emergency_coverage', 'Shift Miss Report — Coverage Needed', $3, false, NOW())`,
+        [uuidv4(), admin.id, alertMessage]
+      );
+    }
+
+    // Store schedule info in absence notes
+    await db.query(
+      `UPDATE absences SET notes = $1 WHERE id = $2`,
+      [JSON.stringify({ scheduleId, scheduleInfo: scheduleInfo ? { clientName: `${scheduleInfo.client_first_name} ${scheduleInfo.client_last_name}`, startTime: scheduleInfo.start_time, endTime: scheduleInfo.end_time } : null, alternativeContact }), reportId]
+    );
+
+    // ── AUTO-CREATE OPEN SHIFT ────────────────────────────────────────────────
+    let openShiftId = null;
+    let notifiedCount = 0;
+
+    if (scheduleInfo && scheduleInfo.client_id) {
+      try {
+        // Create open shift from this miss report
+        const osResult = await db.query(`
+          INSERT INTO open_shifts (
+            client_id, schedule_id, shift_date, start_time, end_time,
+            notes, urgency, created_by, source_absence_id, auto_created, status
+          ) VALUES ($1, $2, $3, $4, $5, $6, 'urgent', $7, $8, true, 'open')
+          RETURNING id
+        `, [
+          scheduleInfo.client_id,
+          scheduleId || null,
+          date,
+          scheduleInfo.start_time,
+          scheduleInfo.end_time,
+          `Coverage needed — ${cgName} called out. Reason: ${reason || 'None given'}`,
+          caregiverId,
+          reportId
+        ]);
+        openShiftId = osResult.rows[0].id;
+
+        // Find caregivers NOT scheduled at this time
+        const shiftStart = scheduleInfo.start_time;
+        const shiftEnd = scheduleInfo.end_time;
+
+        const available = await db.query(`
+          SELECT DISTINCT u.id, u.first_name, u.last_name, u.phone
+          FROM users u
+          WHERE u.role = 'caregiver'
+            AND u.is_active = true
+            AND u.id != $1
+            AND u.id NOT IN (
+              -- Exclude caregivers already scheduled at this time on this date
+              SELECT DISTINCT s.caregiver_id
+              FROM schedules s
+              WHERE s.is_active = true
+                AND s.day_of_week = EXTRACT(DOW FROM $2::date)
+                AND (
+                  (s.start_time <= $3 AND s.end_time > $3) OR
+                  (s.start_time < $4 AND s.end_time >= $4) OR
+                  (s.start_time >= $3 AND s.end_time <= $4)
+                )
+            )
+            AND u.id NOT IN (
+              -- Exclude caregivers with approved time off
+              SELECT caregiver_id FROM absences
+              WHERE type = 'time_off' AND date = $2 AND status = 'approved'
+            )
+          LIMIT 30
+        `, [caregiverId, date, shiftStart, shiftEnd]);
+
+        const availableCaregivers = available.rows;
+
+        // Send push notifications to available caregivers
+        let webpush;
+        try { webpush = require('web-push'); } catch (e) { webpush = null; }
+
+        if (webpush && process.env.VAPID_PUBLIC_KEY && process.env.VAPID_PUBLIC_KEY !== 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') {
+          webpush.setVapidDetails('mailto:admin@chippewahomecare.com', process.env.VAPID_PUBLIC_KEY, process.env.VAPID_PRIVATE_KEY);
+        }
+
+        for (const cg of availableCaregivers) {
+          try {
+            // Log notification
+            await db.query(`
+              INSERT INTO open_shift_notifications (open_shift_id, caregiver_id, notification_type)
+              VALUES ($1, $2, 'push') ON CONFLICT DO NOTHING
+            `, [openShiftId, cg.id]);
+
+            // Send push
+            if (webpush && process.env.VAPID_PUBLIC_KEY && process.env.VAPID_PUBLIC_KEY !== 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') {
+              const subs = await db.query(
+                `SELECT subscription FROM push_subscriptions WHERE user_id = $1 AND is_active = true`,
+                [cg.id]
+              );
+              for (const sub of subs.rows) {
+                try {
+                  await webpush.sendNotification(sub.subscription, JSON.stringify({
+                    title: '🚨 Urgent Open Shift',
+                    body: `${scheduleInfo.client_first_name} ${scheduleInfo.client_last_name} needs coverage on ${date} (${shiftStart}–${shiftEnd}). Tap to claim.`,
+                    data: { type: 'open_shift', openShiftId }
+                  }));
+                } catch (e) { /* ignore */ }
+              }
+            }
+
+            // Add in-app notification too
+            await db.query(`
+              INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+              VALUES ($1, $2, 'open_shift', '🚨 Urgent Shift Available', $3, false, NOW())
+            `, [uuidv4(), cg.id,
+              `${scheduleInfo.client_first_name} ${scheduleInfo.client_last_name} needs coverage on ${date} from ${shiftStart} to ${shiftEnd}. Open the app to claim this shift.`
+            ]);
+
+            notifiedCount++;
+          } catch (e) { /* continue */ }
+        }
+
+        // Update open shift with notified count
+        await db.query(
+          `UPDATE open_shifts SET notified_caregiver_count = $1 WHERE id = $2`,
+          [notifiedCount, openShiftId]
+        );
+
+      } catch (osError) {
+        console.error('Error creating open shift from miss report:', osError.message);
+        // Don't fail the whole request — the miss report was still saved
+      }
+    }
+
+    res.status(201).json({
+      id: reportId,
+      message: 'Your report has been submitted. The admin team has been notified.',
+      date,
+      status: 'submitted',
+      openShiftCreated: !!openShiftId,
+      caregiversNotified: notifiedCount,
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// GET /api/emergency/miss-reports - Admin: all pending miss reports
+router.get('/miss-reports', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT 
+        a.*,
+        u.first_name, u.last_name, u.phone, u.email,
+        a.notes::jsonb->>'scheduleId' as schedule_id,
+        (a.notes::jsonb->'scheduleInfo'->>'clientName') as client_name,
+        (a.notes::jsonb->'scheduleInfo'->>'startTime') as start_time,
+        (a.notes::jsonb->'scheduleInfo'->>'endTime') as end_time
+      FROM absences a
+      JOIN users u ON a.caregiver_id = u.id
+      WHERE a.type = 'call_out' 
+        AND a.coverage_needed = true
+        AND a.coverage_assigned_to IS NULL
+        AND a.date >= CURRENT_DATE
+      ORDER BY a.date ASC, a.created_at ASC`
+    );
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ═══════════════════════════════════════════
+// EMERGENCY COVERAGE FINDER
+// ═══════════════════════════════════════════
+
+// GET /api/emergency/available-caregivers - Find who can cover a shift
+router.get('/available-caregivers', auth, requireAdmin, async (req, res) => {
+  try {
+    const { date, startTime, endTime, clientId, absenceId } = req.query;
+
+    if (!date || !startTime || !endTime) {
+      return res.status(400).json({ error: 'date, startTime, and endTime are required' });
+    }
+
+    const dayOfWeek = new Date(date + 'T12:00:00').getDay();
+
+    // Find caregivers who:
+    // 1. Are active
+    // 2. Have no conflicting schedule on that date/time
+    // 3. Have not requested time off that day
+    // 4. Are marked available for that day
+    const result = await db.query(`
+      WITH conflicting_caregivers AS (
+        -- Has an existing schedule that overlaps
+        SELECT DISTINCT caregiver_id FROM schedules
+        WHERE is_active = true
+          AND (
+            (date = $1)
+            OR (day_of_week = $2 AND (date IS NULL OR date = $1))
+          )
+          AND start_time < $4::time AND end_time > $3::time
+      ),
+      on_time_off AS (
+        -- Has approved time off that day
+        SELECT DISTINCT caregiver_id FROM caregiver_time_off
+        WHERE status = 'approved'
+          AND start_date <= $1::date AND end_date >= $1::date
+      ),
+      called_out AS (
+        -- Already called out this day
+        SELECT DISTINCT caregiver_id FROM absences
+        WHERE date = $1::date AND type IN ('call_out', 'no_show')
+      )
+      SELECT 
+        u.id, u.first_name, u.last_name, u.phone, u.email,
+        u.certifications,
+        -- Check if they are available for this day in their availability preferences
+        ca.weekly_availability,
+        ca.status as availability_status,
+        -- Count their hours this week
+        COALESCE((
+          SELECT SUM(EXTRACT(EPOCH FROM (end_time - start_time)) / 3600)
+          FROM schedules s2
+          WHERE s2.caregiver_id = u.id 
+            AND s2.is_active = true
+            AND s2.date >= DATE_TRUNC('week', $1::date)
+            AND s2.date < DATE_TRUNC('week', $1::date) + INTERVAL '7 days'
+        ), 0) as scheduled_hours_this_week,
+        -- Last worked date
+        (SELECT MAX(start_time)::date FROM time_entries te WHERE te.caregiver_id = u.id AND te.is_complete = true) as last_worked,
+        -- Performance rating
+        COALESCE((
+          SELECT ROUND(AVG(satisfaction_score)::numeric, 1)
+          FROM performance_ratings pr
+          WHERE pr.caregiver_id = u.id
+        ), 0) as avg_rating,
+        -- Client preference match
+        CASE WHEN $5::uuid IS NOT NULL AND $5::text != '' AND u.id = ANY(
+          SELECT UNNEST(preferred_caregivers) FROM clients WHERE id = $5::uuid
+        ) THEN true ELSE false END as is_preferred
+      FROM users u
+      LEFT JOIN caregiver_availability ca ON ca.caregiver_id = u.id
+      WHERE u.role = 'caregiver'
+        AND u.is_active = true
+        AND u.id NOT IN (SELECT caregiver_id FROM conflicting_caregivers)
+        AND u.id NOT IN (SELECT caregiver_id FROM on_time_off)
+        AND u.id NOT IN (SELECT caregiver_id FROM called_out)
+      ORDER BY is_preferred DESC, avg_rating DESC, scheduled_hours_this_week ASC`,
+      [date, dayOfWeek, startTime, endTime, clientId || null]
+    );
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/emergency/assign-coverage - Assign a caregiver to cover a shift
+router.post('/assign-coverage', auth, requireAdmin, async (req, res) => {
+  try {
+    const { absenceId, caregiverId, scheduleId, date, startTime, endTime, clientId, notes } = req.body;
+
+    // Update the absence record
+    if (absenceId) {
+      await db.query(
+        `UPDATE absences SET coverage_assigned_to = $1, coverage_needed = false WHERE id = $2`,
+        [caregiverId, absenceId]
+      );
+    }
+
+    // Create a one-time schedule entry for the covering caregiver
+    if (date && startTime && endTime && clientId) {
+      const newSchedId = uuidv4();
+      await db.query(`
+        INSERT INTO schedules (id, caregiver_id, client_id, date, start_time, end_time, notes, is_active, created_at)
+        VALUES ($1, $2, $3, $4, $5, $6, $7, true, NOW())`,
+        [newSchedId, caregiverId, clientId, date, startTime, endTime,
+          `Emergency coverage${notes ? ': ' + notes : ''}. Original absence: ${absenceId || 'N/A'}`]
+      );
+    }
+
+    // Notify the covering caregiver
+    const caregiver = await db.query('SELECT first_name, last_name FROM users WHERE id = $1', [caregiverId]);
+    const client = clientId ? await db.query('SELECT first_name, last_name FROM clients WHERE id = $1', [clientId]) : null;
+    
+    const cg = caregiver.rows[0];
+    const cl = client ? client.rows[0] : null;
+
+    await db.query(`
+      INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+      VALUES ($1, $2, 'emergency_assignment', 'Emergency Coverage Assignment', $3, false, NOW())`,
+      [
+        uuidv4(),
+        caregiverId,
+        `You have been assigned emergency coverage on ${date} from ${startTime} to ${endTime}${cl ? ` for ${cl.first_name} ${cl.last_name}` : ''}. Please confirm your availability.`
+      ]
+    );
+
+    res.json({ success: true, message: `Coverage assigned to ${cg?.first_name} ${cg?.last_name}` });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// GET /api/emergency/my-shifts - Caregiver: get upcoming shifts for miss-report form
+router.get('/my-shifts', auth, async (req, res) => {
+  try {
+    const today = new Date().toISOString().split('T')[0];
+    const result = await db.query(`
+      SELECT s.id, s.date, s.day_of_week, s.start_time, s.end_time,
+             c.first_name as client_first_name, c.last_name as client_last_name,
+             c.address as client_address
+      FROM schedules s
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.caregiver_id = $1
+        AND s.is_active = true
+        AND (s.date >= $2::date OR (s.date IS NULL AND s.day_of_week IS NOT NULL))
+      ORDER BY s.date ASC, s.start_time ASC
+      LIMIT 14`,
+      [req.user.id, today]
+    );
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/expenseRoutes.js b/templates/crm-homecare/backend/src/routes/expenseRoutes.js
new file mode 100644
index 0000000..ce5abb5
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/expenseRoutes.js
@@ -0,0 +1,121 @@
+// routes/expenseRoutes.js — mounted at /api via app.use('/api', expenseRoutes)
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── EXPENSES ─────────────────────────────────────────────────────────────────
+
+router.get('/expenses/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, byCategory, byMonth] = await Promise.all([
+      db.query(`SELECT SUM(amount) as total_expenses, COUNT(*) as expense_count, AVG(amount) as average_expense FROM expenses`),
+      db.query(`SELECT category, COUNT(*) as count, SUM(amount) as total, AVG(amount) as average FROM expenses GROUP BY category ORDER BY total DESC`),
+      db.query(`SELECT DATE_TRUNC('month', expense_date)::DATE as month, SUM(amount) as total FROM expenses GROUP BY DATE_TRUNC('month', expense_date) ORDER BY month DESC LIMIT 12`),
+    ]);
+    res.json({ total: total.rows[0], byCategory: byCategory.rows, byMonth: byMonth.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM expenses WHERE id=$1`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/expenses', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { category, startDate, endDate, paymentMethod } = req.query;
+    let query = `SELECT * FROM expenses WHERE 1=1`;
+    const params = [];
+    let i = 1;
+    if (category) { query += ` AND category=$${i++}`; params.push(category); }
+    if (startDate) { query += ` AND expense_date>=$${i++}`; params.push(startDate); }
+    if (endDate) { query += ` AND expense_date<=$${i++}`; params.push(endDate); }
+    if (paymentMethod) { query += ` AND payment_method=$${i++}`; params.push(paymentMethod); }
+    query += ` ORDER BY expense_date DESC`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/expenses', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { expenseDate, category, description, amount, paymentMethod, notes, receiptUrl } = req.body;
+    if (!expenseDate || !category || !amount) return res.status(400).json({ error: 'expenseDate, category, and amount are required' });
+    const expenseId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO expenses (id, expense_date, category, description, amount, payment_method, notes, receipt_url, submitted_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [expenseId, expenseDate, category, description||null, amount, paymentMethod||null, notes||null, receiptUrl||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'expenses', expenseId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { expenseDate, category, description, amount, paymentMethod, notes, receiptUrl } = req.body;
+    const result = await db.query(
+      `UPDATE expenses SET expense_date=COALESCE($1,expense_date), category=COALESCE($2,category), description=COALESCE($3,description),
+        amount=COALESCE($4,amount), payment_method=COALESCE($5,payment_method), notes=COALESCE($6,notes), receipt_url=COALESCE($7,receipt_url), updated_at=NOW()
+       WHERE id=$8 RETURNING *`,
+      [expenseDate, category, description, amount, paymentMethod, notes, receiptUrl, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    await auditLog(req.user.id, 'UPDATE', 'expenses', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM expenses WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    await auditLog(req.user.id, 'DELETE', 'expenses', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Expense deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── COMPLIANCE ───────────────────────────────────────────────────────────────
+
+router.get('/compliance/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [expiredBg, expiredTraining, trainingByType, bgStatus] = await Promise.all([
+      db.query(`SELECT COUNT(*) as expired_bg FROM background_checks WHERE expiration_date < CURRENT_DATE`),
+      db.query(`SELECT COUNT(*) as expired_training FROM training_records WHERE expiration_date < CURRENT_DATE AND status != 'expired'`),
+      db.query(`SELECT training_type, COUNT(*) as count FROM training_records WHERE status='completed' GROUP BY training_type ORDER BY count DESC`),
+      db.query(`SELECT status, COUNT(*) as count FROM background_checks GROUP BY status`),
+    ]);
+    res.json({ expiredBackgroundChecks: expiredBg.rows[0].expired_bg, expiredTraining: expiredTraining.rows[0].expired_training, trainingByType: trainingByType.rows, backgroundCheckStatus: bgStatus.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/training-records/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM training_records WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Training record not found' });
+    await auditLog(req.user.id, 'DELETE', 'training_records', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Training record deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/compliance-documents/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM compliance_documents WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Document not found' });
+    await auditLog(req.user.id, 'DELETE', 'compliance_documents', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Document deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/blackout-dates/:dateId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM caregiver_blackout_dates WHERE id=$1 RETURNING *`, [req.params.dateId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Blackout date not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_blackout_dates', req.params.dateId, null, result.rows[0]);
+    res.json({ message: 'Blackout date deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/failsafeRoutes.js b/templates/crm-homecare/backend/src/routes/failsafeRoutes.js
new file mode 100644
index 0000000..3cbbe51
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/failsafeRoutes.js
@@ -0,0 +1,244 @@
+// routes/failsafeRoutes.js
+// Pre-submission validation engine - catches problems before claims get denied
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── VALIDATION RULES ─────────────────────────────────────────────────────────
+const RULES = {
+  // EVV-level validations
+  EVV_HAS_GPS: async (visit) => {
+    if (!visit.gps_in_lat) return { status: 'fail', code: 'EVV_NO_GPS_IN', message: 'No GPS location recorded on clock-in' };
+    if (!visit.gps_out_lat && visit.actual_end) return { status: 'warning', code: 'EVV_NO_GPS_OUT', message: 'No GPS location on clock-out' };
+    return { status: 'pass' };
+  },
+  EVV_HAS_MEDICAID_ID: async (visit) => {
+    if (!visit.medicaid_id) return { status: 'fail', code: 'EVV_NO_MEDICAID_ID', message: `Client ${visit.client_first} ${visit.client_last} has no Medicaid ID` };
+    return { status: 'pass' };
+  },
+  EVV_HAS_WORKER_ID: async (visit) => {
+    if (!visit.evv_worker_id && !visit.npi_number) return { status: 'fail', code: 'EVV_NO_WORKER_ID', message: `Caregiver ${visit.cg_first} ${visit.cg_last} has no EVV Worker ID or NPI` };
+    return { status: 'pass' };
+  },
+  EVV_WITHIN_AUTH: async (visit) => {
+    if (!visit.authorization_id) return { status: 'warning', code: 'EVV_NO_AUTH', message: 'No authorization linked to this visit — verify manually' };
+    if (visit.auth_remaining_units !== null && visit.auth_remaining_units < 0) {
+      return { status: 'fail', code: 'EVV_EXCEEDS_AUTH', message: `Authorization exhausted: ${Math.abs(visit.auth_remaining_units).toFixed(1)} units over limit` };
+    }
+    return { status: 'pass' };
+  },
+  EVV_AUTH_ACTIVE: async (visit) => {
+    if (!visit.auth_end_date) return { status: 'pass' };
+    if (new Date(visit.service_date) > new Date(visit.auth_end_date)) {
+      return { status: 'fail', code: 'EVV_AUTH_EXPIRED', message: `Authorization expired on ${new Date(visit.auth_end_date).toLocaleDateString()}` };
+    }
+    return { status: 'pass' };
+  },
+  EVV_NO_DUPLICATE: async (visit) => {
+    const dup = await db.query(`
+      SELECT id FROM evv_visits
+      WHERE client_id = $1 AND caregiver_id = $2 AND service_date = $3
+        AND id != $4 AND sandata_status NOT IN ('rejected')
+    `, [visit.client_id, visit.caregiver_id, visit.service_date, visit.id]);
+    if (dup.rows.length > 0) return { status: 'warning', code: 'EVV_POSSIBLE_DUPLICATE', message: 'Another EVV visit exists for same client, caregiver, and date' };
+    return { status: 'pass' };
+  },
+  EVV_SANDATA_ACCEPTED: async (visit) => {
+    if (visit.sandata_status === 'accepted') return { status: 'pass' };
+    if (visit.sandata_status === 'submitted') return { status: 'warning', code: 'EVV_PENDING_SANDATA', message: 'EVV submitted to Sandata but acceptance not yet confirmed' };
+    if (visit.sandata_status === 'exception') return { status: 'fail', code: 'EVV_EXCEPTION', message: `Sandata exception: ${visit.sandata_exception_desc || visit.sandata_exception_code}` };
+    if (!getSandataConfig()) return { status: 'warning', code: 'EVV_NOT_SUBMITTED', message: 'EVV not yet submitted to Sandata (credentials not configured)' };
+    return { status: 'fail', code: 'EVV_NOT_SUBMITTED', message: 'EVV not yet submitted to Sandata' };
+  },
+  // Claim-level validations
+  CLAIM_HAS_SERVICE_CODE: async (claim) => {
+    if (!claim.procedure_code) return { status: 'fail', code: 'CLAIM_NO_CODE', message: 'Claim has no procedure code' };
+    return { status: 'pass' };
+  },
+  CLAIM_NO_DUPLICATE: async (claim) => {
+    const dup = await db.query(`
+      SELECT id FROM claims
+      WHERE client_id = $1 AND procedure_code = $2
+        AND service_date_from = $3 AND service_date_to = $4
+        AND id != $5 AND status NOT IN ('denied', 'void')
+    `, [claim.client_id, claim.procedure_code, claim.service_date_from, claim.service_date_to, claim.id]);
+    if (dup.rows.length > 0) return { status: 'fail', code: 'CLAIM_DUPLICATE', message: 'Duplicate claim detected for same client, service, and dates' };
+    return { status: 'pass' };
+  },
+  CAREGIVER_CREDENTIALS_CURRENT: async (claim) => {
+    const bg = await db.query(`
+      SELECT * FROM background_checks
+      WHERE caregiver_id = $1
+        AND (expiry_date IS NULL OR expiry_date > CURRENT_DATE)
+        AND status = 'clear'
+      LIMIT 1
+    `, [claim.caregiver_id || claim.created_by]);
+    if (!bg.rows.length) return { status: 'warning', code: 'CLAIM_CRED_EXPIRED', message: 'Caregiver may have expired background check — verify before submitting' };
+    return { status: 'pass' };
+  },
+};
+
+function getSandataConfig() {
+  return !!(process.env.SANDATA_USERNAME && process.env.SANDATA_PASSWORD);
+}
+
+// ─── VALIDATE EVV VISITS BEFORE CLAIM GENERATION ─────────────────────────────
+router.post('/validate-evv', auth, requireAdmin, async (req, res) => {
+  try {
+    const { visitIds } = req.body;
+
+    const visits = await db.query(`
+      SELECT ev.*,
+        c.first_name as client_first, c.last_name as client_last,
+        c.medicaid_id,
+        u.first_name as cg_first, u.last_name as cg_last,
+        cp.evv_worker_id, cp.npi_number,
+        a.auth_number, a.end_date as auth_end_date,
+        a.authorized_units - a.used_units as auth_remaining_units
+      FROM evv_visits ev
+      JOIN clients c ON ev.client_id = c.id
+      JOIN users u ON ev.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      LEFT JOIN authorizations a ON ev.authorization_id = a.id
+      WHERE ev.id = ANY($1)
+    `, [visitIds]);
+
+    const validationResults = [];
+    let allPass = true;
+
+    for (const visit of visits.rows) {
+      const visitResults = { visitId: visit.id, checks: [], canProceed: true };
+
+      for (const [ruleName, ruleFn] of Object.entries(RULES)) {
+        if (!ruleName.startsWith('EVV_')) continue;
+        try {
+          const result = await ruleFn(visit);
+          visitResults.checks.push({ rule: ruleName, ...result });
+          if (result.status === 'fail') {
+            visitResults.canProceed = false;
+            allPass = false;
+          }
+          if (result.status !== 'pass') {
+            // Log validation issue
+            await db.query(`
+              INSERT INTO validation_log (id, entity_type, entity_id, validation_type, status, message, details)
+              VALUES ($1,'evv_visit',$2,$3,$4,$5,$6)
+              ON CONFLICT DO NOTHING
+            `, [uuidv4(), visit.id, result.code, result.status, result.message, JSON.stringify({ visitId: visit.id, rule: ruleName })]);
+          }
+        } catch (e) { /* skip failed rule */ }
+      }
+
+      validationResults.push(visitResults);
+    }
+
+    res.json({
+      allPass,
+      canGenerateClaims: allPass,
+      results: validationResults,
+      summary: {
+        total: validationResults.length,
+        pass: validationResults.filter(v => v.canProceed).length,
+        fail: validationResults.filter(v => !v.canProceed).length,
+      }
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── VALIDATE CLAIMS BEFORE SUBMISSION ───────────────────────────────────────
+router.post('/validate-claims', auth, requireAdmin, async (req, res) => {
+  try {
+    const { claimIds } = req.body;
+
+    const claims = await db.query(`
+      SELECT c.*,
+        cl.first_name as client_first, cl.last_name as client_last, cl.medicaid_id,
+        rs.name as payer_name, rs.edi_payer_id,
+        ev.sandata_status, ev.sandata_exception_desc, ev.is_verified as evv_verified,
+        ev.gps_in_lat, ev.gps_out_lat, ev.gps_in_lng, ev.gps_out_lng,
+        ev.evv_worker_id, ev.npi_number
+      FROM claims c
+      JOIN clients cl ON c.client_id = cl.id
+      LEFT JOIN referral_sources rs ON c.payer_id = rs.id
+      LEFT JOIN evv_visits ev ON c.evv_visit_id = ev.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = c.created_by
+      WHERE c.id = ANY($1)
+    `, [claimIds]);
+
+    const results = [];
+    let allPass = true;
+
+    for (const claim of claims.rows) {
+      const claimResult = { claimId: claim.id, checks: [], canSubmit: true };
+
+      // Check EVV-to-claim match
+      if (claim.evv_visit_id && claim.sandata_status !== 'accepted') {
+        const check = { rule: 'EVV_SANDATA_ACCEPTED', status: 'warning', code: 'EVV_NOT_ACCEPTED', message: `EVV status is "${claim.sandata_status}" — ideally should be accepted before submitting claim` };
+        claimResult.checks.push(check);
+      } else if (!claim.evv_visit_id) {
+        claimResult.checks.push({ rule: 'EVV_LINKED', status: 'warning', code: 'NO_EVV_LINK', message: 'No EVV visit linked to this claim' });
+      }
+
+      for (const [ruleName, ruleFn] of Object.entries(RULES)) {
+        if (!ruleName.startsWith('CLAIM_') && !ruleName.startsWith('CAREGIVER_')) continue;
+        try {
+          const result = await ruleFn(claim);
+          claimResult.checks.push({ rule: ruleName, ...result });
+          if (result.status === 'fail') {
+            claimResult.canSubmit = false;
+            allPass = false;
+          }
+        } catch (e) { /* skip */ }
+      }
+
+      results.push(claimResult);
+    }
+
+    res.json({
+      allPass,
+      results,
+      summary: {
+        total: results.length,
+        readyToSubmit: results.filter(r => r.canSubmit).length,
+        blocked: results.filter(r => !r.canSubmit).length,
+      }
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET OPEN VALIDATION ISSUES ───────────────────────────────────────────────
+router.get('/issues', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT vl.*
+      FROM validation_log vl
+      WHERE vl.resolved_at IS NULL
+        AND vl.status IN ('fail', 'warning')
+      ORDER BY vl.status DESC, vl.created_at DESC
+      LIMIT 100
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── RESOLVE ISSUE ────────────────────────────────────────────────────────────
+router.put('/issues/:id/resolve', auth, requireAdmin, async (req, res) => {
+  try {
+    await db.query(`UPDATE validation_log SET resolved_at = NOW(), resolved_by = $1 WHERE id = $2`, [req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/familyPortalRoutes.js b/templates/crm-homecare/backend/src/routes/familyPortalRoutes.js
new file mode 100644
index 0000000..40ce228
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/familyPortalRoutes.js
@@ -0,0 +1,402 @@
+// routes/familyPortalRoutes.js
+// Family Portal - Allow families to view client info
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const bcrypt = require('bcryptjs');
+const jwt = require('jsonwebtoken');
+
+// ==================== ADMIN ENDPOINTS ====================
+
+// Get all family members (admin view)
+router.get('/admin/members', auth, async (req, res) => {
+  const { status, clientId } = req.query;
+  try {
+    let query = `
+      SELECT fm.*, 
+        c.first_name as client_first_name, c.last_name as client_last_name,
+        u.email as login_email
+      FROM family_members fm
+      JOIN clients c ON fm.client_id = c.id
+      LEFT JOIN users u ON fm.user_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status === 'active') {
+      query += ` AND fm.is_active = true`;
+    } else if (status === 'inactive') {
+      query += ` AND fm.is_active = false`;
+    }
+
+    if (clientId) {
+      params.push(clientId);
+      query += ` AND fm.client_id = $${params.length}`;
+    }
+
+    query += ` ORDER BY c.last_name, c.first_name, fm.is_primary_contact DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Add family member (admin)
+router.post('/admin/members', auth, async (req, res) => {
+  const { 
+    clientId, firstName, lastName, email, phone, relationship, password,
+    canViewSchedule, canViewCarePlan, canViewMedications, canMessage 
+  } = req.body;
+  
+  try {
+    let userId = null;
+
+    // Create user account for portal access
+    if (email && password) {
+      const hashedPassword = await bcrypt.hash(password, 10);
+      
+      const userResult = await db.query(`
+        INSERT INTO users (email, password, first_name, last_name, role, status)
+        VALUES ($1, $2, $3, $4, 'family', 'active')
+        RETURNING id
+      `, [email, hashedPassword, firstName, lastName]);
+      
+      userId = userResult.rows[0].id;
+    }
+
+    const result = await db.query(`
+      INSERT INTO family_members 
+      (client_id, user_id, first_name, last_name, email, phone, relationship, 
+       can_view_schedule, can_view_care_plan, can_view_medications, can_message, is_active)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, true)
+      RETURNING *
+    `, [
+      clientId, userId, firstName, lastName, email, phone, relationship,
+      canViewSchedule !== false, canViewCarePlan !== false, 
+      canViewMedications === true, canMessage !== false
+    ]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    if (error.code === '23505') {
+      res.status(400).json({ error: 'Email already exists' });
+    } else {
+      res.status(500).json({ error: error.message });
+    }
+  }
+});
+
+// Update family member status (admin)
+router.put('/admin/members/:id/status', auth, async (req, res) => {
+  const { isActive } = req.body;
+  try {
+    await db.query(`
+      UPDATE family_members SET is_active = $1, updated_at = NOW() WHERE id = $2
+    `, [isActive, req.params.id]);
+
+    // Also update user status if linked
+    const fm = await db.query('SELECT user_id FROM family_members WHERE id = $1', [req.params.id]);
+    if (fm.rows[0]?.user_id) {
+      await db.query(`
+        UPDATE users SET status = $1 WHERE id = $2
+      `, [isActive ? 'active' : 'inactive', fm.rows[0].user_id]);
+    }
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Reset family member password (admin)
+router.put('/admin/members/:id/reset-password', auth, async (req, res) => {
+  const { password } = req.body;
+  try {
+    const fm = await db.query('SELECT user_id FROM family_members WHERE id = $1', [req.params.id]);
+    if (!fm.rows[0]?.user_id) {
+      return res.status(400).json({ error: 'No user account linked to this family member' });
+    }
+
+    const hashedPassword = await bcrypt.hash(password, 10);
+    await db.query('UPDATE users SET password = $1 WHERE id = $2', [hashedPassword, fm.rows[0].user_id]);
+    
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get all family messages (admin)
+router.get('/admin/messages', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT fm.*, 
+        fam.first_name as sender_first_name, fam.last_name as sender_last_name,
+        c.first_name as client_first_name, c.last_name as client_last_name
+      FROM family_messages fm
+      JOIN family_members fam ON fm.family_member_id = fam.id
+      JOIN clients c ON fm.client_id = c.id
+      WHERE fm.direction = 'inbound'
+      ORDER BY fm.is_read ASC, fm.created_at DESC
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Reply to family message (admin)
+router.post('/admin/messages/:id/reply', auth, async (req, res) => {
+  const { reply } = req.body;
+  try {
+    // Mark original as read and add reply
+    await db.query(`
+      UPDATE family_messages 
+      SET is_read = true, reply = $1, replied_at = NOW(), replied_by = $2
+      WHERE id = $3
+    `, [reply, req.user.id, req.params.id]);
+
+    // Get original message details for creating reply record
+    const original = await db.query('SELECT * FROM family_messages WHERE id = $1', [req.params.id]);
+    if (original.rows[0]) {
+      await db.query(`
+        INSERT INTO family_messages (client_id, family_member_id, direction, message)
+        VALUES ($1, $2, 'outbound', $3)
+      `, [original.rows[0].client_id, original.rows[0].family_member_id, reply]);
+    }
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update family member (admin)
+router.put('/admin/members/:id', auth, async (req, res) => {
+  const { firstName, lastName, email, phone, relationship, canViewSchedule, canViewCarePlan, canViewMedications, canMessage } = req.body;
+  
+  try {
+    const result = await db.query(`
+      UPDATE family_members SET
+        first_name = COALESCE($1, first_name),
+        last_name = COALESCE($2, last_name),
+        email = COALESCE($3, email),
+        phone = COALESCE($4, phone),
+        relationship = COALESCE($5, relationship),
+        can_view_schedule = COALESCE($6, can_view_schedule),
+        can_view_care_plan = COALESCE($7, can_view_care_plan),
+        can_view_medications = COALESCE($8, can_view_medications),
+        can_message = COALESCE($9, can_message),
+        updated_at = NOW()
+      WHERE id = $10
+      RETURNING *
+    `, [firstName, lastName, email, phone, relationship, canViewSchedule, canViewCarePlan, canViewMedications, canMessage, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get family members for a specific client (admin)
+router.get('/client/:clientId/members', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT fm.*, u.email as login_email
+      FROM family_members fm
+      LEFT JOIN users u ON fm.user_id = u.id
+      WHERE fm.client_id = $1
+      ORDER BY fm.is_primary_contact DESC, fm.first_name
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== FAMILY PORTAL ENDPOINTS ====================
+
+// Family login
+router.post('/login', async (req, res) => {
+  const { email, password } = req.body;
+  
+  try {
+    const user = await db.query(`
+      SELECT u.*, fm.id as family_member_id, fm.client_id
+      FROM users u
+      JOIN family_members fm ON fm.user_id = u.id
+      WHERE u.email = $1 AND u.role = 'family' AND u.status = 'active'
+    `, [email]);
+
+    if (user.rows.length === 0) {
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    const valid = await bcrypt.compare(password, user.rows[0].password);
+    if (!valid) {
+      return res.status(401).json({ error: 'Invalid credentials' });
+    }
+
+    // Update last login
+    await db.query('UPDATE family_members SET last_login = NOW() WHERE user_id = $1', [user.rows[0].id]);
+
+    const token = jwt.sign(
+      { id: user.rows[0].id, role: 'family', clientId: user.rows[0].client_id, familyMemberId: user.rows[0].family_member_id },
+      process.env.JWT_SECRET,
+      { expiresIn: '24h' }
+    );
+
+    res.json({ token, user: { ...user.rows[0], password: undefined } });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Family middleware
+const familyAuth = async (req, res, next) => {
+  try {
+    const token = req.headers.authorization?.split(' ')[1];
+    if (!token) return res.status(401).json({ error: 'No token' });
+
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+    if (decoded.role !== 'family') return res.status(403).json({ error: 'Access denied' });
+
+    const fm = await db.query('SELECT * FROM family_members WHERE id = $1 AND is_active = true', [decoded.familyMemberId]);
+    if (fm.rows.length === 0) return res.status(403).json({ error: 'Access denied' });
+
+    req.familyMember = fm.rows[0];
+    req.clientId = decoded.clientId;
+    next();
+  } catch (error) {
+    res.status(401).json({ error: 'Invalid token' });
+  }
+};
+
+// Get client info (for family)
+router.get('/portal/client', familyAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT id, first_name, last_name, date_of_birth, address, city, state, zip, phone
+      FROM clients WHERE id = $1
+    `, [req.clientId]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get schedule (for family)
+router.get('/portal/schedule', familyAuth, async (req, res) => {
+  if (!req.familyMember.can_view_schedule) {
+    return res.status(403).json({ error: 'Access denied' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT s.*, cp.first_name as caregiver_first, cp.last_name as caregiver_last
+      FROM schedules s
+      LEFT JOIN caregiver_profiles cp ON s.caregiver_id = cp.id
+      WHERE s.client_id = $1 AND s.scheduled_date >= CURRENT_DATE
+      ORDER BY s.scheduled_date, s.start_time
+    `, [req.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get care plan (for family)
+router.get('/portal/care-plan', familyAuth, async (req, res) => {
+  if (!req.familyMember.can_view_care_plan) {
+    return res.status(403).json({ error: 'Access denied' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT * FROM care_plans WHERE client_id = $1 AND status = 'active'
+      ORDER BY created_at DESC LIMIT 1
+    `, [req.clientId]);
+    res.json(result.rows[0] || null);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get medications (for family)
+router.get('/portal/medications', familyAuth, async (req, res) => {
+  if (!req.familyMember.can_view_medications) {
+    return res.status(403).json({ error: 'Access denied' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT * FROM client_medications WHERE client_id = $1 AND is_active = true
+      ORDER BY medication_name
+    `, [req.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get visit notes (for family)
+router.get('/portal/notes', familyAuth, async (req, res) => {
+  if (!req.familyMember.can_view_care_plan) {
+    return res.status(403).json({ error: 'Access denied' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT te.id, te.clock_in, te.clock_out, te.hours, te.notes,
+        cp.first_name as caregiver_first, cp.last_name as caregiver_last
+      FROM time_entries te
+      JOIN caregiver_profiles cp ON te.caregiver_id = cp.id
+      WHERE te.client_id = $1 AND te.status = 'approved'
+      ORDER BY te.clock_in DESC
+      LIMIT 30
+    `, [req.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Send message to admin (family)
+router.post('/portal/messages', familyAuth, async (req, res) => {
+  if (!req.familyMember.can_message) {
+    return res.status(403).json({ error: 'Access denied' });
+  }
+
+  const { subject, message } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO family_messages (client_id, family_member_id, direction, subject, message)
+      VALUES ($1, $2, 'inbound', $3, $4)
+      RETURNING *
+    `, [req.clientId, req.familyMember.id, subject, message]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get messages (family)
+router.get('/portal/messages', familyAuth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT * FROM family_messages
+      WHERE client_id = $1 AND family_member_id = $2
+      ORDER BY created_at DESC
+      LIMIT 50
+    `, [req.clientId, req.familyMember.id]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/forecastRoutes.js b/templates/crm-homecare/backend/src/routes/forecastRoutes.js
new file mode 100644
index 0000000..abe89d1
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/forecastRoutes.js
@@ -0,0 +1,135 @@
+// routes/forecastRoutes.js
+// Revenue forecasting based on authorizations, schedules, and billing history
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// GET revenue forecast — projected vs actual by week/month
+router.get('/revenue', auth, async (req, res) => {
+  const { period = 'month', months = 3 } = req.query;
+  try {
+    // Actual billed revenue last N months
+    const actual = await db.query(`
+      SELECT
+        DATE_TRUNC('month', service_date) AS period,
+        SUM(total_amount) AS billed,
+        SUM(paid_amount) AS collected,
+        COUNT(*) AS claim_count
+      FROM claims
+      WHERE service_date >= CURRENT_DATE - ($1 * INTERVAL '1 month')
+        AND status NOT IN ('voided','rejected')
+      GROUP BY 1 ORDER BY 1
+    `, [months]);
+
+    // Projected revenue from active authorizations + scheduled hours
+    const projected = await db.query(`
+      SELECT
+        a.client_id,
+        c.first_name || ' ' || c.last_name AS client_name,
+        a.service_type,
+        a.authorized_hours,
+        a.used_hours,
+        (a.authorized_hours - a.used_hours) AS remaining_hours,
+        a.hourly_rate,
+        ((a.authorized_hours - a.used_hours) * COALESCE(a.hourly_rate, 18.50)) AS projected_remaining_revenue,
+        a.end_date
+      FROM authorizations a
+      JOIN clients c ON a.client_id = c.id
+      WHERE a.status = 'active'
+        AND a.end_date >= CURRENT_DATE
+        AND (a.authorized_hours - a.used_hours) > 0
+      ORDER BY projected_remaining_revenue DESC
+    `);
+
+    // Weekly scheduled hours (current + next 4 weeks)
+    const weekly = await db.query(`
+      SELECT
+        DATE_TRUNC('week', gs.dt) AS week_start,
+        COUNT(DISTINCT s.caregiver_id) AS caregiver_count,
+        COUNT(*) AS shift_count,
+        SUM(
+          EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 3600.0
+        ) AS scheduled_hours,
+        SUM(
+          EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 3600.0
+        ) * 18.50 AS estimated_revenue
+      FROM schedules s
+      CROSS JOIN LATERAL generate_series(CURRENT_DATE, CURRENT_DATE + 27, '1 day') AS gs(dt)
+      WHERE s.is_active = TRUE
+        AND (
+          (s.schedule_type = 'recurring' AND s.day_of_week = EXTRACT(DOW FROM gs.dt)::int)
+          OR (s.schedule_type = 'one-time' AND s.date = gs.dt)
+          OR (s.schedule_type = 'bi-weekly' AND s.day_of_week = EXTRACT(DOW FROM gs.dt)::int)
+        )
+      GROUP BY 1 ORDER BY 1
+    `);
+
+    // Top clients by revenue (last 90 days)
+    const topClients = await db.query(`
+      SELECT
+        cl.client_id,
+        c.first_name || ' ' || c.last_name AS client_name,
+        SUM(cl.total_amount) AS total_billed,
+        SUM(cl.paid_amount) AS total_collected,
+        COUNT(*) AS claim_count,
+        AVG(cl.total_amount) AS avg_claim
+      FROM claims cl
+      JOIN clients c ON cl.client_id = c.id
+      WHERE cl.service_date >= CURRENT_DATE - INTERVAL '90 days'
+        AND cl.status NOT IN ('voided','rejected')
+      GROUP BY 1,2 ORDER BY 3 DESC LIMIT 10
+    `);
+
+    // Auth utilization summary
+    const authSummary = await db.query(`
+      SELECT
+        COUNT(*) AS total_active_auths,
+        SUM(authorized_hours) AS total_auth_hours,
+        SUM(used_hours) AS total_used_hours,
+        ROUND(AVG(used_hours::numeric / NULLIF(authorized_hours,0) * 100), 1) AS avg_utilization_pct,
+        SUM((authorized_hours - used_hours) * COALESCE(hourly_rate, 18.50)) AS total_projected_remaining
+      FROM authorizations
+      WHERE status = 'active' AND end_date >= CURRENT_DATE
+    `);
+
+    res.json({
+      actual: actual.rows,
+      projected: projected.rows,
+      weekly: weekly.rows,
+      topClients: topClients.rows,
+      authSummary: authSummary.rows[0] || {}
+    });
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// GET caregiver utilization
+router.get('/caregiver-utilization', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        u.id,
+        u.first_name || ' ' || u.last_name AS caregiver_name,
+        COUNT(DISTINCT s.client_id) AS client_count,
+        SUM(
+          EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 3600.0
+        ) AS weekly_hours,
+        SUM(
+          EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 3600.0
+        ) * 18.50 AS weekly_revenue,
+        u.employment_type
+      FROM users u
+      LEFT JOIN schedules s ON s.caregiver_id = u.id AND s.is_active = TRUE
+        AND s.day_of_week IN (
+          SELECT EXTRACT(DOW FROM CURRENT_DATE - i)::int FROM generate_series(0,6) i
+        )
+      WHERE u.role = 'caregiver' AND u.is_active = TRUE
+      GROUP BY u.id, u.first_name, u.last_name, u.employment_type
+      ORDER BY weekly_hours DESC NULLS LAST
+    `);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/formBuilderRoutes.js b/templates/crm-homecare/backend/src/routes/formBuilderRoutes.js
new file mode 100644
index 0000000..2ec9d23
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/formBuilderRoutes.js
@@ -0,0 +1,150 @@
+// routes/formBuilderRoutes.js
+// Custom form templates + submissions
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// ── TEMPLATES ──────────────────────────────────────────
+
+router.get('/templates', auth, async (req, res) => {
+  const { category, active = 'true' } = req.query;
+  try {
+    let q = `SELECT ft.*, u.first_name || ' ' || u.last_name AS created_by_name,
+      (SELECT COUNT(*) FROM form_submissions fs WHERE fs.template_id = ft.id) AS submission_count
+      FROM form_templates ft LEFT JOIN users u ON ft.created_by = u.id WHERE 1=1`;
+    const params = [];
+    if (active !== 'all') { params.push(active === 'true'); q += ` AND ft.is_active=$${params.length}`; }
+    if (category) { params.push(category); q += ` AND ft.category=$${params.length}`; }
+    q += ' ORDER BY ft.category, ft.name';
+    const result = await db.query(q, params);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.get('/templates/:id', auth, async (req, res) => {
+  try {
+    const result = await db.query('SELECT * FROM form_templates WHERE id=$1', [req.params.id]);
+    if (!result.rows.length) return res.status(404).json({ error: 'Not found' });
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.post('/templates', auth, async (req, res) => {
+  const { name, description, category = 'general', fields = [], requiresSignature = false, autoAttachTo } = req.body;
+  if (!name) return res.status(400).json({ error: 'name required' });
+  try {
+    const result = await db.query(`
+      INSERT INTO form_templates (name, description, category, fields, requires_signature, auto_attach_to, created_by)
+      VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING *
+    `, [name, description || null, category, JSON.stringify(fields), requiresSignature, autoAttachTo || null, req.user.id]);
+    res.status(201).json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.put('/templates/:id', auth, async (req, res) => {
+  const { name, description, category, fields, requiresSignature, autoAttachTo, isActive } = req.body;
+  try {
+    const result = await db.query(`
+      UPDATE form_templates SET
+        name = COALESCE($1, name),
+        description = COALESCE($2, description),
+        category = COALESCE($3, category),
+        fields = COALESCE($4, fields),
+        requires_signature = COALESCE($5, requires_signature),
+        auto_attach_to = COALESCE($6, auto_attach_to),
+        is_active = COALESCE($7, is_active),
+        updated_at = NOW()
+      WHERE id=$8 RETURNING *
+    `, [name, description, category, fields ? JSON.stringify(fields) : null, requiresSignature, autoAttachTo, isActive, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.delete('/templates/:id', auth, async (req, res) => {
+  try {
+    await db.query('UPDATE form_templates SET is_active=FALSE WHERE id=$1', [req.params.id]);
+    res.json({ message: 'Deactivated' });
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// ── SUBMISSIONS ────────────────────────────────────────
+
+router.get('/submissions', auth, async (req, res) => {
+  const { entityType, entityId, templateId, status, limit = 50 } = req.query;
+  try {
+    let q = `
+      SELECT fs.*, ft.name AS template_name, ft.category,
+        u.first_name || ' ' || u.last_name AS submitted_by_name
+      FROM form_submissions fs
+      LEFT JOIN form_templates ft ON fs.template_id = ft.id
+      LEFT JOIN users u ON fs.submitted_by = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+    if (entityType) { params.push(entityType); q += ` AND fs.entity_type=$${params.length}`; }
+    if (entityId) { params.push(entityId); q += ` AND fs.entity_id=$${params.length}`; }
+    if (templateId) { params.push(templateId); q += ` AND fs.template_id=$${params.length}`; }
+    if (status) { params.push(status); q += ` AND fs.status=$${params.length}`; }
+    q += ` ORDER BY fs.created_at DESC LIMIT $${params.length+1}`;
+    params.push(parseInt(limit));
+    const result = await db.query(q, params);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.get('/submissions/:id', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT fs.*, ft.name AS template_name, ft.fields AS template_fields, ft.category, ft.requires_signature
+      FROM form_submissions fs
+      LEFT JOIN form_templates ft ON fs.template_id = ft.id
+      WHERE fs.id=$1
+    `, [req.params.id]);
+    if (!result.rows.length) return res.status(404).json({ error: 'Not found' });
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.post('/submissions', auth, async (req, res) => {
+  const { templateId, entityType, entityId, data = {}, status = 'submitted', signature } = req.body;
+  if (!templateId) return res.status(400).json({ error: 'templateId required' });
+  try {
+    const tmpl = await db.query('SELECT name FROM form_templates WHERE id=$1', [templateId]);
+    const user = await db.query('SELECT first_name, last_name FROM users WHERE id=$1', [req.user.id]);
+    const name = user.rows[0] ? `${user.rows[0].first_name} ${user.rows[0].last_name}` : 'Unknown';
+    const result = await db.query(`
+      INSERT INTO form_submissions (template_id, template_name, entity_type, entity_id, submitted_by, submitted_by_name, data, status, signature, signed_at)
+      VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9, $10) RETURNING *
+    `, [templateId, tmpl.rows[0]?.name, entityType || null, entityId || null,
+        req.user.id, name, JSON.stringify(data), status,
+        signature || null, signature ? new Date() : null]);
+    res.status(201).json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.put('/submissions/:id', auth, async (req, res) => {
+  const { data, status, signature } = req.body;
+  try {
+    const result = await db.query(`
+      UPDATE form_submissions SET
+        data = COALESCE($1, data),
+        status = COALESCE($2, status),
+        signature = COALESCE($3, signature),
+        signed_at = CASE WHEN $3 IS NOT NULL THEN NOW() ELSE signed_at END,
+        updated_at = NOW()
+      WHERE id=$4 RETURNING *
+    `, [data ? JSON.stringify(data) : null, status, signature || null, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+router.delete('/submissions/:id', auth, async (req, res) => {
+  try {
+    await db.query('DELETE FROM form_submissions WHERE id=$1', [req.params.id]);
+    res.json({ message: 'Deleted' });
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/gustoRoutes.js b/templates/crm-homecare/backend/src/routes/gustoRoutes.js
new file mode 100644
index 0000000..7b53d06
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/gustoRoutes.js
@@ -0,0 +1,218 @@
+// routes/gustoRoutes.js
+// Gusto payroll integration - export verified hours
+// Gusto API key set via: GUSTO_API_KEY, GUSTO_COMPANY_ID
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+function getGustoConfig() {
+  return {
+    apiKey: process.env.GUSTO_API_KEY,
+    companyId: process.env.GUSTO_COMPANY_ID,
+    isConfigured: !!(process.env.GUSTO_API_KEY && process.env.GUSTO_COMPANY_ID),
+    baseUrl: 'https://api.gusto.com/v1'
+  };
+}
+
+async function gustoRequest(method, endpoint, body = null) {
+  const cfg = getGustoConfig();
+  if (!cfg.isConfigured) throw new Error('Gusto not configured. Set GUSTO_API_KEY and GUSTO_COMPANY_ID.');
+  const options = {
+    method,
+    headers: { 'Authorization': `Token ${cfg.apiKey}`, 'Content-Type': 'application/json' }
+  };
+  if (body) options.body = JSON.stringify(body);
+  const res = await fetch(`${cfg.baseUrl}${endpoint}`, options);
+  return { ok: res.ok, status: res.status, data: await res.json() };
+}
+
+// ─── CONFIG STATUS ────────────────────────────────────────────────────────────
+router.get('/config', auth, requireAdmin, async (req, res) => {
+  const cfg = getGustoConfig();
+  res.json({
+    isConfigured: cfg.isConfigured,
+    setupInstructions: cfg.isConfigured ? null : {
+      step1: 'Sign up at gusto.com and create your company',
+      step2: 'Go to Settings → Integrations → API → Create API Key',
+      step3: 'Add to Render env vars: GUSTO_API_KEY and GUSTO_COMPANY_ID',
+      note: 'Gusto starts at $40/mo + $6/employee/mo — worth it when you have 10+ caregivers'
+    }
+  });
+});
+
+// ─── GET EMPLOYEE MAPPING STATUS ─────────────────────────────────────────────
+router.get('/employees', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT u.id, u.first_name, u.last_name, u.email, u.phone,
+        gem.gusto_employee_id, gem.gusto_uuid, gem.is_synced, gem.last_synced_at
+      FROM users u
+      LEFT JOIN gusto_employee_map gem ON gem.user_id = u.id
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      ORDER BY u.last_name, u.first_name
+    `);
+    res.json(result.rows);
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── SYNC EMPLOYEES TO GUSTO ─────────────────────────────────────────────────
+router.post('/sync-employees', auth, requireAdmin, async (req, res) => {
+  const cfg = getGustoConfig();
+  if (!cfg.isConfigured) return res.status(400).json({ error: 'Gusto not configured', setup: true });
+  try {
+    // Get Gusto employees
+    const gustoEmployees = await gustoRequest('GET', `/companies/${cfg.companyId}/employees`);
+    if (!gustoEmployees.ok) return res.status(400).json({ error: 'Could not fetch Gusto employees', details: gustoEmployees.data });
+
+    const gusto = gustoEmployees.data || [];
+    let matched = 0, unmatched = 0;
+
+    for (const ge of gusto) {
+      // Try to match by email first, then name
+      const user = await db.query(`
+        SELECT id FROM users WHERE LOWER(email)=LOWER($1) OR (LOWER(first_name)=LOWER($2) AND LOWER(last_name)=LOWER($3))
+        LIMIT 1
+      `, [ge.email||'', ge.first_name||'', ge.last_name||'']);
+
+      if (user.rows.length) {
+        await db.query(`
+          INSERT INTO gusto_employee_map (id, user_id, gusto_employee_id, gusto_uuid, is_synced, last_synced_at)
+          VALUES ($1,$2,$3,$4,true,NOW())
+          ON CONFLICT (user_id) DO UPDATE SET gusto_employee_id=$3, gusto_uuid=$4, is_synced=true, last_synced_at=NOW()
+        `, [uuidv4(), user.rows[0].id, ge.id, ge.uuid]);
+        matched++;
+      } else { unmatched++; }
+    }
+
+    await db.query(`INSERT INTO gusto_sync_log (id,sync_type,status,records_exported,created_by) VALUES ($1,'employees','success',$2,$3)`,
+      [uuidv4(), matched, req.user.id]);
+
+    res.json({ matched, unmatched, total: gusto.length });
+  } catch(error) {
+    await db.query(`INSERT INTO gusto_sync_log (id,sync_type,status,error_message,created_by) VALUES ($1,'employees','failed',$2,$3)`,
+      [uuidv4(), error.message, req.user.id]);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── PREVIEW PAYROLL EXPORT ───────────────────────────────────────────────────
+router.get('/preview', auth, requireAdmin, async (req, res) => {
+  try {
+    const { startDate, endDate } = req.query;
+    if (!startDate || !endDate) return res.status(400).json({ error: 'startDate and endDate required' });
+
+    const result = await db.query(`
+      SELECT
+        u.id, u.first_name, u.last_name, u.email,
+        gem.gusto_employee_id, gem.is_synced as gusto_mapped,
+        COUNT(te.id) as shift_count,
+        ROUND(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600)::numeric, 2) as total_hours,
+        ROUND(SUM(CASE WHEN EXTRACT(DOW FROM te.start_time) IN (0,6) THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600 ELSE 0 END)::numeric, 2) as weekend_hours,
+        cp.pay_rate as hourly_rate,
+        ROUND(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600)::numeric * COALESCE(cp.pay_rate, 0), 2) as gross_pay
+      FROM users u
+      JOIN time_entries te ON te.caregiver_id = u.id
+      LEFT JOIN gusto_employee_map gem ON gem.user_id = u.id
+      LEFT JOIN (
+        SELECT DISTINCT ON (caregiver_id) caregiver_id, pay_rate
+        FROM caregiver_pay_rates ORDER BY caregiver_id, effective_date DESC
+      ) cp ON cp.caregiver_id = u.id
+      WHERE te.start_time >= $1::date AND te.start_time < $2::date + 1
+        AND te.is_complete = true
+        AND u.role = 'caregiver'
+      GROUP BY u.id, u.first_name, u.last_name, u.email, gem.gusto_employee_id, gem.is_synced, cp.pay_rate
+      ORDER BY u.last_name, u.first_name
+    `, [startDate, endDate]);
+
+    const totals = {
+      employees: result.rows.length,
+      totalHours: result.rows.reduce((s,r) => s + parseFloat(r.total_hours||0), 0).toFixed(2),
+      totalGross: result.rows.reduce((s,r) => s + parseFloat(r.gross_pay||0), 0).toFixed(2),
+      unmapped: result.rows.filter(r => !r.gusto_mapped).length
+    };
+
+    res.json({ preview: result.rows, totals, period: { startDate, endDate } });
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── EXPORT TO GUSTO ──────────────────────────────────────────────────────────
+router.post('/export', auth, requireAdmin, async (req, res) => {
+  const cfg = getGustoConfig();
+  if (!cfg.isConfigured) return res.status(400).json({ error: 'Gusto not configured', setup: true });
+  try {
+    const { startDate, endDate, payPeriodId } = req.body;
+    if (!startDate || !endDate) return res.status(400).json({ error: 'Date range required' });
+
+    const preview = await db.query(`
+      SELECT u.id, gem.gusto_employee_id,
+        ROUND(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600)::numeric, 2) as total_hours
+      FROM users u
+      JOIN time_entries te ON te.caregiver_id = u.id
+      JOIN gusto_employee_map gem ON gem.user_id = u.id
+      WHERE te.start_time >= $1::date AND te.start_time < $2::date + 1
+        AND te.is_complete = true AND u.role = 'caregiver'
+        AND gem.gusto_employee_id IS NOT NULL
+      GROUP BY u.id, gem.gusto_employee_id
+    `, [startDate, endDate]);
+
+    let exported = 0;
+    const errors = [];
+
+    for (const emp of preview.rows) {
+      try {
+        // Push time entries to Gusto pay schedule
+        const payload = {
+          employee_id: emp.gusto_employee_id,
+          regular_hours: parseFloat(emp.total_hours),
+          ...(payPeriodId ? { pay_period_id: payPeriodId } : {})
+        };
+        const result = await gustoRequest('PUT', `/companies/${cfg.companyId}/pay_schedules/unprocessed_termination_pay`, payload);
+        if (result.ok) exported++;
+        else errors.push(`${emp.gusto_employee_id}: ${result.data?.message || 'failed'}`);
+      } catch(e) { errors.push(e.message); }
+    }
+
+    await db.query(`INSERT INTO gusto_sync_log (id,sync_type,status,pay_period_start,pay_period_end,records_exported,error_message,created_by) VALUES ($1,'time_entries',$2,$3,$4,$5,$6,$7)`,
+      [uuidv4(), errors.length === 0 ? 'success' : exported > 0 ? 'partial' : 'failed', startDate, endDate, exported, errors.length > 0 ? errors.join('; ') : null, req.user.id]);
+
+    res.json({ exported, skipped: preview.rows.length - exported, errors });
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CSV EXPORT (fallback if Gusto not configured) ────────────────────────────
+router.get('/export-csv', auth, requireAdmin, async (req, res) => {
+  try {
+    const { startDate, endDate } = req.query;
+    const result = await db.query(`
+      SELECT u.first_name, u.last_name, u.email,
+        ROUND(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600)::numeric, 2) as regular_hours,
+        ROUND(SUM(CASE WHEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600 > 40 THEN EXTRACT(EPOCH FROM (te.end_time - te.start_time))/3600 - 40 ELSE 0 END)::numeric, 2) as overtime_hours
+      FROM users u JOIN time_entries te ON te.caregiver_id = u.id
+      WHERE te.start_time >= $1::date AND te.start_time < $2::date + 1
+        AND te.is_complete = true AND u.role = 'caregiver'
+      GROUP BY u.id, u.first_name, u.last_name, u.email ORDER BY u.last_name
+    `, [startDate || new Date().toISOString().split('T')[0], endDate || new Date().toISOString().split('T')[0]]);
+
+    const lines = ['First Name,Last Name,Email,Regular Hours,Overtime Hours'];
+    for (const r of result.rows) {
+      lines.push(`${r.first_name},${r.last_name},${r.email},${r.regular_hours},${r.overtime_hours}`);
+    }
+
+    res.setHeader('Content-Type', 'text/csv');
+    res.setHeader('Content-Disposition', `attachment; filename="payroll-${startDate}-${endDate}.csv"`);
+    res.send(lines.join('\n'));
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/sync-log', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM gusto_sync_log ORDER BY created_at DESC LIMIT 20`);
+    res.json(result.rows);
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/matchingRoutes.js b/templates/crm-homecare/backend/src/routes/matchingRoutes.js
new file mode 100644
index 0000000..8df09f1
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/matchingRoutes.js
@@ -0,0 +1,835 @@
+// routes/matchingRoutes.js
+// Smart Matching: Capabilities, Needs, Restrictions, Company-wide Optimizer
+// Uses iterative swap optimization (not greedy) for globally optimal assignments
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+
+// ════════════════════════════════════════════════════════════
+// SERVICE CAPABILITIES (Master list)
+// ════════════════════════════════════════════════════════════
+
+router.get('/capabilities', async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT * FROM service_capabilities WHERE is_active = true ORDER BY category, sort_order, name`
+    );
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/capabilities', async (req, res) => {
+  try {
+    const { name, category, description, icon } = req.body;
+    if (!name || !category) return res.status(400).json({ error: 'name and category required' });
+    const result = await db.query(
+      `INSERT INTO service_capabilities (name, category, description, icon)
+       VALUES ($1, $2, $3, $4) RETURNING *`,
+      [name, category, description || null, icon || '📋']
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    if (error.code === '23505') return res.status(409).json({ error: 'Capability already exists' });
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.delete('/capabilities/:id', async (req, res) => {
+  try {
+    await db.query(`UPDATE service_capabilities SET is_active = false WHERE id = $1`, [req.params.id]);
+    res.json({ message: 'Capability deactivated' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ════════════════════════════════════════════════════════════
+// CAREGIVER CAPABILITIES
+// ════════════════════════════════════════════════════════════
+
+router.get('/caregiver/:caregiverId/capabilities', async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT cc.*, sc.name, sc.category, sc.icon, sc.description as cap_description
+      FROM caregiver_capabilities cc
+      JOIN service_capabilities sc ON cc.capability_id = sc.id
+      WHERE cc.caregiver_id = $1 AND sc.is_active = true
+      ORDER BY sc.category, sc.sort_order
+    `, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.put('/caregiver/:caregiverId/capabilities', async (req, res) => {
+  try {
+    const { capabilities } = req.body;
+    if (!Array.isArray(capabilities)) return res.status(400).json({ error: 'capabilities array required' });
+    const caregiverId = req.params.caregiverId;
+    await db.query(`DELETE FROM caregiver_capabilities WHERE caregiver_id = $1`, [caregiverId]);
+    for (const cap of capabilities) {
+      await db.query(
+        `INSERT INTO caregiver_capabilities (caregiver_id, capability_id, proficiency, notes)
+         VALUES ($1, $2, $3, $4)`,
+        [caregiverId, cap.capabilityId, cap.proficiency || 'capable', cap.notes || null]
+      );
+    }
+    const result = await db.query(`
+      SELECT cc.*, sc.name, sc.category, sc.icon
+      FROM caregiver_capabilities cc
+      JOIN service_capabilities sc ON cc.capability_id = sc.id
+      WHERE cc.caregiver_id = $1 AND sc.is_active = true
+      ORDER BY sc.category, sc.sort_order
+    `, [caregiverId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ════════════════════════════════════════════════════════════
+// CLIENT SERVICE NEEDS
+// ════════════════════════════════════════════════════════════
+
+router.get('/client/:clientId/needs', async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT csn.*, sc.name, sc.category, sc.icon
+      FROM client_service_needs csn
+      JOIN service_capabilities sc ON csn.capability_id = sc.id
+      WHERE csn.client_id = $1 AND sc.is_active = true
+      ORDER BY
+        CASE csn.priority WHEN 'critical' THEN 0 WHEN 'high' THEN 1 WHEN 'normal' THEN 2 ELSE 3 END,
+        sc.category, sc.sort_order
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.put('/client/:clientId/needs', async (req, res) => {
+  try {
+    const { needs } = req.body;
+    if (!Array.isArray(needs)) return res.status(400).json({ error: 'needs array required' });
+    const clientId = req.params.clientId;
+    await db.query(`DELETE FROM client_service_needs WHERE client_id = $1`, [clientId]);
+    for (const need of needs) {
+      await db.query(
+        `INSERT INTO client_service_needs (client_id, capability_id, priority, frequency, notes)
+         VALUES ($1, $2, $3, $4, $5)`,
+        [clientId, need.capabilityId, need.priority || 'normal', need.frequency || 'every_visit', need.notes || null]
+      );
+    }
+    const result = await db.query(`
+      SELECT csn.*, sc.name, sc.category, sc.icon
+      FROM client_service_needs csn
+      JOIN service_capabilities sc ON csn.capability_id = sc.id
+      WHERE csn.client_id = $1 AND sc.is_active = true
+      ORDER BY sc.category, sc.sort_order
+    `, [clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ════════════════════════════════════════════════════════════
+// CLIENT SCHEDULE DAY PREFERENCES
+// ════════════════════════════════════════════════════════════
+
+// GET /api/matching/client/:clientId/schedule-prefs
+router.get('/client/:clientId/schedule-prefs', async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT service_days_per_week, service_allowed_days FROM clients WHERE id = $1`,
+      [req.params.clientId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    const row = result.rows[0];
+    res.json({
+      daysPerWeek: row.service_days_per_week || 5,
+      allowedDays: row.service_allowed_days || [1, 2, 3, 4, 5]
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// PUT /api/matching/client/:clientId/schedule-prefs
+router.put('/client/:clientId/schedule-prefs', async (req, res) => {
+  try {
+    const { daysPerWeek, allowedDays } = req.body;
+    if (!Array.isArray(allowedDays) || allowedDays.length === 0) {
+      return res.status(400).json({ error: 'allowedDays must be a non-empty array of day indices (0-6)' });
+    }
+    // Validate day indices
+    if (allowedDays.some(d => d < 0 || d > 6)) {
+      return res.status(400).json({ error: 'Day indices must be 0-6 (Sun-Sat)' });
+    }
+    const effectiveDays = Math.min(daysPerWeek || allowedDays.length, allowedDays.length);
+
+    await db.query(
+      `UPDATE clients SET service_days_per_week = $1, service_allowed_days = $2, updated_at = NOW() WHERE id = $3`,
+      [effectiveDays, JSON.stringify(allowedDays), req.params.clientId]
+    );
+    res.json({ daysPerWeek: effectiveDays, allowedDays });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ════════════════════════════════════════════════════════════
+// CLIENT ↔ CAREGIVER RESTRICTIONS
+// ════════════════════════════════════════════════════════════
+
+router.get('/client/:clientId/restrictions', async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ccr.*, u.first_name as cg_first_name, u.last_name as cg_last_name
+      FROM client_caregiver_restrictions ccr
+      JOIN users u ON ccr.caregiver_id = u.id
+      WHERE ccr.client_id = $1
+      ORDER BY ccr.restriction_type, u.first_name
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.post('/client/:clientId/restrictions', async (req, res) => {
+  try {
+    const { caregiverId, restrictionType, reason } = req.body;
+    if (!caregiverId || !restrictionType) return res.status(400).json({ error: 'caregiverId and restrictionType required' });
+    if (!['preferred', 'excluded', 'locked'].includes(restrictionType)) {
+      return res.status(400).json({ error: 'restrictionType must be preferred, excluded, or locked' });
+    }
+    const result = await db.query(`
+      INSERT INTO client_caregiver_restrictions (client_id, caregiver_id, restriction_type, reason, created_by)
+      VALUES ($1, $2, $3, $4, $5)
+      ON CONFLICT (client_id, caregiver_id)
+      DO UPDATE SET restriction_type = $3, reason = $4, updated_at = NOW()
+      RETURNING *
+    `, [req.params.clientId, caregiverId, restrictionType, reason || null, req.user.id]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.delete('/restrictions/:id', async (req, res) => {
+  try {
+    await db.query(`DELETE FROM client_caregiver_restrictions WHERE id = $1`, [req.params.id]);
+    res.json({ message: 'Restriction removed' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.get('/caregiver/:caregiverId/restrictions', async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ccr.*, c.first_name as cl_first_name, c.last_name as cl_last_name
+      FROM client_caregiver_restrictions ccr
+      JOIN clients c ON ccr.client_id = c.id
+      WHERE ccr.caregiver_id = $1
+      ORDER BY ccr.restriction_type, c.first_name
+    `, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ════════════════════════════════════════════════════════════
+// HELPERS
+// ════════════════════════════════════════════════════════════
+const DAY_NAMES = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
+const DAY_LABELS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+
+const haversine = (lat1, lon1, lat2, lon2) => {
+  if (!lat1 || !lon1 || !lat2 || !lon2) return null;
+  const R = 3959;
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = Math.sin(dLat / 2) ** 2 +
+    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
+    Math.sin(dLon / 2) ** 2;
+  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
+};
+
+function timeToMinutes(timeStr) {
+  if (!timeStr) return 480;
+  const [h, m] = timeStr.split(':').map(Number);
+  return h * 60 + (m || 0);
+}
+
+function minutesToTime(mins) {
+  const h = Math.floor(mins / 60);
+  const m = mins % 60;
+  return `${String(h).padStart(2, '0')}:${String(Math.round(m)).padStart(2, '0')}`;
+}
+
+// ════════════════════════════════════════════════════════════
+// SCORING ENGINE
+// ════════════════════════════════════════════════════════════
+function computePairScore(clientLat, clientLng, caregiver, clientNeeds, cgCaps, restriction, opts) {
+  if (restriction === 'excluded') return { score: -Infinity, blocked: true, reason: 'Excluded' };
+
+  let score = 50;
+  const factors = [];
+  let needsMet = 0, criticalMet = 0, criticalTotal = 0;
+
+  for (const need of clientNeeds) {
+    const hasCap = cgCaps.has(need.capability_id);
+    if (need.priority === 'critical') criticalTotal++;
+    if (hasCap) {
+      needsMet++;
+      if (need.priority === 'critical') criticalMet++;
+      const capInfo = cgCaps.get(need.capability_id);
+      const basePoints = need.priority === 'critical' ? 20 : need.priority === 'high' ? 12 : need.priority === 'normal' ? 6 : 3;
+      const profMult = capInfo.proficiency === 'specialized' ? 1.5 : capInfo.proficiency === 'experienced' ? 1.2 : 1.0;
+      score += Math.round(basePoints * profMult);
+    } else {
+      if (need.priority === 'critical') { score -= 30; factors.push(`Missing critical: ${need.name}`); }
+      else if (need.priority === 'high') score -= 10;
+    }
+  }
+
+  if (clientNeeds.length > 0) {
+    factors.push(`${Math.round((needsMet / clientNeeds.length) * 100)}% needs (${needsMet}/${clientNeeds.length})`);
+  }
+
+  if (restriction === 'preferred' && opts.respectPreferences) { score += 25; factors.push('Preferred'); }
+  if (restriction === 'locked') { score += 40; factors.push('Locked'); }
+
+  if (opts.minimizeDriving && clientLat && caregiver.latitude) {
+    const dist = haversine(
+      parseFloat(caregiver.latitude), parseFloat(caregiver.longitude),
+      parseFloat(clientLat), parseFloat(clientLng)
+    );
+    if (dist !== null) {
+      if (dist <= 5) score += 15;
+      else if (dist <= 10) score += 8;
+      else if (dist <= 15) score += 0;
+      else if (dist <= 25) score -= 10;
+      else score -= 20;
+      factors.push(`${dist.toFixed(1)} mi`);
+    }
+  }
+
+  return { score: Math.max(0, score), blocked: false, needsMet, totalNeeds: clientNeeds.length, criticalMet, criticalTotal, factors };
+}
+
+// ════════════════════════════════════════════════════════════
+// THE OPTIMIZER ENGINE
+// POST /api/matching/optimize
+//
+// 1. Generate daily slots (spread units across days)
+// 2. Score all (slot, caregiver) pairs
+// 3. Initial best-available assignment (hardest-to-fill first)
+// 4. 2-opt swap improvement until stable
+// 5. Return globally-improved solution
+// ════════════════════════════════════════════════════════════
+router.post('/optimize', async (req, res) => {
+  try {
+    const { weekStart, mode, options } = req.body;
+    if (!weekStart) return res.status(400).json({ error: 'weekStart required (YYYY-MM-DD)' });
+
+    const opts = {
+      balanceHours: options?.balanceHours !== false,
+      minimizeDriving: options?.minimizeDriving !== false,
+      respectPreferences: options?.respectPreferences !== false
+    };
+
+    const startDate = new Date(weekStart + 'T12:00:00');
+    const weekDates = [];
+    for (let i = 0; i < 7; i++) {
+      const d = new Date(startDate);
+      d.setDate(d.getDate() + i);
+      weekDates.push({ date: d.toISOString().split('T')[0], dayIndex: d.getDay(), dayName: DAY_NAMES[d.getDay()], dayLabel: DAY_LABELS[d.getDay()] });
+    }
+    const endDateStr = weekDates[6].date;
+
+    // ── Load all data ────────────────────────────
+    const [clientsRes, caregiversRes, capsRes, needsRes, restrictionsRes, existingRes, availRes, blackoutRes] = await Promise.all([
+      db.query(`SELECT id, first_name, last_name, address, city, state, zip, latitude, longitude,
+                weekly_authorized_units, service_type, service_days_per_week, service_allowed_days
+                FROM clients WHERE is_active = true AND weekly_authorized_units > 0
+                ORDER BY weekly_authorized_units DESC`),
+      db.query(`SELECT id, first_name, last_name, address, city, state, zip, latitude, longitude
+                FROM users WHERE role = 'caregiver' AND is_active = true`),
+      db.query(`SELECT cc.caregiver_id, cc.capability_id, cc.proficiency, sc.name
+                FROM caregiver_capabilities cc JOIN service_capabilities sc ON cc.capability_id = sc.id AND sc.is_active = true`),
+      db.query(`SELECT csn.client_id, csn.capability_id, csn.priority, csn.frequency, sc.name
+                FROM client_service_needs csn JOIN service_capabilities sc ON csn.capability_id = sc.id AND sc.is_active = true`),
+      db.query(`SELECT * FROM client_caregiver_restrictions`),
+      db.query(`SELECT * FROM schedules WHERE is_active = true AND date >= $1 AND date <= $2
+                ORDER BY date, start_time`, [weekStart, endDateStr]),
+      db.query(`SELECT * FROM caregiver_availability WHERE caregiver_id IN (
+                SELECT id FROM users WHERE role = 'caregiver' AND is_active = true)`),
+      db.query(`SELECT * FROM caregiver_blackout_dates WHERE start_date <= $1 AND end_date >= $2`, [endDateStr, weekStart])
+        .catch(() => ({ rows: [] }))
+    ]);
+
+    const allClients = clientsRes.rows;
+    const allCaregivers = caregiversRes.rows;
+
+    // ── Build lookups ─────────────────────────
+    const cgCapMap = {};
+    capsRes.rows.forEach(r => {
+      if (!cgCapMap[r.caregiver_id]) cgCapMap[r.caregiver_id] = new Map();
+      cgCapMap[r.caregiver_id].set(r.capability_id, { proficiency: r.proficiency, name: r.name });
+    });
+
+    const clientNeedMap = {};
+    needsRes.rows.forEach(r => {
+      if (!clientNeedMap[r.client_id]) clientNeedMap[r.client_id] = [];
+      clientNeedMap[r.client_id].push(r);
+    });
+
+    const restrictionLookup = {};
+    restrictionsRes.rows.forEach(r => {
+      if (!restrictionLookup[r.client_id]) restrictionLookup[r.client_id] = new Map();
+      restrictionLookup[r.client_id].set(r.caregiver_id, r.restriction_type);
+    });
+
+    const lockedMap = {};
+    restrictionsRes.rows.filter(r => r.restriction_type === 'locked').forEach(r => {
+      if (!lockedMap[r.client_id]) lockedMap[r.client_id] = new Set();
+      lockedMap[r.client_id].add(r.caregiver_id);
+    });
+
+    const availMap = {};
+    availRes.rows.forEach(r => { availMap[r.caregiver_id] = r; });
+
+    const blackoutMap = {};
+    blackoutRes.rows.forEach(r => {
+      if (!blackoutMap[r.caregiver_id]) blackoutMap[r.caregiver_id] = new Set();
+      const s = new Date(r.start_date), e = new Date(r.end_date);
+      for (let d = new Date(s); d <= e; d.setDate(d.getDate() + 1)) {
+        blackoutMap[r.caregiver_id].add(d.toISOString().split('T')[0]);
+      }
+    });
+
+    const existingMap = {};
+    existingRes.rows.forEach(s => {
+      const dateStr = s.date?.toISOString?.()?.split('T')[0] || s.date;
+      const key = `${s.caregiver_id}-${dateStr}`;
+      if (!existingMap[key]) existingMap[key] = [];
+      existingMap[key].push({ clientId: s.client_id, start: s.start_time, end: s.end_time });
+    });
+
+    // ── Generate daily slots (per-client day preferences) ──
+    const slots = [];
+    for (const client of allClients) {
+      const weeklyUnits = client.weekly_authorized_units || 0;
+      if (weeklyUnits <= 0) continue;
+
+      // Client's allowed days (default Mon-Fri)
+      const allowedDayIndices = Array.isArray(client.service_allowed_days)
+        ? client.service_allowed_days
+        : [1, 2, 3, 4, 5];
+      const requestedDaysPerWeek = client.service_days_per_week || allowedDayIndices.length;
+
+      // Filter week dates to only allowed days
+      const availableDays = weekDates.filter(d => allowedDayIndices.includes(d.dayIndex));
+      if (availableDays.length === 0) continue;
+
+      // Use requested days count, capped at available days
+      let daysCount = Math.min(requestedDaysPerWeek, availableDays.length);
+
+      // Ensure minimum 2 units (30 min) per visit
+      if (Math.floor(weeklyUnits / daysCount) < 2 && weeklyUnits >= 2) {
+        daysCount = Math.min(daysCount, Math.floor(weeklyUnits / 2));
+      }
+      daysCount = Math.max(1, daysCount);
+
+      // Pick which days to use (spread evenly across available days)
+      let assignDays;
+      if (daysCount >= availableDays.length) {
+        assignDays = availableDays;
+      } else {
+        // Spread evenly: pick every Nth day
+        const step = availableDays.length / daysCount;
+        assignDays = [];
+        for (let i = 0; i < daysCount; i++) {
+          assignDays.push(availableDays[Math.round(i * step)]);
+        }
+      }
+
+      const basePerDay = Math.floor(weeklyUnits / assignDays.length);
+      let remainder = weeklyUnits - (basePerDay * assignDays.length);
+
+      for (let idx = 0; idx < assignDays.length; idx++) {
+        const day = assignDays[idx];
+        const dayUnits = basePerDay + (idx < remainder ? 1 : 0);
+        if (dayUnits <= 0) continue;
+        slots.push({
+          clientId: client.id,
+          clientName: `${client.first_name} ${client.last_name}`,
+          clientCity: client.city,
+          clientLat: client.latitude ? parseFloat(client.latitude) : null,
+          clientLng: client.longitude ? parseFloat(client.longitude) : null,
+          date: day.date, dayIndex: day.dayIndex, dayLabel: day.dayLabel,
+          units: dayUnits, minutes: dayUnits * 15, weeklyUnits,
+          slotIndex: slots.length
+        });
+      }
+    }
+
+    console.log(`[Optimizer] ${slots.length} daily slots for ${allClients.length} clients, ${allCaregivers.length} caregivers`);
+
+    // ── Score matrix ──────────────────────
+    const scoreMatrix = [];
+    const cgIndexMap = {};
+    allCaregivers.forEach((cg, idx) => { cgIndexMap[cg.id] = idx; });
+
+    for (const slot of slots) {
+      const slotScores = [];
+      const clientNeeds = clientNeedMap[slot.clientId] || [];
+      const clientRestr = restrictionLookup[slot.clientId] || new Map();
+      const clientLocked = lockedMap[slot.clientId];
+
+      for (const cg of allCaregivers) {
+        const restriction = clientRestr.get(cg.id) || null;
+
+        if (clientLocked && clientLocked.size > 0 && !clientLocked.has(cg.id)) {
+          slotScores.push({ score: -Infinity, blocked: true, reason: 'Not locked' });
+          continue;
+        }
+
+        const avail = availMap[cg.id];
+        const dayName = DAY_NAMES[slot.dayIndex];
+        if (avail && !avail[`${dayName}_available`]) {
+          slotScores.push({ score: -Infinity, blocked: true, reason: `Off ${slot.dayLabel}` });
+          continue;
+        }
+        if (avail?.status === 'unavailable') {
+          slotScores.push({ score: -Infinity, blocked: true, reason: 'Unavailable' });
+          continue;
+        }
+        if (blackoutMap[cg.id]?.has(slot.date)) {
+          slotScores.push({ score: -Infinity, blocked: true, reason: 'Blackout' });
+          continue;
+        }
+
+        const cgCaps = cgCapMap[cg.id] || new Map();
+        slotScores.push(computePairScore(slot.clientLat, slot.clientLng, cg, clientNeeds, cgCaps, restriction, opts));
+      }
+      scoreMatrix.push(slotScores);
+    }
+
+    // ── Hour tracking ──────────────────────
+    const cgDayHours = {};
+    const cgWeekHours = {};
+    allCaregivers.forEach(cg => { cgWeekHours[cg.id] = 0; });
+
+    if (mode === 'optimize_existing') {
+      existingRes.rows.forEach(s => {
+        if (s.start_time && s.end_time) {
+          const mins = (new Date(`2000-01-01T${s.end_time}`) - new Date(`2000-01-01T${s.start_time}`)) / 60000;
+          const hrs = mins / 60;
+          const dateStr = s.date?.toISOString?.()?.split('T')[0] || s.date;
+          const dayKey = `${s.caregiver_id}-${dateStr}`;
+          cgDayHours[dayKey] = (cgDayHours[dayKey] || 0) + hrs;
+          cgWeekHours[s.caregiver_id] = (cgWeekHours[s.caregiver_id] || 0) + hrs;
+        }
+      });
+    }
+
+    const assignments = new Array(slots.length).fill(-1);
+
+    function canAssign(si, ci) {
+      const cg = allCaregivers[ci];
+      const slot = slots[si];
+      const hrs = slot.minutes / 60;
+      const maxW = availMap[cg.id]?.max_hours_per_week || 40;
+      if ((cgWeekHours[cg.id] || 0) + hrs > maxW) return false;
+      const avail = availMap[cg.id];
+      if (avail) {
+        const dn = DAY_NAMES[slot.dayIndex];
+        const dayStart = timeToMinutes(avail[`${dn}_start_time`] || '08:00');
+        const dayEnd = timeToMinutes(avail[`${dn}_end_time`] || '17:00');
+        const availMins = dayEnd - dayStart;
+        const dayKey = `${cg.id}-${slot.date}`;
+        if ((cgDayHours[dayKey] || 0) * 60 + slot.minutes > availMins) return false;
+      }
+      return true;
+    }
+
+    function doAssign(si, ci) {
+      const cg = allCaregivers[ci];
+      const hrs = slots[si].minutes / 60;
+      const dayKey = `${cg.id}-${slots[si].date}`;
+      cgDayHours[dayKey] = (cgDayHours[dayKey] || 0) + hrs;
+      cgWeekHours[cg.id] = (cgWeekHours[cg.id] || 0) + hrs;
+      assignments[si] = ci;
+    }
+
+    function doUnassign(si) {
+      const ci = assignments[si];
+      if (ci < 0) return;
+      const cg = allCaregivers[ci];
+      const hrs = slots[si].minutes / 60;
+      const dayKey = `${cg.id}-${slots[si].date}`;
+      cgDayHours[dayKey] = Math.max(0, (cgDayHours[dayKey] || 0) - hrs);
+      cgWeekHours[cg.id] = Math.max(0, (cgWeekHours[cg.id] || 0) - hrs);
+      assignments[si] = -1;
+    }
+
+    function effScore(si, ci) {
+      const base = scoreMatrix[si][ci];
+      if (base.blocked) return -Infinity;
+      let score = base.score;
+      if (opts.balanceHours) {
+        const maxW = availMap[allCaregivers[ci].id]?.max_hours_per_week || 40;
+        const pct = (cgWeekHours[allCaregivers[ci].id] || 0) / maxW;
+        if (pct > 0.9) score -= 20;
+        else if (pct > 0.7) score -= 10;
+        else if (pct > 0.5) score -= 3;
+      }
+      // Continuity: same caregiver already serving this client today
+      const eKey = `${allCaregivers[ci].id}-${slots[si].date}`;
+      if ((existingMap[eKey] || []).some(e => e.clientId === slots[si].clientId)) score += 10;
+      return score;
+    }
+
+    // ── Initial assignment (hardest-to-fill first) ──
+    const slotOrder = slots.map((_, i) => i).sort((a, b) => {
+      const eA = scoreMatrix[a].filter(s => !s.blocked).length;
+      const eB = scoreMatrix[b].filter(s => !s.blocked).length;
+      if (eA !== eB) return eA - eB;
+      const cA = (clientNeedMap[slots[a].clientId] || []).filter(n => n.priority === 'critical').length;
+      const cB = (clientNeedMap[slots[b].clientId] || []).filter(n => n.priority === 'critical').length;
+      return cB - cA;
+    });
+
+    for (const si of slotOrder) {
+      let bestCi = -1, bestS = -Infinity;
+      for (let ci = 0; ci < allCaregivers.length; ci++) {
+        if (scoreMatrix[si][ci].blocked) continue;
+        if (!canAssign(si, ci)) continue;
+        const s = effScore(si, ci);
+        if (s > bestS) { bestS = s; bestCi = ci; }
+      }
+      if (bestCi >= 0) doAssign(si, bestCi);
+    }
+
+    console.log(`[Optimizer] Initial: ${assignments.filter(a => a >= 0).length}/${slots.length} filled`);
+
+    // ── 2-opt swap improvement ───────────────
+    let improved = true;
+    let iters = 0;
+    while (improved && iters < 50) {
+      improved = false;
+      iters++;
+      for (let i = 0; i < slots.length; i++) {
+        for (let j = i + 1; j < slots.length; j++) {
+          const cI = assignments[i], cJ = assignments[j];
+          if (cI < 0 && cJ < 0) continue;
+          if (cI === cJ) continue;
+
+          const curScore = (cI >= 0 ? effScore(i, cI) : 0) + (cJ >= 0 ? effScore(j, cJ) : 0);
+
+          doUnassign(i);
+          doUnassign(j);
+
+          const canSI = cJ >= 0 ? (!scoreMatrix[i][cJ].blocked && canAssign(i, cJ)) : true;
+          const canSJ = cI >= 0 ? (!scoreMatrix[j][cI].blocked && canAssign(j, cI)) : true;
+
+          if (canSI && canSJ) {
+            if (cJ >= 0) doAssign(i, cJ);
+            if (cI >= 0) doAssign(j, cI);
+            const swapScore = (cJ >= 0 ? effScore(i, cJ) : 0) + (cI >= 0 ? effScore(j, cI) : 0);
+            if (swapScore > curScore) { improved = true; continue; }
+            if (cJ >= 0) doUnassign(i);
+            if (cI >= 0) doUnassign(j);
+          }
+          if (cI >= 0) doAssign(i, cI);
+          if (cJ >= 0) doAssign(j, cJ);
+        }
+      }
+    }
+
+    console.log(`[Optimizer] Optimized: ${iters} iters, ${assignments.filter(a => a >= 0).length}/${slots.length} filled`);
+
+    // ── Build results ─────────────────────────────
+    const clientAssignments = {};
+    for (let i = 0; i < slots.length; i++) {
+      const slot = slots[i];
+      if (!clientAssignments[slot.clientId]) {
+        clientAssignments[slot.clientId] = {
+          clientId: slot.clientId, clientName: slot.clientName, clientCity: slot.clientCity,
+          weeklyUnits: slot.weeklyUnits, hoursNeeded: slot.weeklyUnits * 0.25,
+          needsCount: (clientNeedMap[slot.clientId] || []).length,
+          criticalNeedsCount: (clientNeedMap[slot.clientId] || []).filter(n => n.priority === 'critical').length,
+          hasLocked: !!(lockedMap[slot.clientId]?.size),
+          hasExcluded: !!(restrictionLookup[slot.clientId] && [...(restrictionLookup[slot.clientId].values())].some(v => v === 'excluded')),
+          dailySlots: [], unfilledSlots: 0, assignedHours: 0
+        };
+      }
+      const ci = assignments[i];
+      if (ci >= 0) {
+        const cg = allCaregivers[ci];
+        const sc = scoreMatrix[i][ci];
+        clientAssignments[slot.clientId].dailySlots.push({
+          date: slot.date, dayLabel: slot.dayLabel, units: slot.units, hours: slot.minutes / 60,
+          caregiverId: cg.id, caregiverName: `${cg.first_name} ${cg.last_name}`,
+          score: sc.score, needsMet: sc.needsMet, totalNeeds: sc.totalNeeds,
+          criticalMet: sc.criticalMet, criticalTotal: sc.criticalTotal, factors: sc.factors
+        });
+        clientAssignments[slot.clientId].assignedHours += slot.minutes / 60;
+      } else {
+        clientAssignments[slot.clientId].dailySlots.push({
+          date: slot.date, dayLabel: slot.dayLabel, units: slot.units, hours: slot.minutes / 60,
+          caregiverId: null, caregiverName: null, score: 0, warning: 'No eligible caregiver'
+        });
+        clientAssignments[slot.clientId].unfilledSlots++;
+      }
+    }
+
+    const resultAssignments = Object.values(clientAssignments).sort((a, b) => {
+      if (a.unfilledSlots !== b.unfilledSlots) return b.unfilledSlots - a.unfilledSlots;
+      if (a.criticalNeedsCount !== b.criticalNeedsCount) return b.criticalNeedsCount - a.criticalNeedsCount;
+      return a.clientName.localeCompare(b.clientName);
+    });
+
+    const caregiverUtilization = allCaregivers.map(cg => {
+      const maxH = availMap[cg.id]?.max_hours_per_week || 40;
+      const assigned = cgWeekHours[cg.id] || 0;
+      const cls = new Set();
+      for (let i = 0; i < slots.length; i++) if (assignments[i] === cgIndexMap[cg.id]) cls.add(slots[i].clientId);
+      return {
+        caregiverId: cg.id, caregiverName: `${cg.first_name} ${cg.last_name}`,
+        maxHours: maxH, assignedHours: Math.round(assigned * 100) / 100,
+        utilization: Math.round((assigned / maxH) * 100), clientCount: cls.size
+      };
+    }).sort((a, b) => b.utilization - a.utilization);
+
+    const totalNeeded = resultAssignments.reduce((s, a) => s + a.hoursNeeded, 0);
+    const totalAssigned = resultAssignments.reduce((s, a) => s + a.assignedHours, 0);
+    const filledSlots = assignments.filter(a => a >= 0).length;
+    const totalScore = slots.reduce((s, _, i) => s + (assignments[i] >= 0 ? scoreMatrix[i][assignments[i]].score : 0), 0);
+
+    const runId = uuidv4();
+    await db.query(`
+      INSERT INTO optimizer_runs (id, run_type, week_start, week_end, parameters, results_summary,
+        assignments_generated, total_score, run_by) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
+    `, [runId, mode || 'generate_fresh', weekStart, endDateStr, JSON.stringify(opts),
+      JSON.stringify({ totalNeeded, totalAssigned, slots: slots.length, filled: filledSlots, swapIters: iters }),
+      filledSlots, Math.round(totalScore), req.user.id]);
+
+    res.json({
+      runId, mode: mode || 'generate_fresh', weekStart, weekEnd: endDateStr,
+      weekDates: weekDates.map(d => ({ date: d.date, label: d.dayLabel })),
+      assignments: resultAssignments,
+      summary: {
+        totalClients: allClients.length, totalCaregivers: allCaregivers.length,
+        totalSlots: slots.length, filledSlots,
+        slotFillPercent: slots.length > 0 ? Math.round((filledSlots / slots.length) * 100) : 100,
+        totalHoursNeeded: Math.round(totalNeeded * 100) / 100,
+        totalHoursAssigned: Math.round(totalAssigned * 100) / 100,
+        coveragePercent: totalNeeded > 0 ? Math.round((totalAssigned / totalNeeded) * 100) : 100,
+        unfilledClients: resultAssignments.filter(a => a.unfilledSlots > 0).length,
+        fullyFilledClients: resultAssignments.filter(a => a.unfilledSlots === 0).length,
+        totalScore: Math.round(totalScore), swapIterations: iters,
+        existingScheduleCount: existingRes.rows.length
+      },
+      caregiverUtilization
+    });
+  } catch (error) {
+    console.error('Optimizer error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+
+// ════════════════════════════════════════════════════════════
+// APPLY TO SCHEDULE
+// POST /api/matching/apply-schedule
+// ════════════════════════════════════════════════════════════
+router.post('/apply-schedule', async (req, res) => {
+  try {
+    const { assignments, weekStart, clearExisting } = req.body;
+    if (!assignments?.length) return res.status(400).json({ error: 'No assignments' });
+
+    const endDate = new Date(weekStart + 'T12:00:00');
+    endDate.setDate(endDate.getDate() + 6);
+    const endDateStr = endDate.toISOString().split('T')[0];
+
+    let created = 0, skipped = 0, cleared = 0;
+    const errors = [];
+
+    if (clearExisting) {
+      const r = await db.query(
+        `DELETE FROM schedules WHERE date >= $1 AND date <= $2 AND notes LIKE '%[Optimizer]%' AND is_active = true`,
+        [weekStart, endDateStr]
+      );
+      cleared = r.rowCount || 0;
+    }
+
+    for (const assignment of assignments) {
+      for (const slot of assignment.dailySlots) {
+        if (!slot.caregiverId) { skipped++; continue; }
+
+        // Find caregiver's start time for this day
+        let startTime = '08:00';
+        try {
+          const aRes = await db.query(`SELECT * FROM caregiver_availability WHERE caregiver_id = $1`, [slot.caregiverId]);
+          if (aRes.rows[0]) {
+            const dayIdx = new Date(slot.date + 'T12:00:00').getDay();
+            startTime = aRes.rows[0][`${DAY_NAMES[dayIdx]}_start_time`] || '08:00';
+          }
+        } catch (e) {}
+
+        // Stack after existing schedules
+        try {
+          const eRes = await db.query(
+            `SELECT end_time FROM schedules WHERE caregiver_id = $1 AND date = $2 AND is_active = true ORDER BY end_time DESC LIMIT 1`,
+            [slot.caregiverId, slot.date]
+          );
+          if (eRes.rows[0]) {
+            const lastEnd = timeToMinutes(eRes.rows[0].end_time.slice(0, 5));
+            if (lastEnd >= timeToMinutes(startTime)) startTime = minutesToTime(lastEnd + 15);
+          }
+        } catch (e) {}
+
+        const startMins = timeToMinutes(startTime);
+        const endTime = minutesToTime(startMins + (slot.units * 15));
+
+        // Conflict check
+        const conflict = await db.query(
+          `SELECT id FROM schedules WHERE caregiver_id = $1 AND date = $2 AND is_active = true
+           AND NOT (end_time <= $3 OR start_time >= $4)`,
+          [slot.caregiverId, slot.date, startTime, endTime]
+        );
+        if (conflict.rows.length > 0) {
+          errors.push({ clientName: assignment.clientName, date: slot.date, error: 'Time conflict' });
+          skipped++; continue;
+        }
+
+        await db.query(
+          `INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, date, start_time, end_time, notes, is_active)
+           VALUES ($1, $2, $3, 'one-time', $4, $5, $6, $7, true)`,
+          [uuidv4(), slot.caregiverId, assignment.clientId, slot.date, startTime, endTime,
+           `[Optimizer] ${slot.units}u · Score: ${slot.score || 'N/A'}`]
+        );
+        created++;
+      }
+    }
+
+    res.json({ success: true, created, skipped, cleared, errors,
+      message: `Created ${created} schedules${skipped > 0 ? `, ${skipped} skipped` : ''}${cleared > 0 ? `, cleared ${cleared} old` : ''}` });
+  } catch (error) {
+    console.error('Apply schedule error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/medicationsRoutes.js b/templates/crm-homecare/backend/src/routes/medicationsRoutes.js
new file mode 100644
index 0000000..4ead4ef
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/medicationsRoutes.js
@@ -0,0 +1,182 @@
+// routes/medicationsRoutes.js
+// Medication Tracking for clients
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Get client medications
+router.get('/client/:clientId', auth, async (req, res) => {
+  const { activeOnly } = req.query;
+  try {
+    let query = `
+      SELECT * FROM client_medications 
+      WHERE client_id = $1
+    `;
+    if (activeOnly === 'true') {
+      query += ` AND is_active = true`;
+    }
+    query += ` ORDER BY medication_name`;
+    
+    const result = await db.query(query, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Add medication
+router.post('/', auth, async (req, res) => {
+  const { clientId, medicationName, dosage, frequency, route, prescriber, pharmacy, rxNumber, startDate, endDate, instructions, sideEffects, isPrn } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO client_medications 
+      (client_id, medication_name, dosage, frequency, route, prescriber, pharmacy, rx_number, start_date, end_date, instructions, side_effects, is_prn)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)
+      RETURNING *
+    `, [clientId, medicationName, dosage, frequency, route, prescriber, pharmacy, rxNumber, startDate, endDate, instructions, sideEffects, isPrn]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update medication
+router.put('/:id', auth, async (req, res) => {
+  const { medicationName, dosage, frequency, route, prescriber, pharmacy, rxNumber, startDate, endDate, instructions, sideEffects, isPrn, isActive } = req.body;
+  
+  try {
+    const result = await db.query(`
+      UPDATE client_medications SET
+        medication_name = $1, dosage = $2, frequency = $3, route = $4,
+        prescriber = $5, pharmacy = $6, rx_number = $7, start_date = $8, end_date = $9,
+        instructions = $10, side_effects = $11, is_prn = $12, is_active = $13, updated_at = NOW()
+      WHERE id = $14
+      RETURNING *
+    `, [medicationName, dosage, frequency, route, prescriber, pharmacy, rxNumber, startDate, endDate, instructions, sideEffects, isPrn, isActive, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Discontinue medication
+router.put('/:id/discontinue', auth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE client_medications SET is_active = false, end_date = CURRENT_DATE, updated_at = NOW()
+      WHERE id = $1
+    `, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Log medication administration
+router.post('/log', auth, async (req, res) => {
+  const { clientId, medicationId, caregiverId, timeEntryId, scheduledTime, administeredTime, status, dosageGiven, notes } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO medication_logs 
+      (client_id, medication_id, caregiver_id, time_entry_id, scheduled_time, administered_time, status, dosage_given, notes)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
+      RETURNING *
+    `, [clientId, medicationId, caregiverId, timeEntryId, scheduledTime, administeredTime || new Date(), status, dosageGiven, notes]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get medication logs for a client
+router.get('/logs/client/:clientId', auth, async (req, res) => {
+  const { startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT ml.*, 
+        cm.medication_name, cm.dosage, cm.frequency,
+        cp.first_name as caregiver_first, cp.last_name as caregiver_last
+      FROM medication_logs ml
+      JOIN client_medications cm ON ml.medication_id = cm.id
+      LEFT JOIN caregiver_profiles cp ON ml.caregiver_id = cp.id
+      WHERE ml.client_id = $1
+    `;
+    const params = [req.params.clientId];
+
+    if (startDate) {
+      params.push(startDate);
+      query += ` AND ml.administered_time >= $${params.length}`;
+    }
+    if (endDate) {
+      params.push(endDate);
+      query += ` AND ml.administered_time <= $${params.length}`;
+    }
+
+    query += ` ORDER BY ml.administered_time DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get medication logs for a time entry (visit)
+router.get('/logs/time-entry/:timeEntryId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ml.*, cm.medication_name, cm.dosage
+      FROM medication_logs ml
+      JOIN client_medications cm ON ml.medication_id = cm.id
+      WHERE ml.time_entry_id = $1
+      ORDER BY ml.administered_time
+    `, [req.params.timeEntryId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get medications due for a visit
+router.get('/due/:clientId', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT * FROM client_medications
+      WHERE client_id = $1 AND is_active = true
+      ORDER BY medication_name
+    `, [req.params.clientId]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Medication adherence report
+router.get('/reports/adherence/:clientId', auth, async (req, res) => {
+  const { startDate, endDate } = req.query;
+  try {
+    const result = await db.query(`
+      SELECT 
+        cm.medication_name,
+        COUNT(*) FILTER (WHERE ml.status = 'administered') as administered_count,
+        COUNT(*) FILTER (WHERE ml.status = 'refused') as refused_count,
+        COUNT(*) FILTER (WHERE ml.status = 'missed') as missed_count,
+        COUNT(*) as total_entries
+      FROM client_medications cm
+      LEFT JOIN medication_logs ml ON ml.medication_id = cm.id
+        AND ml.administered_time >= $2 AND ml.administered_time <= $3
+      WHERE cm.client_id = $1 AND cm.is_active = true
+      GROUP BY cm.id, cm.medication_name
+      ORDER BY cm.medication_name
+    `, [req.params.clientId, startDate || '1970-01-01', endDate || '2099-12-31']);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/messageRoutes.js b/templates/crm-homecare/backend/src/routes/messageRoutes.js
new file mode 100644
index 0000000..078896a
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/messageRoutes.js
@@ -0,0 +1,307 @@
+// routes/messageRoutes.js - Company Message Board
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── GET INBOX ────────────────────────────────────────────────────────────────
+// Returns all threads the current user participates in, with unread counts
+router.get('/inbox', auth, async (req, res) => {
+  try {
+    const userId = req.user.id;
+    const result = await db.query(`
+      SELECT 
+        mt.*,
+        mtp.last_read_at,
+        u.first_name as sender_first, u.last_name as sender_last,
+        u.role as sender_role,
+        (
+          SELECT body FROM messages m
+          WHERE m.thread_id = mt.id AND m.is_deleted = false
+          ORDER BY m.created_at DESC LIMIT 1
+        ) as last_message,
+        (
+          SELECT created_at FROM messages m
+          WHERE m.thread_id = mt.id AND m.is_deleted = false
+          ORDER BY m.created_at DESC LIMIT 1
+        ) as last_message_at,
+        (
+          SELECT COUNT(*) FROM messages m
+          WHERE m.thread_id = mt.id 
+            AND m.is_deleted = false
+            AND m.created_at > COALESCE(mtp.last_read_at, '1970-01-01')
+            AND m.sender_id != $1
+        ) as unread_count,
+        (
+          SELECT json_agg(json_build_object(
+            'id', p.user_id,
+            'first_name', pu.first_name,
+            'last_name', pu.last_name,
+            'role', pu.role
+          ))
+          FROM message_thread_participants p
+          JOIN users pu ON p.user_id = pu.id
+          WHERE p.thread_id = mt.id AND p.user_id != $1
+        ) as other_participants
+      FROM message_threads mt
+      JOIN message_thread_participants mtp ON mt.id = mtp.thread_id AND mtp.user_id = $1
+      JOIN users u ON mt.created_by = u.id
+      ORDER BY COALESCE(
+        (SELECT created_at FROM messages WHERE thread_id = mt.id ORDER BY created_at DESC LIMIT 1),
+        mt.created_at
+      ) DESC
+    `, [userId]);
+
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET UNREAD COUNT ─────────────────────────────────────────────────────────
+router.get('/unread-count', auth, async (req, res) => {
+  try {
+    const userId = req.user.id;
+    const result = await db.query(`
+      SELECT COUNT(*) as count
+      FROM messages m
+      JOIN message_thread_participants mtp ON m.thread_id = mtp.thread_id AND mtp.user_id = $1
+      WHERE m.is_deleted = false
+        AND m.sender_id != $1
+        AND m.created_at > COALESCE(mtp.last_read_at, '1970-01-01')
+    `, [userId]);
+
+    res.json({ count: parseInt(result.rows[0].count) });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET THREAD MESSAGES ──────────────────────────────────────────────────────
+router.get('/thread/:threadId', auth, async (req, res) => {
+  try {
+    const { threadId } = req.params;
+    const userId = req.user.id;
+
+    // Verify user is a participant
+    const participant = await db.query(
+      'SELECT * FROM message_thread_participants WHERE thread_id = $1 AND user_id = $2',
+      [threadId, userId]
+    );
+    if (!participant.rows.length && req.user.role !== 'admin') {
+      return res.status(403).json({ error: 'Not a participant in this thread' });
+    }
+
+    // Get thread info
+    const thread = await db.query(`
+      SELECT mt.*, 
+        json_agg(json_build_object(
+          'id', p.user_id,
+          'first_name', pu.first_name,
+          'last_name', pu.last_name,
+          'role', pu.role
+        )) as participants
+      FROM message_threads mt
+      JOIN message_thread_participants p ON mt.id = p.thread_id
+      JOIN users pu ON p.user_id = pu.id
+      WHERE mt.id = $1
+      GROUP BY mt.id
+    `, [threadId]);
+
+    // Get messages
+    const messages = await db.query(`
+      SELECT m.*, u.first_name, u.last_name, u.role
+      FROM messages m
+      JOIN users u ON m.sender_id = u.id
+      WHERE m.thread_id = $1 AND m.is_deleted = false
+      ORDER BY m.created_at ASC
+    `, [threadId]);
+
+    // Mark thread as read
+    await db.query(
+      `UPDATE message_thread_participants SET last_read_at = NOW() WHERE thread_id = $1 AND user_id = $2`,
+      [threadId, userId]
+    );
+
+    res.json({ thread: thread.rows[0], messages: messages.rows });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── CREATE THREAD & SEND FIRST MESSAGE ───────────────────────────────────────
+// recipientIds: array of user IDs, or 'all' for broadcast
+router.post('/send', auth, async (req, res) => {
+  try {
+    const { subject, body, recipientIds } = req.body;
+    const senderId = req.user.id;
+
+    if (!body?.trim()) return res.status(400).json({ error: 'Message body is required' });
+
+    const isBroadcast = recipientIds === 'all';
+    const threadType = isBroadcast ? 'broadcast' : (Array.isArray(recipientIds) && recipientIds.length > 1 ? 'group' : 'direct');
+
+    // Create thread
+    const thread = await db.query(`
+      INSERT INTO message_threads (subject, created_by, thread_type, is_broadcast)
+      VALUES ($1, $2, $3, $4)
+      RETURNING *
+    `, [subject || 'New Message', senderId, threadType, isBroadcast]);
+
+    const threadId = thread.rows[0].id;
+
+    // Determine recipients
+    let allRecipientIds = [];
+    if (isBroadcast) {
+      const allUsers = await db.query(`SELECT id FROM users WHERE is_active = true AND id != $1`, [senderId]);
+      allRecipientIds = allUsers.rows.map(r => r.id);
+    } else {
+      allRecipientIds = Array.isArray(recipientIds) ? recipientIds.filter(id => id !== senderId) : [recipientIds];
+    }
+
+    // Add sender as participant
+    await db.query(
+      `INSERT INTO message_thread_participants (thread_id, user_id, last_read_at) VALUES ($1, $2, NOW()) ON CONFLICT DO NOTHING`,
+      [threadId, senderId]
+    );
+
+    // Add all recipients as participants
+    for (const recipientId of allRecipientIds) {
+      await db.query(
+        `INSERT INTO message_thread_participants (thread_id, user_id) VALUES ($1, $2) ON CONFLICT DO NOTHING`,
+        [threadId, recipientId]
+      );
+    }
+
+    // Create the message
+    const message = await db.query(`
+      INSERT INTO messages (thread_id, sender_id, body)
+      VALUES ($1, $2, $3)
+      RETURNING *
+    `, [threadId, senderId, body.trim()]);
+
+    // Send push notifications to recipients
+    try {
+      const senderName = req.user.first_name + ' ' + req.user.last_name;
+      const notifTitle = isBroadcast ? `📢 ${senderName}` : `💬 ${senderName}`;
+      const notifBody = body.length > 80 ? body.slice(0, 77) + '...' : body;
+
+      const subscriptions = await db.query(`
+        SELECT ps.subscription FROM push_subscriptions ps
+        WHERE ps.user_id = ANY($1) AND ps.is_active = true
+      `, [allRecipientIds]);
+
+      let webpush;
+      try { webpush = require('web-push'); } catch (e) { webpush = null; }
+
+      if (webpush && process.env.VAPID_PUBLIC_KEY && process.env.VAPID_PUBLIC_KEY !== 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') {
+        webpush.setVapidDetails('mailto:admin@chippewahomecare.com', process.env.VAPID_PUBLIC_KEY, process.env.VAPID_PRIVATE_KEY);
+        for (const row of subscriptions.rows) {
+          try {
+            await webpush.sendNotification(row.subscription, JSON.stringify({ title: notifTitle, body: notifBody, data: { type: 'message', threadId } }));
+          } catch (e) { /* ignore individual failures */ }
+        }
+      }
+    } catch (e) { /* push failure doesn't break send */ }
+
+    res.json({ thread: thread.rows[0], message: message.rows[0], recipientCount: allRecipientIds.length });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── REPLY TO THREAD ──────────────────────────────────────────────────────────
+router.post('/thread/:threadId/reply', auth, async (req, res) => {
+  try {
+    const { threadId } = req.params;
+    const { body } = req.body;
+    const senderId = req.user.id;
+
+    if (!body?.trim()) return res.status(400).json({ error: 'Message body is required' });
+
+    // Ensure user is a participant (admins can always reply)
+    await db.query(
+      `INSERT INTO message_thread_participants (thread_id, user_id, last_read_at) VALUES ($1, $2, NOW()) ON CONFLICT (thread_id, user_id) DO UPDATE SET last_read_at = NOW()`,
+      [threadId, senderId]
+    );
+
+    const message = await db.query(`
+      INSERT INTO messages (thread_id, sender_id, body)
+      VALUES ($1, $2, $3)
+      RETURNING *
+    `, [threadId, senderId, body.trim()]);
+
+    // Update thread updated_at
+    await db.query(`UPDATE message_threads SET updated_at = NOW() WHERE id = $1`, [threadId]);
+
+    // Get sender info
+    const sender = await db.query(`SELECT first_name, last_name, role FROM users WHERE id = $1`, [senderId]);
+
+    // Notify other participants
+    try {
+      const participants = await db.query(`
+        SELECT ps.subscription FROM message_thread_participants mtp
+        JOIN push_subscriptions ps ON mtp.user_id = ps.user_id
+        WHERE mtp.thread_id = $1 AND mtp.user_id != $2 AND ps.is_active = true
+      `, [threadId, senderId]);
+
+      let webpush;
+      try { webpush = require('web-push'); } catch (e) { webpush = null; }
+
+      if (webpush && process.env.VAPID_PUBLIC_KEY && process.env.VAPID_PUBLIC_KEY !== 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') {
+        webpush.setVapidDetails('mailto:admin@chippewahomecare.com', process.env.VAPID_PUBLIC_KEY, process.env.VAPID_PRIVATE_KEY);
+        const senderName = `${sender.rows[0].first_name} ${sender.rows[0].last_name}`;
+        for (const row of participants.rows) {
+          try {
+            await webpush.sendNotification(row.subscription, JSON.stringify({
+              title: `💬 ${senderName}`,
+              body: body.length > 80 ? body.slice(0, 77) + '...' : body,
+              data: { type: 'message', threadId }
+            }));
+          } catch (e) { /* ignore */ }
+        }
+      }
+    } catch (e) { /* push failure doesn't break reply */ }
+
+    res.json({ ...message.rows[0], first_name: sender.rows[0].first_name, last_name: sender.rows[0].last_name, role: sender.rows[0].role });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET ALL USERS (for recipient picker) ────────────────────────────────────
+router.get('/users', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT id, first_name, last_name, role, phone, email
+      FROM users
+      WHERE is_active = true AND id != $1
+      ORDER BY role DESC, first_name ASC
+    `, [req.user.id]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── DELETE MESSAGE (admin or sender) ────────────────────────────────────────
+router.delete('/message/:messageId', auth, async (req, res) => {
+  try {
+    const { messageId } = req.params;
+    const msg = await db.query('SELECT * FROM messages WHERE id = $1', [messageId]);
+    if (!msg.rows.length) return res.status(404).json({ error: 'Message not found' });
+
+    if (msg.rows[0].sender_id !== req.user.id && req.user.role !== 'admin') {
+      return res.status(403).json({ error: 'Cannot delete this message' });
+    }
+
+    await db.query('UPDATE messages SET is_deleted = true WHERE id = $1', [messageId]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/miscRoutes.js b/templates/crm-homecare/backend/src/routes/miscRoutes.js
new file mode 100644
index 0000000..ac8393c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/miscRoutes.js
@@ -0,0 +1,984 @@
+// routes/miscRoutes.js
+// Catch-all for smaller inline route groups that don't warrant their own file:
+//   referral sources, notifications, prospects, service pricing, care types,
+//   caregiver care type rates, compliance summary, caregiver profiles,
+//   user admin endpoints, payroll inline, blackout dates, training/compliance docs
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// ─── REFERRAL SOURCES ───────────────────────────────────────────────────────
+
+router.get('/referral-sources', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT rs.*, COUNT(c.id) as referral_count FROM referral_sources rs
+       LEFT JOIN clients c ON rs.id = c.referred_by AND c.is_active = true
+       WHERE rs.is_active = true GROUP BY rs.id ORDER BY referral_count DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/referral-sources', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, type, contactName, email, phone, address, city, state, zip } = req.body;
+    if (!name || !type) return res.status(400).json({ error: 'Name and type are required' });
+    const sourceId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO referral_sources (id, name, type, contact_name, email, phone, address, city, state, zip, created_by)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11) RETURNING *`,
+      [sourceId, name, type, contactName||null, email||null, phone||null, address||null, city||null, state||process.env.AGENCY_STATE||null, zip||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'referral_sources', sourceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/referral-sources/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, type, contactName, email, phone, address, city, state, zip } = req.body;
+    const result = await db.query(
+      `UPDATE referral_sources SET name=COALESCE($1,name), type=COALESCE($2,type), contact_name=COALESCE($3,contact_name),
+        email=COALESCE($4,email), phone=COALESCE($5,phone), address=COALESCE($6,address),
+        city=COALESCE($7,city), state=COALESCE($8,state), zip=COALESCE($9,zip), updated_at=NOW()
+       WHERE id=$10 RETURNING *`,
+      [name, type, contactName, email, phone, address, city, state, zip, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Referral source not found' });
+    await auditLog(req.user.id, 'UPDATE', 'referral_sources', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/referral-sources/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM referral_sources WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Referral source not found' });
+    await auditLog(req.user.id, 'DELETE', 'referral_sources', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Referral source deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/referral-sources/stats', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [totalResult, byTypeResult, topSources] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total FROM referral_sources`),
+      db.query(`SELECT type, COUNT(*) as count FROM referral_sources GROUP BY type ORDER BY count DESC`),
+      db.query(`SELECT rs.id, rs.name, COUNT(c.id) as client_count FROM referral_sources rs LEFT JOIN clients c ON rs.id = c.referral_source_id WHERE c.id IS NOT NULL GROUP BY rs.id, rs.name ORDER BY client_count DESC`),
+    ]);
+    res.json({ total: totalResult.rows[0].total, byType: byTypeResult.rows, topSources: topSources.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── NOTIFICATIONS ───────────────────────────────────────────────────────────
+
+router.get('/notifications', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT * FROM notifications WHERE recipient_id=$1 OR (recipient_type='admin' AND $2='admin') ORDER BY created_at DESC LIMIT 50`,
+      [req.user.id, req.user.role]
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/notification-settings', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM notification_settings WHERE user_id=$1`, [req.user.id]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO notification_settings (user_id, email_enabled, schedule_alerts, payroll_alerts, absence_alerts, payment_alerts) VALUES ($1,true,true,true,true,true)`, [req.user.id]);
+      result = await db.query(`SELECT * FROM notification_settings WHERE user_id=$1`, [req.user.id]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/notification-settings', verifyToken, async (req, res) => {
+  try {
+    const { emailEnabled, scheduleAlerts, payrollAlerts, absenceAlerts, paymentAlerts } = req.body;
+    const result = await db.query(
+      `UPDATE notification_settings SET email_enabled=COALESCE($1,email_enabled), schedule_alerts=COALESCE($2,schedule_alerts),
+        payroll_alerts=COALESCE($3,payroll_alerts), absence_alerts=COALESCE($4,absence_alerts),
+        payment_alerts=COALESCE($5,payment_alerts), updated_at=NOW() WHERE user_id=$6 RETURNING *`,
+      [emailEnabled, scheduleAlerts, payrollAlerts, absenceAlerts, paymentAlerts, req.user.id]
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/send', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { recipientType, recipientId, notificationType, subject, message } = req.body;
+    if (!recipientId || !subject || !message) return res.status(400).json({ error: 'recipientId, subject, and message are required' });
+    const notificationId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO notifications (id, recipient_type, recipient_id, notification_type, subject, message, status, sent_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8) RETURNING *`,
+      [notificationId, recipientType, recipientId, notificationType||'general', subject, message, 'sent', req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'notifications', notificationId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/send-bulk', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { recipientIds, notificationType, subject, message } = req.body;
+    if (!recipientIds?.length || !subject || !message) return res.status(400).json({ error: 'recipientIds, subject, and message are required' });
+    const sent = [];
+    for (const recipientId of recipientIds) {
+      const notificationId = uuidv4();
+      const result = await db.query(
+        `INSERT INTO notifications (id, recipient_type, recipient_id, notification_type, subject, message, status, sent_by) VALUES ($1,'caregiver',$2,$3,$4,$5,'sent',$6) RETURNING *`,
+        [notificationId, recipientId, notificationType||'general', subject, message, req.user.id]
+      );
+      sent.push(result.rows[0]);
+    }
+    await auditLog(req.user.id, 'CREATE', 'notifications', 'bulk', null, { count: sent.length });
+    res.status(201).json({ sent: sent.length, notifications: sent });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/notifications/:id/read', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE notifications SET is_read=true, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Notification not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/notifications/:id', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM notifications WHERE id=$1 AND recipient_id=$2 RETURNING *`, [req.params.id, req.user.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Notification not found' });
+    res.json({ message: 'Notification deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/notifications/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT COUNT(*) as total_notifications, COUNT(CASE WHEN is_read=false THEN 1 END) as unread_count,
+        COUNT(CASE WHEN status='sent' THEN 1 END) as sent_count, COUNT(CASE WHEN status='pending' THEN 1 END) as pending_count,
+        COUNT(CASE WHEN status='failed' THEN 1 END) as failed_count, COUNT(DISTINCT recipient_id) as unique_recipients FROM notifications`
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/subscribe', verifyToken, async (req, res) => {
+  res.json({ success: true });
+});
+
+router.put('/notifications/preferences', verifyToken, async (req, res) => {
+  try {
+    const { emailEnabled, pushEnabled, scheduleAlerts, absenceAlerts, billingAlerts } = req.body;
+    const result = await db.query(
+      `INSERT INTO notification_preferences (user_id, email_enabled, push_enabled, schedule_alerts, absence_alerts, billing_alerts)
+       VALUES ($1,$2,$3,$4,$5,$6) ON CONFLICT (user_id) DO UPDATE SET email_enabled=$2, push_enabled=$3, schedule_alerts=$4, absence_alerts=$5, billing_alerts=$6 RETURNING *`,
+      [req.user.id, emailEnabled, pushEnabled, scheduleAlerts, absenceAlerts, billingAlerts]
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── PROSPECTS ───────────────────────────────────────────────────────────────
+
+router.get('/prospects', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM prospects WHERE status != 'inactive' ORDER BY created_at DESC`);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospects', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, phone, email, address, city, state, notes, source } = req.body;
+    if (!firstName || !lastName) return res.status(400).json({ error: 'First and last name required' });
+    const result = await db.query(
+      `INSERT INTO prospects (first_name, last_name, phone, email, address, city, state, notes, source) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [firstName, lastName, phone||null, email||null, address||null, city||null, state||process.env.AGENCY_STATE||null, notes||null, source||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/prospects/:id', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, phone, email, address, city, state, notes, source, status } = req.body;
+    const result = await db.query(
+      `UPDATE prospects SET first_name=COALESCE($1,first_name), last_name=COALESCE($2,last_name),
+        phone=$3, email=$4, address=$5, city=$6, state=COALESCE($7,state), notes=$8, source=$9,
+        status=COALESCE($10,status), updated_at=NOW() WHERE id=$11 RETURNING *`,
+      [firstName, lastName, phone, email, address, city, state, notes, source, status, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Prospect not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/prospects/:id', verifyToken, async (req, res) => {
+  try {
+    await db.query(`UPDATE prospects SET status='inactive' WHERE id=$1`, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospects/:id/convert', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const prospect = await db.query(`SELECT * FROM prospects WHERE id=$1`, [req.params.id]);
+    if (prospect.rows.length === 0) return res.status(404).json({ error: 'Prospect not found' });
+    const p = prospect.rows[0];
+    const clientResult = await db.query(
+      `INSERT INTO clients (first_name, last_name, phone, email, address, city, state, status) VALUES ($1,$2,$3,$4,$5,$6,$7,'active') RETURNING *`,
+      [p.first_name, p.last_name, p.phone, p.email, p.address, p.city, p.state]
+    );
+    await db.query(`UPDATE prospects SET status='converted', converted_client_id=$1, updated_at=NOW() WHERE id=$2`, [clientResult.rows[0].id, req.params.id]);
+    res.json({ client: clientResult.rows[0], message: 'Prospect converted to client' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/prospect-appointments', verifyToken, async (req, res) => {
+  try {
+    const { month, year } = req.query;
+    let query = `SELECT pa.*, p.first_name as prospect_first_name, p.last_name as prospect_last_name,
+      u.first_name as caregiver_first_name, u.last_name as caregiver_last_name
+      FROM prospect_appointments pa JOIN prospects p ON pa.prospect_id=p.id LEFT JOIN users u ON pa.caregiver_id=u.id
+      WHERE pa.status != 'cancelled'`;
+    const params = [];
+    if (month && year) { query += ` AND EXTRACT(MONTH FROM pa.appointment_date)=$1 AND EXTRACT(YEAR FROM pa.appointment_date)=$2`; params.push(month, year); }
+    query += ` ORDER BY pa.appointment_date, pa.start_time`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospect-appointments', verifyToken, async (req, res) => {
+  try {
+    const { prospectId, caregiverId, appointmentDate, startTime, endTime, appointmentType, location, notes } = req.body;
+    if (!prospectId || !appointmentDate || !startTime || !endTime) return res.status(400).json({ error: 'Prospect, date, and times required' });
+    const result = await db.query(
+      `INSERT INTO prospect_appointments (prospect_id, caregiver_id, appointment_date, start_time, end_time, appointment_type, location, notes) VALUES ($1,$2,$3,$4,$5,$6,$7,$8) RETURNING *`,
+      [prospectId, caregiverId||null, appointmentDate, startTime, endTime, appointmentType||'assessment', location||null, notes||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/prospect-appointments/:id', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, appointmentDate, startTime, endTime, appointmentType, location, notes, status } = req.body;
+    const result = await db.query(
+      `UPDATE prospect_appointments SET caregiver_id=$1, appointment_date=COALESCE($2,appointment_date),
+        start_time=COALESCE($3,start_time), end_time=COALESCE($4,end_time),
+        appointment_type=COALESCE($5,appointment_type), location=$6, notes=$7, status=COALESCE($8,status)
+       WHERE id=$9 RETURNING *`,
+      [caregiverId||null, appointmentDate, startTime, endTime, appointmentType, location||null, notes||null, status, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Appointment not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/prospect-appointments/:id', verifyToken, async (req, res) => {
+  try {
+    await db.query(`UPDATE prospect_appointments SET status='cancelled' WHERE id=$1`, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── SERVICE PRICING ─────────────────────────────────────────────────────────
+
+router.get('/service-pricing/margins', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT id, service_name, client_hourly_rate, caregiver_hourly_rate,
+        (client_hourly_rate-caregiver_hourly_rate) as margin_per_hour,
+        ROUND((((client_hourly_rate-caregiver_hourly_rate)/client_hourly_rate)*100)::numeric,1) as margin_percentage
+       FROM service_pricing WHERE is_active=true ORDER BY margin_per_hour DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/service-pricing', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM service_pricing WHERE is_active=true ORDER BY service_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/service-pricing', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceName, description, clientHourlyRate, caregiverHourlyRate } = req.body;
+    if (!serviceName || !clientHourlyRate || !caregiverHourlyRate) return res.status(400).json({ error: 'serviceName, clientHourlyRate, and caregiverHourlyRate are required' });
+    const serviceId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO service_pricing (id, service_name, description, client_hourly_rate, caregiver_hourly_rate) VALUES ($1,$2,$3,$4,$5) RETURNING *`,
+      [serviceId, serviceName, description||null, clientHourlyRate, caregiverHourlyRate]
+    );
+    await auditLog(req.user.id, 'CREATE', 'service_pricing', serviceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/service-pricing/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceName, description, clientHourlyRate, caregiverHourlyRate } = req.body;
+    const result = await db.query(
+      `UPDATE service_pricing SET service_name=COALESCE($1,service_name), description=COALESCE($2,description),
+        client_hourly_rate=COALESCE($3,client_hourly_rate), caregiver_hourly_rate=COALESCE($4,caregiver_hourly_rate), updated_at=NOW()
+       WHERE id=$5 RETURNING *`,
+      [serviceName, description, clientHourlyRate, caregiverHourlyRate, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Service not found' });
+    await auditLog(req.user.id, 'UPDATE', 'service_pricing', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/service-pricing/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE service_pricing SET is_active=false, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Service not found' });
+    await auditLog(req.user.id, 'DELETE', 'service_pricing', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Service deactivated' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CARE TYPES ──────────────────────────────────────────────────────────────
+
+router.get('/care-types', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM care_types WHERE is_active=true ORDER BY name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/care-types', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, description } = req.body;
+    const id = uuidv4();
+    const result = await db.query(`INSERT INTO care_types (id, name, description) VALUES ($1,$2,$3) RETURNING *`, [id, name, description]);
+    await auditLog(req.user.id, 'CREATE', 'care_types', id, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/care-types/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, description } = req.body;
+    const result = await db.query(`UPDATE care_types SET name=$1, description=$2, updated_at=NOW() WHERE id=$3 RETURNING *`, [name, description, req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care type not found' });
+    await auditLog(req.user.id, 'UPDATE', 'care_types', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER CARE TYPE RATES ────────────────────────────────────────────────
+
+router.get('/caregiver-care-type-rates', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId } = req.query;
+    let query = `SELECT cctr.*, u.first_name as caregiver_first_name, u.last_name as caregiver_last_name, ct.name as care_type_name
+      FROM caregiver_care_type_rates cctr JOIN users u ON cctr.caregiver_id=u.id JOIN care_types ct ON cctr.care_type_id=ct.id
+      WHERE cctr.is_active=true AND (cctr.end_date IS NULL OR cctr.end_date>=CURRENT_DATE)`;
+    const params = [];
+    if (caregiverId) { params.push(caregiverId); query += ` AND cctr.caregiver_id=$${params.length}`; }
+    query += ` ORDER BY u.last_name, ct.name`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/caregiver-care-type-rates', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, careTypeId, hourlyRate } = req.body;
+    const id = uuidv4();
+    await db.query(`UPDATE caregiver_care_type_rates SET is_active=false, end_date=CURRENT_DATE, updated_at=NOW() WHERE caregiver_id=$1 AND care_type_id=$2 AND is_active=true`, [caregiverId, careTypeId]);
+    const result = await db.query(`INSERT INTO caregiver_care_type_rates (id, caregiver_id, care_type_id, hourly_rate) VALUES ($1,$2,$3,$4) RETURNING *`, [id, caregiverId, careTypeId, hourlyRate]);
+    await auditLog(req.user.id, 'CREATE', 'caregiver_care_type_rates', id, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-care-type-rates/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE caregiver_care_type_rates SET hourly_rate=$1, updated_at=NOW() WHERE id=$2 RETURNING *`, [req.body.hourlyRate, req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Rate not found' });
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_care_type_rates', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/caregiver-care-type-rates/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE caregiver_care_type_rates SET is_active=false, end_date=CURRENT_DATE, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Rate not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_care_type_rates', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Rate ended' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER RATES ─────────────────────────────────────────────────────────
+
+router.get('/caregiver-rates/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM caregiver_rates WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO caregiver_rates (caregiver_id, base_hourly_rate) VALUES ($1, $2)`, [req.params.caregiverId, 18.50]);
+      result = await db.query(`SELECT * FROM caregiver_rates WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-rates/:caregiverId', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { baseHourlyRate, overtimeRate, premiumRate } = req.body;
+    const result = await db.query(
+      `UPDATE caregiver_rates SET base_hourly_rate=COALESCE($1,base_hourly_rate), overtime_rate=COALESCE($2,overtime_rate), premium_rate=COALESCE($3,premium_rate), updated_at=NOW() WHERE caregiver_id=$4 RETURNING *`,
+      [baseHourlyRate, overtimeRate, premiumRate, req.params.caregiverId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver rate not found' });
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_rates', req.params.caregiverId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER PROFILES ───────────────────────────────────────────────────────
+
+router.get('/caregiver-profile/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM caregiver_profiles WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO caregiver_profiles (caregiver_id) VALUES ($1)`, [req.params.caregiverId]);
+      result = await db.query(`SELECT * FROM caregiver_profiles WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-profile/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const { notes, capabilities, limitations, preferredHours, availableMon, availableTue, availableWed, availableThu, availableFri, availableSat, availableSun } = req.body;
+    const result = await db.query(
+      `UPDATE caregiver_profiles SET notes=COALESCE($1,notes), capabilities=COALESCE($2,capabilities), limitations=COALESCE($3,limitations),
+        preferred_hours=COALESCE($4,preferred_hours), available_mon=COALESCE($5,available_mon), available_tue=COALESCE($6,available_tue),
+        available_wed=COALESCE($7,available_wed), available_thu=COALESCE($8,available_thu), available_fri=COALESCE($9,available_fri),
+        available_sat=COALESCE($10,available_sat), available_sun=COALESCE($11,available_sun), updated_at=NOW()
+       WHERE caregiver_id=$12 RETURNING *`,
+      [notes, capabilities, limitations, preferredHours, availableMon, availableTue, availableWed, availableThu, availableFri, availableSat, availableSun, req.params.caregiverId]
+    );
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_profiles', req.params.caregiverId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── USER ADMIN ───────────────────────────────────────────────────────────────
+
+router.get('/users', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { role } = req.query;
+    let query = `SELECT id, email, first_name, last_name, phone, role, is_active, hire_date, default_pay_rate FROM users WHERE 1=1`;
+    const params = [];
+    if (role) { params.push(role); query += ` AND role=$${params.length}`; }
+    query += ` ORDER BY first_name, last_name`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/caregivers', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT id, email, first_name, last_name, phone, hire_date, is_active, certifications, role, default_pay_rate FROM users WHERE role='caregiver' ORDER BY first_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/caregivers/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM users WHERE id=$1 AND role='caregiver'`, [req.params.caregiverId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/admins', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT id, email, first_name, last_name, phone, hire_date, is_active, role FROM users WHERE role='admin' ORDER BY first_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/users/convert-to-admin', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { userId } = req.body;
+    const result = await db.query(`UPDATE users SET role='admin', updated_at=NOW() WHERE id=$1 RETURNING *`, [userId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'User not found' });
+    await auditLog(req.user.id, 'UPDATE', 'users', userId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── PAYROLL INLINE ───────────────────────────────────────────────────────────
+
+router.post('/payroll/run', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { payPeriodStart, payPeriodEnd } = req.body;
+    if (!payPeriodStart || !payPeriodEnd) return res.status(400).json({ error: 'payPeriodStart and payPeriodEnd are required' });
+    const payrollId = uuidv4();
+    const payrollNumber = `PR-${Date.now()}`;
+    const timeEntriesResult = await db.query(
+      `SELECT te.*, u.first_name, u.last_name, cr.base_hourly_rate FROM time_entries te
+       JOIN users u ON te.caregiver_id=u.id LEFT JOIN caregiver_rates cr ON te.caregiver_id=cr.caregiver_id
+       WHERE te.start_time>=$1 AND te.start_time<=$2 AND te.duration_minutes>0 ORDER BY te.caregiver_id`,
+      [payPeriodStart, payPeriodEnd]
+    );
+    const caregiverPayroll = {};
+    let totalGrossPay = 0;
+    for (const entry of timeEntriesResult.rows) {
+      if (!caregiverPayroll[entry.caregiver_id]) {
+        caregiverPayroll[entry.caregiver_id] = { caregiverId: entry.caregiver_id, caregiverName: `${entry.first_name} ${entry.last_name}`, totalHours: 0, hourlyRate: entry.base_hourly_rate||18.50, grossPay: 0, lineItems: [] };
+      }
+      caregiverPayroll[entry.caregiver_id].totalHours += parseFloat(entry.billable_minutes||entry.duration_minutes||0)/60;
+      caregiverPayroll[entry.caregiver_id].lineItems.push({ timeEntryId: entry.id, date: entry.start_time, hours: ((entry.billable_minutes||entry.duration_minutes||0)/60).toFixed(2), rate: entry.base_hourly_rate||18.50 });
+    }
+    const lineItems = [];
+    for (const caregiverId in caregiverPayroll) {
+      const payData = caregiverPayroll[caregiverId];
+      payData.grossPay = (payData.totalHours * payData.hourlyRate).toFixed(2);
+      totalGrossPay += parseFloat(payData.grossPay);
+      lineItems.push({ caregiverId, description: `Hours: ${payData.totalHours.toFixed(2)} × $${payData.hourlyRate.toFixed(2)}/hr`, totalHours: payData.totalHours.toFixed(2), hourlyRate: payData.hourlyRate, grossAmount: payData.grossPay });
+    }
+    const totalTaxes = (totalGrossPay * 0.0765).toFixed(2);
+    const totalNetPay = (totalGrossPay - parseFloat(totalTaxes)).toFixed(2);
+    const payrollResult = await db.query(
+      `INSERT INTO payroll (id, payroll_number, pay_period_start, pay_period_end, total_hours, gross_pay, taxes, net_pay, status) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [payrollId, payrollNumber, payPeriodStart, payPeriodEnd, Object.values(caregiverPayroll).reduce((s,p)=>s+p.totalHours,0).toFixed(2), totalGrossPay, totalTaxes, totalNetPay, 'pending']
+    );
+    for (const item of lineItems) {
+      await db.query(`INSERT INTO payroll_line_items (payroll_id, caregiver_id, description, total_hours, hourly_rate, gross_amount) VALUES ($1,$2,$3,$4,$5,$6)`, [payrollId, item.caregiverId, item.description, item.totalHours, item.hourlyRate, item.grossAmount]);
+    }
+    await auditLog(req.user.id, 'CREATE', 'payroll', payrollId, null, payrollResult.rows[0]);
+    res.status(201).json({ ...payrollResult.rows[0], lineItems, caregiverCount: lineItems.length });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payroll/caregiver/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT pli.*, p.payroll_number, p.pay_period_start, p.pay_period_end, p.status FROM payroll_line_items pli JOIN payroll p ON pli.payroll_id=p.id WHERE pli.caregiver_id=$1 ORDER BY p.pay_period_end DESC`, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payroll/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [summary, caregiverStats] = await Promise.all([
+      db.query(`SELECT COUNT(DISTINCT id) as total_payrolls, COUNT(DISTINCT CASE WHEN status='pending' THEN id END) as pending_payrolls, COUNT(DISTINCT CASE WHEN status='processed' THEN id END) as processed_payrolls, COUNT(DISTINCT CASE WHEN status='paid' THEN id END) as paid_payrolls, SUM(gross_pay) as total_gross_pay, SUM(taxes) as total_taxes, SUM(net_pay) as total_net_pay, AVG(total_hours) as average_hours_per_payroll, MAX(pay_period_end) as latest_payroll_date FROM payroll`),
+      db.query(`SELECT u.id, u.first_name, u.last_name, COUNT(pli.id) as payroll_count, SUM(pli.total_hours) as total_hours_paid, SUM(pli.gross_amount) as total_earned FROM users u LEFT JOIN payroll_line_items pli ON u.id=pli.caregiver_id WHERE u.role='caregiver' GROUP BY u.id, u.first_name, u.last_name ORDER BY total_earned DESC NULLS LAST`),
+    ]);
+    res.json({ summary: summary.rows[0], caregiverStats: caregiverStats.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payroll', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payroll/:payrollId', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const payrollResult = await db.query(`SELECT * FROM payroll WHERE id=$1`, [req.params.payrollId]);
+    if (payrollResult.rows.length === 0) return res.status(404).json({ error: 'Payroll not found' });
+    const lineItemsResult = await db.query(`SELECT pli.*, u.first_name, u.last_name FROM payroll_line_items pli JOIN users u ON pli.caregiver_id=u.id WHERE pli.payroll_id=$1 ORDER BY u.first_name, u.last_name`, [req.params.payrollId]);
+    res.json({ ...payrollResult.rows[0], lineItems: lineItemsResult.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/payroll/:payrollId/status', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { status, processedDate, paymentMethod } = req.body;
+    if (!status) return res.status(400).json({ error: 'status is required' });
+    const result = await db.query(
+      `UPDATE payroll SET status=$1, processed_date=CASE WHEN $1='processed' THEN COALESCE($2,NOW()) ELSE processed_date END, payment_method=COALESCE($3,payment_method), updated_at=NOW() WHERE id=$4 RETURNING *`,
+      [status, processedDate, paymentMethod, req.params.payrollId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Payroll not found' });
+    await auditLog(req.user.id, 'UPDATE', 'payroll', req.params.payrollId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payroll-periods', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT DISTINCT pay_period_start, pay_period_end FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── ABSENCES ─────────────────────────────────────────────────────────────────
+
+router.post('/absences', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, date, type, reason } = req.body;
+    if (!caregiverId || !date || !type) return res.status(400).json({ error: 'caregiverId, date, and type are required' });
+    const absenceId = uuidv4();
+    const result = await db.query(`INSERT INTO absences (id, caregiver_id, date, type, reason, reported_by, coverage_needed, created_at) VALUES ($1,$2,$3,$4,$5,$6,$7,NOW()) RETURNING *`, [absenceId, caregiverId, date, type, reason||null, req.user.id, true]);
+    await auditLog(req.user.id, 'CREATE', 'absences', absenceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT type, COUNT(*) as count, DATE_TRUNC('month', date)::DATE as month FROM absences GROUP BY type, DATE_TRUNC('month', date) ORDER BY month DESC, type`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences/caregiver/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM absences WHERE caregiver_id=$1 ORDER BY date DESC`, [req.params.caregiverId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/absences', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { type, startDate, endDate } = req.query;
+    let query = `SELECT a.*, u.first_name, u.last_name FROM absences a JOIN users u ON a.caregiver_id=u.id WHERE 1=1`;
+    const params = [];
+    if (type) { params.push(type); query += ` AND a.type=$${params.length}`; }
+    if (startDate) { params.push(startDate); query += ` AND a.date>=$${params.length}`; }
+    if (endDate) { params.push(endDate); query += ` AND a.date<=$${params.length}`; }
+    query += ` ORDER BY a.date DESC`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/absences/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { date, type, reason, coverageAssignedTo } = req.body;
+    const updates = [], params = [];
+    let i = 1;
+    if (date) { updates.push(`date=$${i++}`); params.push(date); }
+    if (type) { updates.push(`type=$${i++}`); params.push(type); }
+    if (reason) { updates.push(`reason=$${i++}`); params.push(reason); }
+    if (coverageAssignedTo) { updates.push(`coverage_assigned_to=$${i++}`); params.push(coverageAssignedTo); }
+    if (updates.length === 0) return res.status(400).json({ error: 'No fields to update' });
+    params.push(req.params.id);
+    const result = await db.query(`UPDATE absences SET ${updates.join(', ')} WHERE id=$${i} RETURNING *`, params);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Absence not found' });
+    await auditLog(req.user.id, 'UPDATE', 'absences', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/absences/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM absences WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Absence not found' });
+    await auditLog(req.user.id, 'DELETE', 'absences', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Absence deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── EXPENSES ─────────────────────────────────────────────────────────────────
+
+router.get('/expenses/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, byCategory, byMonth] = await Promise.all([
+      db.query(`SELECT SUM(amount) as total_expenses, COUNT(*) as expense_count, AVG(amount) as average_expense FROM expenses`),
+      db.query(`SELECT category, COUNT(*) as count, SUM(amount) as total, AVG(amount) as average FROM expenses GROUP BY category ORDER BY total DESC`),
+      db.query(`SELECT DATE_TRUNC('month', expense_date)::DATE as month, SUM(amount) as total FROM expenses GROUP BY DATE_TRUNC('month', expense_date) ORDER BY month DESC LIMIT 12`),
+    ]);
+    res.json({ total: total.rows[0], byCategory: byCategory.rows, byMonth: byMonth.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM expenses WHERE id=$1`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/expenses', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { category, startDate, endDate, paymentMethod } = req.query;
+    let query = `SELECT * FROM expenses WHERE 1=1`;
+    const params = [];
+    let i = 1;
+    if (category) { query += ` AND category=$${i++}`; params.push(category); }
+    if (startDate) { query += ` AND expense_date>=$${i++}`; params.push(startDate); }
+    if (endDate) { query += ` AND expense_date<=$${i++}`; params.push(endDate); }
+    if (paymentMethod) { query += ` AND payment_method=$${i++}`; params.push(paymentMethod); }
+    query += ` ORDER BY expense_date DESC`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/expenses', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { expenseDate, category, description, amount, paymentMethod, notes, receiptUrl } = req.body;
+    if (!expenseDate || !category || !amount) return res.status(400).json({ error: 'expenseDate, category, and amount are required' });
+    const expenseId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO expenses (id, expense_date, category, description, amount, payment_method, notes, receipt_url, submitted_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [expenseId, expenseDate, category, description||null, amount, paymentMethod||null, notes||null, receiptUrl||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'expenses', expenseId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { expenseDate, category, description, amount, paymentMethod, notes, receiptUrl } = req.body;
+    const result = await db.query(
+      `UPDATE expenses SET expense_date=COALESCE($1,expense_date), category=COALESCE($2,category), description=COALESCE($3,description),
+        amount=COALESCE($4,amount), payment_method=COALESCE($5,payment_method), notes=COALESCE($6,notes), receipt_url=COALESCE($7,receipt_url), updated_at=NOW()
+       WHERE id=$8 RETURNING *`,
+      [expenseDate, category, description, amount, paymentMethod, notes, receiptUrl, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    await auditLog(req.user.id, 'UPDATE', 'expenses', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/expenses/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM expenses WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Expense not found' });
+    await auditLog(req.user.id, 'DELETE', 'expenses', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Expense deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── COMPLIANCE ───────────────────────────────────────────────────────────────
+
+router.get('/compliance/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [expiredBg, expiredTraining, trainingByType, bgStatus] = await Promise.all([
+      db.query(`SELECT COUNT(*) as expired_bg FROM background_checks WHERE expiration_date < CURRENT_DATE`),
+      db.query(`SELECT COUNT(*) as expired_training FROM training_records WHERE expiration_date < CURRENT_DATE AND status != 'expired'`),
+      db.query(`SELECT training_type, COUNT(*) as count FROM training_records WHERE status='completed' GROUP BY training_type ORDER BY count DESC`),
+      db.query(`SELECT status, COUNT(*) as count FROM background_checks GROUP BY status`),
+    ]);
+    res.json({ expiredBackgroundChecks: expiredBg.rows[0].expired_bg, expiredTraining: expiredTraining.rows[0].expired_training, trainingByType: trainingByType.rows, backgroundCheckStatus: bgStatus.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/training-records/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM training_records WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Training record not found' });
+    await auditLog(req.user.id, 'DELETE', 'training_records', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Training record deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/compliance-documents/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM compliance_documents WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Document not found' });
+    await auditLog(req.user.id, 'DELETE', 'compliance_documents', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Document deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/blackout-dates/:dateId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM caregiver_blackout_dates WHERE id=$1 RETURNING *`, [req.params.dateId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Blackout date not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_blackout_dates', req.params.dateId, null, result.rows[0]);
+    res.json({ message: 'Blackout date deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CARE PLANS ───────────────────────────────────────────────────────────────
+
+router.get('/care-plans/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, active, byServiceType, byClient] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total_plans FROM care_plans`),
+      db.query(`SELECT COUNT(*) as active_plans FROM care_plans WHERE (start_date IS NULL OR start_date<=CURRENT_DATE) AND (end_date IS NULL OR end_date>=CURRENT_DATE)`),
+      db.query(`SELECT service_type, COUNT(*) as count FROM care_plans GROUP BY service_type ORDER BY count DESC`),
+      db.query(`SELECT c.id, c.first_name||' '||c.last_name as client_name, COUNT(cp.id) as plan_count FROM clients c LEFT JOIN care_plans cp ON c.id=cp.client_id GROUP BY c.id, c.first_name, c.last_name HAVING COUNT(cp.id)>0 ORDER BY plan_count DESC`),
+    ]);
+    res.json({ total: total.rows[0].total_plans, active: active.rows[0].active_plans, byServiceType: byServiceType.rows, byClient: byClient.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/care-plans/:clientId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM care_plans WHERE client_id=$1 ORDER BY start_date DESC`, [req.params.clientId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/care-plans', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT cp.*, c.first_name||' '||c.last_name as client_name FROM care_plans cp JOIN clients c ON cp.client_id=c.id ORDER BY cp.created_at DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/care-plans', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { clientId, serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate } = req.body;
+    if (!clientId || !serviceType) return res.status(400).json({ error: 'clientId and serviceType are required' });
+    const planId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO care_plans (id, client_id, service_type, service_description, frequency, care_goals, special_instructions, precautions, medication_notes, mobility_notes, dietary_notes, communication_notes, start_date, end_date, created_by)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15) RETURNING *`,
+      [planId, clientId, serviceType, serviceDescription||null, frequency||null, careGoals||null, specialInstructions||null, precautions||null, medicationNotes||null, mobilityNotes||null, dietaryNotes||null, communicationNotes||null, startDate||null, endDate||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'care_plans', planId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/care-plans/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate } = req.body;
+    const result = await db.query(
+      `UPDATE care_plans SET service_type=COALESCE($1,service_type), service_description=COALESCE($2,service_description), frequency=COALESCE($3,frequency), care_goals=COALESCE($4,care_goals), special_instructions=COALESCE($5,special_instructions), precautions=COALESCE($6,precautions), medication_notes=COALESCE($7,medication_notes), mobility_notes=COALESCE($8,mobility_notes), dietary_notes=COALESCE($9,dietary_notes), communication_notes=COALESCE($10,communication_notes), start_date=COALESCE($11,start_date), end_date=COALESCE($12,end_date), updated_at=NOW() WHERE id=$13 RETURNING *`,
+      [serviceType, serviceDescription, frequency, careGoals, specialInstructions, precautions, medicationNotes, mobilityNotes, dietaryNotes, communicationNotes, startDate, endDate, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care plan not found' });
+    await auditLog(req.user.id, 'UPDATE', 'care_plans', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/care-plans/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM care_plans WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care plan not found' });
+    await auditLog(req.user.id, 'DELETE', 'care_plans', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Care plan deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── INCIDENTS ────────────────────────────────────────────────────────────────
+
+router.get('/incidents/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [total, bySeverity, byType, followUp, monthly, byClient] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total FROM incident_reports`),
+      db.query(`SELECT severity, COUNT(*) as count FROM incident_reports GROUP BY severity ORDER BY CASE severity WHEN 'critical' THEN 1 WHEN 'severe' THEN 2 WHEN 'moderate' THEN 3 WHEN 'minor' THEN 4 END`),
+      db.query(`SELECT incident_type, COUNT(*) as count FROM incident_reports GROUP BY incident_type ORDER BY count DESC`),
+      db.query(`SELECT COUNT(*) as pending_followup FROM incident_reports WHERE follow_up_required=true`),
+      db.query(`SELECT DATE_TRUNC('month', incident_date)::DATE as month, COUNT(*) as count, COUNT(CASE WHEN severity IN ('critical','severe') THEN 1 END) as serious_count FROM incident_reports GROUP BY DATE_TRUNC('month', incident_date) ORDER BY month DESC LIMIT 12`),
+      db.query(`SELECT c.id, c.first_name||' '||c.last_name as client_name, COUNT(ir.id) as incident_count FROM clients c LEFT JOIN incident_reports ir ON c.id=ir.client_id WHERE ir.id IS NOT NULL GROUP BY c.id, c.first_name, c.last_name ORDER BY incident_count DESC LIMIT 10`),
+    ]);
+    res.json({ total: total.rows[0].total, bySeverity: bySeverity.rows, byType: byType.rows, pendingFollowUp: followUp.rows[0].pending_followup, monthlyTrend: monthly.rows, topClients: byClient.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/incidents/:id', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT ir.*, c.first_name||' '||c.last_name as client_name, u.first_name||' '||u.last_name as caregiver_name FROM incident_reports ir LEFT JOIN clients c ON ir.client_id=c.id LEFT JOIN users u ON ir.caregiver_id=u.id WHERE ir.id=$1`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/incidents', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT ir.*, c.first_name||' '||c.last_name as client_name, u.first_name||' '||u.last_name as caregiver_name FROM incident_reports ir LEFT JOIN clients c ON ir.client_id=c.id LEFT JOIN users u ON ir.caregiver_id=u.id ORDER BY ir.incident_date DESC, ir.incident_time DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/incidents', verifyToken, async (req, res) => {
+  try {
+    const { clientId, caregiverId, incidentType, severity, incidentDate, incidentTime, description, witnesses, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes, reportedBy, reportedDate } = req.body;
+    if (!clientId || !incidentType || !description) return res.status(400).json({ error: 'Client, incident type, and description are required' });
+    const incidentId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO incident_reports (id, client_id, caregiver_id, incident_type, severity, incident_date, incident_time, description, witnesses, injuries_or_damage, actions_taken, follow_up_required, follow_up_notes, reported_by, reported_date, reported_by_user_id)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16) RETURNING *`,
+      [incidentId, clientId, caregiverId||null, incidentType, severity||'moderate', incidentDate, incidentTime||null, description, witnesses||null, injuriesOrDamage||null, actionsTaken||null, followUpRequired||false, followUpNotes||null, reportedBy||null, reportedDate||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'incident_reports', incidentId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/incidents/:id', verifyToken, async (req, res) => {
+  try {
+    const { severity, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes } = req.body;
+    const result = await db.query(
+      `UPDATE incident_reports SET severity=COALESCE($1,severity), injuries_or_damage=COALESCE($2,injuries_or_damage), actions_taken=COALESCE($3,actions_taken), follow_up_required=COALESCE($4,follow_up_required), follow_up_notes=COALESCE($5,follow_up_notes), updated_at=NOW() WHERE id=$6 RETURNING *`,
+      [severity, injuriesOrDamage, actionsTaken, followUpRequired, followUpNotes, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    await auditLog(req.user.id, 'UPDATE', 'incident_reports', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/incidents/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM incident_reports WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Incident not found' });
+    await auditLog(req.user.id, 'DELETE', 'incident_reports', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Incident report deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── PERFORMANCE REVIEWS ──────────────────────────────────────────────────────
+
+router.get('/performance-reviews/summary/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT COUNT(*) as total_reviews, AVG(CASE WHEN overall_assessment='excellent' THEN 3 WHEN overall_assessment='satisfactory' THEN 2 WHEN overall_assessment='needs_improvement' THEN 1 ELSE 0 END) as avg_score, COUNT(CASE WHEN overall_assessment='excellent' THEN 1 END) as excellent_count, COUNT(CASE WHEN overall_assessment='satisfactory' THEN 1 END) as satisfactory_count, COUNT(CASE WHEN overall_assessment='needs_improvement' THEN 1 END) as needs_improvement_count, MAX(review_date) as last_review_date FROM performance_reviews WHERE caregiver_id=$1`, [req.params.caregiverId])).rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/performance-reviews/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT pr.*, cl.first_name||' '||cl.last_name as client_name FROM performance_reviews pr LEFT JOIN clients cl ON pr.client_id=cl.id WHERE pr.caregiver_id=$1 ORDER BY pr.review_date DESC`, [req.params.caregiverId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/performance-reviews', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT pr.*, c.first_name||' '||c.last_name as caregiver_name, cl.first_name||' '||cl.last_name as client_name FROM performance_reviews pr LEFT JOIN users c ON pr.caregiver_id=c.id LEFT JOIN clients cl ON pr.client_id=cl.id ORDER BY pr.review_date DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/performance-reviews', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, clientId, reviewDate, performanceNotes, strengths, areasForImprovement, overallAssessment } = req.body;
+    if (!caregiverId || !clientId || !performanceNotes) return res.status(400).json({ error: 'Caregiver, client, and performance notes are required' });
+    const reviewId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO performance_reviews (id, caregiver_id, client_id, review_date, performance_notes, strengths, areas_for_improvement, overall_assessment, reviewed_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [reviewId, caregiverId, clientId, reviewDate, performanceNotes, strengths||null, areasForImprovement||null, overallAssessment||'satisfactory', req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'performance_reviews', reviewId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/performance-reviews/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM performance_reviews WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Review not found' });
+    await auditLog(req.user.id, 'DELETE', 'performance_reviews', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Review deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── SCHEDULES ENHANCED ───────────────────────────────────────────────────────
+
+router.post('/schedules-enhanced', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, clientId, scheduleType, dayOfWeek, date, startTime, endTime, notes, frequency, effectiveDate, anchorDate } = req.body;
+    if (!caregiverId || !clientId || !startTime || !endTime) return res.status(400).json({ error: 'Missing required fields' });
+    const id = uuidv4();
+    const result = await db.query(
+      `INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, day_of_week, date, start_time, end_time, notes, frequency, effective_date, anchor_date)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12) RETURNING *`,
+      [id, caregiverId, clientId, scheduleType||'recurring', dayOfWeek!=null?dayOfWeek:null, date||null, startTime, endTime, notes||null, frequency||'weekly', effectiveDate||null, anchorDate||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/noShowRoutes.js b/templates/crm-homecare/backend/src/routes/noShowRoutes.js
new file mode 100644
index 0000000..3ca2c73
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/noShowRoutes.js
@@ -0,0 +1,189 @@
+// routes/noShowRoutes.js
+// Automated no-show detection + SMS alerts
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+let twilioClient = null;
+if (process.env.TWILIO_ACCOUNT_SID && process.env.TWILIO_AUTH_TOKEN) {
+  const twilio = require('twilio');
+  twilioClient = twilio(process.env.TWILIO_ACCOUNT_SID, process.env.TWILIO_AUTH_TOKEN);
+}
+
+const sendSMS = async (to, body) => {
+  if (!twilioClient || !to) return false;
+  try {
+    await twilioClient.messages.create({ body, from: process.env.TWILIO_PHONE_NUMBER, to });
+    return true;
+  } catch (e) { console.error('SMS failed:', e.message); return false; }
+};
+
+// GET alert config
+router.get('/config', auth, async (req, res) => {
+  try {
+    const result = await db.query('SELECT * FROM noshow_alert_config LIMIT 1');
+    res.json(result.rows[0] || {});
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// PUT update config
+router.put('/config', auth, async (req, res) => {
+  const { graceMinutes, notifyAdmin, notifyCaregiver, notifyClientFamily, adminPhone, adminEmail, isActive } = req.body;
+  try {
+    const result = await db.query(`
+      UPDATE noshow_alert_config SET
+        grace_minutes = COALESCE($1, grace_minutes),
+        notify_admin = COALESCE($2, notify_admin),
+        notify_caregiver = COALESCE($3, notify_caregiver),
+        notify_client_family = COALESCE($4, notify_client_family),
+        admin_phone = COALESCE($5, admin_phone),
+        admin_email = COALESCE($6, admin_email),
+        is_active = COALESCE($7, is_active),
+        updated_at = NOW()
+      RETURNING *
+    `, [graceMinutes, notifyAdmin, notifyCaregiver, notifyClientFamily, adminPhone, adminEmail, isActive]);
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// GET active no-show alerts
+router.get('/alerts', auth, async (req, res) => {
+  const { status = 'open', limit = 50 } = req.query;
+  try {
+    const result = await db.query(`
+      SELECT na.*,
+        u.first_name || ' ' || u.last_name AS caregiver_name,
+        u.phone AS caregiver_phone,
+        c.first_name || ' ' || c.last_name AS client_name
+      FROM noshow_alerts na
+      LEFT JOIN users u ON na.caregiver_id = u.id
+      LEFT JOIN clients c ON na.client_id = c.id
+      WHERE ($1 = '' OR na.status = $1)
+      ORDER BY na.shift_date DESC, na.expected_start DESC
+      LIMIT $2
+    `, [status === 'all' ? '' : status, limit]);
+    res.json(result.rows);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// POST resolve alert
+router.put('/alerts/:id/resolve', auth, async (req, res) => {
+  const { resolutionNote, status = 'resolved' } = req.body;
+  try {
+    const result = await db.query(`
+      UPDATE noshow_alerts SET
+        status = $1, resolved_at = NOW(), resolved_by = $2, resolution_note = $3
+      WHERE id = $4 RETURNING *
+    `, [status, req.user.id, resolutionNote || null, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// POST run check — called by cron or manually from admin
+// Finds any schedules that should have started > grace_minutes ago with no EVV clock-in
+router.post('/run-check', auth, async (req, res) => {
+  try {
+    const configRes = await db.query('SELECT * FROM noshow_alert_config WHERE is_active = TRUE LIMIT 1');
+    if (!configRes.rows.length) return res.json({ checked: 0, alerts: 0 });
+    const config = configRes.rows[0];
+    const grace = config.grace_minutes || 15;
+
+    // Find schedules that started more than grace_minutes ago today with no time_tracking entry
+    const overdue = await db.query(`
+      SELECT
+        s.id AS schedule_id,
+        s.caregiver_id,
+        s.client_id,
+        CURRENT_DATE AS shift_date,
+        s.start_time AS expected_start,
+        u.first_name || ' ' || u.last_name AS caregiver_name,
+        u.phone AS caregiver_phone,
+        c.first_name || ' ' || c.last_name AS client_name
+      FROM schedules s
+      JOIN users u ON s.caregiver_id = u.id
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.is_active = TRUE
+        AND (
+          -- recurring: day_of_week matches today
+          (s.day_of_week = EXTRACT(DOW FROM CURRENT_DATE)::int AND s.schedule_type = 'recurring')
+          OR
+          -- one-time: date is today
+          (s.schedule_type = 'one-time' AND s.date = CURRENT_DATE)
+        )
+        -- started more than grace_minutes ago
+        AND (CURRENT_TIME - s.start_time) > ($1 * INTERVAL '1 minute')
+        AND (CURRENT_TIME - s.start_time) < INTERVAL '4 hours'
+        -- no clock-in today
+        AND NOT EXISTS (
+          SELECT 1 FROM time_tracking tt
+          WHERE tt.caregiver_id = s.caregiver_id
+            AND tt.client_id = s.client_id
+            AND DATE(tt.clock_in) = CURRENT_DATE
+            AND ABS(EXTRACT(EPOCH FROM (tt.clock_in::time - s.start_time)) / 60) < 120
+        )
+        -- not already alerted today
+        AND NOT EXISTS (
+          SELECT 1 FROM noshow_alerts na
+          WHERE na.caregiver_id = s.caregiver_id
+            AND na.client_id = s.client_id
+            AND na.shift_date = CURRENT_DATE
+            AND na.status = 'open'
+        )
+    `, [grace]);
+
+    let alertsCreated = 0;
+    for (const row of overdue.rows) {
+      // Create alert record
+      await db.query(`
+        INSERT INTO noshow_alerts (schedule_id, caregiver_id, client_id, shift_date, expected_start, sms_sent)
+        VALUES ($1,$2,$3,$4,$5, FALSE)
+        ON CONFLICT DO NOTHING
+      `, [row.schedule_id, row.caregiver_id, row.client_id, row.shift_date, row.expected_start]);
+
+      let smsSent = false;
+
+      // SMS caregiver
+      if (config.notify_caregiver && row.caregiver_phone) {
+        smsSent = await sendSMS(row.caregiver_phone,
+          `CVHC Alert: You were scheduled to start with ${row.client_name} at ${row.expected_start}. Please clock in or contact the office immediately.`
+        );
+      }
+
+      // SMS admin
+      if (config.notify_admin && config.admin_phone) {
+        await sendSMS(config.admin_phone,
+          `CVHC No-Show Alert: ${row.caregiver_name} has not clocked in for ${row.client_name} (scheduled ${row.expected_start}). Please follow up.`
+        );
+      }
+
+      if (smsSent) {
+        await db.query(`UPDATE noshow_alerts SET sms_sent = TRUE WHERE caregiver_id=$1 AND client_id=$2 AND shift_date=$3`,
+          [row.caregiver_id, row.client_id, row.shift_date]);
+      }
+
+      alertsCreated++;
+    }
+
+    res.json({ checked: overdue.rows.length, alerts: alertsCreated, grace_minutes: grace });
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+// GET today's summary stats
+router.get('/stats', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT
+        COUNT(*) FILTER (WHERE status = 'open') AS open_count,
+        COUNT(*) FILTER (WHERE status = 'resolved') AS resolved_count,
+        COUNT(*) FILTER (WHERE status = 'false_alarm') AS false_alarm_count,
+        COUNT(*) FILTER (WHERE shift_date = CURRENT_DATE) AS today_count,
+        COUNT(*) FILTER (WHERE shift_date >= CURRENT_DATE - 7) AS week_count
+      FROM noshow_alerts
+    `);
+    res.json(result.rows[0]);
+  } catch (e) { res.status(500).json({ error: e.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/notificationRoutes.js b/templates/crm-homecare/backend/src/routes/notificationRoutes.js
new file mode 100644
index 0000000..12ed7f7
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/notificationRoutes.js
@@ -0,0 +1,118 @@
+// routes/notificationRoutes.js — mounted at /api via app.use('/api', notificationRoutes)
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── NOTIFICATIONS ───────────────────────────────────────────────────────────
+
+router.get('/notifications', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT * FROM notifications WHERE recipient_id=$1 OR (recipient_type='admin' AND $2='admin') ORDER BY created_at DESC LIMIT 50`,
+      [req.user.id, req.user.role]
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/notification-settings', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM notification_settings WHERE user_id=$1`, [req.user.id]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO notification_settings (user_id, email_enabled, schedule_alerts, payroll_alerts, absence_alerts, payment_alerts) VALUES ($1,true,true,true,true,true)`, [req.user.id]);
+      result = await db.query(`SELECT * FROM notification_settings WHERE user_id=$1`, [req.user.id]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/notification-settings', verifyToken, async (req, res) => {
+  try {
+    const { emailEnabled, scheduleAlerts, payrollAlerts, absenceAlerts, paymentAlerts } = req.body;
+    const result = await db.query(
+      `UPDATE notification_settings SET email_enabled=COALESCE($1,email_enabled), schedule_alerts=COALESCE($2,schedule_alerts),
+        payroll_alerts=COALESCE($3,payroll_alerts), absence_alerts=COALESCE($4,absence_alerts),
+        payment_alerts=COALESCE($5,payment_alerts), updated_at=NOW() WHERE user_id=$6 RETURNING *`,
+      [emailEnabled, scheduleAlerts, payrollAlerts, absenceAlerts, paymentAlerts, req.user.id]
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/send', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { recipientType, recipientId, notificationType, subject, message } = req.body;
+    if (!recipientId || !subject || !message) return res.status(400).json({ error: 'recipientId, subject, and message are required' });
+    const notificationId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO notifications (id, recipient_type, recipient_id, notification_type, subject, message, status, sent_by) VALUES ($1,$2,$3,$4,$5,$6,$7,$8) RETURNING *`,
+      [notificationId, recipientType, recipientId, notificationType||'general', subject, message, 'sent', req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'notifications', notificationId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/send-bulk', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { recipientIds, notificationType, subject, message } = req.body;
+    if (!recipientIds?.length || !subject || !message) return res.status(400).json({ error: 'recipientIds, subject, and message are required' });
+    const sent = [];
+    for (const recipientId of recipientIds) {
+      const notificationId = uuidv4();
+      const result = await db.query(
+        `INSERT INTO notifications (id, recipient_type, recipient_id, notification_type, subject, message, status, sent_by) VALUES ($1,'caregiver',$2,$3,$4,$5,'sent',$6) RETURNING *`,
+        [notificationId, recipientId, notificationType||'general', subject, message, req.user.id]
+      );
+      sent.push(result.rows[0]);
+    }
+    await auditLog(req.user.id, 'CREATE', 'notifications', 'bulk', null, { count: sent.length });
+    res.status(201).json({ sent: sent.length, notifications: sent });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.patch('/notifications/:id/read', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE notifications SET is_read=true, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Notification not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/notifications/:id', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM notifications WHERE id=$1 AND recipient_id=$2 RETURNING *`, [req.params.id, req.user.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Notification not found' });
+    res.json({ message: 'Notification deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/notifications/summary', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT COUNT(*) as total_notifications, COUNT(CASE WHEN is_read=false THEN 1 END) as unread_count,
+        COUNT(CASE WHEN status='sent' THEN 1 END) as sent_count, COUNT(CASE WHEN status='pending' THEN 1 END) as pending_count,
+        COUNT(CASE WHEN status='failed' THEN 1 END) as failed_count, COUNT(DISTINCT recipient_id) as unique_recipients FROM notifications`
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/notifications/subscribe', verifyToken, async (req, res) => {
+  res.json({ success: true });
+});
+
+router.put('/notifications/preferences', verifyToken, async (req, res) => {
+  try {
+    const { emailEnabled, pushEnabled, scheduleAlerts, absenceAlerts, billingAlerts } = req.body;
+    const result = await db.query(
+      `INSERT INTO notification_preferences (user_id, email_enabled, push_enabled, schedule_alerts, absence_alerts, billing_alerts)
+       VALUES ($1,$2,$3,$4,$5,$6) ON CONFLICT (user_id) DO UPDATE SET email_enabled=$2, push_enabled=$3, schedule_alerts=$4, absence_alerts=$5, billing_alerts=$6 RETURNING *`,
+      [req.user.id, emailEnabled, pushEnabled, scheduleAlerts, absenceAlerts, billingAlerts]
+    );
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/openShiftsRoutes.js b/templates/crm-homecare/backend/src/routes/openShiftsRoutes.js
new file mode 100644
index 0000000..146c0fb
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/openShiftsRoutes.js
@@ -0,0 +1,304 @@
+// routes/openShiftsRoutes.js
+// Open Shift Board - Caregivers claim available shifts
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Get all open shifts
+router.get('/available', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT os.*, c.first_name as client_first_name, c.last_name as client_last_name
+      FROM open_shifts os
+      LEFT JOIN clients c ON os.client_id = c.id
+      WHERE os.status = 'open' 
+        AND (os.shift_date >= CURRENT_DATE OR os.shift_date IS NULL)
+      ORDER BY os.shift_date, os.start_time
+    `);
+    res.json(result.rows);
+  } catch (error) {
+    console.error('Get available shifts error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+router.get('/', auth, async (req, res) => {
+  const { status, startDate, endDate, urgency } = req.query;
+  try {
+    let query = `
+      SELECT os.*, 
+        c.first_name as client_first_name, c.last_name as client_last_name,
+        c.address as client_address, c.city as client_city,
+        ct.name as care_type_name,
+        u.first_name as claimed_by_first, u.last_name as claimed_by_last
+      FROM open_shifts os
+      JOIN clients c ON os.client_id = c.id
+      LEFT JOIN care_types ct ON os.care_type_id = ct.id
+      LEFT JOIN users u ON os.claimed_by = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status) {
+      params.push(status);
+      query += ` AND os.status = $${params.length}`;
+    } else {
+      query += ` AND os.status = 'open'`; // Default to open shifts
+    }
+
+    if (startDate) {
+      params.push(startDate);
+      query += ` AND os.shift_date >= $${params.length}`;
+    }
+    if (endDate) {
+      params.push(endDate);
+      query += ` AND os.shift_date <= $${params.length}`;
+    }
+    if (urgency) {
+      params.push(urgency);
+      query += ` AND os.urgency = $${params.length}`;
+    }
+
+    query += ` ORDER BY os.urgency DESC, os.shift_date ASC, os.start_time ASC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create open shift
+router.post('/', auth, async (req, res) => {
+  const { clientId, scheduleId, shiftDate, startTime, endTime, careTypeId, hourlyRate, bonusAmount, notes, urgency } = req.body;
+  
+  try {
+    const result = await db.query(`
+      INSERT INTO open_shifts (client_id, schedule_id, shift_date, start_time, end_time, care_type_id, hourly_rate, bonus_amount, notes, urgency, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)
+      RETURNING *
+    `, [clientId, scheduleId, shiftDate, startTime, endTime, careTypeId, hourlyRate, bonusAmount || 0, notes, urgency || 'normal', req.user.id]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Convert unfilled schedule to open shift
+router.post('/from-schedule/:scheduleId', auth, async (req, res) => {
+  const { scheduleId } = req.params;
+  const { bonusAmount, urgency } = req.body;
+
+  try {
+    const schedule = await db.query(`
+      SELECT s.*, c.referral_source_id
+      FROM schedules s
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.id = $1
+    `, [scheduleId]);
+
+    if (schedule.rows.length === 0) {
+      return res.status(404).json({ error: 'Schedule not found' });
+    }
+
+    const s = schedule.rows[0];
+
+    // Get rate
+    const rate = await db.query(`
+      SELECT rate_amount FROM referral_source_rates 
+      WHERE referral_source_id = $1 
+      ORDER BY effective_date DESC LIMIT 1
+    `, [s.referral_source_id]);
+
+    const result = await db.query(`
+      INSERT INTO open_shifts (client_id, schedule_id, shift_date, start_time, end_time, care_type_id, hourly_rate, bonus_amount, urgency, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)
+      RETURNING *
+    `, [s.client_id, scheduleId, s.scheduled_date, s.start_time, s.end_time, s.care_type_id, rate.rows[0]?.rate_amount || 20, bonusAmount || 0, urgency || 'normal', req.user.id]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Caregiver claims a shift
+router.post('/:id/claim', auth, async (req, res) => {
+  const { id } = req.params;
+  const { caregiverId, notes } = req.body;
+
+  try {
+    // Check shift is still open
+    const shift = await db.query('SELECT * FROM open_shifts WHERE id = $1 AND status = $2', [id, 'open']);
+    if (shift.rows.length === 0) {
+      return res.status(400).json({ error: 'Shift is no longer available' });
+    }
+
+    // Check caregiver availability
+    const conflicts = await db.query(`
+      SELECT id FROM schedules 
+      WHERE caregiver_id = $1 
+      AND scheduled_date = $2
+      AND ((start_time, end_time) OVERLAPS ($3::time, $4::time))
+      AND status != 'cancelled'
+    `, [caregiverId, shift.rows[0].shift_date, shift.rows[0].start_time, shift.rows[0].end_time]);
+
+    if (conflicts.rows.length > 0) {
+      return res.status(400).json({ error: 'You have a conflicting shift at this time' });
+    }
+
+    // Create claim
+    await db.query(`
+      INSERT INTO open_shift_claims (open_shift_id, caregiver_id, notes)
+      VALUES ($1, $2, $3)
+    `, [id, caregiverId, notes]);
+
+    // Update shift status
+    await db.query(`
+      UPDATE open_shifts SET status = 'claimed', claimed_by = $1, claimed_at = NOW()
+      WHERE id = $2
+    `, [caregiverId, id]);
+
+    res.json({ success: true, message: 'Shift claimed - pending approval' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Admin approves claim
+router.post('/:id/approve', auth, async (req, res) => {
+  const { id } = req.params;
+
+  try {
+    const shift = await db.query('SELECT * FROM open_shifts WHERE id = $1', [id]);
+    if (shift.rows.length === 0) {
+      return res.status(404).json({ error: 'Shift not found' });
+    }
+
+    const s = shift.rows[0];
+    if (!s.claimed_by) {
+      return res.status(400).json({ error: 'No claim to approve' });
+    }
+
+    // Create or update schedule
+    if (s.schedule_id) {
+      await db.query(`
+        UPDATE schedules SET caregiver_id = $1, status = 'scheduled' WHERE id = $2
+      `, [s.claimed_by, s.schedule_id]);
+    } else {
+      await db.query(`
+        INSERT INTO schedules (client_id, caregiver_id, scheduled_date, start_time, end_time, care_type_id, status)
+        VALUES ($1, $2, $3, $4, $5, $6, 'scheduled')
+      `, [s.client_id, s.claimed_by, s.shift_date, s.start_time, s.end_time, s.care_type_id]);
+    }
+
+    // Update open shift
+    await db.query(`
+      UPDATE open_shifts SET status = 'filled', approved_by = $1, approved_at = NOW()
+      WHERE id = $2
+    `, [req.user.id, id]);
+
+    // Update claim
+    await db.query(`
+      UPDATE open_shift_claims SET status = 'approved' WHERE open_shift_id = $1 AND caregiver_id = $2
+    `, [id, s.claimed_by]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Reject claim
+router.post('/:id/reject', auth, async (req, res) => {
+  const { id } = req.params;
+  const { reason } = req.body;
+
+  try {
+    const shift = await db.query('SELECT * FROM open_shifts WHERE id = $1', [id]);
+    if (shift.rows.length === 0) {
+      return res.status(404).json({ error: 'Shift not found' });
+    }
+
+    // Reopen shift
+    await db.query(`
+      UPDATE open_shifts SET status = 'open', claimed_by = NULL, claimed_at = NULL
+      WHERE id = $1
+    `, [id]);
+
+    // Update claim
+    await db.query(`
+      UPDATE open_shift_claims SET status = 'rejected', notes = $1
+      WHERE open_shift_id = $2 AND status = 'pending'
+    `, [reason, id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Broadcast open shift to caregivers
+router.post('/:id/broadcast', auth, async (req, res) => {
+  const { id } = req.params;
+
+  try {
+    const shift = await db.query(`
+      SELECT os.*, c.first_name as client_first, c.last_name as client_last
+      FROM open_shifts os
+      JOIN clients c ON os.client_id = c.id
+      WHERE os.id = $1
+    `, [id]);
+
+    if (shift.rows.length === 0) {
+      return res.status(404).json({ error: 'Shift not found' });
+    }
+
+    const s = shift.rows[0];
+
+    // Get eligible caregivers
+    const caregivers = await db.query(`
+      SELECT u.id, u.phone 
+      FROM users u
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      WHERE u.role = 'caregiver' AND u.is_active = true 
+        AND (cp.sms_enabled = true OR cp.sms_enabled IS NULL)
+        AND (cp.sms_open_shifts = true OR cp.sms_open_shifts IS NULL)
+    `);
+
+    // This would integrate with SMS routes
+    const message = `Open shift available: ${s.client_first} ${s.client_last} on ${s.shift_date} at ${s.start_time}${s.bonus_amount > 0 ? ` (+$${s.bonus_amount} bonus)` : ''}. Claim it in the app!`;
+
+    // Mark as broadcast
+    await db.query(`UPDATE open_shifts SET broadcast_sent = true WHERE id = $1`, [id]);
+
+    res.json({ 
+      success: true, 
+      message: `Broadcast sent to ${caregivers.rows.length} caregivers`,
+      caregiverCount: caregivers.rows.length
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Get claims for a shift
+router.get('/:id/claims', auth, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT osc.*, u.first_name, u.last_name, u.phone
+      FROM open_shift_claims osc
+      JOIN users u ON osc.caregiver_id = u.id
+      WHERE osc.open_shift_id = $1
+      ORDER BY osc.created_at
+    `, [req.params.id]);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/optimizerRoutes.js b/templates/crm-homecare/backend/src/routes/optimizerRoutes.js
new file mode 100644
index 0000000..452cb3c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/optimizerRoutes.js
@@ -0,0 +1,446 @@
+// routes/optimizerRoutes.js
+// Schedule Optimizer — sandbox scheduling that reads existing data but writes nothing
+// until admin explicitly applies the proposal.
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── GET CLIENT OPTIMIZER DATA ────────────────────────────────────────────────
+// Returns active authorization (units→hours) + existing schedule info for a client
+router.get('/client-data/:clientId', async (req, res) => {
+  try {
+    const { clientId } = req.params;
+
+    // Get client info
+    const clientRes = await db.query(
+      `SELECT id, first_name, last_name, preferred_caregivers, do_not_use_caregivers, service_type
+       FROM clients WHERE id = $1`,
+      [clientId]
+    );
+    if (clientRes.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+    const client = clientRes.rows[0];
+
+    // Get active authorization
+    const authRes = await db.query(
+      `SELECT authorized_units, used_units, unit_type, start_date, end_date,
+              authorized_units - used_units as remaining_units
+       FROM authorizations
+       WHERE client_id = $1 AND status = 'active'
+         AND start_date <= CURRENT_DATE AND end_date >= CURRENT_DATE
+       ORDER BY end_date ASC LIMIT 1`,
+      [clientId]
+    );
+
+    const auth = authRes.rows[0] || null;
+    let authorizedHoursPerWeek = 0;
+    let remainingHours = 0;
+
+    if (auth) {
+      // Calculate weekly hours from authorization period
+      const startDate = new Date(auth.start_date);
+      const endDate = new Date(auth.end_date);
+      const weeks = Math.max(1, Math.round((endDate - startDate) / (7 * 24 * 60 * 60 * 1000)));
+      const totalHours = auth.unit_type === '15min'
+        ? parseFloat(auth.authorized_units) / 4
+        : parseFloat(auth.authorized_units); // assume hours if not 15min
+      const remainingTotalHours = auth.unit_type === '15min'
+        ? parseFloat(auth.remaining_units) / 4
+        : parseFloat(auth.remaining_units);
+      authorizedHoursPerWeek = parseFloat((totalHours / weeks).toFixed(2));
+      remainingHours = parseFloat(remainingTotalHours.toFixed(2));
+    }
+
+    // Get existing recurring schedules for this client
+    const schedRes = await db.query(
+      `SELECT s.day_of_week, s.start_time, s.end_time, s.caregiver_id,
+              u.first_name as caregiver_first, u.last_name as caregiver_last
+       FROM schedules s
+       JOIN users u ON s.caregiver_id = u.id
+       WHERE s.client_id = $1 AND s.is_active = true
+         AND s.schedule_type = 'recurring' AND s.day_of_week IS NOT NULL
+       ORDER BY s.day_of_week, s.start_time`,
+      [clientId]
+    );
+
+    // Also check client_assignments for hours_per_week
+    const assignRes = await db.query(
+      `SELECT hours_per_week FROM client_assignments
+       WHERE client_id = $1 AND status = 'active'
+       ORDER BY assignment_date DESC LIMIT 1`,
+      [clientId]
+    );
+    const assignedHoursPerWeek = assignRes.rows[0]?.hours_per_week || null;
+
+    res.json({
+      client,
+      authorization: auth,
+      authorizedHoursPerWeek,
+      remainingHours,
+      assignedHoursPerWeek,
+      existingScheduleDays: schedRes.rows.map(r => r.day_of_week),
+      existingSchedules: schedRes.rows,
+    });
+  } catch (err) {
+    console.error('Optimizer client-data error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── RUN OPTIMIZER ────────────────────────────────────────────────────────────
+// Core algorithm: constraint-based schedule builder
+// Input: selectedCaregivers [{id, allocatedHours}], selectedClients [{id, visitsPerWeek, hoursPerWeek}]
+// Reads existing schedules, builds proposed assignments, flags conflicts
+router.post('/run', async (req, res) => {
+  try {
+    const { caregivers: selectedCaregivers, clients: selectedClients } = req.body;
+
+    if (!selectedCaregivers?.length || !selectedClients?.length) {
+      return res.status(400).json({ error: 'Must provide at least one caregiver and one client' });
+    }
+
+    const caregiverIds = selectedCaregivers.map(c => c.id);
+    const clientIds = selectedClients.map(c => c.id);
+
+    // ── 1. Load existing schedules for ALL selected caregivers ──────────────
+    const existingRes = await db.query(
+      `SELECT s.id, s.caregiver_id, s.client_id, s.day_of_week, s.start_time, s.end_time,
+              s.schedule_type, s.frequency,
+              u.first_name as cg_first, u.last_name as cg_last,
+              c.first_name as cl_first, c.last_name as cl_last
+       FROM schedules s
+       JOIN users u ON s.caregiver_id = u.id
+       JOIN clients c ON s.client_id = c.id
+       WHERE s.caregiver_id = ANY($1) AND s.is_active = true
+         AND s.schedule_type = 'recurring' AND s.day_of_week IS NOT NULL
+       ORDER BY s.caregiver_id, s.day_of_week, s.start_time`,
+      [caregiverIds]
+    );
+    const existingSchedules = existingRes.rows;
+
+    // ── 2. Load client data (preferred caregivers, do_not_use) ──────────────
+    const clientDataRes = await db.query(
+      `SELECT id, first_name, last_name, preferred_caregivers, do_not_use_caregivers
+       FROM clients WHERE id = ANY($1)`,
+      [clientIds]
+    );
+    const clientMap = {};
+    clientDataRes.rows.forEach(c => { clientMap[c.id] = c; });
+
+    // ── 3. Load caregiver data ───────────────────────────────────────────────
+    const cgDataRes = await db.query(
+      `SELECT u.id, u.first_name, u.last_name,
+              a.monday_available, a.tuesday_available, a.wednesday_available,
+              a.thursday_available, a.friday_available, a.saturday_available, a.sunday_available,
+              a.monday_start_time, a.tuesday_start_time, a.wednesday_start_time,
+              a.thursday_start_time, a.friday_start_time,
+              a.monday_end_time, a.tuesday_end_time, a.wednesday_end_time,
+              a.thursday_end_time, a.friday_end_time
+       FROM users u
+       LEFT JOIN caregiver_availability a ON a.caregiver_id = u.id
+       WHERE u.id = ANY($1)`,
+      [caregiverIds]
+    );
+    const cgMap = {};
+    cgDataRes.rows.forEach(cg => { cgMap[cg.id] = cg; });
+
+    // ── 4. Build caregiver schedule map: {cgId: {dayOfWeek: [{start, end}]}} ─
+    const cgScheduleMap = {};
+    caregiverIds.forEach(id => { cgScheduleMap[id] = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] }; });
+    existingSchedules.forEach(s => {
+      if (cgScheduleMap[s.caregiver_id] && s.day_of_week !== null) {
+        cgScheduleMap[s.caregiver_id][s.day_of_week].push({
+          start: s.start_time,
+          end: s.end_time,
+          clientId: s.client_id,
+          clientName: `${s.cl_first} ${s.cl_last}`,
+          scheduleId: s.id,
+          isExisting: true
+        });
+      }
+    });
+
+    // ── 5. Track remaining hours per caregiver ───────────────────────────────
+    const cgRemainingHours = {};
+    selectedCaregivers.forEach(cg => {
+      // Subtract hours already booked in existing recurring schedules
+      let alreadyBooked = 0;
+      existingSchedules.filter(s => s.caregiver_id === cg.id).forEach(s => {
+        alreadyBooked += timeToHours(s.end_time) - timeToHours(s.start_time);
+      });
+      cgRemainingHours[cg.id] = Math.max(0, parseFloat(cg.allocatedHours) - alreadyBooked);
+    });
+
+    // ── 6. Run optimization: assign each client's visits ────────────────────
+    const proposals = [];
+    const conflicts = [];
+    const unscheduled = [];
+    const DAY_NAMES = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+    const AVAIL_KEYS = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
+    const DEFAULT_START = '08:00';
+
+    for (const clientCfg of selectedClients) {
+      const { id: clientId, visitsPerWeek, hoursPerWeek } = clientCfg;
+      const clientInfo = clientMap[clientId];
+      if (!clientInfo) continue;
+
+      const hoursPerVisit = parseFloat((hoursPerWeek / visitsPerWeek).toFixed(2));
+      const visitDurationMins = Math.round(hoursPerVisit * 60);
+
+      // Days already used for this client in existing schedules
+      const clientExistingDays = existingSchedules
+        .filter(s => s.client_id === clientId)
+        .map(s => s.day_of_week);
+
+      // Track days we've already placed a visit for this client (this run)
+      const clientPlacedDays = new Set(clientExistingDays);
+      let visitsPlaced = 0;
+
+      // Score caregivers for this client
+      const scoredCaregivers = selectedCaregivers.map(cg => {
+        const info = clientInfo;
+        const isPreferred = Array.isArray(info.preferred_caregivers) && info.preferred_caregivers.includes(cg.id);
+        const isBlocked = Array.isArray(info.do_not_use_caregivers) && info.do_not_use_caregivers.includes(cg.id);
+        // Check if this caregiver already sees this client
+        const alreadySees = existingSchedules.some(s => s.caregiver_id === cg.id && s.client_id === clientId);
+        return {
+          ...cg,
+          score: isBlocked ? -999 : (isPreferred ? 10 : 0) + (alreadySees ? 5 : 0),
+          isBlocked
+        };
+      }).filter(cg => !cg.isBlocked).sort((a, b) => b.score - a.score);
+
+      // Try to place each visit on a different day
+      const tryDays = [1, 3, 2, 4, 5, 0, 6]; // Mon, Wed, Tue, Thu, Fri, Sun, Sat — prefer weekdays
+
+      for (let visit = 0; visit < visitsPerWeek && visitsPlaced < visitsPerWeek; visit++) {
+        let placed = false;
+
+        for (const day of tryDays) {
+          if (clientPlacedDays.has(day)) continue; // skip days already used
+
+          for (const cg of scoredCaregivers) {
+            if (cgRemainingHours[cg.id] < hoursPerVisit - 0.01) continue; // not enough hours
+
+            // Check caregiver availability
+            const cgInfo = cgMap[cg.id];
+            const dayKey = AVAIL_KEYS[day];
+            const isAvailable = cgInfo ? (cgInfo[`${dayKey}_available`] !== false) : true;
+            if (!isAvailable) continue;
+
+            // Find a non-conflicting start time for this day
+            const daySlots = cgScheduleMap[cg.id][day];
+            const startTime = findAvailableSlot(daySlots, visitDurationMins, cgInfo, day);
+            if (!startTime) continue;
+
+            const endTime = addMinutes(startTime, visitDurationMins);
+
+            // Check if this overlaps with any existing schedule
+            const overlap = daySlots.filter(slot => slot.isExisting &&
+              timesOverlap(startTime, endTime, slot.start, slot.end));
+
+            const proposal = {
+              id: uuidv4(),
+              clientId,
+              clientName: `${clientInfo.first_name} ${clientInfo.last_name}`,
+              caregiverId: cg.id,
+              caregiverName: `${cgMap[cg.id]?.first_name || ''} ${cgMap[cg.id]?.last_name || ''}`.trim(),
+              dayOfWeek: day,
+              dayName: DAY_NAMES[day],
+              startTime,
+              endTime,
+              hoursPerVisit,
+              hasConflict: overlap.length > 0,
+              conflictsWith: overlap.map(o => ({
+                scheduleId: o.scheduleId,
+                clientName: o.clientName,
+                start: o.start,
+                end: o.end,
+                suggestion: `Consider moving ${o.clientName} to another time slot`
+              })),
+              isNew: !clientExistingDays.includes(day)
+            };
+
+            proposals.push(proposal);
+
+            // Register this slot so subsequent assignments avoid it
+            cgScheduleMap[cg.id][day].push({
+              start: startTime,
+              end: endTime,
+              clientId,
+              clientName: `${clientInfo.first_name} ${clientInfo.last_name}`,
+              isExisting: false
+            });
+
+            cgRemainingHours[cg.id] -= hoursPerVisit;
+            clientPlacedDays.add(day);
+            visitsPlaced++;
+            placed = true;
+            break;
+          }
+          if (placed) break;
+        }
+
+        if (!placed) {
+          // Couldn't place this visit — log it
+          unscheduled.push({
+            clientId,
+            clientName: `${clientInfo.first_name} ${clientInfo.last_name}`,
+            visitNumber: visit + 1,
+            reason: cgRemainingHours[scoredCaregivers[0]?.id] < hoursPerVisit
+              ? 'Caregivers at hour capacity'
+              : 'No available time slots found'
+          });
+        }
+      }
+    }
+
+    // ── 7. Build summary ─────────────────────────────────────────────────────
+    const summary = {
+      caregivers: selectedCaregivers.map(cg => {
+        const cgInfo = cgMap[cg.id];
+        const name = `${cgInfo?.first_name || ''} ${cgInfo?.last_name || ''}`.trim();
+        const proposedHours = proposals
+          .filter(p => p.caregiverId === cg.id)
+          .reduce((sum, p) => sum + p.hoursPerVisit, 0);
+        const existingHours = existingSchedules
+          .filter(s => s.caregiver_id === cg.id)
+          .reduce((sum, s) => sum + (timeToHours(s.end_time) - timeToHours(s.start_time)), 0);
+        return {
+          id: cg.id,
+          name,
+          allocatedHours: parseFloat(cg.allocatedHours),
+          existingHours: parseFloat(existingHours.toFixed(2)),
+          proposedNewHours: parseFloat(proposedHours.toFixed(2)),
+          totalHours: parseFloat((existingHours + proposedHours).toFixed(2)),
+          remainingHours: parseFloat(cgRemainingHours[cg.id].toFixed(2))
+        };
+      }),
+      clients: selectedClients.map(cl => {
+        const clientInfo = clientMap[cl.id];
+        const name = `${clientInfo?.first_name || ''} ${clientInfo?.last_name || ''}`.trim();
+        const placedVisits = proposals.filter(p => p.clientId === cl.id).length;
+        return {
+          id: cl.id,
+          name,
+          visitsNeeded: cl.visitsPerWeek,
+          visitsPlaced: placedVisits,
+          hoursPerWeek: cl.hoursPerWeek,
+          fullyScheduled: placedVisits >= cl.visitsPerWeek
+        };
+      }),
+      totalProposals: proposals.length,
+      conflictCount: proposals.filter(p => p.hasConflict).length,
+      unscheduledCount: unscheduled.length
+    };
+
+    res.json({
+      proposals,
+      existingSchedules: existingSchedules.map(s => ({
+        id: s.id,
+        caregiverId: s.caregiver_id,
+        caregiverName: `${s.cg_first} ${s.cg_last}`,
+        clientId: s.client_id,
+        clientName: `${s.cl_first} ${s.cl_last}`,
+        dayOfWeek: s.day_of_week,
+        startTime: s.start_time,
+        endTime: s.end_time
+      })),
+      unscheduled,
+      summary
+    });
+  } catch (err) {
+    console.error('Optimizer run error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── APPLY PROPOSALS ─────────────────────────────────────────────────────────
+// Writes approved proposals to the real schedules table
+router.post('/apply', async (req, res) => {
+  try {
+    const { proposals, createdBy } = req.body;
+    if (!proposals?.length) return res.status(400).json({ error: 'No proposals to apply' });
+
+    const created = [];
+    const errors = [];
+
+    for (const p of proposals) {
+      try {
+        const id = uuidv4();
+        await db.query(
+          `INSERT INTO schedules
+             (id, caregiver_id, client_id, schedule_type, day_of_week, start_time, end_time, notes, is_active)
+           VALUES ($1, $2, $3, 'recurring', $4, $5, $6, $7, true)
+           RETURNING id`,
+          [id, p.caregiverId, p.clientId, p.dayOfWeek, p.startTime, p.endTime,
+           `Created by Schedule Optimizer`]
+        );
+        created.push(id);
+      } catch (err) {
+        errors.push({ proposal: p, error: err.message });
+      }
+    }
+
+    res.json({
+      success: true,
+      created: created.length,
+      errors: errors.length,
+      errorDetails: errors
+    });
+  } catch (err) {
+    console.error('Optimizer apply error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── HELPERS ─────────────────────────────────────────────────────────────────
+
+function timeToHours(timeStr) {
+  if (!timeStr) return 0;
+  const [h, m] = timeStr.split(':').map(Number);
+  return h + m / 60;
+}
+
+function addMinutes(timeStr, minutes) {
+  const [h, m] = timeStr.split(':').map(Number);
+  const total = h * 60 + m + minutes;
+  const nh = Math.floor(total / 60) % 24;
+  const nm = total % 60;
+  return `${String(nh).padStart(2, '0')}:${String(nm).padStart(2, '0')}`;
+}
+
+function timesOverlap(aStart, aEnd, bStart, bEnd) {
+  return aStart < bEnd && aEnd > bStart;
+}
+
+// Find the first non-conflicting start time for a slot of `durationMins` on a given day
+function findAvailableSlot(existingSlots, durationMins, cgInfo, dayOfWeek) {
+  const AVAIL_KEYS = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
+  const dayKey = AVAIL_KEYS[dayOfWeek];
+
+  // Caregiver window for this day (default 08:00–18:00)
+  const windowStart = cgInfo?.[`${dayKey}_start_time`] || '08:00';
+  const windowEnd = cgInfo?.[`${dayKey}_end_time`] || '18:00';
+
+  // Sort existing slots for this day
+  const sorted = [...existingSlots].sort((a, b) => a.start.localeCompare(b.start));
+
+  // Try starting at windowStart, then after each existing block
+  const candidates = [windowStart, ...sorted.map(s => s.end)];
+
+  for (const candidate of candidates) {
+    if (candidate >= windowEnd) break;
+    const proposed_end = addMinutes(candidate, durationMins);
+    if (proposed_end > windowEnd) break;
+
+    // Check no overlap with existing slots
+    const hasConflict = sorted.some(s => timesOverlap(candidate, proposed_end, s.start, s.end));
+    if (!hasConflict) return candidate;
+  }
+
+  return null; // no room
+}
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/payrollRoutes.js b/templates/crm-homecare/backend/src/routes/payrollRoutes.js
new file mode 100644
index 0000000..11c9c13
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/payrollRoutes.js
@@ -0,0 +1,434 @@
+// routes/payrollRoutes.js
+// Mounted at /api/payroll — so routes here are /calculate, /mileage, etc. (no /payroll/ prefix)
+
+const express = require('express');
+const router  = express.Router();
+const db      = require('../db');
+const auth    = require('../middleware/auth');
+
+// ==================== PAYROLL CALCULATE ====================
+// POST /api/payroll/calculate
+
+router.post('/calculate', auth, async (req, res) => {
+  const { startDate, endDate } = req.body;
+
+  if (!startDate || !endDate) {
+    return res.status(400).json({ error: 'startDate and endDate are required' });
+  }
+
+  try {
+    const result = await db.query(`
+      SELECT
+        u.id                                                        AS caregiver_id,
+        u.first_name,
+        u.last_name,
+        COALESCE(u.hourly_rate, $3::numeric)                       AS hourly_rate,
+        COALESCE(
+          ROUND(SUM(COALESCE(te.duration_minutes, 0))::numeric / 60, 2),
+          0
+        )                                                          AS total_hours,
+        COALESCE(
+          ROUND(SUM(
+            CASE WHEN EXTRACT(DOW FROM te.start_time) IN (0,6)
+                 THEN COALESCE(te.duration_minutes, 0)
+                 ELSE 0 END
+          )::numeric / 60, 2),
+          0
+        )                                                          AS weekend_hours,
+        COALESCE(
+          ROUND(SUM(
+            CASE WHEN EXTRACT(HOUR FROM te.start_time) >= 18
+                   OR EXTRACT(HOUR FROM te.start_time) < 6
+                 THEN COALESCE(te.duration_minutes, 0)
+                 ELSE 0 END
+          )::numeric / 60, 2),
+          0
+        )                                                          AS night_hours,
+        COALESCE((
+          SELECT SUM(m.miles)
+          FROM mileage m
+          WHERE m.caregiver_id = u.id
+            AND m.date >= $1 AND m.date <= $2
+        ), 0)                                                      AS total_miles,
+        COALESCE((
+          SELECT SUM(p.hours)
+          FROM pto p
+          WHERE p.caregiver_id = u.id
+            AND p.start_date >= $1 AND p.end_date <= $2
+            AND p.status = 'approved' AND p.type != 'unpaid'
+        ), 0)                                                      AS pto_hours,
+        COALESCE(pr.status, 'draft')                               AS status,
+        pr.check_number
+      FROM users u
+      LEFT JOIN time_entries te
+        ON te.caregiver_id = u.id
+        AND DATE(te.start_time) >= $1::date
+        AND DATE(te.start_time) <= $2::date
+        AND te.is_complete = true
+      LEFT JOIN payroll_records pr
+        ON pr.caregiver_id = u.id
+        AND pr.period_start = $1 AND pr.period_end = $2
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      GROUP BY u.id, u.first_name, u.last_name, u.hourly_rate, pr.status, pr.check_number
+      HAVING
+        COALESCE(SUM(COALESCE(te.duration_minutes, 0)), 0) > 0
+        OR COALESCE((
+          SELECT SUM(p.hours) FROM pto p
+          WHERE p.caregiver_id = u.id
+            AND p.start_date >= $1 AND p.end_date <= $2
+            AND p.status = 'approved'
+        ), 0) > 0
+      ORDER BY u.last_name, u.first_name
+    `, [startDate, endDate, process.env.DEFAULT_HOURLY_RATE || 15]);
+
+    res.json({ payrollData: result.rows, status: 'calculated' });
+  } catch (error) {
+    console.error('Payroll calculate error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== PAYROLL APPROVE ====================
+// POST /api/payroll/:caregiverId/approve
+
+router.post('/:caregiverId/approve', auth, async (req, res) => {
+  const { caregiverId } = req.params;
+  const { startDate, endDate } = req.body;
+
+  try {
+    await db.query(`
+      INSERT INTO payroll_records (caregiver_id, period_start, period_end, status, approved_by, approved_at)
+      VALUES ($1, $2, $3, 'approved', $4, NOW())
+      ON CONFLICT (caregiver_id, period_start, period_end)
+      DO UPDATE SET status = 'approved', approved_by = $4, approved_at = NOW()
+    `, [caregiverId, startDate, endDate, req.user.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    console.error('Payroll approve error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== PAYROLL PROCESS ====================
+// POST /api/payroll/:caregiverId/process
+
+router.post('/:caregiverId/process', auth, async (req, res) => {
+  const { caregiverId } = req.params;
+
+  try {
+    const checkResult = await db.query(`
+      SELECT COALESCE(MAX(check_number), 1000) + 1 AS next_check
+      FROM payroll_records WHERE check_number IS NOT NULL
+    `);
+    const checkNumber = checkResult.rows[0].next_check;
+
+    await db.query(`
+      UPDATE payroll_records
+      SET status = 'processed', check_number = $1, processed_by = $2, processed_at = NOW()
+      WHERE caregiver_id = $3 AND status = 'approved'
+    `, [checkNumber, req.user.id, caregiverId]);
+
+    res.json({ success: true, checkNumber });
+  } catch (error) {
+    console.error('Payroll process error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== MILEAGE ====================
+// GET /api/payroll/mileage
+
+router.get('/mileage', auth, async (req, res) => {
+  const { caregiverId, startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT m.*, u.first_name, u.last_name
+      FROM mileage m
+      JOIN users u ON m.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (caregiverId) { params.push(caregiverId); query += ` AND m.caregiver_id = $${params.length}`; }
+    if (startDate)   { params.push(startDate);   query += ` AND m.date >= $${params.length}`; }
+    if (endDate)     { params.push(endDate);     query += ` AND m.date <= $${params.length}`; }
+
+    query += ` ORDER BY m.date DESC`;
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/payroll/mileage
+
+router.post('/mileage', auth, async (req, res) => {
+  const { caregiverId, date, miles, fromLocation, toLocation, notes } = req.body;
+  try {
+    const result = await db.query(`
+      INSERT INTO mileage (caregiver_id, date, miles, from_location, to_location, notes, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING *
+    `, [caregiverId, date, miles, fromLocation, toLocation, notes, req.user.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== PTO ====================
+// GET /api/payroll/pto
+
+router.get('/pto', auth, async (req, res) => {
+  const { caregiverId, startDate, endDate } = req.query;
+  try {
+    let query = `
+      SELECT p.*, u.first_name, u.last_name
+      FROM pto p
+      JOIN users u ON p.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (caregiverId) { params.push(caregiverId); query += ` AND p.caregiver_id = $${params.length}`; }
+    if (startDate)   { params.push(startDate);   query += ` AND p.start_date >= $${params.length}`; }
+    if (endDate)     { params.push(endDate);     query += ` AND p.end_date <= $${params.length}`; }
+
+    query += ` ORDER BY p.start_date DESC`;
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/payroll/pto
+
+router.post('/pto', auth, async (req, res) => {
+  const { caregiverId, type, startDate, endDate, hours, notes } = req.body;
+  try {
+    const result = await db.query(`
+      INSERT INTO pto (caregiver_id, type, start_date, end_date, hours, notes, status, created_by)
+      VALUES ($1, $2, $3, $4, $5, $6, 'approved', $7) RETURNING *
+    `, [caregiverId, type, startDate, endDate, hours, notes, req.user.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== CSV EXPORT ====================
+// POST /api/payroll/export
+
+router.post('/export', auth, async (req, res) => {
+  const { startDate, endDate, format, payrollData } = req.body;
+
+  try {
+    if (format === 'quickbooks') {
+      // QuickBooks IIF format
+      let iif = `!TIMEACT\tDATE\tJOB\tEMP\tITEM\tDURATION\tNOTE\n`;
+      for (const p of (payrollData || [])) {
+        iif += `TIMEACT\t${startDate}\t\t${p.first_name} ${p.last_name}\tRegular\t${p.regular_hours || 0}\tPayroll ${startDate} to ${endDate}\n`;
+        if (parseFloat(p.overtime_hours) > 0) {
+          iif += `TIMEACT\t${startDate}\t\t${p.first_name} ${p.last_name}\tOvertime\t${p.overtime_hours}\tOvertime\n`;
+        }
+      }
+      res.setHeader('Content-Type', 'application/octet-stream');
+      res.setHeader('Content-Disposition', `attachment; filename=quickbooks-payroll-${startDate}.iif`);
+      return res.send(iif);
+    }
+
+    // Default: CSV
+    const result = await db.query(`
+      SELECT
+        u.first_name, u.last_name,
+        COALESCE(u.hourly_rate, $3::numeric) AS hourly_rate,
+        ROUND(COALESCE(SUM(COALESCE(te.duration_minutes, 0))::numeric / 60, 0), 2) AS total_hours
+      FROM users u
+      LEFT JOIN time_entries te
+        ON te.caregiver_id = u.id
+        AND DATE(te.start_time) >= $1::date
+        AND DATE(te.start_time) <= $2::date
+        AND te.is_complete = true
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      GROUP BY u.id, u.first_name, u.last_name, u.hourly_rate
+      HAVING COALESCE(SUM(COALESCE(te.duration_minutes, 0)), 0) > 0
+      ORDER BY u.last_name
+    `, [startDate, endDate, process.env.DEFAULT_HOURLY_RATE || 15]);
+
+    const headers = ['First Name', 'Last Name', 'Hourly Rate', 'Total Hours', 'Gross Pay'];
+    const rows = result.rows.map(r => [
+      r.first_name, r.last_name, r.hourly_rate, r.total_hours,
+      (parseFloat(r.hourly_rate) * parseFloat(r.total_hours)).toFixed(2)
+    ]);
+
+    const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\n');
+    res.setHeader('Content-Type', 'text/csv');
+    res.setHeader('Content-Disposition', `attachment; filename=payroll-${startDate}-to-${endDate}.csv`);
+    res.send(csv);
+  } catch (error) {
+    console.error('Payroll export error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Keep old /export/quickbooks endpoint for backward compat
+router.post('/export/quickbooks', auth, async (req, res) => {
+  req.body.format = 'quickbooks';
+  // Re-use the export handler logic inline
+  const { startDate, endDate, payrollData } = req.body;
+  let iif = `!TIMEACT\tDATE\tJOB\tEMP\tITEM\tDURATION\tNOTE\n`;
+  for (const p of (payrollData || [])) {
+    iif += `TIMEACT\t${startDate}\t\t${p.first_name} ${p.last_name}\tRegular\t${p.regular_hours || 0}\tPayroll ${startDate} to ${endDate}\n`;
+    if (parseFloat(p.overtime_hours) > 0) {
+      iif += `TIMEACT\t${startDate}\t\t${p.first_name} ${p.last_name}\tOvertime\t${p.overtime_hours}\tOvertime\n`;
+    }
+  }
+  res.setHeader('Content-Type', 'application/octet-stream');
+  res.setHeader('Content-Disposition', `attachment; filename=quickbooks-payroll-${startDate}.iif`);
+  res.send(iif);
+});
+
+module.exports = router;
+
+// ==================== PAYROLL CRUD (migrated from miscRoutes) ====================
+// These were shadowed by miscRoutes — now live here exclusively
+
+const { v4: uuidv4 } = require('uuid');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// POST /api/payroll/run
+router.post('/run', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { payPeriodStart, payPeriodEnd } = req.body;
+    if (!payPeriodStart || !payPeriodEnd) return res.status(400).json({ error: 'payPeriodStart and payPeriodEnd are required' });
+    const payrollId = uuidv4();
+    const payrollNumber = `PR-${Date.now()}`;
+    const timeEntriesResult = await db.query(
+      `SELECT te.*, u.first_name, u.last_name, cr.base_hourly_rate FROM time_entries te
+       JOIN users u ON te.caregiver_id = u.id LEFT JOIN caregiver_rates cr ON te.caregiver_id = cr.caregiver_id
+       WHERE te.start_time >= $1 AND te.start_time <= $2 AND te.duration_minutes > 0 ORDER BY te.caregiver_id`,
+      [payPeriodStart, payPeriodEnd]
+    );
+    const caregiverPayroll = {};
+    let totalGrossPay = 0;
+    for (const entry of timeEntriesResult.rows) {
+      if (!caregiverPayroll[entry.caregiver_id]) {
+        caregiverPayroll[entry.caregiver_id] = { caregiverId: entry.caregiver_id, caregiverName: `${entry.first_name} ${entry.last_name}`, totalHours: 0, hourlyRate: entry.base_hourly_rate || 18.50, grossPay: 0, lineItems: [] };
+      }
+      caregiverPayroll[entry.caregiver_id].totalHours += parseFloat(entry.billable_minutes || entry.duration_minutes || 0) / 60;
+    }
+    const lineItems = [];
+    for (const caregiverId in caregiverPayroll) {
+      const p = caregiverPayroll[caregiverId];
+      p.grossPay = (p.totalHours * p.hourlyRate).toFixed(2);
+      totalGrossPay += parseFloat(p.grossPay);
+      lineItems.push({ caregiverId, description: `Hours: ${p.totalHours.toFixed(2)} × $${p.hourlyRate.toFixed(2)}/hr`, totalHours: p.totalHours.toFixed(2), hourlyRate: p.hourlyRate, grossAmount: p.grossPay });
+    }
+    const totalTaxes = (totalGrossPay * 0.0765).toFixed(2);
+    const totalNetPay = (totalGrossPay - parseFloat(totalTaxes)).toFixed(2);
+    const payrollResult = await db.query(
+      `INSERT INTO payroll (id, payroll_number, pay_period_start, pay_period_end, total_hours, gross_pay, taxes, net_pay, status) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,'pending') RETURNING *`,
+      [payrollId, payrollNumber, payPeriodStart, payPeriodEnd, Object.values(caregiverPayroll).reduce((s, p) => s + p.totalHours, 0).toFixed(2), totalGrossPay, totalTaxes, totalNetPay]
+    );
+    for (const item of lineItems) {
+      await db.query(`INSERT INTO payroll_line_items (payroll_id, caregiver_id, description, total_hours, hourly_rate, gross_amount) VALUES ($1,$2,$3,$4,$5,$6)`, [payrollId, item.caregiverId, item.description, item.totalHours, item.hourlyRate, item.grossAmount]);
+    }
+    await auditLog(req.user.id, 'CREATE', 'payroll', payrollId, null, payrollResult.rows[0]);
+    res.status(201).json({ ...payrollResult.rows[0], lineItems, caregiverCount: lineItems.length });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll/summary
+router.get('/summary', auth, async (req, res) => {
+  try {
+    const [summary, caregiverStats] = await Promise.all([
+      db.query(`SELECT COUNT(DISTINCT id) as total_payrolls, COUNT(DISTINCT CASE WHEN status='pending' THEN id END) as pending_payrolls, COUNT(DISTINCT CASE WHEN status='processed' THEN id END) as processed_payrolls, COUNT(DISTINCT CASE WHEN status='paid' THEN id END) as paid_payrolls, SUM(gross_pay) as total_gross_pay, SUM(taxes) as total_taxes, SUM(net_pay) as total_net_pay, AVG(total_hours) as average_hours_per_payroll, MAX(pay_period_end) as latest_payroll_date FROM payroll`),
+      db.query(`SELECT u.id, u.first_name, u.last_name, COUNT(pli.id) as payroll_count, SUM(pli.total_hours) as total_hours_paid, SUM(pli.gross_amount) as total_earned FROM users u LEFT JOIN payroll_line_items pli ON u.id = pli.caregiver_id WHERE u.role = 'caregiver' GROUP BY u.id, u.first_name, u.last_name ORDER BY total_earned DESC NULLS LAST`),
+    ]);
+    res.json({ summary: summary.rows[0], caregiverStats: caregiverStats.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll/caregiver/:caregiverId
+router.get('/caregiver/:caregiverId', auth, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT pli.*, p.payroll_number, p.pay_period_start, p.pay_period_end, p.status FROM payroll_line_items pli JOIN payroll p ON pli.payroll_id = p.id WHERE pli.caregiver_id = $1 ORDER BY p.pay_period_end DESC`, [req.params.caregiverId])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll/periods
+router.get('/periods', auth, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT DISTINCT pay_period_start, pay_period_end FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll/discrepancies
+router.get('/discrepancies', auth, async (req, res) => {
+  try {
+    const { startDate, endDate, minDiscrepancy = 5 } = req.query;
+    const start = startDate || new Date(Date.now() - 30 * 86400000).toISOString().split('T')[0];
+    const end = endDate || new Date().toISOString().split('T')[0];
+    const result = await db.query(`
+      SELECT te.id, te.start_time, te.end_time, te.duration_minutes, te.allotted_minutes, te.billable_minutes,
+        ROUND(te.duration_minutes::numeric/60,2) as actual_hours,
+        ROUND(COALESCE(te.allotted_minutes,te.duration_minutes)::numeric/60,2) as allotted_hours,
+        ROUND(te.billable_minutes::numeric/60,2) as billable_hours,
+        ROUND((te.duration_minutes-COALESCE(te.allotted_minutes,te.duration_minutes))::numeric/60,2) as discrepancy_hours,
+        u.first_name as caregiver_first, u.last_name as caregiver_last, u.default_pay_rate,
+        ROUND(te.billable_minutes::numeric/60*u.default_pay_rate,2) as billable_pay,
+        ROUND(te.duration_minutes::numeric/60*u.default_pay_rate,2) as actual_pay,
+        ROUND((te.duration_minutes-COALESCE(te.allotted_minutes,te.duration_minutes))::numeric/60*u.default_pay_rate,2) as overage_cost,
+        c.first_name as client_first, c.last_name as client_last
+      FROM time_entries te JOIN users u ON te.caregiver_id=u.id JOIN clients c ON te.client_id=c.id
+      WHERE te.is_complete=true AND te.start_time>=$1::date AND te.start_time<$2::date+INTERVAL '1 day'
+        AND te.allotted_minutes IS NOT NULL AND ABS(COALESCE(te.duration_minutes-te.allotted_minutes,0))>=$3
+      ORDER BY ABS(COALESCE(te.duration_minutes-te.allotted_minutes,0)) DESC
+    `, [start, end, parseInt(minDiscrepancy)]);
+    const totals = result.rows.reduce((acc, r) => {
+      acc.totalShifts++;
+      acc.totalActualHours += parseFloat(r.actual_hours || 0);
+      acc.totalAllottedHours += parseFloat(r.allotted_hours || 0);
+      acc.totalBillableHours += parseFloat(r.billable_hours || 0);
+      acc.totalOverageCost += parseFloat(r.overage_cost || 0);
+      if (parseFloat(r.discrepancy_hours) > 0) acc.overageCount++;
+      if (parseFloat(r.discrepancy_hours) < 0) acc.underageCount++;
+      return acc;
+    }, { totalShifts: 0, totalActualHours: 0, totalAllottedHours: 0, totalBillableHours: 0, totalOverageCost: 0, overageCount: 0, underageCount: 0 });
+    res.json({ discrepancies: result.rows, totals, period: { start, end } });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll (list all)
+router.get('/', auth, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/payroll/:payrollId
+router.get('/:payrollId', auth, async (req, res) => {
+  try {
+    const payrollResult = await db.query(`SELECT * FROM payroll WHERE id = $1`, [req.params.payrollId]);
+    if (payrollResult.rows.length === 0) return res.status(404).json({ error: 'Payroll not found' });
+    const lineItemsResult = await db.query(`SELECT pli.*, u.first_name, u.last_name FROM payroll_line_items pli JOIN users u ON pli.caregiver_id = u.id WHERE pli.payroll_id = $1 ORDER BY u.first_name, u.last_name`, [req.params.payrollId]);
+    res.json({ ...payrollResult.rows[0], lineItems: lineItemsResult.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PATCH /api/payroll/:payrollId/status
+router.patch('/:payrollId/status', auth, async (req, res) => {
+  try {
+    const { status, processedDate, paymentMethod } = req.body;
+    if (!status) return res.status(400).json({ error: 'status is required' });
+    const result = await db.query(
+      `UPDATE payroll SET status=$1, processed_date=CASE WHEN $1='processed' THEN COALESCE($2,NOW()) ELSE processed_date END, payment_method=COALESCE($3,payment_method), updated_at=NOW() WHERE id=$4 RETURNING *`,
+      [status, processedDate, paymentMethod, req.params.payrollId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Payroll not found' });
+    await auditLog(req.user.id, 'UPDATE', 'payroll', req.params.payrollId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
diff --git a/templates/crm-homecare/backend/src/routes/pricingRoutes.js b/templates/crm-homecare/backend/src/routes/pricingRoutes.js
new file mode 100644
index 0000000..c77da80
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/pricingRoutes.js
@@ -0,0 +1,236 @@
+// routes/pricingRoutes.js — mounted at /api via app.use('/api', pricingRoutes)
+// Covers: service pricing, care types, caregiver care type rates, caregiver rates, caregiver profiles
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── SERVICE PRICING ─────────────────────────────────────────────────────────
+
+router.get('/service-pricing/margins', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT id, service_name, client_hourly_rate, caregiver_hourly_rate,
+        (client_hourly_rate-caregiver_hourly_rate) as margin_per_hour,
+        ROUND((((client_hourly_rate-caregiver_hourly_rate)/client_hourly_rate)*100)::numeric,1) as margin_percentage
+       FROM service_pricing WHERE is_active=true ORDER BY margin_per_hour DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/service-pricing', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM service_pricing WHERE is_active=true ORDER BY service_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/service-pricing', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceName, description, clientHourlyRate, caregiverHourlyRate } = req.body;
+    if (!serviceName || !clientHourlyRate || !caregiverHourlyRate) return res.status(400).json({ error: 'serviceName, clientHourlyRate, and caregiverHourlyRate are required' });
+    const serviceId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO service_pricing (id, service_name, description, client_hourly_rate, caregiver_hourly_rate) VALUES ($1,$2,$3,$4,$5) RETURNING *`,
+      [serviceId, serviceName, description||null, clientHourlyRate, caregiverHourlyRate]
+    );
+    await auditLog(req.user.id, 'CREATE', 'service_pricing', serviceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/service-pricing/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { serviceName, description, clientHourlyRate, caregiverHourlyRate } = req.body;
+    const result = await db.query(
+      `UPDATE service_pricing SET service_name=COALESCE($1,service_name), description=COALESCE($2,description),
+        client_hourly_rate=COALESCE($3,client_hourly_rate), caregiver_hourly_rate=COALESCE($4,caregiver_hourly_rate), updated_at=NOW()
+       WHERE id=$5 RETURNING *`,
+      [serviceName, description, clientHourlyRate, caregiverHourlyRate, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Service not found' });
+    await auditLog(req.user.id, 'UPDATE', 'service_pricing', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/service-pricing/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE service_pricing SET is_active=false, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Service not found' });
+    await auditLog(req.user.id, 'DELETE', 'service_pricing', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Service deactivated' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CARE TYPES ──────────────────────────────────────────────────────────────
+
+router.get('/care-types', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM care_types WHERE is_active=true ORDER BY name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/care-types', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, description } = req.body;
+    const id = uuidv4();
+    const result = await db.query(`INSERT INTO care_types (id, name, description) VALUES ($1,$2,$3) RETURNING *`, [id, name, description]);
+    await auditLog(req.user.id, 'CREATE', 'care_types', id, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/care-types/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, description } = req.body;
+    const result = await db.query(`UPDATE care_types SET name=$1, description=$2, updated_at=NOW() WHERE id=$3 RETURNING *`, [name, description, req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Care type not found' });
+    await auditLog(req.user.id, 'UPDATE', 'care_types', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER CARE TYPE RATES ────────────────────────────────────────────────
+
+router.get('/caregiver-care-type-rates', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId } = req.query;
+    let query = `SELECT cctr.*, u.first_name as caregiver_first_name, u.last_name as caregiver_last_name, ct.name as care_type_name
+      FROM caregiver_care_type_rates cctr JOIN users u ON cctr.caregiver_id=u.id JOIN care_types ct ON cctr.care_type_id=ct.id
+      WHERE cctr.is_active=true AND (cctr.end_date IS NULL OR cctr.end_date>=CURRENT_DATE)`;
+    const params = [];
+    if (caregiverId) { params.push(caregiverId); query += ` AND cctr.caregiver_id=$${params.length}`; }
+    query += ` ORDER BY u.last_name, ct.name`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/caregiver-care-type-rates', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, careTypeId, hourlyRate } = req.body;
+    const id = uuidv4();
+    await db.query(`UPDATE caregiver_care_type_rates SET is_active=false, end_date=CURRENT_DATE, updated_at=NOW() WHERE caregiver_id=$1 AND care_type_id=$2 AND is_active=true`, [caregiverId, careTypeId]);
+    const result = await db.query(`INSERT INTO caregiver_care_type_rates (id, caregiver_id, care_type_id, hourly_rate) VALUES ($1,$2,$3,$4) RETURNING *`, [id, caregiverId, careTypeId, hourlyRate]);
+    await auditLog(req.user.id, 'CREATE', 'caregiver_care_type_rates', id, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-care-type-rates/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE caregiver_care_type_rates SET hourly_rate=$1, updated_at=NOW() WHERE id=$2 RETURNING *`, [req.body.hourlyRate, req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Rate not found' });
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_care_type_rates', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/caregiver-care-type-rates/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`UPDATE caregiver_care_type_rates SET is_active=false, end_date=CURRENT_DATE, updated_at=NOW() WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Rate not found' });
+    await auditLog(req.user.id, 'DELETE', 'caregiver_care_type_rates', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Rate ended' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER RATES ─────────────────────────────────────────────────────────
+
+router.get('/caregiver-rates/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM caregiver_rates WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO caregiver_rates (caregiver_id, base_hourly_rate) VALUES ($1, $2)`, [req.params.caregiverId, 18.50]);
+      result = await db.query(`SELECT * FROM caregiver_rates WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-rates/:caregiverId', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { baseHourlyRate, overtimeRate, premiumRate } = req.body;
+    const result = await db.query(
+      `UPDATE caregiver_rates SET base_hourly_rate=COALESCE($1,base_hourly_rate), overtime_rate=COALESCE($2,overtime_rate), premium_rate=COALESCE($3,premium_rate), updated_at=NOW() WHERE caregiver_id=$4 RETURNING *`,
+      [baseHourlyRate, overtimeRate, premiumRate, req.params.caregiverId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver rate not found' });
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_rates', req.params.caregiverId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── CAREGIVER PROFILES ───────────────────────────────────────────────────────
+
+router.get('/caregiver-profile/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    let result = await db.query(`SELECT * FROM caregiver_profiles WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    if (result.rows.length === 0) {
+      await db.query(`INSERT INTO caregiver_profiles (caregiver_id) VALUES ($1)`, [req.params.caregiverId]);
+      result = await db.query(`SELECT * FROM caregiver_profiles WHERE caregiver_id=$1`, [req.params.caregiverId]);
+    }
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/caregiver-profile/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const { notes, capabilities, limitations, preferredHours, availableMon, availableTue, availableWed, availableThu, availableFri, availableSat, availableSun } = req.body;
+    const result = await db.query(
+      `UPDATE caregiver_profiles SET notes=COALESCE($1,notes), capabilities=COALESCE($2,capabilities), limitations=COALESCE($3,limitations),
+        preferred_hours=COALESCE($4,preferred_hours), available_mon=COALESCE($5,available_mon), available_tue=COALESCE($6,available_tue),
+        available_wed=COALESCE($7,available_wed), available_thu=COALESCE($8,available_thu), available_fri=COALESCE($9,available_fri),
+        available_sat=COALESCE($10,available_sat), available_sun=COALESCE($11,available_sun), updated_at=NOW()
+       WHERE caregiver_id=$12 RETURNING *`,
+      [notes, capabilities, limitations, preferredHours, availableMon, availableTue, availableWed, availableThu, availableFri, availableSat, availableSun, req.params.caregiverId]
+    );
+    await auditLog(req.user.id, 'UPDATE', 'caregiver_profiles', req.params.caregiverId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ─── USER ADMIN ───────────────────────────────────────────────────────────────
+
+router.get('/users', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { role } = req.query;
+    let query = `SELECT id, email, first_name, last_name, phone, role, is_active, hire_date, default_pay_rate FROM users WHERE 1=1`;
+    const params = [];
+    if (role) { params.push(role); query += ` AND role=$${params.length}`; }
+    query += ` ORDER BY first_name, last_name`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/caregivers', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT id, email, first_name, last_name, phone, hire_date, is_active, certifications, role, default_pay_rate FROM users WHERE role='caregiver' ORDER BY first_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/caregivers/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM users WHERE id=$1 AND role='caregiver'`, [req.params.caregiverId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/users/admins', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT id, email, first_name, last_name, phone, hire_date, is_active, role FROM users WHERE role='admin' ORDER BY first_name`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/users/convert-to-admin', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { userId } = req.body;
+    const result = await db.query(`UPDATE users SET role='admin', updated_at=NOW() WHERE id=$1 RETURNING *`, [userId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'User not found' });
+    await auditLog(req.user.id, 'UPDATE', 'users', userId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/prospectRoutes.js b/templates/crm-homecare/backend/src/routes/prospectRoutes.js
new file mode 100644
index 0000000..754b7fd
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/prospectRoutes.js
@@ -0,0 +1,111 @@
+// routes/prospectRoutes.js — mounted at /api via app.use('/api', prospectRoutes)
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── PROSPECTS ───────────────────────────────────────────────────────────────
+
+router.get('/prospects', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM prospects WHERE status != 'inactive' ORDER BY created_at DESC`);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospects', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, phone, email, address, city, state, notes, source } = req.body;
+    if (!firstName || !lastName) return res.status(400).json({ error: 'First and last name required' });
+    const result = await db.query(
+      `INSERT INTO prospects (first_name, last_name, phone, email, address, city, state, notes, source) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *`,
+      [firstName, lastName, phone||null, email||null, address||null, city||null, state||process.env.AGENCY_STATE||null, notes||null, source||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/prospects/:id', verifyToken, async (req, res) => {
+  try {
+    const { firstName, lastName, phone, email, address, city, state, notes, source, status } = req.body;
+    const result = await db.query(
+      `UPDATE prospects SET first_name=COALESCE($1,first_name), last_name=COALESCE($2,last_name),
+        phone=$3, email=$4, address=$5, city=$6, state=COALESCE($7,state), notes=$8, source=$9,
+        status=COALESCE($10,status), updated_at=NOW() WHERE id=$11 RETURNING *`,
+      [firstName, lastName, phone, email, address, city, state, notes, source, status, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Prospect not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/prospects/:id', verifyToken, async (req, res) => {
+  try {
+    await db.query(`UPDATE prospects SET status='inactive' WHERE id=$1`, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospects/:id/convert', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const prospect = await db.query(`SELECT * FROM prospects WHERE id=$1`, [req.params.id]);
+    if (prospect.rows.length === 0) return res.status(404).json({ error: 'Prospect not found' });
+    const p = prospect.rows[0];
+    const clientResult = await db.query(
+      `INSERT INTO clients (first_name, last_name, phone, email, address, city, state, status) VALUES ($1,$2,$3,$4,$5,$6,$7,'active') RETURNING *`,
+      [p.first_name, p.last_name, p.phone, p.email, p.address, p.city, p.state]
+    );
+    await db.query(`UPDATE prospects SET status='converted', converted_client_id=$1, updated_at=NOW() WHERE id=$2`, [clientResult.rows[0].id, req.params.id]);
+    res.json({ client: clientResult.rows[0], message: 'Prospect converted to client' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/prospect-appointments', verifyToken, async (req, res) => {
+  try {
+    const { month, year } = req.query;
+    let query = `SELECT pa.*, p.first_name as prospect_first_name, p.last_name as prospect_last_name,
+      u.first_name as caregiver_first_name, u.last_name as caregiver_last_name
+      FROM prospect_appointments pa JOIN prospects p ON pa.prospect_id=p.id LEFT JOIN users u ON pa.caregiver_id=u.id
+      WHERE pa.status != 'cancelled'`;
+    const params = [];
+    if (month && year) { query += ` AND EXTRACT(MONTH FROM pa.appointment_date)=$1 AND EXTRACT(YEAR FROM pa.appointment_date)=$2`; params.push(month, year); }
+    query += ` ORDER BY pa.appointment_date, pa.start_time`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/prospect-appointments', verifyToken, async (req, res) => {
+  try {
+    const { prospectId, caregiverId, appointmentDate, startTime, endTime, appointmentType, location, notes } = req.body;
+    if (!prospectId || !appointmentDate || !startTime || !endTime) return res.status(400).json({ error: 'Prospect, date, and times required' });
+    const result = await db.query(
+      `INSERT INTO prospect_appointments (prospect_id, caregiver_id, appointment_date, start_time, end_time, appointment_type, location, notes) VALUES ($1,$2,$3,$4,$5,$6,$7,$8) RETURNING *`,
+      [prospectId, caregiverId||null, appointmentDate, startTime, endTime, appointmentType||'assessment', location||null, notes||null]
+    );
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/prospect-appointments/:id', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, appointmentDate, startTime, endTime, appointmentType, location, notes, status } = req.body;
+    const result = await db.query(
+      `UPDATE prospect_appointments SET caregiver_id=$1, appointment_date=COALESCE($2,appointment_date),
+        start_time=COALESCE($3,start_time), end_time=COALESCE($4,end_time),
+        appointment_type=COALESCE($5,appointment_type), location=$6, notes=$7, status=COALESCE($8,status)
+       WHERE id=$9 RETURNING *`,
+      [caregiverId||null, appointmentDate, startTime, endTime, appointmentType, location||null, notes||null, status, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Appointment not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/prospect-appointments/:id', verifyToken, async (req, res) => {
+  try {
+    await db.query(`UPDATE prospect_appointments SET status='cancelled' WHERE id=$1`, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/pushNotificationRoutes.js b/templates/crm-homecare/backend/src/routes/pushNotificationRoutes.js
new file mode 100644
index 0000000..508c758
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/pushNotificationRoutes.js
@@ -0,0 +1,205 @@
+// src/routes/pushNotificationRoutes.js - Web push notification system
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+let webpush;
+try { webpush = require('web-push'); } catch (e) {
+  console.warn('[Push] web-push not installed — push notifications disabled.');
+  webpush = null;
+}
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+
+// Configure web-push with VAPID keys
+// Generate once with: npx web-push generate-vapid-keys
+const VAPID_PUBLIC_KEY = process.env.VAPID_PUBLIC_KEY || 'PLACEHOLDER_REPLACE_WITH_REAL_KEY';
+const VAPID_PRIVATE_KEY = process.env.VAPID_PRIVATE_KEY || 'PLACEHOLDER_REPLACE_WITH_REAL_KEY';
+
+if (webpush && VAPID_PUBLIC_KEY !== 'PLACEHOLDER_REPLACE_WITH_REAL_KEY') {
+  webpush.setVapidDetails(
+    'mailto:admin@chippewahomecare.com',
+    VAPID_PUBLIC_KEY,
+    VAPID_PRIVATE_KEY
+  );
+}
+
+// Helper: send push to a user
+const sendPushToUser = async (userId, payload) => {
+  try {
+    const subs = await db.query(
+      `SELECT subscription FROM push_subscriptions WHERE user_id = $1 AND is_active = true`,
+      [userId]
+    );
+
+    for (const row of subs.rows) {
+      try {
+        if (!webpush) throw new Error('web-push not available');
+        await webpush.sendNotification(
+          row.subscription,
+          JSON.stringify(payload)
+        );
+      } catch (e) {
+        if (e.statusCode === 410 || e.statusCode === 404) {
+          // Subscription expired — deactivate it
+          await db.query(
+            `UPDATE push_subscriptions SET is_active = false WHERE user_id = $1 AND subscription = $2`,
+            [userId, row.subscription]
+          );
+        }
+      }
+    }
+  } catch (error) {
+    console.error('[PUSH] sendPushToUser error:', error.message);
+  }
+};
+
+// GET /api/push/vapid-key - Return public key for client subscription setup
+router.get('/vapid-key', (req, res) => {
+  res.json({ publicKey: VAPID_PUBLIC_KEY });
+});
+
+// POST /api/push/subscribe - Register a push subscription
+router.post('/subscribe', auth, async (req, res) => {
+  try {
+    const { subscription } = req.body;
+    if (!subscription) return res.status(400).json({ error: 'subscription is required' });
+
+    const subStr = JSON.stringify(subscription);
+
+    // Upsert subscription
+    await db.query(`
+      INSERT INTO push_subscriptions (id, user_id, subscription, is_active, created_at)
+      VALUES ($1, $2, $3, true, NOW())
+      ON CONFLICT (user_id, subscription) DO UPDATE SET is_active = true, updated_at = NOW()`,
+      [uuidv4(), req.user.id, subStr]
+    );
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/push/unsubscribe - Remove a push subscription
+router.post('/unsubscribe', auth, async (req, res) => {
+  try {
+    const { subscription } = req.body;
+    const subStr = JSON.stringify(subscription);
+    
+    await db.query(
+      `UPDATE push_subscriptions SET is_active = false WHERE user_id = $1 AND subscription = $2`,
+      [req.user.id, subStr]
+    );
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/push/send-clock-in-confirm - Called by clock-in endpoint
+router.post('/send-clock-in-confirm', auth, async (req, res) => {
+  try {
+    const { caregiverId, clientName, startTime, timeEntryId } = req.body;
+
+    const payload = {
+      title: '✅ Clocked In',
+      body: `You are clocked in${clientName ? ` for ${clientName}` : ''}. Started at ${startTime}.`,
+      icon: '/icon-192.png',
+      badge: '/badge-72.png',
+      tag: `clock-in-${timeEntryId}`,
+      data: { type: 'clock_in', timeEntryId },
+    };
+
+    await sendPushToUser(caregiverId, payload);
+
+    // Also store in-app notification
+    await db.query(`
+      INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+      VALUES ($1, $2, 'clock_in_confirm', 'Clocked In', $3, true, NOW())`,
+      [uuidv4(), caregiverId, payload.body]
+    );
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/push/send-clock-out-confirm - Called by clock-out endpoint
+router.post('/send-clock-out-confirm', auth, async (req, res) => {
+  try {
+    const { caregiverId, clientName, duration, totalHours } = req.body;
+
+    const payload = {
+      title: '🕐 Clocked Out',
+      body: `Shift complete${clientName ? ` — ${clientName}` : ''}. Duration: ${duration}. Total today: ${totalHours}h.`,
+      icon: '/icon-192.png',
+      badge: '/badge-72.png',
+      tag: `clock-out-${Date.now()}`,
+      data: { type: 'clock_out' },
+    };
+
+    await sendPushToUser(caregiverId, payload);
+
+    await db.query(`
+      INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+      VALUES ($1, $2, 'clock_out_confirm', 'Clocked Out', $3, true, NOW())`,
+      [uuidv4(), caregiverId, payload.body]
+    );
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/push/send-to-caregiver - Admin sends custom notification
+router.post('/send-to-caregiver', auth, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, title, message, type = 'admin_message' } = req.body;
+
+    await sendPushToUser(caregiverId, { title, body: message, icon: '/icon-192.png', tag: type });
+
+    await db.query(`
+      INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+      VALUES ($1, $2, $3, $4, $5, false, NOW())`,
+      [uuidv4(), caregiverId, type, title, message]
+    );
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// GET /api/push/unread-count - Get unread notification count for user
+router.get('/unread-count', auth, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT COUNT(*) as count FROM notifications WHERE user_id = $1 AND is_read = false`,
+      [req.user.id]
+    );
+    res.json({ count: parseInt(result.rows[0].count) });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/push/mark-read - Mark notifications as read
+router.post('/mark-read', auth, async (req, res) => {
+  try {
+    const { ids } = req.body; // array of notification ids, or 'all'
+    if (ids === 'all') {
+      await db.query(`UPDATE notifications SET is_read = true WHERE user_id = $1`, [req.user.id]);
+    } else if (Array.isArray(ids)) {
+      await db.query(`UPDATE notifications SET is_read = true WHERE user_id = $1 AND id = ANY($2)`, [req.user.id, ids]);
+    }
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = { router, sendPushToUser };
diff --git a/templates/crm-homecare/backend/src/routes/referralRoutes.js b/templates/crm-homecare/backend/src/routes/referralRoutes.js
new file mode 100644
index 0000000..bc2f67d
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/referralRoutes.js
@@ -0,0 +1,71 @@
+// routes/referralRoutes.js — mounted at /api via app.use('/api', referralRoutes)
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+// ─── REFERRAL SOURCES ───────────────────────────────────────────────────────
+
+router.get('/referral-sources', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT rs.*, COUNT(c.id) as referral_count FROM referral_sources rs
+       LEFT JOIN clients c ON rs.id = c.referred_by AND c.is_active = true
+       WHERE rs.is_active = true GROUP BY rs.id ORDER BY referral_count DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/referral-sources', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, type, contactName, email, phone, address, city, state, zip } = req.body;
+    if (!name || !type) return res.status(400).json({ error: 'Name and type are required' });
+    const sourceId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO referral_sources (id, name, type, contact_name, email, phone, address, city, state, zip, created_by)
+       VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11) RETURNING *`,
+      [sourceId, name, type, contactName||null, email||null, phone||null, address||null, city||null, state||process.env.AGENCY_STATE||null, zip||null, req.user.id]
+    );
+    await auditLog(req.user.id, 'CREATE', 'referral_sources', sourceId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.put('/referral-sources/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { name, type, contactName, email, phone, address, city, state, zip } = req.body;
+    const result = await db.query(
+      `UPDATE referral_sources SET name=COALESCE($1,name), type=COALESCE($2,type), contact_name=COALESCE($3,contact_name),
+        email=COALESCE($4,email), phone=COALESCE($5,phone), address=COALESCE($6,address),
+        city=COALESCE($7,city), state=COALESCE($8,state), zip=COALESCE($9,zip), updated_at=NOW()
+       WHERE id=$10 RETURNING *`,
+      [name, type, contactName, email, phone, address, city, state, zip, req.params.id]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Referral source not found' });
+    await auditLog(req.user.id, 'UPDATE', 'referral_sources', req.params.id, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.delete('/referral-sources/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`DELETE FROM referral_sources WHERE id=$1 RETURNING *`, [req.params.id]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Referral source not found' });
+    await auditLog(req.user.id, 'DELETE', 'referral_sources', req.params.id, null, result.rows[0]);
+    res.json({ message: 'Referral source deleted' });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/referral-sources/stats', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const [totalResult, byTypeResult, topSources] = await Promise.all([
+      db.query(`SELECT COUNT(*) as total FROM referral_sources`),
+      db.query(`SELECT type, COUNT(*) as count FROM referral_sources GROUP BY type ORDER BY count DESC`),
+      db.query(`SELECT rs.id, rs.name, COUNT(c.id) as client_count FROM referral_sources rs LEFT JOIN clients c ON rs.id = c.referral_source_id WHERE c.id IS NOT NULL GROUP BY rs.id, rs.name ORDER BY client_count DESC`),
+    ]);
+    res.json({ total: totalResult.rows[0].total, byType: byTypeResult.rows, topSources: topSources.rows });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/remittanceRoutes.js b/templates/crm-homecare/backend/src/routes/remittanceRoutes.js
new file mode 100644
index 0000000..1951530
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/remittanceRoutes.js
@@ -0,0 +1,151 @@
+// routes/remittanceRoutes.js - Remittance management with free OCR
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+const multer = require('multer');
+const fs = require('fs');
+
+const upload = multer({
+  dest: '/tmp/remittance-uploads/',
+  limits: { fileSize: 10 * 1024 * 1024 },
+  fileFilter: (req, file, cb) => {
+    cb(null, ['image/jpeg','image/png','image/webp','application/pdf'].includes(file.mimetype));
+  }
+});
+
+async function extractText(filePath) {
+  try {
+    const Tesseract = require('tesseract.js');
+    const { data: { text } } = await Tesseract.recognize(filePath, 'eng', { logger: () => {} });
+    return text || '';
+  } catch (e) { return ''; }
+}
+
+function parseRemittance(text) {
+  const result = { checkNumber: null, checkDate: null, payerName: null, totalAmount: null, lineItems: [] };
+  if (!text) return result;
+  for (const p of [/CHECK\s*(?:NO\.?|#)?\s*[:\-]?\s*(\d{4,10})/i, /CHK\s*#?\s*(\d{4,10})/i]) {
+    const m = text.match(p); if (m) { result.checkNumber = m[1]; break; }
+  }
+  for (const p of [/(?:DATE|CHECK DATE)\s*[:\-]?\s*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/i, /(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/]) {
+    const m = text.match(p);
+    if (m) { const d = new Date(m[1]); if (!isNaN(d)) { result.checkDate = d.toISOString().split('T')[0]; break; } }
+  }
+  for (const p of [/(?:TOTAL|NET PAYMENT|CHECK AMOUNT)\s*[:\-\$]?\s*\$?\s*([\d,]+\.\d{2})/i, /\*+\s*\$?\s*([\d,]+\.\d{2})\s*\*+/]) {
+    const m = text.match(p);
+    if (m) { const a = parseFloat(m[1].replace(/,/g,'')); if (a > 0) { result.totalAmount = a; break; } }
+  }
+  const known = [
+    {p:/forwardhealth|forward health|dhs/i, n:'Wisconsin ForwardHealth (Medicaid)'},
+    {p:/my choice wisconsin/i, n:'My Choice Wisconsin'},{p:/inclusa/i, n:'Inclusa'},
+    {p:/lakeland care/i, n:'Lakeland Care'},{p:/molina/i, n:'Molina Healthcare of Wisconsin'},
+    {p:/veterans affairs|\bva\b/i, n:'Veterans Affairs (VA)'},{p:/medicare/i, n:'Medicare'},
+  ];
+  for (const k of known) { if (k.p.test(text)) { result.payerName = k.n; break; } }
+  if (!result.payerName) result.payerName = text.split('\n').find(l=>l.trim())?.slice(0,80)||null;
+  let m;
+  const lp = /(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}).*?\$?\s*([\d,]+\.\d{2})\s+\$?\s*([\d,]+\.\d{2})/g;
+  while ((m = lp.exec(text)) !== null) {
+    const paid = parseFloat(m[3].replace(/,/g,'')); if (paid>0) result.lineItems.push({serviceDate:m[1],billedAmount:parseFloat(m[2].replace(/,/g,'')),paidAmount:paid});
+  }
+  return result;
+}
+
+router.post('/upload', auth, requireAdmin, upload.single('remittance'), async (req, res) => {
+  try {
+    if (!req.file) return res.status(400).json({ error: 'No file uploaded' });
+    const text = await extractText(req.file.path);
+    try { fs.unlinkSync(req.file.path); } catch(e) {}
+    const parsed = parseRemittance(text);
+    let suggestedPayer = null;
+    if (parsed.payerName) {
+      const word = parsed.payerName.toLowerCase().split(' ')[0];
+      const match = await db.query(`SELECT id,name,payer_type FROM referral_sources WHERE LOWER(name) LIKE $1 LIMIT 1`,[`%${word}%`]);
+      if (match.rows.length) suggestedPayer = match.rows[0];
+    }
+    res.json({ ocr: parsed, suggestedPayer, confidence: {checkNumber:!!parsed.checkNumber,date:!!parsed.checkDate,amount:!!parsed.totalAmount,payer:!!parsed.payerName,lineItems:parsed.lineItems.length} });
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/batch', auth, requireAdmin, async (req, res) => {
+  try {
+    const { payerId, payerName, payerType, checkNumber, checkDate, paymentDate, totalAmount, notes, lineItems, rawOcrText } = req.body;
+    if (!totalAmount || !payerName) return res.status(400).json({ error: 'Payer name and total amount required' });
+    const batchId = uuidv4();
+    const batch = await db.query(`
+      INSERT INTO remittance_batches (id,payer_id,payer_name,payer_type,check_number,check_date,payment_date,total_amount,raw_ocr_text,notes,created_by)
+      VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11) RETURNING *
+    `,[batchId,payerId||null,payerName,payerType||'other',checkNumber||null,checkDate||null,paymentDate||new Date().toISOString().split('T')[0],totalAmount,rawOcrText||null,notes||null,req.user.id]);
+    let matchedCount = 0;
+    for (const item of (lineItems||[])) {
+      let matchedInvoiceId=item.invoiceId||null, matchedClientId=item.clientId||null, matchedClaimId=item.claimId||null, matchStatus='unmatched';
+      if (!matchedInvoiceId && matchedClientId && item.serviceDate) {
+        const inv = await db.query(`SELECT id FROM invoices WHERE client_id=$1 AND billing_period_start<=$2::date AND billing_period_end>=$2::date AND payment_status!='paid' ORDER BY created_at DESC LIMIT 1`,[matchedClientId,item.serviceDate]);
+        if (inv.rows.length) { matchedInvoiceId=inv.rows[0].id; matchStatus='matched'; }
+      }
+      if (!matchedClaimId && item.claimNumber) {
+        const clm = await db.query(`SELECT id FROM claims WHERE claim_number=$1 LIMIT 1`,[item.claimNumber]);
+        if (clm.rows.length) { matchedClaimId=clm.rows[0].id; matchStatus='matched'; }
+      }
+      if (matchStatus==='matched') matchedCount++;
+      await db.query(`INSERT INTO remittance_line_items (id,batch_id,client_id,invoice_id,claim_id,claim_number,service_date_from,service_date_to,billed_amount,paid_amount,adjustment_amount,denial_code,denial_reason,match_status,matched_at) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15)`,
+        [uuidv4(),batchId,matchedClientId,matchedInvoiceId,matchedClaimId,item.claimNumber||null,item.serviceDateFrom||item.serviceDate||null,item.serviceDateTo||null,item.billedAmount||null,item.paidAmount,item.adjustmentAmount||0,item.denialCode||null,item.denialReason||null,matchStatus,matchStatus==='matched'?new Date():null]);
+      if (matchedInvoiceId && item.paidAmount>0) {
+        try {
+          await db.query(`INSERT INTO invoice_payments (invoice_id,amount,payment_date,payment_method,reference_number,notes) VALUES ($1,$2,$3,'check',$4,$5)`,[matchedInvoiceId,item.paidAmount,paymentDate||new Date(),checkNumber,`Remittance ${batchId.slice(0,8)}`]);
+          await db.query(`UPDATE invoices SET amount_paid=COALESCE(amount_paid,0)+$1, payment_status=CASE WHEN COALESCE(amount_paid,0)+$1>=total THEN 'paid' WHEN COALESCE(amount_paid,0)+$1>0 THEN 'partial' ELSE 'pending' END WHERE id=$2`,[item.paidAmount,matchedInvoiceId]);
+        } catch(e) {}
+      }
+      if (matchedClaimId && item.paidAmount!=null) {
+        await db.query(`UPDATE claims SET paid_amount=$1,paid_date=$2,status=CASE WHEN $1>0 THEN 'paid' ELSE 'denied' END,denial_code=$3,denial_reason=$4 WHERE id=$5`,[item.paidAmount,paymentDate||new Date(),item.denialCode||null,item.denialReason||null,matchedClaimId]);
+      }
+    }
+    const total=(lineItems||[]).length;
+    await db.query(`UPDATE remittance_batches SET status=$1 WHERE id=$2`,[total===0?'pending_match':matchedCount===total?'matched':matchedCount>0?'partial':'unmatched',batchId]);
+    res.json({ batch:batch.rows[0], matchedCount, totalItems:total });
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/batches', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT rb.*,rs.name as payer_display_name,COUNT(rli.id) as line_item_count FROM remittance_batches rb LEFT JOIN referral_sources rs ON rb.payer_id=rs.id LEFT JOIN remittance_line_items rli ON rb.id=rli.batch_id GROUP BY rb.id,rs.name ORDER BY rb.payment_date DESC LIMIT 50`);
+    res.json(result.rows);
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payer-summary', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT rs.id as payer_id, rs.name as payer_name, rs.payer_type,
+        COUNT(DISTINCT i.id) as total_invoices,
+        COALESCE(SUM(i.total),0) as total_billed,
+        COALESCE(SUM(i.amount_paid),0) as total_paid,
+        COALESCE(SUM(i.total)-SUM(COALESCE(i.amount_paid,0)),0) as total_outstanding,
+        COALESCE(SUM(CASE WHEN i.payment_status='pending' AND i.payment_due_date<CURRENT_DATE-90 THEN i.total-COALESCE(i.amount_paid,0) END),0) as over_90_days,
+        COALESCE(SUM(CASE WHEN i.payment_status='pending' AND i.payment_due_date BETWEEN CURRENT_DATE-90 AND CURRENT_DATE-60 THEN i.total-COALESCE(i.amount_paid,0) END),0) as days_61_90,
+        COALESCE(SUM(CASE WHEN i.payment_status='pending' AND i.payment_due_date BETWEEN CURRENT_DATE-60 AND CURRENT_DATE-30 THEN i.total-COALESCE(i.amount_paid,0) END),0) as days_31_60,
+        COALESCE(SUM(CASE WHEN i.payment_status='pending' AND i.payment_due_date>CURRENT_DATE-30 THEN i.total-COALESCE(i.amount_paid,0) END),0) as days_0_30,
+        MAX(rb.payment_date) as last_payment_date, COALESCE(SUM(rb.total_amount),0) as total_received
+      FROM referral_sources rs
+      LEFT JOIN clients c ON c.referral_source_id=rs.id
+      LEFT JOIN invoices i ON i.client_id=c.id
+      LEFT JOIN remittance_batches rb ON rb.payer_id=rs.id
+      WHERE rs.is_active_payer=true
+      GROUP BY rs.id,rs.name,rs.payer_type
+      ORDER BY total_outstanding DESC
+    `);
+    res.json(result.rows);
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+router.get('/payers', auth, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT id,name,payer_type,edi_payer_id,expected_pay_days FROM referral_sources WHERE is_active_payer=true ORDER BY name ASC`);
+    res.json(result.rows);
+  } catch(error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/reports.js b/templates/crm-homecare/backend/src/routes/reports.js
index 0c82dcd..5513875 100644
--- a/templates/crm-homecare/backend/src/routes/reports.js
+++ b/templates/crm-homecare/backend/src/routes/reports.js
@@ -1,117 +1,25 @@
 import { Router } from 'express';
-import { prisma } from '../index.js';
 import { authenticate, requireAdmin } from '../middleware/auth.js';
 
 const router = Router();
-router.use(authenticate, requireAdmin);
 
-// Hours by caregiver
-router.get('/hours-by-caregiver', async (req, res, next) => {
-  try {
-    const { startDate, endDate } = req.query;
-    const where = { isComplete: true };
-    if (startDate || endDate) {
-      where.startTime = {};
-      if (startDate) where.startTime.gte = new Date(startDate);
-      if (endDate) where.startTime.lte = new Date(endDate);
-    }
-    const entries = await prisma.timeEntry.groupBy({
-      by: ['caregiverId'],
-      where,
-      _sum: { billableMinutes: true, durationMinutes: true },
-      _count: true,
-    });
+// TODO: Convert from raw SQL to Prisma queries
+// Original CVHC reports.js has full implementation
 
-    const caregivers = await prisma.user.findMany({
-      where: { id: { in: entries.map(e => e.caregiverId) } },
-      select: { id: true, firstName: true, lastName: true, defaultPayRate: true },
-    });
-
-    const result = entries.map(e => {
-      const cg = caregivers.find(c => c.id === e.caregiverId);
-      const hours = (e._sum.billableMinutes || e._sum.durationMinutes || 0) / 60;
-      return { caregiver: cg, totalHours: Number(hours.toFixed(2)), visits: e._count, estimatedPay: Number((hours * Number(cg?.defaultPayRate || 15)).toFixed(2)) };
-    });
-
-    res.json(result);
-  } catch (err) { next(err); }
-});
-
-// Revenue by period
-router.get('/revenue', async (req, res, next) => {
-  try {
-    const { startDate, endDate } = req.query;
-    const where = {};
-    if (startDate || endDate) {
-      where.billingPeriodStart = {};
-      if (startDate) where.billingPeriodStart.gte = new Date(startDate);
-      if (endDate) where.billingPeriodStart.lte = new Date(endDate);
-    }
-    const summary = await prisma.invoice.aggregate({
-      where,
-      _sum: { total: true, subtotal: true },
-      _count: true,
-    });
-    const byStatus = await prisma.invoice.groupBy({ by: ['paymentStatus'], where, _sum: { total: true }, _count: true });
-    res.json({ summary, byStatus });
-  } catch (err) { next(err); }
-});
-
-// Client census
-router.get('/census', async (req, res, next) => {
-  try {
-    const byService = await prisma.client.groupBy({ by: ['serviceType'], where: { isActive: true }, _count: true });
-    const total = await prisma.client.count({ where: { isActive: true } });
-    const newThisMonth = await prisma.client.count({
-      where: { startDate: { gte: new Date(new Date().getFullYear(), new Date().getMonth(), 1) } },
-    });
-    res.json({ total, newThisMonth, byServiceType: byService });
-  } catch (err) { next(err); }
+router.get('/summary', authenticate, async (req, res) => {
+  res.json({ message: 'Reports coming soon', data: {} });
 });
 
-// Payer mix
-router.get('/payer-mix', async (req, res, next) => {
-  try {
-    const mix = await prisma.client.groupBy({
-      by: ['insuranceProvider'],
-      where: { isActive: true },
-      _count: true,
-    });
-    res.json(mix.sort((a, b) => b._count - a._count));
-  } catch (err) { next(err); }
+router.get('/hours', authenticate, async (req, res) => {
+  res.json({ data: [] });
 });
 
-// Revenue forecast
-router.get('/forecast', async (req, res, next) => {
-  try {
-    const activeAuths = await prisma.authorization.findMany({
-      where: { status: 'active', endDate: { gte: new Date() } },
-      include: { client: { select: { firstName: true, lastName: true } } },
-    });
-    const forecast = activeAuths.map(a => {
-      const remainingUnits = Number(a.authorizedUnits) - Number(a.usedUnits);
-      return { clientName: `${a.client.firstName} ${a.client.lastName}`, remainingUnits, endDate: a.endDate, procedureCode: a.procedureCode };
-    });
-    res.json({ activeAuthorizationsCount: activeAuths.length, forecast });
-  } catch (err) { next(err); }
+router.get('/billing', authenticate, requireAdmin, async (req, res) => {
+  res.json({ data: [] });
 });
 
-// No-show rate
-router.get('/noshow-rate', async (req, res, next) => {
-  try {
-    const { startDate, endDate } = req.query;
-    const where = {};
-    if (startDate || endDate) {
-      where.date = {};
-      if (startDate) where.date.gte = new Date(startDate);
-      if (endDate) where.date.lte = new Date(endDate);
-    }
-    const [total, noShows] = await Promise.all([
-      prisma.timeEntry.count({ where: { isComplete: true, ...where.date ? { startTime: where.date } : {} } }),
-      prisma.absence.count({ where: { type: 'no_show', ...where } }),
-    ]);
-    res.json({ totalShifts: total, noShows, rate: total > 0 ? Number((noShows / total * 100).toFixed(1)) : 0 });
-  } catch (err) { next(err); }
+router.get('/payroll', authenticate, requireAdmin, async (req, res) => {
+  res.json({ data: [] });
 });
 
 export default router;
diff --git a/templates/crm-homecare/backend/src/routes/rosterOptimizerRoutes.js b/templates/crm-homecare/backend/src/routes/rosterOptimizerRoutes.js
new file mode 100644
index 0000000..4fb3664
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/rosterOptimizerRoutes.js
@@ -0,0 +1,420 @@
+// routes/rosterOptimizerRoutes.js
+// Full-Roster Schedule Optimizer
+// Loads ALL active caregivers and clients, builds an optimized schedule
+// across the entire workforce. Nothing writes to live schedules until
+// the admin explicitly clicks "Apply."
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── GET FULL ROSTER ─────────────────────────────────────────────────────────
+// Returns all active caregivers (with their current weekly hours) and
+// all active clients (with their required hours/week from assignments or authorizations)
+router.get('/roster', async (req, res) => {
+  try {
+    // All active caregivers with their max hours & current scheduled hours
+    const cgRes = await db.query(`
+      SELECT
+        u.id,
+        u.first_name,
+        u.last_name,
+        u.phone,
+        u.hire_date,
+        COALESCE(cs.max_hours_per_week, 40) AS max_hours_per_week,
+        -- Sum of hours from existing recurring schedules this week
+        COALESCE((
+          SELECT ROUND(SUM(
+            EXTRACT(EPOCH FROM (end_time::time - start_time::time)) / 3600
+          )::numeric, 2)
+          FROM schedules
+          WHERE caregiver_id = u.id
+            AND is_active = true
+            AND schedule_type = 'recurring'
+            AND day_of_week IS NOT NULL
+        ), 0) AS current_weekly_hours,
+        -- Number of active clients assigned
+        COALESCE((
+          SELECT COUNT(*)
+          FROM client_assignments
+          WHERE caregiver_id = u.id AND status = 'active'
+        ), 0) AS active_client_count
+      FROM users u
+      LEFT JOIN (
+        SELECT caregiver_id, MAX(max_hours_per_week) AS max_hours_per_week
+        FROM caregiver_schedules
+        GROUP BY caregiver_id
+      ) cs ON cs.caregiver_id = u.id
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      ORDER BY u.first_name, u.last_name
+    `);
+
+    // All active clients with their required hours/week
+    const clRes = await db.query(`
+      SELECT
+        c.id,
+        c.first_name,
+        c.last_name,
+        c.service_type,
+        c.address,
+        c.city,
+        c.preferred_caregivers,
+        c.do_not_use_caregivers,
+        -- Hours from active assignment
+        COALESCE((
+          SELECT hours_per_week FROM client_assignments
+          WHERE client_id = c.id AND status = 'active'
+          ORDER BY assignment_date DESC LIMIT 1
+        ), 0) AS assigned_hours_per_week,
+        -- Days already scheduled (recurring)
+        COALESCE((
+          SELECT ARRAY_AGG(DISTINCT day_of_week ORDER BY day_of_week)
+          FROM schedules
+          WHERE client_id = c.id AND is_active = true
+            AND schedule_type = 'recurring' AND day_of_week IS NOT NULL
+        ), '{}') AS scheduled_days,
+        -- Current caregiver(s)
+        COALESCE((
+          SELECT ARRAY_AGG(DISTINCT caregiver_id)
+          FROM client_assignments
+          WHERE client_id = c.id AND status = 'active'
+        ), '{}') AS current_caregivers
+      FROM clients c
+      WHERE c.is_active = true
+      ORDER BY c.last_name, c.first_name
+    `);
+
+    res.json({
+      caregivers: cgRes.rows,
+      clients: clRes.rows,
+    });
+  } catch (err) {
+    console.error('Roster fetch error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── RUN FULL ROSTER OPTIMIZATION ────────────────────────────────────────────
+// Input: array of caregivers [{id, targetHours}] and clients [{id, hoursPerWeek, visitsPerWeek}]
+// Reads existing live schedules as context, generates proposals in sandbox only.
+router.post('/run', async (req, res) => {
+  try {
+    const { caregivers: inputCaregivers, clients: inputClients } = req.body;
+
+    if (!inputCaregivers?.length || !inputClients?.length) {
+      return res.status(400).json({ error: 'Need at least one caregiver and one client' });
+    }
+
+    const cgIds = inputCaregivers.map(c => c.id);
+    const clIds = inputClients.map(c => c.id);
+
+    // ── Load full caregiver data ──────────────────────────────────────────
+    const cgDataRes = await db.query(
+      `SELECT id, first_name, last_name FROM users WHERE id = ANY($1)`,
+      [cgIds]
+    );
+    const cgMap = {};
+    cgDataRes.rows.forEach(r => { cgMap[r.id] = r; });
+
+    // ── Load full client data ─────────────────────────────────────────────
+    const clDataRes = await db.query(
+      `SELECT id, first_name, last_name, preferred_caregivers, do_not_use_caregivers
+       FROM clients WHERE id = ANY($1)`,
+      [clIds]
+    );
+    const clMap = {};
+    clDataRes.rows.forEach(r => { clMap[r.id] = r; });
+
+    // ── Load all existing recurring schedules for these caregivers ────────
+    const existingRes = await db.query(
+      `SELECT s.id, s.caregiver_id, s.client_id, s.day_of_week,
+              s.start_time::text AS start_time, s.end_time::text AS end_time,
+              u.first_name AS cg_first, u.last_name AS cg_last,
+              c.first_name AS cl_first, c.last_name AS cl_last
+       FROM schedules s
+       JOIN users u ON s.caregiver_id = u.id
+       JOIN clients c ON s.client_id = c.id
+       WHERE s.caregiver_id = ANY($1)
+         AND s.is_active = true
+         AND s.schedule_type = 'recurring'
+         AND s.day_of_week IS NOT NULL
+       ORDER BY s.caregiver_id, s.day_of_week, s.start_time`,
+      [cgIds]
+    );
+    const existingSchedules = existingRes.rows;
+
+    // ── Build per-caregiver slot map (day → booked windows) ──────────────
+    const cgSlotMap = {};
+    cgIds.forEach(id => {
+      cgSlotMap[id] = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] };
+    });
+    existingSchedules.forEach(s => {
+      if (cgSlotMap[s.caregiver_id] && s.day_of_week !== null) {
+        cgSlotMap[s.caregiver_id][s.day_of_week].push({
+          start: normalizeTime(s.start_time),
+          end: normalizeTime(s.end_time),
+          clientId: s.client_id,
+          clientName: `${s.cl_first} ${s.cl_last}`,
+          scheduleId: s.id,
+          isExisting: true,
+        });
+      }
+    });
+
+    // ── Caregiver remaining capacity ──────────────────────────────────────
+    const cgRemaining = {};
+    inputCaregivers.forEach(cg => {
+      const existingHrs = existingSchedules
+        .filter(s => s.caregiver_id === cg.id)
+        .reduce((sum, s) => sum + (toHours(normalizeTime(s.end_time)) - toHours(normalizeTime(s.start_time))), 0);
+      cgRemaining[cg.id] = Math.max(0, parseFloat(cg.targetHours) - existingHrs);
+    });
+
+    // ── Algorithm ─────────────────────────────────────────────────────────
+    const proposals = [];
+    const unscheduled = [];
+    const DAY_NAMES = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
+    const WEEKDAY_ORDER = [1, 3, 2, 4, 5, 0, 6]; // Mon, Wed, Tue, Thu, Fri, Sun, Sat
+
+    for (const clInput of inputClients) {
+      const { id: clId, hoursPerWeek, visitsPerWeek } = clInput;
+      const clInfo = clMap[clId];
+      if (!clInfo) continue;
+
+      const hrsPerVisit = parseFloat((hoursPerWeek / visitsPerWeek).toFixed(2));
+      const visitMins = Math.round(hrsPerVisit * 60);
+
+      // Days this client is already scheduled on
+      const existingClientDays = new Set(
+        existingSchedules.filter(s => s.client_id === clId).map(s => s.day_of_week)
+      );
+      const placedDays = new Set(existingClientDays);
+      let visitsPlaced = 0;
+
+      // Score and rank caregivers for this client
+      const ranked = inputCaregivers
+        .map(cg => {
+          const isBlocked = Array.isArray(clInfo.do_not_use_caregivers) &&
+            clInfo.do_not_use_caregivers.includes(cg.id);
+          const isPreferred = Array.isArray(clInfo.preferred_caregivers) &&
+            clInfo.preferred_caregivers.includes(cg.id);
+          const alreadySees = existingSchedules.some(
+            s => s.caregiver_id === cg.id && s.client_id === clId
+          );
+          return {
+            ...cg,
+            isBlocked,
+            score: isBlocked ? -999 :
+              (isPreferred ? 20 : 0) +
+              (alreadySees ? 10 : 0) +
+              (cgRemaining[cg.id] > 0 ? 5 : 0),
+          };
+        })
+        .filter(cg => !cg.isBlocked)
+        .sort((a, b) => b.score - a.score);
+
+      for (let v = 0; v < visitsPerWeek; v++) {
+        let placed = false;
+
+        for (const day of WEEKDAY_ORDER) {
+          if (placedDays.has(day)) continue;
+
+          for (const cg of ranked) {
+            if (cgRemaining[cg.id] < hrsPerVisit - 0.01) continue;
+
+            const daySlots = cgSlotMap[cg.id][day];
+            const startTime = findSlot(daySlots, visitMins);
+            if (!startTime) continue;
+
+            const endTime = addMins(startTime, visitMins);
+
+            const conflicts = daySlots
+              .filter(s => s.isExisting && overlaps(startTime, endTime, s.start, s.end))
+              .map(s => ({ clientName: s.clientName, start: s.start, end: s.end }));
+
+            const proposal = {
+              id: uuidv4(),
+              clientId: clId,
+              clientName: `${clInfo.first_name} ${clInfo.last_name}`,
+              caregiverId: cg.id,
+              caregiverName: `${cgMap[cg.id]?.first_name || ''} ${cgMap[cg.id]?.last_name || ''}`.trim(),
+              dayOfWeek: day,
+              dayName: DAY_NAMES[day],
+              startTime,
+              endTime,
+              hoursPerVisit: hrsPerVisit,
+              hasConflict: conflicts.length > 0,
+              conflictsWith: conflicts,
+            };
+
+            proposals.push(proposal);
+
+            // Reserve this slot in memory so future assignments avoid it
+            cgSlotMap[cg.id][day].push({
+              start: startTime,
+              end: endTime,
+              clientId: clId,
+              clientName: `${clInfo.first_name} ${clInfo.last_name}`,
+              isExisting: false,
+            });
+
+            cgRemaining[cg.id] -= hrsPerVisit;
+            placedDays.add(day);
+            visitsPlaced++;
+            placed = true;
+            break;
+          }
+          if (placed) break;
+        }
+
+        if (!placed) {
+          const topCg = ranked[0];
+          unscheduled.push({
+            clientId: clId,
+            clientName: `${clInfo.first_name} ${clInfo.last_name}`,
+            visitNumber: v + 1,
+            reason: topCg && cgRemaining[topCg.id] < hrsPerVisit
+              ? 'All caregivers at hour capacity'
+              : 'No available time slot found for any caregiver',
+          });
+        }
+      }
+    }
+
+    // ── Build summary ─────────────────────────────────────────────────────
+    const cgSummary = inputCaregivers.map(cg => {
+      const info = cgMap[cg.id] || {};
+      const existingHrs = existingSchedules
+        .filter(s => s.caregiver_id === cg.id)
+        .reduce((sum, s) => sum + (toHours(normalizeTime(s.end_time)) - toHours(normalizeTime(s.start_time))), 0);
+      const proposedHrs = proposals
+        .filter(p => p.caregiverId === cg.id)
+        .reduce((sum, p) => sum + p.hoursPerVisit, 0);
+      return {
+        id: cg.id,
+        name: `${info.first_name || ''} ${info.last_name || ''}`.trim(),
+        targetHours: parseFloat(cg.targetHours),
+        existingHours: parseFloat(existingHrs.toFixed(2)),
+        proposedNewHours: parseFloat(proposedHrs.toFixed(2)),
+        totalHours: parseFloat((existingHrs + proposedHrs).toFixed(2)),
+        remainingCapacity: parseFloat(cgRemaining[cg.id].toFixed(2)),
+        utilizationPct: parseFloat(cg.targetHours) > 0
+          ? Math.min(100, Math.round(((existingHrs + proposedHrs) / parseFloat(cg.targetHours)) * 100))
+          : 0,
+      };
+    });
+
+    const clSummary = inputClients.map(cl => {
+      const info = clMap[cl.id] || {};
+      const placed = proposals.filter(p => p.clientId === cl.id).length;
+      return {
+        id: cl.id,
+        name: `${info.first_name || ''} ${info.last_name || ''}`.trim(),
+        visitsNeeded: cl.visitsPerWeek,
+        visitsPlaced: placed,
+        hoursPerWeek: cl.hoursPerWeek,
+        fullyScheduled: placed >= cl.visitsPerWeek,
+      };
+    });
+
+    res.json({
+      proposals,
+      existingSchedules: existingSchedules.map(s => ({
+        id: s.id,
+        caregiverId: s.caregiver_id,
+        caregiverName: `${s.cg_first} ${s.cg_last}`,
+        clientId: s.client_id,
+        clientName: `${s.cl_first} ${s.cl_last}`,
+        dayOfWeek: s.day_of_week,
+        startTime: normalizeTime(s.start_time),
+        endTime: normalizeTime(s.end_time),
+      })),
+      unscheduled,
+      summary: {
+        caregivers: cgSummary,
+        clients: clSummary,
+        totalProposals: proposals.length,
+        conflictCount: proposals.filter(p => p.hasConflict).length,
+        unscheduledCount: unscheduled.length,
+        fullyScheduledClients: clSummary.filter(c => c.fullyScheduled).length,
+        totalClients: clSummary.length,
+      },
+    });
+  } catch (err) {
+    console.error('Roster optimizer run error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── APPLY PROPOSALS → LIVE SCHEDULES ────────────────────────────────────────
+router.post('/apply', async (req, res) => {
+  try {
+    const { proposals } = req.body;
+    if (!proposals?.length) return res.status(400).json({ error: 'No proposals to apply' });
+
+    const created = [];
+    const errors = [];
+
+    for (const p of proposals) {
+      try {
+        const id = uuidv4();
+        await db.query(
+          `INSERT INTO schedules
+             (id, caregiver_id, client_id, schedule_type, day_of_week, start_time, end_time, notes, is_active)
+           VALUES ($1, $2, $3, 'recurring', $4, $5, $6, $7, true)`,
+          [id, p.caregiverId, p.clientId, p.dayOfWeek, p.startTime, p.endTime,
+           'Created by Roster Optimizer']
+        );
+        created.push(id);
+      } catch (err) {
+        errors.push({ proposal: p, error: err.message });
+      }
+    }
+
+    res.json({ success: true, created: created.length, errors: errors.length, errorDetails: errors });
+  } catch (err) {
+    console.error('Roster optimizer apply error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+// ─── HELPERS ─────────────────────────────────────────────────────────────────
+
+function normalizeTime(t) {
+  if (!t) return '08:00';
+  // Strip seconds if present e.g. "08:00:00" → "08:00"
+  return String(t).slice(0, 5);
+}
+
+function toHours(t) {
+  if (!t) return 0;
+  const [h, m] = t.split(':').map(Number);
+  return h + m / 60;
+}
+
+function addMins(t, mins) {
+  const [h, m] = t.split(':').map(Number);
+  const total = h * 60 + m + mins;
+  return `${String(Math.floor(total / 60) % 24).padStart(2, '0')}:${String(total % 60).padStart(2, '0')}`;
+}
+
+function overlaps(aS, aE, bS, bE) {
+  return aS < bE && aE > bS;
+}
+
+function findSlot(existingSlots, durationMins, windowStart = '08:00', windowEnd = '18:00') {
+  const sorted = [...existingSlots].sort((a, b) => a.start.localeCompare(b.start));
+  const candidates = [windowStart, ...sorted.map(s => s.end)];
+
+  for (const candidate of candidates) {
+    if (candidate >= windowEnd) break;
+    const end = addMins(candidate, durationMins);
+    if (end > windowEnd) break;
+    const conflict = sorted.some(s => overlaps(candidate, end, s.start, s.end));
+    if (!conflict) return candidate;
+  }
+  return null;
+}
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/routeOptimizerRoutes.js b/templates/crm-homecare/backend/src/routes/routeOptimizerRoutes.js
new file mode 100644
index 0000000..3661cc5
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/routeOptimizerRoutes.js
@@ -0,0 +1,1216 @@
+// routes/routeOptimizerRoutes.js
+// Route Optimization, Mileage Tracking, Hours Dashboard, GPS Geofence
+// Uses Google Routes API for real driving distances + Google Geocoding API
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+const jwt = require('jsonwebtoken');
+
+const GOOGLE_API_KEY = process.env.GOOGLE_MAPS_API_KEY;
+
+// ============================================================
+// Auth Middleware
+// ============================================================
+const verifyToken = (req, res, next) => {
+  const token = req.headers.authorization?.split(' ')[1];
+  if (!token) return res.status(401).json({ error: 'No token provided' });
+  try {
+    req.user = jwt.verify(token, process.env.JWT_SECRET);
+    if (!process.env.JWT_SECRET) throw new Error('JWT_SECRET not configured');
+    next();
+  } catch (error) {
+    return res.status(401).json({ error: 'Invalid token' });
+  }
+};
+
+const requireAdmin = (req, res, next) => {
+  if (req.user.role !== 'admin') return res.status(403).json({ error: 'Admin access required' });
+  next();
+};
+
+// ============================================================
+// Google API Helpers
+// ============================================================
+
+// Google Routes API: Get driving distance + duration between two points
+// Returns { distanceMiles, durationMinutes } or null on failure
+const googleRoute = async (originLat, originLng, destLat, destLng) => {
+  if (!GOOGLE_API_KEY) return null;
+  try {
+    const res = await fetch('https://routes.googleapis.com/directions/v2:computeRoutes', {
+      method: 'POST',
+      headers: {
+        'Content-Type': 'application/json',
+        'X-Goog-Api-Key': GOOGLE_API_KEY,
+        'X-Goog-FieldMask': 'routes.distanceMeters,routes.duration'
+      },
+      body: JSON.stringify({
+        origin: { location: { latLng: { latitude: originLat, longitude: originLng } } },
+        destination: { location: { latLng: { latitude: destLat, longitude: destLng } } },
+        travelMode: 'DRIVE',
+        routingPreference: 'TRAFFIC_UNAWARE', // Essentials tier = $5/1k requests
+        units: 'IMPERIAL'
+      })
+    });
+    const data = await res.json();
+    if (data.routes && data.routes.length > 0) {
+      const route = data.routes[0];
+      const meters = route.distanceMeters || 0;
+      const seconds = parseInt(route.duration?.replace('s', '')) || 0;
+      return {
+        distanceMiles: Math.round((meters / 1609.344) * 100) / 100,
+        durationMinutes: Math.round(seconds / 60)
+      };
+    }
+    return null;
+  } catch (e) {
+    console.error('Google Routes API error:', e.message);
+    return null;
+  }
+};
+
+// Google Routes API: Compute Route Matrix (multiple origins x destinations in 1 call)
+// Returns a map of "originIdx-destIdx" -> { distanceMiles, durationMinutes }
+const googleRouteMatrix = async (origins, destinations) => {
+  if (!GOOGLE_API_KEY) return null;
+  try {
+    const res = await fetch('https://routes.googleapis.com/distanceMatrix/v2:computeRouteMatrix', {
+      method: 'POST',
+      headers: {
+        'Content-Type': 'application/json',
+        'X-Goog-Api-Key': GOOGLE_API_KEY,
+        'X-Goog-FieldMask': 'originIndex,destinationIndex,distanceMeters,duration,status'
+      },
+      body: JSON.stringify({
+        origins: origins.map(o => ({
+          waypoint: { location: { latLng: { latitude: o.latitude, longitude: o.longitude } } }
+        })),
+        destinations: destinations.map(d => ({
+          waypoint: { location: { latLng: { latitude: d.latitude, longitude: d.longitude } } }
+        })),
+        travelMode: 'DRIVE',
+        routingPreference: 'TRAFFIC_UNAWARE'
+      })
+    });
+    const data = await res.json();
+    const matrix = {};
+    if (Array.isArray(data)) {
+      for (const entry of data) {
+        if (entry.status && entry.status.code && entry.status.code !== 0) continue;
+        const key = `${entry.originIndex}-${entry.destinationIndex}`;
+        const meters = entry.distanceMeters || 0;
+        const seconds = parseInt(entry.duration?.replace('s', '')) || 0;
+        matrix[key] = {
+          distanceMiles: Math.round((meters / 1609.344) * 100) / 100,
+          durationMinutes: Math.round(seconds / 60)
+        };
+      }
+    }
+    return Object.keys(matrix).length > 0 ? matrix : null;
+  } catch (e) {
+    console.error('Google Route Matrix API error:', e.message);
+    return null;
+  }
+};
+
+// Google Geocoding API: Convert address to lat/lng
+const googleGeocode = async (address) => {
+  if (!GOOGLE_API_KEY) return null;
+  try {
+    const encoded = encodeURIComponent(address);
+    const res = await fetch(
+      `https://maps.googleapis.com/maps/api/geocode/json?address=${encoded}&key=${GOOGLE_API_KEY}&components=country:US`
+    );
+    const data = await res.json();
+    if (data.status === 'OK' && data.results?.length > 0) {
+      const { lat, lng } = data.results[0].geometry.location;
+      return {
+        latitude: lat,
+        longitude: lng,
+        formattedAddress: data.results[0].formatted_address,
+        placeId: data.results[0].place_id
+      };
+    }
+    return null;
+  } catch (e) {
+    console.error('Google Geocoding error:', e.message);
+    return null;
+  }
+};
+
+// ============================================================
+// Fallback Helpers (when Google API key not configured)
+// ============================================================
+
+// Haversine distance in miles (straight-line fallback)
+const haversine = (lat1, lon1, lat2, lon2) => {
+  if (!lat1 || !lon1 || !lat2 || !lon2) return null;
+  const R = 3959;
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = Math.sin(dLat / 2) ** 2 +
+    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
+    Math.sin(dLon / 2) ** 2;
+  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
+};
+
+const estimateDriveMinutes = (miles) => {
+  if (!miles) return 0;
+  return Math.round(miles * 2); // ~30mph fallback
+};
+
+// Distance in feet between two coordinates
+const distanceFeet = (lat1, lon1, lat2, lon2) => {
+  const miles = haversine(lat1, lon1, lat2, lon2);
+  return miles ? miles * 5280 : null;
+};
+
+// Nearest-neighbor TSP with a distance matrix
+const solveRouteWithMatrix = (startIdx, distMatrix, nodeCount) => {
+  const visited = new Set([startIdx]);
+  const order = [];
+  let current = startIdx;
+
+  while (order.length < nodeCount - 1) {
+    let nearestIdx = -1;
+    let nearestDist = Infinity;
+
+    for (let i = 1; i < nodeCount; i++) {
+      if (visited.has(i)) continue;
+      const key = `${current}-${i}`;
+      const dist = distMatrix[key]?.distanceMiles ?? Infinity;
+      if (dist < nearestDist) {
+        nearestDist = dist;
+        nearestIdx = i;
+      }
+    }
+
+    if (nearestIdx === -1) break;
+    visited.add(nearestIdx);
+    
+    const key = `${current}-${nearestIdx}`;
+    const segment = distMatrix[key] || { distanceMiles: 0, durationMinutes: 0 };
+    
+    order.push({
+      stopIndex: nearestIdx - 1,
+      milesFromPrevious: segment.distanceMiles,
+      driveMinutesFromPrevious: segment.durationMinutes
+    });
+
+    current = nearestIdx;
+  }
+
+  return order;
+};
+
+// 2-opt improvement using distance matrix
+const improve2OptMatrix = (order, distMatrix) => {
+  if (order.length < 3) return order;
+  let improved = true;
+  let route = [...order];
+
+  while (improved) {
+    improved = false;
+    for (let i = 0; i < route.length - 1; i++) {
+      for (let j = i + 2; j < route.length; j++) {
+        const prevI = i === 0 ? 0 : route[i - 1].stopIndex + 1;
+        const iIdx = route[i].stopIndex + 1;
+        const jMinusIdx = route[j - 1].stopIndex + 1;
+        const jIdx = route[j].stopIndex + 1;
+
+        const currentDist =
+          (distMatrix[`${prevI}-${iIdx}`]?.distanceMiles || Infinity) +
+          (distMatrix[`${jMinusIdx}-${jIdx}`]?.distanceMiles || Infinity);
+
+        const newDist =
+          (distMatrix[`${prevI}-${jMinusIdx}`]?.distanceMiles || Infinity) +
+          (distMatrix[`${iIdx}-${jIdx}`]?.distanceMiles || Infinity);
+
+        if (newDist < currentDist) {
+          const reversed = route.slice(i, j).reverse();
+          route = [...route.slice(0, i), ...reversed, ...route.slice(j)];
+          improved = true;
+        }
+      }
+    }
+  }
+  return route;
+};
+
+// Audit log helper
+const auditLog = async (userId, action, tableName, recordId, oldData, newData) => {
+  try {
+    await db.query(
+      `INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data, created_at)
+       VALUES ($1, $2, $3, $4, $5, $6, NOW())`,
+      [userId, action, tableName, recordId, JSON.stringify(oldData), JSON.stringify(newData)]
+    );
+  } catch (e) { /* silent */ }
+};
+
+// Time helpers
+function timeToMinutes(timeStr) {
+  if (!timeStr) return 480;
+  const [h, m] = timeStr.split(':').map(Number);
+  return h * 60 + (m || 0);
+}
+function minutesToTime(minutes) {
+  const h = Math.floor(minutes / 60);
+  const m = minutes % 60;
+  return `${String(h).padStart(2, '0')}:${String(Math.round(m)).padStart(2, '0')}`;
+}
+
+// ============================================================
+// ROUTE 1: Optimize a route (Google Routes API for real road miles)
+// POST /api/route-optimizer/optimize
+// ============================================================
+router.post('/optimize', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, date, stops } = req.body;
+    const bufferMinutes = parseInt(req.body.bufferMinutes) || 0;
+    const mileageRate = parseFloat(req.body.mileageRate) || 0.67; // IRS 2024 rate
+    
+    if (!caregiverId || !date || !stops?.length) {
+      return res.status(400).json({ error: 'caregiverId, date, and stops[] required' });
+    }
+
+    // Get caregiver home location
+    const cgResult = await db.query(
+      `SELECT id, first_name, last_name, latitude, longitude, address, city, state, zip
+       FROM users WHERE id = $1 AND role = 'caregiver'`,
+      [caregiverId]
+    );
+    if (!cgResult.rows.length) return res.status(404).json({ error: 'Caregiver not found' });
+    const caregiver = cgResult.rows[0];
+
+    if (!caregiver.latitude || !caregiver.longitude) {
+      return res.status(400).json({ 
+        error: 'Caregiver has no home address geocoded. Please update their address first.',
+        field: 'caregiver_address'
+      });
+    }
+
+    // Get client details for all stops
+    const clientIds = stops.map(s => s.clientId);
+    const clientsResult = await db.query(
+      `SELECT id, first_name, last_name, latitude, longitude, address, city, state, zip, weekly_authorized_units
+       FROM clients WHERE id = ANY($1)`,
+      [clientIds]
+    );
+    const clientMap = {};
+    clientsResult.rows.forEach(c => { clientMap[c.id] = c; });
+
+    // Build stop list
+    const stopList = stops.map(s => {
+      const client = clientMap[s.clientId];
+      if (!client) return null;
+      return {
+        clientId: client.id,
+        clientName: `${client.first_name} ${client.last_name}`,
+        latitude: parseFloat(client.latitude),
+        longitude: parseFloat(client.longitude),
+        address: [client.address, client.city, client.state, client.zip].filter(Boolean).join(', '),
+        serviceUnits: s.serviceUnits || 0,
+        serviceMinutes: (s.serviceUnits || 0) * 15,
+        requestedStartTime: s.startTime || null,
+        requestedEndTime: s.endTime || null,
+        weeklyAuthorizedUnits: client.weekly_authorized_units || 0
+      };
+    }).filter(Boolean);
+
+    // Check for missing coordinates
+    const missingCoords = stopList.filter(s => !s.latitude || !s.longitude);
+    if (missingCoords.length > 0) {
+      return res.status(400).json({ 
+        error: 'Some clients are missing geocoded addresses',
+        missingClients: missingCoords.map(s => ({ clientId: s.clientId, name: s.clientName }))
+      });
+    }
+
+    // Build all nodes: index 0 = caregiver home, 1..N = stops
+    const allNodes = [
+      { latitude: parseFloat(caregiver.latitude), longitude: parseFloat(caregiver.longitude) },
+      ...stopList.map(s => ({ latitude: s.latitude, longitude: s.longitude }))
+    ];
+
+    // Build distance matrix
+    let distMatrix = {};
+    let usingGoogle = false;
+
+    // Try Google Route Matrix (1 API call for all pairs, billed per element)
+    if (GOOGLE_API_KEY && allNodes.length <= 26) {
+      console.log(`[RouteOptimizer] Calling Google Route Matrix: ${allNodes.length} nodes = ${allNodes.length * allNodes.length} elements`);
+      const googleMatrix = await googleRouteMatrix(allNodes, allNodes);
+      if (googleMatrix) {
+        distMatrix = googleMatrix;
+        usingGoogle = true;
+        console.log(`[RouteOptimizer] Google Matrix returned ${Object.keys(googleMatrix).length} entries`);
+      } else {
+        console.log('[RouteOptimizer] Google Matrix failed, falling back to Haversine');
+      }
+    }
+
+    // Haversine fallback
+    if (!usingGoogle) {
+      console.log(`[RouteOptimizer] Using Haversine fallback for ${allNodes.length} nodes`);
+      for (let i = 0; i < allNodes.length; i++) {
+        for (let j = 0; j < allNodes.length; j++) {
+          if (i === j) continue;
+          const miles = haversine(allNodes[i].latitude, allNodes[i].longitude,
+                                  allNodes[j].latitude, allNodes[j].longitude) || 0;
+          distMatrix[`${i}-${j}`] = {
+            distanceMiles: Math.round(miles * 100) / 100,
+            durationMinutes: estimateDriveMinutes(miles)
+          };
+        }
+      }
+    }
+
+    // Solve TSP
+    const rawOrder = solveRouteWithMatrix(0, distMatrix, allNodes.length);
+    const improvedOrder = improve2OptMatrix(rawOrder, distMatrix);
+    
+    // Recalculate totals with improved order
+    let totalMiles = 0;
+    let totalDriveMinutes = 0;
+    let prevIdx = 0;
+    const recalculated = improvedOrder.map(item => {
+      const matrixIdx = item.stopIndex + 1;
+      const key = `${prevIdx}-${matrixIdx}`;
+      const segment = distMatrix[key] || { distanceMiles: 0, durationMinutes: 0 };
+      totalMiles += segment.distanceMiles;
+      totalDriveMinutes += segment.durationMinutes;
+      prevIdx = matrixIdx;
+      return { ...item, milesFromPrevious: segment.distanceMiles, driveMinutesFromPrevious: segment.durationMinutes };
+    });
+    
+    // Return home
+    const returnKey = `${prevIdx}-0`;
+    const returnSegment = distMatrix[returnKey] || { distanceMiles: 0, durationMinutes: 0 };
+    totalMiles += returnSegment.distanceMiles;
+    totalDriveMinutes += returnSegment.durationMinutes;
+
+    // Build final stops with scheduled times
+    let totalServiceMinutes = 0;
+    let runningTime = req.body.startTime || '08:00';
+
+    const finalStops = recalculated.map((item, idx) => {
+      const stop = stopList[item.stopIndex];
+      totalServiceMinutes += stop.serviceMinutes;
+
+      const arrivalMinutes = timeToMinutes(runningTime) + item.driveMinutesFromPrevious + (idx > 0 ? bufferMinutes : 0);
+      const arrivalTime = minutesToTime(arrivalMinutes);
+      const departureMinutes = arrivalMinutes + stop.serviceMinutes;
+      const departureTime = minutesToTime(departureMinutes);
+      runningTime = departureTime;
+
+      return {
+        ...stop,
+        stopOrder: idx + 1,
+        milesFromPrevious: item.milesFromPrevious,
+        driveMinutesFromPrevious: item.driveMinutesFromPrevious,
+        calculatedArrival: arrivalTime,
+        calculatedDeparture: departureTime,
+        scheduledStartTime: stop.requestedStartTime || null,
+        scheduledEndTime: stop.requestedEndTime || null,
+      };
+    });
+
+    // Calculate pre-optimization metrics (original schedule order)
+    let preOptMiles = 0;
+    let preOptDriveMinutes = 0;
+    let preOptPrevIdx = 0;
+    for (let i = 0; i < stopList.length; i++) {
+      const matrixIdx = i + 1; // stopList is in original order, matrix index = stopList index + 1
+      const key = `${preOptPrevIdx}-${matrixIdx}`;
+      const seg = distMatrix[key] || { distanceMiles: 0, durationMinutes: 0 };
+      preOptMiles += seg.distanceMiles;
+      preOptDriveMinutes += seg.durationMinutes;
+      preOptPrevIdx = matrixIdx;
+    }
+    // Return home from last original stop
+    const preOptReturnKey = `${preOptPrevIdx}-0`;
+    const preOptReturn = distMatrix[preOptReturnKey] || { distanceMiles: 0, durationMinutes: 0 };
+    preOptMiles += preOptReturn.distanceMiles;
+    preOptDriveMinutes += preOptReturn.durationMinutes;
+
+    // Build pre-optimization stop details (original order with driving segments)
+    let preOptRunningTime = req.body.startTime || '08:00';
+    let preOptPrevIdx2 = 0;
+    const preOptStops = stopList.map((stop, idx) => {
+      const matrixIdx = idx + 1;
+      const key = `${preOptPrevIdx2}-${matrixIdx}`;
+      const seg = distMatrix[key] || { distanceMiles: 0, durationMinutes: 0 };
+      
+      const arrivalMinutes = timeToMinutes(preOptRunningTime) + seg.durationMinutes + (idx > 0 ? bufferMinutes : 0);
+      const arrivalTime = minutesToTime(arrivalMinutes);
+      const departureMinutes = arrivalMinutes + stop.serviceMinutes;
+      const departureTime = minutesToTime(departureMinutes);
+      preOptRunningTime = departureTime;
+      preOptPrevIdx2 = matrixIdx;
+      
+      return {
+        clientId: stop.clientId,
+        clientName: stop.clientName,
+        address: stop.address,
+        stopOrder: idx + 1,
+        milesFromPrevious: seg.distanceMiles,
+        driveMinutesFromPrevious: seg.durationMinutes,
+        serviceUnits: stop.serviceUnits,
+        serviceMinutes: stop.serviceMinutes,
+        calculatedArrival: arrivalTime,
+        calculatedDeparture: departureTime,
+        scheduledStartTime: stop.requestedStartTime || null,
+        scheduledEndTime: stop.requestedEndTime || null,
+      };
+    });
+
+    // Build Google Maps URL for the route
+    const gmapsParts = ['https://www.google.com/maps/dir'];
+    gmapsParts.push(`${caregiver.latitude},${caregiver.longitude}`);
+    finalStops.forEach(s => gmapsParts.push(`${s.latitude},${s.longitude}`));
+    gmapsParts.push(`${caregiver.latitude},${caregiver.longitude}`);
+
+    res.json({
+      caregiver: {
+        id: caregiver.id,
+        name: `${caregiver.first_name} ${caregiver.last_name}`,
+        homeAddress: [caregiver.address, caregiver.city, caregiver.state, caregiver.zip].filter(Boolean).join(', '),
+        latitude: parseFloat(caregiver.latitude),
+        longitude: parseFloat(caregiver.longitude)
+      },
+      date,
+      stops: finalStops,
+      preOptimization: {
+        stops: preOptStops,
+        totalMiles: Math.round(preOptMiles * 100) / 100,
+        totalDriveMinutes: preOptDriveMinutes,
+        totalServiceMinutes,
+        returnMiles: Math.round(preOptReturn.distanceMiles * 100) / 100,
+        returnDriveMinutes: preOptReturn.durationMinutes,
+        estimatedStartTime: preOptStops[0]?.calculatedArrival || '08:00',
+        estimatedEndTime: minutesToTime(
+          timeToMinutes(preOptStops[preOptStops.length - 1]?.calculatedDeparture || '08:00') +
+          preOptReturn.durationMinutes
+        ),
+        mileageReimbursement: Math.round(preOptMiles * mileageRate * 100) / 100,
+      },
+      googleMapsUrl: gmapsParts.join('/'),
+      summary: {
+        totalStops: finalStops.length,
+        totalMiles: Math.round(totalMiles * 100) / 100,
+        totalDriveMinutes,
+        totalServiceMinutes,
+        totalServiceHours: Math.round(totalServiceMinutes / 60 * 100) / 100,
+        totalBufferMinutes: bufferMinutes * Math.max(0, finalStops.length - 1),
+        returnMiles: Math.round(returnSegment.distanceMiles * 100) / 100,
+        returnDriveMinutes: returnSegment.durationMinutes,
+        estimatedStartTime: finalStops[0]?.calculatedArrival || '08:00',
+        estimatedEndTime: minutesToTime(
+          timeToMinutes(finalStops[finalStops.length - 1]?.calculatedDeparture || '08:00') +
+          returnSegment.durationMinutes
+        ),
+        mileageReimbursement: Math.round(totalMiles * mileageRate * 100) / 100,
+        mileageRate,
+        milesSaved: Math.round((preOptMiles - totalMiles) * 100) / 100,
+        drivingMinutesSaved: preOptDriveMinutes - totalDriveMinutes,
+        routingSource: usingGoogle ? 'google_routes_api' : 'haversine_estimate',
+        googleApiUsed: usingGoogle
+      }
+    });
+  } catch (error) {
+    console.error('Route optimization error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 2: Save a route plan
+// POST /api/route-optimizer/save-route
+// ============================================================
+router.post('/save-route', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, date, stops, totalMiles, totalDriveMinutes, totalServiceMinutes, notes, status } = req.body;
+    const planId = uuidv4();
+
+    await db.query(`DELETE FROM route_plans WHERE caregiver_id = $1 AND route_date = $2`, [caregiverId, date]);
+
+    const planResult = await db.query(
+      `INSERT INTO route_plans (id, caregiver_id, route_date, total_miles, total_drive_minutes, 
+       total_service_minutes, stop_count, status, notes, created_by)
+       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING *`,
+      [planId, caregiverId, date, totalMiles, totalDriveMinutes, totalServiceMinutes, 
+       stops.length, status || 'draft', notes || null, req.user.id]
+    );
+
+    for (const stop of stops) {
+      await db.query(
+        `INSERT INTO route_plan_stops (id, route_plan_id, stop_order, client_id, arrival_time, departure_time,
+         service_units, miles_from_previous, drive_minutes_from_previous, latitude, longitude, address, notes)
+         VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)`,
+        [uuidv4(), planId, stop.stopOrder, stop.clientId, stop.calculatedArrival, stop.calculatedDeparture,
+         stop.serviceUnits, stop.milesFromPrevious, stop.driveMinutesFromPrevious,
+         stop.latitude, stop.longitude, stop.address, stop.notes || null]
+      );
+    }
+
+    await auditLog(req.user.id, 'CREATE', 'route_plans', planId, null, planResult.rows[0]);
+    res.status(201).json({ id: planId, ...planResult.rows[0] });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 3: Get saved route plans
+// GET /api/route-optimizer/plans?date=YYYY-MM-DD&caregiverId=uuid
+// ============================================================
+router.get('/plans', verifyToken, async (req, res) => {
+  try {
+    const { date, caregiverId } = req.query;
+    let query = `
+      SELECT rp.*, 
+             u.first_name as caregiver_first_name, u.last_name as caregiver_last_name,
+             u.latitude as cg_lat, u.longitude as cg_lng, u.address as cg_address,
+             u.city as cg_city, u.state as cg_state, u.zip as cg_zip
+      FROM route_plans rp
+      JOIN users u ON rp.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+    if (date) { params.push(date); query += ` AND rp.route_date = $${params.length}`; }
+    if (caregiverId) { params.push(caregiverId); query += ` AND rp.caregiver_id = $${params.length}`; }
+    query += ' ORDER BY rp.route_date DESC, u.first_name';
+    
+    const plans = await db.query(query, params);
+    const results = [];
+    for (const plan of plans.rows) {
+      const planStops = await db.query(
+        `SELECT rps.*, c.first_name as client_first_name, c.last_name as client_last_name,
+                c.phone as client_phone, c.weekly_authorized_units
+         FROM route_plan_stops rps
+         JOIN clients c ON rps.client_id = c.id
+         WHERE rps.route_plan_id = $1
+         ORDER BY rps.stop_order`,
+        [plan.id]
+      );
+      results.push({ ...plan, stops: planStops.rows });
+    }
+    res.json(results);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 4: Delete a route plan
+// ============================================================
+router.delete('/plans/:id', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query('DELETE FROM route_plans WHERE id = $1 RETURNING *', [req.params.id]);
+    if (!result.rows.length) return res.status(404).json({ error: 'Route plan not found' });
+    await auditLog(req.user.id, 'DELETE', 'route_plans', req.params.id, result.rows[0], null);
+    res.json({ message: 'Route plan deleted' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 5: Hours Summary Dashboard
+// GET /api/route-optimizer/hours-summary?startDate=&endDate=
+// ============================================================
+router.get('/hours-summary', verifyToken, async (req, res) => {
+  try {
+    const { startDate, endDate } = req.query;
+    const now = new Date();
+    const weekStart = startDate || (() => {
+      const d = new Date(now); d.setDate(d.getDate() - d.getDay());
+      return d.toISOString().split('T')[0];
+    })();
+    const weekEnd = endDate || (() => {
+      const d = new Date(now); d.setDate(d.getDate() + (6 - d.getDay()));
+      return d.toISOString().split('T')[0];
+    })();
+
+    const result = await db.query(`
+      SELECT 
+        u.id, u.first_name, u.last_name, u.phone,
+        COALESCE(ca.max_hours_per_week, 40) as max_hours_per_week,
+        COALESCE((
+          SELECT SUM(EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 3600)
+          FROM schedules s WHERE s.caregiver_id = u.id AND s.is_active = true
+            AND (s.date >= $1 AND s.date <= $2)
+        ), 0) as scheduled_hours,
+        COALESCE((
+          SELECT SUM(EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time)) / 900)
+          FROM schedules s WHERE s.caregiver_id = u.id AND s.is_active = true
+            AND (s.date >= $1 AND s.date <= $2)
+        ), 0) as scheduled_units,
+        COALESCE((
+          SELECT SUM(te.duration_minutes) / 60.0
+          FROM time_entries te WHERE te.caregiver_id = u.id AND te.is_complete = true
+            AND te.start_time >= ($1 || ' 00:00:00')::timestamptz
+            AND te.start_time <= ($2 || ' 23:59:59')::timestamptz
+        ), 0) as clocked_hours,
+        (
+          SELECT json_build_object('id', te.id, 'client_id', te.client_id, 'start_time', te.start_time,
+            'client_name', c.first_name || ' ' || c.last_name)
+          FROM time_entries te LEFT JOIN clients c ON te.client_id = c.id
+          WHERE te.caregiver_id = u.id AND te.is_complete = false AND te.end_time IS NULL
+          ORDER BY te.start_time DESC LIMIT 1
+        ) as active_shift,
+        COALESCE((
+          SELECT SUM(rp.total_miles) FROM route_plans rp
+          WHERE rp.caregiver_id = u.id AND rp.route_date >= $1 AND rp.route_date <= $2
+        ), 0) as total_miles,
+        COALESCE((
+          SELECT COUNT(*) FROM schedules s
+          WHERE s.caregiver_id = u.id AND s.is_active = true AND (s.date >= $1 AND s.date <= $2)
+        ), 0) as scheduled_visits,
+        COALESCE((
+          SELECT COUNT(*) FROM time_entries te
+          WHERE te.caregiver_id = u.id AND te.is_complete = true
+            AND te.start_time >= ($1 || ' 00:00:00')::timestamptz
+            AND te.start_time <= ($2 || ' 23:59:59')::timestamptz
+        ), 0) as completed_visits
+      FROM users u
+      LEFT JOIN caregiver_availability ca ON u.id = ca.caregiver_id
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      ORDER BY u.first_name, u.last_name
+    `, [weekStart, weekEnd]);
+
+    const caregivers = result.rows.map(cg => {
+      const scheduled = parseFloat(cg.scheduled_hours) || 0;
+      const clocked = parseFloat(cg.clocked_hours) || 0;
+      const maxHours = parseFloat(cg.max_hours_per_week) || 40;
+      return {
+        id: cg.id, name: `${cg.first_name} ${cg.last_name}`, phone: cg.phone,
+        maxHoursPerWeek: maxHours,
+        scheduledHours: Math.round(scheduled * 100) / 100,
+        clockedHours: Math.round(clocked * 100) / 100,
+        remainingHours: Math.round(Math.max(0, maxHours - scheduled) * 100) / 100,
+        overtimeHours: Math.round(Math.max(0, clocked - 40) * 100) / 100,
+        scheduledUnits: parseInt(cg.scheduled_units) || 0,
+        scheduledVisits: parseInt(cg.scheduled_visits) || 0,
+        completedVisits: parseInt(cg.completed_visits) || 0,
+        totalMiles: Math.round(parseFloat(cg.total_miles || 0) * 100) / 100,
+        activeShift: cg.active_shift,
+        utilizationPct: maxHours > 0 ? Math.round((scheduled / maxHours) * 100) : 0,
+        clockedVsScheduledPct: scheduled > 0 ? Math.round((clocked / scheduled) * 100) : 0
+      };
+    });
+
+    const totals = {
+      totalCaregivers: caregivers.length,
+      totalScheduledHours: caregivers.reduce((s, c) => s + c.scheduledHours, 0),
+      totalClockedHours: caregivers.reduce((s, c) => s + c.clockedHours, 0),
+      totalMiles: caregivers.reduce((s, c) => s + c.totalMiles, 0),
+      totalScheduledVisits: caregivers.reduce((s, c) => s + c.scheduledVisits, 0),
+      totalCompletedVisits: caregivers.reduce((s, c) => s + c.completedVisits, 0),
+      activeCaregivers: caregivers.filter(c => c.activeShift).length
+    };
+
+    res.json({ startDate: weekStart, endDate: weekEnd, caregivers, totals });
+  } catch (error) {
+    console.error('Hours summary error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 6: Daily route view (all caregivers for a date)
+// GET /api/route-optimizer/daily/:date
+// ============================================================
+router.get('/daily/:date', verifyToken, async (req, res) => {
+  try {
+    const { date } = req.params;
+    const dayOfWeek = new Date(date + 'T12:00:00').getDay();
+
+    const schedulesResult = await db.query(`
+      SELECT s.*, 
+             u.first_name as cg_first, u.last_name as cg_last, 
+             u.latitude as cg_lat, u.longitude as cg_lng,
+             u.address as cg_address, u.city as cg_city, u.state as cg_state, u.zip as cg_zip,
+             c.first_name as cl_first, c.last_name as cl_last,
+             c.latitude as cl_lat, c.longitude as cl_lng,
+             c.address as cl_address, c.city as cl_city, c.state as cl_state, c.zip as cl_zip,
+             c.weekly_authorized_units
+      FROM schedules s
+      JOIN users u ON s.caregiver_id = u.id
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.is_active = true AND (s.date = $1 OR s.day_of_week = $2)
+      ORDER BY u.first_name, s.start_time
+    `, [date, dayOfWeek]);
+
+    // Group by caregiver
+    const caregiverMap = {};
+    for (const row of schedulesResult.rows) {
+      if (!caregiverMap[row.caregiver_id]) {
+        caregiverMap[row.caregiver_id] = {
+          caregiverId: row.caregiver_id,
+          caregiverName: `${row.cg_first} ${row.cg_last}`,
+          homeLatitude: parseFloat(row.cg_lat),
+          homeLongitude: parseFloat(row.cg_lng),
+          homeAddress: [row.cg_address, row.cg_city, row.cg_state, row.cg_zip].filter(Boolean).join(', '),
+          visits: []
+        };
+      }
+      const serviceMinutes = (new Date(`2000-01-01T${row.end_time}`) - new Date(`2000-01-01T${row.start_time}`)) / 60000;
+      caregiverMap[row.caregiver_id].visits.push({
+        scheduleId: row.id, clientId: row.client_id,
+        clientName: `${row.cl_first} ${row.cl_last}`,
+        latitude: parseFloat(row.cl_lat), longitude: parseFloat(row.cl_lng),
+        address: [row.cl_address, row.cl_city, row.cl_state, row.cl_zip].filter(Boolean).join(', '),
+        startTime: row.start_time, endTime: row.end_time,
+        serviceUnits: Math.round(serviceMinutes / 15),
+        serviceMinutes, weeklyAuthorizedUnits: row.weekly_authorized_units
+      });
+    }
+
+    // Calculate route metrics using Google or Haversine
+    const routes = [];
+    for (const cg of Object.values(caregiverMap)) {
+      let totalMiles = 0;
+      let totalDriveMinutes = 0;
+      let prevLat = cg.homeLatitude;
+      let prevLng = cg.homeLongitude;
+
+      const visitsWithDistance = [];
+      for (const v of cg.visits) {
+        let miles, driveMin;
+        if (GOOGLE_API_KEY && prevLat && prevLng && v.latitude && v.longitude) {
+          const gResult = await googleRoute(prevLat, prevLng, v.latitude, v.longitude);
+          if (gResult) { miles = gResult.distanceMiles; driveMin = gResult.durationMinutes; }
+        }
+        if (miles === undefined) {
+          miles = haversine(prevLat, prevLng, v.latitude, v.longitude) || 0;
+          driveMin = estimateDriveMinutes(miles);
+        }
+        totalMiles += miles;
+        totalDriveMinutes += driveMin;
+        visitsWithDistance.push({ ...v, milesFromPrevious: Math.round(miles * 100) / 100, driveMinutesFromPrevious: driveMin });
+        prevLat = v.latitude; prevLng = v.longitude;
+      }
+
+      // Return trip
+      if (visitsWithDistance.length > 0) {
+        const last = visitsWithDistance[visitsWithDistance.length - 1];
+        let rm, rd;
+        if (GOOGLE_API_KEY && last.latitude && last.longitude && cg.homeLatitude && cg.homeLongitude) {
+          const gr = await googleRoute(last.latitude, last.longitude, cg.homeLatitude, cg.homeLongitude);
+          if (gr) { rm = gr.distanceMiles; rd = gr.durationMinutes; }
+        }
+        if (rm === undefined) {
+          rm = haversine(last.latitude, last.longitude, cg.homeLatitude, cg.homeLongitude) || 0;
+          rd = estimateDriveMinutes(rm);
+        }
+        totalMiles += rm; totalDriveMinutes += rd;
+      }
+
+      routes.push({
+        ...cg, visits: visitsWithDistance,
+        totalMiles: Math.round(totalMiles * 100) / 100,
+        totalServiceMinutes: cg.visits.reduce((s, v) => s + v.serviceMinutes, 0),
+        totalDriveMinutes
+      });
+    }
+
+    res.json({ date, routes, routingSource: GOOGLE_API_KEY ? 'google_routes_api' : 'haversine_estimate' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 7: Geofence settings
+// ============================================================
+router.get('/geofence', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT gs.*, c.first_name, c.last_name, c.address, c.city, c.state, c.zip, c.latitude, c.longitude
+      FROM geofence_settings gs JOIN clients c ON gs.client_id = c.id
+      WHERE c.is_active = true ORDER BY c.first_name
+    `);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/geofence', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { clientId, radiusFeet, autoClockIn, autoClockOut, requireGps, notifyAdminOnOverride } = req.body;
+    const result = await db.query(`
+      INSERT INTO geofence_settings (id, client_id, radius_feet, auto_clock_in, auto_clock_out, require_gps, notify_admin_on_override)
+      VALUES ($1, $2, $3, $4, $5, $6, $7)
+      ON CONFLICT (client_id) DO UPDATE SET
+        radius_feet = $3, auto_clock_in = $4, auto_clock_out = $5, 
+        require_gps = $6, notify_admin_on_override = $7, updated_at = NOW()
+      RETURNING *
+    `, [uuidv4(), clientId, radiusFeet || 300, autoClockIn !== false, autoClockOut !== false,
+        requireGps !== false, notifyAdminOnOverride !== false]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+router.post('/geofence/check', verifyToken, async (req, res) => {
+  try {
+    const { clientId, latitude, longitude } = req.body;
+    const client = await db.query(
+      `SELECT c.latitude, c.longitude, c.first_name, c.last_name,
+              COALESCE(gs.radius_feet, 300) as radius_feet,
+              COALESCE(gs.auto_clock_in, true) as auto_clock_in,
+              COALESCE(gs.auto_clock_out, true) as auto_clock_out
+       FROM clients c LEFT JOIN geofence_settings gs ON c.id = gs.client_id WHERE c.id = $1`, [clientId]
+    );
+    if (!client.rows.length) return res.status(404).json({ error: 'Client not found' });
+    const cl = client.rows[0];
+    if (!cl.latitude || !cl.longitude) return res.json({ withinGeofence: false, error: 'Client has no geocoded address' });
+    const feet = distanceFeet(latitude, longitude, parseFloat(cl.latitude), parseFloat(cl.longitude));
+    const withinGeofence = feet !== null && feet <= cl.radius_feet;
+    res.json({
+      withinGeofence, distanceFeet: feet ? Math.round(feet) : null, radiusFeet: cl.radius_feet,
+      autoClockIn: cl.auto_clock_in, autoClockOut: cl.auto_clock_out,
+      clientName: `${cl.first_name} ${cl.last_name}`
+    });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ============================================================
+// ROUTE 8: Geocode (Google -> Nominatim fallback)
+// POST /api/route-optimizer/geocode
+// ============================================================
+router.post('/geocode', verifyToken, async (req, res) => {
+  try {
+    const { address, city, state, zip, entityType, entityId } = req.body;
+    const fullAddress = [address, city, state, zip].filter(Boolean).join(', ');
+    if (!fullAddress) return res.status(400).json({ error: 'Address required' });
+
+    // Try Google first
+    let result = await googleGeocode(fullAddress);
+    let source = 'google';
+
+    // Fallback to Nominatim
+    if (!result) {
+      source = 'nominatim';
+      try {
+        const encoded = encodeURIComponent(fullAddress);
+        const response = await fetch(
+          `https://nominatim.openstreetmap.org/search?q=${encoded}&format=json&limit=1&countrycodes=us`,
+          { headers: { 'User-Agent': 'ChippewaValleyHomeCare/1.0' } }
+        );
+        const data = await response.json();
+        if (data.length) {
+          result = { latitude: parseFloat(data[0].lat), longitude: parseFloat(data[0].lon), formattedAddress: data[0].display_name };
+        }
+      } catch (e) { /* fallback failed */ }
+    }
+
+    if (!result) return res.status(404).json({ error: 'Address not found', address: fullAddress });
+
+    if (entityType && entityId) {
+      const table = entityType === 'client' ? 'clients' : 'users';
+      await db.query(`UPDATE ${table} SET latitude = $1, longitude = $2, updated_at = NOW() WHERE id = $3`,
+        [result.latitude, result.longitude, entityId]);
+    }
+
+    res.json({ latitude: result.latitude, longitude: result.longitude, formattedAddress: result.formattedAddress, searchedAddress: fullAddress, source });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ============================================================
+// ROUTE 9: Bulk geocode
+// POST /api/route-optimizer/geocode-all
+// ============================================================
+router.post('/geocode-all', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { entityType } = req.body;
+    const table = entityType === 'caregivers' ? 'users' : 'clients';
+    const whereClause = entityType === 'caregivers' ? `role = 'caregiver' AND is_active = true` : `is_active = true`;
+
+    const result = await db.query(
+      `SELECT id, address, city, state, zip FROM ${table} 
+       WHERE (latitude IS NULL OR longitude IS NULL) AND address IS NOT NULL AND ${whereClause}`
+    );
+
+    const results = { success: 0, failed: 0, errors: [], source: GOOGLE_API_KEY ? 'google' : 'nominatim' };
+    
+    for (const row of result.rows) {
+      const fullAddress = [row.address, row.city, row.state, row.zip].filter(Boolean).join(', ');
+      try {
+        let geo = GOOGLE_API_KEY ? await googleGeocode(fullAddress) : null;
+
+        if (!geo) {
+          await new Promise(r => setTimeout(r, 1100)); // Nominatim rate limit
+          const encoded = encodeURIComponent(fullAddress);
+          const response = await fetch(
+            `https://nominatim.openstreetmap.org/search?q=${encoded}&format=json&limit=1&countrycodes=us`,
+            { headers: { 'User-Agent': 'ChippewaValleyHomeCare/1.0' } }
+          );
+          const data = await response.json();
+          if (data.length) geo = { latitude: parseFloat(data[0].lat), longitude: parseFloat(data[0].lon) };
+        }
+        
+        if (geo) {
+          await db.query(`UPDATE ${table} SET latitude = $1, longitude = $2, updated_at = NOW() WHERE id = $3`,
+            [geo.latitude, geo.longitude, row.id]);
+          results.success++;
+        } else {
+          results.failed++;
+          results.errors.push({ id: row.id, address: fullAddress, error: 'Not found' });
+        }
+      } catch (e) {
+        results.failed++;
+        results.errors.push({ id: row.id, address: fullAddress, error: e.message });
+      }
+    }
+
+    res.json({ total: result.rows.length, ...results });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ============================================================
+// ROUTE 10: Update stop status (live route tracking)
+// ============================================================
+router.put('/stops/:stopId/status', verifyToken, async (req, res) => {
+  try {
+    const { status } = req.body;
+    const validStatuses = ['pending', 'en_route', 'arrived', 'in_progress', 'completed', 'skipped'];
+    if (!validStatuses.includes(status)) {
+      return res.status(400).json({ error: `Invalid status. Must be one of: ${validStatuses.join(', ')}` });
+    }
+    const updates = [`status = $1`];
+    const params = [status, req.params.stopId];
+    if (status === 'arrived') updates.push(`actual_arrival = NOW()`);
+    else if (status === 'completed') updates.push(`actual_departure = NOW()`);
+
+    const result = await db.query(
+      `UPDATE route_plan_stops SET ${updates.join(', ')} WHERE id = $${params.length} RETURNING *`, params
+    );
+    if (!result.rows.length) return res.status(404).json({ error: 'Stop not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ============================================================
+// ROUTE 11: Config status check
+// GET /api/route-optimizer/config-status
+// ============================================================
+router.get('/config-status', verifyToken, requireAdmin, async (req, res) => {
+  const status = {
+    googleApiKeyConfigured: !!GOOGLE_API_KEY,
+    googleApiKeyPrefix: GOOGLE_API_KEY ? GOOGLE_API_KEY.substring(0, 10) + '...' : null,
+    routingSource: GOOGLE_API_KEY ? 'Google Routes API (real road miles + drive times)' : 'Haversine (straight-line estimate)',
+    geocodingSource: GOOGLE_API_KEY ? 'Google Geocoding API' : 'Nominatim (OpenStreetMap)',
+    enabledApis: GOOGLE_API_KEY ? ['Routes API', 'Geocoding API'] : ['Nominatim (free)']
+  };
+
+  if (GOOGLE_API_KEY) {
+    try {
+      const testResult = await googleGeocode('1600 Pennsylvania Ave NW, Washington, DC 20500');
+      status.googleApiKeyValid = !!testResult;
+      status.testResult = testResult ? 'API key working — Geocoding OK' : 'API key may be invalid or APIs not enabled';
+    } catch (e) {
+      status.googleApiKeyValid = false;
+      status.testResult = e.message;
+    }
+  }
+
+  res.json(status);
+});
+
+// ============================================================
+// ROUTE 12: Load existing schedule into route planner
+// GET /api/route-optimizer/load-schedule/:caregiverId/:date
+// ============================================================
+router.get('/load-schedule/:caregiverId/:date', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, date } = req.params;
+    const dayOfWeek = new Date(date + 'T12:00:00').getDay();
+
+    const result = await db.query(`
+      SELECT s.id, s.client_id, s.start_time, s.end_time,
+             c.first_name, c.last_name, c.latitude, c.longitude,
+             c.address, c.city, c.state, c.zip, c.weekly_authorized_units
+      FROM schedules s
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.caregiver_id = $1 AND s.is_active = true 
+        AND (s.date = $2 OR s.day_of_week = $3)
+      ORDER BY s.start_time
+    `, [caregiverId, date, dayOfWeek]);
+
+    const stops = result.rows.map(r => {
+      const serviceMinutes = (new Date(`2000-01-01T${r.end_time}`) - new Date(`2000-01-01T${r.start_time}`)) / 60000;
+      return {
+        clientId: r.client_id,
+        clientName: `${r.first_name} ${r.last_name}`,
+        address: [r.address, r.city, r.state, r.zip].filter(Boolean).join(', '),
+        latitude: r.latitude ? parseFloat(r.latitude) : null,
+        longitude: r.longitude ? parseFloat(r.longitude) : null,
+        serviceUnits: Math.round(serviceMinutes / 15),
+        weeklyAuthorizedUnits: r.weekly_authorized_units || 0,
+        startTime: r.start_time?.slice(0, 5) || '',
+        endTime: r.end_time?.slice(0, 5) || '',
+        hasCoords: !!(r.latitude && r.longitude),
+        scheduleId: r.id
+      };
+    });
+
+    // Also check if a saved route plan exists for this caregiver+date
+    const savedPlan = await db.query(
+      `SELECT id, status, total_miles, total_drive_minutes, total_service_minutes, 
+              stop_count, created_at, notes
+       FROM route_plans WHERE caregiver_id = $1 AND route_date = $2
+       ORDER BY created_at DESC LIMIT 1`,
+      [caregiverId, date]
+    );
+
+    res.json({
+      stops,
+      scheduledVisits: stops.length,
+      savedPlan: savedPlan.rows[0] || null
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 13: Build Google Maps directions URL
+// POST /api/route-optimizer/google-maps-url
+// ============================================================
+router.post('/google-maps-url', verifyToken, async (req, res) => {
+  try {
+    const { origin, destination, waypoints } = req.body;
+    // Build a Google Maps directions URL that opens in browser/app
+    // Format: https://www.google.com/maps/dir/origin/wp1/wp2/.../destination
+    const parts = ['https://www.google.com/maps/dir'];
+    
+    // Add origin
+    if (origin.latitude && origin.longitude) {
+      parts.push(`${origin.latitude},${origin.longitude}`);
+    } else if (origin.address) {
+      parts.push(encodeURIComponent(origin.address));
+    }
+    
+    // Add waypoints
+    if (waypoints) {
+      for (const wp of waypoints) {
+        if (wp.latitude && wp.longitude) {
+          parts.push(`${wp.latitude},${wp.longitude}`);
+        } else if (wp.address) {
+          parts.push(encodeURIComponent(wp.address));
+        }
+      }
+    }
+    
+    // Add destination (back to origin for round trip)
+    if (destination) {
+      if (destination.latitude && destination.longitude) {
+        parts.push(`${destination.latitude},${destination.longitude}`);
+      } else if (destination.address) {
+        parts.push(encodeURIComponent(destination.address));
+      }
+    }
+
+    res.json({ url: parts.join('/') });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 14: Load a saved route plan with stops
+// GET /api/route-optimizer/plans/:id/full
+// ============================================================
+router.get('/plans/:id/full', verifyToken, async (req, res) => {
+  try {
+    const plan = await db.query(`
+      SELECT rp.*, 
+             u.first_name as cg_first, u.last_name as cg_last,
+             u.latitude as cg_lat, u.longitude as cg_lng,
+             u.address as cg_address, u.city as cg_city, u.state as cg_state, u.zip as cg_zip
+      FROM route_plans rp
+      JOIN users u ON rp.caregiver_id = u.id
+      WHERE rp.id = $1
+    `, [req.params.id]);
+    
+    if (!plan.rows.length) return res.status(404).json({ error: 'Route plan not found' });
+    
+    const stops = await db.query(`
+      SELECT rps.*, c.first_name, c.last_name, c.phone, c.weekly_authorized_units
+      FROM route_plan_stops rps
+      JOIN clients c ON rps.client_id = c.id
+      WHERE rps.route_plan_id = $1
+      ORDER BY rps.stop_order
+    `, [req.params.id]);
+
+    const p = plan.rows[0];
+    res.json({
+      plan: p,
+      caregiver: {
+        id: p.caregiver_id,
+        name: `${p.cg_first} ${p.cg_last}`,
+        homeAddress: [p.cg_address, p.cg_city, p.cg_state, p.cg_zip].filter(Boolean).join(', '),
+        latitude: parseFloat(p.cg_lat),
+        longitude: parseFloat(p.cg_lng)
+      },
+      stops: stops.rows.map(s => ({
+        ...s,
+        clientName: `${s.first_name} ${s.last_name}`,
+        latitude: parseFloat(s.latitude),
+        longitude: parseFloat(s.longitude)
+      }))
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ============================================================
+// ROUTE 15: Get all saved route plans (browse/manage)
+// GET /api/route-optimizer/saved-routes?limit=20&offset=0&status=published
+// ============================================================
+router.get('/saved-routes', verifyToken, async (req, res) => {
+  try {
+    const { limit = 20, offset = 0, status, caregiverId, startDate, endDate } = req.query;
+    let query = `
+      SELECT rp.*, 
+             u.first_name as cg_first, u.last_name as cg_last,
+             (SELECT COUNT(*) FROM route_plan_stops rps WHERE rps.route_plan_id = rp.id) as actual_stop_count
+      FROM route_plans rp
+      JOIN users u ON rp.caregiver_id = u.id
+      WHERE 1=1
+    `;
+    const params = [];
+    if (status) { params.push(status); query += ` AND rp.status = $${params.length}`; }
+    if (caregiverId) { params.push(caregiverId); query += ` AND rp.caregiver_id = $${params.length}`; }
+    if (startDate) { params.push(startDate); query += ` AND rp.route_date >= $${params.length}`; }
+    if (endDate) { params.push(endDate); query += ` AND rp.route_date <= $${params.length}`; }
+    
+    // Get total count
+    const countResult = await db.query(`SELECT COUNT(*) FROM (${query}) sub`, params);
+    const total = parseInt(countResult.rows[0].count);
+    
+    params.push(parseInt(limit));
+    query += ` ORDER BY rp.route_date DESC, u.first_name LIMIT $${params.length}`;
+    params.push(parseInt(offset));
+    query += ` OFFSET $${params.length}`;
+
+    const result = await db.query(query, params);
+    
+    res.json({
+      routes: result.rows.map(r => ({
+        ...r,
+        caregiverName: `${r.cg_first} ${r.cg_last}`
+      })),
+      total,
+      limit: parseInt(limit),
+      offset: parseInt(offset)
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/routesIndex.js b/templates/crm-homecare/backend/src/routes/routesIndex.js
new file mode 100644
index 0000000..f798ec1
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/routesIndex.js
@@ -0,0 +1,186 @@
+// routes/index.js
+// Master routes file - import and register all routes
+
+const express = require('express');
+const router = express.Router();
+
+// Import all route modules
+const billingRoutes = require('./billingRoutes');
+const payrollRoutes = require('./payrollRoutes');
+const claimsRoutes = require('./claimsRoutes');
+const smsRoutes = require('./smsRoutes');
+const openShiftsRoutes = require('./openShiftsRoutes');
+const medicationsRoutes = require('./medicationsRoutes');
+const documentsRoutes = require('./documentsRoutes');
+const adlRoutes = require('./adlRoutes');
+const backgroundChecksRoutes = require('./backgroundChecksRoutes');
+const familyPortalRoutes = require('./familyPortalRoutes');
+const clientPortalRoutes = require('./clientPortalRoutes');
+const shiftSwapsRoutes = require('./shiftSwapsRoutes');
+const reportsRoutes = require('./reportsRoutes');
+const alertsRoutes = require('./alertsRoutes');
+const applicationsRoutes = require('./applicationsRoutes'); // NEW: Job applications
+const routeOptimizerRoutes = require('./routeOptimizerRoutes'); // Route optimizer
+
+// Register routes with their prefixes
+router.use('/billing', billingRoutes);
+router.use('/payroll', payrollRoutes);
+router.use('/claims', claimsRoutes);
+router.use('/sms', smsRoutes);
+router.use('/open-shifts', openShiftsRoutes);
+router.use('/medications', medicationsRoutes);
+router.use('/documents', documentsRoutes);
+router.use('/adl', adlRoutes);
+router.use('/background-checks', backgroundChecksRoutes);
+router.use('/family-portal', familyPortalRoutes);
+router.use('/client-portal', clientPortalRoutes);
+router.use('/shift-swaps', shiftSwapsRoutes);
+router.use('/reports', reportsRoutes);
+router.use('/alerts', alertsRoutes);
+router.use('/applications', applicationsRoutes); // NEW: Job applications
+router.use('/route-optimizer', routeOptimizerRoutes); // Route optimizer
+
+// Also expose billing/payroll endpoints at root level for backwards compatibility
+router.use('/', billingRoutes);  // For /api/authorizations, /api/invoice-payments, etc.
+router.use('/', payrollRoutes);  // For /api/mileage, /api/pto, etc.
+
+module.exports = router;
+
+/*
+===============================================================================
+USAGE IN server.js
+===============================================================================
+
+1. Add this near your other requires:
+   const additionalRoutes = require('./routes/index');
+
+2. Add this with your other app.use statements (AFTER existing routes):
+   app.use('/api', additionalRoutes);
+
+Example server.js setup:
+------------------------
+
+const express = require('express');
+const cors = require('cors');
+const app = express();
+
+// Middleware
+app.use(cors());
+app.use(express.json());
+
+// Existing routes
+app.use('/api/auth', require('./routes/auth'));
+app.use('/api/clients', require('./routes/clients'));
+app.use('/api/caregivers', require('./routes/caregivers'));
+app.use('/api/schedules', require('./routes/schedules'));
+app.use('/api/time-entries', require('./routes/timeEntries'));
+app.use('/api/invoices', require('./routes/invoices'));
+// ... other existing routes
+
+// NEW: Add all additional routes
+const additionalRoutes = require('./routes/index');
+app.use('/api', additionalRoutes);
+
+// Start server
+app.listen(process.env.PORT || 5000);
+
+===============================================================================
+ENV VARS NEEDED
+===============================================================================
+
+# Twilio (for SMS)
+TWILIO_ACCOUNT_SID=your_twilio_sid
+TWILIO_AUTH_TOKEN=your_twilio_token
+TWILIO_PHONE_NUMBER=+1234567890
+
+# File uploads
+UPLOAD_DIR=./uploads
+
+===============================================================================
+API ENDPOINTS SUMMARY
+===============================================================================
+
+ALERTS:
+  GET    /api/alerts                    - Get all alerts
+  POST   /api/alerts                    - Create alert
+  PUT    /api/alerts/:id/acknowledge    - Acknowledge alert
+  PUT    /api/alerts/:id/resolve        - Resolve alert
+  PUT    /api/alerts/:id/dismiss        - Dismiss alert
+  GET    /api/alerts/dashboard          - Get dashboard summary
+
+BACKGROUND CHECKS:
+  GET    /api/background-checks         - Get all checks
+  POST   /api/background-checks         - Add check
+  PUT    /api/background-checks/:id     - Update check
+  DELETE /api/background-checks/:id     - Delete check
+
+SMS:
+  GET    /api/sms/messages              - Get messages
+  POST   /api/sms/send                  - Send single SMS
+  POST   /api/sms/send-bulk             - Send bulk SMS
+  GET    /api/sms/templates             - Get templates
+  POST   /api/sms/templates             - Create template
+  PUT    /api/sms/templates/:id         - Update template
+  DELETE /api/sms/templates/:id         - Delete template
+
+FAMILY PORTAL:
+  GET    /api/family-portal/admin/members           - Get all family members
+  POST   /api/family-portal/admin/members           - Add family member
+  PUT    /api/family-portal/admin/members/:id/status - Toggle active
+  PUT    /api/family-portal/admin/members/:id/reset-password - Reset password
+  GET    /api/family-portal/admin/messages          - Get messages
+  POST   /api/family-portal/admin/messages/:id/reply - Reply to message
+
+ADL TRACKING:
+  GET    /api/adl/client/:id/requirements   - Get requirements
+  POST   /api/adl/requirements              - Add requirement
+  PUT    /api/adl/requirements/:id          - Update requirement
+  DELETE /api/adl/requirements/:id          - Delete requirement
+  GET    /api/adl/client/:id/logs           - Get logs
+  POST   /api/adl/log                       - Log activity
+
+CLAIMS:
+  GET    /api/claims                    - Get all claims
+  GET    /api/claims/:id                - Get claim details
+  POST   /api/claims                    - Create claim
+  PUT    /api/claims/:id/status         - Update status
+  POST   /api/claims/export/837p        - Export 837P file
+
+OPEN SHIFTS:
+  GET    /api/open-shifts               - Get open shifts
+  POST   /api/open-shifts               - Create open shift
+  POST   /api/open-shifts/:id/claim     - Claim shift
+  POST   /api/open-shifts/:id/approve   - Approve claim
+  POST   /api/open-shifts/:id/broadcast - Broadcast to caregivers
+
+SHIFT SWAPS:
+  GET    /api/shift-swaps               - Get swap requests
+  POST   /api/shift-swaps               - Create swap request
+  PUT    /api/shift-swaps/:id/respond   - Accept/reject
+  PUT    /api/shift-swaps/:id/approve   - Admin approve
+  PUT    /api/shift-swaps/:id/reject    - Admin reject
+
+MEDICATIONS:
+  GET    /api/medications/client/:id    - Get client medications
+  POST   /api/medications               - Add medication
+  PUT    /api/medications/:id           - Update medication
+  POST   /api/medications/log           - Log administration
+  GET    /api/medications/logs/client/:id - Get logs
+
+DOCUMENTS:
+  GET    /api/documents/:type/:id       - Get documents
+  POST   /api/documents/upload          - Upload document
+  DELETE /api/documents/:id             - Delete document
+  POST   /api/documents/:id/acknowledge - Sign/acknowledge
+
+JOB APPLICATIONS:
+  POST   /api/applications              - Submit application (PUBLIC - no auth)
+  GET    /api/applications              - Get all applications (admin)
+  GET    /api/applications/:id          - Get application details (admin)
+  PUT    /api/applications/:id/status   - Update status (admin)
+  POST   /api/applications/:id/notes    - Add interview notes (admin)
+  POST   /api/applications/:id/hire     - Convert to caregiver (admin)
+  DELETE /api/applications/:id          - Delete application (admin)
+  GET    /api/applications/stats/summary - Get application stats (admin)
+
+*/
diff --git a/templates/crm-homecare/backend/src/routes/sandataRoutes.js b/templates/crm-homecare/backend/src/routes/sandataRoutes.js
new file mode 100644
index 0000000..d8d842b
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/sandataRoutes.js
@@ -0,0 +1,445 @@
+// routes/sandataRoutes.js
+// Sandata Alt-EVV API integration
+// Credentials set via env vars: SANDATA_USERNAME, SANDATA_PASSWORD, SANDATA_ACCOUNT_ID
+// API docs: Wisconsin DHS Alt-EVV Technical Specification
+// Contact: (833) 931-2035 / VDXC.ContactEVV@wisconsin.gov
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+const requireAdmin = require('../middleware/authorizeAdmin');
+const { v4: uuidv4 } = require('uuid');
+
+// ─── API CLIENT ───────────────────────────────────────────────────────────────
+function getSandataConfig() {
+  return {
+    baseUrl: process.env.SANDATA_API_URL || 'https://openevv.sandata.com/api/v1',
+    username: process.env.SANDATA_USERNAME,
+    password: process.env.SANDATA_PASSWORD,
+    accountId: process.env.SANDATA_ACCOUNT_ID,
+    isConfigured: !!(process.env.SANDATA_USERNAME && process.env.SANDATA_PASSWORD && process.env.SANDATA_ACCOUNT_ID)
+  };
+}
+
+async function sandataRequest(method, endpoint, body = null) {
+  const cfg = getSandataConfig();
+  if (!cfg.isConfigured) {
+    throw new Error('Sandata credentials not configured. Set SANDATA_USERNAME, SANDATA_PASSWORD, SANDATA_ACCOUNT_ID in environment variables.');
+  }
+
+  const credentials = Buffer.from(`${cfg.username}:${cfg.password}`).toString('base64');
+  const options = {
+    method,
+    headers: {
+      'Authorization': `Basic ${credentials}`,
+      'Account': cfg.accountId,
+      'Content-Type': 'application/json',
+      'Accept': 'application/json'
+    }
+  };
+  if (body) options.body = JSON.stringify(body);
+
+  const response = await fetch(`${cfg.baseUrl}${endpoint}`, options);
+  const data = await response.json();
+  return { ok: response.ok, status: response.status, data };
+}
+
+// ─── CALCULATE UNITS ─────────────────────────────────────────────────────────
+function calcUnits(startTime, endTime, unitType) {
+  if (!endTime) return 0;
+  const mins = (new Date(endTime) - new Date(startTime)) / 60000;
+  if (unitType === '15min') return Math.round(mins / 15 * 100) / 100;
+  if (unitType === 'hour') return Math.round(mins / 60 * 100) / 100;
+  if (unitType === 'visit') return 1;
+  return Math.round(mins / 15 * 100) / 100; // default 15min
+}
+
+// ─── AUTO-CREATE EVV VISIT FROM TIME ENTRY ───────────────────────────────────
+// Called automatically when a shift clocks out
+async function createEVVFromTimeEntry(timeEntryId) {
+  try {
+    // Get full time entry with client and caregiver details
+    const te = await db.query(`
+      SELECT te.*, 
+        c.medicaid_id, c.evv_client_id, c.first_name as client_first, c.last_name as client_last,
+        c.referral_source_id as client_payer_id,
+        u.first_name as cg_first, u.last_name as cg_last,
+        cp.evv_worker_id, cp.npi_number, cp.taxonomy_code,
+        ct.default_service_code, ct.default_modifier, ct.requires_evv,
+        rs.payer_type
+      FROM time_entries te
+      JOIN clients c ON te.client_id = c.id
+      JOIN users u ON te.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      LEFT JOIN care_types ct ON te.care_type_id = ct.id
+      LEFT JOIN referral_sources rs ON c.referral_source_id = rs.id
+      WHERE te.id = $1
+    `, [timeEntryId]);
+
+    if (!te.rows.length) return null;
+    const entry = te.rows[0];
+
+    // Find active authorization for this client/service
+    const auth = await db.query(`
+      SELECT * FROM authorizations
+      WHERE client_id = $1
+        AND status = 'active'
+        AND start_date <= $2::date
+        AND end_date >= $2::date
+        AND (procedure_code = $3 OR procedure_code IS NULL)
+      ORDER BY end_date ASC
+      LIMIT 1
+    `, [entry.client_id, entry.start_time, entry.default_service_code]);
+
+    const authorization = auth.rows[0] || null;
+
+    // Parse GPS locations
+    const gpsIn = entry.clock_in_location || {};
+    const gpsOut = entry.clock_out_location || {};
+
+    // Calculate units
+    const serviceCode = entry.default_service_code || 'T1019';
+    const unitType = authorization?.unit_type || '15min';
+    const units = calcUnits(entry.start_time, entry.end_time, unitType);
+
+    // Determine issues
+    const issues = [];
+    if (!entry.medicaid_id) issues.push({ code: 'NO_MEDICAID_ID', msg: 'Client has no Medicaid ID on file' });
+    if (!entry.evv_worker_id && !entry.npi_number) issues.push({ code: 'NO_WORKER_ID', msg: 'Caregiver has no EVV Worker ID or NPI' });
+    if (!authorization) issues.push({ code: 'NO_AUTH', msg: 'No active authorization found for this service/date' });
+    if (!gpsIn.latitude && !gpsIn.lat) issues.push({ code: 'NO_GPS_IN', msg: 'No GPS on clock-in' });
+    if (!gpsOut.latitude && !gpsOut.lat) issues.push({ code: 'NO_GPS_OUT', msg: 'No GPS on clock-out' });
+
+    // Upsert EVV visit record
+    const result = await db.query(`
+      INSERT INTO evv_visits (
+        id, time_entry_id, client_id, caregiver_id, authorization_id,
+        service_code, modifier, service_date, actual_start, actual_end,
+        units_of_service,
+        gps_in_lat, gps_in_lng, gps_out_lat, gps_out_lng,
+        sandata_status, evv_method, is_verified, verification_issues
+      ) VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,
+        $16,'gps',$17,$18)
+      ON CONFLICT (time_entry_id) DO UPDATE SET
+        actual_end = EXCLUDED.actual_end,
+        units_of_service = EXCLUDED.units_of_service,
+        gps_out_lat = EXCLUDED.gps_out_lat,
+        gps_out_lng = EXCLUDED.gps_out_lng,
+        verification_issues = EXCLUDED.verification_issues,
+        is_verified = EXCLUDED.is_verified,
+        updated_at = NOW()
+      RETURNING *
+    `, [
+      uuidv4(), timeEntryId, entry.client_id, entry.caregiver_id,
+      authorization?.id || null,
+      serviceCode, entry.default_modifier || null,
+      new Date(entry.start_time).toISOString().split('T')[0],
+      entry.start_time, entry.end_time,
+      units,
+      gpsIn.latitude || gpsIn.lat || null,
+      gpsIn.longitude || gpsIn.lng || null,
+      gpsOut.latitude || gpsOut.lat || null,
+      gpsOut.longitude || gpsOut.lng || null,
+      issues.length === 0 ? 'ready' : 'pending',
+      issues.length === 0,
+      JSON.stringify(issues)
+    ]);
+
+    // Update authorization used units
+    if (authorization && units > 0) {
+      await db.query(`
+        UPDATE authorizations SET 
+          used_units = used_units + $1,
+          status = CASE 
+            WHEN used_units + $1 >= authorized_units THEN 'exhausted'
+            ELSE status END,
+          updated_at = NOW()
+        WHERE id = $2
+      `, [units, authorization.id]);
+
+      // Check if low units alert needed
+      const updatedAuth = await db.query('SELECT * FROM authorizations WHERE id = $1', [authorization.id]);
+      const a = updatedAuth.rows[0];
+      if (a && a.authorized_units - a.used_units <= a.low_units_alert_threshold) {
+        const remaining = a.authorized_units - a.used_units;
+        const admins = await db.query(`SELECT id FROM users WHERE role = 'admin' AND is_active = true`);
+        const clientInfo = await db.query(`SELECT first_name, last_name FROM clients WHERE id = $1`, [entry.client_id]);
+        const clientName = clientInfo.rows[0] ? `${clientInfo.rows[0].first_name} ${clientInfo.rows[0].last_name}` : 'Client';
+        for (const admin of admins.rows) {
+          await db.query(`
+            INSERT INTO notifications (id, user_id, type, title, message, is_read, created_at)
+            VALUES ($1,$2,'authorization_low','⚠️ Low Authorization Units',$3,false,NOW())
+          `, [uuidv4(), admin.id,
+            `${clientName}: Only ${remaining.toFixed(1)} units remaining on auth #${a.auth_number || a.id.slice(0,8)} (expires ${new Date(a.end_date).toLocaleDateString()})`
+          ]);
+        }
+      }
+    }
+
+    return result.rows[0];
+  } catch (e) {
+    console.error('[EVV] createEVVFromTimeEntry error:', e.message);
+    return null;
+  }
+}
+
+// Export for use in other routes (called from clock-out endpoint)
+module.exports.createEVVFromTimeEntry = createEVVFromTimeEntry;
+
+// ─── GET EVV STATUS DASHBOARD ────────────────────────────────────────────────
+router.get('/status', auth, requireAdmin, async (req, res) => {
+  try {
+    const cfg = getSandataConfig();
+    const { startDate, endDate } = req.query;
+    const start = startDate || new Date(Date.now() - 7 * 86400000).toISOString().split('T')[0];
+    const end = endDate || new Date().toISOString().split('T')[0];
+
+    const visits = await db.query(`
+      SELECT ev.*,
+        c.first_name as client_first, c.last_name as client_last, c.medicaid_id,
+        u.first_name as cg_first, u.last_name as cg_last,
+        cp.evv_worker_id, cp.npi_number
+      FROM evv_visits ev
+      JOIN clients c ON ev.client_id = c.id
+      JOIN users u ON ev.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      WHERE ev.service_date BETWEEN $1 AND $2
+      ORDER BY ev.service_date DESC, ev.actual_start DESC
+    `, [start, end]);
+
+    const summary = {
+      total: visits.rows.length,
+      verified: visits.rows.filter(v => v.is_verified).length,
+      pending: visits.rows.filter(v => v.sandata_status === 'pending').length,
+      ready: visits.rows.filter(v => v.sandata_status === 'ready').length,
+      submitted: visits.rows.filter(v => v.sandata_status === 'submitted').length,
+      accepted: visits.rows.filter(v => v.sandata_status === 'accepted').length,
+      exceptions: visits.rows.filter(v => v.sandata_status === 'exception').length,
+      hasIssues: visits.rows.filter(v => v.verification_issues?.length > 0).length,
+    };
+
+    res.json({ sandataConfigured: cfg.isConfigured, summary, visits: visits.rows });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── SUBMIT VISITS TO SANDATA ────────────────────────────────────────────────
+router.post('/submit', auth, requireAdmin, async (req, res) => {
+  try {
+    const { visitIds } = req.body;
+    const cfg = getSandataConfig();
+
+    if (!cfg.isConfigured) {
+      return res.status(400).json({
+        error: 'Sandata credentials not configured',
+        setup: 'Add SANDATA_USERNAME, SANDATA_PASSWORD, SANDATA_ACCOUNT_ID to your Render environment variables. Call (833) 931-2035 to get credentials.'
+      });
+    }
+
+    const visits = await db.query(`
+      SELECT ev.*,
+        c.medicaid_id, c.evv_client_id, c.first_name as client_first, c.last_name as client_last,
+        c.date_of_birth, c.gender,
+        u.first_name as cg_first, u.last_name as cg_last,
+        cp.evv_worker_id, cp.npi_number, cp.taxonomy_code
+      FROM evv_visits ev
+      JOIN clients c ON ev.client_id = c.id
+      JOIN users u ON ev.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      WHERE ev.id = ANY($1)
+        AND ev.sandata_status IN ('ready', 'pending')
+    `, [visitIds]);
+
+    const results = [];
+    for (const v of visits.rows) {
+      // Build Sandata Alt-EVV visit payload
+      const payload = {
+        ClientID: v.evv_client_id || v.medicaid_id,
+        EmployeeID: v.evv_worker_id || v.npi_number,
+        ServiceCode: v.service_code,
+        Modifier: v.modifier || null,
+        ServiceDate: v.service_date,
+        ActualStartTime: new Date(v.actual_start).toISOString(),
+        ActualEndTime: v.actual_end ? new Date(v.actual_end).toISOString() : null,
+        UnitsOfService: v.units_of_service,
+        GPSInLatitude: v.gps_in_lat,
+        GPSInLongitude: v.gps_in_lng,
+        GPSOutLatitude: v.gps_out_lat,
+        GPSOutLongitude: v.gps_out_lng,
+        VerificationMethod: 'GPS',
+      };
+
+      try {
+        const response = await sandataRequest('POST', '/visits', payload);
+        const newStatus = response.ok ? 'submitted' : 'exception';
+        const sandataVisitId = response.data?.VisitID || response.data?.visitId || null;
+
+        await db.query(`
+          UPDATE evv_visits SET
+            sandata_status = $1,
+            sandata_visit_id = $2,
+            sandata_submitted_at = NOW(),
+            sandata_response = $3,
+            sandata_exception_code = $4,
+            sandata_exception_desc = $5,
+            updated_at = NOW()
+          WHERE id = $6
+        `, [
+          newStatus, sandataVisitId,
+          JSON.stringify(response.data),
+          response.ok ? null : (response.data?.ExceptionCode || 'ERR'),
+          response.ok ? null : (response.data?.Message || response.data?.message || 'Submission failed'),
+          v.id
+        ]);
+
+        results.push({ visitId: v.id, status: newStatus, sandataVisitId });
+      } catch (e) {
+        await db.query(`UPDATE evv_visits SET sandata_status='exception', sandata_exception_desc=$1 WHERE id=$2`, [e.message, v.id]);
+        results.push({ visitId: v.id, status: 'error', error: e.message });
+      }
+    }
+
+    res.json({ submitted: results.filter(r => r.status === 'submitted').length, results });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── GET EVV VISIT DETAIL ────────────────────────────────────────────────────
+router.get('/visit/:id', auth, requireAdmin, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT ev.*,
+        c.first_name as client_first, c.last_name as client_last, c.medicaid_id, c.evv_client_id,
+        u.first_name as cg_first, u.last_name as cg_last,
+        cp.evv_worker_id, cp.npi_number,
+        a.auth_number, a.authorized_units, a.used_units, a.end_date as auth_expires
+      FROM evv_visits ev
+      JOIN clients c ON ev.client_id = c.id
+      JOIN users u ON ev.caregiver_id = u.id
+      LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      LEFT JOIN authorizations a ON ev.authorization_id = a.id
+      WHERE ev.id = $1
+    `, [req.params.id]);
+    if (!result.rows.length) return res.status(404).json({ error: 'EVV visit not found' });
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── MANUAL CORRECT EVV VISIT ────────────────────────────────────────────────
+router.put('/visit/:id', auth, requireAdmin, async (req, res) => {
+  try {
+    const { serviceCode, modifier, authorizationId, actualStart, actualEnd, notes } = req.body;
+    await db.query(`
+      UPDATE evv_visits SET
+        service_code = COALESCE($1, service_code),
+        modifier = COALESCE($2, modifier),
+        authorization_id = COALESCE($3, authorization_id),
+        actual_start = COALESCE($4, actual_start),
+        actual_end = COALESCE($5, actual_end),
+        sandata_status = CASE WHEN sandata_status = 'exception' THEN 'ready' ELSE sandata_status END,
+        updated_at = NOW()
+      WHERE id = $6
+    `, [serviceCode, modifier, authorizationId, actualStart, actualEnd, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── SYNC CLIENT TO SANDATA ──────────────────────────────────────────────────
+router.post('/sync-client/:clientId', auth, requireAdmin, async (req, res) => {
+  const cfg = getSandataConfig();
+  if (!cfg.isConfigured) return res.status(400).json({ error: 'Sandata not configured' });
+  try {
+    const client = await db.query(`SELECT * FROM clients WHERE id = $1`, [req.params.clientId]);
+    if (!client.rows.length) return res.status(404).json({ error: 'Client not found' });
+    const c = client.rows[0];
+
+    const payload = {
+      ClientID: c.evv_client_id || c.medicaid_id || c.id,
+      FirstName: c.first_name,
+      LastName: c.last_name,
+      DateOfBirth: c.date_of_birth,
+      Gender: c.gender,
+      MedicaidID: c.medicaid_id,
+      Address: c.address,
+      City: c.city,
+      State: c.state || 'WI',
+      Zip: c.zip,
+    };
+
+    const response = await sandataRequest('POST', '/clients', payload);
+    if (response.ok) {
+      const sandataClientId = response.data?.ClientID || response.data?.clientId;
+      if (sandataClientId) {
+        await db.query(`UPDATE clients SET evv_client_id = $1 WHERE id = $2`, [sandataClientId, req.params.clientId]);
+      }
+    }
+    res.json({ ok: response.ok, data: response.data });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── SYNC CAREGIVER TO SANDATA ───────────────────────────────────────────────
+router.post('/sync-caregiver/:caregiverId', auth, requireAdmin, async (req, res) => {
+  const cfg = getSandataConfig();
+  if (!cfg.isConfigured) return res.status(400).json({ error: 'Sandata not configured' });
+  try {
+    const user = await db.query(`
+      SELECT u.*, cp.npi_number, cp.evv_worker_id, cp.taxonomy_code
+      FROM users u LEFT JOIN caregiver_profiles cp ON cp.caregiver_id = u.id
+      WHERE u.id = $1
+    `, [req.params.caregiverId]);
+    if (!user.rows.length) return res.status(404).json({ error: 'Caregiver not found' });
+    const u = user.rows[0];
+
+    const payload = {
+      EmployeeID: u.evv_worker_id || u.npi_number || u.id,
+      FirstName: u.first_name,
+      LastName: u.last_name,
+      NPI: u.npi_number,
+      TaxonomyCode: u.taxonomy_code || '374700000X',
+      Phone: u.phone,
+    };
+
+    const response = await sandataRequest('POST', '/employees', payload);
+    if (response.ok) {
+      const workerId = response.data?.EmployeeID || response.data?.employeeId;
+      if (workerId) {
+        await db.query(`
+          INSERT INTO caregiver_profiles (caregiver_id, evv_worker_id) VALUES ($1, $2)
+          ON CONFLICT (caregiver_id) DO UPDATE SET evv_worker_id = $2
+        `, [req.params.caregiverId, workerId]);
+      }
+    }
+    res.json({ ok: response.ok, data: response.data });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ─── CONFIG STATUS ────────────────────────────────────────────────────────────
+router.get('/config', auth, requireAdmin, async (req, res) => {
+  const cfg = getSandataConfig();
+  res.json({
+    isConfigured: cfg.isConfigured,
+    hasUsername: !!cfg.username,
+    hasPassword: !!cfg.password,
+    hasAccountId: !!cfg.accountId,
+    setupInstructions: cfg.isConfigured ? null : {
+      step1: 'Call Wisconsin EVV Customer Care: (833) 931-2035',
+      step2: 'Request Alt-EVV API credentials for your agency',
+      step3: 'Add to Render environment variables: SANDATA_USERNAME, SANDATA_PASSWORD, SANDATA_ACCOUNT_ID',
+      step4: 'Use Sandata sandbox to test before going live'
+    }
+  });
+});
+
+router.createEVVFromTimeEntry = createEVVFromTimeEntry;
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/schedulesRoutes.js b/templates/crm-homecare/backend/src/routes/schedulesRoutes.js
new file mode 100644
index 0000000..abf2036
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/schedulesRoutes.js
@@ -0,0 +1,202 @@
+// routes/schedulesRoutes.js
+// Schedule Management Routes
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const { v4: uuidv4 } = require('uuid');
+
+// Auth middleware (same as in server.js)
+const jwt = require('jsonwebtoken');
+
+const verifyToken = (req, res, next) => {
+  const token = req.headers.authorization?.split(' ')[1];
+  if (!token) {
+    return res.status(401).json({ error: 'No token provided' });
+  }
+  if (!process.env.JWT_SECRET) {
+    console.error('FATAL: JWT_SECRET env var not set');
+    return res.status(500).json({ error: 'Server configuration error' });
+  }
+  try {
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+    req.user = decoded;
+    next();
+  } catch (error) {
+    return res.status(401).json({ error: 'Invalid token' });
+  }
+};
+
+const requireAdmin = (req, res, next) => {
+  if (req.user.role !== 'admin') {
+    return res.status(403).json({ error: 'Admin access required' });
+  }
+  next();
+};
+
+// Audit logging helper
+const auditLog = async (userId, action, tableName, recordId, oldData, newData) => {
+  try {
+    if (recordId && typeof recordId === 'string' && !recordId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)) {
+      return;
+    }
+    await db.query(
+      `INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data, created_at)
+       VALUES ($1, $2, $3, $4, $5, $6, NOW())`,
+      [userId || '00000000-0000-0000-0000-000000000000', action, tableName, recordId, JSON.stringify(oldData), JSON.stringify(newData)]
+    );
+  } catch (error) {
+    console.error('Audit log error:', error.message);
+  }
+};
+
+// ==================== SCHEDULES ROUTES ====================
+
+// GET /api/schedules/:caregiverId - Get schedules for a specific caregiver (caregiver dashboard)
+router.get('/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT s.*,
+        c.first_name as client_first_name, c.last_name as client_last_name,
+        c.address as client_address, c.city as client_city,
+        ct.name as care_type_name
+      FROM schedules s
+      JOIN clients c ON s.client_id = c.id
+      LEFT JOIN care_types ct ON c.care_type_id = ct.id
+      WHERE s.caregiver_id = $1 AND s.is_active = true
+      ORDER BY s.day_of_week, s.date, s.start_time
+    `, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/schedules/caregiver/:caregiverId - alias used by SchedulingHub
+router.get('/caregiver/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`
+      SELECT s.*,
+        c.first_name as client_first_name, c.last_name as client_last_name
+      FROM schedules s
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.caregiver_id = $1 AND s.is_active = true
+      ORDER BY s.day_of_week, s.date, s.start_time
+    `, [req.params.caregiverId]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/schedules - Create new schedule
+router.post('/', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, clientId, scheduleType, dayOfWeek, date, startTime, endTime, notes } = req.body;
+    
+    const scheduleId = uuidv4();
+    const result = await db.query(
+      `INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, day_of_week, date, start_time, end_time, notes)
+       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
+       RETURNING *`,
+      [scheduleId, caregiverId, clientId, scheduleType, dayOfWeek || null, date || null, startTime, endTime, notes || null]
+    );
+
+    await auditLog(req.user.id, 'CREATE', 'schedules', scheduleId, null, result.rows[0]);
+    res.status(201).json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// PUT /api/schedules/:id/reassign - Admin reassigns schedule to different caregiver
+router.put('/:id/reassign', verifyToken, requireAdmin, async (req, res) => {
+  const { newCaregiverId } = req.body;
+  const scheduleId = req.params.id;
+
+  try {
+    // Validate inputs
+    if (!newCaregiverId) {
+      return res.status(400).json({ error: 'newCaregiverId is required' });
+    }
+
+    // Get current schedule for audit log
+    const current = await db.query('SELECT * FROM schedules WHERE id = $1', [scheduleId]);
+    if (current.rows.length === 0) {
+      return res.status(404).json({ error: 'Schedule not found' });
+    }
+
+    const oldData = current.rows[0];
+
+    // Verify the new caregiver exists and is active
+    const caregiver = await db.query(
+      `SELECT id, first_name, last_name FROM users WHERE id = $1 AND role = 'caregiver' AND is_active = true`,
+      [newCaregiverId]
+    );
+    if (caregiver.rows.length === 0) {
+      return res.status(404).json({ error: 'Caregiver not found or inactive' });
+    }
+
+    // Check for scheduling conflicts with the new caregiver
+    const schedule = oldData;
+    if (schedule.date) {
+      const conflicts = await db.query(`
+        SELECT id FROM schedules 
+        WHERE caregiver_id = $1 
+          AND is_active = true
+          AND id != $2
+          AND date = $3
+          AND NOT (end_time <= $4 OR start_time >= $5)
+      `, [newCaregiverId, scheduleId, schedule.date, schedule.start_time, schedule.end_time]);
+
+      if (conflicts.rows.length > 0) {
+        return res.status(400).json({ 
+          error: `${caregiver.rows[0].first_name} ${caregiver.rows[0].last_name} has a conflicting schedule at this time` 
+        });
+      }
+    }
+
+    // Update the schedule
+    const result = await db.query(`
+      UPDATE schedules 
+      SET caregiver_id = $1, updated_at = NOW()
+      WHERE id = $2
+      RETURNING *
+    `, [newCaregiverId, scheduleId]);
+
+    // Audit log the change
+    await auditLog(req.user.id, 'UPDATE', 'schedules', scheduleId, oldData, result.rows[0]);
+
+    console.log(`Schedule ${scheduleId} reassigned from caregiver ${oldData.caregiver_id} to ${newCaregiverId} by admin ${req.user.id}`);
+
+    res.json({ 
+      success: true, 
+      schedule: result.rows[0],
+      message: `Schedule reassigned to ${caregiver.rows[0].first_name} ${caregiver.rows[0].last_name}`
+    });
+  } catch (error) {
+    console.error('Reassignment failed:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// NOTE: GET /api/schedules-all and PUT /api/schedules-all/:id are handled
+// directly in server.js — do not add them here (Express router path boundaries
+// prevent router.get('-all') from ever matching /api/schedules-all).
+
+// DELETE /api/schedules/:scheduleId - Delete a schedule (soft delete)
+router.delete('/:scheduleId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `UPDATE schedules SET is_active = false, updated_at = NOW() WHERE id = $1 RETURNING *`,
+      [req.params.scheduleId]
+    );
+
+    if (result.rows.length === 0) {
+      return res.status(404).json({ error: 'Schedule not found' });
+    }
+
+    await auditLog(req.user.id, 'DELETE', 'schedules', req.params.scheduleId, null, result.rows[0]);
+    res.json({ message: 'Schedule deleted' });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/schedulingRoutes.js b/templates/crm-homecare/backend/src/routes/schedulingRoutes.js
new file mode 100644
index 0000000..41ed6b4
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/schedulingRoutes.js
@@ -0,0 +1,381 @@
+// routes/schedulingRoutes.js
+// Smart scheduling: suggest-caregivers, auto-fill, conflict check, week view, bulk create, coverage overview
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin } = require('../middleware/shared');
+
+// ─── HELPERS ──────────────────────────────────────────────────────────────────
+
+function getWeekStart(date) {
+  const d = new Date(date);
+  d.setDate(d.getDate() - d.getDay());
+  d.setHours(0, 0, 0, 0);
+  return d;
+}
+
+function calculateDistance(lat1, lon1, lat2, lon2) {
+  if (!lat1 || !lon1 || !lat2 || !lon2) return null;
+  const R = 3959;
+  const dLat = (lat2 - lat1) * Math.PI / 180;
+  const dLon = (lon2 - lon1) * Math.PI / 180;
+  const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180) * Math.cos(lat2*Math.PI/180) * Math.sin(dLon/2)**2;
+  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
+}
+
+function timesOverlap(s1, e1, s2, e2) {
+  return !(e1 <= s2 || s1 >= e2);
+}
+
+// Returns { hasAll, missing } for suggest-caregivers
+function checkRequiredCerts(caregiverCerts, required) {
+  if (!required || required.length === 0) return { hasAll: true, missing: [] };
+  const certs = caregiverCerts || [];
+  const missing = required.filter(r => !certs.includes(r));
+  return { hasAll: missing.length === 0, missing };
+}
+
+// Returns boolean for auto-fill
+function hasRequiredCerts(caregiverCerts, required) {
+  if (!required || required.length === 0) return true;
+  const certs = caregiverCerts || [];
+  return required.every(r => certs.includes(r));
+}
+
+function isScheduleActiveForDate(schedule, targetDate) {
+  if (schedule.effective_date) {
+    const effDate = new Date(schedule.effective_date); effDate.setHours(0,0,0,0);
+    const target = new Date(targetDate); target.setHours(0,0,0,0);
+    if (target < effDate) return false;
+  }
+  if (schedule.frequency === 'biweekly' && schedule.anchor_date) {
+    const anchor = new Date(schedule.anchor_date);
+    const target = new Date(targetDate);
+    const diffWeeks = Math.round((target - anchor) / (7 * 24 * 60 * 60 * 1000));
+    if (diffWeeks % 2 !== 0) return false;
+  }
+  return true;
+}
+
+// ─── ROUTES ───────────────────────────────────────────────────────────────────
+
+// GET /api/scheduling/suggest-caregivers
+router.get('/suggest-caregivers', verifyToken, async (req, res) => {
+  try {
+    const { clientId, date, startTime, endTime } = req.query;
+    if (!clientId) return res.status(400).json({ error: 'Client ID required' });
+
+    const client = await db.query(`
+      SELECT c.id, c.first_name, c.last_name, c.care_type_id, c.latitude, c.longitude,
+             ct.name as care_type_name, ct.required_certifications
+      FROM clients c LEFT JOIN care_types ct ON c.care_type_id = ct.id
+      WHERE c.id = $1
+    `, [clientId]);
+    if (client.rows.length === 0) return res.status(404).json({ error: 'Client not found' });
+
+    const clientData = client.rows[0];
+    const requiredCerts = clientData.required_certifications || [];
+    const shiftHours = startTime && endTime
+      ? (new Date(`2000-01-01T${endTime}`) - new Date(`2000-01-01T${startTime}`)) / (1000 * 60 * 60) : 4;
+
+    const caregivers = await db.query(`
+      SELECT u.id, u.first_name, u.last_name, u.phone, u.default_pay_rate,
+             u.latitude, u.longitude, u.certifications,
+             ca.status as availability_status, ca.max_hours_per_week,
+             ARRAY_AGG(DISTINCT cc.certification_name)
+               FILTER (WHERE cc.certification_name IS NOT NULL AND (cc.expiration_date IS NULL OR cc.expiration_date > CURRENT_DATE))
+               as active_certifications
+      FROM users u
+      LEFT JOIN caregiver_availability ca ON u.id = ca.caregiver_id
+      LEFT JOIN caregiver_certifications cc ON u.id = cc.caregiver_id
+      WHERE u.role = 'caregiver' AND u.is_active = true
+      GROUP BY u.id, u.first_name, u.last_name, u.phone, u.default_pay_rate,
+               u.latitude, u.longitude, u.certifications, ca.status, ca.max_hours_per_week
+      ORDER BY u.first_name
+    `);
+
+    const weekStart = date ? getWeekStart(new Date(date)) : getWeekStart(new Date());
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate() + 6);
+
+    const [hoursResult, historyResult, conflictsResult] = await Promise.all([
+      db.query(`SELECT caregiver_id, SUM(EXTRACT(EPOCH FROM (end_time::time - start_time::time))/3600) as weekly_hours FROM schedules WHERE is_active=true AND (date>=$1 AND date<=$2 OR day_of_week IS NOT NULL) GROUP BY caregiver_id`,
+        [weekStart.toISOString().split('T')[0], weekEnd.toISOString().split('T')[0]]),
+      db.query(`SELECT caregiver_id, COUNT(*) as visit_count FROM time_entries WHERE client_id=$1 AND is_complete=true GROUP BY caregiver_id`, [clientId]),
+      date && startTime && endTime
+        ? db.query(`SELECT DISTINCT caregiver_id FROM schedules WHERE is_active=true AND (date=$1 OR day_of_week=EXTRACT(DOW FROM $1::date)::int) AND NOT (end_time<=$2 OR start_time>=$3)`, [date, startTime, endTime])
+        : Promise.resolve({ rows: [] }),
+    ]);
+
+    const hoursMap = {}; hoursResult.rows.forEach(r => hoursMap[r.caregiver_id] = parseFloat(r.weekly_hours)||0);
+    const historyMap = {}; historyResult.rows.forEach(r => historyMap[r.caregiver_id] = parseInt(r.visit_count)||0);
+    const conflictIds = new Set(conflictsResult.rows.map(r => r.caregiver_id));
+
+    const ranked = caregivers.rows.map(cg => {
+      const weeklyHours = hoursMap[cg.id] || 0;
+      const maxHours = cg.max_hours_per_week || 40;
+      const visitCount = historyMap[cg.id] || 0;
+      const hasConflict = conflictIds.has(cg.id);
+      const isAvailable = cg.availability_status !== 'unavailable';
+      const wouldExceedHours = (weeklyHours + shiftHours) > maxHours;
+      const approachingOvertime = weeklyHours > 35;
+      const distance = calculateDistance(cg.latitude, cg.longitude, clientData.latitude, clientData.longitude);
+      const estimatedDriveTime = distance ? Math.round(distance * 2) : null;
+      const certCheck = checkRequiredCerts(cg.active_certifications, requiredCerts);
+
+      let score = 100;
+      score += Math.min(visitCount * 3, 30);
+      if (!isAvailable) score -= 100;
+      if (hasConflict) score -= 100;
+      score -= (weeklyHours / maxHours) * 20;
+      if (wouldExceedHours) score -= 50;
+      if (approachingOvertime) score -= 10;
+      if (distance !== null) { if (distance <= 5) score += 20; else if (distance <= 10) score += 10; else if (distance <= 20) score += 5; else if (distance > 30) score -= 15; }
+      if (!certCheck.hasAll) score -= 40;
+
+      const reasons = [];
+      if (visitCount > 5) reasons.push(`✓ Familiar (${visitCount} visits)`);
+      else if (visitCount > 0) reasons.push(`${visitCount} prior visits`);
+      if (hasConflict) reasons.push('⚠️ Conflict');
+      if (!isAvailable) reasons.push('⚠️ Unavailable');
+      if (wouldExceedHours) reasons.push('⚠️ Exceeds max hours');
+      else if (approachingOvertime) reasons.push(`⚠️ ${weeklyHours.toFixed(0)}h this week`);
+      else if (weeklyHours < 20) reasons.push('✓ Has availability');
+      if (distance !== null) { if (distance <= 5) reasons.push(`✓ Nearby (${distance.toFixed(1)} mi)`); else if (distance <= 15) reasons.push(`${distance.toFixed(1)} mi away`); else if (distance > 20) reasons.push(`⚠️ Far (${distance.toFixed(1)} mi)`); }
+      if (!certCheck.hasAll) reasons.push(`⚠️ Missing: ${certCheck.missing.join(', ')}`);
+      else if (requiredCerts.length > 0) reasons.push('✓ Has required certs');
+
+      return { ...cg, weeklyHours: weeklyHours.toFixed(2), maxHours, visitCount, hasConflict, isAvailable, wouldExceedHours, approachingOvertime, distance: distance ? distance.toFixed(1) : null, estimatedDriveTime, hasRequiredSkills: certCheck.hasAll, missingCertifications: certCheck.missing, score: Math.round(score), reasons };
+    });
+
+    ranked.sort((a, b) => b.score - a.score);
+    res.json({ client: clientData, suggestions: ranked, shiftHours, requiredCertifications: requiredCerts });
+  } catch (error) {
+    console.error('Suggest caregivers error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/scheduling/auto-fill
+router.post('/auto-fill', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { startDate, endDate, dryRun = false } = req.body;
+    const start = startDate || new Date().toISOString().split('T')[0];
+    const end = endDate || (() => { const d = new Date(); d.setDate(d.getDate()+7); return d.toISOString().split('T')[0]; })();
+
+    const openShifts = await db.query(`
+      SELECT os.*, c.first_name as client_first, c.last_name as client_last,
+             c.care_type_id, c.latitude as client_lat, c.longitude as client_lng, ct.required_certifications
+      FROM open_shifts os JOIN clients c ON os.client_id=c.id LEFT JOIN care_types ct ON c.care_type_id=ct.id
+      WHERE os.status='open' AND os.shift_date>=$1 AND os.shift_date<=$2
+      ORDER BY os.urgency DESC, os.shift_date ASC, os.start_time ASC
+    `, [start, end]);
+
+    if (openShifts.rows.length === 0) return res.json({ success: true, message: 'No open shifts to fill', filled: 0, failed: 0, results: [] });
+
+    const caregivers = await db.query(`
+      SELECT u.id, u.first_name, u.last_name, u.latitude, u.longitude,
+             ca.status as availability_status, ca.max_hours_per_week,
+             ARRAY_AGG(DISTINCT cc.certification_name) FILTER (WHERE cc.certification_name IS NOT NULL AND (cc.expiration_date IS NULL OR cc.expiration_date > CURRENT_DATE)) as active_certifications
+      FROM users u
+      LEFT JOIN caregiver_availability ca ON u.id=ca.caregiver_id
+      LEFT JOIN caregiver_certifications cc ON u.id=cc.caregiver_id
+      WHERE u.role='caregiver' AND u.is_active=true AND (ca.status IS NULL OR ca.status!='unavailable')
+      GROUP BY u.id, u.first_name, u.last_name, u.latitude, u.longitude, ca.status, ca.max_hours_per_week
+    `);
+
+    const weekStart = getWeekStart(new Date(start));
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate()+6);
+    const hoursResult = await db.query(`SELECT caregiver_id, SUM(EXTRACT(EPOCH FROM (end_time::time - start_time::time))/3600) as weekly_hours FROM schedules WHERE is_active=true AND (date>=$1 AND date<=$2 OR day_of_week IS NOT NULL) GROUP BY caregiver_id`, [weekStart.toISOString().split('T')[0], weekEnd.toISOString().split('T')[0]]);
+    const historyResult = await db.query(`SELECT caregiver_id, client_id, COUNT(*) as visit_count FROM time_entries WHERE is_complete=true GROUP BY caregiver_id, client_id`);
+
+    const hoursMap = {}; hoursResult.rows.forEach(r => hoursMap[r.caregiver_id] = parseFloat(r.weekly_hours)||0);
+    const historyMap = {}; historyResult.rows.forEach(r => { if (!historyMap[r.client_id]) historyMap[r.client_id]={}; historyMap[r.client_id][r.caregiver_id]=parseInt(r.visit_count)||0; });
+
+    const newAssignments = [], results = [];
+    let filled = 0, failed = 0;
+
+    for (const shift of openShifts.rows) {
+      const shiftHours = (new Date(`2000-01-01T${shift.end_time}`) - new Date(`2000-01-01T${shift.start_time}`)) / (1000*60*60);
+      const requiredCerts = shift.required_certifications || [];
+      const clientHistory = historyMap[shift.client_id] || {};
+      const existingConflicts = await db.query(`SELECT DISTINCT caregiver_id FROM schedules WHERE is_active=true AND date=$1 AND NOT (end_time<=$2 OR start_time>=$3)`, [shift.shift_date, shift.start_time, shift.end_time]);
+      const conflictingIds = existingConflicts.rows.map(r => r.caregiver_id);
+
+      const scored = caregivers.rows.map(cg => {
+        const weeklyHours = hoursMap[cg.id] || 0;
+        const maxHours = cg.max_hours_per_week || 40;
+        const visitCount = clientHistory[cg.id] || 0;
+        const additionalHours = newAssignments.filter(a => a.caregiverId===cg.id).reduce((s,a) => s + (new Date(`2000-01-01T${a.endTime}`) - new Date(`2000-01-01T${a.startTime}`))/(1000*60*60), 0);
+        const projectedHours = weeklyHours + additionalHours;
+        const hasConflict = conflictingIds.includes(cg.id) || newAssignments.some(a => a.caregiverId===cg.id && a.date===shift.shift_date && timesOverlap(a.startTime, a.endTime, shift.start_time, shift.end_time));
+        const wouldExceedHours = (projectedHours + shiftHours) > maxHours;
+        const wouldExceedOvertime = (projectedHours + shiftHours) > 40;
+        const distance = calculateDistance(cg.latitude, cg.longitude, shift.client_lat, shift.client_lng);
+        const hasCerts = hasRequiredCerts(cg.active_certifications, requiredCerts);
+        if (hasConflict || wouldExceedHours || !hasCerts) return { ...cg, score: -1000, disqualified: true, reason: hasConflict ? 'conflict' : !hasCerts ? 'missing_certs' : 'exceeds_hours' };
+        let score = 100 + Math.min(visitCount*3,30) - (projectedHours/maxHours)*20;
+        if (wouldExceedOvertime) score -= 15;
+        if (distance !== null) { if (distance<=5) score+=20; else if (distance<=10) score+=10; else if (distance<=20) score+=5; else if (distance>30) score-=15; }
+        return { ...cg, score, disqualified: false, distance, visitCount, projectedHours };
+      });
+
+      scored.sort((a,b) => b.score - a.score);
+      const bestMatch = scored.find(s => !s.disqualified);
+
+      if (bestMatch) {
+        const shiftResult = { shiftId: shift.id, client: `${shift.client_first} ${shift.client_last}`, date: shift.shift_date, time: `${shift.start_time} - ${shift.end_time}`, assignedTo: `${bestMatch.first_name} ${bestMatch.last_name}`, caregiverId: bestMatch.id, score: Math.round(bestMatch.score), distance: bestMatch.distance ? `${bestMatch.distance.toFixed(1)} mi` : 'N/A', familiarity: bestMatch.visitCount > 0 ? `${bestMatch.visitCount} visits` : 'New' };
+        if (!dryRun) {
+          const scheduleId = uuidv4();
+          await db.query(`INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, date, start_time, end_time, notes) VALUES ($1,$2,$3,'one-time',$4,$5,$6,$7)`, [scheduleId, bestMatch.id, shift.client_id, shift.shift_date, shift.start_time, shift.end_time, 'Auto-assigned']);
+          await db.query(`UPDATE open_shifts SET status='filled', filled_by=$1, filled_at=NOW() WHERE id=$2`, [bestMatch.id, shift.id]);
+          shiftResult.scheduleId = scheduleId;
+        }
+        newAssignments.push({ caregiverId: bestMatch.id, date: shift.shift_date, startTime: shift.start_time, endTime: shift.end_time });
+        hoursMap[bestMatch.id] = (hoursMap[bestMatch.id]||0) + shiftHours;
+        results.push({ ...shiftResult, status: 'filled' });
+        filled++;
+      } else {
+        results.push({ shiftId: shift.id, client: `${shift.client_first} ${shift.client_last}`, date: shift.shift_date, time: `${shift.start_time} - ${shift.end_time}`, status: 'unfilled', reason: 'No available caregivers', candidates: scored.filter(s=>s.disqualified).slice(0,3).map(c=>({ name: `${c.first_name} ${c.last_name}`, reason: c.reason })) });
+        failed++;
+      }
+    }
+
+    res.json({ success: true, dryRun, message: dryRun ? `Preview: Would fill ${filled} of ${openShifts.rows.length} shifts` : `Filled ${filled} of ${openShifts.rows.length} shifts`, filled, failed, total: openShifts.rows.length, results });
+  } catch (error) {
+    console.error('Auto-fill error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/scheduling/check-conflicts
+router.post('/check-conflicts', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId, date, startTime, endTime } = req.body;
+    if (!caregiverId || !startTime || !endTime) return res.status(400).json({ error: 'Missing required fields' });
+    const dayOfWeek = date ? new Date(date).getDay() : null;
+    const result = await db.query(`
+      SELECT s.*, c.first_name as client_first_name, c.last_name as client_last_name
+      FROM schedules s LEFT JOIN clients c ON s.client_id=c.id
+      WHERE s.caregiver_id=$1 AND s.is_active=true AND NOT (s.end_time<=$2 OR s.start_time>=$3)
+        AND (s.date=$4 OR s.day_of_week=$5)
+    `, [caregiverId, startTime, endTime, date, dayOfWeek]);
+    res.json({ hasConflict: result.rows.length > 0, conflicts: result.rows.map(s => ({ id: s.id, clientName: `${s.client_first_name} ${s.client_last_name}`, startTime: s.start_time, endTime: s.end_time, isRecurring: s.day_of_week !== null })) });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/scheduling/week-view
+router.get('/week-view', verifyToken, async (req, res) => {
+  try {
+    const { weekOf } = req.query;
+    const weekStart = weekOf ? getWeekStart(new Date(weekOf)) : getWeekStart(new Date());
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate()+6);
+    const wsStr = weekStart.toISOString().split('T')[0];
+    const weStr = weekEnd.toISOString().split('T')[0];
+
+    const [caregivers, schedules] = await Promise.all([
+      db.query(`SELECT id, first_name, last_name FROM users WHERE role='caregiver' AND is_active=true ORDER BY first_name`),
+      db.query(`SELECT s.*, c.first_name as client_first_name, c.last_name as client_last_name FROM schedules s LEFT JOIN clients c ON s.client_id=c.id WHERE s.is_active=true AND (s.date>=$1 AND s.date<=$2 OR s.day_of_week IS NOT NULL) ORDER BY s.start_time`, [wsStr, weStr]),
+    ]);
+
+    const weekData = {};
+    caregivers.rows.forEach(cg => { weekData[cg.id] = { caregiver: cg, days: { 0:[], 1:[], 2:[], 3:[], 4:[], 5:[], 6:[] } }; });
+    schedules.rows.forEach(s => {
+      if (!weekData[s.caregiver_id]) return;
+      if (s.date) { weekData[s.caregiver_id].days[new Date(s.date).getDay()].push({ ...s, isRecurring: false }); }
+      else if (s.day_of_week !== null) {
+        const dayDate = new Date(weekStart); dayDate.setDate(dayDate.getDate() + s.day_of_week);
+        if (isScheduleActiveForDate(s, dayDate)) weekData[s.caregiver_id].days[s.day_of_week].push({ ...s, isRecurring: true });
+      }
+    });
+    res.json({ weekStart: wsStr, weekEnd: weStr, caregivers: Object.values(weekData) });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/scheduling/bulk-create
+router.post('/bulk-create', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { caregiverId, clientId, template, weeks, startDate, notes } = req.body;
+    if (!caregiverId || !clientId || !template?.length) return res.status(400).json({ error: 'Missing required fields' });
+    const numWeeks = Math.min(Math.max(parseInt(weeks)||4, 1), 12);
+    const start = startDate ? new Date(startDate) : new Date();
+    start.setDate(start.getDate() - start.getDay());
+    const created = [], conflicts = [];
+    for (let week = 0; week < numWeeks; week++) {
+      for (const slot of template) {
+        const slotDate = new Date(start); slotDate.setDate(slotDate.getDate() + (week*7) + slot.dayOfWeek);
+        if (slotDate < new Date()) continue;
+        const dateStr = slotDate.toISOString().split('T')[0];
+        const conflict = await db.query(`SELECT id FROM schedules WHERE caregiver_id=$1 AND is_active=true AND date=$2 AND NOT (end_time<=$3 OR start_time>=$4)`, [caregiverId, dateStr, slot.startTime, slot.endTime]);
+        if (conflict.rows.length > 0) { conflicts.push({ date: dateStr, startTime: slot.startTime }); continue; }
+        const scheduleId = uuidv4();
+        const result = await db.query(`INSERT INTO schedules (id, caregiver_id, client_id, schedule_type, date, start_time, end_time, notes) VALUES ($1,$2,$3,'one-time',$4,$5,$6,$7) RETURNING *`, [scheduleId, caregiverId, clientId, dateStr, slot.startTime, slot.endTime, notes||null]);
+        created.push(result.rows[0]);
+      }
+    }
+    res.json({ success: true, created: created.length, skippedConflicts: conflicts.length, conflicts });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/scheduling/caregiver-hours/:caregiverId
+router.get('/caregiver-hours/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId } = req.params;
+    const now = new Date();
+    const weekStart = new Date(now); weekStart.setDate(now.getDate()-now.getDay()); weekStart.setHours(0,0,0,0);
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate()+6); weekEnd.setHours(23,59,59,999);
+    const wsStr = weekStart.toISOString().split('T')[0]; const weStr = weekEnd.toISOString().split('T')[0];
+    const [oneTime, recurring, avail] = await Promise.all([
+      db.query(`SELECT SUM(EXTRACT(EPOCH FROM (end_time::time - start_time::time))/3600) as hours FROM schedules WHERE caregiver_id=$1 AND is_active=true AND date>=$2 AND date<=$3`, [caregiverId, wsStr, weStr]),
+      db.query(`SELECT SUM(EXTRACT(EPOCH FROM (end_time::time - start_time::time))/3600) as hours FROM schedules WHERE caregiver_id=$1 AND is_active=true AND day_of_week IS NOT NULL`, [caregiverId]),
+      db.query(`SELECT max_hours_per_week FROM caregiver_availability WHERE caregiver_id=$1`, [caregiverId]),
+    ]);
+    const oneTimeHours = parseFloat(oneTime.rows[0]?.hours)||0;
+    const recurringHours = parseFloat(recurring.rows[0]?.hours)||0;
+    const totalHours = oneTimeHours + recurringHours;
+    const maxHours = avail.rows[0]?.max_hours_per_week || 40;
+    res.json({ totalHours: totalHours.toFixed(2), oneTimeHours: oneTimeHours.toFixed(2), recurringHours: recurringHours.toFixed(2), maxHours, remainingHours: Math.max(0, maxHours-totalHours).toFixed(2), approachingOvertime: totalHours > 35 });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/scheduling/coverage-overview
+router.get('/coverage-overview', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { weekOf } = req.query;
+    const now = weekOf ? new Date(weekOf+'T12:00:00') : new Date();
+    const weekStart = new Date(now); weekStart.setDate(now.getDate()-now.getDay()); weekStart.setHours(0,0,0,0);
+    const weekEnd = new Date(weekStart); weekEnd.setDate(weekEnd.getDate()+6); weekEnd.setHours(23,59,59,999);
+    const wsStr = weekStart.toISOString().split('T')[0]; const weStr = weekEnd.toISOString().split('T')[0];
+
+    const [caregiversResult, clientsResult] = await Promise.all([
+      db.query(`SELECT u.id, u.first_name, u.last_name, COALESCE(ca.max_hours_per_week,40) as max_hours, COALESCE(ca.status,'available') as availability_status,
+        (SELECT COALESCE(SUM(EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time))/3600),0) FROM schedules s WHERE s.caregiver_id=u.id AND s.is_active=true AND ((s.date>=$1 AND s.date<=$2) OR s.day_of_week IS NOT NULL)) as scheduled_hours
+        FROM users u LEFT JOIN caregiver_availability ca ON u.id=ca.caregiver_id WHERE u.role='caregiver' AND u.is_active=true ORDER BY u.first_name, u.last_name`, [wsStr, weStr]),
+      db.query(`SELECT c.id, c.first_name, c.last_name, c.weekly_authorized_units,
+        (SELECT COALESCE(SUM(EXTRACT(EPOCH FROM (s.end_time::time - s.start_time::time))/3600),0) FROM schedules s WHERE s.client_id=c.id AND s.is_active=true AND ((s.date>=$1 AND s.date<=$2) OR s.day_of_week IS NOT NULL)) as scheduled_hours
+        FROM clients c WHERE c.is_active=true ORDER BY c.first_name, c.last_name`, [wsStr, weStr]),
+    ]);
+
+    const caregivers = caregiversResult.rows.map(cg => {
+      const maxHours = parseFloat(cg.max_hours)||40; const scheduledHours = parseFloat(cg.scheduled_hours)||0;
+      return { id: cg.id, name: `${cg.first_name} ${cg.last_name}`, maxHours, scheduledHours, remainingHours: Math.max(0, maxHours-scheduledHours), utilizationPercent: Math.round((scheduledHours/maxHours)*100), status: cg.availability_status };
+    });
+    const clientsWithUnits = clientsResult.rows.filter(cl => cl.weekly_authorized_units && parseInt(cl.weekly_authorized_units)>0).map(cl => {
+      const authorizedUnits = parseInt(cl.weekly_authorized_units)||0; const authorizedHours = authorizedUnits*0.25;
+      const scheduledHours = parseFloat(cl.scheduled_hours)||0; const scheduledUnits = Math.round(scheduledHours*4);
+      const shortfallUnits = Math.max(0, authorizedUnits-scheduledUnits);
+      return { id: cl.id, name: `${cl.first_name} ${cl.last_name}`, authorizedUnits, authorizedHours, scheduledUnits, scheduledHours, shortfallUnits, shortfallHours: shortfallUnits*0.25, coveragePercent: authorizedUnits>0 ? Math.round((scheduledUnits/authorizedUnits)*100) : 0, isUnderScheduled: shortfallUnits>0 };
+    });
+    const underScheduledClients = clientsWithUnits.filter(cl => cl.isUnderScheduled);
+    res.json({ weekStart: wsStr, weekEnd: weStr, caregivers, clientsWithUnits, underScheduledClients, summary: { totalCaregivers: caregivers.length, totalScheduledHours: caregivers.reduce((s,cg)=>s+cg.scheduledHours,0).toFixed(2), totalAvailableHours: caregivers.reduce((s,cg)=>s+cg.maxHours,0).toFixed(2), underScheduledClientCount: underScheduledClients.length, totalShortfallUnits: underScheduledClients.reduce((s,cl)=>s+cl.shortfallUnits,0), totalShortfallHours: underScheduledClients.reduce((s,cl)=>s+cl.shortfallHours,0).toFixed(2) } });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/absences/my
+router.get('/absences/my', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT * FROM absences WHERE caregiver_id=$1 ORDER BY created_at DESC`, [req.user.id])).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/shiftSwapsRoutes.js b/templates/crm-homecare/backend/src/routes/shiftSwapsRoutes.js
new file mode 100644
index 0000000..4f67456
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/shiftSwapsRoutes.js
@@ -0,0 +1,145 @@
+// routes/shiftSwapsRoutes.js
+// Shift Swap Requests
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Get swap requests
+router.get('/', auth, async (req, res) => {
+  const { status, caregiverId } = req.query;
+  try {
+    let query = `
+      SELECT ssr.*,
+        s.date as shift_date, s.start_time, s.end_time,
+        c.first_name as client_first, c.last_name as client_last,
+        u1.first_name as requester_first, u1.last_name as requester_last,
+        u2.first_name as target_first, u2.last_name as target_last
+      FROM shift_swap_requests ssr
+      JOIN schedules s ON ssr.schedule_id = s.id
+      JOIN clients c ON s.client_id = c.id
+      JOIN users u1 ON ssr.requesting_caregiver_id = u1.id
+      LEFT JOIN users u2 ON ssr.target_caregiver_id = u2.id
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (status) {
+      params.push(status);
+      query += ` AND ssr.status = $${params.length}`;
+    }
+    if (caregiverId) {
+      params.push(caregiverId);
+      query += ` AND (ssr.requesting_caregiver_id = $${params.length} OR ssr.target_caregiver_id = $${params.length})`;
+    }
+
+    query += ` ORDER BY ssr.requested_at DESC`;
+    
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create swap request
+router.post('/', auth, async (req, res) => {
+  const { scheduleId, requestingCaregiverId, targetCaregiverId, reason } = req.body;
+  
+  try {
+    // Get shift date
+    const schedule = await db.query('SELECT date FROM schedules WHERE id = $1', [scheduleId]);
+    if (schedule.rows.length === 0) {
+      return res.status(404).json({ error: 'Schedule not found' });
+    }
+
+    const result = await db.query(`
+      INSERT INTO shift_swap_requests (schedule_id, requesting_caregiver_id, target_caregiver_id, shift_date, reason)
+      VALUES ($1, $2, $3, $4, $5)
+      RETURNING *
+    `, [scheduleId, requestingCaregiverId, targetCaregiverId, schedule.rows[0].date, reason]);
+
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Target caregiver accepts/rejects
+router.put('/:id/respond', auth, async (req, res) => {
+  const { accepted, notes } = req.body;
+  
+  try {
+    const status = accepted ? 'accepted' : 'rejected';
+    await db.query(`
+      UPDATE shift_swap_requests 
+      SET status = $1, responded_at = NOW(), notes = $2
+      WHERE id = $3
+    `, [status, notes, req.params.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Admin approves swap
+router.put('/:id/approve', auth, async (req, res) => {
+  try {
+    const swap = await db.query('SELECT * FROM shift_swap_requests WHERE id = $1', [req.params.id]);
+    if (swap.rows.length === 0) {
+      return res.status(404).json({ error: 'Swap request not found' });
+    }
+
+    const s = swap.rows[0];
+    if (s.status !== 'accepted') {
+      return res.status(400).json({ error: 'Swap must be accepted by target caregiver first' });
+    }
+
+    // Update schedule with new caregiver
+    await db.query(`
+      UPDATE schedules SET caregiver_id = $1 WHERE id = $2
+    `, [s.target_caregiver_id, s.schedule_id]);
+
+    // Update swap request
+    await db.query(`
+      UPDATE shift_swap_requests 
+      SET status = 'approved', admin_approved_by = $1, admin_approved_at = NOW()
+      WHERE id = $2
+    `, [req.user.id, req.params.id]);
+
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Admin rejects swap
+router.put('/:id/reject', auth, async (req, res) => {
+  const { reason } = req.body;
+  try {
+    await db.query(`
+      UPDATE shift_swap_requests 
+      SET status = 'rejected', notes = $1, admin_approved_by = $2, admin_approved_at = NOW()
+      WHERE id = $3
+    `, [reason, req.user.id, req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Cancel swap request
+router.put('/:id/cancel', auth, async (req, res) => {
+  try {
+    await db.query(`
+      UPDATE shift_swap_requests SET status = 'cancelled' WHERE id = $1
+    `, [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
\ No newline at end of file
diff --git a/templates/crm-homecare/backend/src/routes/smsRoutes.js b/templates/crm-homecare/backend/src/routes/smsRoutes.js
new file mode 100644
index 0000000..10198c4
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/smsRoutes.js
@@ -0,0 +1,332 @@
+// routes/smsRoutes.js
+// SMS Notifications via Twilio
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Initialize Twilio (set in env vars)
+let twilioClient = null;
+if (process.env.TWILIO_ACCOUNT_SID && process.env.TWILIO_AUTH_TOKEN) {
+  const twilio = require('twilio');
+  twilioClient = twilio(process.env.TWILIO_ACCOUNT_SID, process.env.TWILIO_AUTH_TOKEN);
+}
+
+// ==================== MESSAGES ====================
+
+// Get all messages (for admin view)
+router.get('/messages', auth, async (req, res) => {
+  const { direction, status, limit = 100 } = req.query;
+  try {
+    let query = `
+      SELECT sm.*,
+        CASE 
+          WHEN sm.recipient_type = 'caregiver' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM users WHERE id = sm.recipient_id)
+          WHEN sm.recipient_type = 'client' THEN (SELECT CONCAT(first_name, ' ', last_name) FROM clients WHERE id = sm.recipient_id)
+          ELSE NULL
+        END as recipient_name
+      FROM sms_messages sm
+      WHERE 1=1
+    `;
+    const params = [];
+
+    if (direction) {
+      params.push(direction);
+      query += ` AND sm.direction = $${params.length}`;
+    }
+    if (status) {
+      params.push(status);
+      query += ` AND sm.status = $${params.length}`;
+    }
+
+    params.push(limit);
+    query += ` ORDER BY sm.created_at DESC LIMIT $${params.length}`;
+
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Send single SMS
+router.post('/send', auth, async (req, res) => {
+  const { to, body, recipientType, recipientId } = req.body;
+  
+  try {
+    let phone = to;
+    
+    // Get phone number from recipient if not provided
+    if (!phone && recipientType && recipientId) {
+      let phoneQuery;
+      if (recipientType === 'caregiver') {
+        phoneQuery = await db.query('SELECT phone FROM users WHERE id = $1', [recipientId]);
+      } else if (recipientType === 'client') {
+        phoneQuery = await db.query('SELECT phone FROM clients WHERE id = $1', [recipientId]);
+      }
+      if (phoneQuery?.rows[0]?.phone) {
+        phone = phoneQuery.rows[0].phone;
+      }
+    }
+
+    if (!phone) {
+      return res.status(400).json({ error: 'No phone number provided' });
+    }
+
+    // Log the message
+    const smsRecord = await db.query(`
+      INSERT INTO sms_messages (recipient_type, recipient_id, to_number, from_number, body, direction, status)
+      VALUES ($1, $2, $3, $4, $5, 'outbound', 'pending')
+      RETURNING *
+    `, [recipientType || null, recipientId || null, phone, process.env.TWILIO_PHONE_NUMBER, body]);
+
+    // Send via Twilio
+    if (twilioClient && process.env.TWILIO_PHONE_NUMBER) {
+      try {
+        const twilioMessage = await twilioClient.messages.create({
+          body: body,
+          from: process.env.TWILIO_PHONE_NUMBER,
+          to: phone
+        });
+
+        await db.query(`
+          UPDATE sms_messages 
+          SET status = 'sent', twilio_sid = $1, sent_at = NOW()
+          WHERE id = $2
+        `, [twilioMessage.sid, smsRecord.rows[0].id]);
+
+        res.json({ success: true, sid: twilioMessage.sid, messageId: smsRecord.rows[0].id });
+      } catch (twilioError) {
+        await db.query(`
+          UPDATE sms_messages SET status = 'failed', error_message = $1 WHERE id = $2
+        `, [twilioError.message, smsRecord.rows[0].id]);
+        res.status(500).json({ error: 'SMS send failed', details: twilioError.message });
+      }
+    } else {
+      // No Twilio configured - just log it
+      await db.query(`UPDATE sms_messages SET status = 'logged' WHERE id = $1`, [smsRecord.rows[0].id]);
+      res.json({ success: true, messageId: smsRecord.rows[0].id, sid: 'NO_TWILIO', note: 'Twilio not configured - message logged only' });
+    }
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Send bulk SMS
+router.post('/send-bulk', auth, async (req, res) => {
+  const { recipientType, recipientIds, body } = req.body;
+  
+  try {
+    const results = { sent: 0, failed: 0, errors: [] };
+
+    for (const recipientId of recipientIds) {
+      try {
+        let phoneQuery;
+        if (recipientType === 'caregiver') {
+          phoneQuery = await db.query('SELECT id, phone, first_name, last_name FROM users WHERE id = $1', [recipientId]);
+        } else if (recipientType === 'client') {
+          phoneQuery = await db.query('SELECT id, phone, first_name, last_name FROM clients WHERE id = $1', [recipientId]);
+        }
+
+        if (!phoneQuery?.rows[0]?.phone) {
+          results.failed++;
+          results.errors.push({ recipientId, error: 'No phone number' });
+          continue;
+        }
+
+        const phone = phoneQuery.rows[0].phone;
+
+        // Log message
+        const smsRecord = await db.query(`
+          INSERT INTO sms_messages (recipient_type, recipient_id, to_number, from_number, body, direction, status)
+          VALUES ($1, $2, $3, $4, $5, 'outbound', 'pending')
+          RETURNING id
+        `, [recipientType, recipientId, phone, process.env.TWILIO_PHONE_NUMBER, body]);
+
+        // Send via Twilio
+        if (twilioClient && process.env.TWILIO_PHONE_NUMBER) {
+          const twilioMessage = await twilioClient.messages.create({
+            body: body,
+            from: process.env.TWILIO_PHONE_NUMBER,
+            to: phone
+          });
+
+          await db.query(`
+            UPDATE sms_messages SET status = 'sent', twilio_sid = $1, sent_at = NOW() WHERE id = $2
+          `, [twilioMessage.sid, smsRecord.rows[0].id]);
+        } else {
+          await db.query(`UPDATE sms_messages SET status = 'logged' WHERE id = $1`, [smsRecord.rows[0].id]);
+        }
+
+        results.sent++;
+      } catch (err) {
+        results.failed++;
+        results.errors.push({ recipientId, error: err.message });
+      }
+    }
+
+    res.json(results);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== TEMPLATES ====================
+
+// Get all templates
+router.get('/templates', auth, async (req, res) => {
+  try {
+    const result = await db.query('SELECT * FROM sms_templates WHERE is_active = true ORDER BY name');
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Create template
+router.post('/templates', auth, async (req, res) => {
+  const { name, body, category, variables } = req.body;
+  try {
+    const slug = name.toLowerCase().replace(/[^a-z0-9]+/g, '_');
+    const result = await db.query(`
+      INSERT INTO sms_templates (name, slug, body, category, variables)
+      VALUES ($1, $2, $3, $4, $5)
+      RETURNING *
+    `, [name, slug, body, category || 'general', variables]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Update template
+router.put('/templates/:id', auth, async (req, res) => {
+  const { name, body, category, variables } = req.body;
+  try {
+    const result = await db.query(`
+      UPDATE sms_templates SET
+        name = COALESCE($1, name),
+        body = COALESCE($2, body),
+        category = COALESCE($3, category),
+        variables = COALESCE($4, variables),
+        updated_at = NOW()
+      WHERE id = $5
+      RETURNING *
+    `, [name, body, category, variables, req.params.id]);
+    res.json(result.rows[0]);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Delete template
+router.delete('/templates/:id', auth, async (req, res) => {
+  try {
+    await db.query('UPDATE sms_templates SET is_active = false WHERE id = $1', [req.params.id]);
+    res.json({ success: true });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== LEGACY/COMPATIBILITY ====================
+
+// Get SMS history (legacy endpoint)
+router.get('/history', auth, async (req, res) => {
+  const { recipientType, recipientId, limit = 50 } = req.query;
+  try {
+    let query = `SELECT * FROM sms_messages WHERE 1=1`;
+    const params = [];
+
+    if (recipientType) {
+      params.push(recipientType);
+      query += ` AND recipient_type = $${params.length}`;
+    }
+    if (recipientId) {
+      params.push(recipientId);
+      query += ` AND recipient_id = $${params.length}`;
+    }
+
+    params.push(limit);
+    query += ` ORDER BY created_at DESC LIMIT $${params.length}`;
+
+    const result = await db.query(query, params);
+    res.json(result.rows);
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Broadcast to caregivers (legacy endpoint)
+router.post('/broadcast', auth, async (req, res) => {
+  const { caregiverIds, message } = req.body;
+  return router.handle({ 
+    ...req, 
+    body: { recipientType: 'caregiver', recipientIds: caregiverIds, body: message }
+  }, res);
+});
+
+// ==================== WEBHOOKS & AUTOMATION ====================
+
+// Send shift reminders (called by cron job)
+router.post('/shift-reminders', auth, async (req, res) => {
+  try {
+    const schedules = await db.query(`
+      SELECT s.*, 
+        u.id as caregiver_id, u.phone, u.first_name as cg_first,
+        c.first_name as client_first, c.last_name as client_last
+      FROM schedules s
+      JOIN users u ON s.caregiver_id = u.id
+      JOIN clients c ON s.client_id = c.id
+      WHERE s.date = CURRENT_DATE + INTERVAL '1 day'
+      AND s.status = 'scheduled'
+    `);
+
+    let sent = 0;
+    for (const schedule of schedules.rows) {
+      if (!schedule.phone) continue;
+
+      const message = `Reminder: You have a shift with ${schedule.client_first} ${schedule.client_last} tomorrow at ${schedule.start_time}.`;
+      
+      await db.query(`
+        INSERT INTO sms_messages (recipient_type, recipient_id, to_number, body, direction, status, sent_at)
+        VALUES ('caregiver', $1, $2, $3, 'outbound', 'sent', NOW())
+      `, [schedule.caregiver_id, schedule.phone, message]);
+
+      if (twilioClient && process.env.TWILIO_PHONE_NUMBER) {
+        await twilioClient.messages.create({
+          body: message,
+          from: process.env.TWILIO_PHONE_NUMBER,
+          to: schedule.phone
+        });
+      }
+      sent++;
+    }
+
+    res.json({ sent, total: schedules.rows.length });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// Twilio webhook for incoming messages
+router.post('/webhook/incoming', async (req, res) => {
+  const { From, Body } = req.body;
+  
+  try {
+    await db.query(`
+      INSERT INTO sms_messages (from_number, body, direction, status)
+      VALUES ($1, $2, 'inbound', 'received')
+    `, [From, Body]);
+
+    res.type('text/xml');
+    res.send('<?xml version="1.0" encoding="UTF-8"?><Response></Response>');
+  } catch (error) {
+    console.error('SMS webhook error:', error);
+    res.type('text/xml');
+    res.send('<?xml version="1.0" encoding="UTF-8"?><Response></Response>');
+  }
+});
+
+module.exports = router;
\ No newline at end of file
diff --git a/templates/crm-homecare/backend/src/routes/stripeRoutes.js b/templates/crm-homecare/backend/src/routes/stripeRoutes.js
new file mode 100644
index 0000000..9b0f03f
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/stripeRoutes.js
@@ -0,0 +1,387 @@
+// routes/stripeRoutes.js
+// Stripe Payment Integration for Invoice Payments
+
+const express = require('express');
+const router = express.Router();
+const db = require('../db');
+const auth = require('../middleware/auth');
+
+// Initialize Stripe with your secret key
+const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);
+
+// Your frontend URL for redirects
+const FRONTEND_URL = process.env.FRONTEND_URL || 'http://localhost:3000';
+
+// ==================== CREATE CHECKOUT SESSION ====================
+// POST /api/stripe/create-checkout-session
+// Creates a Stripe checkout session for an invoice
+router.post('/create-checkout-session', auth, async (req, res) => {
+  try {
+    const { invoiceId } = req.body;
+
+    if (!invoiceId) {
+      return res.status(400).json({ error: 'Invoice ID required' });
+    }
+
+    // Get invoice details
+    const invoiceResult = await db.query(`
+      SELECT i.*, c.first_name, c.last_name, c.email as client_email
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoiceResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const invoice = invoiceResult.rows[0];
+
+    if (invoice.payment_status === 'paid') {
+      return res.status(400).json({ error: 'Invoice already paid' });
+    }
+
+    // Calculate amount due (total - amount_paid)
+    const amountDue = parseFloat(invoice.total) - parseFloat(invoice.amount_paid || 0);
+    
+    if (amountDue <= 0) {
+      return res.status(400).json({ error: 'No amount due' });
+    }
+
+    // Create Stripe checkout session
+    const session = await stripe.checkout.sessions.create({
+      payment_method_types: ['card'],
+      line_items: [
+        {
+          price_data: {
+            currency: 'usd',
+            product_data: {
+              name: `Invoice #${invoice.invoice_number || invoice.id.slice(0, 8)}`,
+              description: `Home Care Services - ${invoice.first_name} ${invoice.last_name}`,
+            },
+            unit_amount: Math.round(amountDue * 100), // Stripe uses cents
+          },
+          quantity: 1,
+        },
+      ],
+      mode: 'payment',
+      success_url: `${FRONTEND_URL}/payment-success?session_id={CHECKOUT_SESSION_ID}&invoice_id=${invoiceId}`,
+      cancel_url: `${FRONTEND_URL}/payment-cancelled?invoice_id=${invoiceId}`,
+      customer_email: invoice.client_email,
+      metadata: {
+        invoice_id: invoiceId,
+        client_name: `${invoice.first_name} ${invoice.last_name}`,
+      },
+    });
+
+    // Store the session ID on the invoice for tracking
+    await db.query(`
+      UPDATE invoices 
+      SET stripe_session_id = $1, updated_at = NOW()
+      WHERE id = $2
+    `, [session.id, invoiceId]);
+
+    res.json({ 
+      sessionId: session.id, 
+      url: session.url 
+    });
+  } catch (error) {
+    console.error('Stripe checkout error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== CREATE PAYMENT LINK ====================
+// POST /api/stripe/create-payment-link
+// Creates a shareable payment link for an invoice (no auth required to pay)
+router.post('/create-payment-link', auth, async (req, res) => {
+  try {
+    const { invoiceId } = req.body;
+
+    // Get invoice details
+    const invoiceResult = await db.query(`
+      SELECT i.*, c.first_name, c.last_name, c.email as client_email
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoiceResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const invoice = invoiceResult.rows[0];
+    const amountDue = parseFloat(invoice.total) - parseFloat(invoice.amount_paid || 0);
+
+    if (amountDue <= 0) {
+      return res.status(400).json({ error: 'No amount due' });
+    }
+
+    // Create a Stripe Price for this invoice
+    const price = await stripe.prices.create({
+      currency: 'usd',
+      unit_amount: Math.round(amountDue * 100),
+      product_data: {
+        name: `Invoice #${invoice.invoice_number || invoice.id.slice(0, 8)}`,
+      },
+    });
+
+    // Create payment link
+    const paymentLink = await stripe.paymentLinks.create({
+      line_items: [{ price: price.id, quantity: 1 }],
+      metadata: {
+        invoice_id: invoiceId,
+        client_name: `${invoice.first_name} ${invoice.last_name}`,
+      },
+      after_completion: {
+        type: 'redirect',
+        redirect: {
+          url: `${FRONTEND_URL}/payment-success?invoice_id=${invoiceId}`,
+        },
+      },
+    });
+
+    // Store the payment link on the invoice
+    await db.query(`
+      UPDATE invoices 
+      SET stripe_payment_link = $1, updated_at = NOW()
+      WHERE id = $2
+    `, [paymentLink.url, invoiceId]);
+
+    res.json({ 
+      paymentLink: paymentLink.url,
+      linkId: paymentLink.id
+    });
+  } catch (error) {
+    console.error('Payment link error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== PUBLIC PAYMENT PAGE ====================
+// GET /api/stripe/invoice/:invoiceId/pay
+// Public endpoint - allows anyone with the link to view and pay
+router.get('/invoice/:invoiceId/pay', async (req, res) => {
+  try {
+    const { invoiceId } = req.params;
+
+    const invoiceResult = await db.query(`
+      SELECT 
+        i.id, i.invoice_number, i.total, i.amount_paid, i.payment_status,
+        i.billing_period_start, i.billing_period_end,
+        c.first_name, c.last_name
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoiceResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const invoice = invoiceResult.rows[0];
+    const amountDue = parseFloat(invoice.total) - parseFloat(invoice.amount_paid || 0);
+
+    res.json({
+      invoiceNumber: invoice.invoice_number || invoice.id.slice(0, 8),
+      clientName: `${invoice.first_name} ${invoice.last_name}`,
+      total: invoice.total,
+      amountPaid: invoice.amount_paid || 0,
+      amountDue,
+      status: invoice.payment_status,
+      billingPeriod: {
+        start: invoice.billing_period_start,
+        end: invoice.billing_period_end
+      }
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// POST /api/stripe/invoice/:invoiceId/pay - Create session for public payment
+router.post('/invoice/:invoiceId/pay', async (req, res) => {
+  try {
+    const { invoiceId } = req.params;
+
+    const invoiceResult = await db.query(`
+      SELECT i.*, c.first_name, c.last_name, c.email as client_email
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoiceResult.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    const invoice = invoiceResult.rows[0];
+
+    if (invoice.payment_status === 'paid') {
+      return res.status(400).json({ error: 'Invoice already paid' });
+    }
+
+    const amountDue = parseFloat(invoice.total) - parseFloat(invoice.amount_paid || 0);
+
+    const session = await stripe.checkout.sessions.create({
+      payment_method_types: ['card'],
+      line_items: [
+        {
+          price_data: {
+            currency: 'usd',
+            product_data: {
+              name: `Invoice #${invoice.invoice_number || invoice.id.slice(0, 8)}`,
+              description: `Chippewa Valley Home Care - ${invoice.first_name} ${invoice.last_name}`,
+            },
+            unit_amount: Math.round(amountDue * 100),
+          },
+          quantity: 1,
+        },
+      ],
+      mode: 'payment',
+      success_url: `${FRONTEND_URL}/payment-success?session_id={CHECKOUT_SESSION_ID}&invoice_id=${invoiceId}`,
+      cancel_url: `${FRONTEND_URL}/pay/${invoiceId}?cancelled=true`,
+      customer_email: invoice.client_email,
+      metadata: {
+        invoice_id: invoiceId,
+      },
+    });
+
+    await db.query(`
+      UPDATE invoices 
+      SET stripe_session_id = $1, updated_at = NOW()
+      WHERE id = $2
+    `, [session.id, invoiceId]);
+
+    res.json({ url: session.url });
+  } catch (error) {
+    console.error('Public payment error:', error);
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== STRIPE WEBHOOK ====================
+// POST /api/stripe/webhook
+// Handles Stripe webhook events (payment success, etc.)
+router.post('/webhook', express.raw({ type: 'application/json' }), async (req, res) => {
+  const sig = req.headers['stripe-signature'];
+  const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;
+
+  let event;
+
+  try {
+    event = stripe.webhooks.constructEvent(req.body, sig, webhookSecret);
+  } catch (err) {
+    console.error('Webhook signature verification failed:', err.message);
+    return res.status(400).send(`Webhook Error: ${err.message}`);
+  }
+
+  // Handle the event
+  switch (event.type) {
+    case 'checkout.session.completed': {
+      const session = event.data.object;
+      const invoiceId = session.metadata?.invoice_id;
+
+      if (invoiceId) {
+        const amountPaid = session.amount_total / 100; // Convert from cents
+
+        // Update invoice
+        await db.query(`
+          UPDATE invoices 
+          SET 
+            amount_paid = COALESCE(amount_paid, 0) + $1,
+            payment_status = CASE 
+              WHEN COALESCE(amount_paid, 0) + $1 >= total THEN 'paid'
+              ELSE 'partial'
+            END,
+            stripe_payment_id = $2,
+            paid_at = NOW(),
+            updated_at = NOW()
+          WHERE id = $3
+        `, [amountPaid, session.payment_intent, invoiceId]);
+
+        console.log(`✅ Payment received for invoice ${invoiceId}: $${amountPaid}`);
+      }
+      break;
+    }
+
+    case 'payment_intent.payment_failed': {
+      const paymentIntent = event.data.object;
+      console.log(`❌ Payment failed: ${paymentIntent.last_payment_error?.message}`);
+      break;
+    }
+
+    default:
+      console.log(`Unhandled event type: ${event.type}`);
+  }
+
+  res.json({ received: true });
+});
+
+// ==================== VERIFY PAYMENT ====================
+// GET /api/stripe/verify-payment/:sessionId
+// Verify a payment was successful (for success page)
+router.get('/verify-payment/:sessionId', async (req, res) => {
+  try {
+    const { sessionId } = req.params;
+
+    const session = await stripe.checkout.sessions.retrieve(sessionId);
+
+    if (session.payment_status === 'paid') {
+      res.json({
+        success: true,
+        amount: session.amount_total / 100,
+        invoiceId: session.metadata?.invoice_id,
+        customerEmail: session.customer_email
+      });
+    } else {
+      res.json({
+        success: false,
+        status: session.payment_status
+      });
+    }
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+// ==================== GET PAYMENT HISTORY ====================
+// GET /api/stripe/payments/:invoiceId
+router.get('/payments/:invoiceId', auth, async (req, res) => {
+  try {
+    const { invoiceId } = req.params;
+
+    // Get invoice with payment info
+    const invoice = await db.query(`
+      SELECT 
+        i.*,
+        c.first_name, c.last_name
+      FROM invoices i
+      JOIN clients c ON i.client_id = c.id
+      WHERE i.id = $1
+    `, [invoiceId]);
+
+    if (invoice.rows.length === 0) {
+      return res.status(404).json({ error: 'Invoice not found' });
+    }
+
+    // If there's a Stripe payment ID, get details from Stripe
+    let stripePayment = null;
+    if (invoice.rows[0].stripe_payment_id) {
+      try {
+        stripePayment = await stripe.paymentIntents.retrieve(invoice.rows[0].stripe_payment_id);
+      } catch (e) {
+        console.log('Could not retrieve Stripe payment:', e.message);
+      }
+    }
+
+    res.json({
+      invoice: invoice.rows[0],
+      stripePayment
+    });
+  } catch (error) {
+    res.status(500).json({ error: error.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/timeTrackingRoutes.js b/templates/crm-homecare/backend/src/routes/timeTrackingRoutes.js
new file mode 100644
index 0000000..3c7dcdb
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/timeTrackingRoutes.js
@@ -0,0 +1,286 @@
+// routes/timeTrackingRoutes.js
+const express = require('express');
+const router = express.Router();
+const { v4: uuidv4 } = require('uuid');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// GET /api/time-entries/active
+router.get('/active', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT te.*, c.first_name as client_first_name, c.last_name as client_last_name
+       FROM time_entries te JOIN clients c ON te.client_id = c.id
+       WHERE te.caregiver_id = $1 AND te.end_time IS NULL ORDER BY te.start_time DESC LIMIT 1`,
+      [req.user.id]
+    );
+    if (result.rows.length === 0) return res.json(null);
+    const entry = result.rows[0];
+    res.json({ id: entry.id, client_id: entry.client_id, start_time: entry.start_time, client_name: `${entry.client_first_name} ${entry.client_last_name}` });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/recent
+router.get('/recent', verifyToken, async (req, res) => {
+  try {
+    const limit = parseInt(req.query.limit) || 10;
+    const result = await db.query(
+      `SELECT te.*, c.first_name as client_first_name, c.last_name as client_last_name
+       FROM time_entries te JOIN clients c ON te.client_id = c.id
+       WHERE te.caregiver_id = $1 AND te.end_time IS NOT NULL ORDER BY te.start_time DESC LIMIT $2`,
+      [req.user.id, limit]
+    );
+    res.json(result.rows.map(e => ({
+      id: e.id, client_id: e.client_id, start_time: e.start_time, end_time: e.end_time, notes: e.notes,
+      hours_worked: e.duration_minutes ? (e.duration_minutes / 60).toFixed(2) : null,
+      client_name: `${e.client_first_name} ${e.client_last_name}`
+    })));
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/check-warnings
+router.post('/check-warnings', verifyToken, async (req, res) => {
+  try {
+    const { timeEntryId } = req.body;
+    const entry = await db.query(`
+      SELECT te.*, te.allotted_minutes, te.start_time, c.first_name as client_first, c.last_name as client_last
+      FROM time_entries te JOIN clients c ON te.client_id = c.id
+      WHERE te.id = $1 AND te.caregiver_id = $2 AND te.is_complete = false
+    `, [timeEntryId, req.user.id]);
+    if (!entry.rows[0] || !entry.rows[0].allotted_minutes) return res.json({ warning: false });
+    const te = entry.rows[0];
+    const minutesElapsed = (new Date() - new Date(te.start_time)) / 60000;
+    const minutesRemaining = te.allotted_minutes - minutesElapsed;
+    if (minutesRemaining >= 14 && minutesRemaining <= 16) {
+      try {
+        const { sendPushToUser } = require('./pushNotificationRoutes');
+        const scheduledEnd = new Date(new Date(te.start_time).getTime() + te.allotted_minutes * 60000);
+        const endTime = scheduledEnd.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
+        sendPushToUser(req.user.id, { title: '⏰ 15-Minute Warning', body: `Shift with ${te.client_first} ${te.client_last} ends at ${endTime}. Start wrapping up!`, icon: '/icon-192.png', tag: 'shift-warning-15min', data: { type: 'shift_warning', timeEntryId } });
+      } catch {}
+      return res.json({ warning: true, minutesRemaining: Math.round(minutesRemaining), message: '15 minutes remaining — start wrapping up' });
+    }
+    if (minutesElapsed > te.allotted_minutes + 5) {
+      return res.json({ warning: true, overTime: true, minutesOver: Math.round(minutesElapsed - te.allotted_minutes), message: 'Over scheduled time — please clock out' });
+    }
+    res.json({ warning: false, minutesRemaining: Math.round(minutesRemaining), minutesElapsed: Math.round(minutesElapsed) });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/caregiver-history/:caregiverId
+router.get('/caregiver-history/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const { startDate, endDate, limit = 50 } = req.query;
+    const params = [req.params.caregiverId, limit];
+    if (startDate) params.push(startDate);
+    if (endDate) params.push(endDate);
+    const result = await db.query(
+      `SELECT te.*, c.first_name as client_first_name, c.last_name as client_last_name,
+        c.address as client_address, c.city as client_city,
+        (SELECT COUNT(*) FROM gps_tracking gt WHERE gt.time_entry_id = te.id) as gps_point_count
+       FROM time_entries te LEFT JOIN clients c ON te.client_id = c.id
+       WHERE te.caregiver_id = $1
+         ${startDate ? `AND te.start_time >= $${params.indexOf(startDate) + 1}::timestamptz` : ''}
+         ${endDate ? `AND te.start_time <= $${params.indexOf(endDate) + 1}::timestamptz` : ''}
+       ORDER BY te.start_time DESC LIMIT $2`,
+      params
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/caregiver/:caregiverId
+router.get('/caregiver/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT te.*, c.first_name as client_first_name, c.last_name as client_last_name
+       FROM time_entries te JOIN clients c ON te.client_id = c.id
+       WHERE te.caregiver_id = $1 ORDER BY te.start_time DESC`, [req.params.caregiverId]
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/discrepancies (mounted under /api/payroll in server)
+// — kept here as /api/time-entries/discrepancies
+router.get('/discrepancies', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { startDate, endDate, minDiscrepancy = 5 } = req.query;
+    const start = startDate || new Date(Date.now() - 30*86400000).toISOString().split('T')[0];
+    const end = endDate || new Date().toISOString().split('T')[0];
+    const result = await db.query(`
+      SELECT te.id, te.start_time, te.end_time, te.duration_minutes, te.allotted_minutes, te.billable_minutes, te.discrepancy_minutes,
+        ROUND(te.duration_minutes::numeric/60,2) as actual_hours,
+        ROUND(COALESCE(te.allotted_minutes,te.duration_minutes)::numeric/60,2) as allotted_hours,
+        ROUND(te.billable_minutes::numeric/60,2) as billable_hours,
+        ROUND((te.duration_minutes-COALESCE(te.allotted_minutes,te.duration_minutes))::numeric/60,2) as discrepancy_hours,
+        u.first_name as caregiver_first, u.last_name as caregiver_last, u.default_pay_rate,
+        ROUND(te.billable_minutes::numeric/60*u.default_pay_rate,2) as billable_pay,
+        ROUND(te.duration_minutes::numeric/60*u.default_pay_rate,2) as actual_pay,
+        ROUND((te.duration_minutes-COALESCE(te.allotted_minutes,te.duration_minutes))::numeric/60*u.default_pay_rate,2) as overage_cost,
+        c.first_name as client_first, c.last_name as client_last
+      FROM time_entries te JOIN users u ON te.caregiver_id=u.id JOIN clients c ON te.client_id=c.id
+      WHERE te.is_complete=true AND te.start_time>=$1::date AND te.start_time<$2::date+INTERVAL '1 day'
+        AND te.allotted_minutes IS NOT NULL AND ABS(COALESCE(te.discrepancy_minutes,0))>=$3
+      ORDER BY ABS(COALESCE(te.discrepancy_minutes,0)) DESC
+    `, [start, end, parseInt(minDiscrepancy)]);
+    const totals = result.rows.reduce((acc, r) => {
+      acc.totalShifts++;
+      acc.totalActualHours += parseFloat(r.actual_hours||0);
+      acc.totalAllottedHours += parseFloat(r.allotted_hours||0);
+      acc.totalBillableHours += parseFloat(r.billable_hours||0);
+      acc.totalOverageCost += parseFloat(r.overage_cost||0);
+      if (parseFloat(r.discrepancy_hours) > 0) acc.overageCount++;
+      if (parseFloat(r.discrepancy_hours) < 0) acc.underageCount++;
+      return acc;
+    }, { totalShifts:0, totalActualHours:0, totalAllottedHours:0, totalBillableHours:0, totalOverageCost:0, overageCount:0, underageCount:0 });
+    res.json({ discrepancies: result.rows, totals, period: { start, end } });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries
+router.get('/', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT te.*, u.first_name, u.last_name, c.first_name as client_first_name, c.last_name as client_last_name
+       FROM time_entries te JOIN users u ON te.caregiver_id=u.id JOIN clients c ON te.client_id=c.id
+       ORDER BY te.start_time DESC`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/time-entries/clock-in
+router.post('/clock-in', verifyToken, async (req, res) => {
+  try {
+    const { clientId, latitude, longitude, scheduleId } = req.body;
+    const entryId = uuidv4();
+    let allottedMinutes = null, linkedScheduleId = scheduleId || null;
+    try {
+      const today = new Date();
+      const sched = await db.query(`
+        SELECT id, start_time, end_time FROM schedules
+        WHERE caregiver_id=$1 AND client_id=$2 AND is_active=true
+          AND (day_of_week=$3 OR (date IS NOT NULL AND date::date=$4::date))
+        ORDER BY date DESC NULLS LAST LIMIT 1
+      `, [req.user.id, clientId, today.getDay(), today.toISOString().split('T')[0]]);
+      if (sched.rows[0]) {
+        linkedScheduleId = linkedScheduleId || sched.rows[0].id;
+        if (sched.rows[0].start_time && sched.rows[0].end_time) {
+          const [sh, sm] = sched.rows[0].start_time.split(':').map(Number);
+          const [eh, em] = sched.rows[0].end_time.split(':').map(Number);
+          allottedMinutes = (eh*60+em) - (sh*60+sm);
+        }
+      }
+    } catch(e) {}
+    const result = await db.query(
+      `INSERT INTO time_entries (id, caregiver_id, client_id, start_time, clock_in_location, schedule_id, allotted_minutes)
+       VALUES ($1,$2,$3,NOW(),$4,$5,$6) RETURNING *`,
+      [entryId, req.user.id, clientId, JSON.stringify({ lat: latitude, lng: longitude }), linkedScheduleId, allottedMinutes]
+    );
+    await auditLog(req.user.id, 'CREATE', 'time_entries', entryId, null, result.rows[0]);
+    try {
+      const { sendPushToUser } = require('./pushNotificationRoutes');
+      let clientName = null;
+      if (clientId) { const cl = await db.query('SELECT first_name, last_name FROM clients WHERE id=$1', [clientId]); if (cl.rows[0]) clientName = `${cl.rows[0].first_name} ${cl.rows[0].last_name}`; }
+      const startTimeFormatted = new Date(result.rows[0].start_time).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
+      sendPushToUser(req.user.id, { title: '✅ Clocked In', body: `You are clocked in${clientName ? ` for ${clientName}` : ''}. Started at ${startTimeFormatted}.`, icon: '/icon-192.png', tag: `clock-in-${entryId}`, data: { type: 'clock_in', timeEntryId: entryId } });
+    } catch {}
+    res.status(201).json({ id: result.rows[0].id, client_id: result.rows[0].client_id, start_time: result.rows[0].start_time });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/time-entries/:id/clock-out
+router.post('/:id/clock-out', verifyToken, async (req, res) => {
+  try {
+    const { latitude, longitude, notes } = req.body;
+    const timeEntry = await db.query(
+      `SELECT te.*, c.first_name as client_first_name, c.last_name as client_last_name
+       FROM time_entries te LEFT JOIN clients c ON te.client_id=c.id WHERE te.id=$1`, [req.params.id]
+    );
+    if (timeEntry.rows.length === 0) return res.status(404).json({ error: 'Time entry not found' });
+    const durationMinutes = Math.round((new Date() - new Date(timeEntry.rows[0].start_time)) / 60000);
+    const allottedMinutes = timeEntry.rows[0].allotted_minutes;
+    const discrepancyMinutes = allottedMinutes ? durationMinutes - allottedMinutes : null;
+    const billableMinutes = allottedMinutes ? Math.min(durationMinutes, allottedMinutes) : durationMinutes;
+    const result = await db.query(
+      `UPDATE time_entries SET end_time=NOW(), clock_out_location=$1, duration_minutes=$2, is_complete=true,
+        notes=$3, discrepancy_minutes=$4, billable_minutes=$5, updated_at=NOW() WHERE id=$6 RETURNING *`,
+      [latitude && longitude ? JSON.stringify({ lat: latitude, lng: longitude }) : null, durationMinutes, notes || null, discrepancyMinutes, billableMinutes, req.params.id]
+    );
+    await auditLog(req.user.id, 'UPDATE', 'time_entries', req.params.id, null, result.rows[0]);
+    try {
+      const { sendPushToUser } = require('./pushNotificationRoutes');
+      const clientName = timeEntry.rows[0].client_first_name ? `${timeEntry.rows[0].client_first_name} ${timeEntry.rows[0].client_last_name}` : null;
+      const durationStr = durationMinutes >= 60 ? `${Math.floor(durationMinutes/60)}h ${durationMinutes%60}m` : `${durationMinutes}m`;
+      sendPushToUser(req.user.id, { title: '🕐 Clocked Out', body: `Shift complete${clientName ? ` — ${clientName}` : ''}. Duration: ${durationStr}.`, icon: '/icon-192.png', tag: `clock-out-${req.params.id}`, data: { type: 'clock_out' } });
+    } catch {}
+    try { const { createEVVFromTimeEntry } = require('./sandataRoutes'); createEVVFromTimeEntry(req.params.id).catch(e => console.error('[EVV auto-create]', e.message)); } catch(e) {}
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/time-entries/:id/gps
+router.post('/:id/gps', verifyToken, async (req, res) => {
+  try {
+    const { latitude, longitude, accuracy, speed, heading } = req.body;
+    const entryCheck = await db.query(`SELECT id FROM time_entries WHERE id=$1 AND caregiver_id=$2 AND end_time IS NULL`, [req.params.id, req.user.id]);
+    if (entryCheck.rows.length === 0) return res.status(404).json({ error: 'Active time entry not found' });
+    await db.query(`INSERT INTO gps_tracking (caregiver_id, time_entry_id, latitude, longitude, accuracy, speed, heading, timestamp) VALUES ($1,$2,$3,$4,$5,$6,$7,NOW())`,
+      [req.user.id, req.params.id, latitude, longitude, accuracy||null, speed||null, heading||null]);
+    res.json({ success: true });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/time-entries/:id/gps
+router.get('/:id/gps', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT latitude, longitude, accuracy, speed, heading, timestamp FROM gps_tracking WHERE time_entry_id=$1 ORDER BY timestamp ASC`, [req.params.id]);
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+
+// GET /api/time-entries/caregiver-gps/:caregiverId
+// Returns recent shifts with clock-in/out GPS + full GPS trail per shift
+router.get('/caregiver-gps/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const { caregiverId } = req.params;
+    const limit = parseInt(req.query.limit) || 20;
+
+    // Get recent time entries with clock in/out locations
+    const entries = await db.query(
+      `SELECT te.id, te.start_time, te.end_time, te.is_complete,
+              te.clock_in_location, te.clock_out_location,
+              ROUND(EXTRACT(EPOCH FROM (COALESCE(te.end_time, NOW()) - te.start_time))/3600.0::numeric, 2) as hours,
+              c.first_name as client_first, c.last_name as client_last,
+              c.address as client_address, c.city as client_city,
+              c.address as client_address
+       FROM time_entries te
+       LEFT JOIN clients c ON te.client_id = c.id
+       WHERE te.caregiver_id = $1
+       ORDER BY te.start_time DESC
+       LIMIT $2`,
+      [caregiverId, limit]
+    );
+
+    // For each entry, fetch GPS trail
+    const results = await Promise.all(entries.rows.map(async (entry) => {
+      const gps = await db.query(
+        `SELECT latitude, longitude, accuracy, speed, timestamp
+         FROM gps_tracking
+         WHERE time_entry_id = $1
+         ORDER BY timestamp ASC`,
+        [entry.id]
+      );
+      return { ...entry, gpsTrail: gps.rows };
+    }));
+
+    res.json(results);
+  } catch (err) {
+    console.error('caregiver-gps error:', err);
+    res.status(500).json({ error: err.message });
+  }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/routes/users.js b/templates/crm-homecare/backend/src/routes/users.js
new file mode 100644
index 0000000..5370ba6
--- /dev/null
+++ b/templates/crm-homecare/backend/src/routes/users.js
@@ -0,0 +1,81 @@
+// routes/users.js — mounted at /api/users
+const express = require('express');
+const router = express.Router();
+const bcrypt = require('bcryptjs');
+const db = require('../db');
+const { verifyToken, requireAdmin, auditLog } = require('../middleware/shared');
+
+// GET /api/users?role=caregiver
+router.get('/', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { role } = req.query;
+    let query = `SELECT id, email, first_name, last_name, phone, role, is_active, hire_date, default_pay_rate FROM users WHERE 1=1`;
+    const params = [];
+    if (role) { params.push(role); query += ` AND role = $${params.length}`; }
+    query += ` ORDER BY first_name, last_name`;
+    res.json((await db.query(query, params)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/users/caregivers
+router.get('/caregivers', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(
+      `SELECT id, email, first_name, last_name, phone, hire_date, is_active, certifications, role, default_pay_rate
+       FROM users WHERE role = 'caregiver' ORDER BY first_name`
+    )).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/users/caregivers/:caregiverId
+router.get('/caregivers/:caregiverId', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(`SELECT * FROM users WHERE id = $1 AND role = 'caregiver'`, [req.params.caregiverId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Caregiver not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/users/admins
+router.get('/admins', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(
+      `SELECT id, email, first_name, last_name, phone, hire_date, is_active, role FROM users WHERE role = 'admin' ORDER BY first_name`
+    )).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// GET /api/users/all
+router.get('/all', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    res.json((await db.query(
+      `SELECT id, email, first_name, last_name, phone, role, is_active, hire_date, default_pay_rate FROM users ORDER BY first_name, last_name`
+    )).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// POST /api/users/convert-to-admin
+router.post('/convert-to-admin', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { userId } = req.body;
+    const result = await db.query(`UPDATE users SET role = 'admin', updated_at = NOW() WHERE id = $1 RETURNING *`, [userId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'User not found' });
+    await auditLog(req.user.id, 'UPDATE', 'users', userId, null, result.rows[0]);
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// PUT /api/users/:caregiverId/reset-password
+router.put('/:caregiverId/reset-password', verifyToken, requireAdmin, async (req, res) => {
+  try {
+    const { newPassword } = req.body;
+    if (!newPassword || newPassword.length < 8) return res.status(400).json({ error: 'Password must be at least 8 characters' });
+    const hashed = await bcrypt.hash(newPassword, 10);
+    const result = await db.query(`UPDATE users SET password_hash = $1, updated_at = NOW() WHERE id = $2 RETURNING id, email, first_name, last_name`, [hashed, req.params.caregiverId]);
+    if (result.rows.length === 0) return res.status(404).json({ error: 'User not found' });
+    await auditLog(req.user.id, 'UPDATE', 'users', req.params.caregiverId, null, { action: 'password_reset' });
+    res.json({ success: true, user: result.rows[0] });
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+module.exports = router;
diff --git a/templates/crm-homecare/backend/src/server.js b/templates/crm-homecare/backend/src/server.js
new file mode 100644
index 0000000..c2bb602
--- /dev/null
+++ b/templates/crm-homecare/backend/src/server.js
@@ -0,0 +1,342 @@
+// server.js - HomeCare CRM API
+// Pure setup and route mounting — all logic lives in /routes
+const express = require('express');
+const cors = require('cors');
+const helmet = require('helmet');
+const compression = require('compression');
+const rateLimit = require('express-rate-limit');
+const auditLogger = require('./middleware/auditLogger');
+const dotenv = require('dotenv');
+const db = require('./db');
+
+dotenv.config();
+
+// ============ STARTUP VALIDATION ============
+const REQUIRED_ENV = ['JWT_SECRET', 'DATABASE_URL'];
+const MISSING = REQUIRED_ENV.filter(k => !process.env[k]);
+if (MISSING.length) {
+  console.error(`\n❌ FATAL: Missing required environment variables:\n  ${MISSING.join('\n  ')}\n`);
+  process.exit(1);
+}
+
+const WARN_IF_MISSING = ['ENCRYPTION_KEY', 'STRIPE_SECRET_KEY', 'TWILIO_ACCOUNT_SID', 'VAPID_PUBLIC_KEY', 'VAPID_PRIVATE_KEY', 'FRONTEND_URL', 'ALLOWED_ORIGINS'];
+WARN_IF_MISSING.filter(k => !process.env[k]).forEach(k => console.warn(`⚠️  Optional env var not set: ${k}`));
+
+const app = express();
+app.set('trust proxy', 1);
+const port = process.env.PORT || 5000;
+
+// ============ SECURITY MIDDLEWARE ============
+app.use(helmet());
+app.use(compression());
+
+// CORS — CVHC defaults + ALLOWED_ORIGINS env var for additional domains (white-labeling)
+// To add a new domain: set ALLOWED_ORIGINS=https://newclient.netlify.app in Render env vars
+app.use(cors({
+  origin: (origin, callback) => {
+    const defaultOrigins = [
+      'https://cvhc-crm.netlify.app',
+      'https://chippewavalleyhomecare.com',
+      'https://www.chippewavalleyhomecare.com',
+      process.env.FRONTEND_URL,
+      'http://localhost:3000',
+      'http://localhost:5173',
+      'https://localhost',      // Capacitor Android APK origin
+      'capacitor://localhost',   // Capacitor iOS origin
+    ].filter(Boolean);
+
+    const extraOrigins = (process.env.ALLOWED_ORIGINS || '')
+      .split(',').map(o => o.trim()).filter(Boolean);
+
+    const allowed = [...new Set([...defaultOrigins, ...extraOrigins])];
+
+    if (!origin || allowed.includes(origin)) return callback(null, true);
+    callback(new Error(`CORS: origin ${origin} not allowed. Add it to ALLOWED_ORIGINS env var.`));
+  },
+  credentials: true,
+  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
+  allowedHeaders: ['Content-Type', 'Authorization']
+}));
+
+// Rate limiters
+const limiter = rateLimit({
+  windowMs: 15 * 60 * 1000, max: 500, standardHeaders: true, legacyHeaders: false,
+  skip: (req) => req.path.includes('/api/messages/unread-count') || req.path.includes('/api/push/unread-count')
+});
+app.use(limiter);
+app.use(express.json({ limit: '10mb' }));
+app.use(express.urlencoded({ limit: '10mb', extended: true }));
+
+const authLimiter = rateLimit({
+  windowMs: 15 * 60 * 1000, max: 5,
+  message: { error: 'Too many login attempts. Try again in 15 minutes.' }
+});
+app.use('/api/auth/login', authLimiter);
+app.use('/api/auth/register-caregiver', authLimiter);
+app.use('/api/auth/register-admin', authLimiter);
+
+app.use(auditLogger(db.pool));
+
+// ============ HEALTH CHECK ============
+app.get('/health', (req, res) => res.json({ status: 'ok', timestamp: new Date() }));
+
+// ============ ROUTE IMPORTS ============
+const { verifyToken } = require('./middleware/shared');
+
+// Core resources
+const authRoutes         = require('./routes/authRoutes');
+const caregiverRoutes    = require('./routes/caregiverRoutes');
+const clientsRoutes      = require('./routes/clientsRoutes');
+const timeTrackingRoutes = require('./routes/timeTrackingRoutes');
+const dashboardRoutes    = require('./routes/dashboardRoutes');
+const schedulingRoutes   = require('./routes/schedulingRoutes');
+const billingRoutes      = require('./routes/billingRoutes');
+
+// Split from miscRoutes — each focused domain
+const referralRoutes     = require('./routes/referralRoutes');
+const notificationRoutes = require('./routes/notificationRoutes');
+const prospectRoutes     = require('./routes/prospectRoutes');
+const pricingRoutes      = require('./routes/pricingRoutes');
+const absenceRoutes      = require('./routes/absenceRoutes');
+const expenseRoutes      = require('./routes/expenseRoutes');
+const clinicalRoutes     = require('./routes/clinicalRoutes');
+
+// ============ ROUTE MOUNTING ============
+
+// Auth (routes handle their own token requirements)
+app.use('/api/auth', authRoutes);
+
+// Core resources
+app.use('/api/caregivers',   verifyToken, caregiverRoutes);
+app.use('/api/clients',      verifyToken, clientsRoutes);
+app.use('/api/time-entries', verifyToken, timeTrackingRoutes);
+app.use('/api/dashboard',    verifyToken, dashboardRoutes);
+app.use('/api/scheduling',   verifyToken, schedulingRoutes);
+app.use('/api/billing',      verifyToken, billingRoutes);
+
+// Domain-focused routes (mounted at /api, each defines its own paths)
+app.use('/api', referralRoutes);
+app.use('/api', notificationRoutes);
+app.use('/api', prospectRoutes);
+app.use('/api', pricingRoutes);
+app.use('/api', absenceRoutes);
+app.use('/api', expenseRoutes);
+app.use('/api', clinicalRoutes);
+
+// Dedicated route files (mounted at their own prefixes — no conflicts)
+app.use('/api/reports',           verifyToken, require('./routes/reports'));
+app.use('/api/payroll',           verifyToken, require('./routes/payrollRoutes'));
+app.use('/api/audit-logs',        verifyToken, require('./routes/auditLogs'));
+app.use('/api/users',             verifyToken, require('./routes/users'));
+app.use('/api/claims',            verifyToken, require('./routes/claimsRoutes'));
+app.use('/api/stripe',                         require('./routes/stripeRoutes'));
+app.use('/api/applications', (req, res, next) => {
+  // POST / is public (job application form from website)
+  // Everything else requires admin auth
+  if (req.method === 'POST' && req.path === '/') return next();
+  return verifyToken(req, res, next);
+}, require('./routes/applicationsRoutes'));
+app.use('/api/schedules',         verifyToken, require('./routes/schedulesRoutes'));
+app.use('/api/sms',               verifyToken, require('./routes/smsRoutes'));
+app.use('/api/open-shifts',       verifyToken, require('./routes/openShiftsRoutes'));
+app.use('/api/medications',       verifyToken, require('./routes/medicationsRoutes'));
+app.use('/api/documents',         verifyToken, require('./routes/documentsRoutes'));
+app.use('/api/adl',               verifyToken, require('./routes/adlRoutes'));
+app.use('/api/background-checks', verifyToken, require('./routes/backgroundChecksRoutes'));
+app.use('/api/family-portal', (req, res, next) => {
+  // Defense-in-depth: admin sub-routes require a valid admin token even though
+  // familyPortalRoutes has its own auth. Belt AND suspenders.
+  if (req.path.startsWith('/admin')) return verifyToken(req, res, next);
+  next();
+}, require('./routes/familyPortalRoutes'));
+app.use('/api/client-portal', (req, res, next) => {
+  // Public routes: /login, /set-password — no token needed
+  // Portal routes: /portal/* — clientAuth middleware inside the router handles it
+  // Admin routes: /admin/* — require valid admin token here as belt-and-suspenders
+  if (req.path.startsWith('/admin')) return verifyToken(req, res, next);
+  next();
+}, require('./routes/clientPortalRoutes'));
+app.use('/api/shift-swaps',       verifyToken, require('./routes/shiftSwapsRoutes'));
+app.use('/api/alerts',            verifyToken, require('./routes/alertsRoutes'));
+app.use('/api/route-optimizer',   verifyToken, require('./routes/routeOptimizerRoutes'));
+app.use('/api/matching',          verifyToken, require('./routes/matchingRoutes'));
+app.use('/api/emergency',         verifyToken, require('./routes/emergencyRoutes'));
+app.use('/api/messages',          verifyToken, require('./routes/messageRoutes'));
+app.use('/api/remittance',        verifyToken, require('./routes/remittanceRoutes'));
+app.use('/api/sandata',           verifyToken, require('./routes/sandataRoutes'));
+app.use('/api/authorizations',    verifyToken, require('./routes/authorizationRoutes'));
+app.use('/api/failsafe',          verifyToken, require('./routes/failsafeRoutes'));
+app.use('/api/edi',               verifyToken, require('./routes/ediRoutes'));
+app.use('/api/gusto',             verifyToken, require('./routes/gustoRoutes'));
+app.use('/api/optimizer',         verifyToken, require('./routes/optimizerRoutes'));
+app.use('/api/roster-optimizer',  verifyToken, require('./routes/rosterOptimizerRoutes'));
+app.use('/api/push',              verifyToken, require('./routes/pushNotificationRoutes').router);
+app.use('/api/communication-log', verifyToken, require('./routes/communicationRoutes'));
+app.use('/api/no-show',           verifyToken, require('./routes/noShowRoutes'));
+app.use('/api/forms',             verifyToken, require('./routes/formBuilderRoutes'));
+app.use('/api/forecast',          verifyToken, require('./routes/forecastRoutes'));
+
+// ── EXPLICIT ROUTES (Express path-boundary workarounds) ──────────────────────
+
+// /api/schedules-all — router.get('-all') can't match this path due to Express
+// path segment rules, so these live directly on the app instance.
+app.get('/api/schedules-all', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT s.*, s.frequency, s.effective_date, s.anchor_date,
+              u.first_name as caregiver_first_name, u.last_name as caregiver_last_name,
+              c.first_name as client_first_name, c.last_name as client_last_name
+       FROM schedules s
+       JOIN users u ON s.caregiver_id = u.id
+       JOIN clients c ON s.client_id = c.id
+       WHERE s.is_active = true
+       ORDER BY s.day_of_week, s.date, s.start_time`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+app.put('/api/schedules-all/:scheduleId', verifyToken, async (req, res) => {
+  try {
+    const { scheduleId } = req.params;
+    const { clientId, dayOfWeek, date, startTime, endTime, notes, frequency, effectiveDate, anchorDate } = req.body;
+    if (startTime && endTime && startTime >= endTime) return res.status(400).json({ error: 'End time must be after start time' });
+    const result = await db.query(
+      `UPDATE schedules SET client_id=COALESCE($1,client_id), day_of_week=$2, date=$3,
+        start_time=COALESCE($4,start_time), end_time=COALESCE($5,end_time), notes=$6,
+        frequency=COALESCE($7,frequency), effective_date=COALESCE($8,effective_date),
+        anchor_date=COALESCE($9,anchor_date), updated_at=NOW()
+       WHERE id=$10 AND is_active=true RETURNING *`,
+      [clientId, dayOfWeek !== undefined ? dayOfWeek : null, date || null, startTime, endTime,
+       notes || null, frequency || 'weekly', effectiveDate || null, anchorDate || null, scheduleId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Schedule not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// /api/payroll-periods — path has a hyphen so can't live inside payrollRoutes
+// (which is mounted at /api/payroll). Alias to /api/payroll/periods.
+app.get('/api/payroll-periods', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT DISTINCT pay_period_start, pay_period_end FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// ============ GLOBAL ERROR HANDLER ============
+app.use((err, req, res, next) => {
+  const status = err.status || err.statusCode || 500;
+  console.error(`[ERROR] ${req.method} ${req.path}`, {
+    status, message: err.message,
+    stack: process.env.NODE_ENV === 'development' ? err.stack : undefined,
+  });
+  res.status(status).json({
+    error: status < 500 ? err.message : 'An unexpected error occurred. Please try again.',
+  });
+});
+
+// ============ ONE-TIME MIGRATION ENDPOINT ============
+// Hit GET /api/run-migration-v7 once to create new tables, then this can be removed
+app.get('/api/run-migration-v7', async (req, res) => {
+  const db = require('./db');
+  try {
+    await db.query(`
+      CREATE TABLE IF NOT EXISTS communication_log (
+        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
+        entity_type VARCHAR(20) NOT NULL CHECK (entity_type IN ('client','caregiver')),
+        entity_id UUID NOT NULL,
+        log_type VARCHAR(30) NOT NULL DEFAULT 'note' CHECK (log_type IN ('note','call','email','text','visit','incident','complaint','compliment','other')),
+        direction VARCHAR(10) CHECK (direction IN ('inbound','outbound','internal')),
+        subject VARCHAR(255),
+        body TEXT NOT NULL,
+        logged_by UUID REFERENCES users(id),
+        logged_by_name VARCHAR(100),
+        follow_up_date DATE,
+        follow_up_done BOOLEAN DEFAULT FALSE,
+        is_pinned BOOLEAN DEFAULT FALSE,
+        created_at TIMESTAMPTZ DEFAULT NOW(),
+        updated_at TIMESTAMPTZ DEFAULT NOW()
+      );
+      CREATE INDEX IF NOT EXISTS idx_comm_log_entity ON communication_log(entity_type, entity_id);
+      CREATE INDEX IF NOT EXISTS idx_comm_log_created ON communication_log(created_at DESC);
+      CREATE INDEX IF NOT EXISTS idx_comm_log_followup ON communication_log(follow_up_date) WHERE follow_up_done = FALSE;
+
+      CREATE TABLE IF NOT EXISTS noshow_alert_config (
+        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
+        grace_minutes INT NOT NULL DEFAULT 15,
+        notify_admin BOOLEAN DEFAULT TRUE,
+        notify_caregiver BOOLEAN DEFAULT TRUE,
+        notify_client_family BOOLEAN DEFAULT FALSE,
+        admin_phone VARCHAR(20),
+        admin_email VARCHAR(255),
+        is_active BOOLEAN DEFAULT TRUE,
+        created_at TIMESTAMPTZ DEFAULT NOW(),
+        updated_at TIMESTAMPTZ DEFAULT NOW()
+      );
+      INSERT INTO noshow_alert_config (grace_minutes, notify_admin, notify_caregiver, is_active)
+      SELECT 15, TRUE, TRUE, TRUE WHERE NOT EXISTS (SELECT 1 FROM noshow_alert_config);
+
+      CREATE TABLE IF NOT EXISTS noshow_alerts (
+        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
+        schedule_id UUID,
+        caregiver_id UUID REFERENCES users(id),
+        client_id UUID REFERENCES clients(id),
+        shift_date DATE NOT NULL,
+        expected_start TIME NOT NULL,
+        alerted_at TIMESTAMPTZ DEFAULT NOW(),
+        resolved_at TIMESTAMPTZ,
+        resolved_by UUID REFERENCES users(id),
+        resolution_note TEXT,
+        status VARCHAR(20) DEFAULT 'open' CHECK (status IN ('open','resolved','false_alarm')),
+        sms_sent BOOLEAN DEFAULT FALSE,
+        created_at TIMESTAMPTZ DEFAULT NOW()
+      );
+      CREATE INDEX IF NOT EXISTS idx_noshow_status ON noshow_alerts(status, shift_date);
+      CREATE INDEX IF NOT EXISTS idx_noshow_caregiver ON noshow_alerts(caregiver_id);
+
+      CREATE TABLE IF NOT EXISTS form_templates (
+        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
+        name VARCHAR(255) NOT NULL,
+        description TEXT,
+        category VARCHAR(50) DEFAULT 'general' CHECK (category IN ('assessment','incident','physician_order','consent','intake','hr','general')),
+        fields JSONB NOT NULL DEFAULT '[]',
+        is_active BOOLEAN DEFAULT TRUE,
+        requires_signature BOOLEAN DEFAULT FALSE,
+        auto_attach_to VARCHAR(20) CHECK (auto_attach_to IN ('client','caregiver','both')),
+        created_by UUID REFERENCES users(id),
+        created_at TIMESTAMPTZ DEFAULT NOW(),
+        updated_at TIMESTAMPTZ DEFAULT NOW()
+      );
+      CREATE INDEX IF NOT EXISTS idx_form_templates_category ON form_templates(category, is_active);
+
+      CREATE TABLE IF NOT EXISTS form_submissions (
+        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
+        template_id UUID REFERENCES form_templates(id),
+        template_name VARCHAR(255),
+        entity_type VARCHAR(20) CHECK (entity_type IN ('client','caregiver')),
+        entity_id UUID,
+        submitted_by UUID REFERENCES users(id),
+        submitted_by_name VARCHAR(100),
+        data JSONB NOT NULL DEFAULT '{}',
+        signature TEXT,
+        signed_at TIMESTAMPTZ,
+        status VARCHAR(20) DEFAULT 'draft' CHECK (status IN ('draft','submitted','signed','archived')),
+        created_at TIMESTAMPTZ DEFAULT NOW(),
+        updated_at TIMESTAMPTZ DEFAULT NOW()
+      );
+      CREATE INDEX IF NOT EXISTS idx_form_submissions_entity ON form_submissions(entity_type, entity_id);
+      CREATE INDEX IF NOT EXISTS idx_form_submissions_template ON form_submissions(template_id);
+    `);
+    res.json({ success: true, message: 'Migration v7 complete — all tables created.' });
+  } catch (err) {
+    res.status(500).json({ success: false, error: err.message });
+  }
+});
+
+// ============ START SERVER ============
+const agencyName = process.env.AGENCY_NAME || 'HomeCare CRM';
+app.listen(port, () => {
+  console.log(`🚀 ${agencyName} API running on port ${port}`);
+  console.log(`📊 Dashboard: ${process.env.FRONTEND_URL || 'http://localhost:3000'}`);
+  if (!process.env.ALLOWED_ORIGINS) console.warn('⚠️  ALLOWED_ORIGINS not set — CORS will block all browser requests in production!');
+});
diff --git a/templates/crm-homecare/backend/src/services/encryptionService.js b/templates/crm-homecare/backend/src/services/encryptionService.js
new file mode 100644
index 0000000..46c35d8
--- /dev/null
+++ b/templates/crm-homecare/backend/src/services/encryptionService.js
@@ -0,0 +1,68 @@
+// src/services/encryptionService.js - AES-256-GCM encryption for PII fields
+const crypto = require('crypto');
+
+const ALGORITHM  = 'aes-256-gcm';
+const KEY_LENGTH = 32; // 256 bits
+const IV_LENGTH  = 16; // 128 bits
+
+// Configurable salt — override via ENCRYPTION_SALT env var per tenant
+const SALT = process.env.ENCRYPTION_SALT || 'homecare-crm-encryption-salt-v1';
+
+let _cachedKey = null;
+const getKey = () => {
+  if (_cachedKey) return _cachedKey;
+
+  const envKey = process.env.ENCRYPTION_KEY;
+  if (!envKey) {
+    throw new Error(
+      'ENCRYPTION_KEY environment variable is required. ' +
+      'Generate with: node -e "console.log(require(\'crypto\').randomBytes(32).toString(\'hex\'))"'
+    );
+  }
+
+  if (envKey.length === 64 && /^[0-9a-f]+$/i.test(envKey)) {
+    _cachedKey = Buffer.from(envKey, 'hex');
+  } else {
+    _cachedKey = crypto.scryptSync(envKey, SALT, KEY_LENGTH);
+  }
+  return _cachedKey;
+};
+
+const encrypt = (plaintext) => {
+  if (plaintext === null || plaintext === undefined) return null;
+  try {
+    const key    = getKey();
+    const iv     = crypto.randomBytes(IV_LENGTH);
+    const cipher = crypto.createCipheriv(ALGORITHM, key, iv);
+    const encrypted = Buffer.concat([cipher.update(String(plaintext), 'utf8'), cipher.final()]);
+    const authTag = cipher.getAuthTag();
+    return [iv.toString('base64'), authTag.toString('base64'), encrypted.toString('base64')].join(':');
+  } catch (error) {
+    console.error('[ENCRYPTION] Encrypt error:', error.message);
+    throw new Error('Encryption failed');
+  }
+};
+
+const decrypt = (encryptedValue) => {
+  if (!encryptedValue) return null;
+  try {
+    const key    = getKey();
+    const parts  = encryptedValue.split(':');
+    if (parts.length !== 3) throw new Error('Invalid encrypted format');
+    const iv         = Buffer.from(parts[0], 'base64');
+    const authTag    = Buffer.from(parts[1], 'base64');
+    const ciphertext = Buffer.from(parts[2], 'base64');
+    const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);
+    decipher.setAuthTag(authTag);
+    return Buffer.concat([decipher.update(ciphertext), decipher.final()]).toString('utf8');
+  } catch (error) {
+    console.error('[ENCRYPTION] Decrypt error:', error.message);
+    return null;
+  }
+};
+
+const maskSSN     = (ssn) => { if (!ssn) return null; const c = ssn.replace(/\D/g,''); return `***-**-${c.slice(-4)}`; };
+const validateSSN = (ssn) => ssn.replace(/\D/g,'').length === 9;
+const normalizeSSN = (ssn) => ssn.replace(/\D/g,'');
+
+module.exports = { encrypt, decrypt, maskSSN, validateSSN, normalizeSSN };
diff --git a/templates/crm-homecare/backend/src/services/worcsService.js b/templates/crm-homecare/backend/src/services/worcsService.js
new file mode 100644
index 0000000..eef7de2
--- /dev/null
+++ b/templates/crm-homecare/backend/src/services/worcsService.js
@@ -0,0 +1,195 @@
+// src/services/worcsService.js - Wisconsin DOJ WORCS SOAP Integration
+const axios = require('axios');
+
+const WORCS_WSDL = 'https://worcs-services.doj.wi.gov/Worcs.svc?singleWsdl';
+const WORCS_ENDPOINT = 'https://worcs-services.doj.wi.gov/Worcs.svc';
+
+// Build SOAP envelope for name-based background check (Caregiver-General)
+const buildSOAPRequest = (credentials, applicantData) => {
+  const { username, password, accountNumber } = credentials;
+  const { firstName, lastName, dateOfBirth, ssn, requestPurpose = 'Caregiver-General' } = applicantData;
+
+  return `<?xml version="1.0" encoding="utf-8"?>
+<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
+               xmlns:wor="http://worcs.doj.wi.gov/">
+  <soap:Header>
+    <wor:AuthHeader>
+      <wor:Username>${escapeXml(username)}</wor:Username>
+      <wor:Password>${escapeXml(password)}</wor:Password>
+      <wor:AccountNumber>${escapeXml(accountNumber)}</wor:AccountNumber>
+    </wor:AuthHeader>
+  </soap:Header>
+  <soap:Body>
+    <wor:SubmitNameBasedRequest>
+      <wor:request>
+        <wor:FirstName>${escapeXml(firstName)}</wor:FirstName>
+        <wor:LastName>${escapeXml(lastName)}</wor:LastName>
+        <wor:DateOfBirth>${dateOfBirth}</wor:DateOfBirth>
+        <wor:SSN>${ssn}</wor:SSN>
+        <wor:RequestPurpose>${requestPurpose}</wor:RequestPurpose>
+        <wor:RequesterReference>${Date.now()}</wor:RequesterReference>
+      </wor:request>
+    </wor:SubmitNameBasedRequest>
+  </soap:Body>
+</soap:Envelope>`;
+};
+
+const buildResultsSOAP = (credentials, referenceNumber) => {
+  const { username, password, accountNumber } = credentials;
+  return `<?xml version="1.0" encoding="utf-8"?>
+<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
+               xmlns:wor="http://worcs.doj.wi.gov/">
+  <soap:Header>
+    <wor:AuthHeader>
+      <wor:Username>${escapeXml(username)}</wor:Username>
+      <wor:Password>${escapeXml(password)}</wor:Password>
+      <wor:AccountNumber>${escapeXml(accountNumber)}</wor:AccountNumber>
+    </wor:AuthHeader>
+  </soap:Header>
+  <soap:Body>
+    <wor:GetRequestResults>
+      <wor:referenceNumber>${escapeXml(referenceNumber)}</wor:referenceNumber>
+    </wor:GetRequestResults>
+  </soap:Body>
+</soap:Envelope>`;
+};
+
+const escapeXml = (str) => {
+  if (!str) return '';
+  return String(str)
+    .replace(/&/g, '&amp;')
+    .replace(/</g, '&lt;')
+    .replace(/>/g, '&gt;')
+    .replace(/"/g, '&quot;')
+    .replace(/'/g, '&apos;');
+};
+
+// Parse SOAP XML response to extract reference number and status
+const parseSOAPResponse = (xml) => {
+  const refMatch = xml.match(/<ReferenceNumber[^>]*>([^<]+)<\/ReferenceNumber>/i);
+  const statusMatch = xml.match(/<Status[^>]*>([^<]+)<\/Status>/i);
+  const errorMatch = xml.match(/<ErrorMessage[^>]*>([^<]+)<\/ErrorMessage>/i);
+  const resultMatch = xml.match(/<Result[^>]*>([^<]+)<\/Result>/i);
+  const recordMatch = xml.match(/<HasRecord[^>]*>([^<]+)<\/HasRecord>/i);
+
+  return {
+    referenceNumber: refMatch ? refMatch[1].trim() : null,
+    status: statusMatch ? statusMatch[1].trim() : null,
+    result: resultMatch ? resultMatch[1].trim() : null,
+    hasRecord: recordMatch ? recordMatch[1].trim().toLowerCase() === 'true' : null,
+    error: errorMatch ? errorMatch[1].trim() : null,
+    rawXml: xml,
+  };
+};
+
+/**
+ * Submit a name-based background check to Wisconsin DOJ WORCS
+ * Returns a reference number for polling results
+ */
+const submitBackgroundCheck = async (applicantData) => {
+  const credentials = {
+    username: process.env.WORCS_USERNAME,
+    password: process.env.WORCS_PASSWORD,
+    accountNumber: process.env.WORCS_ACCOUNT_NUMBER,
+  };
+
+  // In development/staging without credentials, return mock response
+  if (!credentials.username || !credentials.password) {
+    console.warn('[WORCS] No credentials configured — returning mock pending response');
+    return {
+      success: true,
+      referenceNumber: `MOCK-${Date.now()}`,
+      status: 'pending',
+      mock: true,
+    };
+  }
+
+  try {
+    const soapBody = buildSOAPRequest(credentials, applicantData);
+
+    const response = await axios.post(WORCS_ENDPOINT, soapBody, {
+      headers: {
+        'Content-Type': 'text/xml; charset=utf-8',
+        'SOAPAction': 'http://worcs.doj.wi.gov/IWorcs/SubmitNameBasedRequest',
+      },
+      timeout: 30000,
+    });
+
+    const parsed = parseSOAPResponse(response.data);
+
+    if (parsed.error) {
+      throw new Error(`WORCS Error: ${parsed.error}`);
+    }
+
+    return {
+      success: true,
+      referenceNumber: parsed.referenceNumber,
+      status: 'pending',
+    };
+  } catch (error) {
+    console.error('[WORCS] Submit error:', error.message);
+    throw new Error(`Background check submission failed: ${error.message}`);
+  }
+};
+
+/**
+ * Poll WORCS for results of a previously submitted check
+ */
+const getCheckResults = async (referenceNumber) => {
+  // Mock response for development
+  if (referenceNumber.startsWith('MOCK-')) {
+    return {
+      referenceNumber,
+      status: 'completed',
+      result: 'cleared',
+      hasRecord: false,
+      completedAt: new Date().toISOString(),
+      mock: true,
+    };
+  }
+
+  const credentials = {
+    username: process.env.WORCS_USERNAME,
+    password: process.env.WORCS_PASSWORD,
+    accountNumber: process.env.WORCS_ACCOUNT_NUMBER,
+  };
+
+  if (!credentials.username) {
+    throw new Error('WORCS credentials not configured');
+  }
+
+  try {
+    const soapBody = buildResultsSOAP(credentials, referenceNumber);
+
+    const response = await axios.post(WORCS_ENDPOINT, soapBody, {
+      headers: {
+        'Content-Type': 'text/xml; charset=utf-8',
+        'SOAPAction': 'http://worcs.doj.wi.gov/IWorcs/GetRequestResults',
+      },
+      timeout: 30000,
+    });
+
+    const parsed = parseSOAPResponse(response.data);
+
+    let result = 'pending';
+    if (parsed.status === 'Completed' || parsed.status === 'Complete') {
+      result = parsed.hasRecord ? 'record_found' : 'cleared';
+    } else if (parsed.status === 'Error' || parsed.status === 'Failed') {
+      result = 'error';
+    }
+
+    return {
+      referenceNumber,
+      status: parsed.status === 'Completed' ? 'completed' : 'pending',
+      result,
+      hasRecord: parsed.hasRecord,
+      rawResult: parsed.result,
+      completedAt: result !== 'pending' ? new Date().toISOString() : null,
+    };
+  } catch (error) {
+    console.error('[WORCS] Results error:', error.message);
+    throw new Error(`Failed to retrieve results: ${error.message}`);
+  }
+};
+
+module.exports = { submitBackgroundCheck, getCheckResults };
diff --git a/templates/crm-homecare/backend/src/testApp.js b/templates/crm-homecare/backend/src/testApp.js
new file mode 100644
index 0000000..056c789
--- /dev/null
+++ b/templates/crm-homecare/backend/src/testApp.js
@@ -0,0 +1,143 @@
+// src/testApp.js
+// Same middleware/routes as server.js but exports the Express app without calling listen().
+// Used by smoke.test.js so tests don't need a real port or DB.
+
+const express = require('express');
+const cors = require('cors');
+const helmet = require('helmet');
+const rateLimit = require('express-rate-limit');
+const db = require('./db');
+
+const app = express();
+app.set('trust proxy', 1);
+
+app.use(helmet());
+app.use(cors({ origin: '*', credentials: true, methods: ['GET','POST','PUT','DELETE','PATCH'], allowedHeaders: ['Content-Type','Authorization'] }));
+
+// Skip rate limiting in tests
+if (process.env.NODE_ENV !== 'test') {
+  app.use(rateLimit({ windowMs: 15*60*1000, max: 500 }));
+}
+
+app.use(express.json({ limit: '10mb' }));
+app.use(express.urlencoded({ limit: '10mb', extended: true }));
+
+// Mock audit logger in test mode
+if (process.env.NODE_ENV === 'test') {
+  app.use((req, res, next) => next());
+} else {
+  app.use(require('./middleware/auditLogger')(db.pool));
+}
+
+// Health check
+app.get('/health', (req, res) => res.json({ status: 'ok', timestamp: new Date() }));
+
+const { verifyToken } = require('./middleware/shared');
+
+// All routes — same as server.js
+const authRoutes         = require('./routes/authRoutes');
+const caregiverRoutes    = require('./routes/caregiverRoutes');
+const clientsRoutes      = require('./routes/clientsRoutes');
+const timeTrackingRoutes = require('./routes/timeTrackingRoutes');
+const dashboardRoutes    = require('./routes/dashboardRoutes');
+const schedulingRoutes   = require('./routes/schedulingRoutes');
+const billingRoutes      = require('./routes/billingRoutes');
+const referralRoutes     = require('./routes/referralRoutes');
+const notificationRoutes = require('./routes/notificationRoutes');
+const prospectRoutes     = require('./routes/prospectRoutes');
+const pricingRoutes      = require('./routes/pricingRoutes');
+const absenceRoutes      = require('./routes/absenceRoutes');
+const expenseRoutes      = require('./routes/expenseRoutes');
+const clinicalRoutes     = require('./routes/clinicalRoutes');
+
+app.use('/api/auth', authRoutes);
+app.use('/api/caregivers',   verifyToken, caregiverRoutes);
+app.use('/api/clients',      verifyToken, clientsRoutes);
+app.use('/api/time-entries', verifyToken, timeTrackingRoutes);
+app.use('/api/dashboard',    verifyToken, dashboardRoutes);
+app.use('/api/scheduling',   verifyToken, schedulingRoutes);
+app.use('/api/billing',      verifyToken, billingRoutes);
+app.use('/api', referralRoutes);
+app.use('/api', notificationRoutes);
+app.use('/api', prospectRoutes);
+app.use('/api', pricingRoutes);
+app.use('/api', absenceRoutes);
+app.use('/api', expenseRoutes);
+app.use('/api', clinicalRoutes);
+app.use('/api/reports',           verifyToken, require('./routes/reports'));
+app.use('/api/payroll',           verifyToken, require('./routes/payrollRoutes'));
+app.use('/api/audit-logs',        verifyToken, require('./routes/auditLogs'));
+app.use('/api/users',             verifyToken, require('./routes/users'));
+app.use('/api/claims',            verifyToken, require('./routes/claimsRoutes'));
+app.use('/api/stripe',                         require('./routes/stripeRoutes'));
+app.use('/api/applications',      verifyToken, require('./routes/applicationsRoutes'));
+app.use('/api/schedules',         verifyToken, require('./routes/schedulesRoutes'));
+app.use('/api/sms',               verifyToken, require('./routes/smsRoutes'));
+app.use('/api/open-shifts',       verifyToken, require('./routes/openShiftsRoutes'));
+app.use('/api/medications',       verifyToken, require('./routes/medicationsRoutes'));
+app.use('/api/documents',         verifyToken, require('./routes/documentsRoutes'));
+app.use('/api/adl',               verifyToken, require('./routes/adlRoutes'));
+app.use('/api/background-checks', verifyToken, require('./routes/backgroundChecksRoutes'));
+app.use('/api/family-portal', (req, res, next) => {
+  if (req.path.startsWith('/admin')) return verifyToken(req, res, next);
+  next();
+}, require('./routes/familyPortalRoutes'));
+app.use('/api/shift-swaps',       verifyToken, require('./routes/shiftSwapsRoutes'));
+app.use('/api/alerts',            verifyToken, require('./routes/alertsRoutes'));
+app.use('/api/route-optimizer',   verifyToken, require('./routes/routeOptimizerRoutes'));
+app.use('/api/matching',          verifyToken, require('./routes/matchingRoutes'));
+app.use('/api/emergency',         verifyToken, require('./routes/emergencyRoutes'));
+app.use('/api/messages',          verifyToken, require('./routes/messageRoutes'));
+app.use('/api/remittance',        verifyToken, require('./routes/remittanceRoutes'));
+app.use('/api/sandata',           verifyToken, require('./routes/sandataRoutes'));
+app.use('/api/authorizations',    verifyToken, require('./routes/authorizationRoutes'));
+app.use('/api/failsafe',          verifyToken, require('./routes/failsafeRoutes'));
+app.use('/api/edi',               verifyToken, require('./routes/ediRoutes'));
+app.use('/api/gusto',             verifyToken, require('./routes/gustoRoutes'));
+app.use('/api/push',              verifyToken, require('./routes/pushNotificationRoutes').router);
+
+// Explicit path workarounds
+app.get('/api/schedules-all', verifyToken, async (req, res) => {
+  try {
+    const result = await db.query(
+      `SELECT s.*, s.frequency, s.effective_date, s.anchor_date,
+              u.first_name as caregiver_first_name, u.last_name as caregiver_last_name,
+              c.first_name as client_first_name, c.last_name as client_last_name
+       FROM schedules s JOIN users u ON s.caregiver_id=u.id JOIN clients c ON s.client_id=c.id
+       WHERE s.is_active=true ORDER BY s.day_of_week, s.date, s.start_time`
+    );
+    res.json(result.rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+app.put('/api/schedules-all/:scheduleId', verifyToken, async (req, res) => {
+  try {
+    const { scheduleId } = req.params;
+    const { clientId, dayOfWeek, date, startTime, endTime, notes, frequency, effectiveDate, anchorDate } = req.body;
+    if (startTime && endTime && startTime >= endTime) return res.status(400).json({ error: 'End time must be after start time' });
+    const result = await db.query(
+      `UPDATE schedules SET client_id=COALESCE($1,client_id), day_of_week=$2, date=$3,
+        start_time=COALESCE($4,start_time), end_time=COALESCE($5,end_time), notes=$6,
+        frequency=COALESCE($7,frequency), effective_date=COALESCE($8,effective_date),
+        anchor_date=COALESCE($9,anchor_date), updated_at=NOW()
+       WHERE id=$10 AND is_active=true RETURNING *`,
+      [clientId, dayOfWeek !== undefined ? dayOfWeek : null, date||null, startTime, endTime, notes||null, frequency||'weekly', effectiveDate||null, anchorDate||null, scheduleId]
+    );
+    if (result.rows.length === 0) return res.status(404).json({ error: 'Schedule not found' });
+    res.json(result.rows[0]);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+app.get('/api/payroll-periods', verifyToken, async (req, res) => {
+  try {
+    res.json((await db.query(`SELECT DISTINCT pay_period_start, pay_period_end FROM payroll ORDER BY pay_period_end DESC`)).rows);
+  } catch (error) { res.status(500).json({ error: error.message }); }
+});
+
+// Error handler
+app.use((err, req, res, next) => {
+  const status = err.status || err.statusCode || 500;
+  res.status(status).json({ error: status < 500 ? err.message : 'An unexpected error occurred.' });
+});
+
+module.exports = app;
diff --git a/templates/crm-homecare/backend/src/tests/auth.test.js b/templates/crm-homecare/backend/src/tests/auth.test.js
new file mode 100644
index 0000000..a52d6d1
--- /dev/null
+++ b/templates/crm-homecare/backend/src/tests/auth.test.js
@@ -0,0 +1,108 @@
+// __tests__/auth.test.js
+// Smoke tests for authentication endpoints
+// These run against a real DB — set TEST_DATABASE_URL in env
+
+const request = require('supertest');
+
+// Only run integration tests if TEST_DATABASE_URL is set
+const INTEGRATION = !!process.env.TEST_DATABASE_URL;
+
+describe('Auth endpoints', () => {
+  let app;
+
+  beforeAll(() => {
+    if (!INTEGRATION) return;
+    process.env.DATABASE_URL = process.env.TEST_DATABASE_URL;
+    process.env.JWT_SECRET   = 'test-jwt-secret-for-unit-tests-only';
+    process.env.ENCRYPTION_KEY = 'a'.repeat(64); // Valid 64-char hex
+    app = require('../server');
+  });
+
+  describe('POST /api/auth/login', () => {
+    test('returns 400 on missing credentials', async () => {
+      if (!INTEGRATION) return;
+      const res = await request(app).post('/api/auth/login').send({});
+      expect(res.status).toBe(400);
+    });
+
+    test('returns 401 on bad credentials', async () => {
+      if (!INTEGRATION) return;
+      const res = await request(app)
+        .post('/api/auth/login')
+        .send({ email: 'nobody@example.com', password: 'wrongpassword' });
+      expect(res.status).toBe(401);
+    });
+
+    test('does not return password_hash in response', async () => {
+      if (!INTEGRATION) return;
+      const res = await request(app)
+        .post('/api/auth/login')
+        .send({ email: 'admin@example.com', password: 'testpassword' });
+      if (res.status === 200) {
+        expect(res.body.user).not.toHaveProperty('password_hash');
+      }
+    });
+  });
+});
+
+// ── JWT validation unit tests (no DB needed) ──────────────────────────────────
+
+const jwt = require('jsonwebtoken');
+
+describe('JWT validation', () => {
+  const SECRET = 'test-secret';
+
+  test('valid token decodes correctly', () => {
+    const token = jwt.sign({ id: '123', role: 'admin' }, SECRET, { expiresIn: '1h' });
+    const decoded = jwt.verify(token, SECRET);
+    expect(decoded.id).toBe('123');
+    expect(decoded.role).toBe('admin');
+  });
+
+  test('expired token throws', () => {
+    const token = jwt.sign({ id: '123' }, SECRET, { expiresIn: '-1s' });
+    expect(() => jwt.verify(token, SECRET)).toThrow();
+  });
+
+  test('tampered token throws', () => {
+    const token = jwt.sign({ id: '123', role: 'admin' }, SECRET);
+    const parts  = token.split('.');
+    // Tamper with payload
+    parts[1] = Buffer.from(JSON.stringify({ id: '123', role: 'superadmin' })).toString('base64');
+    const tampered = parts.join('.');
+    expect(() => jwt.verify(tampered, SECRET)).toThrow();
+  });
+
+  test('wrong secret throws', () => {
+    const token = jwt.sign({ id: '123' }, SECRET);
+    expect(() => jwt.verify(token, 'wrong-secret')).toThrow();
+  });
+});
+
+// ── SQL injection prevention tests ────────────────────────────────────────────
+
+describe('SQL injection prevention', () => {
+  const ALLOWED_COLUMNS = new Set([
+    'step_name', 'step_status', 'completed_at', 'notes', 'is_complete'
+  ]);
+
+  function validateColumns(updates) {
+    return Object.keys(updates).every(k => ALLOWED_COLUMNS.has(k));
+  }
+
+  test('allows valid column names', () => {
+    expect(validateColumns({ step_status: 'complete', notes: 'done' })).toBe(true);
+  });
+
+  test('blocks SQL injection attempt', () => {
+    expect(validateColumns({ 'is_active = false; DROP TABLE clients; --': true })).toBe(false);
+  });
+
+  test('blocks unknown columns', () => {
+    expect(validateColumns({ password_hash: 'hacked' })).toBe(false);
+  });
+
+  test('blocks empty string column', () => {
+    expect(validateColumns({ '': 'value' })).toBe(false);
+  });
+});
diff --git a/templates/crm-homecare/backend/src/tests/payroll.test.js b/templates/crm-homecare/backend/src/tests/payroll.test.js
new file mode 100644
index 0000000..0e0513c
--- /dev/null
+++ b/templates/crm-homecare/backend/src/tests/payroll.test.js
@@ -0,0 +1,144 @@
+// __tests__/payroll.test.js
+// Unit tests for payroll calculation logic
+
+// ── Helper functions extracted from server.js payroll run ────────────────────
+
+/**
+ * Calculate hours worked from duration_minutes (the actual DB column)
+ */
+function calcHoursFromMinutes(durationMinutes, billableMinutes) {
+  const mins = billableMinutes ?? durationMinutes ?? 0;
+  return parseFloat((mins / 60).toFixed(4));
+}
+
+/**
+ * Calculate gross pay with overtime
+ */
+function calcGrossPay(totalHours, hourlyRate, overtimeMultiplier = 1.5) {
+  const regularHours  = Math.min(totalHours, 40);
+  const overtimeHours = Math.max(totalHours - 40, 0);
+  const regularPay    = regularHours * hourlyRate;
+  const overtimePay   = overtimeHours * hourlyRate * overtimeMultiplier;
+  return {
+    regularHours:  parseFloat(regularHours.toFixed(4)),
+    overtimeHours: parseFloat(overtimeHours.toFixed(4)),
+    regularPay:    parseFloat(regularPay.toFixed(2)),
+    overtimePay:   parseFloat(overtimePay.toFixed(2)),
+    grossPay:      parseFloat((regularPay + overtimePay).toFixed(2)),
+  };
+}
+
+/**
+ * Calculate tax withholdings
+ */
+function calcTaxes(grossPay, {
+  ssRate    = 0.062,
+  ssLimit   = 160200,
+  medicare  = 0.0145,
+  ytdEarnings = 0,
+} = {}) {
+  const ssWages = Math.min(grossPay, Math.max(ssLimit - ytdEarnings, 0));
+  const ssTax   = parseFloat((ssWages * ssRate).toFixed(2));
+  const medTax  = parseFloat((grossPay * medicare).toFixed(2));
+  return { ssTax, medTax, totalTax: parseFloat((ssTax + medTax).toFixed(2)) };
+}
+
+// ── Tests ─────────────────────────────────────────────────────────────────────
+
+describe('Hours calculation', () => {
+  test('converts duration_minutes to hours correctly', () => {
+    expect(calcHoursFromMinutes(480, null)).toBe(8);       // 8-hour shift
+    expect(calcHoursFromMinutes(90, null)).toBe(1.5);      // 90-minute shift
+    expect(calcHoursFromMinutes(0, null)).toBe(0);         // zero
+    expect(calcHoursFromMinutes(null, null)).toBe(0);      // null safety
+  });
+
+  test('prefers billable_minutes over duration_minutes', () => {
+    expect(calcHoursFromMinutes(480, 450)).toBe(7.5);      // 450 billable vs 480 actual
+    expect(calcHoursFromMinutes(480, 0)).toBe(0);          // billable=0 means unpaid
+  });
+
+  test('handles partial hours', () => {
+    expect(calcHoursFromMinutes(75, null)).toBeCloseTo(1.25, 4);
+    expect(calcHoursFromMinutes(45, null)).toBeCloseTo(0.75, 4);
+  });
+});
+
+describe('Gross pay calculation', () => {
+  test('regular time under 40 hours', () => {
+    const result = calcGrossPay(32, 15);
+    expect(result.regularHours).toBe(32);
+    expect(result.overtimeHours).toBe(0);
+    expect(result.grossPay).toBe(480);
+    expect(result.overtimePay).toBe(0);
+  });
+
+  test('overtime beyond 40 hours', () => {
+    const result = calcGrossPay(45, 20);
+    expect(result.regularHours).toBe(40);
+    expect(result.overtimeHours).toBe(5);
+    expect(result.regularPay).toBe(800);
+    expect(result.overtimePay).toBe(150);
+    expect(result.grossPay).toBe(950);
+  });
+
+  test('exactly 40 hours — no overtime', () => {
+    const result = calcGrossPay(40, 18);
+    expect(result.overtimeHours).toBe(0);
+    expect(result.grossPay).toBe(720);
+  });
+
+  test('zero hours', () => {
+    const result = calcGrossPay(0, 15);
+    expect(result.grossPay).toBe(0);
+  });
+
+  test('custom overtime multiplier', () => {
+    const result = calcGrossPay(42, 20, 2.0); // double-time
+    expect(result.overtimePay).toBe(80);       // 2 hrs * $20 * 2.0
+  });
+});
+
+describe('Tax calculations', () => {
+  test('standard SS and Medicare', () => {
+    const taxes = calcTaxes(1000);
+    expect(taxes.ssTax).toBe(62);      // 6.2% of 1000
+    expect(taxes.medTax).toBe(14.50);  // 1.45% of 1000
+    expect(taxes.totalTax).toBe(76.50);
+  });
+
+  test('SS wage base limit respected', () => {
+    // If employee already earned $160,100 YTD, only $100 more is SS-taxable
+    const taxes = calcTaxes(500, { ssLimit: 160200, ytdEarnings: 160100 });
+    expect(taxes.ssTax).toBe(parseFloat((100 * 0.062).toFixed(2)));
+    expect(taxes.medTax).toBe(parseFloat((500 * 0.0145).toFixed(2)));
+  });
+
+  test('past SS wage limit — no SS tax', () => {
+    const taxes = calcTaxes(500, { ssLimit: 160200, ytdEarnings: 160200 });
+    expect(taxes.ssTax).toBe(0);
+    expect(taxes.medTax).toBeGreaterThan(0);
+  });
+
+  test('zero gross — zero taxes', () => {
+    const taxes = calcTaxes(0);
+    expect(taxes.totalTax).toBe(0);
+  });
+});
+
+describe('End-to-end payroll scenario', () => {
+  test('caregiver works 46 hours at $18/hr', () => {
+    const hours    = calcHoursFromMinutes(46 * 60, null);
+    const payBreakdown = calcGrossPay(hours, 18);
+    const taxes    = calcTaxes(payBreakdown.grossPay);
+    const netPay   = parseFloat((payBreakdown.grossPay - taxes.totalTax).toFixed(2));
+
+    expect(hours).toBe(46);
+    expect(payBreakdown.regularPay).toBe(720);   // 40 * 18
+    expect(payBreakdown.overtimePay).toBe(162);  // 6 * 18 * 1.5
+    expect(payBreakdown.grossPay).toBe(882);
+    expect(taxes.ssTax).toBe(54.68);             // 882 * 0.062
+    expect(taxes.medTax).toBe(12.79);            // 882 * 0.0145
+    expect(netPay).toBe(814.53);
+  });
+});
-- 
2.43.0


From 7133154487da24ae7aa86df11a5c84d172782a85 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 23:15:52 +0000
Subject: [PATCH 16/27] fix: add missing logger import to deploy.js

---
 backend/src/services/factory/deploy.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 29df9a7..ca5cce1 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -20,6 +20,7 @@ import fs from 'fs';
 import path from 'path';
 import { execSync } from 'child_process';
 import AdmZip from 'adm-zip';
+import logger from '../logger.js';
 
 const RENDER_API = 'https://api.render.com/v1';
 const GITHUB_API = 'https://api.github.com';
@@ -366,7 +367,8 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
     let dbConnectionInfo = null;
 
     try {
-      const db = await createRenderDatabase(slug, region);
+      const dbSlug = isHomeCare ? `${slug}-care` : slug;
+      const db = await createRenderDatabase(dbSlug, region);
       results.steps.push({ step: 'render_db', status: 'ok', dbId: db.id });
       results.services.database = db;
 
@@ -374,7 +376,9 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
       await new Promise(resolve => setTimeout(resolve, 30000));
       dbConnectionInfo = await getDatabaseConnectionInfo(db.id);
       dbInfo = dbConnectionInfo;
+      logger.info(`[Deploy] DB created: ${dbSlug}-db, connectionInfo keys: ${Object.keys(dbConnectionInfo || {}).join(', ')}`);
     } catch (dbErr) {
+      logger.error(`[Deploy] DB creation failed for ${slug}:`, dbErr.message);
       results.steps.push({ step: 'render_db', status: 'error', error: dbErr.message });
       results.errors.push(`Database: ${dbErr.message}`);
     }
-- 
2.43.0


From 5bb1cb548fe0ee877a2a9fccbcb8ba502b151f3c Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 23:32:23 +0000
Subject: [PATCH 17/27] fix: surface full Render DB error, make DB failure stop
 deploy early

---
 backend/src/services/factory/deploy.js | 19 ++++++++++++++-----
 1 file changed, 14 insertions(+), 5 deletions(-)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index ca5cce1..6a9b95b 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -175,7 +175,8 @@ async function createRenderDatabase(slug, region = 'ohio') {
 
   if (!res.ok) {
     const err = await res.json();
-    throw new Error(`Render DB creation failed: ${JSON.stringify(err)}`);
+    const msg = `Render DB creation failed (${res.status}): ${JSON.stringify(err)}`;
+    throw new Error(msg);
   }
 
   return await res.json();
@@ -368,19 +369,27 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
 
     try {
       const dbSlug = isHomeCare ? `${slug}-care` : slug;
+      logger.info(`[Deploy] Creating DB: ${dbSlug}-db in ${region}`);
       const db = await createRenderDatabase(dbSlug, region);
+      logger.info(`[Deploy] DB created successfully: ${dbSlug}-db, id=${db.id}`);
       results.steps.push({ step: 'render_db', status: 'ok', dbId: db.id });
       results.services.database = db;
 
-      // Wait a moment for DB to initialize, then get connection info
+      // Wait for DB to initialize, then get connection info
+      logger.info(`[Deploy] Waiting 30s for DB to initialize...`);
       await new Promise(resolve => setTimeout(resolve, 30000));
       dbConnectionInfo = await getDatabaseConnectionInfo(db.id);
       dbInfo = dbConnectionInfo;
-      logger.info(`[Deploy] DB created: ${dbSlug}-db, connectionInfo keys: ${Object.keys(dbConnectionInfo || {}).join(', ')}`);
+      logger.info(`[Deploy] DB connection info retrieved. Keys: ${Object.keys(dbConnectionInfo || {}).join(', ')}`);
     } catch (dbErr) {
-      logger.error(`[Deploy] DB creation failed for ${slug}:`, dbErr.message);
+      // Log full error so we can see exactly what Render said
+      logger.error(`[Deploy] DB creation FAILED for ${slug}: ${dbErr.message}`);
       results.steps.push({ step: 'render_db', status: 'error', error: dbErr.message });
-      results.errors.push(`Database: ${dbErr.message}`);
+      results.errors.push(`Database creation failed: ${dbErr.message}`);
+      // Don't continue — backend needs a DB to work
+      results.success = false;
+      results.status = 'failed';
+      return results;
     }
 
     const jwtSecret = generateJwtSecret();
-- 
2.43.0


From e265a7967aa68f15f8657ea1d28d984ed32184ed Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Tue, 24 Feb 2026 23:41:49 +0000
Subject: [PATCH 18/27] fix: remove tailwind, use CVHC plain CSS, add db:seed
 script, fix start command

---
 templates/crm-homecare/backend/package.json   |    5 +-
 templates/crm-homecare/frontend/src/index.css | 1362 ++++++++++++++++-
 .../crm-homecare/frontend/tailwind.config.js  |   13 -
 3 files changed, 1338 insertions(+), 42 deletions(-)
 delete mode 100644 templates/crm-homecare/frontend/tailwind.config.js

diff --git a/templates/crm-homecare/backend/package.json b/templates/crm-homecare/backend/package.json
index 2c11935..4294433 100644
--- a/templates/crm-homecare/backend/package.json
+++ b/templates/crm-homecare/backend/package.json
@@ -1,11 +1,12 @@
 {
   "name": "chippewa-home-care-backend",
   "scripts": {
-    "start": "node src/server.js",
+    "start": "node src/index.js",
     "dev": "nodemon src/server.js",
     "test": "jest --testPathPattern=tests/ --forceExit --detectOpenHandles",
     "test:watch": "jest --watch",
-    "test:coverage": "jest --coverage"
+    "test:coverage": "jest --coverage",
+    "db:seed": "node prisma/seed.js"
   },
   "jest": {
     "testEnvironment": "node",
diff --git a/templates/crm-homecare/frontend/src/index.css b/templates/crm-homecare/frontend/src/index.css
index 4b11f40..262a210 100644
--- a/templates/crm-homecare/frontend/src/index.css
+++ b/templates/crm-homecare/frontend/src/index.css
@@ -1,32 +1,1340 @@
-@tailwind base;
-@tailwind components;
-@tailwind utilities;
-
 :root {
-  --color-primary: {{PRIMARY_COLOR}};
-  --color-secondary: {{SECONDARY_COLOR}};
-  --color-primary-light: color-mix(in srgb, var(--color-primary) 15%, white);
-  --color-primary-dark: color-mix(in srgb, var(--color-primary) 80%, black);
+    --color-teal: #2ABBA7;
+    --color-teal-dark: #1E9A89;
+    --color-teal-light: #E8F8F6;
+    --color-gold: #C9A227;
+    --color-gold-light: #D4AF37;
+    --color-gold-pale: #FDF8E8;
+    --color-cream: #FDFCFA;
+    --color-white: #FFFFFF;
+    --color-text: #2D3A3A;
+    --color-text-light: #5A6B6B;
+    --color-gray: #F5F5F5;
+    --color-red: #DC3545;
+    --color-green: #28A745;
+    --color-blue: #0066CC;
+    --primary: #17a2b8;
+    --font-display: 'Cormorant Garamond', Georgia, serif;
+    --font-body: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
+    --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
+    --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
+    --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
 }
 
-* { box-sizing: border-box; }
+* {
+    margin: 0;
+    padding: 0;
+    box-sizing: border-box;
+}
+
+html {
+    scroll-behavior: smooth;
+}
 
 body {
-  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
-  color: #111827;
-  background: #f9fafb;
-  margin: 0;
-}
-
-/* Primary color utilities using CSS vars */
-.bg-brand { background-color: var(--color-primary); }
-.text-brand { color: var(--color-primary); }
-.border-brand { border-color: var(--color-primary); }
-.hover\:bg-brand:hover { background-color: var(--color-primary); }
-.ring-brand { --tw-ring-color: var(--color-primary); }
-.bg-brand-light { background-color: var(--color-primary-light); }
-
-/* Scrollbar */
-::-webkit-scrollbar { width: 6px; height: 6px; }
-::-webkit-scrollbar-track { background: #f1f5f9; }
-::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
+    font-family: var(--font-body);
+    color: var(--color-text);
+    background-color: var(--color-gray);
+    line-height: 1.6;
+    font-size: 16px;
+    overflow-x: hidden;
+}
+
+/* Layout */
+#root {
+    display: flex;
+    min-height: 100vh;
+    width: 100%;
+    overflow-x: hidden;
+}
+
+/* Sidebar Navigation */
+.sidebar {
+    width: 280px;
+    min-width: 280px;
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+    padding: 2rem 1rem;
+    overflow-y: auto;
+    position: fixed;
+    height: 100vh;
+    z-index: 1000;
+    display: flex;
+    flex-direction: column;
+}
+
+.sidebar-nav {
+    list-style: none;
+    flex: 1;
+    overflow-y: auto;
+    padding-bottom: 2rem;
+}
+
+.sidebar-logo {
+    font-family: var(--font-display);
+    font-size: 1.8rem;
+    font-weight: 600;
+    margin-bottom: 2rem;
+    display: flex;
+    align-items: center;
+    gap: 0.5rem;
+}
+
+.sidebar-nav li {
+    margin-bottom: 0.5rem;
+}
+
+.sidebar-nav a {
+    display: block;
+    padding: 0.75rem 1rem;
+    color: rgba(255,255,255,0.85);
+    text-decoration: none;
+    border-radius: 6px;
+    transition: all 0.3s ease;
+    font-weight: 500;
+    font-size: 0.95rem;
+}
+
+.sidebar-nav a:hover,
+.sidebar-nav a.active {
+    background: rgba(255,255,255,0.15);
+    color: white;
+    padding-left: 1.5rem;
+}
+
+.sidebar-nav a.active {
+    background: rgba(255,255,255,0.25);
+    border-left: 3px solid var(--color-gold);
+}
+
+.sidebar-user {
+    position: relative;
+    padding: 1rem;
+    background: rgba(0,0,0,0.15);
+    border-radius: 8px;
+    margin-top: auto;
+}
+
+.sidebar-user-name {
+    font-weight: 600;
+    font-size: 0.9rem;
+    margin-bottom: 0.5rem;
+}
+
+.sidebar-user-role {
+    font-size: 0.8rem;
+    opacity: 0.8;
+    margin-bottom: 1rem;
+}
+
+.btn-logout {
+    width: 100%;
+    padding: 0.5rem;
+    background: rgba(255,255,255,0.2);
+    color: white;
+    border: none;
+    border-radius: 4px;
+    cursor: pointer;
+    font-size: 0.85rem;
+    transition: all 0.3s ease;
+}
+
+.btn-logout:hover {
+    background: rgba(255,255,255,0.3);
+}
+
+/* Main Content */
+.main-content {
+    flex: 1;
+    margin-left: 280px;
+    overflow-x: hidden;
+    background: var(--color-gray);
+    min-width: 0;
+    width: calc(100% - 280px);
+}
+
+.header {
+    background: white;
+    padding: 1.5rem 2rem;
+    border-bottom: 1px solid #e0e0e0;
+    box-shadow: var(--shadow-sm);
+    margin-bottom: 1.5rem;
+}
+
+.header h1 {
+    font-family: var(--font-display);
+    font-size: 1.8rem;
+    font-weight: 600;
+    color: var(--color-teal-dark);
+    margin-bottom: 0.25rem;
+}
+
+.header p {
+    color: var(--color-text-light);
+    font-size: 0.9rem;
+}
+
+/* Container */
+.container {
+    padding: 1.5rem;
+    width: 100%;
+    max-width: 100%;
+    overflow-x: hidden;
+}
+
+/* Page Header */
+.page-header {
+    display: flex;
+    flex-wrap: wrap;
+    justify-content: space-between;
+    align-items: center;
+    gap: 1rem;
+    margin-bottom: 1.5rem;
+}
+
+.page-header h2 {
+    font-family: var(--font-display);
+    font-size: 1.6rem;
+    color: var(--color-teal-dark);
+}
+
+/* Cards */
+.card {
+    background: white;
+    border-radius: 8px;
+    padding: 1.25rem;
+    margin-bottom: 1.25rem;
+    box-shadow: var(--shadow-sm);
+    overflow: hidden;
+}
+
+.card:hover {
+    box-shadow: var(--shadow-md);
+}
+
+.card-centered {
+    text-align: center;
+}
+
+.card-title {
+    font-family: var(--font-display);
+    font-size: 1.3rem;
+    font-weight: 600;
+    color: var(--color-teal-dark);
+    margin-bottom: 1rem;
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+}
+
+.card-form {
+    max-width: 800px;
+}
+
+/* Grid Layout */
+.grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
+    gap: 1.25rem;
+    margin-bottom: 1.25rem;
+}
+
+.stat-card {
+    background: linear-gradient(135deg, var(--color-teal-light) 0%, #f0f9f7 100%);
+    border-left: 4px solid var(--color-teal);
+    padding: 1.25rem;
+    border-radius: 8px;
+}
+
+.stat-card h3 {
+    color: var(--color-text-light);
+    font-size: 0.8rem;
+    font-weight: 600;
+    text-transform: uppercase;
+    margin-bottom: 0.5rem;
+}
+
+.stat-card .value {
+    font-size: 1.8rem;
+    font-weight: 700;
+    color: var(--color-teal-dark);
+}
+
+.stat-card .value-danger { color: var(--color-red); }
+.stat-card .value-success { color: var(--color-green); }
+.stat-subtext {
+    font-size: 0.8rem;
+    color: var(--color-text-light);
+    margin-top: 0.25rem;
+}
+
+/* Forms */
+.form-group {
+    margin-bottom: 1.25rem;
+}
+
+.form-group label {
+    display: block;
+    margin-bottom: 0.4rem;
+    font-weight: 600;
+    color: var(--color-text);
+    font-size: 0.9rem;
+}
+
+.form-group input,
+.form-group select,
+.form-group textarea {
+    width: 100%;
+    padding: 0.6rem;
+    border: 1px solid #ddd;
+    border-radius: 6px;
+    font-family: var(--font-body);
+    font-size: 0.9rem;
+    transition: all 0.3s ease;
+}
+
+.form-group input:focus,
+.form-group select:focus,
+.form-group textarea:focus {
+    outline: none;
+    border-color: var(--color-teal);
+    box-shadow: 0 0 0 3px rgba(42, 187, 167, 0.1);
+}
+
+.form-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
+    gap: 1rem;
+}
+
+.form-grid-2 {
+    display: grid;
+    grid-template-columns: repeat(2, 1fr);
+    gap: 1rem;
+}
+
+.form-grid-3 {
+    display: grid;
+    grid-template-columns: repeat(3, 1fr);
+    gap: 1rem;
+}
+
+/* Buttons */
+.btn {
+    padding: 0.6rem 1.2rem;
+    border: none;
+    border-radius: 6px;
+    font-weight: 600;
+    font-size: 0.9rem;
+    cursor: pointer;
+    transition: all 0.3s ease;
+    display: inline-flex;
+    align-items: center;
+    gap: 0.4rem;
+    text-decoration: none;
+    white-space: nowrap;
+}
+
+.btn-primary {
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+}
+
+.btn-primary:hover {
+    transform: translateY(-2px);
+    box-shadow: var(--shadow-md);
+}
+
+.btn-secondary {
+    background: #f0f0f0;
+    color: var(--color-text);
+}
+
+.btn-secondary:hover { background: #e0e0e0; }
+.btn-danger { background: var(--color-red); color: white; }
+.btn-danger:hover { background: #c82333; }
+.btn-success { background: #4caf50; color: white; border: none; }
+.btn-success:hover:not(:disabled) { background: #388e3c; }
+.btn-warning { background: #ffc107; color: #212529; }
+.btn-sm { padding: 0.35rem 0.7rem; font-size: 0.8rem; }
+.btn-block { width: 100%; justify-content: center; }
+
+/* Tables - CRITICAL: Always scrollable */
+.card > .table,
+.table {
+    width: 100%;
+    min-width: 500px;
+    border-collapse: collapse;
+    margin-top: 0.5rem;
+    display: table;
+}
+
+/* Make cards with tables scrollable */
+.card:has(.table) {
+    overflow-x: auto;
+    -webkit-overflow-scrolling: touch;
+}
+
+.table th {
+    background: var(--color-gray);
+    padding: 0.6rem 0.5rem;
+    text-align: left;
+    font-weight: 600;
+    color: var(--color-text);
+    border-bottom: 2px solid #ddd;
+    font-size: 0.8rem;
+    text-transform: uppercase;
+    white-space: nowrap;
+}
+
+.table td {
+    padding: 0.6rem 0.5rem;
+    border-bottom: 1px solid #f0f0f0;
+    vertical-align: middle;
+}
+
+.table tr:hover { background: var(--color-teal-light); }
+.table td:last-child { white-space: nowrap; }
+.table .btn + .btn { margin-left: 0.25rem; }
+
+/* Status Badges */
+.badge {
+    display: inline-block;
+    padding: 0.25rem 0.5rem;
+    border-radius: 20px;
+    font-size: 0.7rem;
+    font-weight: 600;
+    text-transform: uppercase;
+    white-space: nowrap;
+}
+
+.badge-success { background: #d4edda; color: #155724; }
+.badge-warning { background: #fff3cd; color: #856404; }
+.badge-danger { background: #f8d7da; color: #721c24; }
+.badge-info { background: #d1ecf1; color: #0c5460; }
+.badge-primary { background: var(--primary); color: white; }
+.badge-secondary { background: #999; color: white; }
+
+/* Filter Controls */
+.filter-controls {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.75rem;
+    margin-bottom: 1rem;
+}
+
+.filter-controls input,
+.filter-controls select {
+    padding: 0.5rem 0.75rem;
+    border: 1px solid #ddd;
+    border-radius: 6px;
+    font-size: 0.85rem;
+}
+
+.search-input {
+    flex: 1;
+    min-width: 150px;
+    max-width: 300px;
+}
+
+.filter-tabs {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.4rem;
+    margin-top: 0.75rem;
+}
+
+.filter-tab {
+    padding: 0.4rem 0.8rem;
+    background: #f0f0f0;
+    border: none;
+    border-radius: 20px;
+    cursor: pointer;
+    font-size: 0.8rem;
+    transition: all 0.2s;
+}
+
+.filter-tab.active { background: var(--color-teal); color: white; }
+.filter-count { opacity: 0.7; font-size: 0.75rem; margin-left: 0.25rem; }
+
+/* Modals */
+.modal {
+    display: none;
+    position: fixed;
+    z-index: 2000;
+    left: 0;
+    top: 0;
+    width: 100%;
+    height: 100%;
+    background: rgba(0,0,0,0.5);
+    align-items: center;
+    justify-content: center;
+    padding: 1rem;
+}
+
+.modal.active { display: flex; }
+
+.modal-content {
+    background: white;
+    padding: 1.25rem;
+    border-radius: 12px;
+    max-width: 600px;
+    width: 100%;
+    max-height: 90vh;
+    overflow-y: auto;
+    box-shadow: var(--shadow-lg);
+}
+
+.modal-large { max-width: 900px; }
+
+.modal-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    margin-bottom: 1.25rem;
+    padding-bottom: 0.75rem;
+    border-bottom: 1px solid #f0f0f0;
+}
+
+.modal-header h2 {
+    font-family: var(--font-display);
+    color: var(--color-teal-dark);
+    font-size: 1.4rem;
+}
+
+.modal-actions {
+    display: flex;
+    gap: 0.75rem;
+    justify-content: flex-end;
+    margin-top: 1.25rem;
+    padding-top: 0.75rem;
+    border-top: 1px solid #f0f0f0;
+}
+
+.close-btn {
+    background: none;
+    border: none;
+    font-size: 1.8rem;
+    cursor: pointer;
+    color: #999;
+    transition: color 0.3s ease;
+    line-height: 1;
+}
+
+.close-btn:hover { color: var(--color-text); }
+
+/* Alerts */
+.alert {
+    padding: 0.75rem 1rem;
+    border-radius: 6px;
+    margin-bottom: 1rem;
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+    font-size: 0.9rem;
+}
+
+.alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
+.alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
+.alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
+.alert-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
+
+/* Loading */
+.loading {
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    padding: 2rem;
+}
+
+.spinner {
+    border: 4px solid var(--color-gray);
+    border-top: 4px solid var(--color-teal);
+    border-radius: 50%;
+    width: 40px;
+    height: 40px;
+    animation: spin 1s linear infinite;
+}
+
+@keyframes spin {
+    0% { transform: rotate(0deg); }
+    100% { transform: rotate(360deg); }
+}
+
+/* Text Utilities */
+.text-muted { color: var(--color-text-light); }
+.text-center { text-align: center; }
+.text-right { text-align: right; }
+
+/* Hamburger Button */
+.hamburger-btn {
+    display: none;
+    padding: 0.5rem 1rem;
+    background: var(--color-teal);
+    color: white;
+    border: none;
+    border-radius: 6px;
+    font-weight: 600;
+    cursor: pointer;
+}
+
+/* Sidebar Overlay */
+.sidebar-overlay {
+    display: none;
+    position: fixed;
+    top: 0;
+    left: 0;
+    right: 0;
+    bottom: 0;
+    background: rgba(0, 0, 0, 0.5);
+    z-index: 999;
+}
+
+.sidebar-overlay.active { display: block; }
+
+/* Login Page */
+.login-container {
+    display: flex;
+    height: 100vh;
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    align-items: center;
+    justify-content: center;
+}
+
+.login-card {
+    background: white;
+    padding: 2.5rem;
+    border-radius: 12px;
+    box-shadow: var(--shadow-lg);
+    width: 100%;
+    max-width: 380px;
+}
+
+.login-card h1 {
+    font-family: var(--font-display);
+    color: var(--color-teal-dark);
+    margin-bottom: 0.5rem;
+    font-size: 1.8rem;
+}
+
+.login-card p {
+    color: var(--color-text-light);
+    margin-bottom: 1.5rem;
+}
+
+.login-footer {
+    margin-top: 1.5rem;
+    font-size: 0.75rem;
+    color: #999;
+    text-align: center;
+}
+
+/* Applications Grid */
+.applications-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
+    gap: 1.25rem;
+}
+
+.application-card {
+    background: white;
+    border-radius: 8px;
+    padding: 1.25rem;
+    box-shadow: var(--shadow-sm);
+    cursor: pointer;
+    transition: all 0.2s;
+}
+
+.application-card:hover {
+    box-shadow: var(--shadow-md);
+    transform: translateY(-2px);
+}
+
+.app-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: flex-start;
+    margin-bottom: 0.75rem;
+}
+
+.app-header h4 { margin: 0; color: var(--color-teal-dark); }
+.app-date { font-size: 0.8rem; color: var(--color-text-light); }
+.app-body p { margin: 0.2rem 0; font-size: 0.85rem; }
+.app-certs { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.4rem; }
+
+.app-footer {
+    margin-top: 0.75rem;
+    padding-top: 0.6rem;
+    border-top: 1px solid #eee;
+    text-align: center;
+}
+
+.app-footer small { color: var(--color-text-light); }
+
+/* Quick Actions Grid */
+.quick-actions-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
+    gap: 0.75rem;
+}
+
+/* Card Empty State */
+.card-empty-state {
+    text-align: center;
+    padding: 1.5rem;
+    color: var(--color-text-light);
+}
+
+/* Star Rating */
+.star-icon { color: #ffc107; }
+
+/* Form Sections */
+.form-section {
+    margin-bottom: 2rem;
+    padding-bottom: 1.5rem;
+    border-bottom: 1px solid #eee;
+}
+
+.form-section:last-of-type { border-bottom: none; }
+
+.form-section h2 {
+    color: var(--primary);
+    font-size: 1.2rem;
+    margin-bottom: 1rem;
+    border-left: 4px solid var(--primary);
+    padding-left: 0.75rem;
+}
+
+.checkbox-grid {
+    display: grid;
+    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
+    gap: 0.75rem;
+    margin: 0.75rem 0;
+}
+
+.checkbox-label {
+    display: flex;
+    align-items: center;
+    gap: 0.5rem;
+    padding: 0.4rem;
+    cursor: pointer;
+    font-weight: 500;
+    transition: all 0.2s;
+    font-size: 0.9rem;
+}
+
+.checkbox-label:hover { color: var(--primary); }
+.checkbox-label input { cursor: pointer; width: 16px; height: 16px; }
+
+.form-actions {
+    display: flex;
+    flex-wrap: wrap;
+    gap: 0.75rem;
+    justify-content: center;
+    margin-top: 1.25rem;
+    padding-top: 1.25rem;
+    border-top: 2px solid #eee;
+}
+
+/* Calendar */
+.calendar-container {
+    background: white;
+    border: 1px solid #ddd;
+    border-radius: 8px;
+    overflow: hidden;
+}
+
+.calendar-header {
+    display: grid;
+    grid-template-columns: repeat(7, 1fr);
+    background: #f5f5f5;
+    border-bottom: 2px solid #ddd;
+}
+
+.calendar-day-name {
+    padding: 0.75rem;
+    font-weight: bold;
+    text-align: center;
+    color: var(--primary);
+    border-right: 1px solid #eee;
+    font-size: 0.85rem;
+}
+
+.calendar-day-name:last-child { border-right: none; }
+
+.calendar-grid {
+    display: grid;
+    grid-template-columns: repeat(7, 1fr);
+    min-height: 400px;
+}
+
+.calendar-cell {
+    border: 1px solid #eee;
+    padding: 0.5rem;
+    min-height: 80px;
+    cursor: pointer;
+    transition: background 0.2s;
+}
+
+.calendar-cell:hover { background: #f9f9f9; }
+.calendar-cell.has-schedules { background: #f0f7ff; }
+
+.calendar-day-number {
+    font-weight: bold;
+    font-size: 1rem;
+    margin-bottom: 0.25rem;
+    color: var(--primary);
+}
+
+/* Caregiver Dashboard Styles */
+.clock-card {
+    background: white;
+    border-radius: 12px;
+    padding: 1.5rem;
+    margin-bottom: 1.25rem;
+    box-shadow: var(--shadow-md);
+    text-align: center;
+}
+
+.clock-card.active {
+    background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
+    color: white;
+}
+
+.clock-card.ready { border: 2px dashed var(--color-teal); }
+
+.clock-btn {
+    padding: 0.75rem 2rem;
+    font-size: 1.1rem;
+    font-weight: bold;
+    border: none;
+    border-radius: 50px;
+    cursor: pointer;
+    margin-top: 0.75rem;
+    transition: all 0.3s;
+}
+
+.clock-btn.clock-in { background: var(--color-green); color: white; }
+.clock-btn.clock-out { background: white; color: var(--color-red); }
+.clock-btn:disabled { opacity: 0.5; cursor: not-allowed; }
+
+.timer-display {
+    font-size: 2.5rem;
+    font-weight: bold;
+    font-family: 'Courier New', monospace;
+    margin: 0.75rem 0;
+}
+
+.gps-status {
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    gap: 0.4rem;
+    margin: 0.75rem 0;
+    font-size: 0.85rem;
+    color: var(--color-text-light);
+}
+
+.gps-dot {
+    width: 8px;
+    height: 8px;
+    border-radius: 50%;
+    background: var(--color-green);
+}
+
+.gps-dot.inactive { background: var(--color-red); }
+
+.schedule-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    margin-bottom: 0.75rem;
+}
+
+.schedule-header h3 { margin: 0; color: var(--color-teal-dark); font-size: 1.1rem; }
+
+.schedule-count {
+    background: var(--color-teal-light);
+    color: var(--color-teal-dark);
+    padding: 0.2rem 0.6rem;
+    border-radius: 20px;
+    font-size: 0.8rem;
+    font-weight: 600;
+}
+
+.schedule-list { display: flex; flex-direction: column; gap: 0.6rem; }
+
+.schedule-item {
+    display: flex;
+    gap: 0.75rem;
+    padding: 0.75rem;
+    background: var(--color-gray);
+    border-radius: 8px;
+    align-items: center;
+}
+
+.schedule-time { text-align: center; min-width: 60px; }
+.schedule-time-start { font-weight: bold; color: var(--color-teal-dark); font-size: 0.9rem; }
+.schedule-time-end { font-size: 0.8rem; color: var(--color-text-light); }
+.schedule-details { flex: 1; }
+.schedule-client { font-weight: 600; color: var(--color-text); }
+
+.schedule-meta {
+    font-size: 0.8rem;
+    color: var(--color-text-light);
+    display: flex;
+    align-items: center;
+    gap: 0.4rem;
+}
+
+.badge-weekly {
+    background: var(--color-gold-pale);
+    color: var(--color-gold);
+    padding: 0.1rem 0.4rem;
+    border-radius: 10px;
+    font-size: 0.7rem;
+    font-weight: 600;
+}
+
+.stats-grid-2 {
+    display: grid;
+    grid-template-columns: repeat(2, 1fr);
+    gap: 0.75rem;
+    margin-bottom: 1.25rem;
+}
+
+.stat-value-large { font-size: 2rem; font-weight: bold; }
+.stat-value-green { color: var(--color-green); }
+.stat-value-blue { color: var(--color-blue); }
+.stat-label { font-size: 0.85rem; color: var(--color-text-light); margin-top: 0.2rem; }
+
+.schedule-day-card { padding: 0; overflow: hidden; }
+
+.schedule-day-header {
+    display: flex;
+    justify-content: space-between;
+    align-items: center;
+    padding: 0.75rem;
+    background: var(--color-gray);
+}
+
+.schedule-day-header.today { background: var(--color-teal); color: white; }
+.schedule-day-name { font-weight: bold; display: block; }
+.schedule-day-date { font-size: 0.8rem; opacity: 0.8; }
+.schedule-day-hours { font-weight: bold; }
+.schedule-day-list { padding: 0.4rem; }
+
+.schedule-day-item {
+    display: flex;
+    gap: 0.75rem;
+    padding: 0.6rem;
+    border-bottom: 1px solid #eee;
+    align-items: center;
+}
+
+.schedule-day-item:last-child { border-bottom: none; }
+
+/* Availability Grid */
+.availability-grid { display: flex; flex-wrap: wrap; gap: 0.4rem; }
+.availability-badges { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.4rem; }
+
+/* Status Buttons */
+.status-buttons { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-bottom: 0.75rem; }
+
+/* Tabs */
+.tabs {
+    display: flex;
+    gap: 0.4rem;
+    margin-bottom: 1.25rem;
+    border-bottom: 2px solid #eee;
+    padding-bottom: 0.4rem;
+    flex-wrap: wrap;
+}
+
+/* ==========================================
+   RESPONSIVE STYLES
+   ========================================== */
+@media (max-width: 1024px) {
+    .grid { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
+    .form-grid-3 { grid-template-columns: repeat(2, 1fr); }
+}
+
+@media (max-width: 768px) {
+    .sidebar {
+        position: fixed;
+        left: 0;
+        top: 0;
+        width: 260px;
+        height: 100vh;
+        transform: translateX(-100%);
+        transition: transform 0.3s ease;
+        z-index: 1000;
+    }
+
+    .sidebar.open { transform: translateX(0); }
+
+    .main-content {
+        margin-left: 0;
+        width: 100%;
+    }
+
+    .hamburger-btn { display: block; }
+
+    .header {
+        padding: 0.75rem 1rem;
+        display: flex;
+        justify-content: space-between;
+        align-items: center;
+    }
+
+    .header h1 { font-size: 1.1rem; }
+    .header p { font-size: 0.75rem; display: none; }
+
+    .container { padding: 0.75rem; }
+
+    .page-header {
+        flex-direction: column;
+        align-items: flex-start;
+        gap: 0.75rem;
+    }
+
+    .page-header h2 { font-size: 1.3rem; }
+
+    .card {
+        padding: 0.75rem;
+        margin-bottom: 0.75rem;
+    }
+
+    .grid { grid-template-columns: 1fr; gap: 0.75rem; }
+
+    .form-grid,
+    .form-grid-2,
+    .form-grid-3 {
+        grid-template-columns: 1fr;
+    }
+
+    /* Tables scroll horizontally */
+    .table { font-size: 0.8rem; min-width: 450px; }
+    .table th, .table td { padding: 0.4rem 0.3rem; }
+    .table .btn-sm { padding: 0.25rem 0.4rem; font-size: 0.7rem; }
+
+    /* Calendar */
+    .calendar-grid { min-height: 250px; }
+    .calendar-cell { min-height: 50px; padding: 0.25rem; }
+    .calendar-day-number { font-size: 0.85rem; }
+    .calendar-day-name { padding: 0.4rem; font-size: 0.75rem; }
+
+    /* Modals slide up from bottom on mobile */
+    .modal-content {
+        width: 100%;
+        max-width: 100%;
+        max-height: 85vh;
+        margin: 0;
+        border-radius: 12px 12px 0 0;
+        position: fixed;
+        bottom: 0;
+        left: 0;
+        right: 0;
+    }
+
+    .modal-large { max-width: 100%; }
+
+    .form-actions, .modal-actions {
+        flex-direction: column;
+    }
+
+    .form-actions .btn,
+    .modal-actions .btn {
+        width: 100%;
+    }
+
+    .stat-card .value { font-size: 1.5rem; }
+    .badge { font-size: 0.65rem; padding: 0.15rem 0.35rem; }
+    .login-card { margin: 0.75rem; padding: 1.5rem; }
+    
+    .filter-controls { flex-direction: column; }
+    .search-input { max-width: 100%; }
+    .applications-grid { grid-template-columns: 1fr; }
+    .stats-grid-2 { grid-template-columns: 1fr; }
+    .timer-display { font-size: 2rem; }
+    .clock-btn { padding: 0.6rem 1.5rem; font-size: 1rem; }
+}
+
+@media (max-width: 480px) {
+    .header h1 { font-size: 1rem; }
+    .sidebar { width: 240px; }
+    .card { padding: 0.6rem; }
+    .btn { padding: 0.5rem 0.8rem; font-size: 0.8rem; }
+    .btn-sm { padding: 0.2rem 0.4rem; font-size: 0.65rem; }
+    .calendar-cell { min-height: 40px; }
+    .stat-value-large { font-size: 1.6rem; }
+    .modal-header h2 { font-size: 1.1rem; }
+}
+
+/* ═══════════════════════════════════════════════════════
+   MOBILE REDESIGN — Bottom Nav + Polish
+   ═══════════════════════════════════════════════════════ */
+
+@media (max-width: 768px) {
+
+  /* ── Bottom Navigation Bar ── */
+  .mobile-bottom-nav {
+    display: flex;
+    position: fixed;
+    bottom: 0;
+    left: 0;
+    right: 0;
+    height: calc(64px + env(safe-area-inset-bottom, 0px));
+    padding-bottom: env(safe-area-inset-bottom, 0px);
+    background: #fff;
+    border-top: 1px solid #E5E7EB;
+    z-index: 1100;
+    box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
+  }
+
+  .mobile-bottom-nav-item {
+    flex: 1;
+    display: flex;
+    flex-direction: column;
+    align-items: center;
+    justify-content: center;
+    gap: 3px;
+    border: none;
+    background: none;
+    cursor: pointer;
+    padding: 0.5rem 0;
+    color: #9CA3AF;
+    font-size: 0.62rem;
+    font-weight: 600;
+    letter-spacing: 0.02em;
+    text-transform: uppercase;
+    transition: color 0.15s;
+    -webkit-tap-highlight-color: transparent;
+    position: relative;
+  }
+
+  .mobile-bottom-nav-item.active {
+    color: #2ABBA7;
+  }
+
+  .mobile-bottom-nav-item.active::before {
+    content: '';
+    position: absolute;
+    top: 0;
+    left: 50%;
+    transform: translateX(-50%);
+    width: 32px;
+    height: 3px;
+    background: #2ABBA7;
+    border-radius: 0 0 3px 3px;
+  }
+
+  .mobile-bottom-nav-icon {
+    font-size: 1.3rem;
+    line-height: 1;
+  }
+
+  /* ── More Menu Drawer ── */
+  .mobile-more-drawer {
+    position: fixed;
+    bottom: 64px;
+    left: 0;
+    right: 0;
+    background: #fff;
+    border-top: 1px solid #E5E7EB;
+    z-index: 1099;
+    max-height: 60vh;
+    overflow-y: auto;
+    transform: translateY(100%);
+    transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1);
+    box-shadow: 0 -8px 32px rgba(0,0,0,0.12);
+    border-radius: 16px 16px 0 0;
+    padding-bottom: env(safe-area-inset-bottom, 0);
+  }
+
+  .mobile-more-drawer.open {
+    transform: translateY(0);
+  }
+
+  .mobile-more-drawer-handle {
+    width: 36px;
+    height: 4px;
+    background: #E5E7EB;
+    border-radius: 2px;
+    margin: 12px auto 8px;
+  }
+
+  .mobile-more-drawer-section {
+    padding: 0.5rem 1rem;
+  }
+
+  .mobile-more-drawer-section-title {
+    font-size: 0.7rem;
+    font-weight: 700;
+    color: #9CA3AF;
+    text-transform: uppercase;
+    letter-spacing: 0.08em;
+    padding: 0.5rem 0.25rem 0.35rem;
+  }
+
+  .mobile-more-drawer-item {
+    display: flex;
+    align-items: center;
+    gap: 0.75rem;
+    padding: 0.75rem 0.5rem;
+    border-radius: 8px;
+    border: none;
+    background: none;
+    width: 100%;
+    text-align: left;
+    cursor: pointer;
+    font-size: 0.95rem;
+    color: #374151;
+    font-weight: 500;
+    -webkit-tap-highlight-color: transparent;
+    transition: background 0.1s;
+  }
+
+  .mobile-more-drawer-item:active,
+  .mobile-more-drawer-item.active {
+    background: #F0FDFB;
+    color: #2ABBA7;
+  }
+
+  .mobile-more-drawer-item-icon {
+    width: 36px;
+    height: 36px;
+    display: flex;
+    align-items: center;
+    justify-content: center;
+    background: #F3F4F6;
+    border-radius: 8px;
+    font-size: 1.1rem;
+    flex-shrink: 0;
+  }
+
+  .mobile-more-drawer-item.active .mobile-more-drawer-item-icon {
+    background: #CCFBF1;
+  }
+
+  .mobile-more-drawer-overlay {
+    position: fixed;
+    inset: 0;
+    background: rgba(0,0,0,0.3);
+    z-index: 1098;
+  }
+
+  /* ── Padding for bottom nav ── */
+  .main-content {
+    padding-bottom: calc(72px + env(safe-area-inset-bottom, 0px)) !important;
+  }
+
+  /* ── Header improvements ── */
+  .header {
+    background: #fff !important;
+    border-bottom: 1px solid #E5E7EB;
+    box-shadow: 0 1px 4px rgba(0,0,0,0.06);
+    padding: 0.6rem 1rem !important;
+    min-height: 56px;
+  }
+
+  .header h1 {
+    font-size: 1rem !important;
+    font-weight: 700;
+    color: #111827;
+  }
+
+  /* Hide hamburger — replaced by bottom nav */
+  .hamburger-btn {
+    display: none !important;
+  }
+
+  /* ── Card improvements ── */
+  .card {
+    border-radius: 12px !important;
+    box-shadow: 0 1px 4px rgba(0,0,0,0.07) !important;
+    border: 1px solid #F3F4F6;
+  }
+
+  /* ── Stat cards ── */
+  .stat-card {
+    border-radius: 12px !important;
+    padding: 1rem !important;
+  }
+
+  .stat-card .value,
+  .stat-value-large {
+    font-size: 1.75rem !important;
+    font-weight: 800 !important;
+  }
+
+  /* ── Buttons — larger touch targets ── */
+  .btn {
+    min-height: 44px;
+    border-radius: 10px !important;
+    font-weight: 600 !important;
+  }
+
+  .btn-primary {
+    background: linear-gradient(135deg, #2ABBA7, #1E9A89) !important;
+    box-shadow: 0 2px 8px rgba(42, 187, 167, 0.3) !important;
+  }
+
+  /* ── Form inputs ── */
+  input[type="text"],
+  input[type="email"],
+  input[type="password"],
+  input[type="tel"],
+  input[type="date"],
+  input[type="time"],
+  input[type="number"],
+  select,
+  textarea {
+    min-height: 44px;
+    font-size: 16px !important; /* prevents iOS zoom */
+    border-radius: 10px !important;
+  }
+
+  /* ── Table improvements ── */
+  .table-wrapper {
+    overflow-x: auto;
+    -webkit-overflow-scrolling: touch;
+    border-radius: 12px;
+    border: 1px solid #E5E7EB;
+  }
+
+  /* ── Login page ── */
+  .login-container {
+    padding: 1.5rem;
+    align-items: flex-start;
+    padding-top: 4rem;
+  }
+
+  .login-card {
+    border-radius: 16px !important;
+    padding: 2rem 1.5rem !important;
+    box-shadow: 0 8px 32px rgba(0,0,0,0.12) !important;
+  }
+
+  /* ── Page header ── */
+  .page-header h2 {
+    font-size: 1.25rem !important;
+    font-weight: 800;
+  }
+
+  /* ── Container ── */
+  .container {
+    padding: 0.875rem !important;
+  }
+
+  /* ── Modal full-screen on mobile ── */
+  .modal-content {
+    border-radius: 20px 20px 0 0 !important;
+    max-height: 90vh !important;
+  }
+
+  .modal-header {
+    padding: 1rem 1.25rem 0.875rem !important;
+    border-radius: 20px 20px 0 0;
+  }
+}
diff --git a/templates/crm-homecare/frontend/tailwind.config.js b/templates/crm-homecare/frontend/tailwind.config.js
deleted file mode 100644
index 577d441..0000000
--- a/templates/crm-homecare/frontend/tailwind.config.js
+++ /dev/null
@@ -1,13 +0,0 @@
-/** @type {import('tailwindcss').Config} */
-export default {
-  content: ['./index.html', './src/**/*.{js,jsx}'],
-  theme: {
-    extend: {
-      colors: {
-        primary: 'var(--color-primary)',
-        secondary: 'var(--color-secondary)',
-      },
-    },
-  },
-  plugins: [],
-};
-- 
2.43.0


From 5e90a74e01aaff70ba611821f4c7b22f62124332 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 00:00:53 +0000
Subject: [PATCH 19/27] fix: remove tailwindcss and postcss from frontend
 package.json

---
 templates/crm-homecare/frontend/package.json | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

diff --git a/templates/crm-homecare/frontend/package.json b/templates/crm-homecare/frontend/package.json
index b789f90..8ba15d1 100644
--- a/templates/crm-homecare/frontend/package.json
+++ b/templates/crm-homecare/frontend/package.json
@@ -23,14 +23,11 @@
     "@capacitor/push-notifications": "^8.0.1",
     "@capacitor/splash-screen": "^8.0.1",
     "@capacitor/status-bar": "^8.0.1",
-    "autoprefixer": "^10.4.24",
     "axios": "^1.6.2",
-    "postcss": "^8.5.6",
     "prop-types": "^15.8.1",
     "react": "^18.2.0",
     "react-dom": "^18.2.0",
-    "react-router-dom": "^6.28.0",
-    "tailwindcss": "^4.2.1"
+    "react-router-dom": "^6.28.0"
   },
   "devDependencies": {
     "@vitejs/plugin-react": "^4.2.1",
@@ -41,4 +38,4 @@
   "engines": {
     "node": ">=18.0.0"
   }
-}
+}
\ No newline at end of file
-- 
2.43.0


From f2f3e3ec9225389b38588c4ca9697806efb943a8 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 00:10:47 +0000
Subject: [PATCH 20/27] fix: reuse existing DB if name already taken instead of
 failing

---
 backend/src/services/factory/deploy.js | 32 ++++++++++++++++++++++----
 1 file changed, 28 insertions(+), 4 deletions(-)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 6a9b95b..805e521 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -158,16 +158,31 @@ export async function pushToGitHub(repoFullName, extractDir) {
 /**
  * Create a Render Postgres database
  */
+async function findExistingDatabase(name) {
+  const res = await fetch(`${RENDER_API}/postgres?limit=20`, {
+    headers: renderHeaders(),
+  });
+  if (!res.ok) return null;
+  const list = await res.json();
+  const match = (Array.isArray(list) ? list : []).find(item => {
+    const db = item.postgres || item;
+    return db.name === name;
+  });
+  return match ? (match.postgres || match) : null;
+}
+
 async function createRenderDatabase(slug, region = 'ohio') {
+  const dbName = `${slug}-db`;
+
   const res = await fetch(`${RENDER_API}/postgres`, {
     method: 'POST',
     headers: renderHeaders(),
     body: JSON.stringify({
       databaseName: slug.replace(/-/g, '_'),
       databaseUser: slug.replace(/-/g, '_'),
-      name: `${slug}-db`,
+      name: dbName,
       ownerId: process.env.RENDER_OWNER_ID,
-      plan: 'free', // Start free, customer can upgrade
+      plan: 'free',
       region: region,
       version: '16',
     }),
@@ -175,8 +190,17 @@ async function createRenderDatabase(slug, region = 'ohio') {
 
   if (!res.ok) {
     const err = await res.json();
-    const msg = `Render DB creation failed (${res.status}): ${JSON.stringify(err)}`;
-    throw new Error(msg);
+    const errStr = JSON.stringify(err);
+    // If name already taken, find and reuse existing DB
+    if (res.status === 400 || res.status === 409 || errStr.includes('already') || errStr.includes('exists')) {
+      logger.info(`[Deploy] DB ${dbName} already exists, looking it up...`);
+      const existing = await findExistingDatabase(dbName);
+      if (existing) {
+        logger.info(`[Deploy] Reusing existing DB id=${existing.id}`);
+        return existing;
+      }
+    }
+    throw new Error(`Render DB creation failed (${res.status}): ${errStr}`);
   }
 
   return await res.json();
-- 
2.43.0


From 86dae018f8e0d6ae7789d094354fff09015a7366 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 00:40:36 +0000
Subject: [PATCH 21/27] fix: use prisma db push instead of migrate deploy for
 homecare (no migration files)

---
 backend/src/services/factory/deploy.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 805e521..3b9d82e 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -446,7 +446,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
           name: isHomeCare ? `${slug}-care-api` : `${slug}-api`,
           repoFullName: repo.full_name,
           rootDir: 'crm/backend',
-          buildCommand: 'npm install && npx prisma generate && npx prisma migrate deploy',
+          buildCommand: 'npm install && npx prisma generate && npx prisma db push --accept-data-loss',
           startCommand: 'npm run db:seed && npm start',
           envVars: backendEnvVars,
           plan,
-- 
2.43.0


From 9208adca4d9a01ccc1e670f46f298db7705d9bb1 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 00:44:11 +0000
Subject: [PATCH 22/27] fix: add initial migration, unignore migrations folder,
 revert to migrate deploy

---
 backend/src/services/factory/deploy.js        |    2 +-
 templates/crm-homecare/backend/.gitignore     |    1 -
 .../20240101000000_init/migration.sql         | 1012 +++++++++++++++++
 .../prisma/migrations/migration_lock.toml     |    3 +
 4 files changed, 1016 insertions(+), 2 deletions(-)
 create mode 100644 templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
 create mode 100644 templates/crm-homecare/backend/prisma/migrations/migration_lock.toml

diff --git a/backend/src/services/factory/deploy.js b/backend/src/services/factory/deploy.js
index 3b9d82e..805e521 100644
--- a/backend/src/services/factory/deploy.js
+++ b/backend/src/services/factory/deploy.js
@@ -446,7 +446,7 @@ export async function deployCustomer(factoryCustomer, zipPath, options = {}) {
           name: isHomeCare ? `${slug}-care-api` : `${slug}-api`,
           repoFullName: repo.full_name,
           rootDir: 'crm/backend',
-          buildCommand: 'npm install && npx prisma generate && npx prisma db push --accept-data-loss',
+          buildCommand: 'npm install && npx prisma generate && npx prisma migrate deploy',
           startCommand: 'npm run db:seed && npm start',
           envVars: backendEnvVars,
           plan,
diff --git a/templates/crm-homecare/backend/.gitignore b/templates/crm-homecare/backend/.gitignore
index 969e239..bd6a1b7 100644
--- a/templates/crm-homecare/backend/.gitignore
+++ b/templates/crm-homecare/backend/.gitignore
@@ -1,4 +1,3 @@
 node_modules/
 .env
 uploads/
-prisma/migrations/
diff --git a/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql b/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
new file mode 100644
index 0000000..f487369
--- /dev/null
+++ b/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
@@ -0,0 +1,1012 @@
+-- Prisma Initial Migration
+-- Generated from schema.prisma
+
+-- CreateTable
+CREATE TABLE "agencies" (
+    "id" TEXT NOT NULL,
+    "name" TEXT NOT NULL,
+    "legal_name" TEXT,
+    "slug" TEXT NOT NULL UNIQUE,
+    "email" TEXT,
+    "phone" TEXT,
+    "address" TEXT,
+    "city" TEXT,
+    "state" TEXT,
+    "zip" TEXT,
+    "primary_color" TEXT NOT NULL DEFAULT '#0369a1',
+    "secondary_color" TEXT,
+    "logo" TEXT,
+    "website" TEXT,
+    "license_number" TEXT,
+    "npi" TEXT,
+    "medicaid_id" TEXT,
+    "settings" JSONB NOT NULL DEFAULT '{}',
+    "stripe_customer_id" TEXT UNIQUE,
+    "subscription_tier" TEXT,
+    "twilio_phone_number" TEXT,
+    "twilio_account_sid" TEXT,
+    "twilio_auth_token" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "agencies_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "users" (
+    "id" TEXT NOT NULL,
+    "email" TEXT NOT NULL UNIQUE,
+    "password_hash" TEXT NOT NULL,
+    "first_name" TEXT NOT NULL,
+    "last_name" TEXT NOT NULL,
+    "phone" TEXT,
+    "role" TEXT NOT NULL DEFAULT 'caregiver',
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "address" TEXT,
+    "city" TEXT,
+    "state" TEXT,
+    "zip" TEXT,
+    "latitude" DECIMAL(10,8),
+    "longitude" DECIMAL(11,8),
+    "certifications" TEXT[] NOT NULL,
+    "certifications_expiry" TIMESTAMP(3)[] NOT NULL,
+    "default_pay_rate" DECIMAL(8,2),
+    "hire_date" DATE,
+    "emergency_contact_name" TEXT,
+    "emergency_contact_phone" TEXT,
+    "last_login" TIMESTAMP(3),
+    "refresh_token" TEXT,
+    "reset_token" TEXT,
+    "reset_token_exp" TIMESTAMP(3),
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "users_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "caregiver_profiles" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL UNIQUE,
+    "notes" TEXT,
+    "capabilities" TEXT,
+    "limitations" TEXT,
+    "preferred_hours" TEXT,
+    "available_mon" BOOLEAN NOT NULL DEFAULT true,
+    "available_tue" BOOLEAN NOT NULL DEFAULT true,
+    "available_wed" BOOLEAN NOT NULL DEFAULT true,
+    "available_thu" BOOLEAN NOT NULL DEFAULT true,
+    "available_fri" BOOLEAN NOT NULL DEFAULT true,
+    "available_sat" BOOLEAN NOT NULL DEFAULT false,
+    "available_sun" BOOLEAN NOT NULL DEFAULT false,
+    "npi_number" TEXT,
+    "taxonomy_code" TEXT DEFAULT '374700000X',
+    "evv_worker_id" TEXT,
+    "medicaid_provider_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "caregiver_profiles_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "caregiver_availability" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL UNIQUE,
+    "status" TEXT NOT NULL DEFAULT 'available',
+    "max_hours_per_week" INTEGER NOT NULL DEFAULT 40,
+    "weekly_availability" JSONB,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "caregiver_availability_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "caregiver_schedules" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "day_of_week" INTEGER,
+    "date" DATE,
+    "start_time" TIME,
+    "end_time" TIME,
+    "is_available" BOOLEAN NOT NULL DEFAULT true,
+    "max_hours_per_week" INTEGER NOT NULL DEFAULT 40,
+    "overtime_approved" BOOLEAN NOT NULL DEFAULT false,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "caregiver_schedules_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "caregiver_time_off" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "start_date" DATE NOT NULL,
+    "end_date" DATE NOT NULL,
+    "type" TEXT NOT NULL,
+    "reason" TEXT,
+    "approved_by_id" TEXT,
+    "status" TEXT NOT NULL DEFAULT 'pending',
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "caregiver_time_off_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "referral_sources" (
+    "id" TEXT NOT NULL,
+    "name" TEXT NOT NULL,
+    "type" TEXT,
+    "contact_name" TEXT,
+    "email" TEXT,
+    "phone" TEXT,
+    "address" TEXT,
+    "city" TEXT,
+    "state" TEXT,
+    "zip" TEXT,
+    "notes" TEXT,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "payer_type" TEXT DEFAULT 'other',
+    "payer_id_number" TEXT,
+    "npi" TEXT,
+    "expected_pay_days" INTEGER DEFAULT 30,
+    "is_active_payer" BOOLEAN NOT NULL DEFAULT false,
+    "edi_payer_id" TEXT,
+    "submission_method" TEXT DEFAULT 'manual',
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "referral_sources_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "clients" (
+    "id" TEXT NOT NULL,
+    "first_name" TEXT NOT NULL,
+    "last_name" TEXT NOT NULL,
+    "date_of_birth" DATE,
+    "ssn_encrypted" TEXT,
+    "gender" TEXT,
+    "address" TEXT,
+    "city" TEXT,
+    "state" TEXT,
+    "zip" TEXT,
+    "phone" TEXT,
+    "email" TEXT,
+    "referred_by_id" TEXT,
+    "referral_date" DATE,
+    "start_date" DATE,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "service_type" TEXT,
+    "insurance_provider" TEXT,
+    "insurance_id" TEXT,
+    "insurance_group" TEXT,
+    "medical_conditions" TEXT[] NOT NULL,
+    "allergies" TEXT[] NOT NULL,
+    "medications" TEXT[] NOT NULL,
+    "preferred_caregivers" TEXT[] NOT NULL,
+    "do_not_use_caregivers" TEXT[] NOT NULL,
+    "notes" TEXT,
+    "evv_client_id" TEXT,
+    "mco_member_id" TEXT,
+    "primary_diagnosis_code" TEXT,
+    "secondary_diagnosis_code" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "clients_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "client_emergency_contacts" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL,
+    "name" TEXT NOT NULL,
+    "relationship" TEXT,
+    "phone" TEXT NOT NULL,
+    "email" TEXT,
+    "is_primary" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "client_emergency_contacts_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "client_onboarding" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL UNIQUE,
+    "emergency_contacts_completed" BOOLEAN NOT NULL DEFAULT false,
+    "medical_history_completed" BOOLEAN NOT NULL DEFAULT false,
+    "insurance_info_completed" BOOLEAN NOT NULL DEFAULT false,
+    "care_preferences_completed" BOOLEAN NOT NULL DEFAULT false,
+    "family_communication_completed" BOOLEAN NOT NULL DEFAULT false,
+    "initial_assessment_completed" BOOLEAN NOT NULL DEFAULT false,
+    "all_completed" BOOLEAN NOT NULL DEFAULT false,
+    "completed_at" TIMESTAMP(3),
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "client_onboarding_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "client_assignments" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "assignment_date" DATE NOT NULL,
+    "hours_per_week" DECIMAL(5,2),
+    "pay_rate" DECIMAL(10,2),
+    "status" TEXT NOT NULL DEFAULT 'active',
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "client_assignments_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "schedules" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT,
+    "caregiver_id" TEXT,
+    "title" TEXT,
+    "start_time" TIMESTAMP(3),
+    "end_time" TIMESTAMP(3),
+    "frequency" TEXT NOT NULL DEFAULT 'weekly',
+    "effective_date" DATE,
+    "anchor_date" DATE,
+    "schedule_type" TEXT NOT NULL DEFAULT 'recurring',
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "day_of_week" INTEGER,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "schedules_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "open_shifts" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT,
+    "date" DATE NOT NULL,
+    "start_time" TIME,
+    "end_time" TIME,
+    "status" TEXT NOT NULL DEFAULT 'open',
+    "notes" TEXT,
+    "source_absence_id" TEXT,
+    "notified_caregiver_count" INTEGER NOT NULL DEFAULT 0,
+    "auto_created" BOOLEAN NOT NULL DEFAULT false,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "open_shifts_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "open_shift_notifications" (
+    "id" TEXT NOT NULL,
+    "open_shift_id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "notified_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "notification_type" TEXT NOT NULL DEFAULT 'push',
+
+    CONSTRAINT "open_shift_notifications_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "absences" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "client_id" TEXT,
+    "date" DATE NOT NULL,
+    "type" TEXT NOT NULL,
+    "reason" TEXT,
+    "reported_by_id" TEXT,
+    "coverage_needed" BOOLEAN NOT NULL DEFAULT true,
+    "coverage_assigned_to" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "absences_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "time_entries" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL,
+    "assignment_id" TEXT,
+    "schedule_id" TEXT,
+    "start_time" TIMESTAMP(3) NOT NULL,
+    "end_time" TIMESTAMP(3),
+    "duration_minutes" INTEGER,
+    "allotted_minutes" INTEGER,
+    "billable_minutes" INTEGER,
+    "discrepancy_minutes" INTEGER,
+    "clock_in_location" JSONB,
+    "clock_out_location" JSONB,
+    "is_complete" BOOLEAN NOT NULL DEFAULT false,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "time_entries_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "gps_tracking" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "time_entry_id" TEXT,
+    "latitude" DECIMAL(10,8) NOT NULL,
+    "longitude" DECIMAL(11,8) NOT NULL,
+    "accuracy" INTEGER,
+    "speed" DECIMAL(6,2),
+    "heading" INTEGER,
+    "timestamp" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "gps_tracking_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "geofence_settings" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL UNIQUE,
+    "radius_feet" INTEGER NOT NULL DEFAULT 300,
+    "auto_clock_in" BOOLEAN NOT NULL DEFAULT true,
+    "auto_clock_out" BOOLEAN NOT NULL DEFAULT true,
+    "require_gps" BOOLEAN NOT NULL DEFAULT true,
+    "notify_admin_on_override" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "geofence_settings_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "service_codes" (
+    "id" TEXT NOT NULL,
+    "code" TEXT NOT NULL,
+    "modifier1" TEXT,
+    "modifier2" TEXT,
+    "description" TEXT NOT NULL,
+    "service_category" TEXT,
+    "payer_type" TEXT NOT NULL DEFAULT 'all',
+    "unit_type" TEXT NOT NULL DEFAULT '15min',
+    "rate_per_unit" DECIMAL(8,4),
+    "requires_evv" BOOLEAN NOT NULL DEFAULT true,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "service_codes_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "authorizations" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL,
+    "payer_id" TEXT,
+    "auth_number" TEXT,
+    "midas_auth_id" TEXT,
+    "procedure_code" TEXT,
+    "modifier" TEXT,
+    "authorized_units" DECIMAL(10,2) NOT NULL,
+    "unit_type" TEXT NOT NULL DEFAULT '15min',
+    "used_units" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "start_date" DATE NOT NULL,
+    "end_date" DATE NOT NULL,
+    "status" TEXT NOT NULL DEFAULT 'active',
+    "low_units_alert_threshold" DECIMAL(10,2) NOT NULL DEFAULT 20,
+    "notes" TEXT,
+    "imported_from" TEXT NOT NULL DEFAULT 'manual',
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "authorizations_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "evv_visits" (
+    "id" TEXT NOT NULL,
+    "time_entry_id" TEXT NOT NULL UNIQUE,
+    "client_id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "authorization_id" TEXT,
+    "service_code" TEXT,
+    "modifier" TEXT,
+    "service_date" DATE NOT NULL,
+    "actual_start" TIMESTAMP(3) NOT NULL,
+    "actual_end" TIMESTAMP(3),
+    "units_of_service" DECIMAL(8,2),
+    "gps_in_lat" DECIMAL(10,7),
+    "gps_in_lng" DECIMAL(10,7),
+    "gps_out_lat" DECIMAL(10,7),
+    "gps_out_lng" DECIMAL(10,7),
+    "sandata_status" TEXT NOT NULL DEFAULT 'pending',
+    "sandata_visit_id" TEXT,
+    "sandata_submitted_at" TIMESTAMP(3),
+    "sandata_response" JSONB,
+    "sandata_exception_code" TEXT,
+    "sandata_exception_desc" TEXT,
+    "evv_method" TEXT NOT NULL DEFAULT 'gps',
+    "is_verified" BOOLEAN NOT NULL DEFAULT false,
+    "verification_issues" JSONB NOT NULL DEFAULT '[]',
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "evv_visits_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "validation_log" (
+    "id" TEXT NOT NULL,
+    "entity_type" TEXT NOT NULL,
+    "entity_id" TEXT NOT NULL,
+    "validation_type" TEXT NOT NULL,
+    "status" TEXT NOT NULL,
+    "message" TEXT,
+    "details" JSONB,
+    "resolved_at" TIMESTAMP(3),
+    "resolved_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "validation_log_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "invoices" (
+    "id" TEXT NOT NULL,
+    "invoice_number" TEXT NOT NULL UNIQUE,
+    "client_id" TEXT NOT NULL,
+    "billing_period_start" DATE NOT NULL,
+    "billing_period_end" DATE NOT NULL,
+    "subtotal" DECIMAL(12,2) NOT NULL,
+    "tax" DECIMAL(12,2) NOT NULL DEFAULT 0,
+    "total" DECIMAL(12,2) NOT NULL,
+    "payment_status" TEXT NOT NULL DEFAULT 'pending',
+    "payment_due_date" DATE,
+    "payment_date" DATE,
+    "payment_method" TEXT,
+    "stripe_payment_intent_id" TEXT,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "invoices_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "invoice_line_items" (
+    "id" TEXT NOT NULL,
+    "invoice_id" TEXT NOT NULL,
+    "time_entry_id" TEXT,
+    "caregiver_id" TEXT NOT NULL,
+    "description" TEXT NOT NULL,
+    "hours" DECIMAL(6,2) NOT NULL,
+    "rate" DECIMAL(10,2) NOT NULL,
+    "amount" DECIMAL(12,2) NOT NULL,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "invoice_line_items_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "edi_batches" (
+    "id" TEXT NOT NULL,
+    "payer_id" TEXT,
+    "batch_number" TEXT NOT NULL UNIQUE,
+    "status" TEXT NOT NULL DEFAULT 'draft',
+    "claim_count" INTEGER NOT NULL DEFAULT 0,
+    "total_billed" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "edi_content" TEXT,
+    "submitted_at" TIMESTAMP(3),
+    "response_code" TEXT,
+    "response_message" TEXT,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "edi_batches_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "claims" (
+    "id" TEXT NOT NULL,
+    "client_id" TEXT,
+    "caregiver_id" TEXT,
+    "edi_batch_id" TEXT,
+    "evv_visit_id" TEXT,
+    "authorization_id" TEXT,
+    "claim_number" TEXT,
+    "service_date" DATE,
+    "service_code" TEXT,
+    "billed_amount" DECIMAL(10,2),
+    "allowed_amount" DECIMAL(10,2),
+    "paid_amount" DECIMAL(10,2),
+    "denial_code" TEXT,
+    "denial_reason" TEXT,
+    "status" TEXT NOT NULL DEFAULT 'pending',
+    "submission_date" DATE,
+    "paid_date" DATE,
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "claims_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "remittance_batches" (
+    "id" TEXT NOT NULL,
+    "payer_id" TEXT,
+    "payer_name" TEXT NOT NULL,
+    "payer_type" TEXT NOT NULL DEFAULT 'other',
+    "check_number" TEXT,
+    "check_date" DATE,
+    "payment_date" DATE,
+    "total_amount" DECIMAL(10,2) NOT NULL,
+    "raw_ocr_text" TEXT,
+    "status" TEXT NOT NULL DEFAULT 'pending_match',
+    "notes" TEXT,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "remittance_batches_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "remittance_line_items" (
+    "id" TEXT NOT NULL,
+    "batch_id" TEXT NOT NULL,
+    "client_id" TEXT,
+    "invoice_id" TEXT,
+    "claim_id" TEXT,
+    "claim_number" TEXT,
+    "service_date_from" DATE,
+    "service_date_to" DATE,
+    "billed_amount" DECIMAL(10,2),
+    "allowed_amount" DECIMAL(10,2),
+    "paid_amount" DECIMAL(10,2) NOT NULL,
+    "adjustment_amount" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "denial_code" TEXT,
+    "denial_reason" TEXT,
+    "match_status" TEXT NOT NULL DEFAULT 'unmatched',
+    "matched_at" TIMESTAMP(3),
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "remittance_line_items_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "gusto_sync_log" (
+    "id" TEXT NOT NULL,
+    "sync_type" TEXT NOT NULL,
+    "status" TEXT NOT NULL,
+    "pay_period_start" DATE,
+    "pay_period_end" DATE,
+    "records_exported" INTEGER NOT NULL DEFAULT 0,
+    "gusto_response" JSONB,
+    "error_message" TEXT,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "gusto_sync_log_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "gusto_employee_map" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL UNIQUE,
+    "gusto_employee_id" TEXT,
+    "gusto_uuid" TEXT,
+    "is_synced" BOOLEAN NOT NULL DEFAULT false,
+    "last_synced_at" TIMESTAMP(3),
+
+    CONSTRAINT "gusto_employee_map_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "expenses" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL,
+    "category" TEXT,
+    "description" TEXT NOT NULL,
+    "amount" DECIMAL(10,2) NOT NULL,
+    "date" DATE NOT NULL,
+    "receipt_url" TEXT,
+    "status" TEXT NOT NULL DEFAULT 'pending',
+    "notes" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "expenses_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "performance_ratings" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "client_id" TEXT NOT NULL,
+    "rating_date" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "satisfaction_score" INTEGER,
+    "punctuality_score" INTEGER,
+    "professionalism_score" INTEGER,
+    "care_quality_score" INTEGER,
+    "comments" TEXT,
+    "no_shows" INTEGER NOT NULL DEFAULT 0,
+    "late_arrivals" INTEGER NOT NULL DEFAULT 0,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "performance_ratings_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "background_checks" (
+    "id" TEXT NOT NULL,
+    "caregiver_id" TEXT NOT NULL,
+    "check_type" TEXT NOT NULL DEFAULT 'criminal',
+    "provider" TEXT,
+    "cost" DECIMAL(8,2),
+    "status" TEXT NOT NULL DEFAULT 'pending',
+    "initiated_date" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "expiration_date" DATE,
+    "worcs_reference_number" TEXT,
+    "worcs_status" TEXT,
+    "ssn_encrypted" TEXT,
+    "drivers_license_encrypted" TEXT,
+    "drivers_license_state" TEXT,
+    "notes" TEXT,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "background_checks_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "notifications" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL,
+    "type" TEXT,
+    "title" TEXT NOT NULL,
+    "message" TEXT,
+    "is_read" BOOLEAN NOT NULL DEFAULT false,
+    "email_sent" BOOLEAN NOT NULL DEFAULT false,
+    "push_sent" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "notifications_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "notification_preferences" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL UNIQUE,
+    "email_enabled" BOOLEAN NOT NULL DEFAULT true,
+    "push_enabled" BOOLEAN NOT NULL DEFAULT true,
+    "schedule_alerts" BOOLEAN NOT NULL DEFAULT true,
+    "absence_alerts" BOOLEAN NOT NULL DEFAULT true,
+    "billing_alerts" BOOLEAN NOT NULL DEFAULT true,
+    "rating_alerts" BOOLEAN NOT NULL DEFAULT true,
+    "daily_digest" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "notification_preferences_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "push_subscriptions" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL,
+    "subscription" JSONB NOT NULL,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "push_subscriptions_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "message_threads" (
+    "id" TEXT NOT NULL,
+    "subject" TEXT NOT NULL,
+    "created_by_id" TEXT NOT NULL,
+    "thread_type" TEXT NOT NULL DEFAULT 'direct',
+    "is_broadcast" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "message_threads_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "message_thread_participants" (
+    "id" TEXT NOT NULL,
+    "thread_id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL,
+    "last_read_at" TIMESTAMP(3),
+    "joined_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "message_thread_participants_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "messages" (
+    "id" TEXT NOT NULL,
+    "thread_id" TEXT NOT NULL,
+    "sender_id" TEXT NOT NULL,
+    "body" TEXT NOT NULL,
+    "is_deleted" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "messages_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "communication_log" (
+    "id" TEXT NOT NULL,
+    "entity_type" TEXT NOT NULL,
+    "entity_id" TEXT NOT NULL,
+    "log_type" TEXT NOT NULL DEFAULT 'note',
+    "direction" TEXT,
+    "subject" TEXT,
+    "body" TEXT NOT NULL,
+    "logged_by_id" TEXT,
+    "logged_by_name" TEXT,
+    "client_id" TEXT,
+    "follow_up_date" DATE,
+    "follow_up_done" BOOLEAN NOT NULL DEFAULT false,
+    "is_pinned" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "communication_log_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "noshow_alert_config" (
+    "id" TEXT NOT NULL,
+    "grace_minutes" INTEGER NOT NULL DEFAULT 15,
+    "notify_admin" BOOLEAN NOT NULL DEFAULT true,
+    "notify_caregiver" BOOLEAN NOT NULL DEFAULT true,
+    "notify_client_family" BOOLEAN NOT NULL DEFAULT false,
+    "admin_phone" TEXT,
+    "admin_email" TEXT,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "noshow_alert_config_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "noshow_alerts" (
+    "id" TEXT NOT NULL,
+    "schedule_id" TEXT,
+    "caregiver_id" TEXT,
+    "client_id" TEXT,
+    "shift_date" DATE NOT NULL,
+    "expected_start" TIME NOT NULL,
+    "alerted_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "resolved_at" TIMESTAMP(3),
+    "resolved_by_id" TEXT,
+    "resolution_note" TEXT,
+    "status" TEXT NOT NULL DEFAULT 'open',
+    "sms_sent" BOOLEAN NOT NULL DEFAULT false,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "noshow_alerts_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "form_templates" (
+    "id" TEXT NOT NULL,
+    "name" TEXT NOT NULL,
+    "description" TEXT,
+    "category" TEXT NOT NULL DEFAULT 'general',
+    "fields" JSONB NOT NULL DEFAULT '[]',
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "requires_signature" BOOLEAN NOT NULL DEFAULT false,
+    "auto_attach_to" TEXT,
+    "created_by_id" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "form_templates_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "form_submissions" (
+    "id" TEXT NOT NULL,
+    "template_id" TEXT,
+    "template_name" TEXT,
+    "entity_type" TEXT,
+    "entity_id" TEXT,
+    "client_id" TEXT,
+    "submitted_by_id" TEXT,
+    "submitted_by_name" TEXT,
+    "data" JSONB NOT NULL DEFAULT '{}',
+    "signature" TEXT,
+    "signed_at" TIMESTAMP(3),
+    "status" TEXT NOT NULL DEFAULT 'draft',
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "form_submissions_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "login_activity" (
+    "id" TEXT NOT NULL,
+    "email" TEXT NOT NULL,
+    "user_id" TEXT,
+    "success" BOOLEAN NOT NULL DEFAULT false,
+    "ip_address" TEXT,
+    "user_agent" TEXT,
+    "fail_reason" TEXT,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "login_activity_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "audit_logs" (
+    "id" TEXT NOT NULL,
+    "user_id" TEXT NOT NULL,
+    "action" TEXT NOT NULL,
+    "table_name" TEXT,
+    "record_id" TEXT,
+    "old_data" JSONB,
+    "new_data" JSONB,
+    "ip_address" TEXT,
+    "timestamp" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "audit_logs_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "service_locations" (
+    "id" TEXT NOT NULL,
+    "name" TEXT NOT NULL,
+    "address" TEXT,
+    "city" TEXT,
+    "state" TEXT,
+    "zip" TEXT,
+    "latitude" DECIMAL(10,8),
+    "longitude" DECIMAL(11,8),
+    "service_radius_miles" INTEGER NOT NULL DEFAULT 5,
+    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updated_at" TIMESTAMP(3) NOT NULL,
+
+    CONSTRAINT "service_locations_pkey" PRIMARY KEY ("id")
+);
+
+-- CreateTable
+CREATE TABLE "dashboard_cache" (
+    "id" TEXT NOT NULL,
+    "cache_key" TEXT NOT NULL UNIQUE,
+    "data" JSONB,
+    "expires_at" TIMESTAMP(3),
+    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+
+    CONSTRAINT "dashboard_cache_pkey" PRIMARY KEY ("id")
+);
+
+CREATE INDEX "caregiver_schedules_caregiver_id_idx" ON "caregiver_schedules"("caregiver_id");
+CREATE INDEX "caregiver_schedules_date_idx" ON "caregiver_schedules"("date");
+
+CREATE INDEX "caregiver_time_off_caregiver_id_idx" ON "caregiver_time_off"("caregiver_id");
+CREATE INDEX "caregiver_time_off_start_date_end_date_idx" ON "caregiver_time_off"("start_date", "end_date");
+
+CREATE INDEX "referral_sources_type_idx" ON "referral_sources"("type");
+CREATE INDEX "referral_sources_is_active_idx" ON "referral_sources"("is_active");
+
+CREATE INDEX "clients_is_active_idx" ON "clients"("is_active");
+CREATE INDEX "clients_referred_by_id_idx" ON "clients"("referred_by_id");
+
+CREATE INDEX "client_emergency_contacts_client_id_idx" ON "client_emergency_contacts"("client_id");
+
+CREATE INDEX "client_assignments_client_id_idx" ON "client_assignments"("client_id");
+CREATE INDEX "client_assignments_caregiver_id_idx" ON "client_assignments"("caregiver_id");
+CREATE INDEX "client_assignments_status_idx" ON "client_assignments"("status");
+
+CREATE INDEX "schedules_client_id_idx" ON "schedules"("client_id");
+CREATE INDEX "schedules_caregiver_id_idx" ON "schedules"("caregiver_id");
+
+CREATE INDEX "open_shifts_date_idx" ON "open_shifts"("date");
+CREATE INDEX "open_shifts_status_idx" ON "open_shifts"("status");
+
+CREATE UNIQUE INDEX "open_shift_notifications_open_shift_id_caregiver_id_key" ON "open_shift_notifications"("open_shift_id", "caregiver_id");
+CREATE INDEX "open_shift_notifications_open_shift_id_idx" ON "open_shift_notifications"("open_shift_id");
+
+CREATE INDEX "absences_caregiver_id_idx" ON "absences"("caregiver_id");
+CREATE INDEX "absences_date_idx" ON "absences"("date");
+
+CREATE INDEX "time_entries_caregiver_id_idx" ON "time_entries"("caregiver_id");
+CREATE INDEX "time_entries_client_id_idx" ON "time_entries"("client_id");
+CREATE INDEX "time_entries_start_time_idx" ON "time_entries"("start_time");
+CREATE INDEX "time_entries_schedule_id_idx" ON "time_entries"("schedule_id");
+
+CREATE INDEX "gps_tracking_caregiver_id_idx" ON "gps_tracking"("caregiver_id");
+CREATE INDEX "gps_tracking_time_entry_id_idx" ON "gps_tracking"("time_entry_id");
+CREATE INDEX "gps_tracking_timestamp_idx" ON "gps_tracking"("timestamp");
+
+CREATE INDEX "service_codes_code_idx" ON "service_codes"("code");
+CREATE INDEX "service_codes_is_active_idx" ON "service_codes"("is_active");
+
+CREATE INDEX "authorizations_client_id_idx" ON "authorizations"("client_id");
+CREATE INDEX "authorizations_start_date_end_date_idx" ON "authorizations"("start_date", "end_date");
+CREATE INDEX "authorizations_status_idx" ON "authorizations"("status");
+
+CREATE INDEX "evv_visits_client_id_service_date_idx" ON "evv_visits"("client_id", "service_date");
+CREATE INDEX "evv_visits_caregiver_id_idx" ON "evv_visits"("caregiver_id");
+CREATE INDEX "evv_visits_sandata_status_idx" ON "evv_visits"("sandata_status");
+
+CREATE INDEX "validation_log_entity_id_entity_type_idx" ON "validation_log"("entity_id", "entity_type");
+
+CREATE INDEX "invoices_client_id_idx" ON "invoices"("client_id");
+CREATE INDEX "invoices_payment_status_idx" ON "invoices"("payment_status");
+
+CREATE INDEX "invoice_line_items_invoice_id_idx" ON "invoice_line_items"("invoice_id");
+
+CREATE INDEX "edi_batches_status_idx" ON "edi_batches"("status");
+
+CREATE INDEX "claims_edi_batch_id_idx" ON "claims"("edi_batch_id");
+CREATE INDEX "claims_evv_visit_id_idx" ON "claims"("evv_visit_id");
+CREATE INDEX "claims_status_idx" ON "claims"("status");
+
+CREATE INDEX "remittance_batches_payer_id_idx" ON "remittance_batches"("payer_id");
+
+CREATE INDEX "remittance_line_items_batch_id_idx" ON "remittance_line_items"("batch_id");
+
+CREATE INDEX "expenses_user_id_idx" ON "expenses"("user_id");
+
+CREATE INDEX "performance_ratings_caregiver_id_idx" ON "performance_ratings"("caregiver_id");
+CREATE INDEX "performance_ratings_client_id_idx" ON "performance_ratings"("client_id");
+
+CREATE INDEX "background_checks_caregiver_id_idx" ON "background_checks"("caregiver_id");
+
+CREATE INDEX "notifications_user_id_idx" ON "notifications"("user_id");
+CREATE INDEX "notifications_is_read_idx" ON "notifications"("is_read");
+
+CREATE UNIQUE INDEX "push_subscriptions_user_id_subscription_key" ON "push_subscriptions"("user_id", "subscription");
+CREATE INDEX "push_subscriptions_is_active_idx" ON "push_subscriptions"("is_active");
+
+CREATE INDEX "message_threads_updated_at_idx" ON "message_threads"("updated_at");
+
+CREATE UNIQUE INDEX "message_thread_participants_thread_id_user_id_key" ON "message_thread_participants"("thread_id", "user_id");
+CREATE INDEX "message_thread_participants_user_id_idx" ON "message_thread_participants"("user_id");
+CREATE INDEX "message_thread_participants_thread_id_idx" ON "message_thread_participants"("thread_id");
+
+CREATE INDEX "messages_thread_id_created_at_idx" ON "messages"("thread_id", "created_at");
+
+CREATE INDEX "communication_log_entity_type_entity_id_idx" ON "communication_log"("entity_type", "entity_id");
+CREATE INDEX "communication_log_created_at_idx" ON "communication_log"("created_at");
+
+CREATE INDEX "noshow_alerts_status_shift_date_idx" ON "noshow_alerts"("status", "shift_date");
+CREATE INDEX "noshow_alerts_caregiver_id_idx" ON "noshow_alerts"("caregiver_id");
+
+CREATE INDEX "form_templates_category_is_active_idx" ON "form_templates"("category", "is_active");
+
+CREATE INDEX "form_submissions_entity_type_entity_id_idx" ON "form_submissions"("entity_type", "entity_id");
+CREATE INDEX "form_submissions_template_id_idx" ON "form_submissions"("template_id");
+
+CREATE INDEX "login_activity_email_idx" ON "login_activity"("email");
+CREATE INDEX "login_activity_user_id_idx" ON "login_activity"("user_id");
+CREATE INDEX "login_activity_created_at_idx" ON "login_activity"("created_at");
+
+CREATE INDEX "audit_logs_user_id_idx" ON "audit_logs"("user_id");
+CREATE INDEX "audit_logs_timestamp_idx" ON "audit_logs"("timestamp");
+CREATE INDEX "audit_logs_table_name_idx" ON "audit_logs"("table_name");
diff --git a/templates/crm-homecare/backend/prisma/migrations/migration_lock.toml b/templates/crm-homecare/backend/prisma/migrations/migration_lock.toml
new file mode 100644
index 0000000..044d57c
--- /dev/null
+++ b/templates/crm-homecare/backend/prisma/migrations/migration_lock.toml
@@ -0,0 +1,3 @@
+# Please do not edit this file manually
+# It should be added in your version-control system (e.g., Git)
+provider = "postgresql"
-- 
2.43.0


From 3be6ea118effc3c99f13973b8527d941865e1d27 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 00:54:12 +0000
Subject: [PATCH 23/27] fix: regenerate migration with camelCase column names
 (no @map on fields)

---
 .../20240101000000_init/migration.sql         | 973 +++++++++---------
 1 file changed, 486 insertions(+), 487 deletions(-)

diff --git a/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql b/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
index f487369..27da084 100644
--- a/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
+++ b/templates/crm-homecare/backend/prisma/migrations/20240101000000_init/migration.sql
@@ -1,11 +1,10 @@
 -- Prisma Initial Migration
--- Generated from schema.prisma
 
 -- CreateTable
 CREATE TABLE "agencies" (
     "id" TEXT NOT NULL,
     "name" TEXT NOT NULL,
-    "legal_name" TEXT,
+    "legalName" TEXT,
     "slug" TEXT NOT NULL UNIQUE,
     "email" TEXT,
     "phone" TEXT,
@@ -13,21 +12,21 @@ CREATE TABLE "agencies" (
     "city" TEXT,
     "state" TEXT,
     "zip" TEXT,
-    "primary_color" TEXT NOT NULL DEFAULT '#0369a1',
-    "secondary_color" TEXT,
+    "primaryColor" TEXT NOT NULL DEFAULT '#0369a1',
+    "secondaryColor" TEXT,
     "logo" TEXT,
     "website" TEXT,
-    "license_number" TEXT,
+    "licenseNumber" TEXT,
     "npi" TEXT,
-    "medicaid_id" TEXT,
+    "medicaidId" TEXT,
     "settings" JSONB NOT NULL DEFAULT '{}',
-    "stripe_customer_id" TEXT UNIQUE,
-    "subscription_tier" TEXT,
-    "twilio_phone_number" TEXT,
-    "twilio_account_sid" TEXT,
-    "twilio_auth_token" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "stripeCustomerId" TEXT UNIQUE,
+    "subscriptionTier" TEXT,
+    "twilioPhoneNumber" TEXT,
+    "twilioAccountSid" TEXT,
+    "twilioAuthToken" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "agencies_pkey" PRIMARY KEY ("id")
 );
@@ -36,12 +35,12 @@ CREATE TABLE "agencies" (
 CREATE TABLE "users" (
     "id" TEXT NOT NULL,
     "email" TEXT NOT NULL UNIQUE,
-    "password_hash" TEXT NOT NULL,
-    "first_name" TEXT NOT NULL,
-    "last_name" TEXT NOT NULL,
+    "passwordHash" TEXT NOT NULL,
+    "firstName" TEXT NOT NULL,
+    "lastName" TEXT NOT NULL,
     "phone" TEXT,
     "role" TEXT NOT NULL DEFAULT 'caregiver',
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
     "address" TEXT,
     "city" TEXT,
     "state" TEXT,
@@ -49,17 +48,17 @@ CREATE TABLE "users" (
     "latitude" DECIMAL(10,8),
     "longitude" DECIMAL(11,8),
     "certifications" TEXT[] NOT NULL,
-    "certifications_expiry" TIMESTAMP(3)[] NOT NULL,
-    "default_pay_rate" DECIMAL(8,2),
-    "hire_date" DATE,
-    "emergency_contact_name" TEXT,
-    "emergency_contact_phone" TEXT,
-    "last_login" TIMESTAMP(3),
-    "refresh_token" TEXT,
-    "reset_token" TEXT,
-    "reset_token_exp" TIMESTAMP(3),
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "certificationsExpiry" TIMESTAMP(3)[] NOT NULL,
+    "defaultPayRate" DECIMAL(8,2),
+    "hireDate" DATE,
+    "emergencyContactName" TEXT,
+    "emergencyContactPhone" TEXT,
+    "lastLogin" TIMESTAMP(3),
+    "refreshToken" TEXT,
+    "resetToken" TEXT,
+    "resetTokenExp" TIMESTAMP(3),
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "users_pkey" PRIMARY KEY ("id")
 );
@@ -67,24 +66,24 @@ CREATE TABLE "users" (
 -- CreateTable
 CREATE TABLE "caregiver_profiles" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL UNIQUE,
+    "caregiverId" TEXT NOT NULL UNIQUE,
     "notes" TEXT,
     "capabilities" TEXT,
     "limitations" TEXT,
-    "preferred_hours" TEXT,
-    "available_mon" BOOLEAN NOT NULL DEFAULT true,
-    "available_tue" BOOLEAN NOT NULL DEFAULT true,
-    "available_wed" BOOLEAN NOT NULL DEFAULT true,
-    "available_thu" BOOLEAN NOT NULL DEFAULT true,
-    "available_fri" BOOLEAN NOT NULL DEFAULT true,
-    "available_sat" BOOLEAN NOT NULL DEFAULT false,
-    "available_sun" BOOLEAN NOT NULL DEFAULT false,
-    "npi_number" TEXT,
-    "taxonomy_code" TEXT DEFAULT '374700000X',
-    "evv_worker_id" TEXT,
-    "medicaid_provider_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "preferredHours" TEXT,
+    "availableMon" BOOLEAN NOT NULL DEFAULT true,
+    "availableTue" BOOLEAN NOT NULL DEFAULT true,
+    "availableWed" BOOLEAN NOT NULL DEFAULT true,
+    "availableThu" BOOLEAN NOT NULL DEFAULT true,
+    "availableFri" BOOLEAN NOT NULL DEFAULT true,
+    "availableSat" BOOLEAN NOT NULL DEFAULT false,
+    "availableSun" BOOLEAN NOT NULL DEFAULT false,
+    "npiNumber" TEXT,
+    "taxonomyCode" TEXT DEFAULT '374700000X',
+    "evvWorkerId" TEXT,
+    "medicaidProviderId" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "caregiver_profiles_pkey" PRIMARY KEY ("id")
 );
@@ -92,13 +91,13 @@ CREATE TABLE "caregiver_profiles" (
 -- CreateTable
 CREATE TABLE "caregiver_availability" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL UNIQUE,
+    "caregiverId" TEXT NOT NULL UNIQUE,
     "status" TEXT NOT NULL DEFAULT 'available',
-    "max_hours_per_week" INTEGER NOT NULL DEFAULT 40,
-    "weekly_availability" JSONB,
+    "maxHoursPerWeek" INTEGER NOT NULL DEFAULT 40,
+    "weeklyAvailability" JSONB,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "caregiver_availability_pkey" PRIMARY KEY ("id")
 );
@@ -106,17 +105,17 @@ CREATE TABLE "caregiver_availability" (
 -- CreateTable
 CREATE TABLE "caregiver_schedules" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "day_of_week" INTEGER,
+    "caregiverId" TEXT NOT NULL,
+    "dayOfWeek" INTEGER,
     "date" DATE,
-    "start_time" TIME,
-    "end_time" TIME,
-    "is_available" BOOLEAN NOT NULL DEFAULT true,
-    "max_hours_per_week" INTEGER NOT NULL DEFAULT 40,
-    "overtime_approved" BOOLEAN NOT NULL DEFAULT false,
+    "startTime" TIME,
+    "endTime" TIME,
+    "isAvailable" BOOLEAN NOT NULL DEFAULT true,
+    "maxHoursPerWeek" INTEGER NOT NULL DEFAULT 40,
+    "overtimeApproved" BOOLEAN NOT NULL DEFAULT false,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "caregiver_schedules_pkey" PRIMARY KEY ("id")
 );
@@ -124,14 +123,14 @@ CREATE TABLE "caregiver_schedules" (
 -- CreateTable
 CREATE TABLE "caregiver_time_off" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "start_date" DATE NOT NULL,
-    "end_date" DATE NOT NULL,
+    "caregiverId" TEXT NOT NULL,
+    "startDate" DATE NOT NULL,
+    "endDate" DATE NOT NULL,
     "type" TEXT NOT NULL,
     "reason" TEXT,
-    "approved_by_id" TEXT,
+    "approvedById" TEXT,
     "status" TEXT NOT NULL DEFAULT 'pending',
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "caregiver_time_off_pkey" PRIMARY KEY ("id")
 );
@@ -141,7 +140,7 @@ CREATE TABLE "referral_sources" (
     "id" TEXT NOT NULL,
     "name" TEXT NOT NULL,
     "type" TEXT,
-    "contact_name" TEXT,
+    "contactName" TEXT,
     "email" TEXT,
     "phone" TEXT,
     "address" TEXT,
@@ -149,16 +148,16 @@ CREATE TABLE "referral_sources" (
     "state" TEXT,
     "zip" TEXT,
     "notes" TEXT,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "payer_type" TEXT DEFAULT 'other',
-    "payer_id_number" TEXT,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "payerType" TEXT DEFAULT 'other',
+    "payerIdNumber" TEXT,
     "npi" TEXT,
-    "expected_pay_days" INTEGER DEFAULT 30,
-    "is_active_payer" BOOLEAN NOT NULL DEFAULT false,
-    "edi_payer_id" TEXT,
-    "submission_method" TEXT DEFAULT 'manual',
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "expectedPayDays" INTEGER DEFAULT 30,
+    "isActivePayer" BOOLEAN NOT NULL DEFAULT false,
+    "ediPayerId" TEXT,
+    "submissionMethod" TEXT DEFAULT 'manual',
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "referral_sources_pkey" PRIMARY KEY ("id")
 );
@@ -166,10 +165,10 @@ CREATE TABLE "referral_sources" (
 -- CreateTable
 CREATE TABLE "clients" (
     "id" TEXT NOT NULL,
-    "first_name" TEXT NOT NULL,
-    "last_name" TEXT NOT NULL,
-    "date_of_birth" DATE,
-    "ssn_encrypted" TEXT,
+    "firstName" TEXT NOT NULL,
+    "lastName" TEXT NOT NULL,
+    "dateOfBirth" DATE,
+    "ssnEncrypted" TEXT,
     "gender" TEXT,
     "address" TEXT,
     "city" TEXT,
@@ -177,26 +176,26 @@ CREATE TABLE "clients" (
     "zip" TEXT,
     "phone" TEXT,
     "email" TEXT,
-    "referred_by_id" TEXT,
-    "referral_date" DATE,
-    "start_date" DATE,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "service_type" TEXT,
-    "insurance_provider" TEXT,
-    "insurance_id" TEXT,
-    "insurance_group" TEXT,
-    "medical_conditions" TEXT[] NOT NULL,
+    "referredById" TEXT,
+    "referralDate" DATE,
+    "startDate" DATE,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "serviceType" TEXT,
+    "insuranceProvider" TEXT,
+    "insuranceId" TEXT,
+    "insuranceGroup" TEXT,
+    "medicalConditions" TEXT[] NOT NULL,
     "allergies" TEXT[] NOT NULL,
     "medications" TEXT[] NOT NULL,
-    "preferred_caregivers" TEXT[] NOT NULL,
-    "do_not_use_caregivers" TEXT[] NOT NULL,
+    "preferredCaregivers" TEXT[] NOT NULL,
+    "doNotUseCaregivers" TEXT[] NOT NULL,
     "notes" TEXT,
-    "evv_client_id" TEXT,
-    "mco_member_id" TEXT,
-    "primary_diagnosis_code" TEXT,
-    "secondary_diagnosis_code" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "evvClientId" TEXT,
+    "mcoMemberId" TEXT,
+    "primaryDiagnosisCode" TEXT,
+    "secondaryDiagnosisCode" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "clients_pkey" PRIMARY KEY ("id")
 );
@@ -204,13 +203,13 @@ CREATE TABLE "clients" (
 -- CreateTable
 CREATE TABLE "client_emergency_contacts" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL,
+    "clientId" TEXT NOT NULL,
     "name" TEXT NOT NULL,
     "relationship" TEXT,
     "phone" TEXT NOT NULL,
     "email" TEXT,
-    "is_primary" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "isPrimary" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "client_emergency_contacts_pkey" PRIMARY KEY ("id")
 );
@@ -218,17 +217,17 @@ CREATE TABLE "client_emergency_contacts" (
 -- CreateTable
 CREATE TABLE "client_onboarding" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL UNIQUE,
-    "emergency_contacts_completed" BOOLEAN NOT NULL DEFAULT false,
-    "medical_history_completed" BOOLEAN NOT NULL DEFAULT false,
-    "insurance_info_completed" BOOLEAN NOT NULL DEFAULT false,
-    "care_preferences_completed" BOOLEAN NOT NULL DEFAULT false,
-    "family_communication_completed" BOOLEAN NOT NULL DEFAULT false,
-    "initial_assessment_completed" BOOLEAN NOT NULL DEFAULT false,
-    "all_completed" BOOLEAN NOT NULL DEFAULT false,
-    "completed_at" TIMESTAMP(3),
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "clientId" TEXT NOT NULL UNIQUE,
+    "emergencyContactsCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "medicalHistoryCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "insuranceInfoCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "carePreferencesCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "familyCommunicationCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "initialAssessmentCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "allCompleted" BOOLEAN NOT NULL DEFAULT false,
+    "completedAt" TIMESTAMP(3),
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "client_onboarding_pkey" PRIMARY KEY ("id")
 );
@@ -236,15 +235,15 @@ CREATE TABLE "client_onboarding" (
 -- CreateTable
 CREATE TABLE "client_assignments" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "assignment_date" DATE NOT NULL,
-    "hours_per_week" DECIMAL(5,2),
-    "pay_rate" DECIMAL(10,2),
+    "clientId" TEXT NOT NULL,
+    "caregiverId" TEXT NOT NULL,
+    "assignmentDate" DATE NOT NULL,
+    "hoursPerWeek" DECIMAL(5,2),
+    "payRate" DECIMAL(10,2),
     "status" TEXT NOT NULL DEFAULT 'active',
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "client_assignments_pkey" PRIMARY KEY ("id")
 );
@@ -252,20 +251,20 @@ CREATE TABLE "client_assignments" (
 -- CreateTable
 CREATE TABLE "schedules" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT,
-    "caregiver_id" TEXT,
+    "clientId" TEXT,
+    "caregiverId" TEXT,
     "title" TEXT,
-    "start_time" TIMESTAMP(3),
-    "end_time" TIMESTAMP(3),
+    "startTime" TIMESTAMP(3),
+    "endTime" TIMESTAMP(3),
     "frequency" TEXT NOT NULL DEFAULT 'weekly',
-    "effective_date" DATE,
-    "anchor_date" DATE,
-    "schedule_type" TEXT NOT NULL DEFAULT 'recurring',
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "day_of_week" INTEGER,
+    "effectiveDate" DATE,
+    "anchorDate" DATE,
+    "scheduleType" TEXT NOT NULL DEFAULT 'recurring',
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "dayOfWeek" INTEGER,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "schedules_pkey" PRIMARY KEY ("id")
 );
@@ -273,18 +272,18 @@ CREATE TABLE "schedules" (
 -- CreateTable
 CREATE TABLE "open_shifts" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT,
+    "clientId" TEXT,
     "date" DATE NOT NULL,
-    "start_time" TIME,
-    "end_time" TIME,
+    "startTime" TIME,
+    "endTime" TIME,
     "status" TEXT NOT NULL DEFAULT 'open',
     "notes" TEXT,
-    "source_absence_id" TEXT,
-    "notified_caregiver_count" INTEGER NOT NULL DEFAULT 0,
-    "auto_created" BOOLEAN NOT NULL DEFAULT false,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "sourceAbsenceId" TEXT,
+    "notifiedCaregiverCount" INTEGER NOT NULL DEFAULT 0,
+    "autoCreated" BOOLEAN NOT NULL DEFAULT false,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "open_shifts_pkey" PRIMARY KEY ("id")
 );
@@ -292,10 +291,10 @@ CREATE TABLE "open_shifts" (
 -- CreateTable
 CREATE TABLE "open_shift_notifications" (
     "id" TEXT NOT NULL,
-    "open_shift_id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "notified_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "notification_type" TEXT NOT NULL DEFAULT 'push',
+    "openShiftId" TEXT NOT NULL,
+    "caregiverId" TEXT NOT NULL,
+    "notifiedAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "notificationType" TEXT NOT NULL DEFAULT 'push',
 
     CONSTRAINT "open_shift_notifications_pkey" PRIMARY KEY ("id")
 );
@@ -303,15 +302,15 @@ CREATE TABLE "open_shift_notifications" (
 -- CreateTable
 CREATE TABLE "absences" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "client_id" TEXT,
+    "caregiverId" TEXT NOT NULL,
+    "clientId" TEXT,
     "date" DATE NOT NULL,
     "type" TEXT NOT NULL,
     "reason" TEXT,
-    "reported_by_id" TEXT,
-    "coverage_needed" BOOLEAN NOT NULL DEFAULT true,
-    "coverage_assigned_to" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "reportedById" TEXT,
+    "coverageNeeded" BOOLEAN NOT NULL DEFAULT true,
+    "coverageAssignedTo" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "absences_pkey" PRIMARY KEY ("id")
 );
@@ -319,22 +318,22 @@ CREATE TABLE "absences" (
 -- CreateTable
 CREATE TABLE "time_entries" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL,
-    "assignment_id" TEXT,
-    "schedule_id" TEXT,
-    "start_time" TIMESTAMP(3) NOT NULL,
-    "end_time" TIMESTAMP(3),
-    "duration_minutes" INTEGER,
-    "allotted_minutes" INTEGER,
-    "billable_minutes" INTEGER,
-    "discrepancy_minutes" INTEGER,
-    "clock_in_location" JSONB,
-    "clock_out_location" JSONB,
-    "is_complete" BOOLEAN NOT NULL DEFAULT false,
+    "caregiverId" TEXT NOT NULL,
+    "clientId" TEXT NOT NULL,
+    "assignmentId" TEXT,
+    "scheduleId" TEXT,
+    "startTime" TIMESTAMP(3) NOT NULL,
+    "endTime" TIMESTAMP(3),
+    "durationMinutes" INTEGER,
+    "allottedMinutes" INTEGER,
+    "billableMinutes" INTEGER,
+    "discrepancyMinutes" INTEGER,
+    "clockInLocation" JSONB,
+    "clockOutLocation" JSONB,
+    "isComplete" BOOLEAN NOT NULL DEFAULT false,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "time_entries_pkey" PRIMARY KEY ("id")
 );
@@ -342,8 +341,8 @@ CREATE TABLE "time_entries" (
 -- CreateTable
 CREATE TABLE "gps_tracking" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "time_entry_id" TEXT,
+    "caregiverId" TEXT NOT NULL,
+    "timeEntryId" TEXT,
     "latitude" DECIMAL(10,8) NOT NULL,
     "longitude" DECIMAL(11,8) NOT NULL,
     "accuracy" INTEGER,
@@ -357,14 +356,14 @@ CREATE TABLE "gps_tracking" (
 -- CreateTable
 CREATE TABLE "geofence_settings" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL UNIQUE,
-    "radius_feet" INTEGER NOT NULL DEFAULT 300,
-    "auto_clock_in" BOOLEAN NOT NULL DEFAULT true,
-    "auto_clock_out" BOOLEAN NOT NULL DEFAULT true,
-    "require_gps" BOOLEAN NOT NULL DEFAULT true,
-    "notify_admin_on_override" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "clientId" TEXT NOT NULL UNIQUE,
+    "radiusFeet" INTEGER NOT NULL DEFAULT 300,
+    "autoClockIn" BOOLEAN NOT NULL DEFAULT true,
+    "autoClockOut" BOOLEAN NOT NULL DEFAULT true,
+    "requireGps" BOOLEAN NOT NULL DEFAULT true,
+    "notifyAdminOnOverride" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "geofence_settings_pkey" PRIMARY KEY ("id")
 );
@@ -376,13 +375,13 @@ CREATE TABLE "service_codes" (
     "modifier1" TEXT,
     "modifier2" TEXT,
     "description" TEXT NOT NULL,
-    "service_category" TEXT,
-    "payer_type" TEXT NOT NULL DEFAULT 'all',
-    "unit_type" TEXT NOT NULL DEFAULT '15min',
-    "rate_per_unit" DECIMAL(8,4),
-    "requires_evv" BOOLEAN NOT NULL DEFAULT true,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "serviceCategory" TEXT,
+    "payerType" TEXT NOT NULL DEFAULT 'all',
+    "unitType" TEXT NOT NULL DEFAULT '15min',
+    "ratePerUnit" DECIMAL(8,4),
+    "requiresEvv" BOOLEAN NOT NULL DEFAULT true,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "service_codes_pkey" PRIMARY KEY ("id")
 );
@@ -390,24 +389,24 @@ CREATE TABLE "service_codes" (
 -- CreateTable
 CREATE TABLE "authorizations" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL,
-    "payer_id" TEXT,
-    "auth_number" TEXT,
-    "midas_auth_id" TEXT,
-    "procedure_code" TEXT,
+    "clientId" TEXT NOT NULL,
+    "payerId" TEXT,
+    "authNumber" TEXT,
+    "midasAuthId" TEXT,
+    "procedureCode" TEXT,
     "modifier" TEXT,
-    "authorized_units" DECIMAL(10,2) NOT NULL,
-    "unit_type" TEXT NOT NULL DEFAULT '15min',
-    "used_units" DECIMAL(10,2) NOT NULL DEFAULT 0,
-    "start_date" DATE NOT NULL,
-    "end_date" DATE NOT NULL,
+    "authorizedUnits" DECIMAL(10,2) NOT NULL,
+    "unitType" TEXT NOT NULL DEFAULT '15min',
+    "usedUnits" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "startDate" DATE NOT NULL,
+    "endDate" DATE NOT NULL,
     "status" TEXT NOT NULL DEFAULT 'active',
-    "low_units_alert_threshold" DECIMAL(10,2) NOT NULL DEFAULT 20,
+    "lowUnitsAlertThreshold" DECIMAL(10,2) NOT NULL DEFAULT 20,
     "notes" TEXT,
-    "imported_from" TEXT NOT NULL DEFAULT 'manual',
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "importedFrom" TEXT NOT NULL DEFAULT 'manual',
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "authorizations_pkey" PRIMARY KEY ("id")
 );
@@ -415,31 +414,31 @@ CREATE TABLE "authorizations" (
 -- CreateTable
 CREATE TABLE "evv_visits" (
     "id" TEXT NOT NULL,
-    "time_entry_id" TEXT NOT NULL UNIQUE,
-    "client_id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "authorization_id" TEXT,
-    "service_code" TEXT,
+    "timeEntryId" TEXT NOT NULL UNIQUE,
+    "clientId" TEXT NOT NULL,
+    "caregiverId" TEXT NOT NULL,
+    "authorizationId" TEXT,
+    "serviceCode" TEXT,
     "modifier" TEXT,
-    "service_date" DATE NOT NULL,
-    "actual_start" TIMESTAMP(3) NOT NULL,
-    "actual_end" TIMESTAMP(3),
-    "units_of_service" DECIMAL(8,2),
-    "gps_in_lat" DECIMAL(10,7),
-    "gps_in_lng" DECIMAL(10,7),
-    "gps_out_lat" DECIMAL(10,7),
-    "gps_out_lng" DECIMAL(10,7),
-    "sandata_status" TEXT NOT NULL DEFAULT 'pending',
-    "sandata_visit_id" TEXT,
-    "sandata_submitted_at" TIMESTAMP(3),
-    "sandata_response" JSONB,
-    "sandata_exception_code" TEXT,
-    "sandata_exception_desc" TEXT,
-    "evv_method" TEXT NOT NULL DEFAULT 'gps',
-    "is_verified" BOOLEAN NOT NULL DEFAULT false,
-    "verification_issues" JSONB NOT NULL DEFAULT '[]',
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "serviceDate" DATE NOT NULL,
+    "actualStart" TIMESTAMP(3) NOT NULL,
+    "actualEnd" TIMESTAMP(3),
+    "unitsOfService" DECIMAL(8,2),
+    "gpsInLat" DECIMAL(10,7),
+    "gpsInLng" DECIMAL(10,7),
+    "gpsOutLat" DECIMAL(10,7),
+    "gpsOutLng" DECIMAL(10,7),
+    "sandataStatus" TEXT NOT NULL DEFAULT 'pending',
+    "sandataVisitId" TEXT,
+    "sandataSubmittedAt" TIMESTAMP(3),
+    "sandataResponse" JSONB,
+    "sandataExceptionCode" TEXT,
+    "sandataExceptionDesc" TEXT,
+    "evvMethod" TEXT NOT NULL DEFAULT 'gps',
+    "isVerified" BOOLEAN NOT NULL DEFAULT false,
+    "verificationIssues" JSONB NOT NULL DEFAULT '[]',
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "evv_visits_pkey" PRIMARY KEY ("id")
 );
@@ -447,15 +446,15 @@ CREATE TABLE "evv_visits" (
 -- CreateTable
 CREATE TABLE "validation_log" (
     "id" TEXT NOT NULL,
-    "entity_type" TEXT NOT NULL,
-    "entity_id" TEXT NOT NULL,
-    "validation_type" TEXT NOT NULL,
+    "entityType" TEXT NOT NULL,
+    "entityId" TEXT NOT NULL,
+    "validationType" TEXT NOT NULL,
     "status" TEXT NOT NULL,
     "message" TEXT,
     "details" JSONB,
-    "resolved_at" TIMESTAMP(3),
-    "resolved_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "resolvedAt" TIMESTAMP(3),
+    "resolvedById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "validation_log_pkey" PRIMARY KEY ("id")
 );
@@ -463,21 +462,21 @@ CREATE TABLE "validation_log" (
 -- CreateTable
 CREATE TABLE "invoices" (
     "id" TEXT NOT NULL,
-    "invoice_number" TEXT NOT NULL UNIQUE,
-    "client_id" TEXT NOT NULL,
-    "billing_period_start" DATE NOT NULL,
-    "billing_period_end" DATE NOT NULL,
+    "invoiceNumber" TEXT NOT NULL UNIQUE,
+    "clientId" TEXT NOT NULL,
+    "billingPeriodStart" DATE NOT NULL,
+    "billingPeriodEnd" DATE NOT NULL,
     "subtotal" DECIMAL(12,2) NOT NULL,
     "tax" DECIMAL(12,2) NOT NULL DEFAULT 0,
     "total" DECIMAL(12,2) NOT NULL,
-    "payment_status" TEXT NOT NULL DEFAULT 'pending',
-    "payment_due_date" DATE,
-    "payment_date" DATE,
-    "payment_method" TEXT,
-    "stripe_payment_intent_id" TEXT,
+    "paymentStatus" TEXT NOT NULL DEFAULT 'pending',
+    "paymentDueDate" DATE,
+    "paymentDate" DATE,
+    "paymentMethod" TEXT,
+    "stripePaymentIntentId" TEXT,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "invoices_pkey" PRIMARY KEY ("id")
 );
@@ -485,14 +484,14 @@ CREATE TABLE "invoices" (
 -- CreateTable
 CREATE TABLE "invoice_line_items" (
     "id" TEXT NOT NULL,
-    "invoice_id" TEXT NOT NULL,
-    "time_entry_id" TEXT,
-    "caregiver_id" TEXT NOT NULL,
+    "invoiceId" TEXT NOT NULL,
+    "timeEntryId" TEXT,
+    "caregiverId" TEXT NOT NULL,
     "description" TEXT NOT NULL,
     "hours" DECIMAL(6,2) NOT NULL,
     "rate" DECIMAL(10,2) NOT NULL,
     "amount" DECIMAL(12,2) NOT NULL,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "invoice_line_items_pkey" PRIMARY KEY ("id")
 );
@@ -500,18 +499,18 @@ CREATE TABLE "invoice_line_items" (
 -- CreateTable
 CREATE TABLE "edi_batches" (
     "id" TEXT NOT NULL,
-    "payer_id" TEXT,
-    "batch_number" TEXT NOT NULL UNIQUE,
+    "payerId" TEXT,
+    "batchNumber" TEXT NOT NULL UNIQUE,
     "status" TEXT NOT NULL DEFAULT 'draft',
-    "claim_count" INTEGER NOT NULL DEFAULT 0,
-    "total_billed" DECIMAL(10,2) NOT NULL DEFAULT 0,
-    "edi_content" TEXT,
-    "submitted_at" TIMESTAMP(3),
-    "response_code" TEXT,
-    "response_message" TEXT,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "claimCount" INTEGER NOT NULL DEFAULT 0,
+    "totalBilled" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "ediContent" TEXT,
+    "submittedAt" TIMESTAMP(3),
+    "responseCode" TEXT,
+    "responseMessage" TEXT,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "edi_batches_pkey" PRIMARY KEY ("id")
 );
@@ -519,25 +518,25 @@ CREATE TABLE "edi_batches" (
 -- CreateTable
 CREATE TABLE "claims" (
     "id" TEXT NOT NULL,
-    "client_id" TEXT,
-    "caregiver_id" TEXT,
-    "edi_batch_id" TEXT,
-    "evv_visit_id" TEXT,
-    "authorization_id" TEXT,
-    "claim_number" TEXT,
-    "service_date" DATE,
-    "service_code" TEXT,
-    "billed_amount" DECIMAL(10,2),
-    "allowed_amount" DECIMAL(10,2),
-    "paid_amount" DECIMAL(10,2),
-    "denial_code" TEXT,
-    "denial_reason" TEXT,
+    "clientId" TEXT,
+    "caregiverId" TEXT,
+    "ediBatchId" TEXT,
+    "evvVisitId" TEXT,
+    "authorizationId" TEXT,
+    "claimNumber" TEXT,
+    "serviceDate" DATE,
+    "serviceCode" TEXT,
+    "billedAmount" DECIMAL(10,2),
+    "allowedAmount" DECIMAL(10,2),
+    "paidAmount" DECIMAL(10,2),
+    "denialCode" TEXT,
+    "denialReason" TEXT,
     "status" TEXT NOT NULL DEFAULT 'pending',
-    "submission_date" DATE,
-    "paid_date" DATE,
+    "submissionDate" DATE,
+    "paidDate" DATE,
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "claims_pkey" PRIMARY KEY ("id")
 );
@@ -545,19 +544,19 @@ CREATE TABLE "claims" (
 -- CreateTable
 CREATE TABLE "remittance_batches" (
     "id" TEXT NOT NULL,
-    "payer_id" TEXT,
-    "payer_name" TEXT NOT NULL,
-    "payer_type" TEXT NOT NULL DEFAULT 'other',
-    "check_number" TEXT,
-    "check_date" DATE,
-    "payment_date" DATE,
-    "total_amount" DECIMAL(10,2) NOT NULL,
-    "raw_ocr_text" TEXT,
+    "payerId" TEXT,
+    "payerName" TEXT NOT NULL,
+    "payerType" TEXT NOT NULL DEFAULT 'other',
+    "checkNumber" TEXT,
+    "checkDate" DATE,
+    "paymentDate" DATE,
+    "totalAmount" DECIMAL(10,2) NOT NULL,
+    "rawOcrText" TEXT,
     "status" TEXT NOT NULL DEFAULT 'pending_match',
     "notes" TEXT,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "remittance_batches_pkey" PRIMARY KEY ("id")
 );
@@ -565,22 +564,22 @@ CREATE TABLE "remittance_batches" (
 -- CreateTable
 CREATE TABLE "remittance_line_items" (
     "id" TEXT NOT NULL,
-    "batch_id" TEXT NOT NULL,
-    "client_id" TEXT,
-    "invoice_id" TEXT,
-    "claim_id" TEXT,
-    "claim_number" TEXT,
-    "service_date_from" DATE,
-    "service_date_to" DATE,
-    "billed_amount" DECIMAL(10,2),
-    "allowed_amount" DECIMAL(10,2),
-    "paid_amount" DECIMAL(10,2) NOT NULL,
-    "adjustment_amount" DECIMAL(10,2) NOT NULL DEFAULT 0,
-    "denial_code" TEXT,
-    "denial_reason" TEXT,
-    "match_status" TEXT NOT NULL DEFAULT 'unmatched',
-    "matched_at" TIMESTAMP(3),
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "batchId" TEXT NOT NULL,
+    "clientId" TEXT,
+    "invoiceId" TEXT,
+    "claimId" TEXT,
+    "claimNumber" TEXT,
+    "serviceDateFrom" DATE,
+    "serviceDateTo" DATE,
+    "billedAmount" DECIMAL(10,2),
+    "allowedAmount" DECIMAL(10,2),
+    "paidAmount" DECIMAL(10,2) NOT NULL,
+    "adjustmentAmount" DECIMAL(10,2) NOT NULL DEFAULT 0,
+    "denialCode" TEXT,
+    "denialReason" TEXT,
+    "matchStatus" TEXT NOT NULL DEFAULT 'unmatched',
+    "matchedAt" TIMESTAMP(3),
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "remittance_line_items_pkey" PRIMARY KEY ("id")
 );
@@ -588,15 +587,15 @@ CREATE TABLE "remittance_line_items" (
 -- CreateTable
 CREATE TABLE "gusto_sync_log" (
     "id" TEXT NOT NULL,
-    "sync_type" TEXT NOT NULL,
+    "syncType" TEXT NOT NULL,
     "status" TEXT NOT NULL,
-    "pay_period_start" DATE,
-    "pay_period_end" DATE,
-    "records_exported" INTEGER NOT NULL DEFAULT 0,
-    "gusto_response" JSONB,
-    "error_message" TEXT,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "payPeriodStart" DATE,
+    "payPeriodEnd" DATE,
+    "recordsExported" INTEGER NOT NULL DEFAULT 0,
+    "gustoResponse" JSONB,
+    "errorMessage" TEXT,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "gusto_sync_log_pkey" PRIMARY KEY ("id")
 );
@@ -604,11 +603,11 @@ CREATE TABLE "gusto_sync_log" (
 -- CreateTable
 CREATE TABLE "gusto_employee_map" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL UNIQUE,
-    "gusto_employee_id" TEXT,
-    "gusto_uuid" TEXT,
-    "is_synced" BOOLEAN NOT NULL DEFAULT false,
-    "last_synced_at" TIMESTAMP(3),
+    "userId" TEXT NOT NULL UNIQUE,
+    "gustoEmployeeId" TEXT,
+    "gustoUuid" TEXT,
+    "isSynced" BOOLEAN NOT NULL DEFAULT false,
+    "lastSyncedAt" TIMESTAMP(3),
 
     CONSTRAINT "gusto_employee_map_pkey" PRIMARY KEY ("id")
 );
@@ -616,16 +615,16 @@ CREATE TABLE "gusto_employee_map" (
 -- CreateTable
 CREATE TABLE "expenses" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL,
+    "userId" TEXT NOT NULL,
     "category" TEXT,
     "description" TEXT NOT NULL,
     "amount" DECIMAL(10,2) NOT NULL,
     "date" DATE NOT NULL,
-    "receipt_url" TEXT,
+    "receiptUrl" TEXT,
     "status" TEXT NOT NULL DEFAULT 'pending',
     "notes" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "expenses_pkey" PRIMARY KEY ("id")
 );
@@ -633,18 +632,18 @@ CREATE TABLE "expenses" (
 -- CreateTable
 CREATE TABLE "performance_ratings" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "client_id" TEXT NOT NULL,
-    "rating_date" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "satisfaction_score" INTEGER,
-    "punctuality_score" INTEGER,
-    "professionalism_score" INTEGER,
-    "care_quality_score" INTEGER,
+    "caregiverId" TEXT NOT NULL,
+    "clientId" TEXT NOT NULL,
+    "ratingDate" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "satisfactionScore" INTEGER,
+    "punctualityScore" INTEGER,
+    "professionalismScore" INTEGER,
+    "careQualityScore" INTEGER,
     "comments" TEXT,
-    "no_shows" INTEGER NOT NULL DEFAULT 0,
-    "late_arrivals" INTEGER NOT NULL DEFAULT 0,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "noShows" INTEGER NOT NULL DEFAULT 0,
+    "lateArrivals" INTEGER NOT NULL DEFAULT 0,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "performance_ratings_pkey" PRIMARY KEY ("id")
 );
@@ -652,22 +651,22 @@ CREATE TABLE "performance_ratings" (
 -- CreateTable
 CREATE TABLE "background_checks" (
     "id" TEXT NOT NULL,
-    "caregiver_id" TEXT NOT NULL,
-    "check_type" TEXT NOT NULL DEFAULT 'criminal',
+    "caregiverId" TEXT NOT NULL,
+    "checkType" TEXT NOT NULL DEFAULT 'criminal',
     "provider" TEXT,
     "cost" DECIMAL(8,2),
     "status" TEXT NOT NULL DEFAULT 'pending',
-    "initiated_date" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "expiration_date" DATE,
-    "worcs_reference_number" TEXT,
-    "worcs_status" TEXT,
-    "ssn_encrypted" TEXT,
-    "drivers_license_encrypted" TEXT,
-    "drivers_license_state" TEXT,
+    "initiatedDate" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "expirationDate" DATE,
+    "worcsReferenceNumber" TEXT,
+    "worcsStatus" TEXT,
+    "ssnEncrypted" TEXT,
+    "driversLicenseEncrypted" TEXT,
+    "driversLicenseState" TEXT,
     "notes" TEXT,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "background_checks_pkey" PRIMARY KEY ("id")
 );
@@ -675,14 +674,14 @@ CREATE TABLE "background_checks" (
 -- CreateTable
 CREATE TABLE "notifications" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL,
+    "userId" TEXT NOT NULL,
     "type" TEXT,
     "title" TEXT NOT NULL,
     "message" TEXT,
-    "is_read" BOOLEAN NOT NULL DEFAULT false,
-    "email_sent" BOOLEAN NOT NULL DEFAULT false,
-    "push_sent" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "isRead" BOOLEAN NOT NULL DEFAULT false,
+    "emailSent" BOOLEAN NOT NULL DEFAULT false,
+    "pushSent" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "notifications_pkey" PRIMARY KEY ("id")
 );
@@ -690,16 +689,16 @@ CREATE TABLE "notifications" (
 -- CreateTable
 CREATE TABLE "notification_preferences" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL UNIQUE,
-    "email_enabled" BOOLEAN NOT NULL DEFAULT true,
-    "push_enabled" BOOLEAN NOT NULL DEFAULT true,
-    "schedule_alerts" BOOLEAN NOT NULL DEFAULT true,
-    "absence_alerts" BOOLEAN NOT NULL DEFAULT true,
-    "billing_alerts" BOOLEAN NOT NULL DEFAULT true,
-    "rating_alerts" BOOLEAN NOT NULL DEFAULT true,
-    "daily_digest" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "userId" TEXT NOT NULL UNIQUE,
+    "emailEnabled" BOOLEAN NOT NULL DEFAULT true,
+    "pushEnabled" BOOLEAN NOT NULL DEFAULT true,
+    "scheduleAlerts" BOOLEAN NOT NULL DEFAULT true,
+    "absenceAlerts" BOOLEAN NOT NULL DEFAULT true,
+    "billingAlerts" BOOLEAN NOT NULL DEFAULT true,
+    "ratingAlerts" BOOLEAN NOT NULL DEFAULT true,
+    "dailyDigest" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "notification_preferences_pkey" PRIMARY KEY ("id")
 );
@@ -707,11 +706,11 @@ CREATE TABLE "notification_preferences" (
 -- CreateTable
 CREATE TABLE "push_subscriptions" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL,
+    "userId" TEXT NOT NULL,
     "subscription" JSONB NOT NULL,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "push_subscriptions_pkey" PRIMARY KEY ("id")
 );
@@ -720,11 +719,11 @@ CREATE TABLE "push_subscriptions" (
 CREATE TABLE "message_threads" (
     "id" TEXT NOT NULL,
     "subject" TEXT NOT NULL,
-    "created_by_id" TEXT NOT NULL,
-    "thread_type" TEXT NOT NULL DEFAULT 'direct',
-    "is_broadcast" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdById" TEXT NOT NULL,
+    "threadType" TEXT NOT NULL DEFAULT 'direct',
+    "isBroadcast" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "message_threads_pkey" PRIMARY KEY ("id")
 );
@@ -732,10 +731,10 @@ CREATE TABLE "message_threads" (
 -- CreateTable
 CREATE TABLE "message_thread_participants" (
     "id" TEXT NOT NULL,
-    "thread_id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL,
-    "last_read_at" TIMESTAMP(3),
-    "joined_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "threadId" TEXT NOT NULL,
+    "userId" TEXT NOT NULL,
+    "lastReadAt" TIMESTAMP(3),
+    "joinedAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "message_thread_participants_pkey" PRIMARY KEY ("id")
 );
@@ -743,12 +742,12 @@ CREATE TABLE "message_thread_participants" (
 -- CreateTable
 CREATE TABLE "messages" (
     "id" TEXT NOT NULL,
-    "thread_id" TEXT NOT NULL,
-    "sender_id" TEXT NOT NULL,
+    "threadId" TEXT NOT NULL,
+    "senderId" TEXT NOT NULL,
     "body" TEXT NOT NULL,
-    "is_deleted" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "isDeleted" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "messages_pkey" PRIMARY KEY ("id")
 );
@@ -756,20 +755,20 @@ CREATE TABLE "messages" (
 -- CreateTable
 CREATE TABLE "communication_log" (
     "id" TEXT NOT NULL,
-    "entity_type" TEXT NOT NULL,
-    "entity_id" TEXT NOT NULL,
-    "log_type" TEXT NOT NULL DEFAULT 'note',
+    "entityType" TEXT NOT NULL,
+    "entityId" TEXT NOT NULL,
+    "logType" TEXT NOT NULL DEFAULT 'note',
     "direction" TEXT,
     "subject" TEXT,
     "body" TEXT NOT NULL,
-    "logged_by_id" TEXT,
-    "logged_by_name" TEXT,
-    "client_id" TEXT,
-    "follow_up_date" DATE,
-    "follow_up_done" BOOLEAN NOT NULL DEFAULT false,
-    "is_pinned" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "loggedById" TEXT,
+    "loggedByName" TEXT,
+    "clientId" TEXT,
+    "followUpDate" DATE,
+    "followUpDone" BOOLEAN NOT NULL DEFAULT false,
+    "isPinned" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "communication_log_pkey" PRIMARY KEY ("id")
 );
@@ -777,15 +776,15 @@ CREATE TABLE "communication_log" (
 -- CreateTable
 CREATE TABLE "noshow_alert_config" (
     "id" TEXT NOT NULL,
-    "grace_minutes" INTEGER NOT NULL DEFAULT 15,
-    "notify_admin" BOOLEAN NOT NULL DEFAULT true,
-    "notify_caregiver" BOOLEAN NOT NULL DEFAULT true,
-    "notify_client_family" BOOLEAN NOT NULL DEFAULT false,
-    "admin_phone" TEXT,
-    "admin_email" TEXT,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "graceMinutes" INTEGER NOT NULL DEFAULT 15,
+    "notifyAdmin" BOOLEAN NOT NULL DEFAULT true,
+    "notifyCaregiver" BOOLEAN NOT NULL DEFAULT true,
+    "notifyClientFamily" BOOLEAN NOT NULL DEFAULT false,
+    "adminPhone" TEXT,
+    "adminEmail" TEXT,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "noshow_alert_config_pkey" PRIMARY KEY ("id")
 );
@@ -793,18 +792,18 @@ CREATE TABLE "noshow_alert_config" (
 -- CreateTable
 CREATE TABLE "noshow_alerts" (
     "id" TEXT NOT NULL,
-    "schedule_id" TEXT,
-    "caregiver_id" TEXT,
-    "client_id" TEXT,
-    "shift_date" DATE NOT NULL,
-    "expected_start" TIME NOT NULL,
-    "alerted_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "resolved_at" TIMESTAMP(3),
-    "resolved_by_id" TEXT,
-    "resolution_note" TEXT,
+    "scheduleId" TEXT,
+    "caregiverId" TEXT,
+    "clientId" TEXT,
+    "shiftDate" DATE NOT NULL,
+    "expectedStart" TIME NOT NULL,
+    "alertedAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "resolvedAt" TIMESTAMP(3),
+    "resolvedById" TEXT,
+    "resolutionNote" TEXT,
     "status" TEXT NOT NULL DEFAULT 'open',
-    "sms_sent" BOOLEAN NOT NULL DEFAULT false,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "smsSent" BOOLEAN NOT NULL DEFAULT false,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "noshow_alerts_pkey" PRIMARY KEY ("id")
 );
@@ -816,12 +815,12 @@ CREATE TABLE "form_templates" (
     "description" TEXT,
     "category" TEXT NOT NULL DEFAULT 'general',
     "fields" JSONB NOT NULL DEFAULT '[]',
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "requires_signature" BOOLEAN NOT NULL DEFAULT false,
-    "auto_attach_to" TEXT,
-    "created_by_id" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "requiresSignature" BOOLEAN NOT NULL DEFAULT false,
+    "autoAttachTo" TEXT,
+    "createdById" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "form_templates_pkey" PRIMARY KEY ("id")
 );
@@ -829,19 +828,19 @@ CREATE TABLE "form_templates" (
 -- CreateTable
 CREATE TABLE "form_submissions" (
     "id" TEXT NOT NULL,
-    "template_id" TEXT,
-    "template_name" TEXT,
-    "entity_type" TEXT,
-    "entity_id" TEXT,
-    "client_id" TEXT,
-    "submitted_by_id" TEXT,
-    "submitted_by_name" TEXT,
+    "templateId" TEXT,
+    "templateName" TEXT,
+    "entityType" TEXT,
+    "entityId" TEXT,
+    "clientId" TEXT,
+    "submittedById" TEXT,
+    "submittedByName" TEXT,
     "data" JSONB NOT NULL DEFAULT '{}',
     "signature" TEXT,
-    "signed_at" TIMESTAMP(3),
+    "signedAt" TIMESTAMP(3),
     "status" TEXT NOT NULL DEFAULT 'draft',
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "form_submissions_pkey" PRIMARY KEY ("id")
 );
@@ -850,12 +849,12 @@ CREATE TABLE "form_submissions" (
 CREATE TABLE "login_activity" (
     "id" TEXT NOT NULL,
     "email" TEXT NOT NULL,
-    "user_id" TEXT,
+    "userId" TEXT,
     "success" BOOLEAN NOT NULL DEFAULT false,
-    "ip_address" TEXT,
-    "user_agent" TEXT,
-    "fail_reason" TEXT,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "ipAddress" TEXT,
+    "userAgent" TEXT,
+    "failReason" TEXT,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "login_activity_pkey" PRIMARY KEY ("id")
 );
@@ -863,13 +862,13 @@ CREATE TABLE "login_activity" (
 -- CreateTable
 CREATE TABLE "audit_logs" (
     "id" TEXT NOT NULL,
-    "user_id" TEXT NOT NULL,
+    "userId" TEXT NOT NULL,
     "action" TEXT NOT NULL,
-    "table_name" TEXT,
-    "record_id" TEXT,
-    "old_data" JSONB,
-    "new_data" JSONB,
-    "ip_address" TEXT,
+    "tableName" TEXT,
+    "recordId" TEXT,
+    "oldData" JSONB,
+    "newData" JSONB,
+    "ipAddress" TEXT,
     "timestamp" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "audit_logs_pkey" PRIMARY KEY ("id")
@@ -885,10 +884,10 @@ CREATE TABLE "service_locations" (
     "zip" TEXT,
     "latitude" DECIMAL(10,8),
     "longitude" DECIMAL(11,8),
-    "service_radius_miles" INTEGER NOT NULL DEFAULT 5,
-    "is_active" BOOLEAN NOT NULL DEFAULT true,
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
-    "updated_at" TIMESTAMP(3) NOT NULL,
+    "serviceRadiusMiles" INTEGER NOT NULL DEFAULT 5,
+    "isActive" BOOLEAN NOT NULL DEFAULT true,
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "updatedAt" TIMESTAMP(3) NOT NULL,
 
     CONSTRAINT "service_locations_pkey" PRIMARY KEY ("id")
 );
@@ -896,117 +895,117 @@ CREATE TABLE "service_locations" (
 -- CreateTable
 CREATE TABLE "dashboard_cache" (
     "id" TEXT NOT NULL,
-    "cache_key" TEXT NOT NULL UNIQUE,
+    "cacheKey" TEXT NOT NULL UNIQUE,
     "data" JSONB,
-    "expires_at" TIMESTAMP(3),
-    "created_at" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
+    "expiresAt" TIMESTAMP(3),
+    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
 
     CONSTRAINT "dashboard_cache_pkey" PRIMARY KEY ("id")
 );
 
-CREATE INDEX "caregiver_schedules_caregiver_id_idx" ON "caregiver_schedules"("caregiver_id");
+CREATE INDEX "caregiver_schedules_caregiverId_idx" ON "caregiver_schedules"("caregiverId");
 CREATE INDEX "caregiver_schedules_date_idx" ON "caregiver_schedules"("date");
 
-CREATE INDEX "caregiver_time_off_caregiver_id_idx" ON "caregiver_time_off"("caregiver_id");
-CREATE INDEX "caregiver_time_off_start_date_end_date_idx" ON "caregiver_time_off"("start_date", "end_date");
+CREATE INDEX "caregiver_time_off_caregiverId_idx" ON "caregiver_time_off"("caregiverId");
+CREATE INDEX "caregiver_time_off_startDate_endDate_idx" ON "caregiver_time_off"("startDate", "endDate");
 
 CREATE INDEX "referral_sources_type_idx" ON "referral_sources"("type");
-CREATE INDEX "referral_sources_is_active_idx" ON "referral_sources"("is_active");
+CREATE INDEX "referral_sources_isActive_idx" ON "referral_sources"("isActive");
 
-CREATE INDEX "clients_is_active_idx" ON "clients"("is_active");
-CREATE INDEX "clients_referred_by_id_idx" ON "clients"("referred_by_id");
+CREATE INDEX "clients_isActive_idx" ON "clients"("isActive");
+CREATE INDEX "clients_referredById_idx" ON "clients"("referredById");
 
-CREATE INDEX "client_emergency_contacts_client_id_idx" ON "client_emergency_contacts"("client_id");
+CREATE INDEX "client_emergency_contacts_clientId_idx" ON "client_emergency_contacts"("clientId");
 
-CREATE INDEX "client_assignments_client_id_idx" ON "client_assignments"("client_id");
-CREATE INDEX "client_assignments_caregiver_id_idx" ON "client_assignments"("caregiver_id");
+CREATE INDEX "client_assignments_clientId_idx" ON "client_assignments"("clientId");
+CREATE INDEX "client_assignments_caregiverId_idx" ON "client_assignments"("caregiverId");
 CREATE INDEX "client_assignments_status_idx" ON "client_assignments"("status");
 
-CREATE INDEX "schedules_client_id_idx" ON "schedules"("client_id");
-CREATE INDEX "schedules_caregiver_id_idx" ON "schedules"("caregiver_id");
+CREATE INDEX "schedules_clientId_idx" ON "schedules"("clientId");
+CREATE INDEX "schedules_caregiverId_idx" ON "schedules"("caregiverId");
 
 CREATE INDEX "open_shifts_date_idx" ON "open_shifts"("date");
 CREATE INDEX "open_shifts_status_idx" ON "open_shifts"("status");
 
-CREATE UNIQUE INDEX "open_shift_notifications_open_shift_id_caregiver_id_key" ON "open_shift_notifications"("open_shift_id", "caregiver_id");
-CREATE INDEX "open_shift_notifications_open_shift_id_idx" ON "open_shift_notifications"("open_shift_id");
+CREATE UNIQUE INDEX "open_shift_notifications_openShiftId_caregiverId_key" ON "open_shift_notifications"("openShiftId", "caregiverId");
+CREATE INDEX "open_shift_notifications_openShiftId_idx" ON "open_shift_notifications"("openShiftId");
 
-CREATE INDEX "absences_caregiver_id_idx" ON "absences"("caregiver_id");
+CREATE INDEX "absences_caregiverId_idx" ON "absences"("caregiverId");
 CREATE INDEX "absences_date_idx" ON "absences"("date");
 
-CREATE INDEX "time_entries_caregiver_id_idx" ON "time_entries"("caregiver_id");
-CREATE INDEX "time_entries_client_id_idx" ON "time_entries"("client_id");
-CREATE INDEX "time_entries_start_time_idx" ON "time_entries"("start_time");
-CREATE INDEX "time_entries_schedule_id_idx" ON "time_entries"("schedule_id");
+CREATE INDEX "time_entries_caregiverId_idx" ON "time_entries"("caregiverId");
+CREATE INDEX "time_entries_clientId_idx" ON "time_entries"("clientId");
+CREATE INDEX "time_entries_startTime_idx" ON "time_entries"("startTime");
+CREATE INDEX "time_entries_scheduleId_idx" ON "time_entries"("scheduleId");
 
-CREATE INDEX "gps_tracking_caregiver_id_idx" ON "gps_tracking"("caregiver_id");
-CREATE INDEX "gps_tracking_time_entry_id_idx" ON "gps_tracking"("time_entry_id");
+CREATE INDEX "gps_tracking_caregiverId_idx" ON "gps_tracking"("caregiverId");
+CREATE INDEX "gps_tracking_timeEntryId_idx" ON "gps_tracking"("timeEntryId");
 CREATE INDEX "gps_tracking_timestamp_idx" ON "gps_tracking"("timestamp");
 
 CREATE INDEX "service_codes_code_idx" ON "service_codes"("code");
-CREATE INDEX "service_codes_is_active_idx" ON "service_codes"("is_active");
+CREATE INDEX "service_codes_isActive_idx" ON "service_codes"("isActive");
 
-CREATE INDEX "authorizations_client_id_idx" ON "authorizations"("client_id");
-CREATE INDEX "authorizations_start_date_end_date_idx" ON "authorizations"("start_date", "end_date");
+CREATE INDEX "authorizations_clientId_idx" ON "authorizations"("clientId");
+CREATE INDEX "authorizations_startDate_endDate_idx" ON "authorizations"("startDate", "endDate");
 CREATE INDEX "authorizations_status_idx" ON "authorizations"("status");
 
-CREATE INDEX "evv_visits_client_id_service_date_idx" ON "evv_visits"("client_id", "service_date");
-CREATE INDEX "evv_visits_caregiver_id_idx" ON "evv_visits"("caregiver_id");
-CREATE INDEX "evv_visits_sandata_status_idx" ON "evv_visits"("sandata_status");
+CREATE INDEX "evv_visits_clientId_serviceDate_idx" ON "evv_visits"("clientId", "serviceDate");
+CREATE INDEX "evv_visits_caregiverId_idx" ON "evv_visits"("caregiverId");
+CREATE INDEX "evv_visits_sandataStatus_idx" ON "evv_visits"("sandataStatus");
 
-CREATE INDEX "validation_log_entity_id_entity_type_idx" ON "validation_log"("entity_id", "entity_type");
+CREATE INDEX "validation_log_entityId_entityType_idx" ON "validation_log"("entityId", "entityType");
 
-CREATE INDEX "invoices_client_id_idx" ON "invoices"("client_id");
-CREATE INDEX "invoices_payment_status_idx" ON "invoices"("payment_status");
+CREATE INDEX "invoices_clientId_idx" ON "invoices"("clientId");
+CREATE INDEX "invoices_paymentStatus_idx" ON "invoices"("paymentStatus");
 
-CREATE INDEX "invoice_line_items_invoice_id_idx" ON "invoice_line_items"("invoice_id");
+CREATE INDEX "invoice_line_items_invoiceId_idx" ON "invoice_line_items"("invoiceId");
 
 CREATE INDEX "edi_batches_status_idx" ON "edi_batches"("status");
 
-CREATE INDEX "claims_edi_batch_id_idx" ON "claims"("edi_batch_id");
-CREATE INDEX "claims_evv_visit_id_idx" ON "claims"("evv_visit_id");
+CREATE INDEX "claims_ediBatchId_idx" ON "claims"("ediBatchId");
+CREATE INDEX "claims_evvVisitId_idx" ON "claims"("evvVisitId");
 CREATE INDEX "claims_status_idx" ON "claims"("status");
 
-CREATE INDEX "remittance_batches_payer_id_idx" ON "remittance_batches"("payer_id");
+CREATE INDEX "remittance_batches_payerId_idx" ON "remittance_batches"("payerId");
 
-CREATE INDEX "remittance_line_items_batch_id_idx" ON "remittance_line_items"("batch_id");
+CREATE INDEX "remittance_line_items_batchId_idx" ON "remittance_line_items"("batchId");
 
-CREATE INDEX "expenses_user_id_idx" ON "expenses"("user_id");
+CREATE INDEX "expenses_userId_idx" ON "expenses"("userId");
 
-CREATE INDEX "performance_ratings_caregiver_id_idx" ON "performance_ratings"("caregiver_id");
-CREATE INDEX "performance_ratings_client_id_idx" ON "performance_ratings"("client_id");
+CREATE INDEX "performance_ratings_caregiverId_idx" ON "performance_ratings"("caregiverId");
+CREATE INDEX "performance_ratings_clientId_idx" ON "performance_ratings"("clientId");
 
-CREATE INDEX "background_checks_caregiver_id_idx" ON "background_checks"("caregiver_id");
+CREATE INDEX "background_checks_caregiverId_idx" ON "background_checks"("caregiverId");
 
-CREATE INDEX "notifications_user_id_idx" ON "notifications"("user_id");
-CREATE INDEX "notifications_is_read_idx" ON "notifications"("is_read");
+CREATE INDEX "notifications_userId_idx" ON "notifications"("userId");
+CREATE INDEX "notifications_isRead_idx" ON "notifications"("isRead");
 
-CREATE UNIQUE INDEX "push_subscriptions_user_id_subscription_key" ON "push_subscriptions"("user_id", "subscription");
-CREATE INDEX "push_subscriptions_is_active_idx" ON "push_subscriptions"("is_active");
+CREATE UNIQUE INDEX "push_subscriptions_userId_subscription_key" ON "push_subscriptions"("userId", "subscription");
+CREATE INDEX "push_subscriptions_isActive_idx" ON "push_subscriptions"("isActive");
 
-CREATE INDEX "message_threads_updated_at_idx" ON "message_threads"("updated_at");
+CREATE INDEX "message_threads_updatedAt_idx" ON "message_threads"("updatedAt");
 
-CREATE UNIQUE INDEX "message_thread_participants_thread_id_user_id_key" ON "message_thread_participants"("thread_id", "user_id");
-CREATE INDEX "message_thread_participants_user_id_idx" ON "message_thread_participants"("user_id");
-CREATE INDEX "message_thread_participants_thread_id_idx" ON "message_thread_participants"("thread_id");
+CREATE UNIQUE INDEX "message_thread_participants_threadId_userId_key" ON "message_thread_participants"("threadId", "userId");
+CREATE INDEX "message_thread_participants_userId_idx" ON "message_thread_participants"("userId");
+CREATE INDEX "message_thread_participants_threadId_idx" ON "message_thread_participants"("threadId");
 
-CREATE INDEX "messages_thread_id_created_at_idx" ON "messages"("thread_id", "created_at");
+CREATE INDEX "messages_threadId_createdAt_idx" ON "messages"("threadId", "createdAt");
 
-CREATE INDEX "communication_log_entity_type_entity_id_idx" ON "communication_log"("entity_type", "entity_id");
-CREATE INDEX "communication_log_created_at_idx" ON "communication_log"("created_at");
+CREATE INDEX "communication_log_entityType_entityId_idx" ON "communication_log"("entityType", "entityId");
+CREATE INDEX "communication_log_createdAt_idx" ON "communication_log"("createdAt");
 
-CREATE INDEX "noshow_alerts_status_shift_date_idx" ON "noshow_alerts"("status", "shift_date");
-CREATE INDEX "noshow_alerts_caregiver_id_idx" ON "noshow_alerts"("caregiver_id");
+CREATE INDEX "noshow_alerts_status_shiftDate_idx" ON "noshow_alerts"("status", "shiftDate");
+CREATE INDEX "noshow_alerts_caregiverId_idx" ON "noshow_alerts"("caregiverId");
 
-CREATE INDEX "form_templates_category_is_active_idx" ON "form_templates"("category", "is_active");
+CREATE INDEX "form_templates_category_isActive_idx" ON "form_templates"("category", "isActive");
 
-CREATE INDEX "form_submissions_entity_type_entity_id_idx" ON "form_submissions"("entity_type", "entity_id");
-CREATE INDEX "form_submissions_template_id_idx" ON "form_submissions"("template_id");
+CREATE INDEX "form_submissions_entityType_entityId_idx" ON "form_submissions"("entityType", "entityId");
+CREATE INDEX "form_submissions_templateId_idx" ON "form_submissions"("templateId");
 
 CREATE INDEX "login_activity_email_idx" ON "login_activity"("email");
-CREATE INDEX "login_activity_user_id_idx" ON "login_activity"("user_id");
-CREATE INDEX "login_activity_created_at_idx" ON "login_activity"("created_at");
+CREATE INDEX "login_activity_userId_idx" ON "login_activity"("userId");
+CREATE INDEX "login_activity_createdAt_idx" ON "login_activity"("createdAt");
 
-CREATE INDEX "audit_logs_user_id_idx" ON "audit_logs"("user_id");
+CREATE INDEX "audit_logs_userId_idx" ON "audit_logs"("userId");
 CREATE INDEX "audit_logs_timestamp_idx" ON "audit_logs"("timestamp");
-CREATE INDEX "audit_logs_table_name_idx" ON "audit_logs"("table_name");
+CREATE INDEX "audit_logs_tableName_idx" ON "audit_logs"("tableName");
-- 
2.43.0


From b33e376f53fa71d58073ac55e6d87d32e4773271 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 01:26:41 +0000
Subject: [PATCH 24/27] fix: make seed idempotent with upsert, add
 certifications empty arrays

---
 templates/crm-homecare/backend/prisma/seed.js | 209 ++++++++++--------
 1 file changed, 113 insertions(+), 96 deletions(-)

diff --git a/templates/crm-homecare/backend/prisma/seed.js b/templates/crm-homecare/backend/prisma/seed.js
index e4b7506..c87af48 100644
--- a/templates/crm-homecare/backend/prisma/seed.js
+++ b/templates/crm-homecare/backend/prisma/seed.js
@@ -7,8 +7,10 @@ async function main() {
   console.log('🌱 Seeding {{COMPANY_NAME}} Care database...');
 
   // ── AGENCY ────────────────────────────────────────────
-  const agency = await prisma.agency.create({
-    data: {
+  const agency = await prisma.agency.upsert({
+    where: { slug: '{{COMPANY_SLUG}}' },
+    update: {},
+    create: {
       name: '{{COMPANY_NAME}}',
       legalName: '{{COMPANY_LEGAL_NAME}}',
       slug: '{{COMPANY_SLUG}}',
@@ -22,125 +24,140 @@ async function main() {
       secondaryColor: '{{SECONDARY_COLOR}}',
     },
   });
-  console.log(`✅ Agency created: ${agency.name}`);
+  console.log(`✅ Agency: ${agency.name}`);
 
   // ── ADMIN USER ────────────────────────────────────────
   const passwordHash = await bcrypt.hash('{{DEFAULT_PASSWORD}}', 12);
 
-  const admin = await prisma.user.create({
-    data: {
+  const admin = await prisma.user.upsert({
+    where: { email: '{{ADMIN_EMAIL}}' },
+    update: {},
+    create: {
       email: '{{ADMIN_EMAIL}}',
       passwordHash,
       firstName: '{{OWNER_FIRST_NAME}}',
       lastName: '{{OWNER_LAST_NAME}}',
       role: 'admin',
       isActive: true,
+      certifications: [],
+      certificationsExpiry: [],
     },
   });
-  await prisma.notificationPreference.create({ data: { userId: admin.id } });
-  console.log(`✅ Admin user created: ${admin.email}`);
 
-  // ── NO-SHOW ALERT CONFIG ──────────────────────────────
-  await prisma.noshowAlertConfig.create({
-    data: { graceMinutes: 15, notifyAdmin: true, notifyCaregiver: true, isActive: true, adminEmail: '{{ADMIN_EMAIL}}' },
+  await prisma.notificationPreference.upsert({
+    where: { userId: admin.id },
+    update: {},
+    create: { userId: admin.id },
   });
-  console.log('✅ No-show alert config created');
+  console.log(`✅ Admin: ${admin.email}`);
 
-  // ── SERVICE CODES ─────────────────────────────────────
-  const serviceCodes = [
-    { code: 'T1019', description: 'Personal Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
-    { code: 'T1019', modifier1: 'U1', description: 'Personal Care - Supportive Home Care', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
-    { code: 'T1019', modifier1: 'U2', description: 'Personal Care - Consumer Directed', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
-    { code: 'S5125', description: 'Attendant Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
-    { code: 'S5130', description: 'Homemaker Services - per 15 min', serviceCategory: 'homemaker', payerType: 'all', unitType: '15min', requiresEvv: true },
-    { code: 'S5135', description: 'Companion Services - per 15 min', serviceCategory: 'companion', payerType: 'all', unitType: '15min', requiresEvv: true },
-    { code: 'T1005', description: 'Respite Care Services - per 15 min', serviceCategory: 'respite', payerType: 'all', unitType: '15min', requiresEvv: true },
-    { code: 'G0299', description: 'Direct Skilled Nursing - per visit', serviceCategory: 'skilled_nursing', payerType: 'medicaid', unitType: 'visit', requiresEvv: true },
-    { code: '99509', description: 'Home Visit - Assistance with ADLs', serviceCategory: 'personal_care', payerType: 'all', unitType: 'visit', requiresEvv: true },
-    { code: 'T2025', description: 'Waiver Services - Hourly', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: 'hour', requiresEvv: true },
-  ];
+  // ── NO-SHOW ALERT CONFIG ──────────────────────────────
+  const existing = await prisma.noshowAlertConfig.findFirst();
+  if (!existing) {
+    await prisma.noshowAlertConfig.create({
+      data: { graceMinutes: 15, notifyAdmin: true, notifyCaregiver: true, isActive: true, adminEmail: '{{ADMIN_EMAIL}}' },
+    });
+  }
+  console.log('✅ No-show config');
 
-  for (const code of serviceCodes) {
-    await prisma.serviceCode.create({ data: code });
+  // ── SERVICE CODES ─────────────────────────────────────
+  const existingCodes = await prisma.serviceCode.count();
+  if (existingCodes === 0) {
+    const serviceCodes = [
+      { code: 'T1019', description: 'Personal Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
+      { code: 'T1019', modifier1: 'U1', description: 'Personal Care - Supportive Home Care', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
+      { code: 'T1019', modifier1: 'U2', description: 'Personal Care - Consumer Directed', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: '15min', requiresEvv: true },
+      { code: 'S5125', description: 'Attendant Care Services - per 15 min', serviceCategory: 'personal_care', payerType: 'all', unitType: '15min', requiresEvv: true },
+      { code: 'S5130', description: 'Homemaker Services - per 15 min', serviceCategory: 'homemaker', payerType: 'all', unitType: '15min', requiresEvv: true },
+      { code: 'S5135', description: 'Companion Services - per 15 min', serviceCategory: 'companion', payerType: 'all', unitType: '15min', requiresEvv: true },
+      { code: 'T1005', description: 'Respite Care Services - per 15 min', serviceCategory: 'respite', payerType: 'all', unitType: '15min', requiresEvv: true },
+      { code: 'G0299', description: 'Direct Skilled Nursing - per visit', serviceCategory: 'skilled_nursing', payerType: 'medicaid', unitType: 'visit', requiresEvv: true },
+      { code: '99509', description: 'Home Visit - Assistance with ADLs', serviceCategory: 'personal_care', payerType: 'all', unitType: 'visit', requiresEvv: true },
+      { code: 'T2025', description: 'Waiver Services - Hourly', serviceCategory: 'personal_care', payerType: 'mco_family_care', unitType: 'hour', requiresEvv: true },
+    ];
+    await prisma.serviceCode.createMany({ data: serviceCodes });
+    console.log(`✅ ${serviceCodes.length} service codes`);
   }
-  console.log(`✅ ${serviceCodes.length} service codes seeded`);
 
   // ── PAYERS ────────────────────────────────────────────
-  const payers = [
-    { name: 'Private Pay', type: 'private_pay', payerType: 'private_pay', isActivePayer: true, expectedPayDays: 14, submissionMethod: 'manual' },
-    { name: 'Medicaid', type: 'insurance', payerType: 'medicaid', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
-    { name: 'Medicare', type: 'insurance', payerType: 'medicare', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
-    { name: 'Veterans Affairs (VA)', type: 'insurance', payerType: 'va', isActivePayer: true, expectedPayDays: 45, submissionMethod: 'edi' },
-  ];
-
-  for (const payer of payers) {
-    await prisma.referralSource.create({ data: payer });
+  const existingPayers = await prisma.referralSource.count();
+  if (existingPayers === 0) {
+    const payers = [
+      { name: 'Private Pay', type: 'private_pay', payerType: 'private_pay', isActivePayer: true, expectedPayDays: 14, submissionMethod: 'manual' },
+      { name: 'Medicaid', type: 'insurance', payerType: 'medicaid', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
+      { name: 'Medicare', type: 'insurance', payerType: 'medicare', isActivePayer: true, expectedPayDays: 30, submissionMethod: 'edi' },
+      { name: 'Veterans Affairs (VA)', type: 'insurance', payerType: 'va', isActivePayer: true, expectedPayDays: 45, submissionMethod: 'edi' },
+    ];
+    await prisma.referralSource.createMany({ data: payers });
+    console.log(`✅ ${payers.length} payers`);
   }
-  console.log(`✅ ${payers.length} payers seeded`);
 
   // ── SERVICE LOCATION ──────────────────────────────────
-  await prisma.serviceLocation.create({
-    data: { name: '{{COMPANY_NAME}} Main Office', address: '{{COMPANY_ADDRESS}}', city: '{{CITY}}', state: '{{STATE}}', zip: '{{ZIP}}', isActive: true },
-  });
+  const existingLoc = await prisma.serviceLocation.count();
+  if (existingLoc === 0) {
+    await prisma.serviceLocation.create({
+      data: { name: '{{COMPANY_NAME}} Main Office', address: '{{COMPANY_ADDRESS}}', city: '{{CITY}}', state: '{{STATE}}', zip: '{{ZIP}}', isActive: true },
+    });
+  }
 
   // ── FORM TEMPLATES ────────────────────────────────────
-  const formTemplates = [
-    {
-      name: 'Initial Client Assessment',
-      description: 'Standard intake assessment for new clients',
-      category: 'assessment',
-      requiresSignature: true,
-      autoAttachTo: 'client',
-      fields: JSON.stringify([
-        { id: 'f1', type: 'text', label: 'Primary Diagnosis', required: true },
-        { id: 'f2', type: 'textarea', label: 'Medical History', required: false },
-        { id: 'f3', type: 'select', label: 'Mobility Level', required: true, options: ['Independent', 'Requires Assistance', 'Non-Ambulatory'] },
-        { id: 'f4', type: 'select', label: 'Cognitive Status', required: true, options: ['Alert & Oriented', 'Mild Impairment', 'Moderate Impairment', 'Severe Impairment'] },
-        { id: 'f5', type: 'checkbox', label: 'Fall Risk', required: false },
-        { id: 'f6', type: 'checkbox', label: 'Requires Hoyer Lift', required: false },
-        { id: 'f7', type: 'textarea', label: 'Special Instructions for Caregiver', required: false },
-      ]),
-    },
-    {
-      name: 'Incident Report',
-      description: 'Document any incidents during a visit',
-      category: 'incident',
-      requiresSignature: true,
-      autoAttachTo: 'client',
-      fields: JSON.stringify([
-        { id: 'i1', type: 'text', label: 'Date of Incident', required: true, inputType: 'date' },
-        { id: 'i2', type: 'text', label: 'Time of Incident', required: true, inputType: 'time' },
-        { id: 'i3', type: 'select', label: 'Incident Type', required: true, options: ['Fall', 'Medication Error', 'Behavioral Issue', 'Medical Emergency', 'Property Damage', 'Complaint', 'Other'] },
-        { id: 'i4', type: 'textarea', label: 'Description of Incident', required: true },
-        { id: 'i5', type: 'textarea', label: 'Immediate Actions Taken', required: true },
-        { id: 'i6', type: 'checkbox', label: '911 Called', required: false },
-        { id: 'i7', type: 'checkbox', label: 'Family Notified', required: false },
-        { id: 'i8', type: 'checkbox', label: 'Supervisor Notified', required: false },
-      ]),
-    },
-    {
-      name: 'Caregiver HR Review',
-      description: 'Annual performance and compliance review',
-      category: 'hr',
-      requiresSignature: true,
-      autoAttachTo: 'caregiver',
-      fields: JSON.stringify([
-        { id: 'h1', type: 'select', label: 'Review Period', required: true, options: ['Q1', 'Q2', 'Q3', 'Q4', 'Annual'] },
-        { id: 'h2', type: 'select', label: 'Attendance Rating', required: true, options: ['Excellent', 'Good', 'Needs Improvement', 'Unsatisfactory'] },
-        { id: 'h3', type: 'select', label: 'Performance Rating', required: true, options: ['Exceeds Expectations', 'Meets Expectations', 'Below Expectations'] },
-        { id: 'h4', type: 'textarea', label: 'Strengths', required: false },
-        { id: 'h5', type: 'textarea', label: 'Areas for Improvement', required: false },
-        { id: 'h6', type: 'checkbox', label: 'CPR Certification Current', required: false },
-        { id: 'h7', type: 'checkbox', label: 'Background Check Current', required: false },
-        { id: 'h8', type: 'textarea', label: 'Supervisor Comments', required: false },
-      ]),
-    },
-  ];
-
-  for (const template of formTemplates) {
-    await prisma.formTemplate.create({ data: template });
+  const existingForms = await prisma.formTemplate.count();
+  if (existingForms === 0) {
+    const formTemplates = [
+      {
+        name: 'Initial Client Assessment',
+        description: 'Standard intake assessment for new clients',
+        category: 'assessment',
+        requiresSignature: true,
+        autoAttachTo: 'client',
+        fields: JSON.stringify([
+          { id: 'f1', type: 'text', label: 'Primary Diagnosis', required: true },
+          { id: 'f2', type: 'textarea', label: 'Medical History', required: false },
+          { id: 'f3', type: 'select', label: 'Mobility Level', required: true, options: ['Independent', 'Requires Assistance', 'Non-Ambulatory'] },
+          { id: 'f4', type: 'select', label: 'Cognitive Status', required: true, options: ['Alert & Oriented', 'Mild Impairment', 'Moderate Impairment', 'Severe Impairment'] },
+          { id: 'f5', type: 'checkbox', label: 'Fall Risk', required: false },
+          { id: 'f6', type: 'checkbox', label: 'Requires Hoyer Lift', required: false },
+          { id: 'f7', type: 'textarea', label: 'Special Instructions for Caregiver', required: false },
+        ]),
+      },
+      {
+        name: 'Incident Report',
+        description: 'Document any incidents during a visit',
+        category: 'incident',
+        requiresSignature: true,
+        autoAttachTo: 'client',
+        fields: JSON.stringify([
+          { id: 'i1', type: 'text', label: 'Date of Incident', required: true, inputType: 'date' },
+          { id: 'i2', type: 'text', label: 'Time of Incident', required: true, inputType: 'time' },
+          { id: 'i3', type: 'select', label: 'Incident Type', required: true, options: ['Fall', 'Medication Error', 'Behavioral Issue', 'Medical Emergency', 'Property Damage', 'Complaint', 'Other'] },
+          { id: 'i4', type: 'textarea', label: 'Description of Incident', required: true },
+          { id: 'i5', type: 'textarea', label: 'Immediate Actions Taken', required: true },
+          { id: 'i6', type: 'checkbox', label: '911 Called', required: false },
+          { id: 'i7', type: 'checkbox', label: 'Family Notified', required: false },
+          { id: 'i8', type: 'checkbox', label: 'Supervisor Notified', required: false },
+        ]),
+      },
+      {
+        name: 'Caregiver HR Review',
+        description: 'Annual performance and compliance review',
+        category: 'hr',
+        requiresSignature: true,
+        autoAttachTo: 'caregiver',
+        fields: JSON.stringify([
+          { id: 'h1', type: 'select', label: 'Review Period', required: true, options: ['Q1', 'Q2', 'Q3', 'Q4', 'Annual'] },
+          { id: 'h2', type: 'select', label: 'Attendance Rating', required: true, options: ['Excellent', 'Good', 'Needs Improvement', 'Unsatisfactory'] },
+          { id: 'h3', type: 'select', label: 'Performance Rating', required: true, options: ['Exceeds Expectations', 'Meets Expectations', 'Below Expectations'] },
+          { id: 'h4', type: 'textarea', label: 'Strengths', required: false },
+          { id: 'h5', type: 'textarea', label: 'Areas for Improvement', required: false },
+          { id: 'h6', type: 'checkbox', label: 'CPR Certification Current', required: false },
+          { id: 'h7', type: 'checkbox', label: 'Background Check Current', required: false },
+          { id: 'h8', type: 'textarea', label: 'Supervisor Comments', required: false },
+        ]),
+      },
+    ];
+    await prisma.formTemplate.createMany({ data: formTemplates });
+    console.log(`✅ ${formTemplates.length} form templates`);
   }
-  console.log(`✅ ${formTemplates.length} form templates seeded`);
 
   console.log('\n✅ Seed complete!');
   console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
-- 
2.43.0


From 4fe68057d87af46115ee7d40de061b7c2904f79b Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 02:49:39 +0000
Subject: [PATCH 25/27] fix: rename seed.js to seed.template.js so generator
 replaces tokens

---
 .../crm-homecare/backend/prisma/{seed.js => seed.template.js}     | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 rename templates/crm-homecare/backend/prisma/{seed.js => seed.template.js} (100%)

diff --git a/templates/crm-homecare/backend/prisma/seed.js b/templates/crm-homecare/backend/prisma/seed.template.js
similarity index 100%
rename from templates/crm-homecare/backend/prisma/seed.js
rename to templates/crm-homecare/backend/prisma/seed.template.js
-- 
2.43.0


From 7002eb9119ea54a2666bc1cb4979ba1996ab55dd Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 03:12:48 +0000
Subject: [PATCH 26/27] fix: remove capacitor external from vite build - bundle
 for web deployment

---
 templates/crm-homecare/frontend/vite.config.js | 1 -
 1 file changed, 1 deletion(-)

diff --git a/templates/crm-homecare/frontend/vite.config.js b/templates/crm-homecare/frontend/vite.config.js
index 4be347e..5101bb2 100644
--- a/templates/crm-homecare/frontend/vite.config.js
+++ b/templates/crm-homecare/frontend/vite.config.js
@@ -21,7 +21,6 @@ export default defineConfig({
     minify: 'terser',
     chunkSizeWarningLimit: 600,
     rollupOptions: {
-      external: (id) => id.startsWith('@capacitor/') || id === '@capacitor-community/background-geolocation',
       output: {
         manualChunks: {
           'vendor-react': ['react', 'react-dom', 'react-router-dom'],
-- 
2.43.0


From 68475332dd305a93a870174c8d9daaa4d9fea2f5 Mon Sep 17 00:00:00 2001
From: Jeremiah <jeremiah@twomiah.com>
Date: Wed, 25 Feb 2026 07:53:55 +0000
Subject: [PATCH 27/27] fix: alias all capacitor imports to stub for web build

---
 .../crm-homecare/frontend/src/capacitor-stub.js  | 16 ++++++++++++++++
 templates/crm-homecare/frontend/vite.config.js   | 12 ++++++++++--
 2 files changed, 26 insertions(+), 2 deletions(-)
 create mode 100644 templates/crm-homecare/frontend/src/capacitor-stub.js

diff --git a/templates/crm-homecare/frontend/src/capacitor-stub.js b/templates/crm-homecare/frontend/src/capacitor-stub.js
new file mode 100644
index 0000000..6b99e57
--- /dev/null
+++ b/templates/crm-homecare/frontend/src/capacitor-stub.js
@@ -0,0 +1,16 @@
+// Stub for all @capacitor/* packages when running in browser/web
+export const Capacitor = {
+  isNativePlatform: () => false,
+  getPlatform: () => 'web',
+  isPluginAvailable: () => false,
+};
+export const Geolocation = null;
+export const Network = null;
+export const Haptics = null;
+export const LocalNotifications = null;
+export const BackgroundGeolocation = null;
+export const SplashScreen = null;
+export const StatusBar = null;
+export const Keyboard = null;
+export const PushNotifications = null;
+export default {};
diff --git a/templates/crm-homecare/frontend/vite.config.js b/templates/crm-homecare/frontend/vite.config.js
index 5101bb2..66fdce4 100644
--- a/templates/crm-homecare/frontend/vite.config.js
+++ b/templates/crm-homecare/frontend/vite.config.js
@@ -1,10 +1,18 @@
 import { defineConfig } from 'vite';
 import react from '@vitejs/plugin-react';
+import path from 'path';
+import { fileURLToPath } from 'url';
+
+const __dirname = path.dirname(fileURLToPath(import.meta.url));
 
 export default defineConfig({
   plugins: [react()],
-  optimizeDeps: {
-    exclude: ['@capacitor-community/background-geolocation'],
+  resolve: {
+    alias: [
+      { find: /^@capacitor\/core$/, replacement: path.resolve(__dirname, 'src/capacitor-stub.js') },
+      { find: /^@capacitor\/(.+)$/, replacement: path.resolve(__dirname, 'src/capacitor-stub.js') },
+      { find: /^@capacitor-community\/(.+)$/, replacement: path.resolve(__dirname, 'src/capacitor-stub.js') },
+    ],
   },
   server: {
     port: 3000,
-- 
2.43.0

